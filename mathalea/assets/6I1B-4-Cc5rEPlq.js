var w=Object.defineProperty;var M=(p,m,t)=>m in p?w(p,m,{enumerable:!0,configurable:!0,writable:!0,value:t}):p[m]=t;var y=(p,m,t)=>M(p,typeof m!="symbol"?m+"":m,t);import{E as Q,r as v,G as L,ae as F,P as k,o as T,ag as O,aZ as H,p as J,z as $,a1 as V,V as j,U as q,R as B,m as I}from"./index-DjA7ROjC.js";import{j as P}from"./vendors/jspreadsheet-ce-30hCR1-Y.js";/* empty css                         */import"./vendors/svelte-DYHmJxok.js";import"./vendors/ua-parser-js-IGXSU7q4.js";import"./vendors/instrumenpoche-CSnohZOK.js";import"./vendors/sesajstools-DShOIGrY.js";import"./vendors/ansi-styles-C5UZWym2.js";import"./vendors/decimal.js-16C9rIKp.js";import"./vendors/katex-DRsvfONx.js";import"./vendors/seedrandom-CNNRxp22.js";import"./vendors/crypto-js-jSnn2346.js";import"./vendors/apigeom-w0ofBCni.js";import"./vendors/mathjs-oaIJR0Fd.js";import"./vendors/babel_runtime-91SaXnVV.js";import"./vendors/javascript-natural-sort-CZcnv-xn.js";import"./vendors/escape-latex-D2RmlMiC.js";import"./vendors/complex.js-CUuq6tox.js";import"./vendors/typed-function-DLw9ktPY.js";import"./vendors/fraction.js-CAdrwJ1J.js";import"./vendors/tiny-emitter-DDQe9_b_.js";import"./vendors/xstate-CiXeYAGM.js";import"./vendors/earcut-jJVragJp.js";import"./vendors/roughjs-GtHDBO_d.js";import"./json/referentielStaticCH-BvJ6T55O.js";import"./json/referentielStaticFR-CRF_Hjtf.js";import"./json/uuidsToUrlFR-BAWSFQnt.js";import"./vendors/cortex-js_compute-engine-CK5Y8453.js";import"./vendors/mathlive-DtHmjDB4.js";import"./vendors/bugsnag_js-CkCWaA3t.js";import"./vendors/bugsnag_browser-d00kmNSm.js";import"./vendors/big-integer-Cu-VsFVy.js";import"./json/codeToLevelList-Cc4cPPvZ.js";import"./json/codeToThemeList-xPVrG8Yb.js";import"./vendors/mixer_postmessage-rpc-Knoq2TfA.js";import"./vendors/eventemitter3-6E4L_h32.js";import"./vendors/scratchblocks-BVGw3YSR.js";import"./json/scratchFr-DbCU7OC2.js";import"./json/refToUuidFR-BGtQQjtA.js";import"./json/refToUuidCH-Dm7pY6Rc.js";import"./vendors/loadjs-BzrfRgSk.js";import"./vendors/svelte-gestures-u4km4ICX.js";import"./vendors/tw-elements-Cl8JxGRl.js";import"./json/uuidsRessources-CtbQ0Y2s.js";import"./json/referentielProfs-Cey1_luL.js";import"./json/referentielBibliotheque-BkZtqQRj.js";import"./vendors/jszip-CxmGZ1c2.js";import"./vendors/jszip-utils-D5kR6ObF.js";import"./vendors/file-saver-FyOmtGcA.js";import"./vendors/copy-image-clipboard-Cf9y-QAU.js";import"./vendors/qrcode-SHonoxyK.js";import"./vendors/dijkstrajs-D_NXgYpA.js";import"./vendors/svelte-french-toast-BHXPj9o3.js";import"./vendors/svelte-writable-derived-Cn90q3ND.js";import"./vendors/brace-BiTXuHwf.js";import"./json/referentielAppsTierce-SxU58PZT.js";import"./vendors/sortablejs-C83syoBY.js";import"./json/carouselContent-BScQaKkw.js";import"./json/levelsThemesList-HiwLnYG4.js";import"./json/levelsThemesListCH-CWlgSx1G.js";import"./json/referentiel2022CH-B8vRIdSG.js";import"./json/referentiel2022FR-Bx-nUux7.js";import"./json/referentielGeometrieDynamique-BJ2PHXsv.js";import"./json/referentielRessources-BU2QQoSD.js";import"./json/referentielsActivation-CpD_hoec.js";import"./vendors/jsuites-g7pX7vQ7.js";import"./vendors/jspreadsheet_formula-Dc90OoFN.js";class C extends HTMLElement{constructor(){super();y(this,"_spreadsheet",null);y(this,"_buttonListener");y(this,"_customListeners",{});this._spreadsheet=null}addListener(t,r){this.addEventListener(t,r),this._customListeners[t]=r}static create({id:t,data:r=[],minDimensions:o=[5,5],style:s={},columns:i=[],interactif:u=!1}={}){const n=new C;return t&&(n.id=t),n.setAttribute("data",JSON.stringify(r)),n.setAttribute("min-dimensions",JSON.stringify(o)),n.setAttribute("style",JSON.stringify(s)),n.setAttribute("columns",JSON.stringify(i)),n.setAttribute("interactif",u?"true":"false"),n}connectedCallback(){this.innerHTML="<div></div>";const t=this.firstElementChild??document.createElement("div");let r=[],o=[5,5],s={},i=[];try{this.getAttribute("data")&&(r=JSON.parse(this.getAttribute("data")??""))}catch{}try{this.getAttribute("min-dimensions")&&(o=JSON.parse(this.getAttribute("min-dimensions")??""))}catch{}try{this.getAttribute("style")&&(s=JSON.parse(this.getAttribute("style")??""))}catch{}try{this.getAttribute("columns")&&(i=JSON.parse(this.getAttribute("columns")??"[]"))}catch{}this._spreadsheet=P(t,{tabs:!1,toolbar:!1,worksheets:[{data:r,minDimensions:o,tableOverflow:!0,tableHeight:"300px",style:s,columns:i}]})[0];let u=0,n=0;const a=this.id.match(/sheet-Ex(\d+)Q(\d+)$/);a&&(u=Number(a[1]),n=Number(a[2]));const h=document.createElement("div");h.id="message-faux",t.appendChild(h);const l=document.createElement("span");l.id=`resultatCheckEx${u}Q${n}`,t.appendChild(l);const d=document.createElement("div");d.id=`feedbackEx${u}Q${n}`,d.className="italic text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest",t.appendChild(d);const e=document.createElement("button");if(e.id="runCode",e.textContent="V√©rifier",e.style.boxSizing="border-box",e.style.position="relative",e.style.zIndex="10",e.style.marginTop="10px",e.style.backgroundColor="#2b6cb0",e.style.color="white",e.style.border="none",e.style.borderRadius="6px",e.style.padding="8px 20px",e.style.fontSize="1rem",e.style.fontWeight="bold",e.style.cursor="pointer",e.style.boxShadow="0 2px 6px rgba(0,0,0,0.08)",e.onmouseover=()=>{e.style.backgroundColor="#174ea6"},e.onmouseout=()=>{e.style.backgroundColor="#2b6cb0"},e.style.display=this.getAttribute("interactif")==="true"?"none":"block",t.appendChild(e),a){const g=Number(a[1]),c=Number(a[2]);this._setupButton(e,g,c)}this.dispatchEvent(new CustomEvent("spreadsheet-ready"))}disconnectedCallback(){this._spreadsheet&&(this._spreadsheet=null);const t=this.querySelector("#runCode");t&&this._buttonListener&&t.removeEventListener("click",this._buttonListener),Object.entries(this._customListeners).forEach(([r,o])=>{this.removeEventListener(r,o)}),this._customListeners={}}_setupButton(t,r,o){const s=`checkEx${r}Q${o}`;this._buttonListener=()=>{this.dispatchEvent(new CustomEvent(s,{detail:{sheet:this}}))},t.addEventListener("click",this._buttonListener)}getCellValue(t,r){return this._spreadsheet.getValueFromCoords(t,r,!0)}getCellFormula(t,r){return this._spreadsheet.getValueFromCoords(t,r,!1)}getData(){return this._spreadsheet.getData()??[]}setCellValue(t,r,o){this._spreadsheet.setValueFromCoords(t,r,o,!0)}setCellFormula(t,r,o){o.startsWith("=")||(o="="+o),this._spreadsheet.setValueFromCoords(t,r,o,!0)}setData(t){this._spreadsheet.setData(t)}isMounted(){return this._spreadsheet!==null}getMinDimensions(){return this._spreadsheet.minDimensions??[5,5]}getStyle(){return this._spreadsheet.style??{}}getColumns(){return this._spreadsheet.columns??[]}}customElements.define("my-spreadsheet",C);function R({numeroExercice:p,question:m,data:t,minDimensions:r,style:o,columns:s,interactif:i}){return`<my-spreadsheet
  id="sheet-Ex${p}Q${m}"
  data='${JSON.stringify(t)}'
  min-dimensions='${JSON.stringify(r)}'
  style='${JSON.stringify(o)}'
  columns='${JSON.stringify(s)}'
  interactif='${i}'
>`+(i?`<div class="ml-2 py-2" id="resultatCheckEx${p}Q${m}"></div>
<div class ="ml-2 py-2 italic text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest" id="feedbackEx${p}Q${m}"}></div>`:"")+"</my-spreadsheet>"}const mt="Programmer des calculs sur tableur",dt="12/08/2025",ht=!0,pt="custom",ft="ae07c",gt={"fr-fr":["6I1B-4"],"fr-ch":[]},D="ABCDEFGHIJKLMNOPQRSTUVWXYZ",f=class f extends Q{constructor(){super();y(this,"destroyers",[]);y(this,"listeSteps",[]);y(this,"correctionInteractive",t=>{if(t===void 0)return"";this.answers===void 0&&(this.answers={});let r="KO";const o=document.getElementById(`sheet-Ex${this.numeroExercice}Q${t}`);if(!o)return console.error(`sheet-Ex${this.numeroExercice}Q${t} not found`),r;if(o&&o.isMounted()){this.answers[`sheet-Ex${this.numeroExercice}Q${t}`]=JSON.stringify(o.getData());const s=document.querySelector(`#resultatCheckEx${this.numeroExercice}Q${t}`),i=document.querySelector(`#feedbackEx${this.numeroExercice}Q${t}`),{isOk:u,messages:n}=this.validateFormulas(t,o);n.length>0&&s&&i&&(i.innerHTML=n,u?(s&&(s.innerHTML="üòä"),r="OK"):s&&(s.innerHTML="‚òπÔ∏è"))}return r});this.nbQuestions=2,this.besoinFormulaireNumerique=["Nombre d'op√©rations (entre 2 et 5 ou bien 1 si vous laissez le hasard d√©cider)",5],this.besoinFormulaire2Texte=["Type d'op√©rations",["Nombres s√©par√©s par des tirets  :","1 : Addition","2 : Soustraction","3 : Multiplication","4 : Division","5 : M√©lange"].join(`
`)],this.sup=3,this.sup2=5,this.listeSteps=[]}destroy(){this.destroyers.forEach(t=>t()),this.destroyers.length=0}validateFormulas(t,r){const o=r.getData(),s=C.create({data:o,minDimensions:r.getMinDimensions(),style:r.getStyle(),columns:r.getColumns(),interactif:!1,id:"testSheet"});s.style.position="absolute",s.style.left="-9999px",document.body.appendChild(s);const i=[];for(let a=0;a<5;a++){i[a]=[];const h=v(1,10);s.setCellValue(0,0,h);const l=[1,2,3].map(e=>parseFloat(s.getCellValue(e,0)));for(let e=1;e<4;e++)(typeof l[e-1]!="number"||isNaN(l[e-1]))&&i[a].push(`La cellule ${String.fromCharCode(65+e)}1 ne contient pas un nombre valide.<br>`);for(let e=1;e<4;e++)(typeof s.getCellFormula(e,0)!="string"||!s.getCellFormula(e,0).startsWith("="))&&i[a].push(`La cellule ${String.fromCharCode(65+e)}1 ne contient pas une formule valide.<br>`);let d=h;for(let e=1;e<4;e++){const g=this.listeSteps[t];d=W(d,g[e-1].op,g[e-1].val);const c=parseFloat(s.getCellValue(e,0));Math.abs(c-d)>1e-9&&i[a].push(`Pour un nombre de d√©part √©gal √† ${h}, la cellule ${String.fromCharCode(65+e)}1 devrait contenir ${L(d,2)} mais elle contient ${L(c,2)}.<br>`)}}const u=i.reduce((a,h)=>h.length>a.length?h:a,[]);document.body.removeChild(s);const n=u.length===0?"‚úÖ Toutes les formules sont correctes !":"‚ùå Des erreurs ont √©t√© d√©t√©ct√©es.";return{isOk:u.length===0,messages:u.join("")+n}}checkSolution(t){var u;const r=t==null?void 0:t.type,o=(u=r==null?void 0:r.match(/Q(\d+)/))==null?void 0:u[1];if(!o){console.error("Question number not found in event name:",r);return}const s=(r==null?void 0:r.replace("check","sheet-"))||"",i=document.getElementById(s);if(i&&i.isMounted()){const{messages:n}=this.validateFormulas(Number(o),i),a=i.querySelector("#message-faux");n&&a&&(a.style.color="green",a.innerHTML=n)}}nouvelleVersion(){this.destroyers.forEach(s=>s()),this.destroyers.length=0;const t=this.sup===1?v(2,5):Math.min(Math.max(2,this.sup),5),r=F({saisie:this.sup2,min:1,max:4,melange:5,defaut:5,nbQuestions:t});this.listeSteps=[];const o=Object.entries(f.colors);for(let s=0,i=0,u,n;s<this.nbQuestions&&i<50;i++){const{steps:a}=X(r);this.listeSteps[s]=a;const h=z(a),l={0:{0:{v:a[0].oldn,s:"style_id_orange",t:2}}};for(let c=0;c<a.length;c++)l[0][c+1]={v:"",s:`style_id_${o[(c+1)%o.length][0]}`};const d=[[]];d[0][0]=l[0][0].v;for(let c=0;c<a.length;c++)d[0][c+1]=l[0][c+1].v;const e={0:{v:a[0].oldn.toString(),bg:o[0][1]}};for(let c=0,b=1;c<a.length;c++,b+=2)e[`${b}`]={v:h[c]},e[`${b+1}`]={bg:o[(c+1)%o.length][1]};if(u="On a cr√©√© le programme de calculs suivant :<br>",u+=K(Object.keys(e).length,e)+"<br>",u+=`On choisit un nombre dans la premi√®re case, ici ${a[0].oldn} et on obtient un nombre √† la fin de la cha√Æne.<br><br>      
      On veut programmer cette suite de calculs dans un tableur. <br>
      Par exemple, la cellule B1 doit contenir la formule du premier calcul.<br>
      Faire de m√™me pour les autres cellules. <br>
      Attention, les formules doivent fonctionner m√™me si le nombre de d√©part change (Cellule A1).<br>
      `,k.isHtml)u+=R({numeroExercice:this.numeroExercice??0,question:s,data:d,minDimensions:[4,4],style:{A1:`background-color:   ${f.colors.orange}; font-weight: bold;`,B1:`background-color: ${f.colors.vert};`,C1:`background-color: ${f.colors.jaune};`,D1:`background-color: ${f.colors.bleu};`},columns:[{width:90},{width:90},{width:90},{width:90}],interactif:this.interactif});else{const c={};c.formule=!0,c.formuleTexte="=?",c.formuleCellule="B1",u+=U(2,a.length+1,l,f.styles,c)}n="Voici les formules √† saisir dans le tableur :<br>";for(let c=0;c<a.length;c++){const b=a[c];n+=`$${b.oldn} ${h[c]} = ${b.result}$ devient en cellule ${D[c+1]}1 la formule suivante : "=${D[c]}1${h[c].replace("\\times","*").replace("\\div","/")}"<br>`}const g=()=>{var b;const c=Array.from(document.querySelectorAll("my-spreadsheet"));for(const x of c){const E=(b=x.id.match(/Q(\d+)$/))==null?void 0:b[1],S=E!==void 0&&this.numeroExercice!==void 0?`checkEx${this.numeroExercice}Q${E}`:void 0;if(x&&S){const _=N=>{this.checkSolution(N)};x.addListener(S,_)}else console.error(`SheetElement not found or eventName invalid for question ${E} in exercice ${this.numeroExercice}`)}document.removeEventListener("exercicesAffiches",g)};document.addEventListener("exercicesAffiches",g,{once:!0}),this.questionJamaisPosee(s,u)&&(this.listeQuestions[s]=u,this.listeCorrections[s]=n,s++),T(this)}}};y(f,"colors",{orange:"#e6b457",vert:"#7adb7a",jaune:"#e6e66a",bleu:"#8181e6",violet:"#f8a3f8",rouge:"#eca2a2"}),y(f,"styles",{style_id_rouge:{fs:12,bg:f.colors.rouge},style_id_bleu:{fs:12,bg:f.colors.bleu},style_id_orange:{fs:12,bg:f.colors.orange},style_id_violet:{fs:12,bg:f.colors.violet},style_id_vert:{fs:12,bg:f.colors.vert},style_id_jaune:{fs:12,bg:f.colors.jaune}});let A=f;function z(p){function m(t){const r={1:"+",2:"‚àí",3:"\\times",4:"\\div"};return t.map(o=>(r[o.op]||"?")+o.val)}return m(p)}function W(p,m,t){return m===1?p+t:m===2?p-t:m===3?p*t:m===4?p/t:NaN}function X(p=[1,2,3,4]){let m=[],t=null,r=p,o=0,s=!1;for(;!s&&o<20;){r=O(r);let i=v(5,20);m=[],s=!0;for(let u=0,n=0;u<r.length&&n<4;){if(n>0){const e=r.slice(0,u),g=O(r.slice(u));r=[...e,...g]}const a=r[u],h=i;let l=1;const d=u>0?m[u-1].val:1;if(a===1)if(50-i<2||50-i===2&&d===2){n++;continue}else l=v(2,50-i,[d]),i+=l,u++,n=0;else if(a===2)if(i<2||i===2&&d===2){n++;continue}else l=v(2,i,[d]),i-=l,u++,n=0;else if(a===3){const e=i<1?5:Math.floor(50/i);if(e<2||e===2&&d===2){n++;continue}else l=v(2,e,[d]),i*=l,u++,n=0}else if(a===4){const e=H(i).filter(g=>g>1&&g<i);if(e.length===0||e.length===1&&e[0]===d){n++;continue}else l=J(e,[d]),i/=l,u++,n=0}if(i<0||i>50||!Number.isInteger(i)){n+=10;continue}m.push({oldn:h,op:a,val:l,result:i})}m.length!==r.length&&(s=!1),s&&(t=i),o++}return{ops:r,steps:m,final:t}}function K(p,m){const s=[];for(let h=0;h<p;h++){const l=$(h*1.8+h*.8,0),d=$(l.x+1.8,0),e=$(d.x,1.5),g=$(l.x,1.5),c=m[h],b=V(l,d,e,g);if(c&&c.bg&&(b.couleurDeRemplissage=j(c.bg),b.opaciteDeRemplissage=1),s.push(b),c&&c.v){const x=q(`${c.v}`,(l.x+d.x)/2,(l.y+g.y)/2,{color:"red",backgroundColor:"none",letterSize:k.isHtml?"small":"normalsize",orientation:0,opacity:1});s.push(x)}if(h>0){const x=B(l.x-.8,.75,l.x,.75,"#f15929");x.styleExtremites="->",s.push(x)}}const i=-.5,u=-.5,n=1.8*p+.8*(p-1)+.5,a=1.5+.5;return I({xmin:i,ymin:u,xmax:n,ymax:a,mainlevee:!1,scale:k.isHtml?1:.5,style:"margin: auto",optionsTikz:["baseline=(current bounding box.north)"]},s)}function U(p,m,t,r,o={}){var u;let s=`\\begin{tabularx}{0.9\\linewidth}
  {|>{\\cellcolor{lightgray}}c|
  ${o.firstColHeaderWidth?`>{\\centering \\arraybackslash}p{${o.firstColHeaderWidth}}|`:">{\\centering \\arraybackslash}X|"}
  *{${m-1}}{>{\\centering \\arraybackslash}X|}}\\hline
`;o.formule&&(s+=`\\multicolumn{1}{|l}{${o.formuleCellule}}&\\multicolumn{1}{r|}{‚ñº}&\\multicolumn{${m-1}}{l|}{${o.formuleTexte}}\\\\ \\hline
`),s+="\\rowcolor{lightgray} &";const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<m-1;n++)s+=`\\textbf{\\sffamily ${i[n]}}  & `;s+=`\\textbf{\\sffamily ${i[m-1]}} \\\\ \\hline
`;for(let n=0;n<p;n++){const a=t[n]||{};s+=`\\textbf{\\sffamily ${n+1}} &`;for(let h=0;h<m;h++){const l=a[h]||{},d=r[l.s??""]||{};let e="";(u=d.bg)!=null&&u.startsWith("#")?e=`\\cellcolor[HTML]{${d.bg.replace("#","")}}`:d.bg&&(e=`\\cellcolor{${d.bg}}`),(l==null?void 0:l.t)===1?s+=`\\raggedright ${e} ${l.v||""}  &`:(l==null?void 0:l.t)===2?s+=`\\raggedleft ${e} ${l.v||""}  &`:(l==null?void 0:l.t)===3?s+=`\\centering ${e} ${l.v?"VRAI":"FAUX"}  &`:s+=`${e} ${l.v||""}  &`}s=s.slice(0,-1),s+=`\\\\ \\hline
`}return s+=`\\end{tabularx}
`,s}export{dt as dateDePublication,A as default,ht as interactifReady,pt as interactifType,gt as refs,mt as titre,ft as uuid};
//# sourceMappingURL=6I1B-4-Cc5rEPlq.js.map

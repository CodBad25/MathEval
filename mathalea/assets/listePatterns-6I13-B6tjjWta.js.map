{"version":3,"file":"listePatterns-6I13-B6tjjWta.js","sources":["../../src/exercices/profs/listePatterns-6I13.ts"],"sourcesContent":["import Decimal from 'decimal.js'\nimport { isNumber } from 'mathjs'\nimport {\n  cubeDef,\n  faceLeft,\n  faceRight,\n  faceTop,\n  project3dIso,\n  shapeCubeIso,\n  updateCubeIso,\n} from '../../lib/2d/figures2d/Shape3d'\nimport {\n  listeShapes2DInfos,\n  shapeNames,\n  type ShapeName,\n} from '../../lib/2d/figures2d/shapes2d'\nimport { VisualPattern } from '../../lib/2d/patterns/VisualPattern'\nimport { VisualPattern3D } from '../../lib/2d/patterns/VisualPattern3D'\nimport {\n  listePatternAffineOuLineaire,\n  type PatternRiche,\n  type PatternRiche3D,\n} from '../../lib/2d/patterns/patternsPreDef'\nimport { point } from '../../lib/2d/points'\nimport { polygone } from '../../lib/2d/polygones'\nimport { texteParPosition } from '../../lib/2d/textes'\nimport { bleuMathalea } from '../../lib/colors'\nimport { choice } from '../../lib/outils/arrayOutils'\nimport {\n  miseEnEvidence,\n  texteEnCouleurEtGras,\n} from '../../lib/outils/embellissements'\nimport {\n  fixeBordures,\n  mathalea2d,\n  type NestedObjetMathalea2dArray,\n} from '../../modules/2dGeneralites'\nimport { context } from '../../modules/context'\nimport { randint } from '../../modules/outils'\nimport Exercice from '../Exercice'\n\nexport const titre = \"Liste des patterns disponibles pour l'exercice 6I13\"\nexport const dateDePublication = '23/07/2025'\n\nexport const refs = {\n  'fr-fr': ['P023-6I13'],\n  'fr-ch': [],\n}\nexport const uuid = '71ff5'\n\n/**\n * Affiche les patterns propres à l'exercice 6I13\n * @author Eric Elter (sur la base de listePatterns de Jean-Claude Lhote)\n\n */\nexport default class ListePatternsPreDef6I13 extends Exercice {\n  destroyers: (() => void)[] = []\n\n  constructor() {\n    super()\n    this.nbQuestions = 1\n    this.listePackages = ['twemojis'] // this.listePackages est inutile mais la présence du mot \"twemojis\" est indispensable pour la sortie LaTeX.\n    this.nbQuestionsModifiable = false\n    this.besoinFormulaire3Numerique = ['Nombre de motifs par pattern', 6]\n    this.sup3 = 4\n    this.comment = `Cette page affiche la liste des patterns disponibles dans 6I13 avec leur numéro de référence et pour information, le nombre d'éléments \n    pour le motif 43 ainsi que le nombre d'éléments au rang n de chaque pattern.<br>`\n  }\n\n  destroy() {\n    // MGu quan l'exercice est supprimé par svelte : bouton supprimé\n    this.destroyers.forEach((destroy) => destroy())\n    this.destroyers.length = 0\n  }\n\n  nouvelleVersion(): void {\n    // MGu quand l'exercice est modifié, on détruit les anciens listeners\n    this.destroyers.forEach((destroy) => destroy())\n    this.destroyers.length = 0\n    this.sup3 = Math.max(2, this.sup3) // On ne peut pas afficher moins de 2 motifs\n    const listePatternReference = listePatternAffineOuLineaire.filter(\n      (p) =>\n        p.fonctionRatio == null &&\n        p.fonctionFraction == null &&\n        (!('shapes' in p) || p.shapes.length === 1),\n    )\n    const listeOfAll: (PatternRiche | PatternRiche3D)[] = [\n      ...listePatternReference,\n    ]\n\n    let texte = ''\n    // @todo ne pas coller toutes les def dans le fichier tex mais seulement celles utilisées !\n    if (!context.isHtml) {\n      texte += `${Object.values(listeShapes2DInfos)\n        .map((shape) => shape.shapeDef.tikz())\n        .join('\\n')}\\n`\n    }\n    if (listeOfAll == null || listeOfAll.length === 0) return\n    for (let i = 0; i < listeOfAll.length; i++) {\n      const pat = listeOfAll[i]\n      if (pat == null) {\n        texte += `\\n${texteEnCouleurEtGras(`Pattern ${i + 1}`, 'red')}: ${texteEnCouleurEtGras('Pattern inexistant', 'red')}`\n        continue\n      }\n\n      if ('nbMotifMin' in pat && isNumber(pat.nbMotifMin)) {\n        // On est en présence d'un motif répétitif\n        const objets: NestedObjetMathalea2dArray = []\n        if ('shapes' in pat) {\n          for (const shape of pat.shapes) {\n            if (shape in listeShapes2DInfos) {\n              objets.push(listeShapes2DInfos[shape].shapeDef)\n            }\n          }\n        }\n\n        for (let j = 0; j <= pat.nbMotifMin; j++) {\n          const pattern = new VisualPattern([])\n\n          if ('shapes' in pat) pattern.shapes = pat.shapes\n          if ('iterate' in pat) pattern.iterate = pat.iterate\n          objets.push(pattern.render(j, j + 1, 0))\n        }\n        texte += `\\n${texteEnCouleurEtGras(`Pattern ${i + 1}`, 'blue')}:  <br>`\n        texte += mathalea2d(\n          Object.assign(\n            fixeBordures(objets, { rxmin: 0, rymin: -1, rxmax: 0, rymax: 1 }),\n            { pixelsParCm: 20, scale: 0.4, optionsTikz: 'transform shape' },\n          ),\n          objets,\n        )\n      } else {\n        const n43 = !('nbMotifMin' in pat)\n          ? new Decimal(pat.fonctionNb(43)).toString()\n          : null\n        const infosShape =\n          pat.shapes[0] in listeShapes2DInfos\n            ? listeShapes2DInfos[pat.shapes[0]]\n            : { articleCourt: 'de ', nomPluriel: 'cubes' }\n\n        const nom = infosShape.nomPluriel\n\n        texte += `${texteEnCouleurEtGras(`Pattern ${i + 1}`, 'blue')}:<br> Pour le motif 43, il y a ${n43} ${nom}.<br>`\n        texte += `Pour le motif $${miseEnEvidence('n', bleuMathalea)}$, il y a $${miseEnEvidence(pat.formule, bleuMathalea)}$ éléments.<br>`\n\n        const patternRiche = pat\n        const pattern =\n          'iterate3d' in patternRiche\n            ? new VisualPattern3D({\n                initialCells: [],\n                type: 'iso',\n                prefixId: `Ex${this.numeroExercice}Q${i}`,\n                shapes: ['cube'],\n              })\n            : new VisualPattern([])\n        if (pattern instanceof VisualPattern3D) {\n          pattern.shapes = ['cube']\n          pattern.iterate3d = (patternRiche as PatternRiche3D).iterate3d\n        } else {\n          pattern.shapes =\n            (patternRiche as PatternRiche).shapes ||\n            (shapeNames[randint(0, shapeNames.length - 1)] as ShapeName)\n          pattern.iterate = (patternRiche as PatternRiche).iterate\n        }\n\n        const angle = Math.PI / 2.5\n        let yMax = 0\n        let yMin = 0\n\n        const figures: NestedObjetMathalea2dArray[] = []\n        for (let j = 0; j < this.sup3; j++) {\n          figures[j] = []\n          let objets: NestedObjetMathalea2dArray = []\n          let ymin = Infinity\n          let ymax = -Infinity\n          let xmin = Infinity\n          let xmax = -Infinity\n          if (context.isHtml) {\n            for (let n = 0; n < pattern.shapes.length; n++) {\n              let name = pattern.shapes[n]\n              if (name in listeShapes2DInfos) {\n                if (name === 'carré') {\n                  const nom = String(choice(Object.keys(listeShapes2DInfos)))\n                  name = nom\n                  pattern.shapes[n] = nom\n                  figures[j].push(listeShapes2DInfos[nom].shapeDef)\n                } else figures[j].push(listeShapes2DInfos[name].shapeDef)\n              } else if (name === 'cube') {\n                const cubeIsoDef = cubeDef(`cubeIsoQ${i}F${j}`, 1)\n                cubeIsoDef.svg = function (coeff: number): string {\n                  return `\n          <defs>\n            <g id=\"cubeIsoQ${i}F${j}\">\n              ${faceTop(angle)}\n              ${faceLeft(angle)}\n              ${faceRight(angle)}\n            </g>\n          </defs>`\n                }\n                figures[j].push(cubeIsoDef)\n              } else {\n                console.warn(\n                  `Shape ${name} n'est pas dans listeShapesDef ou emojis et n'est pas un cube`,\n                )\n              }\n            }\n          }\n          if (pattern instanceof VisualPattern3D) {\n            if (pattern.shape == null) {\n              pattern.shape = shapeCubeIso(`cubeIsoQ${i}F${j}`, 1, 1, {\n                scale: 1,\n              })\n            }\n            if (context.isHtml) {\n              const listeners = updateCubeIso({ pattern, i, j, angle })\n              if (listeners) this.destroyers.push(listeners)\n              pattern.shape.codeSvg = `<use href=\"#cubeIsoQ${i}F${j}\"></use>`\n              const cells = (pattern as VisualPattern3D).update3DCells(j + 1)\n              // Ajouter les SVG générés par svg() de chaque objet\n              cells.forEach((cell) => {\n                const scale = 1\n                const [px, py] = project3dIso(cell[0], cell[1], cell[2], angle)\n                const obj = shapeCubeIso(`cubeIsoQ${i}F${j}`, px, py, { scale })\n                obj.x = px / 20\n                obj.y = -py / 20\n                objets.push(obj)\n                ymin = Math.min(ymin, obj.y * scale)\n                ymax = Math.max(ymax, (obj.y + 1) * scale)\n                xmin = Math.min(xmin, obj.x * scale)\n                xmax = Math.max(xmax, (obj.x + 1) * scale)\n              })\n            } else {\n              objets = [\n                cubeDef(`cubeIsoQ${i}F${j}`),\n                ...pattern.render(j + 1, 0, 0, Math.PI / 6),\n              ]\n              ;({ xmin, ymin, xmax, ymax } = fixeBordures(objets))\n            }\n          } else {\n            objets = pattern.render(j + 1, 0, 0)\n            ;({ xmin, ymin, xmax, ymax } = fixeBordures(objets))\n          }\n          figures[j].push(...objets)\n          figures[j].push(\n            texteParPosition(\n              `Motif ${j + 1}`,\n              (xmax + xmin) / 2,\n              -1.5,\n              0,\n              'black',\n              0.8,\n              'milieu',\n            ),\n          )\n          const cadre = polygone(\n            point(xmin - 2, -2),\n            point(xmax + 2, -2),\n            point(xmax + 2, ymax + 2),\n            point(xmin - 2, ymax + 2),\n          )\n          cadre.pointilles = 4\n          figures[j].push(cadre)\n\n          yMax = Math.max(yMax, ymax)\n          yMin = Math.min(yMin, ymin)\n        }\n        texte +=\n          figures\n            .map((fig, index) =>\n              mathalea2d(\n                Object.assign(\n                  fixeBordures(fig, {\n                    rxmin: 0,\n                    rymin: -1,\n                    rxmax: 0,\n                    rymax: 1,\n                  }),\n                  {\n                    id: `Motif${i}F${index}`,\n                    pixelsParCm: 20,\n                    yMax,\n                    yMin,\n                    scale: 0.5,\n                    style: 'display: inline-block',\n                    optionsTikz: 'transform shape',\n                  },\n                ),\n                fig,\n              ),\n            )\n            .join('\\n') + '<br>'\n      }\n    }\n    this.listeQuestions = [texte]\n  }\n}\n"],"names":["titre","dateDePublication","refs","uuid","ListePatternsPreDef6I13","Exercice","__publicField","destroy","listeOfAll","listePatternAffineOuLineaire","p","texte","context","listeShapes2DInfos","shape","i","pat","texteEnCouleurEtGras","isNumber","objets","j","pattern","VisualPattern","mathalea2d","fixeBordures","n43","Decimal","nom","miseEnEvidence","bleuMathalea","patternRiche","VisualPattern3D","shapeNames","randint","angle","yMax","yMin","figures","ymin","ymax","xmin","xmax","n","name","choice","cubeIsoDef","cubeDef","coeff","faceTop","faceLeft","faceRight","shapeCubeIso","listeners","updateCubeIso","cell","px","py","project3dIso","obj","texteParPosition","cadre","polygone","point","fig","index"],"mappings":"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"}
{"version":3,"mappings":";oiBA2BO,MAAMA,GAAqB,SAEhCC,EACAC,EACAC,EAAqC,GAC3B,CACVA,EAAQ,UAAYA,EAAQ,WAAa,EACzCA,EAAQ,UAAYA,EAAQ,WAAa,GACzCA,EAAQ,OAASA,EAAQ,QAAU,IACnCA,EAAQ,cAAgBA,EAAQ,eAAiB,KAAK,cACtDA,EAAQ,cAAgBA,EAAQ,eAAiB,KAAK,cACtDA,EAAQ,YAAcA,EAAQ,aAAe,GAC7C,MAAMC,EAAIC,EAAOJ,EAAGC,CAAC,EACfI,EAAKC,EAASN,EAAGG,EAAG,GAAG,EACvBI,EAAIC,EAAgBL,EAAGE,EAAIH,EAAQ,SAAS,EAC5CO,EAAID,EAAgBL,EAAGE,EAAIH,EAAQ,SAAS,EAClD,KAAK,gBACL,KAAK,eAAeF,EAAGE,CAAO,EAC9B,IAAIQ,EAAMC,EAAMC,EAAMC,EAyEtB,GAxEIX,EAAQ,YAAc,GAAKA,EAAQ,WAErC,KAAK,cAAcY,EAASd,EAAGO,CAAC,EAAG,CACjC,QAASL,EAAQ,QACjB,KAAMA,EAAQ,QACf,EACDQ,EAAO,KAAK,2BAA2BV,EAAGO,EAAG,CAC3C,MAAOL,EAAQ,MACf,QAASA,EAAQ,cACjB,KAAMA,EAAQ,KACd,QAASA,EAAQ,QACjB,MAAOA,EAAQ,MAChB,EACDS,EAAO,KAAK,2BAA2BX,EAAGS,EAAG,CAC3C,MAAOP,EAAQ,MACf,QAASA,EAAQ,cACjB,KAAMA,EAAQ,KACd,QAASA,EAAQ,QACjB,MAAOA,EAAQ,MAChB,EACDW,EAAO,KAAK,2BAA2BZ,EAAGQ,EAAG,CAC3C,MAAOP,EAAQ,MACf,QAASA,EAAQ,cACjB,KAAMA,EAAQ,KACd,QAASA,EAAQ,QACjB,MAAOA,EAAQ,MAChB,EACDU,EAAO,KAAK,2BAA2BX,EAAGM,EAAG,CAC3C,MAAOL,EAAQ,MACf,QAASA,EAAQ,cACjB,KAAMA,EAAQ,KACd,QAASA,EAAQ,QACjB,MAAOA,EAAQ,MAChB,IAED,KAAK,cAAcY,EAASd,EAAGO,CAAC,EAAGL,CAAO,EAC1CQ,EAAO,KAAK,2BAA2BV,EAAGO,EAAG,CAC3C,MAAOL,EAAQ,MACf,QAASA,EAAQ,cACjB,KAAMA,EAAQ,KACd,QAASA,EAAQ,QACjB,MAAOA,EAAQ,MAChB,EACDS,EAAO,KAAK,2BAA2BV,EAAGM,EAAG,CAC3C,MAAOL,EAAQ,MACf,QAASA,EAAQ,cACjB,KAAMA,EAAQ,KACd,QAASA,EAAQ,QACjB,MAAOA,EAAQ,MAChB,EACDU,EAAO,KAAK,2BAA2BX,EAAGQ,EAAG,CAC3C,MAAOP,EAAQ,MACf,QAASA,EAAQ,cACjB,KAAMA,EAAQ,KACd,QAASA,EAAQ,QACjB,MAAOA,EAAQ,MAChB,EACDW,EAAO,KAAK,2BAA2Bb,EAAGS,EAAG,CAC3C,MAAOP,EAAQ,MACf,QAASA,EAAQ,cACjB,KAAMA,EAAQ,KACd,QAASA,EAAQ,QACjB,MAAOA,EAAQ,MAChB,GAEH,KAAK,gBACDK,EAAE,GAAKE,EAAE,EACX,KAAK,YAAYF,EAAGE,EAAGP,CAAO,EAE9B,KAAK,YAAYO,EAAGF,EAAGL,CAAO,EAEhC,KAAK,eACDA,EAAQ,YAAa,CACvB,MAAMa,EAAU,KAAK,cAAcf,EAAGG,EAAG,CACvC,OAAQD,EAAQ,OAChB,QAASA,EAAQ,cACjB,MAAOA,EAAQ,MAChB,EACKc,EAAU,KAAK,cAAcb,EAAGF,EAAG,CACvC,OAAQC,EAAQ,OAChB,QAASA,EAAQ,cACjB,MAAOA,EAAQ,MAChB,EACKe,EAAc,KAAK,iBAAiBjB,EAAGG,EAAGE,EAAI,CAClD,QAASH,EAAQ,cACjB,MAAOA,EAAQ,MACf,QAASA,EAAQ,QAClB,EACD,MAAO,CAACQ,EAAMC,EAAMC,EAAMC,EAAME,EAASC,EAAS,GAAGC,CAAW,CAClE,KACE,OAAO,CAACP,EAAMC,EAAMC,EAAMC,CAAI,CAElC,EAOaK,GAAyB,SAEpClB,EACAC,EACAkB,EAAS,IACT,CACA,MAAMhB,EAAIC,EAAOJ,EAAGC,CAAC,EACrB,KAAK,eACL,KAAK,cAAcD,CAAC,EACpB,KAAK,cAAcC,CAAC,EACpB,KAAK,gBACL,MAAMI,EAAKC,EAASN,EAAGG,EAAG,GAAG,EACvBiB,EAAKd,EAASN,EAAGG,EAAG,EAAE,EACtBI,EAAIC,EAAgBL,EAAGE,EAAI,EAAG,EAC9BI,EAAID,EAAgBL,EAAGiB,EAAI,EAAG,EAChC,KAAK,EAAEb,CAAC,EAAI,KAAK,EAAEE,CAAC,EACtB,KAAK,MAAMN,EAAGI,CAAC,EAEf,KAAK,MAAMJ,EAAGM,CAAC,EAEjB,KAAK,eACD,KAAK,EAAET,CAAC,EAAI,KAAK,EAAEC,CAAC,GACtB,KAAK,gBAAgBD,CAAC,EACtB,KAAK,iBACL,KAAK,gBAAgBC,CAAC,IAEtB,KAAK,gBAAgBA,CAAC,EACtB,KAAK,iBACL,KAAK,gBAAgBD,CAAC,GAExB,KAAK,gBAAgBG,CAAC,EACtB,KAAK,eAAeA,CAAC,EACrB,KAAK,MAAMA,EAAGE,CAAE,EAChB,KAAK,iBACL,KAAK,YAAYA,EAAIe,CAAE,EACvB,KAAK,eACL,KAAK,cAAcpB,EAAGG,EAAG,CAAE,OAAAgB,EAAQ,EACnC,KAAK,cAAchB,EAAGF,EAAG,CAAE,OAAAkB,EAAQ,EACnC,KAAK,iBAAiBnB,EAAGG,EAAGE,CAAE,CAChC,EAQagB,GAAU,SAErBrB,EACAC,EACAqB,EACAH,EAAS,GACT,CACA,MAAMI,EAAIC,EAAOxB,EAAGC,CAAC,EACrBsB,EAAE,UAAY,GACd,MAAME,EAAIC,EAAgBJ,EAAGC,CAAC,EAC9B,IAAII,EAAGC,EACH,KAAK,EAAE5B,CAAC,EAAI,KAAK,EAAEC,CAAC,GACtB0B,EAAI3B,EACJ4B,EAAI3B,IAEJ0B,EAAI1B,EACJ2B,EAAI5B,IAEF,KAAK,EAAEyB,CAAC,EAAI,KAAK,EAAEE,CAAC,GAAK,KAAK,EAAEF,CAAC,EAAI,KAAK,EAAEG,CAAC,KAC3C,KAAK,EAAEH,CAAC,EAAI,KAAK,EAAEE,CAAC,GAEtB,KAAK,sBAAsBC,EAAGD,EAAG,CAC/B,SAAUb,EAASa,EAAGF,CAAC,EAAI,EAC3B,WAAY,GACZ,QAAS,MACV,EAEC,KAAK,EAAEA,CAAC,EAAI,KAAK,EAAEG,CAAC,GAEtB,KAAK,sBAAsBD,EAAGC,EAAG,CAC/B,SAAUd,EAASc,EAAGH,CAAC,EAAI,EAC3B,WAAY,GACZ,QAAS,MACV,EAEH,KAAK,gBAEH,KAAK,EAAEzB,CAAC,EAAI,KAAK,EAAEC,CAAC,GACtB,KAAK,gBAAgBD,CAAC,EACtB,KAAK,iBACL,KAAK,gBAAgBC,CAAC,IAEtB,KAAK,gBAAgBA,CAAC,EACtB,KAAK,iBACL,KAAK,gBAAgBD,CAAC,GAExB,KAAK,gBAAgByB,CAAC,EACtB,KAAK,gBACL,KAAK,eAAeA,CAAC,EACrB,KAAK,MAAMA,EAAGH,EAAG,CAAE,UAAW,EAAG,QAAS,MAAO,EACjD,KAAK,iBACDH,GACF,KAAK,iBAAiBnB,EAAGyB,EAAGH,EAAG,CAAE,UAAW,EAAG,QAAS,MAAO,EAEjE,KAAK,eACP,EAQaO,GAAU,SAErB7B,EACAC,EACAqB,EACApB,EAAwB,GACxB,CACAA,EAAQ,OAASA,EAAQ,QAAU,IACnCA,EAAQ,UAAYA,EAAQ,WAAa,EACzCA,EAAQ,QAAUA,EAAQ,SAAW,QACrC,MAAMC,EAAIC,EAAOJ,EAAGC,CAAC,EACrB,KAAK,aAAaD,EAAGE,CAAO,EAC5B,KAAK,cAAcD,EAAGC,CAAO,EAC7B,KAAK,gBACL,MAAMG,EAAKC,EAASN,EAAGG,EAAG,GAAG,EACvBiB,EAAKd,EAASN,EAAGG,EAAG,EAAE,EACtBI,EAAIC,EAAgBL,EAAGE,EAAI,EAAG,EAC9BI,EAAID,EAAgBL,EAAGiB,EAAI,EAAG,EAChCb,EAAE,EAAIE,EAAE,EACV,KAAK,MAAMN,EAAGI,EAAGL,CAAO,EAExB,KAAK,MAAMC,EAAGM,EAAGP,CAAO,EAE1B,KAAK,aAAaC,EAAGmB,EAAGpB,CAAO,EAC3BA,EAAQ,SACV,KAAK,cAAcF,EAAGG,EAAGD,CAAO,EAChC,KAAK,cAAcC,EAAGF,EAAGC,CAAO,EAEpC,EAea4B,GAAsB,SAEjC9B,EACAC,EACAqB,EACApB,EAAiC,GACjC,CACAA,EAAQ,OAASA,EAAQ,QAAU,IACnCA,EAAQ,YAAcA,EAAQ,aAAe,EAC7CA,EAAQ,6BACNA,EAAQ,8BAAgC,GAC1CA,EAAQ,SAAWA,EAAQ,UAAYY,EAASb,EAAGD,CAAC,EACpDE,EAAQ,UAAYA,EAAQ,WAAa,EACzC,MAAM6B,EAAKvB,EAAgBP,EAAGD,EAAGE,EAAQ,WAAW,EAC9C8B,EAAKxB,EAAgBP,EAAGqB,EAAGpB,EAAQ,WAAW,EAC9C+B,EAAQC,EAAalC,EAAGC,EAAGqB,CAAC,EAC5Bf,EAAID,EAASL,EAAG8B,EAAI,EAAE,IAAME,EAAM,EAClCvB,EAAO,KAAK,2BAA2BT,EAAG8B,EAAI7B,CAAO,EACrDS,EAAO,KAAK,2BAA2BV,EAAG+B,EAAI9B,CAAO,EACrDU,EAAO,KAAK,2BAA2BmB,EAAIxB,EAAGL,CAAO,EACrDW,EAAO,KAAK,2BAA2BmB,EAAIzB,EAAGL,CAAO,EAC3D,YAAK,gBACL,KAAK,4BAA4BD,EAAGM,EAAGL,CAAO,EAC9C,KAAK,eACL,KAAK,gBACDA,EAAQ,SACV,KAAK,YAAYF,EAAGC,EAAGM,EAAGL,CAAO,EACjC,KAAK,YAAYK,EAAGN,EAAGqB,EAAGpB,CAAO,GAE/BA,EAAQ,+BACV,KAAK,aAAaQ,CAAI,EACtB,KAAK,aAAaC,CAAI,EACtB,KAAK,aAAaC,CAAI,EACtB,KAAK,aAAaC,CAAI,GAEjB,CAAE,KAAAH,EAAM,KAAAC,EAAM,KAAAC,EAAM,KAAAC,CAAA,CAC7B,EAaasB,GAAoB,SAE/BnC,EACAC,EACAqB,EACApB,EAAuC,GACvC,CACAA,EAAQ,kBACNA,EAAQ,mBAAqBA,EAAQ,SAAW,KAAK,QACvDA,EAAQ,cACNA,EAAQ,eAAiBA,EAAQ,SAAW,KAAK,QACnDA,EAAQ,OAASA,EAAQ,QAAU,IACnC,MAAMkC,EAAK,KAAK,mBAAmBpC,EAAGC,EAAGC,CAAO,EAChD,KAAK,aAAakC,EAAG,CAAC,CAAC,EACvB,KAAK,aAAaA,EAAG,CAAC,CAAC,EACvB,KAAK,aAAaA,EAAG,CAAC,CAAC,EACvB,KAAK,aAAaA,EAAG,CAAC,CAAC,EACvBlC,EAAQ,OAAS,KACjB,MAAMmC,EAAK,KAAK,mBAAmBpC,EAAGqB,EAAGpB,CAAO,EAChD,KAAK,aAAamC,EAAG,CAAC,CAAC,EACvB,KAAK,aAAaA,EAAG,CAAC,CAAC,EACvB,KAAK,aAAaA,EAAG,CAAC,CAAC,EACvB,KAAK,aAAaA,EAAG,CAAC,CAAC,EACvBnC,EAAQ,OAAS,MACjB,MAAMoC,EAAK,KAAK,mBAAmBtC,EAAGsB,EAAGpB,CAAO,EAChD,KAAK,aAAaoC,EAAG,CAAC,CAAC,EACvB,KAAK,aAAaA,EAAG,CAAC,CAAC,EACvB,KAAK,aAAaA,EAAG,CAAC,CAAC,EACvB,KAAK,aAAaA,EAAG,CAAC,CAAC,EACvB,MAAMnC,EAAIoC,GAAwBvC,EAAGC,EAAGqB,CAAC,EACzCpB,EAAQ,QAAUA,EAAQ,cAC1B,KAAK,wBAAwBC,EAAGH,EAAGE,CAAO,CAC5C,ECzVasC,GAAsC,SAEjDxC,EACAC,EACAqB,EACApB,EACA,CACA,IAAIyB,EAAGC,EAAGa,EAGNzC,EAAE,EAAIC,EAAE,GACV0B,EAAI3B,EACJ4B,EAAI3B,IAEJ0B,EAAI1B,EACJ2B,EAAI5B,GAEN,MAAMuB,EAAIC,EAAOxB,EAAGC,CAAC,EACfwB,EAAIC,EAAgBJ,EAAGC,CAAC,EAC1BE,EAAE,EAAIG,EAAE,EACVa,EAAKjC,EAAgBiB,EAAGG,EAAG,EAAE,EACpBH,EAAE,EAAIG,EAAE,EACjBa,EAAKjC,EAAgBiB,EAAGG,EAAG,CAAC,EAE5Ba,EAAKjC,EAAgBiB,EAAGE,EAAG,CAAC,EAE9B,MAAMK,EAAKN,EAAgBe,EAAIC,GAA0BpB,EAAGC,CAAC,CAAC,EAExDhB,EAAIC,EAAgBwB,EAAIV,EAAG,CAAC,EAmBlC,GAhBIG,EAAE,EAAIE,EAAE,GAAKb,EAASW,EAAGE,CAAC,EAAI,IAEhC,KAAK,sBAAsBC,EAAGD,EAAGzB,CAAO,EACxC,KAAK,aAAaA,CAAO,GAEvBuB,EAAE,EAAIG,EAAE,GAAKd,EAASW,EAAGG,CAAC,EAAI,GAEhC,KAAK,sBAAsBD,EAAGC,EAAG1B,CAAO,EAG1C,KAAK,eAAeuC,EAAIvC,CAAO,EAC3BK,EAAE,EAAIyB,EAAG,EACX,KAAK,gBAAgBT,EAAE,qBAAuB,GAAIrB,CAAO,EAEzD,KAAK,gBAAgBqB,EAAE,qBAAuB,GAAIrB,CAAO,EAEvDuC,EAAG,EAAIT,EAAG,EACR,KAAK,MAAM,YACb,KAAK,cAAcS,EAAI,OAAO,OAAO,GAAIvC,EAAS,CAAE,MAAO,EAAG,CAAC,EAC/D,KAAK,cAAc8B,EAAI,OAAO,OAAO,GAAI9B,EAAS,CAAE,MAAO,EAAG,CAAC,IAE/D,KAAK,cACHuC,EACA,OAAO,OAAO,GAAIvC,EAAS,CAAE,QAAS,IAAM,MAAO,EAAG,GAExD,KAAK,cACH8B,EACA,OAAO,OAAO,GAAI9B,EAAS,CAAE,KAAM,IAAM,MAAO,EAAG,QAGlD,CACL,MAAMyC,EAAMnC,EAAgBwB,EAAIS,EAAI,EAAE,EAClC,KAAK,MAAM,YACb,KAAK,cAAcE,EAAK,OAAO,OAAO,GAAIzC,EAAS,CAAE,MAAO,EAAG,CAAC,EAChE,KAAK,cAAcuC,EAAI,OAAO,OAAO,GAAIvC,EAAS,CAAE,MAAO,EAAG,CAAC,IAE/D,KAAK,cACHyC,EACA,OAAO,OAAO,GAAIzC,EAAS,CAAE,QAAS,IAAM,MAAO,EAAG,GAExD,KAAK,cACHuC,EACA,OAAO,OAAO,GAAIvC,EAAS,CAAE,KAAM,IAAM,MAAO,EAAG,GAErD,KAAK,eAET,CACA,KAAK,gBAAgB8B,EAAI9B,CAAO,EAChC,KAAK,gBACL,KAAK,eAAe8B,EAAI9B,CAAO,EAC/B,KAAK,OAAOK,EAAGL,CAAO,EACtB,KAAK,aAAaA,CAAO,EACzB,KAAK,eAAeA,CAAO,EAC3B,KAAK,cAAcA,CAAO,CAC5B,EASa0C,GAA4C,SAEvD5C,EACAC,EACAqB,EACApB,EAAyB,GACzB,CACA,MAAM2C,EAAgB,KAAK,MAAM,SAC3BC,EAAc,KAAK,QAAQ,KAC3BvB,EAAIC,EAAOxB,EAAGC,CAAC,EACrBsB,EAAE,IAAM,IAAIvB,EAAE,GAAG,GAAGC,EAAE,GAAG,IACzB,IAAI8C,EAGJ,GAFI/C,EAAE,MAAQ,SAAWA,EAAE,IAAM,KAC7BC,EAAE,MAAQ,SAAWA,EAAE,IAAM,KAC7BqB,EAAE,OAAOE,EAAOxB,EAAGC,CAAC,CAAC,EAAG,CAC1B,MAAMwB,EAAInB,EAASgB,EAAGA,EAAG,CAAC,EACpB0B,EAAKC,EAAgC3B,EAAGC,CAAC,EAC/CD,EAAI4B,EAAoBF,EAAIG,EAAO1B,EAAG,GAAG,CAAC,EAC1CsB,EAAO,GACT,KAAO,CACL,MAAMtB,EAAIC,EAAgBJ,EAAGC,CAAC,EAC9BwB,EAAOjC,EAASW,EAAGH,CAAC,EAAI,CAC1B,CACA,KAAK,YAAayB,EAAO,IAAO,IAAK7C,CAAO,EAC5C,KAAK,sBAAsB,KAAK,IAAI6C,EAAO,EAAG,EAAE,EAAG7C,CAAO,EAC1D,KAAK,uCAAuCqB,EAAGD,EAAGpB,CAAO,EACzD,KAAK,YAAY4C,EAAa5C,CAAO,EACrC,KAAK,sBAAsB2C,EAAe3C,CAAO,EACjD,KAAK,aAAaA,CAAO,EACzB,KAAK,eAAeA,CAAO,EAC3B,KAAK,cAAcA,CAAO,CAC5B,EASakD,GAAyC,SAEpD7B,EACA8B,EACAnD,EAAyB,GACzB,CACA,GAAKmD,EAAE,OAAO9B,CAAC,EA+CR,CACL,MAAME,EAAI4B,EACJ/B,EAAI6B,EAAOE,EAAG,CAAC,EACfrD,EAAIsD,EAAe/B,EAAG,IAAM,EAC5BtB,EAAIqD,EAAe/B,EAAG,GAAK,EAC3BgC,EAAsBL,EAAoB3B,EAAGD,CAAC,EACpD,IAAIkC,EAAKlD,EAASiD,EAAqBF,EAAG,EAAE,EACxCG,EAAG,EAAIH,EAAE,MAAQ/C,EAASkD,EAAIH,EAAG,GAAG,GACxC,MAAMI,EAAQvB,EAAawB,EAAM,IAAOjC,EAAE,CAAC,EAAGA,EAAGxB,CAAC,EAC9CC,EAAQ,aACV,KAAK,cACH,iEAAiEqB,EAAE,GAAG,gCAAgC8B,EAAE,GAAG,IAC3G,EACA,GACA,CAAE,QAAS,YAAY,EAE3B,KAAK,gBAAgBI,EAAOvD,CAAO,EACnC,KAAK,eAAeuB,EAAGvB,CAAO,EAC1BA,EAAQ,aACV,KAAK,cACH,kEACA,EACA,IACA,CAAE,QAAS,YAAY,EAE3B,KAAK,cAAcsD,EAAItD,CAAO,EAC9B,KAAK,OAAOuB,EAAGvB,CAAO,EACtB,KAAK,eAAeA,CAAO,EACvBA,EAAQ,aACV,KAAK,cACH,qCAAqCqB,EAAE,GAAG,eAC1C,EACA,IACA,CAAE,QAAS,YAAY,EAE3B,KAAK,aAAaiC,EAAItD,CAAO,EAC7B,KAAK,cAAcuD,EAAQ,GAAIvD,CAAO,EACtC,KAAK,eAAesD,EAAItD,CAAO,EAC/B,KAAK,OAAOI,EAASkD,EAAI/B,EAAG,GAAG,EAAGvB,CAAO,EACrCA,EAAQ,aACV,KAAK,cAAc,0BAA2B,EAAG,IAAK,CACpD,QAAS,YACV,EACH,KAAK,aAAaA,CAAO,EACzB,KAAK,iBAAiBF,EAAGyB,EAAG+B,EAAItD,CAAO,CACzC,KA5FkB,CAChB,MAAMuB,EAAIC,EAAgB2B,EAAG9B,CAAC,EACxBvB,EAAIM,EAAS+C,EAAG5B,EAAG,EAAE,EACrBxB,EAAIK,EAASN,EAAGyB,EAAG,GAAG,EACtB+B,EAAKG,EAAWN,EAAG5B,EAAG,GAAG,EACzBgC,EAAQvB,EAAawB,EAAM,IAAOjC,EAAE,CAAC,EAAGA,EAAGxB,CAAC,EAC9CC,EAAQ,aACV,KAAK,cACH,iEAAiEqB,EAAE,GAAG,0DAA0D8B,EAAE,GAAG,IACrI,EACA,GACA,CAAE,QAAS,YAAY,EAE3B,KAAK,gBAAgBI,EAAOvD,CAAO,EACnC,KAAK,eAAeuB,EAAGvB,CAAO,EAC1BA,EAAQ,aACV,KAAK,cACH,uDAAuDmD,EAAE,GAAG,GAC5D,EACA,IACA,CAAE,QAAS,YAAY,EAE3B,KAAK,cAAcA,EAAGnD,CAAO,EAC7B,KAAK,OAAOuB,EAAGvB,CAAO,EACtB,KAAK,eAAeA,CAAO,EACvBA,EAAQ,aACV,KAAK,cACH,qCAAqCqB,EAAE,GAAG,eAC1C,EACA,IACA,CAAE,QAAS,YAAY,EAE3B,KAAK,aAAaiC,EAAItD,CAAO,EAC7B,KAAK,cAAcuD,EAAQ,GAAIvD,CAAO,EACtC,KAAK,eAAesD,EAAItD,CAAO,EAC/B,KAAK,OAAOI,EAASkD,EAAI/B,EAAG,GAAG,EAAGvB,CAAO,EACrCA,EAAQ,aACV,KAAK,cAAc,0BAA2B,EAAG,IAAK,CACpD,QAAS,YACV,EACH,KAAK,aAAaA,CAAO,EACzB,KAAK,iBACHF,EACAyB,EACA4B,EACA,OAAO,OAAO,GAAInD,EAAS,CAAE,cAAe,MAAO,EAEvD,CA8CF,EAOa0D,GAA8C,SAEzDrC,EACAsC,EACA3D,EAAyB,GACzB,CACA,MAAMF,EAAIsD,EAAe/B,EAAGsC,EAAG,GAAG,EAC5B5D,EAAIqD,EAAe/B,EAAGsC,EAAI,CAAC,EAC3BC,EAAKxD,EAASL,EAAGD,EAAG,EAAE,EACtB+D,EAAKzD,EAASwD,EAAI9D,EAAG,GAAG,EAC1BuB,EAAE,MAAQ,SACZA,EAAE,IAAM,OAEV,KAAK,YAAY+B,EAAe/B,EAAG,GAAG,EAAG+B,EAAe/B,EAAG,EAAE,EAAGrB,CAAO,EACvE,KAAK,WAAWF,EAAGE,CAAO,EACtBA,EAAQ,aACV,KAAK,cACH,iEAAiEqB,EAAE,GAAG,IACtE,EACA,GACA,CAAE,QAAS,YAAY,EAE3B,KAAK,gBAAgBA,EAAE,qBAAsBrB,CAAO,EACpD,KAAK,eAAeD,EAAGC,CAAO,EAC1BA,EAAQ,aACV,KAAK,cACH,2DAA2DF,EAAE,GAAG,GAChE,EACA,IACA,CAAE,QAAS,YAAY,EAG3B,KAAK,gBAAgBA,EAAGE,CAAO,EAC3BA,EAAQ,aACV,KAAK,cACH,mEACA,EACA,IACA,CAAE,QAAS,YAAY,EAE3B,KAAK,cAAcF,EAAGE,CAAO,EAC7B,KAAK,OAAO4D,EAAI5D,CAAO,EACvB,KAAK,eAAeA,CAAO,EACvBA,EAAQ,aACV,KAAK,cACH,qCAAqCqB,EAAE,GAAG,eAC1C,EACA,IACA,CAAE,QAAS,YAAY,EAE3B,KAAK,cAAcA,EAAE,qBAAuB,GAAIrB,CAAO,EACvD,KAAK,aAAa4D,EAAI5D,CAAO,EAC7B,KAAK,eAAe4D,EAAI5D,CAAO,EAC/B,KAAK,OAAO6D,EAAI7D,CAAO,EACnBA,EAAQ,aACV,KAAK,cAAc,0BAA2B,EAAG,IAAK,CACpD,QAAS,YACV,EACH,KAAK,aAAaA,CAAO,EACzB,KAAK,iBAAiB4D,EAAI9D,EAAGC,EAAGC,CAAO,CACzC,EAOa8D,GAAwC,SAEnDzC,EACAsC,EACA3D,EAAyB,GACzB,CACA,MAAMF,EAAIsD,EAAe/B,EAAGsC,EAAG,GAAG,EAC5B5D,EAAIqD,EAAe/B,EAAGsC,EAAI,EAAG,GAAG,EAChCvC,EAAIgC,EAAe/B,EAAGsC,EAAI,EAAG,GAAG,EAChCC,EAAKG,EAAWhE,EAAGD,EAAG,GAAI,GAAG,EAC7B+D,EAAKE,EAAWhE,EAAGD,EAAG,IAAK,GAAG,EAChCuB,EAAE,MAAQ,SACZA,EAAE,IAAM,OAEV,KAAK,YAAY+B,EAAe/B,EAAG,GAAG,EAAG+B,EAAe/B,EAAG,EAAE,EAAGrB,CAAO,EACvE,KAAK,WAAWF,EAAGE,CAAO,EACtBA,EAAQ,aACV,KAAK,cACH,yFACA,EACA,GACA,CAAE,QAAS,YAAY,EAE3B,KAAK,qBAAqBF,EAAGC,EAAGC,CAAO,EACvC,KAAK,2BAA2BF,EAAGC,EAAG,CAAE,QAAS,YAAa,UAAW,EAAG,EAC5E,KAAK,2BAA2BD,EAAGsB,EAAG,CAAE,QAAS,YAAa,UAAW,EAAG,EACxEpB,EAAQ,aACV,KAAK,cACH,iEACA,EACA,IACA,CAAE,QAAS,YAAY,EAG3B,KAAK,qBAAqBD,EAAG6D,EAAI5D,CAAO,EACpCA,EAAQ,aACV,KAAK,cACH,8DACA,EACA,IACA,CAAE,QAAS,YAAY,EAE3B,KAAK,2BAA2BD,EAAG6D,EAAI,CAAE,QAAS,YAAa,UAAW,EAAG,EACzE5D,EAAQ,aACV,KAAK,cACH,2EACA,EACA,IACA,CAAE,QAAS,YAAY,EAE3B,KAAK,2BAA2BoB,EAAGwC,EAAI,CAAE,QAAS,YAAa,UAAW,EAAG,EAC7E,KAAK,cAAc5D,CAAO,EACtBA,EAAQ,aACV,KAAK,cACH,kGACA,EACA,IACA,CAAE,QAAS,YAAY,EAG3B,KAAK,cAAcqB,EAAE,qBAAuB,GAAIrB,CAAO,EACvD,MAAMgE,EAAMP,EAAWG,EAAI9D,EAAG,GAAG,EAC3BmE,EAAMR,EAAWI,EAAI/D,EAAG,GAAG,EACjC,KAAK,aAAakE,EAAKhE,CAAO,EAC9B,KAAK,cAAcgE,EAAKhE,CAAO,EAC/B,KAAK,OAAOiE,EAAKjE,CAAO,EACpBA,EAAQ,aACV,KAAK,cAAc,0BAA2B,EAAG,IAAK,CACpD,QAAS,YACV,EACH,KAAK,aAAaA,CAAO,EACzB,KAAK,iBAAiB4D,EAAI9D,EAAGC,EAAGC,CAAO,CACzC,EAOakE,GAA6B,SAExC7C,EACAvB,EACAE,EAAyB,GACzB,CACA,MAAMuB,EAAIC,EAAgB1B,EAAGuB,CAAC,EACxBtB,EAAIgE,EAAWjE,EAAGyB,EAAG,IAAK,IAAK,GAAG,EAClCH,EAAIqC,EAAW1D,EAAGwB,EAAG,IAAM,GAAG,EAC9BG,EAAItB,EAASN,EAAGyB,EAAG,GAAG,EACtBqC,EAAKH,EAAW3D,EAAGyB,EAAG,GAAG,EACzBsC,EAAKJ,EAAW3D,EAAGyB,EAAG,IAAI,EAC5BF,EAAE,MAAQ,KACZA,EAAE,IAAM,OAENvB,EAAE,MAAQ,KACZA,EAAE,IAAM,KAEV,KAAK,YAAYsD,EAAe/B,EAAG,GAAG,EAAG+B,EAAe/B,EAAG,EAAE,EAAGrB,CAAO,EACvE,KAAK,WACHqB,EAAE,IACF8C,EAAYf,EAAe/B,EAAG,CAAC,EAAG+C,EAAQ,EAAG,GAAI,CAAC,EAClDpE,CAAA,EAEF,KAAK,WAAWF,EAAGE,CAAO,EACtBA,EAAQ,aACV,KAAK,cACH,+CAA+CqB,EAAE,GAAG,IACpD,EACA,GACA,CAAE,QAAS,YAAa,MAAO,GAAG,EAEtC,KAAK,MAAQ,GACb,KAAK,WAAWtB,EAAGC,CAAO,EAC1B,KAAK,WAAWoB,EAAGpB,CAAO,EACtBA,EAAQ,aACV,KAAK,cACH,4FAA4FF,EAAE,GAAG,IACjG,EACA,KACA,CAAE,QAAS,YAAa,MAAO,GAAG,EAEtC,KAAK,qBAAqBC,EAAGD,EAAGE,CAAO,EACvC,KAAK,2BACHD,EACA2B,EACA,OAAO,OAAO,GAAI1B,EAAS,CAAE,QAAS,YAAa,UAAW,EAAG,GAEnE,KAAK,qBAAqBoB,EAAGtB,EAAGE,CAAO,EACvC,KAAK,2BACHoB,EACAM,EACA,OAAO,OAAO,GAAI1B,EAAS,CAAE,QAAS,YAAa,UAAW,EAAG,GAE/DA,EAAQ,aACV,KAAK,cACH,gFAAgFF,EAAE,GAAG,kBAAkBuB,EAAE,GAAG,GAC5G,EACA,IACA,CAAE,QAAS,YAAa,MAAO,GAAG,EAEtC,KAAK,cAAcrB,CAAO,EACtBA,EAAQ,aACV,KAAK,cACH,kGACA,EACA,IACA,CAAE,QAAS,YAAa,MAAO,GAAG,EAEtC,KAAK,cAAcqB,EAAE,qBAAuB,GAAIrB,CAAO,EACvD,KAAK,aAAa4D,EAAI5D,CAAO,EAC7B,KAAK,cAAc4D,EAAI5D,CAAO,EAC9B,KAAK,OAAO6D,EAAI7D,CAAO,EACnBA,EAAQ,aACV,KAAK,cAAc,0BAA2B,EAAG,IAAK,CACpD,QAAS,YACT,MAAO,GACR,EACH,KAAK,aAAaA,CAAO,EACzB,KAAK,iBAAiB4D,EAAIrC,EAAGxB,EAAGC,CAAO,CACzC,EAUaqE,GAAkD,SAE7DvE,EACAC,EACAM,EACAiE,EACAtE,EAAyB,CAAE,YAAa,IACxC,CACAF,EAAE,IAAM,IACRC,EAAE,IAAM,IACRM,EAAE,IAAM,IACR,MAAMkE,EAAKd,EAAW3D,EAAGC,EAAG,CAAC,EACvByE,EAAKf,EAAW1D,EAAGD,EAAG,CAAC,EACvBuB,EAAIC,EAAOxB,EAAGC,CAAC,EACf+C,EAAK1C,EAASiB,EAAGvB,EAAG,EAAE,EACtByB,EAAIC,EAAgBnB,EAAGyC,CAAE,EACzBvC,EAAIkD,EAAWpD,EAAGkB,EAAG,GAAG,EACxB4B,EAAIM,EAAWlC,EAAGlB,EAAG,CAAC,EACtBoE,EAAgB,KAAK,MAC3B,KAAK,MAAQ,GACb,KAAK,aAAaF,EAAIC,EAAIxE,CAAO,EACjC,KAAK,YAAYuE,EAAIC,EAAIxE,CAAO,EAChC,KAAK,cACH,iEACA,IACA,KACA,CAAE,QAAS,QAAS,OAAQ,EAAG,MAAO,GAAG,EAEvCA,EAAQ,aACV,KAAK,cACH,kFACA,IACA,GACA,CAAE,QAAS,MAAO,OAAQ,EAAG,MAAO,GAAG,EAEvCA,EAAQ,aACV,KAAK,cACH,0EACA,GACA,IACA,CAAE,QAAS,YAAa,OAAQ,EAAG,MAAO,GAAG,EAEjD,KAAK,eAAeF,EAAGE,CAAO,EAC9B,KAAK,gBACHqB,EAAE,sBAAwBiD,EAAS,IAAM,GACzC,OAAO,OAAO,GAAItE,EAAS,CAAE,MAAO,GAAI,GAEtCA,EAAQ,aACV,KAAK,cACH,gFACA,GACA,IACA,CAAE,QAAS,YAAa,OAAQ,EAAG,MAAO,GAAG,EAEjD,KAAK,cAAcqB,EAAE,qBAAuB,GAAIrB,CAAO,EACvD,KAAK,aAAauE,EAAIvE,CAAO,EAC7B,KAAK,cACHyD,EAAWrD,EAASL,EAAGD,EAAG,EAAE,EAAGA,EAAG,GAAG,EACrC,OAAO,OAAO,GAAIE,EAAS,CAAE,MAAO,GAAI,GAEtCA,EAAQ,aACV,KAAK,cACH,sFACA,KACA,IACA,CAAE,QAAS,OAAQ,OAAQ,EAAG,MAAO,GAAG,EAE5C,KAAK,cAAcF,EAAGE,CAAO,EAC7B,KAAK,OAAOyD,EAAWrD,EAASL,EAAGD,EAAGwE,EAAS,GAAK,GAAG,EAAGxE,EAAG,GAAG,EAAGE,CAAO,EACtEA,EAAQ,aACV,KAAK,cACH,mEACA,GACA,IACA,CAAE,QAAS,YAAa,OAAQ,EAAG,MAAO,GAAG,EAE5CsE,GACH,KAAK,gBAAgBjD,EAAE,qBAAuB,GAAIrB,CAAO,EAE3D,KAAK,gBAAgBuB,EAAG,OAAO,OAAO,GAAIvB,EAAS,CAAE,MAAO,GAAI,CAAC,EAC7DA,EAAQ,aACV,KAAK,cACH,gDACA,GACA,IACA,CAAE,QAAS,YAAa,OAAQ,EAAG,MAAO,GAAG,EAEjD,KAAK,eAAeuB,EAAGvB,CAAO,EAC9B,KAAK,OAAOO,EAAGP,CAAO,EACtB,KAAK,eAAeA,CAAO,EACvBA,EAAQ,aACV,KAAK,cACH,sEACA,GACA,IACA,CAAE,QAAS,YAAa,OAAQ,EAAG,MAAO,GAAG,EAEjD,KAAK,cAAcmD,EAAGnD,CAAO,EAC7B,KAAK,cAAcqB,EAAE,qBAAsBrB,CAAO,EAClD,KAAK,OAAOmD,EAAGnD,CAAO,EACtB,KAAK,aAAaA,CAAO,EACrBA,EAAQ,aACV,KAAK,cAAc,kCAAmC,GAAI,IAAK,CAC7D,QAAS,YACT,OAAQ,EACR,MAAO,GACR,EACH,KAAK,iBAAiBD,EAAGD,EAAGyB,EAAGvB,CAAO,EACtC,KAAK,iBAAiBF,EAAGyB,EAAGlB,EAAGL,CAAO,EACtC,KAAK,cAAcA,CAAO,EAC1B,KAAK,MAAQyE,CACf,EASaC,GAAmC,SAE9C5E,EACAC,EACAqB,EACApB,EAAyB,CAAE,YAAa,IACxC,CACA,MAAM0B,EAAIiD,EAAmBvD,EAAGtB,EAAGC,EAAG,GAAG,EACzCD,EAAE,IAAM,IACRC,EAAE,IAAM,IACRqB,EAAE,IAAM,IACR,MAAMmD,EAAKd,EAAW3D,EAAGC,EAAG,GAAG,EACzByE,EAAKf,EAAW1D,EAAGD,EAAG,GAAG,EACzBS,EAAIkD,EAAWrC,EAAGM,EAAG,GAAG,EACxByB,EAAIM,EAAW/B,EAAGN,EAAG,GAAG,EACxBqD,EAAgB,KAAK,MAC3B,KAAK,MAAQ,GACb,KAAK,YAAYF,EAAIC,EAAIxE,CAAO,EAChC,KAAK,cACH,gEACA,IACA,KACA,CAAE,QAAS,QAAS,OAAQ,EAAG,MAAO,GAAG,EAEvCA,EAAQ,aACV,KAAK,cACH,gFACA,IACA,GACA,CAAE,QAAS,MAAO,OAAQ,EAAG,MAAO,GAAG,EAEvCA,EAAQ,aACV,KAAK,cACH,yEACA,GACA,IACA,CAAE,QAAS,YAAa,OAAQ,EAAG,MAAO,GAAG,EAEjD,KAAK,qBAAqBF,EAAGC,EAAGC,CAAO,EACnCA,EAAQ,aACV,KAAK,cACH,kDACA,GACA,IACA,CAAE,QAAS,YAAa,OAAQ,EAAG,MAAO,GAAG,EAEjD,KAAK,2BACHoB,EACAM,EACA,OAAO,OAAO,GAAI1B,EAAS,CAAE,QAAS,YAAa,UAAW,EAAG,GAE/DA,EAAQ,aACV,KAAK,cACH,iFACA,GACA,IACA,CAAE,QAAS,YAAa,OAAQ,EAAG,MAAO,GAAG,EAEjD,KAAK,qBAAqBF,EAAGsB,EAAGpB,CAAO,EACnCA,EAAQ,aACV,KAAK,cACH,kDACA,GACA,IACA,CAAE,QAAS,YAAa,OAAQ,EAAG,MAAO,GAAG,EAEjD,KAAK,2BACHD,EACA2B,EACA,OAAO,OAAO,GAAI1B,EAAS,CAAE,QAAS,YAAa,UAAW,EAAG,GAEnE,KAAK,cAAcA,CAAO,EACtBA,EAAQ,aACV,KAAK,cACH,+DACA,GACA,IACA,CAAE,QAAS,YAAa,OAAQ,EAAG,MAAO,GAAG,EAEjD,KAAK,WAAW0B,EAAG1B,CAAO,EACtBA,EAAQ,aACV,KAAK,cAAc,0CAA2C,GAAI,IAAK,CACrE,QAAS,YACT,OAAQ,EACR,MAAO,GACR,EACH,KAAK,aAAaO,EAAG4C,EAAGnD,CAAO,EAC/B,KAAK,aAAaA,CAAO,EACzB,KAAK,cAAcA,CAAO,EAC1B,KAAK,MAAQyE,CACf,EASaG,GAAoB,SAE/B9E,EACAC,EACAqB,EACApB,EAAyB,GACzB,CACA,MAAM0B,EAAIiD,EAAmBvD,EAAGtB,EAAGC,CAAC,EAC9BQ,EAAIkD,EAAWrC,EAAGM,EAAG,GAAG,EACxByB,EAAIM,EAAW/B,EAAGN,EAAG,GAAG,EAC9B,YAAK,qBAAqBtB,EAAGC,EAAGC,CAAO,EACvC,KAAK,2BAA2BoB,EAAGM,EAAG1B,CAAO,EAC7C,KAAK,qBAAqBF,EAAGsB,EAAGpB,CAAO,EACvC,KAAK,2BAA2BD,EAAG2B,EAAG1B,CAAO,EAC7C,KAAK,cAAcA,CAAO,EAE1B,KAAK,aAAaO,EAAG4C,EAAGnD,CAAO,EACxB0B,CACT,ECltBO,SAASmD,GAEd/E,EACAC,EACAqB,EACA0D,EAAO,GACPC,EAAc,GACd,CACA,MAAMrD,EAAIiD,EAAmBvD,EAAGrB,EAAGD,CAAC,EACpC4B,EAAE,IAAMoD,EACR,MAAME,EAAO,KAAK,IAAIlF,EAAE,EAAGC,EAAE,EAAGqB,EAAE,EAAGM,EAAE,CAAC,EAClCuD,EAAO,KAAK,IAAInF,EAAE,EAAGC,EAAE,EAAGqB,EAAE,EAAGM,EAAE,CAAC,EAGxC,KAAK,YAAY5B,EAAGC,CAAC,EACrB,KAAK,YAAYA,EAAGqB,CAAC,EACrB,KAAK,WAAWtB,EAAG,CAAE,MAAO,EAAG,EAC/B,KAAK,WAAWC,EAAG,CAAE,MAAO,EAAG,EAC/B,KAAK,WAAWqB,EAAG,CAAE,MAAO,EAAG,EAC3B2D,GACF,KAAK,cACH,GAAGjF,EAAE,IAAMC,EAAE,IAAMqB,EAAE,IAAMM,EAAE,GAAG,wEAChCsD,EAAO,EACPC,EAAO,GAGX,KAAK,qBAAqBlF,EAAGD,CAAC,EAC9B,KAAK,cAAc,GAAGC,EAAE,IAAMD,EAAE,GAAG,MAAMsB,EAAE,IAAMM,EAAE,GAAG,GAAIsD,EAAO,EAAGC,EAAO,CAAC,EAC5E,KAAK,2BAA2B7D,EAAGM,CAAC,EACpC,KAAK,qBAAqB3B,EAAGqB,CAAC,EAC9B,KAAK,cAAc,GAAGrB,EAAE,IAAMqB,EAAE,GAAG,MAAMtB,EAAE,IAAM4B,EAAE,GAAG,GAAIsD,EAAO,EAAGC,EAAO,CAAC,EAC5E,KAAK,2BAA2BnF,EAAG4B,CAAC,EACpC,KAAK,WAAWA,CAAC,EACjB,KAAK,gBACL,KAAK,aAAaN,EAAGM,CAAC,EACtB,KAAK,aAAaA,EAAG5B,CAAC,EACtB,KAAK,eACL,KAAK,gBACL,KAAK,cAAcA,EAAGC,EAAG,CACvB,OAAQ,MACR,QAAS,KAAK,cACd,MAAO,EACR,EACD,KAAK,cAAc2B,EAAGN,EAAG,CACvB,OAAQ,MACR,QAAS,KAAK,cACd,MAAO,EACR,EACD,KAAK,cAAcrB,EAAGqB,EAAG,CACvB,OAAQ,KACR,QAAS,KAAK,cACd,MAAO,EACR,EACD,KAAK,cAActB,EAAG4B,EAAG,CACvB,OAAQ,KACR,QAAS,KAAK,cACd,MAAO,EACR,CACH,CAUO,SAASwD,GAEdpF,EACAC,EACAE,EACAkF,EAAO,GACPL,EAAO,GACPC,EAAc,GACd,CACA,MAAM3D,EAAIuD,EAAmB1E,EAAGH,EAAGG,CAAC,EACpCmB,EAAE,IAAM+D,EACR,MAAMzD,EAAIiD,EAAmB1E,EAAGF,EAAGE,CAAC,EACpCyB,EAAE,IAAMoD,EACR,MAAMM,EAAMtF,EAAE,IAAMC,EAAE,IAAMqB,EAAE,IAAMM,EAAE,KAClCd,EAASd,EAAGsB,CAAC,EAAI,IAAMR,EAASb,EAAG2B,CAAC,EAAI,KAC1C,KAAK,sBAAsB,EAAE,EAE/B,MAAMsD,EAAO,KAAK,IAAIlF,EAAE,EAAGC,EAAE,EAAGqB,EAAE,EAAGM,EAAE,CAAC,EAClCuD,EAAO,KAAK,IAAInF,EAAE,EAAGC,EAAE,EAAGqB,EAAE,EAAGM,EAAE,CAAC,EAGxC,KAAK,YAAY5B,EAAGC,CAAC,EACrB,KAAK,WAAWD,EAAG,CAAE,MAAO,EAAG,EAC/B,KAAK,WAAWC,EAAG,CAAE,MAAO,EAAG,EAC/B,KAAK,WAAWE,EAAG,CAAE,MAAO,EAAG,EAC3B8E,GAAeK,EAAI,SAAW,GAChC,KAAK,cACH,GAAGtF,EAAE,IAAMC,EAAE,IAAMqB,EAAE,IAAMM,EAAE,GAAG,yEAChCsD,EAAO,EACPC,EAAO,GAGX,KAAK,WAAa,GAClB,KAAK,UAAY,EACjB,KAAK,QAAU,KAAK,4BACpB,KAAK,4BAA4BnF,EAAGG,EAAG,CAAE,SAAUW,EAASd,EAAGsB,CAAC,EAAI,EAAG,EACvE,KAAK,eACL,KAAK,gBACL,KAAK,qBAAqBtB,EAAGG,CAAC,EAC1B8E,GAAeK,EAAI,SAAW,GAChC,KAAK,cACH,GAAGtF,EAAE,IAAMG,EAAE,GAAG,MAAMA,EAAE,IAAMmB,EAAE,GAAG,GACnC4D,EAAO,EACPC,EAAO,GAGX,KAAK,WAAa,GAClB,KAAK,2BAA2BhF,EAAGmB,CAAC,EACpC,KAAK,gBACL,KAAK,WAAa,GAClB,KAAK,4BAA4BrB,EAAGE,EAAG,CAAE,SAAUW,EAASb,EAAG2B,CAAC,EAAI,EAAG,EACvE,KAAK,eACL,KAAK,gBACL,KAAK,WAAa,GAClB,KAAK,qBAAqB3B,EAAGE,CAAC,EAC1B8E,GAAeK,EAAI,SAAW,GAChC,KAAK,cACH,GAAGrF,EAAE,IAAME,EAAE,GAAG,MAAMA,EAAE,IAAMyB,EAAE,GAAG,GACnCsD,EAAO,EACPC,EAAO,GAGX,KAAK,2BAA2BhF,EAAGyB,CAAC,EACpC,KAAK,gBACL,KAAK,QAAU,OACf,KAAK,UAAY,EACjB,KAAK,WAAWA,CAAC,EACjB,KAAK,aAAa5B,EAAG4B,CAAC,EACtB,KAAK,aAAaA,EAAGN,CAAC,EACtB,KAAK,aAAaA,EAAGrB,CAAC,EACtB,KAAK,eACL,KAAK,gBACL,KAAK,gBACL,KAAK,cAAcD,EAAGG,EAAG,CACvB,OAAQ,KACR,QAAS,KAAK,cACd,MAAO,EACR,EACD,KAAK,cAAcA,EAAGmB,EAAG,CACvB,OAAQ,KACR,QAAS,KAAK,cACd,MAAO,EACR,EACD,KAAK,cAAcrB,EAAGE,EAAG,CACvB,OAAQ,IACR,QAAS,KAAK,cACd,MAAO,EACR,EACD,KAAK,cAAcA,EAAGyB,EAAG,CACvB,OAAQ,IACR,QAAS,KAAK,cACd,MAAO,EACR,CACH,CAQO,SAAS2D,GAEd3D,EACA5B,EACAC,EACAE,EACA,CACA,MAAMqF,EAAKhF,EAAgBR,EAAGC,EAAGa,EAASd,EAAGC,CAAC,EAAI,CAAC,EAC7CwF,EAAKjF,EAAgBR,EAAG4B,EAAGd,EAASd,EAAG4B,CAAC,EAAI,CAAC,EAC7CN,EAAIuD,EAAmB5E,EAAGD,EAAG4B,CAAC,EACpC,KAAK,YAAY5B,EAAGwF,CAAE,EACtB,KAAK,YAAYxF,EAAGyF,CAAE,EACtB,KAAK,WAAWtF,EAAG,CAAE,MAAO,EAAG,EAC/B,KAAK,WAAWH,EAAG,CAAE,MAAO,EAAG,EAC/B,KAAK,4BAA4BA,EAAGG,EAAG,CACrC,QAAS,KAAK,4BACd,UAAW,EACX,WAAY,GACb,EACD,KAAK,WAAa,GAClB,KAAK,eACL,KAAK,gBACL,KAAK,qBAAqBH,EAAGG,CAAC,EAC9B,KAAK,2BAA2BA,EAAGmB,EAAG,CACpC,QAAS,KAAK,4BACf,EACD,KAAK,gBACL,KAAK,oCAAoCkE,EAAIxF,EAAGsB,EAAG,CACjD,QAAS,KAAK,4BACd,UAAW,EACZ,EACD,KAAK,iBACL,KAAK,YAAYA,EAAGM,EAAG,CACrB,QAAS,KAAK,4BACd,UAAW,EACZ,EACD,KAAK,oCAAoC5B,EAAGyF,EAAInE,EAAG,CACjD,QAAS,KAAK,4BACd,UAAW,EACZ,EACD,KAAK,iBACL,KAAK,YAAYA,EAAGrB,EAAG,CACrB,QAAS,KAAK,4BACd,UAAW,EACZ,EACD,KAAK,WAAW2B,EAAG,CAAE,MAAO,EAAG,EAC/B,KAAK,WAAW3B,EAAG,CAAE,MAAO,EAAG,EAC/B,KAAK,WAAWqB,EAAG,CAAE,MAAO,EAAG,EAC/B,KAAK,aAAarB,EAAGqB,CAAC,EACtB,KAAK,aAAaA,EAAGM,CAAC,EACtB,KAAK,eACL,KAAK,eACP,CAUO,SAAS8D,GAEd1F,EACAC,EACA0F,EACApE,EACA,CAAE,SAAAqE,EAAW,EAAG,SAAAC,EAAW,GAAI,IAAAP,EAAM,GAAI,kBAAAQ,EAAoB,IAAU,GACvE,CACA,KAAK,YAAY9F,EAAGC,CAAC,EACrB,KAAK,0BACL,KAAK,aAAaD,CAAC,EACnB,MAAM+F,EAAI9B,EACRhE,EACAD,EACA6F,GACE,KAAK,IAAIF,EAAGpE,CAAC,EAAI,GAAKqE,EAAY9E,EAASd,EAAGC,CAAC,GAEnD,KAAK,aAAaD,EAAG+F,CAAC,EACtB,KAAK,eACL,KAAK,gBACL,MAAMC,EAAK,CAAChG,CAAC,EACb,QAASiG,EAAI,EAAGA,GAAK,KAAK,IAAIN,EAAGpE,CAAC,EAAG0E,IACnCD,EAAG,KACDE,EACElG,EACA4F,EAAWK,EACXJ,EAAWrE,EAAOxB,EAAGC,CAAC,EAAE,qBAC1B,EAEF,KAAK,2BAA2B+F,EAAGC,EAAI,CAAC,EAAGD,EAAGC,CAAC,CAAC,EAC5CH,GACF,KAAK,WAAWE,EAAGC,CAAC,EAAG,CAAE,MAAOjG,EAAE,IAAM,IAAMiG,EAAG,GAAI,GAAI,GAAI,GAAK,EAEtE,KAAK,gBACL,KAAK,aAAaD,EAAGzE,CAAC,EAAGtB,CAAC,EAC1B,KAAK,eACL,KAAK,gBACL,MAAMkG,EAAI,KAAK,kBAAkBH,EAAGzE,CAAC,EAAGtB,EAAG+F,EAAGL,CAAC,CAAC,EAC1CpF,EAAIoD,EAAW1D,EAAGD,EAAG2F,EAAIpE,CAAC,EAChC,OAAI4E,EAAE,EAAI5F,EAAE,GAAG,KAAK,sBAAsB4F,EAAG5F,EAAG,CAAE,SAAU,EAAG,EAC/D,KAAK,aAAaP,EAAGO,EAAG,CAAE,QAAS,MAAO,UAAW,EAAG,EACpD+E,GAAK,KAAK,WAAW/E,EAAG,CAAE,MAAO+E,EAAK,EAC1C,KAAK,eACL,KAAK,gBACE/E,CACT,CChSO,MAAM6F,GAAuB,SAElCd,EACAtF,EACAqG,EACA,CAEArG,EAAI0D,EAAM,EAAG,EAAG4B,EAAI,CAAC,CAAC,EACtB,MAAMrF,EAAIiG,EAAelG,EAAGqG,EAAGC,EAAQ,IAAK,EAAE,EAAGhB,EAAI,CAAC,CAAC,EACjDhE,EAAIhB,EAASN,EAAGC,EAAG,IAAKqF,EAAI,CAAC,CAAC,EAC9B1D,EAAItB,EAASL,EAAGD,EAAG,GAAIsF,EAAI,CAAC,CAAC,EAC7BiB,EAAI/F,EAAgBR,EAAG4B,EAAGyE,EAAI,EAAG,GAAG,EACpCG,EAAIhG,EAAgBoB,EAAGN,EAAG+E,EAAI,EAAG,GAAG,EAC1C,YAAK,aAAcA,EAAI,GAAK,IAAO,GAAG,EACtC,KAAK,MAAQ,GAEb,KAAK,cACH,0DAA0DA,CAAC,qDAAqDf,EAAI,CAAC,EAAIA,EAAI,CAAC,CAAC,wBAC/H,EACA,IAGF,KAAK,WAAWtF,EAAG,CAAE,MAAO,EAAG,EAC/B,KAAK,YAAYA,EAAGA,EAAE,IAAK,CAAE,GAAI,IAAM,GAAI,EAAG,EAC9C,KAAK,aAAaA,EAAGC,CAAC,EACtB,KAAK,WAAWA,CAAC,EACjB,KAAK,eACL,KAAK,gBAAgBD,EAAGC,EAAG,EAAE,EAE7B,KAAK,cACH,4EAA4EqF,EAAI,CAAC,EAAIA,EAAI,CAAC,CAAC,iBAAiBA,EAAI,CAAC,CAAC,IAClH,EACA,GAAK,EAAI,GAGX,KAAK,iBACL,KAAK,gBAAgBtF,CAAC,EACtB,KAAK,gBAAgBC,CAAC,EACtB,KAAK,MAAMD,EAAGuG,CAAC,EACf,KAAK,iBACL,KAAK,iBAAiBtG,EAAGD,EAAG4B,CAAC,EAE7B,KAAK,cACH,8EAA8E0D,EAAI,CAAC,CAAC,iCAAiCe,CAAC,UAAUf,EAAI,CAAC,CAAC,IACtI,EACA,GAAK,EAAI,GAGX,KAAK,aAAatF,EAAG4B,CAAC,EACtB,KAAK,WAAWA,EAAG,CAAE,MAAO,EAAG,EAC/B,KAAK,YAAYA,EAAGA,EAAE,IAAK,CAAE,GAAI,IAAM,GAAI,GAAK,EAChD,KAAK,eACL,KAAK,cAAc5B,EAAGC,CAAC,EACvB,KAAK,cAAcD,EAAG4B,CAAC,EAEvB,KAAK,cACH,8CAA8C0D,EAAI,CAAC,EAAIA,EAAI,CAAC,CAAC,iBAAiBA,EAAI,CAAC,CAAC,4BAA4BA,EAAI,CAAC,CAAC,iCAAiCe,CAAC,UAAUf,EAAI,CAAC,CAAC,IACxK,EACA,GAAK,EAAI,GAGX,KAAK,iBACL,KAAK,gBAAgB1D,CAAC,EACtB,KAAK,gBAAgB5B,CAAC,EACtB,KAAK,MAAM4B,EAAG4E,CAAC,EACf,KAAK,iBACL,KAAK,iBAAiBxG,EAAG4B,EAAGN,CAAC,EAE7B,KAAK,aAAaM,EAAGN,CAAC,EACtB,KAAK,WAAWA,EAAG,CAAE,MAAO,EAAG,EAC/B,KAAK,YAAYA,EAAGA,EAAE,IAAK,CAAE,GAAI,EAAG,GAAI,GAAK,EAC7C,KAAK,eACL,KAAK,cAAcM,EAAGN,CAAC,EAEvB,KAAK,cACH,2BAA2BgE,EAAI,CAAC,EAAIA,EAAI,CAAC,CAAC,KAC1C,EACA,GAAK,EAAI,GAGX,KAAK,aAAahE,EAAGrB,CAAC,EACtB,KAAK,eACL,KAAK,cAAcA,EAAGqB,CAAC,EAEvB,KAAK,cACH,qBAAqBgE,EAAI,CAAC,EAAIA,EAAI,CAAC,CAAC,MAAMe,CAAC,0DAC3C,EACA,GAAK,EAAI,GAGX,KAAK,eAAe/E,EAAG,CAAE,MAAO,EAAG,EACnC,KAAK,gBAAgBM,CAAC,EACtB,KAAK,iBACL,KAAK,iBAAiBA,EAAGN,EAAGrB,CAAC,EAE7B,KAAK,eAAeA,EAAG,CAAE,MAAO,EAAG,EACnC,KAAK,gBAAgBqB,CAAC,EACtB,KAAK,iBACL,KAAK,iBAAiBA,EAAGrB,EAAGD,CAAC,EACtByG,GAAgBzG,EAAGC,EAAGqB,EAAGM,CAAC,CACnC,EC/FM8E,EAAU,CAAC,IAAK,KAAM,MAAO,IAAK,MAAM,EAUjCC,GAAsB,SAEjCC,EACArF,EACA+D,EACApF,EAAyB,GACzB,EACIoF,IAAQ,QAAaA,IAAQ,MAC/BA,EAAMsB,EAAE,IAAM,KAEhB,MAAMC,EAAQC,EAAeF,EAAGrF,EAAG+D,CAAG,EACtC,GAAIxE,EAAS8F,EAAGC,CAAK,IAAM,EAAG,CAC5B,MAAMtG,EAAIH,EAAOwG,EAAGC,CAAK,EACnBpG,EAAIH,EAASsG,EAAGrG,EAAG,EAAE,EACrBqB,EAAItB,EAASG,EAAGF,EAAG,GAAG,EAC5B,KAAK,wBAAwBL,CAAO,EACpC,KAAK,0CACHO,EACAmB,EACAgF,EACA,OAAO,OAAO,GAAI1G,EAAS,CACzB,QAASA,EAAQ,SAAW,KAAK,4BACjC,UAAW,KAAK,8BAChB,WAAY,GACb,GAEH,KAAK,qBAAqBK,EAAGqG,EAAG1G,CAAO,EACvC,KAAK,2BAA2BK,EAAGsG,EAAO3G,CAAO,EACjD,KAAK,aAAaA,CAAO,EACzB,KAAK,eAAeA,CAAO,EAC3B,KAAK,cAAc0G,EAAGrG,EAAGL,CAAO,EAChC,KAAK,cAAc2G,EAAOtG,EAAGL,CAAO,EACpC,KAAK,cAAcA,CAAO,EAC1B,KAAK,cAAcA,CAAO,CAC5B,CACA,KAAK,WAAW2G,EAAO3G,CAAO,CAChC,EAWa6G,GAAgB,SAE3BH,EACAI,EACA/E,EACAqD,EACApF,EAAyB,GACzB,EACIoF,IAAQ,QAAaA,IAAQ,MAC/BA,EAAMsB,EAAE,IAAM,KAEhB,MAAMC,EAAQvG,EAASsG,EAAGI,EAAQ/E,EAAOqD,CAAG,EAC5C,KAAK,aACH0B,EACAJ,EACA,OAAO,OAAO,GAAI1G,EAAS,CACzB,UAAW,KAAK,8BAChB,WAAY,GACb,GAEH,KAAK,kBAAkB8G,EAAQ9G,CAAO,EACtC,KAAK,gCACH8G,EACAJ,EACA3E,EACA,OAAO,OAAO,GAAI/B,EAAS,CACzB,UAAW,KAAK,8BAChB,WAAY,GACb,GAEH,KAAK,aAAaA,CAAO,EACzB,KAAK,kBAAkBA,CAAO,EAC9B,KAAK,qBAAqB8G,EAAQJ,EAAG1G,CAAO,EAC5C,KAAK,2BAA2B8G,EAAQH,EAAO3G,CAAO,EACtD,KAAK,cAAcA,CAAO,EAC1B,KAAK,WAAW2G,EAAO3G,CAAO,EAC1BA,EAAQ,SACN,KAAK,IAAI+B,CAAK,IAAM,GACtB,KAAK,iBAAiB2E,EAAGI,EAAQH,EAAO3G,CAAO,GAE/C,KAAK,YAAY0G,EAAGI,EAAQH,EAAO3G,CAAO,EAC1C,KAAK,WACH,KAAK,IAAI+B,CAAK,EAAI,IAClBoC,EACEV,EACErD,EAASsG,EAAGI,EAAQ/E,EAAQ,CAAC,EAC7B+E,EACA,IAAMlG,EAASkG,EAAQJ,CAAC,GAE1BtC,EAAQ,IAAM,EAAG,GAEnBpE,CAAA,GAIR,EA6Ca+G,GAAmB,SAE9BL,EACA5G,EACAC,EACAqF,EACApF,EAAyB,GACzB,CACA,MAAMgH,EAAI5C,EAAQtE,EAAGC,CAAC,GAClBqF,IAAQ,QAAaA,IAAQ,MAC/BA,EAAMsB,EAAE,IAAM,KAEhB,MAAMC,EAAQxC,EAAYuC,EAAGM,EAAG5B,CAAG,EAC/BxE,EAASd,EAAG4G,CAAC,IAAM,IAErB,KAAK,qBAAqB5G,EAAG4G,EAAG1G,CAAO,EACvC,KAAK,2BAA2BD,EAAG4G,EAAO3G,CAAO,EACjD,KAAK,qBAAqBF,EAAGC,EAAGC,CAAO,EACvC,KAAK,2BAA2B0G,EAAGC,EAAO3G,CAAO,GAEnD,KAAK,gBACL,KAAK,WAAW2G,EAAO3G,CAAO,EAC9B,MAAMiH,EAASb,EAAQ,EAAG,CAAC,EACrBc,EAASd,EAAQ,EAAG,EAAGa,CAAM,EAC7BE,EAAUX,EAAQS,CAAM,EACxBG,EAAUZ,EAAQU,CAAM,EAC9B,KAAK,YACHR,EACAC,EACA,OAAO,OAAO,GAAI3G,EAAS,CAAE,UAAW,GAAK,WAAY,GAAM,GAEjE,KAAK,YACHF,EACAC,EACA,OAAO,OAAO,GAAIC,EAAS,CAAE,UAAW,GAAK,WAAY,GAAM,GAEjE,KAAK,cAAc0G,EAAGC,EAAO,OAAO,OAAO,GAAI3G,EAAS,CAAE,OAAQmH,CAAA,CAAS,CAAC,EAC5E,KAAK,cAAcrH,EAAGC,EAAG,OAAO,OAAO,GAAIC,EAAS,CAAE,OAAQmH,CAAA,CAAS,CAAC,EACxE,KAAK,YACHpH,EACA4G,EACA,OAAO,OAAO,GAAI3G,EAAS,CAAE,UAAW,GAAK,WAAY,GAAM,GAEjE,KAAK,YACHF,EACA4G,EACA,OAAO,OAAO,GAAI1G,EAAS,CAAE,UAAW,GAAK,WAAY,GAAM,GAEjE,KAAK,cAAcD,EAAG4G,EAAO,OAAO,OAAO,GAAI3G,EAAS,CAAE,OAAQoH,CAAA,CAAS,CAAC,EAC5E,KAAK,cAActH,EAAG4G,EAAG,OAAO,OAAO,GAAI1G,EAAS,CAAE,OAAQoH,CAAA,CAAS,CAAC,CAC1E,EAUaC,GAAgB,SAE3BX,EACAI,EACA1B,EACApF,EAAyB,GACzB,EACIoF,IAAQ,QAAaA,IAAQ,MAC/BA,EAAMsB,EAAE,IAAM,KAEhB,MAAMC,EAAQvG,EAASsG,EAAGI,EAAQ,IAAK1B,CAAG,EAC1C,KAAK,qBAAqB0B,EAAQJ,EAAG1G,CAAO,EAC5C,KAAK,2BAA2B8G,EAAQH,EAAO3G,CAAO,EACtD,KAAK,cAAcA,CAAO,EAC1B,KAAK,eAAe0G,EAAG1G,CAAO,EAC9B,KAAK,aACH0G,EACAC,EACA,OAAO,OAAO,GAAI3G,EAAS,CAAE,UAAW,GAAK,WAAY,GAAM,GAEjE,KAAK,WAAW2G,EAAO3G,CAAO,EAC9B,KAAK,aAAaA,CAAO,EACzB,KAAK,cAAcA,CAAO,EAC1B,KAAK,cAAc0G,EAAGI,EAAQ9G,CAAO,EACrC,KAAK,cAAc8G,EAAQH,EAAO3G,CAAO,CAC3C,EAcasH,GAAkB,SAE7BZ,EACAI,EACAS,EACAnC,EACApF,EACA,CACA,IAAIwH,GACApC,IAAQ,QAAaA,IAAQ,MAC/BA,EAAMsB,EAAE,IAAM,KAEhB,MAAMC,EAAQlD,EAAWiD,EAAGI,EAAQS,EAAGnC,CAAG,EACtCmC,EAAI,EACNC,EAAU,KAAK,cACb,kDAAkDd,EAAE,GAAG,OAAOC,EAAM,GAAG,yBAAyBG,EAAO,GAAG,IAC1G9G,EAAQ,cAAc,EACtBA,EAAQ,cAAc,EACtB,OAAO,OAAO,CAAE,OAAQ,IAAMA,CAAO,GAGvCwH,EAAU,KAAK,cACb,uCAAuCV,EAAO,GAAG,yBAAyBJ,EAAE,GAAG,OAAOC,EAAM,GAAG,IAC/F3G,EAAQ,cAAc,EACtBA,EAAQ,cAAc,EACtB,OAAO,OAAO,CAAE,OAAQ,IAAMA,CAAO,GAGzC,KAAK,aACH0G,EACAI,EACA,OAAO,OAAO,GAAI9G,EAAS,CAAE,UAAW,GAAK,WAAY,GAAM,GAEjE,MAAMyH,EAAI7G,EAAS8F,EAAGI,CAAM,EACtBY,EAASC,GAAQF,EAAG,CAAC,EAAI,KAAK,IAAIF,CAAC,EACnCK,EAAW,KAAK,cACpB,iBAAiBd,EAAO,GAAG,GAAGJ,EAAE,GAAG,SAASmB,EAAaJ,EAAG,CAAC,CAAC,yCAAyCI,EAAaN,EAAG,CAAC,CAAC,GACzHvH,EAAQ,cAAc,EACtBA,EAAQ,cAAc,EAAI,EAC1B,OAAO,OAAO,CAAE,OAAQ,IAAMA,CAAO,GAEjC8H,EAAW,KAAK,cACpB,QAAQhB,EAAO,GAAG,GAAGH,EAAM,GAAG,QAAQkB,EAAaJ,EAAG,CAAC,CAAC,SAASI,EAAa,KAAK,IAAIN,CAAC,EAAG,CAAC,CAAC,MAAMM,EAAaH,EAAQ,CAAC,CAAC,OAC1H1H,EAAQ,cAAc,EACtBA,EAAQ,cAAc,EAAI,EAC1B,OAAO,OAAO,CAAE,OAAQ,IAAMA,CAAO,GAEvC,KAAK,aACH8G,EACAH,EACA,OAAO,OAAO,GAAI3G,EAAS,CAAE,UAAW,GAAK,WAAY,GAAM,GAEjE,KAAK,aAAaA,CAAO,EACzB,KAAK,cAAcA,CAAO,EAC1B,KAAK,WAAW2G,EAAO,OAAO,OAAO,CAAE,aAAc,QAAU3G,CAAO,CAAC,EACvE,KAAK,QACL,KAAK,aAAa4H,EAAU5H,CAAO,EACnC,KAAK,aAAa8H,EAAU9H,CAAO,EACnC,KAAK,aAAawH,EAASxH,CAAO,CACpC,EASa+H,GAAmB,SAE9BrB,EACAI,EACA/E,EACAiG,EAAiB,GACjBhI,EAAyB,CACvB,QAAS,KAAK,QACd,cAAe,KAAK,aACtB,EACA,CACA,IAAIoF,EACJ,MAAM6C,EAAK7H,EAASsG,EAAGI,EAAQ/E,CAAK,EACpC,IAAImG,EACJ,MAAMC,EAAcC,GAAQ5B,CAAO,EACnC,QAAST,EAAI,EAAGA,EAAIW,EAAE,YAAY,OAAQX,IACpCiC,EAAKjC,CAAC,IAAM,OACdX,EAAM4C,EAAKjC,CAAC,EAEZX,EAAMsB,EAAE,YAAYX,CAAC,EAAE,IAAM,IAE3BA,EAAI,EACNmC,EAAclI,EAAQ,QAAU,QAEhCkI,EAAc,GAEZtH,EAASkG,EAAQJ,EAAE,YAAYX,CAAC,CAAC,IAAM,IACzC,KAAK,cACHW,EAAE,YAAYX,CAAC,EACfe,EACA/E,EACAqD,EACA,OAAO,OAAO,GAAIpF,EAAS,CAAE,OAAQkI,EAAa,GAEpD,KAAK,cACHxB,EAAE,YAAYX,CAAC,EACfe,EACA,OAAO,OAAO,GAAI9G,EAAS,CAAE,OAAQmI,EAAYpC,CAAC,EAAG,GAEvD,KAAK,cACHkC,EAAG,YAAYlC,CAAC,EAChBe,EACA,OAAO,OAAO,GAAI9G,EAAS,CAAE,OAAQmI,EAAYpC,CAAC,EAAG,IAI3D,KAAK,eACH,GAAGkC,EAAG,YACN,OAAO,OAAOjI,EAAS,CAAE,UAAW,EAAG,EAE3C,EAUaqI,GAAyB,SAEpC3B,EACArF,EACA2G,EAAiB,GACjBhI,EAAyB,GACzB,CACA,IAAIoF,EACJ,MAAM6C,EAAKrB,EAAeF,EAAGrF,CAAC,EAE9B,IAAI0E,EAAI,EACR,MAAMS,EAAU,CAAC,IAAK,KAAM,MAAO,IAAK,MAAM,EAC9C,UAAW8B,KAAU5B,EAAE,YAEjBsB,EAAKjC,CAAC,IAAM,OACdX,EAAM4C,EAAKjC,CAAC,EAEZX,EAAMkD,EAAO,IAAM,IAErB,KAAK,oBACHA,EACAjH,EACA+D,EACA,OAAO,OAAO,GAAIpF,EAAS,CAAE,OAAQwG,EAAQT,CAAC,EAAG,UAAW,GAAK,GAEnEA,IAEF,KAAK,cAAc/F,CAAO,EAC1B,KAAK,cAAcA,CAAO,EAC1B,KAAK,eACH,GAAGiI,EAAG,YACN,OAAO,OAAO,GAAIjI,EAAS,CAAE,UAAW,EAAG,EAE/C,EAWauI,GAAsB,SAEjC7B,EACA5G,EACAC,EACAiI,EAAiB,GACjBhI,EAAyB,GACzB,CACA,IAAIoF,EACJ,MAAM4B,EAAI5C,EAAQtE,EAAGC,CAAC,EAChBkI,EAAK9D,EAAYuC,EAAGM,CAAC,EAC3B,QAASjB,EAAI,EAAGA,EAAIW,EAAE,YAAY,OAAQX,IACpCiC,EAAKjC,CAAC,IAAM,OACdX,EAAM4C,EAAKjC,CAAC,EAEZX,EAAMsB,EAAE,YAAYX,CAAC,EAAE,IAAM,IAE/B,KAAK,iBAAiBW,EAAE,YAAYX,CAAC,EAAGjG,EAAGC,EAAGqF,EAAKpF,CAAO,EAE5D,KAAK,eACH,GAAGiI,EAAG,YACN,OAAO,OAAO,GAAIjI,EAAS,CAAE,UAAW,EAAG,EAE/C,EASawI,GAAmB,SAE9B9B,EACAI,EACAkB,EAAiB,GACjBhI,EAAyB,GACzB,CACA,MAAMiI,EAAK7H,EAASsG,EAAGI,EAAQ,GAAG,EAClC,IAAI1B,EACAW,EAAI,EACR,MAAMS,EAAU,CAAC,IAAK,KAAM,MAAO,IAAK,MAAM,EAC9C,UAAW8B,KAAU5B,EAAE,YAEjBsB,EAAKjC,CAAC,IAAM,OACdX,EAAM4C,EAAKjC,CAAC,EAEZX,EAAMkD,EAAO,IAAM,IAErB,KAAK,cACHA,EACAxB,EACA1B,EACA,OAAO,OAAO,GAAIpF,EAAS,CAAE,OAAQwG,EAAQT,CAAC,EAAG,GAEnDA,IAEF,KAAK,eACH,GAAGkC,EAAG,YACN,OAAO,OAAO,GAAIjI,EAAS,CAAE,UAAW,EAAG,EAE/C,EAUayI,GAAqB,SAEhC/B,EACAI,EACAS,EACAS,EAAO,GACPhI,EAAyB,GACzB,CACA,IAAIoF,EACJ,MAAM6C,EAAKxE,EAAWiD,EAAGI,EAAQS,CAAC,EAC5BmB,EAAI,KAAK,cACb,gBACGnB,GAAK,EAAI,UAAY,WACtB,WACCA,GAAK,EACF,oCAAsCT,EAAO,IAC7CA,EAAO,IAAM,0BACnB,EACA,EACA,OAAO,OAAO,CAAE,OAAQ,IAAM9G,CAAO,GAEvC,IAAI+F,EAAI,EACR,UAAWuC,KAAU5B,EAAE,YAEjBsB,EAAKjC,CAAC,IAAM,OACdX,EAAM4C,EAAKjC,CAAC,EAEZX,EAAMkD,EAAO,IAAM,IAErB,KAAK,gBACHA,EACAxB,EACAS,EACAnC,EACA,OAAO,OAAO,GAAIpF,EAAS,CACzB,UAAW,EACX,cAAe,CAAE,EAAG,EAAG,EAAG,EAAE,CAC7B,GAEH+F,IAEF,KAAK,eACH,GAAGkC,EAAG,YACN,OAAO,OAAO,GAAIjI,EAAS,CAAE,UAAW,EAAG,GAE7C,KAAK,aAAa0I,CAAC,CACrB,ECvhBaC,GAAqB,SAEhCC,EACAC,EACAC,EACAC,EACA/I,EAAyB,GACzB,CACA,MAAMF,EAAI0D,EAAM,EAAG,CAAC,EACdzD,EAAIiG,EAAelG,EAAG+I,EAAIzC,EAAQ,IAAK,EAAE,CAAC,EAE1ChF,EADI4H,GAA0BlJ,EAAGC,EAAG+I,EAAIC,CAAE,EACpC,YAAY,CAAC,EACzB,IAAIhE,EAAc/E,EAAQ,aAAe,GACzC,OAAI4I,EAAI,SAAW,EACjB7D,EAAc,IAEdjF,EAAE,IAAM8I,EAAI,CAAC,EACb7I,EAAE,IAAM6I,EAAI,CAAC,EACbxH,EAAE,IAAMwH,EAAI,CAAC,GAGX7D,GACF,KAAK,cACH,GAAGjF,EAAE,IAAMC,EAAE,GAAG,MAAMkJ,EAAiBJ,CAAE,CAAC,MAC1C,EACA,GACA7I,CAAA,EAEJ,KAAK,WAAWF,EAAGE,CAAO,EAG1B,KAAK,aAAaF,EAAGC,EAAGC,CAAO,EAC/B,KAAK,WAAWD,EAAGC,CAAO,EAC1B,KAAK,cAAcA,CAAO,EACtB+E,GACF,KAAK,cACH,GAAGjF,EAAE,IAAMsB,EAAE,GAAG,MAAM6H,EAAiBH,CAAE,CAAC,YAAY1H,EAAE,GAAG,mCAAmCtB,EAAE,GAAG,gBAAgBmJ,EAAiBH,CAAE,CAAC,OACvI,EACA,GACA9I,CAAA,EAEJ,KAAK,QAAU,cACf,KAAK,UAAY,EACjB,KAAK,cAAcF,EAAGE,CAAO,EAC7B,KAAK,uBAAuB8I,EAAI9I,CAAO,EACvC,KAAK,2BAA2BF,EAAGsB,EAAGpB,CAAO,EACzC+E,GACF,KAAK,cACH,GAAGhF,EAAE,IAAMqB,EAAE,GAAG,MAAM6H,EAAiBF,CAAE,CAAC,YAAY3H,EAAE,GAAG,mCAAmCrB,EAAE,GAAG,gBAAgBkJ,EAAiBF,CAAE,CAAC,OACvI,EACA,GACA/I,CAAA,EAEJ,KAAK,eAAeD,EAAGC,CAAO,EAC9B,KAAK,uBAAuB+I,EAAI/I,CAAO,EACvC,KAAK,2BAA2BD,EAAGqB,EAAGpB,CAAO,EAC7C,KAAK,cAAcA,CAAO,EAC1B,KAAK,QAAU,OACf,KAAK,UAAY,EACb+E,GACF,KAAK,cACH,YAAY3D,EAAE,GAAG,4CACjB,EACA,GACApB,CAAA,EAEJ,KAAK,WAAWoB,EAAGpB,CAAO,EAC1B,KAAK,aAAaD,EAAGqB,EAAGpB,CAAO,EAC/B,KAAK,aAAaoB,EAAGtB,EAAGE,CAAO,EAC/B,KAAK,cAAcA,CAAO,EAC1B,KAAK,aAAaA,CAAO,EAClB,CAACF,EAAGC,EAAGqB,CAAC,CACjB,EAWa8H,GAAkC,SAE7CN,EACAC,EACAC,EACA9I,EAAyB,GACzB,CAEA,MAAMF,EAAI0D,EAAM,EAAG,CAAC,EACdzD,EAAIiG,EAAelG,EAAG+I,EAAIzC,EAAQ,IAAK,EAAE,CAAC,EAC1C+C,EAAM7H,EAAOxB,EAAGC,CAAC,EACvBoJ,EAAI,UAAY,GAChB,MAAMC,EAAMrG,EAAgChD,EAAGoJ,CAAG,EAClDC,EAAI,UAAY,GAChB,MAAMC,EAAMpG,EAAOnD,EAAGgJ,CAAE,EACxBO,EAAI,UAAY,GAChB,MAAMjI,EAAI4B,EAAoBoG,EAAKC,CAAG,EAChClD,EAAI1C,EAAWrC,EAAGrB,EAAG,GAAG,EAC9B,IAAIgF,EAAc/E,EAAQ,aAAe,GACzC,OAAI4I,EAAI,SAAW,EACjB7D,EAAc,IAEdjF,EAAE,IAAM8I,EAAI,CAAC,EACb7I,EAAE,IAAM6I,EAAI,CAAC,EACbxH,EAAE,IAAMwH,EAAI,CAAC,GAGXhI,EAASd,EAAGsB,CAAC,EAAI,GAAG,KAAK,YAAY,GAAG,EACxC2D,GACF,KAAK,cAAc,GAAGjF,EAAE,IAAMC,EAAE,GAAG,MAAMkJ,EAAiBJ,CAAE,CAAC,MAAO,EAAG,EAAE,EAC3E,KAAK,gBAAgBM,EAAI,qBAAsBnJ,CAAO,EACtD,KAAK,WAAWF,EAAGE,CAAO,EAC1B,KAAK,aAAaF,EAAGC,EAAGC,CAAO,EAC/B,KAAK,WAAWD,EAAGC,CAAO,EACtB+E,GACF,KAAK,cACH,GAAGjF,EAAE,IAAMC,EAAE,IAAMqB,EAAE,GAAG,iCAAiCrB,EAAE,GAAG,SAASqB,EAAE,GAAG,uCAAuCtB,EAAE,IAAMC,EAAE,GAAG,iBAAiBA,EAAE,GAAG,IACtJ,EACA,GACAC,CAAA,EAEJ,KAAK,eAAeF,EAAGE,CAAO,EAC9B,KAAK,gBAAgBD,EAAGC,CAAO,EAC/B,KAAK,OAAOmG,EAAGnG,CAAO,EACtB,KAAK,eAAeA,CAAO,EAC3B,KAAK,iBAAiBF,EAAGC,EAAGqB,EAAGpB,CAAO,EACtC,KAAK,cAAcA,CAAO,EACtB+E,GACF,KAAK,cACH,GAAGjF,EAAE,IAAMsB,EAAE,GAAG,MAAM6H,EAAiBH,CAAE,CAAC,YAAY1H,EAAE,GAAG,mCAAmCtB,EAAE,GAAG,gBAAgBmJ,EAAiBH,CAAE,CAAC,OACvI,EACA,GACA9I,CAAA,EAEJ,KAAK,cAAcF,EAAGE,CAAO,EAC7B,KAAK,uBAAuB8I,EAAI9I,CAAO,EACvC,KAAK,QAAU,cACf,KAAK,UAAY,EACjB,KAAK,2BAA2BF,EAAGsB,EAAGpB,CAAO,EAC7C,KAAK,QAAU,OACf,KAAK,UAAY,EACb+E,GACF,KAAK,cACH,GAAG3D,EAAE,GAAG,8DACR,EACA,GACApB,CAAA,EAEJ,KAAK,cAAcoB,EAAGpB,CAAO,EAC7B,KAAK,WAAWoB,EAAGpB,CAAO,EAC1B,KAAK,cAAcA,CAAO,EAC1B,KAAK,aAAaF,EAAGsB,EAAGpB,CAAO,EAC/B,KAAK,aAAaA,CAAO,EACzB,KAAK,cAAcA,CAAO,EACnB,CAACF,EAAGC,EAAGqB,CAAC,CACjB,EAYakI,GAA0B,SAErCV,EACAC,EACAE,EACA/I,EAAyB,GACzB,CAEA,MAAMF,EAAI0D,EAAM,EAAG,CAAC,EACdzD,EAAIiG,EAAelG,EAAG+I,EAAIzC,EAAQ,IAAK,EAAE,CAAC,EAC1C+C,EAAM7H,EAAOxB,EAAGC,CAAC,EACvBoJ,EAAI,UAAY,GAChB,MAAMC,EAAMrG,EAAgChD,EAAGoJ,CAAG,EAClDC,EAAI,UAAY,GAChB,MAAMG,EAAMtG,EAAOlD,EAAGgJ,CAAE,EACxBQ,EAAI,UAAY,GAChB,MAAMnI,EAAI4B,EAAoBoG,EAAKG,CAAG,EAChCpD,EAAI1C,EAAWrC,EAAGrB,EAAG,GAAG,EAC9B,IAAIgF,EAAc/E,EAAQ,aAAe,GACzC,OAAI4I,EAAI,SAAW,EACjB7D,EAAc,IAEdjF,EAAE,IAAM8I,EAAI,CAAC,EACb7I,EAAE,IAAM6I,EAAI,CAAC,EACbxH,EAAE,IAAMwH,EAAI,CAAC,GAGXhI,EAASd,EAAGsB,CAAC,EAAI,GAAG,KAAK,YAAY,IAAKpB,CAAO,EACjD+E,GACF,KAAK,cACH,GAAGjF,EAAE,IAAMC,EAAE,GAAG,MAAMkJ,EAAiBJ,CAAE,CAAC,MAC1C,EACA,GACA7I,CAAA,EAEJ,KAAK,gBAAgBmJ,EAAI,qBAAsBnJ,CAAO,EACtD,KAAK,WAAWF,EAAGE,CAAO,EAC1B,KAAK,aAAaF,EAAGC,EAAGC,CAAO,EAC/B,KAAK,WAAWD,EAAGC,CAAO,EACtB+E,GACF,KAAK,cACH,GAAGjF,EAAE,IAAMC,EAAE,IAAMqB,EAAE,GAAG,iCAAiCrB,EAAE,GAAG,SAASqB,EAAE,GAAG,uCAAuCtB,EAAE,IAAMC,EAAE,GAAG,iBAAiBA,EAAE,GAAG,IACtJ,EACA,GACAC,CAAA,EAEJ,KAAK,eAAeF,EAAGE,CAAO,EAC9B,KAAK,gBAAgBD,EAAGC,CAAO,EAC/B,KAAK,OAAOmG,EAAGnG,CAAO,EACtB,KAAK,eAAeA,CAAO,EAC3B,KAAK,iBAAiBF,EAAGC,EAAGqB,EAAGpB,CAAO,EAClC+E,GACF,KAAK,cACH,GAAGhF,EAAE,IAAMqB,EAAE,GAAG,MAAM6H,EAAiBF,CAAE,CAAC,YAAY3H,EAAE,GAAG,UAAU6H,EAAiBF,CAAE,CAAC,UAAUhJ,EAAE,GAAG,8BAA8BD,EAAE,IAAMC,EAAE,GAAG,iBAAiBA,EAAE,GAAG,IACzK,EACA,GACAC,CAAA,EAEJ,KAAK,aAAaD,EAAGC,CAAO,EAC5B,KAAK,cAAcoB,EAAGpB,CAAO,EAC7B,KAAK,eAAeoB,EAAGpB,CAAO,EAC9B,KAAK,WAAWoB,EAAGpB,CAAO,EAC1B,KAAK,QAAU,OACf,KAAK,UAAY,EACjB,KAAK,cAAcA,CAAO,EAC1B,KAAK,aAAaF,EAAGsB,EAAGpB,CAAO,EAC/B,KAAK,aAAaA,CAAO,EACzB,KAAK,cAAcA,CAAO,EAEnB,CAACF,EAAGC,EAAGqB,CAAC,CACjB,EAcaoI,GAA2B,SAEtCC,EACAZ,EACAa,EACAC,EACA3J,EAA2C,GAC3C,CACA,MAAM+B,EAAQqE,EAAQ,IAAK,EAAE,EACvBwD,EAAKF,EACLG,EAAKF,EACL7J,EAAI0D,EAAM,EAAG,CAAC,EACdzD,EAAIiG,EAAelG,EAAG+I,EAAI9G,CAAK,EAC/BL,EAAIsE,EAAelG,EAAG,IAAK8J,EAAK7H,CAAK,EACrC+H,EAAKxJ,EAAgBR,EAAG4B,EAAG,EAAE,EAC7B6D,EAAKjF,EAAgBoB,EAAGoI,EAAI,EAAG,EAC/BzD,EAAIL,EAAejG,EAAG,EAAG,IAAM8J,EAAK9H,CAAK,EACzCgI,EAAKzJ,EAAgBP,EAAGsG,EAAG,EAAE,EAC7B2D,EAAK1J,EAAgB+F,EAAG0D,EAAI,GAAI,EAChCzD,EAAIN,EAAejG,EAAG,IAAK,IAAM8J,EAAK9H,CAAK,EAC3CkI,EAAK3J,EAAgBgG,EAAGyD,EAAI,EAAG,EAC/B1I,EAAIjB,EAASkB,EAAOxB,EAAGC,CAAC,EAAGD,EAAG8J,CAAE,EACtClI,EAAE,UAAY,GACd,MAAMwI,EAAK9J,EAASkB,EAAOvB,EAAGD,CAAC,EAAGC,EAAG,CAAC8J,CAAE,EACxCK,EAAG,UAAY,GACf,MAAM9I,EAAI+I,GAAoB9I,EAAG6I,CAAE,EACnC,IAAInF,EAAc/E,EAAQ,aAAe,GACzC,MAAMoK,GAASpK,EAAQ,QAAU,GACjC,OAAIyJ,EAAI,SAAW,EACjB1E,EAAc,IAEdjF,EAAE,IAAM2J,EAAI,CAAC,EACb1J,EAAE,IAAM0J,EAAI,CAAC,EACbrI,EAAE,IAAMqI,EAAI,CAAC,GAEf,KAAK,QAAU,OACf,KAAK,UAAY,EACjB,KAAK,WAAW3J,EAAGE,CAAO,EACtB+E,GACF,KAAK,cACH,qBAAqBjF,EAAE,IAAMC,EAAE,GAAG,QAAQkJ,EAAiBJ,CAAE,CAAC,OAC9D,EACA,GACA7I,CAAA,EAEJ,KAAK,aAAaF,EAAGC,EAAGC,CAAO,EAC/B,KAAK,WAAWD,EAAGC,CAAO,EAC1B,KAAK,QAAU,OACf,KAAK,UAAY,EACjB,KAAK,kBAAkBF,EAAGE,CAAO,EACjC,KAAK,mBAAmBF,EAAGE,CAAO,EAClC,KAAK,mBAAmB+B,EAAO/B,CAAO,EAClC+E,GACF,KAAK,cACH,wBAAwB6E,CAAE,uCAAuC9J,EAAE,IAAMsB,EAAE,GAAG,KAC9E,EACA,GACApB,CAAA,EAEJ,KAAK,UAAY,EACjB,KAAK,MAAM0B,EAAG6D,EAAI,OAAO,OAAO,GAAIvF,EAAS,CAAE,MAAO,GAAI,CAAC,EAC3D,KAAK,UAAY,EACjB,KAAK,kBAAkBA,CAAO,EAC9B,KAAK,aAAaF,EAAGgK,EAAI9J,CAAO,EAChC,KAAK,aAAaA,CAAO,EACzB,KAAK,YAAYD,EAAGD,EAAGsB,EAAGpB,CAAO,EACjC,KAAK,kBAAkBF,EAAGE,CAAO,EACjC,KAAK,mBAAmBD,EAAGC,CAAO,EAC9B+E,GACF,KAAK,cACH,wBAAwB8E,CAAE,uCAAuC9J,EAAE,IAAMqB,EAAE,GAAG,KAC9E,EACA,GACApB,CAAA,EAEJ,KAAK,UAAY,EACjB,KAAK,MAAMqG,EAAG2D,EAAI,OAAO,OAAO,GAAIhK,EAAS,CAAE,MAAO,GAAI,CAAC,EAC3D,KAAK,MAAMsG,EAAG2D,EAAI,OAAO,OAAO,GAAIjK,EAAS,CAAE,MAAO,GAAI,CAAC,EAC3D,KAAK,UAAY,EACjB,KAAK,kBAAkBA,CAAO,EAC9B,KAAK,aAAaD,EAAGC,CAAO,EAC5B,KAAK,aAAaD,EAAGgK,EAAI/J,CAAO,EAChC,KAAK,YAAYoB,EAAGrB,EAAGD,EAAGE,CAAO,EACjC,KAAK,WAAWoB,EAAGpB,CAAO,EAE1B,KAAK,QAAU,OACf,KAAK,UAAY,EACjB,KAAK,aAAaD,EAAGqB,EAAGpB,CAAO,EAC/B,KAAK,aAAaoB,EAAGtB,EAAGE,CAAO,EAC/B,KAAK,aAAaA,CAAO,EACzB,KAAK,cAAcA,CAAO,EACtB+E,GAAeqF,IACjB,KAAK,cACH,mBAAmBtK,EAAE,IAAMsB,EAAE,GAAG,MAAM6H,EAAiBrI,EAASd,EAAGsB,EAAG,CAAC,CAAC,CAAC,UAAUrB,EAAE,IAAMqB,EAAE,GAAG,MAAM6H,EAAiBrI,EAASb,EAAGqB,EAAG,CAAC,CAAC,CAAC,OACzI,EACA,GACApB,CAAA,EAGG,CAACF,EAAGC,EAAGqB,CAAC,CACjB,EAUaiJ,GAA2B,SAEtCZ,EACAZ,EACAC,EACAY,EACA1J,EAAyB,GACzB,CACA,IAAI+E,EAAc/E,EAAQ,aAAe,GACzC,MAAM+B,EAAQqE,EAAQ,IAAK,EAAE,EACvBwD,EAAKF,EACL5J,EAAI0D,EAAM,EAAG,CAAC,EACdzD,EAAIiG,EAAelG,EAAG+I,EAAI9G,CAAK,EAC/BL,EAAIsE,EAAelG,EAAG,IAAK8J,EAAK7H,CAAK,EACrC+H,EAAKxJ,EAAgBR,EAAG4B,EAAG,EAAE,EAC7B6D,EAAKjF,EAAgBoB,EAAGoI,EAAI,EAAG,EAC/B1I,EAAId,EAAgBR,EAAGgK,EAAIhB,CAAE,EACnC,OAAIW,EAAI,SAAW,EACjB1E,EAAc,IAEdjF,EAAE,IAAM2J,EAAI,CAAC,EACb1J,EAAE,IAAM0J,EAAI,CAAC,EACbrI,EAAE,IAAMqI,EAAI,CAAC,GAEf,KAAK,QAAU,OACf,KAAK,UAAY,EACjB,KAAK,WAAW3J,EAAGE,CAAO,EACtB+E,GACF,KAAK,cACH,qBAAqBjF,EAAE,IAAMC,EAAE,GAAG,QAAQkJ,EAAiBJ,CAAE,CAAC,OAC9D,EACA,GACA7I,CAAA,EAEJ,KAAK,aAAaF,EAAGC,EAAGC,CAAO,EAC/B,KAAK,WAAWD,EAAGC,CAAO,EAC1B,KAAK,QAAU,OACf,KAAK,UAAY,EACjB,KAAK,kBAAkBF,EAAGE,CAAO,EACjC,KAAK,mBAAmBF,EAAGE,CAAO,EAClC,KAAK,mBAAmB+B,EAAO/B,CAAO,EAClC+E,GACF,KAAK,cACH,wBAAwB6E,CAAE,uCAAuC9J,EAAE,IAAMsB,EAAE,GAAG,KAC9E,EACA,GACApB,CAAA,EAEJ,KAAK,UAAY,EACjB,KAAK,MAAM0B,EAAG6D,EAAI,OAAO,OAAO,GAAIvF,EAAS,CAAE,MAAO,GAAI,CAAC,EAC3D,KAAK,UAAY,EACjB,KAAK,kBAAkBA,CAAO,EAC9B,KAAK,aAAaF,EAAGgK,EAAI9J,CAAO,EAChC,KAAK,YAAYD,EAAGD,EAAGsB,EAAGpB,CAAO,EACjC,KAAK,kBAAkBA,CAAO,EAC1B+E,GACF,KAAK,cACH,qBAAqB3D,EAAE,GAAG,wBAAwBtB,EAAE,IAAMsB,EAAE,GAAG,OAAO0H,CAAE,UAAUhJ,EAAE,GAAG,IACvF,EACA,GACAE,CAAA,EAEJ,KAAK,UAAY,EACjB,KAAK,QAAU,OACf,KAAK,eAAeoB,EAAGpB,CAAO,EAC9B,KAAK,WAAWoB,EAAGpB,CAAO,EAC1B,KAAK,aAAaF,EAAGsB,EAAGpB,CAAO,EAC/B,KAAK,cAAcA,CAAO,EACtB+E,GACF,KAAK,cAAc,qBAAqBhF,EAAE,IAAMqB,EAAE,GAAG,KAAM,EAAG,GAAIpB,CAAO,EAC3E,KAAK,aAAaoB,EAAGpB,CAAO,EAC5B,KAAK,cAAcoB,EAAGpB,CAAO,EAC7B,KAAK,aAAaoB,EAAGrB,EAAGC,CAAO,EAC/B,KAAK,aAAaA,CAAO,EACzB,KAAK,cAAcA,CAAO,EACnB,CAACF,EAAGC,EAAGqB,CAAC,CACjB,EASakJ,GAA8B,SAEzCxK,EACAC,EACAoF,EAAe,GACf,CACA,MAAM/D,EAAIhB,EAASL,EAAGD,EAAG,EAAE,EAC3B,OAAAsB,EAAE,IAAM+D,EACR,KAAK,YAAYrF,EAAGC,CAAC,EACrB,KAAK,WAAWD,CAAC,EACjB,KAAK,WAAWC,CAAC,EACjB,KAAK,qBAAqBD,EAAGC,CAAC,EAC9B,KAAK,2BAA2BD,EAAGsB,CAAC,EACpC,KAAK,2BAA2BrB,EAAGqB,CAAC,EACpC,KAAK,WAAWA,CAAC,EACjB,KAAK,gBACL,KAAK,aAAatB,EAAGsB,CAAC,EACtB,KAAK,aAAaA,EAAGrB,CAAC,EACtB,KAAK,eACL,KAAK,gBACL,KAAK,cAAcD,EAAGC,CAAC,EACvB,KAAK,cAAcD,EAAGsB,CAAC,EACvB,KAAK,cAAcrB,EAAGqB,CAAC,EAChB,CAACtB,EAAGC,EAAGqB,CAAC,CACjB,EAQamJ,GAAsB,SAEjCd,EACAZ,EACA,CACA,MAAM/I,EAAI0D,EAAM,EAAG,CAAC,EACdzD,EAAIiG,EAAelG,EAAG+I,EAAIzC,EAAQ,IAAK,EAAE,CAAC,EAC1ChF,EAAIhB,EAASL,EAAGD,EAAG,EAAE,EAC3B,OAAI2J,EAAI,SAAW,IACjB3J,EAAE,IAAM2J,EAAI,CAAC,EACb1J,EAAE,IAAM0J,EAAI,CAAC,EACbrI,EAAE,IAAMqI,EAAI,CAAC,GAEf,KAAK,aAAa3J,EAAGC,CAAC,EACtB,KAAK,WAAWD,CAAC,EACjB,KAAK,WAAWC,CAAC,EACjB,KAAK,qBAAqBD,EAAGC,CAAC,EAC9B,KAAK,2BAA2BD,EAAGsB,CAAC,EACpC,KAAK,2BAA2BrB,EAAGqB,CAAC,EACpC,KAAK,WAAWA,CAAC,EACjB,KAAK,gBACL,KAAK,aAAatB,EAAGsB,CAAC,EACtB,KAAK,aAAaA,EAAGrB,CAAC,EACtB,KAAK,eACL,KAAK,gBACL,KAAK,cAAcD,EAAGC,CAAC,EACvB,KAAK,cAAcD,EAAGsB,CAAC,EACvB,KAAK,cAAcrB,EAAGqB,CAAC,EAChB,CAACtB,EAAGC,EAAGqB,CAAC,CACjB,EAEaoJ,GAA4B,SAEvCf,EACAZ,EACAC,EACA9I,EAAyB,GACzB,CACA,MAAMF,EAAI0D,EAAM,EAAG,CAAC,EACdpC,EAAI4E,EAAelG,EAAGgJ,EAAI1C,EAAQ,IAAK,EAAE,CAAC,EACrCJ,EAAelG,EAAG+I,EAAI,CAAC,EAClC,MAAM4B,EAAKxH,EAAOnD,EAAG+I,CAAE,EACjB6B,EAAKzH,EAAO7B,EAAGyH,CAAE,EACjB9I,EAAI4K,GAAoBF,EAAIC,EAAI,IAAK,CAAC,EAG5C,OAAIjB,EAAI,SAAW,IACjB3J,EAAE,IAAM2J,EAAI,CAAC,EACb1J,EAAE,IAAM0J,EAAI,CAAC,EACbrI,EAAE,IAAMqI,EAAI,CAAC,GAEf,KAAK,WAAW3J,EAAGE,CAAO,EAG1B,KAAK,aAAaF,EAAGsB,EAAGpB,CAAO,EAC/B,KAAK,cAAcF,EAAGE,CAAO,EAC7B,KAAK,WAAWoB,EAAGpB,CAAO,EAC1B,KAAK,uBAAuB6I,EAAI7I,CAAO,EACvC,KAAK,2BAA2BF,EAAGC,EAAGC,CAAO,EAC7C,KAAK,2BAA2BoB,EAAGrB,EAAGC,CAAO,EAC7C,KAAK,WAAWD,EAAGC,CAAO,EAC1B,KAAK,cAAcA,CAAO,EAC1B,KAAK,QAAU,OACf,KAAK,UAAY,EACbA,EAAQ,aACV,KAAK,cACH,YAAYD,EAAE,GAAG,4CACjB,EACA,GACAC,CAAA,EAEJ,KAAK,WAAWD,EAAGC,CAAO,EAC1B,KAAK,aAAaD,EAAGqB,EAAGpB,CAAO,EAC/B,KAAK,aAAaD,EAAGD,EAAGE,CAAO,EAC/B,KAAK,cAAcA,CAAO,EAC1B,KAAK,aAAaA,CAAO,EAClB,CAACF,EAAGC,EAAGqB,CAAC,CACjB,EClgBMwJ,EAAgC,GAE/B,MAAMC,CAAS,CACpB,OAAO,OAAOC,EAAY,CACxB,OAAOF,EAAME,CAAE,CACjB,CAEA,OAAO,QAAQA,EAAYC,EAAa,CACtCH,EAAME,CAAE,EAAIC,CACd,CACF,CA+FA,MAAqBC,EAAS,CA6E5B,aAAc,CA5EdC,EAAA,cACAA,EAAA,eACAA,EAAA,cACAA,EAAA,gBACAA,EAAA,gBACAA,EAAA,sBACAA,EAAA,qBACAA,EAAA,qBACAA,EAAA,sBACAA,EAAA,oCACAA,EAAA,kBACAA,EAAA,sCACAA,EAAA,mBACAA,EAAA,qBACAA,EAAA,qBACAA,EAAA,qBACAA,EAAA,aACAA,EAAA,aACAA,EAAA,aACAA,EAAA,aACAA,EAAA,cACAA,EAAA,eACAA,EAAA,gBACAA,EAAA,iBACAA,EAAA,mBACAA,EAAA,eACAA,EAAA,YACAA,EAAA,2BAAsBxE,IACtBwE,EAAA,0CAAqCpG,IACrCoG,EAAA,kCAA6B5F,IAC7B4F,EAAA,sBAAiBzF,IACjByF,EAAA,2CAAsC3I,IACtC2I,EAAA,iDACEvI,IAEFuI,EAAA,8CACE/H,IAEF+H,EAAA,mDACEvH,IAEFuH,EAAA,6CAAwCnH,IACxCmH,EAAA,kCAA6B/G,IAC7B+G,EAAA,uDACE5G,IAEF4G,EAAA,wCAAmCvG,IACnCuG,EAAA,yBAAoBrG,IACpBqG,EAAA,0BAAqBpL,IACrBoL,EAAA,8BAAyBjK,IACzBiK,EAAA,eAAU9J,IACV8J,EAAA,eAAUtJ,IACVsJ,EAAA,2BAAsBrJ,IACtBqJ,EAAA,yBAAoBhJ,IACpBgJ,EAAA,0BAAqBtC,IACrBsC,EAAA,uCAAkC/B,IAClC+B,EAAA,+BAA0B3B,IAC1B2B,EAAA,gCAA2BzB,IAC3ByB,EAAA,gCAA2BZ,IAC3BY,EAAA,mCAA8BX,IAC9BW,EAAA,2BAAsBV,IACtBU,EAAA,4BAAuB/E,IACvB+E,EAAA,qBAAgBpE,IAChBoE,EAAA,wBAAmBlE,IACnBkE,EAAA,qBAAgB5D,IAChB4D,EAAA,uBAAkB3D,IAClB2D,EAAA,wBAAmBlD,IACnBkD,EAAA,8BAAyB5C,IACzB4C,EAAA,2BAAsB1C,IACtB0C,EAAA,wBAAmBzC,IACnByC,EAAA,0BAAqBxC,IACrBwC,EAAA,gDACE/F,IAEF+F,EAAA,iCAA4BT,IAG1B,KAAK,MAAQ,EACb,KAAK,OAAS,EACd,KAAK,MAAQ,EACb,KAAK,QAAU,GACf,KAAK,QAAU,OACf,KAAK,cAAgB,cACrB,KAAK,aAAe,QACpB,KAAK,aAAe,QACpB,KAAK,cAAgB,UACrB,KAAK,4BAA8B,OACnC,KAAK,UAAY,EACjB,KAAK,8BAAgC,GACrC,KAAK,WAAa,GAClB,KAAK,aAAe,GAEpB,KAAK,aAAe,EACpB,KAAK,aAAe,GAGpB,KAAK,KAAO,EACZ,KAAK,KAAO,EACZ,KAAK,KAAO,EACZ,KAAK,KAAO,EAGZ,KAAK,MAAQ,CACX,WAAY,GACZ,SAAUhH,EAAM,EAAG,CAAC,EACpB,MAAO,EACP,SAAU,GACV,KAAM,KAGR,KAAK,OAAS,CACZ,WAAY,GACZ,SAAUA,EAAM,EAAG,CAAC,EACpB,MAAO,EACP,KAAM,KAGR,KAAK,QAAU,CACb,WAAY,GACZ,SAAUA,EAAM,EAAG,CAAC,EACpB,MAAO,EACP,KAAM,KAGR,KAAK,SAAW,CACd,WAAY,GACZ,SAAUA,EAAM,EAAG,CAAC,EACpB,MAAO,EACP,KAAM,KAGR,KAAK,WAAa,CAChB,WAAY,GACZ,SAAUA,EAAM,EAAG,CAAC,EACpB,MAAO,EACP,MAAO,IACP,KAAM,KAGR,KAAK,OAAS,CACZ,WAAY,GACZ,SAAUA,EAAM,EAAG,CAAC,EACpB,MAAO,EACP,YAAa,SACb,WAAY,EACZ,KAAM,GACN,KAAM,KAGR,KAAK,IAAM,EACb,CAIA,EAAE1D,EAAkB,CAClB,MAAM6D,EAAI,KAAK,OAAO7D,EAAE,EAAI,KAAK,cAAgB,EAAE,EACnD,OAAIA,EAAE,EAAI,KAAK,OACb,KAAK,KAAOA,EAAE,GAEZA,EAAE,EAAI,KAAK,OACb,KAAK,KAAOA,EAAE,GAET6D,CACT,CAEA,EAAE7D,EAAkB,CAClB,MAAM+F,EAAI,KAAK,OAAO,CAAC/F,EAAE,EAAI,KAAK,cAAgB,EAAE,EACpD,OAAIA,EAAE,EAAI,KAAK,OACb,KAAK,KAAOA,EAAE,GAEZA,EAAE,EAAI,KAAK,OACb,KAAK,KAAOA,EAAE,GAET+F,CACT,CAMA,QAAS,CACP,GAAI,KAAK,IAAI,OAAS,EACpB,OAAO,KAAK,IACP,CACL,IAAIqF,EAAU;AAAA,EACd,OAAAA,GAAW;AAAA,EACXA,GAAW,KAAK,aAAa,KAAK;AAAA,CAAI,EACtCA,GAAW;AAAA,mBACJA,CACT,CACF,CAOA,KAAKC,EAAwBC,EAAM,EAAG,CACpC,GAAIC,EAAQ,OAAQ,CAElB,KAAK,yCAEL,MAAMP,EAAK,OAAOK,CAAc,IAAIC,CAAG,GACvC,OAAAP,EAAS,QAAQC,EAAI,KAAK,QAAQ,EACjB,2BAA2BA,CAAE,GAEhD,CACA,MAAO,EACT,CAQA,WAAWQ,EAAM,EAAGF,EAAM,EAAG,CAC3B,GAAIC,EAAQ,OAAQ,CAElB,KAAK,yCAEL,MAAMP,EAAK,OAAOQ,CAAG,IAAIF,CAAG,GAC5B,OAAAP,EAAS,QAAQC,EAAI,KAAK,QAAQ,EACjB,iCAAiCA,CAAE,GAEtD,CACA,MAAO,EACT,CAKA,MAAc,wCAAyC,CACrD,GAAI,eAAe,IAAI,qBAAqB,IAAM,OAChD,GAAI,CACF,KAAM,CAAE,sBAAAS,EAAuB,4BAAAC,GAC7B,MAAAC,GAAA,sCAAAF,EAAA,4BAAAC,CAAA,OAAM,QAAO,qCAAyB,0RACpC,eAAe,IAAI,qBAAqB,IAAM,SAGhD,eAAe,OAAO,sBAAuBD,CAAqB,EAClE,eAAe,OACb,4BACAC,CAAA,EAGN,OAASE,EAAO,CAEd,GACEA,aAAiB,cACjBA,EAAM,OAAS,oBAEf,QAAQ,MAAM,sCAAuCA,EAAM,OAAO,MAElE,OAAMA,CAEV,CAEJ,CAQA,QAAQC,EAAcC,EAAc,CAClC,KAAK,aAAe,EAAID,EACxB,KAAK,aAAeC,EAAO,CAC7B,CAEA,OAAOC,EAAeC,EAAgB,CACpC,KAAK,aAAa,KAAK,mBAAmBD,CAAK,aAAaC,CAAM,MAAM,CAC1E,CAEA,QAAQC,EAAoBjM,EAAkBE,EAAsB,GAAI,CACtE,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,GAAI,CAAC,KAAK+L,CAAK,EAAE,YAAc,KAAKA,CAAK,EAAE,WAAajM,EAAG,CAEzD,IAAIoL,EAAU,GACVrJ,EACA,OAAO/B,EAAM,IAEf+B,EAAK,KAAKkK,CAAK,EAAE,SAEjBlK,EAAK/B,EAEH,KAAKiM,CAAK,EAAE,WAEd,KAAK,SAASA,EAAOlK,EAAI7B,CAAO,GAEhCkL,EAAU,kBAAkBa,CAAK,mCAAmC,KAAK,EAAElK,CAAE,CAAC,eAAe,KAAK,EAAEA,CAAE,CAAC,YAAYmK,CAAK,OACxH,KAAKD,CAAK,EAAE,WAAa,IAE3B,KAAKA,CAAK,EAAE,SAAWlK,EACvB,KAAK,aAAa,KAAKqJ,CAAO,CAChC,CACF,CAEA,aAAapL,EAAmBE,EAAwB,GAAI,CAC1D,KAAK,QAAQ,QAASF,GAAK,KAAK,MAAM,SAAUE,CAAO,CACzD,CAEA,cAAcF,EAAmBE,EAAyB,GAAI,CAC5D,KAAK,QAAQ,SAAUF,GAAK,KAAK,OAAO,SAAUE,CAAO,CAC3D,CAEA,eAAeF,EAAmBE,EAA0B,GAAI,CAC9D,KAAK,QAAQ,UAAWF,GAAK,KAAK,QAAQ,SAAUE,CAAO,CAC7D,CAEA,gBAAgBF,EAAmBE,EAA2B,GAAI,CAChE,KAAK,QAAQ,WAAYF,GAAK,KAAK,SAAS,SAAUE,CAAO,CAC/D,CAEA,cAAcF,EAAmBE,EAAyB,GAAI,CAC5D,KAAK,QAAQ,SAAUF,GAAK,KAAK,OAAO,SAAUE,CAAO,CAC3D,CAEA,kBAAkBF,EAAmBE,EAA6B,GAAI,CACpE,KAAK,QAAQ,aAAcF,GAAK,KAAK,WAAW,SAAUE,CAAO,CACnE,CAEA,QAAQ+L,EAAoB/L,EAAwB,GAAI,CACtD,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,GAAI,KAAK+L,CAAK,EAAE,WAAY,CAE1B,MAAMb,EAAU,kBAAkBa,CAAK,gCAAgCC,CAAK,OAC5E,KAAKD,CAAK,EAAE,WAAa,GACzB,KAAK,aAAa,KAAKb,CAAO,CAChC,CACF,CAEA,aAAalL,EAAwB,GAAI,CACvC,KAAK,QAAQ,QAASA,CAAO,CAC/B,CAEA,cAAcA,EAAyB,GAAI,CACzC,KAAK,QAAQ,SAAUA,CAAO,CAChC,CAEA,eAAeA,EAA0B,GAAI,CAC3C,KAAK,QAAQ,UAAWA,CAAO,CACjC,CAEA,gBAAgBA,EAA2B,GAAI,CAC7C,KAAK,QAAQ,WAAYA,CAAO,CAClC,CAEA,cAAcA,EAAyB,GAAI,CACzC,KAAK,QAAQ,SAAUA,CAAO,CAChC,CAEA,kBAAkBA,EAA6B,GAAI,CACjD,KAAK,QAAQ,aAAcA,CAAO,CACpC,CAEA,SAAS+L,EAAoBjM,EAAkBE,EAAwB,GAAI,CACzE,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MAC9BiM,EAAUjM,EAAQ,SAAW,KAAK,QACxC,GAAI,KAAK+L,CAAK,EAAE,WAAajM,EAAG,CAE9B,MAAMoL,EAAU,kBAAkBa,CAAK,uCAAuC,KAAK,EAAEjM,CAAC,CAAC,eAAe,KAAK,EAAEA,CAAC,CAAC,YAAYkM,CAAK,cAAcC,CAAO,OACrJ,KAAKF,CAAK,EAAE,SAAWjM,EACvB,KAAK,aAAa,KAAKoL,CAAO,CAChC,CACF,CAEA,cAAcpL,EAAkBE,EAAwB,GAAI,CAC1D,KAAK,SAAS,QAASF,EAAGE,CAAO,CACnC,CAEA,cAAc8K,EAAYhL,EAAkBE,EAAsB,GAAI,CACpE,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MAC9BiM,EAAUjM,EAAQ,SAAW,KAAK,QAClCkL,EAAU,6BAA6BJ,CAAE,uCAAuC,KAAK,EAAEhL,CAAC,CAAC,eAAe,KAAK,EAAEA,CAAC,CAAC,YAAYkM,CAAK,cAAcC,CAAO,OAC7J,KAAK,aAAa,KAAKf,CAAO,CAChC,CAEA,eAAepL,EAAkBE,EAAyB,GAAI,CAC5D,KAAK,SAAS,SAAUF,EAAGE,CAAO,CACpC,CAEA,gBAAgBF,EAAkBE,EAA0B,GAAI,CAC9D,KAAK,SAAS,UAAWF,EAAGE,CAAO,CACrC,CAEA,iBAAiBF,EAAkBE,EAA2B,GAAI,CAChE,KAAK,SAAS,WAAYF,EAAGE,CAAO,CACtC,CAEA,eAAeF,EAAkBE,EAAyB,GAAI,CAC5D,KAAK,SAAS,SAAUF,EAAGE,CAAO,CACpC,CAEA,mBAAmBF,EAAkBE,EAA6B,GAAI,CACpE,KAAK,SAAS,aAAcF,EAAGE,CAAO,CACxC,CAEA,SACE+L,EACAhK,EACA/B,EAAyB,GACzB,CACA,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MAC9BkM,EAAOlM,EAAQ,MAAQ,KAAK,MAAM,KAAK,QAAU,CAAC,EACxD,IAAImM,EAOJ,GANI,OAAOpK,GAAU,SACnBoK,EAAkBpK,EAGlBoK,EADU7K,EAAO,KAAKyK,CAAK,EAAE,SAAUhK,CAAK,EACxB,qBAElB,KAAKgK,CAAK,EAAE,QAAUhK,EAAO,CAG/B,MAAMmJ,EAAU,kBAAkBa,CAAK,iCAAiC,GAAKI,CAAe,YAAYH,CAAK,WAAWE,CAAI,OAC5H,KAAKH,CAAK,EAAE,MAAQI,EAChB,OAAOA,GAAoB,UAAY,SAASA,CAAe,EACjE,KAAK,aAAa,KAAKjB,CAAO,EAE9B,QAAQ,MAAM,8CAA+Ca,CAAK,CAEtE,CACF,CAEA,cAAchK,EAA+B/B,EAAwB,GAAI,CACvE,KAAK,SAAS,QAAS+B,EAAO/B,CAAO,CACvC,CAEA,eAAe+B,EAA+B/B,EAAyB,GAAI,CACzE,KAAK,SAAS,SAAU+B,EAAO/B,CAAO,CACxC,CAEA,gBAAgB+B,EAA+B/B,EAA0B,GAAI,CAC3E,KAAK,SAAS,UAAW+B,EAAO/B,CAAO,CACzC,CAEA,iBACE+B,EACA/B,EAA2B,GAC3B,CACA,KAAK,SAAS,WAAY+B,EAAO/B,CAAO,CAC1C,CAEA,eAAe+B,EAA+B/B,EAAyB,GAAI,CACzE,KAAK,SAAS,SAAU+B,EAAO/B,CAAO,CACxC,CAEA,mBACE+B,EACA/B,EAA6B,GAC7B,CACA,KAAK,SAAS,aAAc+B,EAAO/B,CAAO,CAC5C,CAOA,KAAK+L,EAAoBK,EAAiBpM,EAAsB,GAAI,CAClE,MAAMgM,EAAQhM,EAAQ,OAAS,EAC/B,KAAK+L,CAAK,EAAE,KAAOK,EACnB,KAAK,aAAa,KAChB,oBAAoBA,CAAO,6BAA6BL,CAAK,YAAYC,CAAK,OAElF,CAOA,UAAUI,EAAiBpM,EAAsB,GAAI,CACnD,KAAK,KAAK,QAASoM,EAASpM,CAAO,EACnC,KAAK,MAAM,SAAY,KAAK,MAAM,SAAWoM,EAAW,GAC1D,CAOA,YAAYA,EAAiBpM,EAAsB,GAAI,CACrD,KAAK,KAAK,UAAWoM,EAASpM,CAAO,CACvC,CAOA,aAAaoM,EAAiBpM,EAAsB,GAAI,CACtD,KAAK,KAAK,WAAYoM,EAASpM,CAAO,CACxC,CAOA,eAAeoM,EAAiBpM,EAAsB,GAAI,CACxD,KAAK,KAAK,aAAcoM,EAASpM,CAAO,CAC1C,CAOA,WAAWoM,EAAiBpM,EAAsB,GAAI,CACpD,KAAK,KAAK,SAAUoM,EAASpM,CAAO,CACtC,CAaA,WAAWF,EAAkBE,EAAwB,GAAI,CACvD,MAAMqM,EAAQrM,EAAQ,OAASF,EAAE,IAC3BwM,EAAUtM,EAAQ,cAAgBA,EAAQ,SAAW,KAAK,aAC1DgM,EAAQhM,EAAQ,OAAS,KAAK,MAC9BuM,EAAevM,EAAQ,cAAgBsM,EACzCtM,EAAQ,GACVF,EAAE,GAAKE,EAAQ,IAEf,KAAK,QACLF,EAAE,GAAK,KAAK,OAEd,IAAIoL,EACJ,GAAImB,EAAO,CACTnB,EAAU,qBAAqB,KAAK,EAAEpL,CAAC,CAAC,eAAe,KAAK,EAAEA,CAAC,CAAC,cAAcwM,CAAO,SAASxM,EAAE,EAAE,4CAA4CkM,CAAK,MAEnJ,MAAM3L,EAAImD,EAAM1D,EAAE,EAAGA,EAAE,CAAC,EACpBE,EAAQ,KACVK,EAAE,GAAKL,EAAQ,IAEbA,EAAQ,KACVK,EAAE,GAAKL,EAAQ,IAEjB,KAAK,WAAW,IAAIqM,CAAK,IAAKhM,EAAG,CAAE,MAAO,EAAG,QAASkM,CAAA,CAAc,CACtE,MACErB,EAAU,qBAAqB,KAAK,EAAEpL,CAAC,CAAC,eAAe,KAAK,EAAEA,CAAC,CAAC,cAAcwM,CAAO,SAASxM,EAAE,EAAE,4CAA4CkM,CAAK,OAErJ,KAAK,aAAa,KAAKd,CAAO,CAChC,CAOA,eAAesB,EAAwC,CACrD,MAAMxM,EAAwB,CAAE,MAAO,GACvCwM,EACG,OAAQC,GAAQ,EAAEA,aAAeC,EAAc,EAC/C,QAASC,GAAW,CAEnB,OAAO,OAAO3M,EAAS2M,CAAM,CAC/B,CAAC,EACHH,EACG,OAAQC,GAAQA,aAAeC,CAAa,EAC5C,QAASlJ,GAAU,CAClB,KAAK,WAAWA,EAAOxD,CAAO,CAChC,CAAC,CACL,CAOA,gBAAgBwM,EAAwC,CACtD,MAAMxM,EAAwB,CAAE,MAAO,GACvCwM,EACG,OAAQC,GAAQ,EAAEA,aAAeC,EAAc,EAC/C,QAASC,GAAW,CAEnB,OAAO,OAAO3M,EAAS2M,CAAM,CAC/B,CAAC,EACHH,EACG,OAAQC,GAAQA,aAAeC,CAAa,EAC5C,QAASlJ,GAAU,CAClB,KAAK,aAAa,KAChB,eAAeA,EAAM,EAAE,8CAA8CxD,EAAQ,KAAK,OAEtF,CAAC,CACL,CAOA,aAAaF,EAAkBE,EAAwB,GAAI,CACzD,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,KAAK,aAAa,KAChB,eAAeF,EAAE,EAAE,8CAA8CkM,CAAK,OAE1E,CASA,cACElM,EACA6D,EACAkC,EACA7F,EAAwB,GACxB,CACA,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MAC9BiM,EAAUjM,EAAQ,SAAW,KAAK,QAClCD,EAAIyD,EAAMG,EAAGkC,CAAC,EACpB,KAAK,aAAa,KAChB,qBAAqB,KAAK,EAAE9F,CAAC,CAAC,eAAe,KAAK,EAAEA,CAAC,CAAC,SAASD,EAAE,EAAE,kDAAkDkM,CAAK,cAAcC,CAAO,OAEnJ,CAQA,YAAYnM,EAAkBsF,EAAapF,EAAwB,GAAI,CAErE,MAAMK,EAAImD,EAAM1D,EAAE,EAAGA,EAAE,CAAC,EACpBE,EAAQ,KACVK,EAAE,GAAKL,EAAQ,IAEbA,EAAQ,KACVK,EAAE,GAAKL,EAAQ,IAEjB,KAAK,WAAW,IAAIoF,CAAG,IAAK/E,EAAGL,CAAO,CAExC,CAYA,gBAAgBA,EAAyB,GAAI,CAE3C,MAAMkL,EAAU,uDADFlL,EAAQ,OAAS,KAAK,KACwC,OACxE,KAAK,OAAO,cAAgB,SAC9B,KAAK,OAAO,YAAc,SAE1B,KAAK,OAAO,YAAc,SAE5B,KAAK,aAAa,KAAKkL,CAAO,CAChC,CAOA,cAAczD,EAAWzH,EAAyB,GAAI,CACpD,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MAC9BiM,EAAUjM,EAAQ,SAAW,KAAK,QAClCkL,EAAU,kBAAkBzD,EAAI,EAAE,+CAA+CuE,CAAK,cAAcC,CAAO,OACjH,KAAK,OAAO,WAAaxE,EACzB,KAAK,aAAa,KAAKyD,CAAO,CAChC,CAOA,uBAAuBzD,EAAWzH,EAAyB,GAAI,CAC7D,KAAK,cAAc,EAAGA,CAAO,EAC7B,KAAK,aAAa,KAAK,OAAO,SAAUA,CAAO,EAC/C,KAAK,cAAc,KAAK,OAAO,SAAUA,CAAO,EAChD,KAAK,cAAc,KAAK,OAAO,SAAUA,CAAO,EAChD,KAAK,eAAe,EAAGA,CAAO,EAC9B,KAAK,cAAcyH,EAAGzH,CAAO,CAC/B,CAQA,qBACEF,EACAC,EACAC,EAAyB,GACzB,CACA,KAAK,cAAcF,EAAGE,CAAO,EAC7B,KAAK,eAAeF,EAAGE,CAAO,EAC9B,MAAM,EAAI4M,EAAQ9M,EAAGC,CAAC,EACtB,EAAE,UAAY,GACd,MAAMgC,EAAQ,EAAE,qBAChB,KAAK,eAAeA,EAAO/B,CAAO,EAClC,KAAK,cAAcY,EAASd,EAAGC,CAAC,EAAGC,CAAO,CAC5C,CAMA,YAAYA,EAAyB,GAAI,CACvC,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,GAAI,CAAC,KAAK,OAAO,KAAM,CAErB,MAAMkL,EAAU,mDAAmDc,CAAK,MACxE,KAAK,OAAO,KAAO,GACnB,KAAK,aAAa,KAAKd,CAAO,CAChC,CACF,CAMA,cAAclL,EAAyB,GAAI,CACzC,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,GAAI,KAAK,OAAO,KAAM,CAEpB,MAAMkL,EAAU,qDAAqDc,CAAK,OAC1E,KAAK,OAAO,KAAO,GACnB,KAAK,aAAa,KAAKd,CAAO,CAChC,CACF,CASA,uBACE2B,EACAC,EACA9M,EAAyB,GACzB,CACA,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MAC9BkM,EAAOlM,EAAQ,MAAQ,KAAK,QAAU,EACtC+M,EAAY/M,EAAQ,WAAa,GACjCgN,EAAgBhN,EAAQ,eAAiB,KAAK,cAC9CiN,EAAkBjN,EAAQ,WAAa,oBAAsB,GACnE,KAAK,OAAS,EAEZ,KAAK,IAAI,KAAK,OAAO,MAAQ6M,CAAM,EACnC,KAAK,IAAI,KAAK,OAAO,MAAQC,CAAM,IAGlC,CAACD,EAAQC,CAAM,EAAI,CAACA,EAAQD,CAAM,GAErC,IAAI3B,EAAU,iBAAiBgB,CAAI,YAAY,CAACW,CAAM,gDAAgDb,CAAK;AAAA,EAC3Gd,GAAW;AAAA,EACXA,GAAW,iBAAiBgB,CAAI,YAAY,CAACW,CAAM;AAAA,EACnD,IAAIK,EACJ,OAAIJ,EAASD,EACXK,EAAYhB,EAEZgB,EAAY,GAAKhB,EAEnBhB,GAAW,oBAAoB8B,CAAa,gBAAgBD,CAAS,WAAWG,CAAS,YAAY,CAACL,CAAM,UAAU,CAACC,CAAM,wCAAwCG,CAAe,QAAQ,KAAK,KAAK;AAAA,EACtM/B,GAAW,qDAAqDc,CAAK,MACrE,KAAK,OAAO,MAAQc,EACpB,KAAK,aAAa,KAAK5B,CAAO,EACvB,KAAK,KACd,CASA,2BACEpE,EACAtD,EACAxD,EAAyB,GACzB,CACA,MAAMmN,EAAQnN,EAAQ,OAAS,GAC/B,KAAK,cAAc,KAAK,OAAO,SAAUA,CAAO,EAChD,KAAK,eAAe8G,EAAQ9G,CAAO,EACnC,MAAMoN,EAAIR,EAAQ9F,EAAQtD,CAAK,EAC/B4J,EAAE,WAAa,GACf,MAAMP,EAASO,EAAE,qBAAuBD,EAClCL,EAASM,EAAE,qBAAuBD,EACxC,OACE,KAAK,IAAI,KAAK,OAAO,WAAavM,EAAS,KAAK,OAAO,SAAU4C,CAAK,CAAC,EACvE,IAEA,KAAK,cAAc5C,EAASkG,EAAQtD,CAAK,EAAGxD,CAAO,EAE9C,KAAK,uBAAuB6M,EAAQC,EAAQ9M,CAAO,CAC5D,CAQA,wBACE8G,EACAtD,EACAxD,EAAyB,GACzB,CACA,KAAK,qBAAqB8G,EAAQtD,EAAOxD,CAAO,EAEhD,MAAM6M,EADIvL,EAAOwF,EAAQtD,CAAK,EACb,qBACjB,KAAK,uBAAuBqJ,EAAQA,EAAS,IAAK7M,CAAO,CAC3D,CAaA,uBAAuBqN,EAAqBrN,EAA2B,GAAI,CACzE,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MAC9BiM,EAAUjM,EAAQ,SAAW,KAAK,QACxC,KAAK,aAAa,KAChB,qBAAqBqN,EAAc,EAAE,iDAAiDrB,CAAK,cAAcC,CAAO,OAEpH,CA6BA,wCAAwCjM,EAA6B,GAAI,CACvE,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,KAAK,aAAa,KAChB,iEAAiEgM,CAAK,MAE1E,CAMA,wCAAwChM,EAA6B,GAAI,CACvE,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,KAAK,aAAa,KAChB,iEAAiEgM,CAAK,MAE1E,CAMA,wCAAwChM,EAA6B,GAAI,CACvE,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,KAAK,aAAa,KAChB,sDAAsDgM,CAAK,MAE/D,CAMA,wCAAwChM,EAA6B,GAAI,CACvE,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,KAAK,aAAa,KAChB,6DAA6DgM,CAAK,MAEtE,CAQA,kCACElM,EACAC,EACAC,EAA6B,GAC7B,CACA,MAAMqB,EAAIC,EAAOxB,EAAGC,CAAC,EACrBsB,EAAE,UAAY,GACd,KAAK,kBAAkB,KAAK,WAAW,SAAUrB,CAAO,EACxD,KAAK,mBAAmBF,EAAGE,CAAO,EAClC,KAAK,mBAAmBqB,EAAE,qBAAsBrB,CAAO,CACzD,CAOA,4BAA4B+B,EAAe/B,EAAyB,GAAI,CACtE,MAAMC,EAAI,KAAK,WAAW,SACpBqN,EAAgB,KAAK,WAAW,MAAQ,KAAK,WAAW,KAAQ,IAChEjN,EAAI2F,EAAe/F,EAAGqN,EAAcvL,EAAQ,KAAK,WAAW,KAAK,EACjExB,EAAIyF,EACR/F,EACAqN,EAAe,GACfvL,EAAQ,KAAK,WAAW,OAE1B,KAAK,cAAc,KAAK,OAAO,SAAU/B,CAAO,EAChD,KAAK,eAAeK,EAAGL,CAAO,EAC9B,KAAK,OAAOO,EAAGP,CAAO,CACxB,CASA,gCACEF,EACAC,EACAgC,EACA/B,EAAyB,GACzB,CACA,GAAI+B,EAAQ,EACV,KAAK,kCAAkCjC,EAAGC,EAAGC,CAAO,EACpD,KAAK,4BAA4B+B,EAAO/B,CAAO,MAC1C,CACL,MAAMuN,EAAKnN,EAASL,EAAGD,EAAG,GAAG,EAC7B,KAAK,kCAAkCA,EAAGyN,EAAIvN,CAAO,EACrD,KAAK,4BAA4B,IAAM,KAAK,IAAI+B,CAAK,EAAG/B,CAAO,CACjE,CACA,MAAMqB,EAAIC,EAAOxB,EAAGC,CAAC,EACrBsB,EAAE,UAAY,GACd,MAAMhB,EAAI2F,EACRlG,EACC,KAAK,WAAW,MAAQ,KAAK,WAAW,KAAQ,IACjDuB,EAAE,qBAAuBU,CAAA,EAE3B,KAAK,kBAAkB/B,CAAO,EAC9B,KAAK,4BAA4BF,EAAGO,EAAGL,CAAO,CAChD,CAYA,wBAAwBA,EAAsB,GAAI,CAChD,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,KAAK,aAAa,KAChB,iDAAiDgM,CAAK,MAE1D,CAMA,wBAAwBhM,EAAsB,GAAI,CAChD,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,KAAK,aAAa,KAChB,wDAAwDgM,CAAK,MAEjE,CAOA,sBAAsBpL,EAAW,GAAIZ,EAAsB,GAAI,CAC7D,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,KAAK,MAAM,SAAWY,EACtB,KAAK,aAAa,KAChB,iEAAiE,KAAK,MAAM,QAAQ,YAAYoL,CAAK,MAEzG,CAQA,4BACE/L,EACAH,EACAE,EAAwB,GACxB,CACA,MAAMY,EAAWZ,EAAQ,UAAY,KAAK,MAAM,SAC1CK,EAAIC,EAAgBL,EAAGH,EAAGc,CAAQ,EACxC,KAAK,aAAaX,EAAGI,EAAGL,CAAO,CACjC,CAQA,YAAYF,EAAkBC,EAAkBC,EAAwB,GAAI,CAC1E,MAAM2C,EAAgB3C,EAAQ,UAAY,KAAK,MAAM,SAC/CK,EAAIoD,EACR1D,EACAD,GACC,CAAC6C,EAAgB,GAAM/B,EAASd,EAAGC,CAAC,EAAI,IAAOa,EAASd,EAAGC,CAAC,GAEzDQ,EAAIkD,EACR3D,EACAC,GACC,CAAC4C,EAAgB,GAAM/B,EAASd,EAAGC,CAAC,EAAI,IAAOa,EAASd,EAAGC,CAAC,GAE3D,KAAK,EAAED,CAAC,GAAK,KAAK,EAAEC,CAAC,GACvB,KAAK,aAAaM,CAAC,EACnB,KAAK,cAAcE,EAAGP,CAAO,EAC7B,KAAK,aAAaK,EAAGE,EAAGP,CAAO,IAE/B,KAAK,aAAaO,CAAC,EACnB,KAAK,cAAcF,EAAGL,CAAO,EAC7B,KAAK,aAAaO,EAAGF,EAAGL,CAAO,EAEnC,CAQA,sBACEF,EACAC,EACAC,EAAwB,GACxB,CACA,MAAMY,EAAWZ,EAAQ,UAAY,KAAK,MAAM,SAAW,EAC3D,GAAIY,EAAW,EAAG,CAChB,MAAM0E,EAAKhF,EAAgBP,EAAGD,EAAG,CAAC,EAC5ByN,EAAKjN,EAAgBP,EAAGD,EAAG,CAACc,CAAQ,EAC1C,KAAK,aAAa0E,EAAIiI,EAAIvN,CAAO,CACnC,KAAO,CACL,MAAM6B,EAAKvB,EAAgBR,EAAGC,EAAG,CAAC,EAC5ByN,EAAKlN,EAAgBR,EAAGC,EAAGa,CAAQ,EACzC,KAAK,aAAaiB,EAAI2L,EAAIxN,CAAO,CACnC,CACF,CAcA,OAAOD,EAAkBC,EAAyB,GAAI,CACpD,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MAC9BiM,EAAUjM,EAAQ,SAAW,KAAK,QAClC+M,EAAY/M,EAAQ,WAAa,KAAK,UACtCsM,EAAUtM,EAAQ,SAAW,KAAK,QAElCiN,EADajN,EAAQ,YAAc,KAAK,WACT,oBAAsB,GACrDyN,EAAezN,EAAQ,QAAU,kBAAoB,GAC3D,KAAK,OAAS,EACd,MAAMkL,EAAU,qBAAqB,KAAK,EAAEnL,CAAC,CAAC,eAAe,KAAK,EAAEA,CAAC,CAAC,gBAAgBgN,CAAS,cAAcT,CAAO,8CAA8CN,CAAK,cAAcC,CAAO,MAAMgB,CAAe,IAAIQ,CAAY,QAAQ,KAAK,KAAK,OACnP,YAAK,OAAO,SAAW1N,EACvB,KAAK,aAAa,KAAKmL,CAAO,EACvB,KAAK,KACd,CASA,MAAMpL,EAAkBC,EAAkBC,EAAyB,GAAI,CACrE,YAAK,eAAeF,EAAGE,CAAO,EACvB,KAAK,OAAOD,EAAGC,CAAO,CAC/B,CASA,YAAYF,EAAkBC,EAAkBC,EAAyB,GAAI,CAG3E,YAAK,eAAeF,EAAG,OAAO,OAAO,CAAE,QAAO,aAAWE,CAAO,CAAC,EAC1D,KAAK,OAAOD,EAAG,OAAO,OAAO,CAAE,QAAO,aAAWC,CAAO,CAAC,CAClE,CAOA,aAAa8K,EAAY9K,EAAyB,GAAI,CACpD,MAAMiM,EAAUjM,EAAQ,SAAW,IACnC,KAAK,aAAa,KAChB,iDAAiD8K,CAAE,cAAcmB,CAAO,OAE5E,CASA,aACEyB,EACAC,EACAC,EACA,CACA,IAAI9N,EAAkBC,EAClB+K,EAAa,GACb9K,EAAwB,GAC5B,OAAI0N,aAAgBG,GAClB/N,EAAI4N,EAAK,WACT3N,EAAI2N,EAAK,WACLC,aAAgBjB,EAClB,OAAO,OACL,mGACA,CAAE,KAAAgB,EAAM,KAAAC,EAAM,KAAAC,CAAA,CAAK,EAGjB,OAAOD,GAAS,WAClB3N,EAAU2N,KAIVD,aAAgBhB,GAAiBiB,aAAgBjB,GACnD5M,EAAI4N,EACJ3N,EAAI4N,IAEJ,OAAO,OACL,4FACA,CAAE,KAAAD,EAAM,KAAAC,EAAM,KAAAC,CAAA,CAAK,EAErB9N,EAAIgO,EAAc,EAAG,CAAC,EACtB/N,EAAI+N,EAAc,EAAG,CAAC,GAEpB,OAAOF,GAAS,WAClB5N,EAAU4N,IAGV9N,EAAE,GAAKC,EAAE,GAEX,KAAK,aAAaD,EAAGE,CAAO,EAC5B,KAAK,cAAcD,EAAGC,CAAO,IAE7B,KAAK,aAAaD,EAAGC,CAAO,EAC5B,KAAK,cAAcF,EAAGE,CAAO,GAE3B,KAAK,QAAU,OAEfY,EAAS,KAAK,OAAO,SAAUd,CAAC,EAAIc,EAAS,KAAK,OAAO,SAAUb,CAAC,GAGpE,KAAK,cAAcD,EAAGE,CAAO,EAC7B8K,EAAK,KAAK,OAAO/K,EAAGC,CAAO,IAE3B,KAAK,cAAcD,EAAGC,CAAO,EAC7B8K,EAAK,KAAK,OAAOhL,EAAGE,CAAO,IAGxB8K,CACT,CAMA,kBAAkBiD,EAA0B,CAC1C,QAAShI,EAAI,EAAGA,EAAIgI,EAAQ,OAAS,EAAGhI,IACtC,KAAK,aAAagI,EAAQhI,CAAC,EAAGgI,EAAQhI,EAAI,CAAC,CAAC,EAE9C,KAAK,aAAagI,EAAQA,EAAQ,OAAS,CAAC,EAAGA,EAAQ,CAAC,CAAC,CAC3D,CAMA,kBAAkBvB,EAAyC,CACzD,MAAMuB,EAA2B,GAC3BpB,EAAwB,GAY9B,GAXAH,EAAK,QAASC,GAAQ,CAChBA,aAAeC,EACjBqB,EAAQ,KAAKtB,CAAG,EACP,OAAOA,GAAQ,SACxB,OAAO,OAAOE,EAAQF,CAAG,EAEzB,OAAO,OAAO,wDAAyD,CACrE,IAAAA,CAAA,CACD,CAEL,CAAC,EACGsB,EAAQ,OAAS,EAAG,CACtB,QAAShI,EAAI,EAAGA,EAAIgI,EAAQ,OAAS,EAAGhI,IACtC,KAAK,YAAYgI,EAAQhI,CAAC,EAAGgI,EAAQhI,EAAI,CAAC,EAAG4G,CAAM,EAErD,KAAK,YAAYoB,EAAQA,EAAQ,OAAS,CAAC,EAAGA,EAAQ,CAAC,EAAGpB,CAAM,CAClE,KACE,OAAM,MACJ,kFAAkF,KAAK,UAAUoB,CAAO,CAAC,IAE/G,CAeA,WAAWC,EAAelO,EAAkBE,EAAwB,GAAI,CACtE,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,KAAK,QACL,MAAMiO,EAAcjO,EAAQ,OAAS,WAAWA,EAAQ,MAAM,IAAM,GACpE,IAAIkO,EAAgB,GAChBlO,EAAQ,cACVkO,GAAiB,kBAAkBlO,EAAQ,WAAW,KAEpDA,EAAQ,cACVkO,GAAiB,kBAAkBlO,EAAQ,WAAW,KAEpDA,EAAQ,eACVkO,GAAiB,mBAAmBlO,EAAQ,YAAY,KAEtDA,EAAQ,iBACVkO,GAAiB,qBAAqBlO,EAAQ,cAAc,KAE1DA,EAAQ,QACVkO,GAAiB,WAAWlO,EAAQ,KAAK,KAEvCA,EAAQ,cACVkO,GAAiB,kBAAkBlO,EAAQ,WAAW,KAEpDA,EAAQ,cACVkO,GAAiB,kBAAkBlO,EAAQ,WAAW,KAEpDA,EAAQ,WACVkO,GAAiB,eAAelO,EAAQ,QAAQ,KAE9CA,EAAQ,YACVkO,GAAiB,gBAAgBlO,EAAQ,SAAS,KAEhDA,EAAQ,SACVkO,GAAiB,YAAYlO,EAAQ,MAAM,KAE7C,IAAIkL,EAAU,qBAAqB,KAAK,EAAEpL,CAAC,CAAC,eAAe,KAAK,EAAEA,CAAC,CAAC,SAAS,KAAK,KAAK,uCACvF,OAAAoL,GAAW;AAAA,UAAa+C,CAAW,aAAajO,EAAQ,SAAW,KAAK,YAAY,YAAYgO,CAAK,SAAS,KAAK,KAAK,sCAAsCE,CAAa,WAAWlC,CAAK,OAC3L,KAAK,aAAa,KAAKd,CAAO,EACvB,KAAK,KACd,CASA,cACE8C,EACArK,EACAkC,EACA7F,EAAwB,GACxB,CACA,MAAMF,EAAI0D,EAAMG,EAAGkC,CAAC,EACpB,OAAO,KAAK,WAAWmI,EAAOlO,EAAGE,CAAO,CAC1C,CAEA,gBACEF,EACAC,EACAoO,EACAnO,EAAwB,GACxB,CACA,MAAMyH,EAAI7G,EAASd,EAAGC,CAAC,EACjBiH,EAAI5C,EAAQtE,EAAGC,CAAC,EAChBqO,EAAIhK,EAAS,CAAC4C,EAAE,EAAImH,EAAME,EAAMrH,CAAC,EAAIA,EAAE,EAAImH,EAAME,EAAMrH,CAAC,CAAC,EACzDsH,EAAUnK,EACdA,EAAY7D,EAAgBR,EAAGC,EAAG0H,EAAI,EAAI,EAAG,EAAG2G,CAAC,EACjDhK,EAAQ,EAAG,CAAC,GAEd,OAAO,KAAK,WAAW,GAAGqD,CAAC,MAAO6G,EAAStO,CAAO,CACpD,CAEA,YAAYF,EAAkBG,EAAkBF,EAAkB,CAChE,MAAMwO,EAAIvM,EAAalC,EAAGG,EAAGF,CAAC,EACxBqB,EAAI+C,EACRV,EAAWrD,EAASN,EAAGG,EAAGsO,EAAI,CAAC,EAAGtO,EAAG,IAAMW,EAASX,EAAGH,CAAC,CAAC,EACzDsE,EAAQ,IAAM,EAAG,GAEnB,OAAO,KAAK,WAAW,KAAK,IAAImK,CAAC,EAAI,IAAKnN,CAAC,CAC7C,CAOA,gBAAgBoL,EAA+B,CAC7C,MAAMxM,EAAsB,CAAE,MAAO,GACrCwM,EACG,OAAQC,GAAU,OAAOA,GAAQ,QAAS,EAC1C,QAASE,GAAW,CAEnB,OAAO,OAAO3M,EAAS2M,CAAM,CAC/B,CAAC,EACHH,EACG,OAAQC,GAAQ,OAAOA,GAAQ,QAAQ,EACvC,QAAS3B,GAAO,CACf,KAAK,aAAa,KAChB,iDAAiDA,CAAE,YAAY9K,EAAQ,KAAK,OAEhF,CAAC,CACL,CASA,mBAAmBgO,EAAelD,EAAYwB,EAAiB,CAC7D,KAAK,aAAa,KAChB;AAAA,mBAAsBA,CAAO,YAAY0B,CAAK,SAASlD,CAAE,wCAE7D,CAKA,OAAQ,CACN,KAAK,aAAa,KAAK,8BAA8B,CACvD,CAeA,cACE4C,EACAC,EACAC,EACA,CACA,IAAI,EACA5N,EAAwB,GACxB0N,aAAgBG,GAClB,EAAIH,EACAC,aAAgBjB,EAClB,OAAO,OACL,mGACA,CAAE,KAAAgB,EAAM,KAAAC,EAAM,KAAAC,CAAA,CAAK,EAGjB,OAAOD,GAAS,WAClB3N,EAAU2N,KAIVD,aAAgBhB,GAAiBiB,aAAgBjB,EACnD,EAAIE,EAAQc,EAAMC,CAAI,GAEtB,OAAO,OACL,6FACA,CAAE,KAAAD,EAAM,KAAAC,EAAM,KAAAC,CAAA,CAAK,EAErB,EAAIhB,EAAQkB,EAAc,EAAG,CAAC,EAAGA,EAAc,EAAG,CAAC,CAAC,GAElD,OAAOF,GAAS,WAClB5N,EAAU4N,IAGd,MAAM5B,EAAQhM,EAAQ,OAAS,KAAK,MAC9BsM,EACJtM,EAAQ,eAAiBA,EAAQ,SAAW,KAAK,cAC7CiB,EAASjB,EAAQ,QAAU,KACjC,KAAK,QACL,MAAM8K,EAAK,KAAK,MACVzK,EAAIH,EAAO,EAAE,WAAY,EAAE,UAAU,EACrCgL,EAAU,qBAAqB,KAAK,EAAE7K,CAAC,CAAC,eAAe,KAAK,EAAEA,CAAC,CAAC,YAAYY,CAAM,eAAeqL,CAAO,SAASxB,CAAE,YAAYkB,CAAK,0CAC1I,YAAK,aAAa,KAAKd,CAAO,EACvBJ,CACT,CAOA,qBAAqBA,EAAY9K,EAAsB,GAAI,CACzD,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,KAAK,aAAa,KAChB,eAAe8K,CAAE,iDAAiDkB,CAAK,OAE3E,CAOA,qBAAqBlB,EAAY9K,EAAsB,GAAI,CACzD,MAAMgM,EAAQhM,EAAQ,OAAS,KAAK,MACpC,KAAK,aAAa,KAChB,eAAe8K,CAAE,iDAAiDkB,CAAK,OAE3E,CAUA,iBACElM,EACAC,EACAqB,EACApB,EAAwB,GACxB,CACA,MAAMY,EAAWZ,EAAQ,UAAY,GAC/BsM,EACJtM,EAAQ,eAAiBA,EAAQ,SAAW,KAAK,cACnD,KAAK,gBACL,MAAM8B,EAAKxB,EAAgBP,EAAGqB,EAAGR,CAAQ,EACnCiB,EAAKvB,EAAgBP,EAAGD,EAAGc,CAAQ,EACnCP,EAAIsE,EAAmB9C,EAAI9B,EAAG+B,CAAE,EAChC0M,EAAW,CAAE,GAAGxO,CAAA,EACtBwO,EAAS,MAAQ,EACjB,MAAMC,EAAS,KAAK,MAAM3M,EAAIzB,EAAG,OAAO,OAAO,GAAImO,EAAU,CAAE,QAAAlC,CAAA,CAAS,CAAC,EACnEoC,EAAS,KAAK,MAAMrO,EAAGwB,EAAI,OAAO,OAAO,GAAI7B,EAAS,CAAE,QAAAsM,CAAA,CAAS,CAAC,EACxE,MAAO,CAACmC,EAAQC,CAAM,CACxB,CAOA,wBAAwB5D,EAAsB9K,EAAsB,GAAI,CACtE,MAAMgM,EAAQhM,EAAQ,OAAS,EAC/B,KAAK,aAAa8K,EAAG,CAAC,EAAG,OAAO,OAAO,CAAE,MAAAkB,GAAShM,CAAO,CAAC,EAC1D,KAAK,aAAa8K,EAAG,CAAC,EAAG,OAAO,OAAO,CAAE,MAAAkB,GAAShM,CAAO,CAAC,CAC5D,CAaA,YACED,EACAD,EACAsB,EACApB,EAAyB,GACzB,CACA,MAAMsM,EACJtM,EAAQ,eAAiBA,EAAQ,SAAW,KAAK,cAC7CiB,EAASjB,EAAQ,QAAU,QAC3B2O,EAAQ3O,EAAQ,OAAS,EACzBgM,EAAQhM,EAAQ,OAAS,KAAK,MAC9B8K,EAAK/K,EAAE,GAAK,IAAMD,EAAE,GAAK,IAAMsB,EAAE,GACjCwN,EAAKtN,EAAOxB,EAAGC,CAAC,EAChBmK,EAAK5I,EAAOxB,EAAGsB,CAAC,EACtBwN,EAAG,UAAY,GACf1E,EAAG,UAAY,GACf,MAAM2C,EAAS,CAAC+B,EAAG,qBACb9B,EAAS,CAAC5C,EAAG,qBACbgB,EAAU,qBAAqB,KAAK,EAAEpL,CAAC,CAAC,eAAe,KAAK,EAAEA,CAAC,CAAC,YAAY6O,EAAQ,EAAE,aAAa9B,CAAM,aAAaC,CAAM,YAAY7L,CAAM,eAAeqL,CAAO,SAASxB,CAAE,YAAYkB,CAAK,uCACtM,YAAK,aAAa,KAAKd,CAAO,EACvBJ,CACT,CASA,mBACE/K,EACAD,EACAsB,EACApB,EAAsB,GACtB,CACA,MAAMgM,EAAQhM,EAAQ,OAAS,EACzB8K,EAAK/K,EAAE,GAAK,IAAMD,EAAE,GAAK,IAAMsB,EAAE,GACvC,KAAK,aAAa,KAChB,eAAe0J,CAAE,8CAA8CkB,CAAK,OAExE,CASA,mBACEjM,EACAD,EACAsB,EACApB,EAAsB,GACtB,CACA,MAAMgM,EAAQhM,EAAQ,OAAS,EACzB8K,EAAK/K,EAAE,GAAK,IAAMD,EAAE,GAAK,IAAMsB,EAAE,GACvC,KAAK,aAAa,KAChB,eAAe0J,CAAE,8CAA8CkB,CAAK,OAExE,CAOA,MAAM6C,EAAa/O,EAAI0D,EAAM,EAAG,CAAC,EAAG,CAClC,KAAK,QACL,IAAI0H,EACJ,OAAAA,EAAU,eAAe,KAAK,KAAK,UAAU2D,CAAG,4CAChD3D,GAAW;AAAA,oBAAuB,KAAK,EAAEpL,CAAC,CAAC,eAAe,KAAK,EAAEA,CAAC,CAAC,SAAS,KAAK,KAAK,8DACtF,KAAK,aAAa,KAAKoL,CAAO,EACvB,KAAK,KACd,CACF","names":["mediatriceAuCompas","A","B","options","O","milieu","O2","rotation","M","pointSurSegment","N","arc1","arc2","arc3","arc4","longueur","codage1","codage2","codageCarre","mediatriceRegleEquerre","codage","O3","hauteur","C","d","droite","H","projectionOrtho","G","D","mediane","bissectriceAuCompas","A1","C1","angle","angleOriente","cercleCirconscrit","m1","m2","m3","centreCercleCirconscrit","paralleleRegleEquerre2points3epoint","H1","droiteParPointEtParallele","C12","perpendiculaireRegleEquerre2points3epoint","longueurRegle","zoomEquerre","dist","dd","droiteParPointEtPerpendiculaire","pointIntersectionLC","cercle","perpendiculaireRegleEquerreDroitePoint","P","pointSurDroite","pointIntersectionDC","P3","alpha","point","homothetie","perpendiculaireRegleEquerrePointSurLaDroite","x","P1","P2","perpendiculaireCompasPointSurLaDroite","similitude","P11","P12","perpendiculaireCompasPoint","translation","vecteur","paralleleRegleEquerreDroitePointAvecDescription","dessus","AA","BB","originalTempo","paralleleAuCompasAvecDescription","translation2Points","paralleleAuCompas","parallelogramme3sommetsConsecutifs","nomD","description","xMin","yMin","parallelogramme2sommetsConsecutifsCentre","nomC","nom","parallelogrammeAngleCentre","B1","D1","partageSegment","n","distance","monAngle","nommerGraduations","y","Ax","i","pointAdistance","m","carre1point1longueur","c","randint","E","F","polygoneAvecNom","marques","symetrieAxialePoint","p","image","symetrieAxiale","rotationPoint","centre","translationPoint","v","choix1","choix2","marque1","marque2","demiTourPoint","homothetiePoint","k","idTexte","l","lprime","arrondi","idTexte1","stringNombre","idTexte2","rotationPolygone","noms","p2","codageAngle","marquesAlea","shuffle","symetrieAxialePolygone","sommet","translationPolygone","demiTourPolygone","homothetiePolygone","t","triangle3longueurs","ABC","AB","AC","BC","triangle2points2longueurs","nombreAvecEspace","triangleRectangleCoteHypotenuse","dAB","dBC","cAC","triangleRectangle2Cotes","cBC","triangle1longueur2angles","NOM","BAC","CBA","a1","a2","D2","E2","E1","F1","d2","pointIntersectionDD","mesure","triangle2longueurs1angle","triangleEquilateral2Sommets","triangleEquilateral","triangleIsocele2Longueurs","c1","c2","pointIntersectionCC","store","StoreIep","id","xml","Alea2iep","__publicField","codeXML","numeroExercice","id2","context","id1","ElementInstrumenpoche","ElementButtonInstrumenpoche","__vitePreload","error","xmin","ymax","width","height","outil","tempo","vitesse","sens","angleDeRotation","echelle","label","couleur","couleurLabel","args","arg","PointAbstrait","option","segment","angle1","angle2","epaisseur","couleurCompas","pointillesTexte","sensTexte","delta","s","deplacement","distanceBord","B2","A2","vecteurTexte","arg1","arg2","arg3","Segment","pointAbstrait","sommets","texte","policeTexte","stringOptions","dy","w","norme","ancrage","a","options1","trait1","trait2","rayon","d1","url"],"ignoreList":[],"sources":["../../src/modules/iepMacros/droitesRemarquables.ts","../../src/modules/iepMacros/parallelesEtPerpendiculaires.ts","../../src/modules/iepMacros/parallelogrammes.ts","../../src/modules/iepMacros/quadrilateres.ts","../../src/modules/iepMacros/transformations.ts","../../src/modules/iepMacros/triangles.ts","../../src/modules/Alea2iep.ts"],"sourcesContent":["import { angleOriente } from '../../lib/2d/angles'\nimport { droite } from '../../lib/2d/droites'\nimport { milieu, pointSurSegment } from '../../lib/2d/points'\nimport type { PointAbstrait } from '../../lib/2d/points-abstraits'\nimport { longueur } from '../../lib/2d/segmentsVecteurs'\nimport { projectionOrtho, rotation } from '../../lib/2d/transformations'\nimport { centreCercleCirconscrit } from '../../lib/2d/triangle'\nimport type Alea2iep from '../Alea2iep'\nimport type {\n  OptionsCompas,\n  OptionsOutilMesure,\n  OptionsRegle,\n} from '../Alea2iep'\n\ntype OptionsMediatriceAuCompas = OptionsCompas & {\n  longueur1?: number // Longueur pour le codage d'angle\n  longueur2?: number // Longueur pour le codage d'angle\n  coderFigure?: boolean // Si true, on ajoute le codage de la figure\n}\n\n/**\n * Trace la mdiatrice de [AB] au compas. Le paramtrage des longueurs correspond  la distance entre le milieu du segment et le point d'intersection des arcs de cercles\n * @param {point} A\n * @param {point} B\n * @param {objet} options Dfaut : {longueur1: 3, longueur2: 3, codage: 'X', couleurCodage : this.couleurCodage, couleurCompas: this.couleurCompas, coderFigure: true}\n * @return {array} [arc1, arc2, arc3, arc4, codage1?, codage2?, codageCarre?]\n */\nexport const mediatriceAuCompas = function (\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  options: OptionsMediatriceAuCompas = {},\n): number[] {\n  options.longueur1 = options.longueur1 ?? 3\n  options.longueur2 = options.longueur2 ?? -3\n  options.codage = options.codage ?? 'X'\n  options.couleurCodage = options.couleurCodage ?? this.couleurCodage\n  options.couleurCompas = options.couleurCompas ?? this.couleurCompas\n  options.coderFigure = options.coderFigure ?? true\n  const O = milieu(A, B)\n  const O2 = rotation(A, O, -90)\n  const M = pointSurSegment(O, O2, options.longueur1)\n  const N = pointSurSegment(O, O2, options.longueur2)\n  this.compasMontrer()\n  this.compasDeplacer(A, options)\n  let arc1, arc2, arc3, arc4\n  if (options.longueur1 === -1 * options.longueur2) {\n    // Si la distance est la mme des deux cts, on peut faire les arcs de part et d'autre\n    this.compasEcarter(longueur(A, M), {\n      vitesse: options.vitesse,\n      sens: options.vitesse,\n    })\n    arc1 = this.compasTracerArcCentrePoint(A, M, {\n      delta: options.delta,\n      couleur: options.couleurCompas,\n      sens: options.sens,\n      vitesse: options.vitesse,\n      tempo: options.tempo,\n    })\n    arc2 = this.compasTracerArcCentrePoint(A, N, {\n      delta: options.delta,\n      couleur: options.couleurCompas,\n      sens: options.sens,\n      vitesse: options.vitesse,\n      tempo: options.tempo,\n    })\n    arc4 = this.compasTracerArcCentrePoint(B, N, {\n      delta: options.delta,\n      couleur: options.couleurCompas,\n      sens: options.sens,\n      vitesse: options.vitesse,\n      tempo: options.tempo,\n    })\n    arc3 = this.compasTracerArcCentrePoint(B, M, {\n      delta: options.delta,\n      couleur: options.couleurCompas,\n      sens: options.sens,\n      vitesse: options.vitesse,\n      tempo: options.tempo,\n    })\n  } else {\n    this.compasEcarter(longueur(A, M), options)\n    arc1 = this.compasTracerArcCentrePoint(A, M, {\n      delta: options.delta,\n      couleur: options.couleurCompas,\n      sens: options.sens,\n      vitesse: options.vitesse,\n      tempo: options.tempo,\n    })\n    arc2 = this.compasTracerArcCentrePoint(B, M, {\n      delta: options.delta,\n      couleur: options.couleurCompas,\n      sens: options.sens,\n      vitesse: options.vitesse,\n      tempo: options.tempo,\n    })\n    arc3 = this.compasTracerArcCentrePoint(B, N, {\n      delta: options.delta,\n      couleur: options.couleurCompas,\n      sens: options.sens,\n      vitesse: options.vitesse,\n      tempo: options.tempo,\n    })\n    arc4 = this.compasTracerArcCentrePoint(A, N, {\n      delta: options.delta,\n      couleur: options.couleurCompas,\n      sens: options.sens,\n      vitesse: options.vitesse,\n      tempo: options.tempo,\n    })\n  }\n  this.compasMasquer()\n  if (M.x <= N.x) {\n    this.regleDroite(M, N, options)\n  } else {\n    this.regleDroite(N, M, options)\n  }\n  this.regleMasquer()\n  if (options.coderFigure) {\n    const codage1 = this.segmentCodage(A, O, {\n      codage: options.codage,\n      couleur: options.couleurCodage,\n      tempo: options.tempo,\n    })\n    const codage2 = this.segmentCodage(O, B, {\n      codage: options.codage,\n      couleur: options.couleurCodage,\n      tempo: options.tempo,\n    })\n    const codageCarre = this.codageAngleDroit(A, O, O2, {\n      couleur: options.couleurCodage,\n      tempo: options.tempo,\n      vitesse: options.vitesse,\n    })\n    return [arc1, arc2, arc3, arc4, codage1, codage2, ...codageCarre]\n  } else {\n    return [arc1, arc2, arc3, arc4]\n  }\n}\n/**\n * Trace la mdiatrice du segment [AB] avec la mthode Rgle + querre.\n * @param {point} A\n * @param {point} B\n * @param {boolen} codage\n */\nexport const mediatriceRegleEquerre = function (\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  codage = 'X',\n) {\n  const O = milieu(A, B)\n  this.regleMontrer()\n  this.regleDeplacer(A)\n  this.regleRotation(B)\n  this.crayonMontrer()\n  const O2 = rotation(A, O, -90)\n  const O3 = rotation(A, O, 90)\n  const M = pointSurSegment(O, O2, 0.2)\n  const N = pointSurSegment(O, O3, 0.2)\n  if (this.y(M) > this.y(N)) {\n    this.trait(O, M)\n  } else {\n    this.trait(O, N)\n  }\n  this.regleMasquer()\n  if (this.x(A) < this.x(B)) {\n    this.equerreDeplacer(A)\n    this.equerreMontrer()\n    this.equerreRotation(B)\n  } else {\n    this.equerreDeplacer(B)\n    this.equerreMontrer()\n    this.equerreRotation(A)\n  }\n  this.equerreDeplacer(O)\n  this.crayonDeplacer(O)\n  this.trait(O, O2)\n  this.equerreMasquer()\n  this.regleDroite(O2, O3)\n  this.regleMasquer()\n  this.segmentCodage(A, O, { codage })\n  this.segmentCodage(O, B, { codage })\n  this.codageAngleDroit(A, O, O2)\n}\n/**\n * Trace la hauteur issue de C dans un triangle ABC. Prolonge si besoin le segment [AB] pour avoir le pied de la hauteur et le codage de l'angle droit.\n * @param {point} A 1er point de la base\n * @param {point} B 2e point de la base\n * @param {point} C Sommet dont est issue la hauteur\n * @param {boolen} codage angle droit ajout si true\n */\nexport const hauteur = function (\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  C: PointAbstrait,\n  codage = true,\n) {\n  const d = droite(A, B)\n  d.isVisible = false\n  const H = projectionOrtho(C, d)\n  let G, D\n  if (this.x(A) < this.x(B)) {\n    G = A\n    D = B\n  } else {\n    G = B\n    D = A\n  }\n  if (this.x(H) < this.x(G) || this.x(H) > this.x(D)) {\n    if (this.x(H) < this.x(G)) {\n      // si le pied de la hauteur est trop  gauche\n      this.regleProlongerSegment(D, G, {\n        longueur: longueur(G, H) + 2,\n        pointilles: true,\n        couleur: 'red',\n      })\n    }\n    if (this.x(H) > this.x(D)) {\n      // si le pied de la hauteur est trop  droite\n      this.regleProlongerSegment(G, D, {\n        longueur: longueur(D, H) + 2,\n        pointilles: true,\n        couleur: 'red',\n      })\n    }\n    this.regleMasquer()\n  }\n  if (this.x(A) < this.x(B)) {\n    this.equerreDeplacer(A)\n    this.equerreMontrer()\n    this.equerreRotation(B)\n  } else {\n    this.equerreDeplacer(B)\n    this.equerreMontrer()\n    this.equerreRotation(A)\n  }\n  this.equerreDeplacer(H)\n  this.crayonMontrer()\n  this.crayonDeplacer(H)\n  this.trait(H, C, { epaisseur: 1, couleur: 'red' })\n  this.equerreMasquer()\n  if (codage) {\n    this.codageAngleDroit(A, H, C, { epaisseur: 1, couleur: 'red' })\n  }\n  this.crayonMasquer()\n}\n/**\n * Trace la mdiane issue de C passant par le milieu de [AB]\n * @param {point} A\n * @param {point} B\n * @param {point} C\n * @param {objet} options\n */\nexport const mediane = function (\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  C: PointAbstrait,\n  options: OptionsRegle = {},\n) {\n  options.codage = options.codage ?? 'X'\n  options.epaisseur = options.epaisseur ?? 1\n  options.couleur = options.couleur ?? 'green'\n  const O = milieu(A, B)\n  this.regleMontrer(A, options)\n  this.regleRotation(B, options)\n  this.crayonMontrer()\n  const O2 = rotation(A, O, -90)\n  const O3 = rotation(A, O, 90)\n  const M = pointSurSegment(O, O2, 0.2)\n  const N = pointSurSegment(O, O3, 0.2)\n  if (M.y > N.y) {\n    this.trait(O, M, options)\n  } else {\n    this.trait(O, N, options)\n  }\n  this.regleSegment(O, C, options)\n  if (options.codage) {\n    this.segmentCodage(A, O, options)\n    this.segmentCodage(O, B, options)\n  }\n}\n\ntype OptionsIepBissectrice = OptionsCompas & {\n  masquerTraitsDeConstructions?: boolean // Si true, on masque les traits de construction\n  distanceDeA?: number // Distance de A pour pointSurSegment()\n}\n/**\n * Trace la bissectrice de l'angle ABC au compas.\n * @param {point} A\n * @param {point} B\n * @param {point} C\n * @param {objet} param3\n * @returns {objet} {arc1, arc2, arc3, arc4}\n * { codage = '/', l = 2, couleur = this.couleur, tempo = this.tempo, vitesse = this.vitesse, sens = Math.round(this.vitesse / 2), epaisseur = this.epaisseur, pointilles = this.pointilles, couleurCodage = this.couleurCodage, masquerTraitsDeConstructions = true } = {}\n */\nexport const bissectriceAuCompas = function (\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  C: PointAbstrait,\n  options: OptionsIepBissectrice = {},\n) {\n  options.codage = options.codage ?? '/'\n  options.distanceDeA = options.distanceDeA ?? 2\n  options.masquerTraitsDeConstructions =\n    options.masquerTraitsDeConstructions ?? true\n  options.longueur = options.longueur ?? longueur(B, A)\n  options.epaisseur = options.epaisseur ?? 1\n  const A1 = pointSurSegment(B, A, options.distanceDeA)\n  const C1 = pointSurSegment(B, C, options.distanceDeA)\n  const angle = angleOriente(A, B, C)\n  const M = rotation(B, A1, -(180 - angle))\n  const arc1 = this.compasTracerArcCentrePoint(B, A1, options)\n  const arc2 = this.compasTracerArcCentrePoint(B, C1, options)\n  const arc3 = this.compasTracerArcCentrePoint(A1, M, options)\n  const arc4 = this.compasTracerArcCentrePoint(C1, M, options)\n  this.compasMasquer()\n  this.regleDemiDroiteOriginePoint(B, M, options)\n  this.regleMasquer()\n  this.crayonMasquer()\n  if (options.codage) {\n    this.angleCodage(A, B, M, options)\n    this.angleCodage(M, B, C, options)\n  }\n  if (options.masquerTraitsDeConstructions) {\n    this.traitMasquer(arc1)\n    this.traitMasquer(arc2)\n    this.traitMasquer(arc3)\n    this.traitMasquer(arc4)\n  }\n  return { arc1, arc2, arc3, arc4 }\n}\n\ntype OptionsIepCercleCirconscrit = OptionsOutilMesure & {\n  couleurMediatrice?: string\n  couleurCercle?: string\n}\n/**\n * Construit les 3 mdiatrices des cts du triangle ABC puis le cercle circonscrit au triangle\n * @param {point} A\n * @param {point} B\n * @param {point} C\n * @param {objet} options\n */\nexport const cercleCirconscrit = function (\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  C: PointAbstrait,\n  options: OptionsIepCercleCirconscrit = {},\n) {\n  options.couleurMediatrice =\n    options.couleurMediatrice ?? options.couleur ?? this.couleur\n  options.couleurCercle =\n    options.couleurCercle ?? options.couleur ?? this.couleur\n  options.codage = options.codage ?? 'X'\n  const m1 = this.mediatriceAuCompas(A, B, options)\n  this.traitMasquer(m1[0]) // On cache les arcs de cercle une fois la mdiatrice trace\n  this.traitMasquer(m1[1])\n  this.traitMasquer(m1[2])\n  this.traitMasquer(m1[3])\n  options.codage = '||'\n  const m2 = this.mediatriceAuCompas(B, C, options)\n  this.traitMasquer(m2[0])\n  this.traitMasquer(m2[1])\n  this.traitMasquer(m2[2])\n  this.traitMasquer(m2[3])\n  options.codage = '///'\n  const m3 = this.mediatriceAuCompas(A, C, options)\n  this.traitMasquer(m3[0])\n  this.traitMasquer(m3[1])\n  this.traitMasquer(m3[2])\n  this.traitMasquer(m3[3])\n  const O = centreCercleCirconscrit(A, B, C)\n  options.couleur = options.couleurCercle\n  this.compasCercleCentrePoint(O, A, options)\n}\n","import { angleOriente } from '../../lib/2d/angles'\nimport { cercle } from '../../lib/2d/cercle'\nimport {\n  Droite,\n  droite,\n  droiteParPointEtParallele,\n  droiteParPointEtPerpendiculaire,\n} from '../../lib/2d/droites'\nimport {\n  point,\n  pointIntersectionLC,\n  pointSurDroite,\n  pointSurSegment,\n} from '../../lib/2d/points'\nimport type { PointAbstrait } from '../../lib/2d/points-abstraits'\nimport { longueur, vecteur } from '../../lib/2d/segmentsVecteurs'\nimport {\n  homothetie,\n  projectionOrtho,\n  rotation,\n  similitude,\n  translation,\n  translation2Points,\n} from '../../lib/2d/transformations'\nimport type { OptionsCompas, OptionsEquerre } from '../Alea2iep'\nimport type Alea2iep from '../Alea2iep'\n\n/**\n * Trace la parallle  (AB) passant par C avec la rgle et l'querre. Peut prolonger le segment [AB] si le pied de la hauteur est trop loign des extrmits du segment\n * @param {Point} A\n * @param {Point} B\n * @param {Point} C\n * @param {*} [options]\n */\nexport const paralleleRegleEquerre2points3epoint = function (\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  C: PointAbstrait,\n  options?: OptionsEquerre,\n) {\n  let G, D, H1\n  // G est le point le plus  gauche, D le plus  droite et H le projet de C sur (AB)\n  // H1 est un point de (AB)  gauche de H, c'est l o seront la rgle et l'querre avant de glisser\n  if (A.x < B.x) {\n    G = A\n    D = B\n  } else {\n    G = B\n    D = A\n  }\n  const d = droite(A, B)\n  const H = projectionOrtho(C, d)\n  if (H.x < D.x) {\n    H1 = pointSurSegment(H, D, -2) // H1 sera plus  gauche que H\n  } else if (H.x > D.x) {\n    H1 = pointSurSegment(H, D, 2)\n  } else {\n    H1 = pointSurSegment(H, G, 2)\n  }\n  const C1 = projectionOrtho(H1, droiteParPointEtParallele(C, d))\n  // C1 est le point d'arrive de l'querre aprs avoir gliss\n  const M = pointSurSegment(C1, C, 6)\n  // Le trac de la parallle ne fera que 6 cm pour ne pas dpassr de l'querre. M est la fin de ce trac\n\n  if (H.x < G.x && longueur(H, G) > 3) {\n    // Si le pied de la hauteur est trop  gauche\n    this.regleProlongerSegment(D, G, options)\n    this.regleMasquer(options)\n  }\n  if (H.x > D.x && longueur(H, D) > 3) {\n    // Si le pied de la hauteur est trop  gauche\n    this.regleProlongerSegment(G, D, options)\n  }\n\n  this.equerreMontrer(H1, options)\n  if (M.x > C1.x) {\n    this.equerreRotation(d.angleAvecHorizontale - 90, options)\n  } else {\n    this.equerreRotation(d.angleAvecHorizontale + 90, options)\n  }\n  if (H1.y > C1.y) {\n    if (this.regle.visibilite) {\n      this.regleDeplacer(H1, Object.assign({}, options, { tempo: 0 }))\n      this.regleRotation(C1, Object.assign({}, options, { tempo: 0 }))\n    } else {\n      this.regleDeplacer(\n        H1,\n        Object.assign({}, options, { vitesse: 1000, tempo: 0 }),\n      )\n      this.regleRotation(\n        C1,\n        Object.assign({}, options, { sens: 1000, tempo: 0 }),\n      )\n    }\n  } else {\n    const C12 = pointSurSegment(C1, H1, -2) // On monte un peu plus la rgle pour que a soit plus crdible\n    if (this.regle.visibilite) {\n      this.regleDeplacer(C12, Object.assign({}, options, { tempo: 0 }))\n      this.regleRotation(H1, Object.assign({}, options, { tempo: 0 }))\n    } else {\n      this.regleDeplacer(\n        C12,\n        Object.assign({}, options, { vitesse: 1000, tempo: 0 }),\n      )\n      this.regleRotation(\n        H1,\n        Object.assign({}, options, { sens: 1000, tempo: 0 }),\n      )\n      this.regleMontrer()\n    }\n  }\n  this.equerreDeplacer(C1, options)\n  this.crayonMontrer()\n  this.crayonDeplacer(C1, options)\n  this.tracer(M, options)\n  this.regleMasquer(options)\n  this.equerreMasquer(options)\n  this.crayonMasquer(options)\n}\n/**\n * Trace la perpendiculaire  (AB) passant par C avec la rgle et l'querre. Peut prolonger le segment [AB] si le pied de la hauteur est trop loign des extrmits du segment\n * Description dsactive par dfaut.\n * @param {Point} A\n * @param {Point} B\n * @param {Point} C\n * @param {*} [options]\n */\nexport const perpendiculaireRegleEquerre2points3epoint = function (\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  C: PointAbstrait,\n  options: OptionsCompas = {},\n) {\n  const longueurRegle = this.regle.longueur\n  const zoomEquerre = this.equerre.zoom\n  const d = droite(A, B)\n  d.nom = `(${A.nom}${B.nom})`\n  let dist\n  if (A.nom === undefined) A.nom = 'A'\n  if (B.nom === undefined) B.nom = 'B'\n  if (C.estSur(droite(A, B))) {\n    const H = rotation(C, C, 0)\n    const dd = droiteParPointEtPerpendiculaire(C, d)\n    C = pointIntersectionLC(dd, cercle(H, 5.5))\n    dist = 7.5\n  } else {\n    const H = projectionOrtho(C, d)\n    dist = longueur(H, C) + 2\n  }\n  this.equerreZoom((dist * 100) / 7.5, options)\n  this.regleModifierLongueur(Math.max(dist * 2, 15), options)\n  this.perpendiculaireRegleEquerreDroitePoint(d, C, options)\n  this.equerreZoom(zoomEquerre, options)\n  this.regleModifierLongueur(longueurRegle, options)\n  this.regleMasquer(options)\n  this.equerreMasquer(options)\n  this.crayonMasquer(options)\n}\n\n/**\n * Construit  la rgle et  l'querre la perpendiculaire  une droite d passant par un point P n'appartenant pas  d.\n * description dsactivable.\n * @param {Droite} d\n * @param {Point} P\n * @param {boolean} [description]\n */\nexport const perpendiculaireRegleEquerreDroitePoint = function (\n  this: Alea2iep,\n  d: Droite,\n  P: PointAbstrait,\n  options: OptionsCompas = {},\n) {\n  if (!P.estSur(d)) {\n    const H = projectionOrtho(P, d)\n    const A = rotation(P, H, 90)\n    const B = rotation(A, H, 180)\n    const P3 = homothetie(P, H, 1.2)\n    const alpha = angleOriente(point(10000, H.y), H, B)\n    if (options.description)\n      this.textePosition(\n        `1. Placer un ct de l'angle droit de l'querre sur la droite ${d.nom} et l'autre ct de l'angle droit passant par le point ${P.nom}.`,\n        0,\n        10,\n        { couleur: 'lightblue' },\n      )\n    this.equerreRotation(alpha, options)\n    this.equerreMontrer(H, options)\n    if (options.description)\n      this.textePosition(\n        `2. Tracer le segment de droite passant par le point ${P.nom}`,\n        0,\n        9.3,\n        { couleur: 'lightblue' },\n      )\n    this.crayonMontrer(P, options)\n    this.tracer(H, options)\n    this.equerreMasquer(options)\n    if (options.description)\n      this.textePosition(\n        `3. Prolonger la perpendiculaire  ${d.nom}  la rgle.`,\n        0,\n        8.6,\n        { couleur: 'lightblue' },\n      )\n    this.regleMontrer(P3, options)\n    this.regleRotation(alpha - 90, options)\n    this.crayonDeplacer(P3, options)\n    this.tracer(rotation(P3, H, 180), options)\n    if (options.description)\n      this.textePosition(\"4. Coder l'angle droit.\", 0, 7.9, {\n        couleur: 'lightblue',\n      })\n    this.regleMasquer(options)\n    this.codageAngleDroit(\n      A,\n      H,\n      P,\n      Object.assign({}, options, { couleurCodage: 'red' }),\n    )\n  } else {\n    const H = P\n    const C = cercle(P, 6)\n    const A = pointSurDroite(d, -10000)\n    const B = pointSurDroite(d, 10000)\n    const pointIntersectionDC = pointIntersectionLC(d, C)\n    let P3 = rotation(pointIntersectionDC, P, 90)\n    if (P3.y < P.y) P3 = rotation(P3, P, 180)\n    const alpha = angleOriente(point(10000, H.y), H, B)\n    if (options.description)\n      this.textePosition(\n        `1. Placer un ct de l'angle droit de l'querre sur la droite ${d.nom} avec l'angle droit au point ${P.nom}.`,\n        0,\n        10,\n        { couleur: 'lightblue' },\n      )\n    this.equerreRotation(alpha, options)\n    this.equerreMontrer(H, options)\n    if (options.description)\n      this.textePosition(\n        \"2. Tracer le long de l'autre ct de l'angle droit de l'querre\",\n        0,\n        9.3,\n        { couleur: 'lightblue' },\n      )\n    this.crayonMontrer(P3, options)\n    this.tracer(H, options)\n    this.equerreMasquer(options)\n    if (options.description)\n      this.textePosition(\n        `3. Prolonger la perpendiculaire  ${d.nom}  la rgle.`,\n        0,\n        8.6,\n        { couleur: 'lightblue' },\n      )\n    this.regleMontrer(P3, options)\n    this.regleRotation(alpha - 90, options)\n    this.crayonDeplacer(P3, options)\n    this.tracer(rotation(P3, H, 180), options)\n    if (options.description)\n      this.textePosition(\"4. Coder l'angle droit.\", 0, 7.9, {\n        couleur: 'lightblue',\n      })\n    this.regleMasquer(options)\n    this.codageAngleDroit(A, H, P3, options)\n  }\n}\n/**\n * Trace la perpendiculaire  une droite passant par un point de cette droite  l'querre et  la rgle.\n * @param {Droite} d\n * @param {number} x  // pour choisir le point sur d : l'abscisse de A\n * @param {boolean} description\n */\nexport const perpendiculaireRegleEquerrePointSurLaDroite = function (\n  this: Alea2iep,\n  d: Droite,\n  x: number,\n  options: OptionsCompas = {},\n) {\n  const A = pointSurDroite(d, x, 'A')\n  const B = pointSurDroite(d, x + 5)\n  const P1 = rotation(B, A, 90)\n  const P2 = rotation(P1, A, 180)\n  if (d.nom === undefined) {\n    d.nom = '(d)'\n  }\n  this.traitRapide(pointSurDroite(d, -20), pointSurDroite(d, 20), options)\n  this.pointCreer(A, options)\n  if (options.description)\n    this.textePosition(\n      `1. Placer un ct de l'angle droit de l'querre sur la droite ${d.nom}.`,\n      0,\n      10,\n      { couleur: 'lightblue' },\n    )\n  this.equerreRotation(d.angleAvecHorizontale, options)\n  this.equerreMontrer(B, options)\n  if (options.description) {\n    this.textePosition(\n      `2. Faire glisser l'querre sur la droite jusqu'au point ${A.nom}`,\n      0,\n      9.3,\n      { couleur: 'lightblue' },\n    )\n  }\n  this.equerreDeplacer(A, options)\n  if (options.description)\n    this.textePosition(\n      \"3. Tracer le long de l'autre ct de l'angle droit de l'querre.\",\n      0,\n      8.6,\n      { couleur: 'lightblue' },\n    )\n  this.crayonMontrer(A, options)\n  this.tracer(P1, options)\n  this.equerreMasquer(options)\n  if (options.description)\n    this.textePosition(\n      `4. Prolonger la perpendiculaire  ${d.nom}  la rgle.`,\n      0,\n      7.9,\n      { couleur: 'lightblue' },\n    )\n  this.regleRotation(d.angleAvecHorizontale - 90, options)\n  this.regleMontrer(P1, options)\n  this.crayonDeplacer(P1, options)\n  this.tracer(P2, options)\n  if (options.description)\n    this.textePosition(\"4. Coder l'angle droit.\", 0, 7.2, {\n      couleur: 'lightblue',\n    })\n  this.regleMasquer(options)\n  this.codageAngleDroit(P1, A, B, options)\n}\n/**\n * Trace la perpendiculaire  une droite passant par un point de cette droite au compas.\n * @param {Droite} d\n * @param {number} x // pour choisir le point sur d : l'abscisse de A\n * @param {boolean} description\n */\nexport const perpendiculaireCompasPointSurLaDroite = function (\n  this: Alea2iep,\n  d: Droite,\n  x: number,\n  options: OptionsCompas = {},\n) {\n  const A = pointSurDroite(d, x, 'A')\n  const B = pointSurDroite(d, x + 3, 'B')\n  const C = pointSurDroite(d, x - 3, 'C')\n  const P1 = similitude(B, A, 90, 1.2)\n  const P2 = similitude(B, A, -90, 1.2)\n  if (d.nom === undefined) {\n    d.nom = '(d)'\n  }\n  this.traitRapide(pointSurDroite(d, -20), pointSurDroite(d, 20), options)\n  this.pointCreer(A, options)\n  if (options.description)\n    this.textePosition(\n      \"1. Avec le compas, marquer deux points B et C de part et d'autre de A, tels que AB=AC.\",\n      0,\n      10,\n      { couleur: 'lightblue' },\n    )\n  this.compasEcarter2Points(A, B, options)\n  this.compasTracerArcCentrePoint(A, B, { couleur: 'lightgray', epaisseur: 1 })\n  this.compasTracerArcCentrePoint(A, C, { couleur: 'lightgray', epaisseur: 1 })\n  if (options.description) {\n    this.textePosition(\n      '2. Choisir un cartement de compas suprieur  la longueur AB.',\n      0,\n      9.3,\n      { couleur: 'lightblue' },\n    )\n  }\n  this.compasEcarter2Points(B, P1, options)\n  if (options.description)\n    this.textePosition(\n      '3. Tracer un arc de cercle de centre B avec cet cartement.',\n      0,\n      8.6,\n      { couleur: 'lightblue' },\n    )\n  this.compasTracerArcCentrePoint(B, P1, { couleur: 'lightgray', epaisseur: 1 })\n  if (options.description)\n    this.textePosition(\n      '4. Tracer un arc de cercle de centre C en conservant le mme cartement.',\n      0,\n      7.9,\n      { couleur: 'lightblue' },\n    )\n  this.compasTracerArcCentrePoint(C, P1, { couleur: 'lightgray', epaisseur: 1 })\n  this.compasMasquer(options)\n  if (options.description) {\n    this.textePosition(\n      \"4. Tracer la droite qui passe par le point d'intersection des arcs de cercle et par le point A.\",\n      0,\n      7.2,\n      { couleur: 'lightblue' },\n    )\n  }\n  this.regleRotation(d.angleAvecHorizontale - 90, options)\n  const P11 = homothetie(P1, A, 1.1)\n  const P12 = homothetie(P2, A, 1.1)\n  this.regleMontrer(P11, options)\n  this.crayonMontrer(P11, options)\n  this.tracer(P12, options)\n  if (options.description)\n    this.textePosition(\"5. Coder l'angle droit.\", 0, 6.5, {\n      couleur: 'lightblue',\n    })\n  this.regleMasquer(options)\n  this.codageAngleDroit(P1, A, B, options)\n}\n/**\n * Trace la perpendiculaire  une droite passant par un point n'appartenant pas  cette droite au compas.\n * @param {Droite} d\n * @param {number} x // pour choisir le point sur d : l'abscisse de A\n * @param {boolean} description\n */\nexport const perpendiculaireCompasPoint = function (\n  this: Alea2iep,\n  d: Droite,\n  A: PointAbstrait,\n  options: OptionsCompas = {},\n) {\n  const H = projectionOrtho(A, d)\n  const B = similitude(A, H, -90, 1.2, 'B')\n  const C = homothetie(B, H, -0.7, 'C')\n  const D = rotation(A, H, 180)\n  const P1 = homothetie(A, H, 1.2)\n  const P2 = homothetie(A, H, -1.2)\n  if (d.nom === '') {\n    d.nom = '(d)'\n  }\n  if (A.nom === '') {\n    A.nom = 'A'\n  }\n  this.traitRapide(pointSurDroite(d, -20), pointSurDroite(d, 20), options)\n  this.textePoint(\n    d.nom,\n    translation(pointSurDroite(d, 0), vecteur(0, -0.5)),\n    options,\n  )\n  this.pointCreer(A, options)\n  if (options.description)\n    this.textePosition(\n      `1. Choisir deux points B et C sur la droite ${d.nom}.`,\n      0,\n      11,\n      { couleur: 'lightblue', tempo: 20 },\n    )\n  this.tempo = 20\n  this.pointCreer(B, options)\n  this.pointCreer(C, options)\n  if (options.description)\n    this.textePosition(\n      `2. Tracer un arc de cercle de centre B passant par A et un autre de centre C passant par ${A.nom}.`,\n      0,\n      10.3,\n      { couleur: 'lightblue', tempo: 20 },\n    )\n  this.compasEcarter2Points(B, A, options)\n  this.compasTracerArcCentrePoint(\n    B,\n    D,\n    Object.assign({}, options, { couleur: 'lightgray', epaisseur: 1 }),\n  )\n  this.compasEcarter2Points(C, A, options)\n  this.compasTracerArcCentrePoint(\n    C,\n    D,\n    Object.assign({}, options, { couleur: 'lightgray', epaisseur: 1 }),\n  )\n  if (options.description)\n    this.textePosition(\n      `3. Ces deux arcs de cercle se recoupent en un point qui est le symtrique de ${A.nom} par rapport  ${d.nom}`,\n      0,\n      9.6,\n      { couleur: 'lightblue', tempo: 20 },\n    )\n  this.compasMasquer(options)\n  if (options.description)\n    this.textePosition(\n      \"4. Tracer la droite qui passe par le point d'intersection des arcs de cercle et par le point A.\",\n      0,\n      8.9,\n      { couleur: 'lightblue', tempo: 20 },\n    )\n  this.regleRotation(d.angleAvecHorizontale - 90, options)\n  this.regleMontrer(P1, options)\n  this.crayonMontrer(P1, options)\n  this.tracer(P2, options)\n  if (options.description)\n    this.textePosition(\"5. Coder l'angle droit.\", 0, 8.2, {\n      couleur: 'lightblue',\n      tempo: 20,\n    })\n  this.regleMasquer(options)\n  this.codageAngleDroit(P1, H, B, options)\n}\n/**\n * Trace la paralllee  (AB) passant par C avec la rgle et l'querre.\n * Cette macro ralise la construction en dcrivant ce qu'elle fait  chaque tape\n * @param {Point} A\n * @param {Point} B\n * @param {Point} M\n * @param {boolean} dessus\n * @param {*} [options]\n */\nexport const paralleleRegleEquerreDroitePointAvecDescription = function (\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  M: PointAbstrait,\n  dessus: boolean,\n  options: OptionsCompas = { description: true },\n) {\n  A.nom = 'A'\n  B.nom = 'B'\n  M.nom = 'M'\n  const AA = homothetie(A, B, 2)\n  const BB = homothetie(B, A, 2)\n  const d = droite(A, B)\n  const dd = rotation(d, A, 90)\n  const H = projectionOrtho(M, dd)\n  const N = homothetie(M, H, 1.5)\n  const P = homothetie(H, M, 2)\n  const originalTempo = this.tempo\n  this.tempo = 10\n  this.pointMasquer(AA, BB, options)\n  this.traitRapide(AA, BB, options)\n  this.textePosition(\n    'Parallle  une droite passant par un point (rgle et querre)',\n    -10,\n    10.7,\n    { couleur: 'green', taille: 4, tempo: 20 },\n  )\n  if (options.description)\n    this.textePosition(\n      \"On veut construire la parallle  (AB) passant par M  la rgle et  l'equerre.\",\n      -10,\n      10,\n      { couleur: 'red', taille: 4, tempo: 50 },\n    )\n  if (options.description)\n    this.textePosition(\n      \"1. Placer l'querre un ct de l'angle droit le long de la droite (AB).\",\n      -9,\n      9.3,\n      { couleur: 'lightblue', taille: 2, tempo: 10 },\n    )\n  this.equerreMontrer(A, options)\n  this.equerreRotation(\n    d.angleAvecHorizontale + (dessus ? -90 : 0),\n    Object.assign({}, options, { tempo: 20 }),\n  )\n  if (options.description)\n    this.textePosition(\n      \"2. Placer ensuite la rgle contre l'autre ct de l'angle droit de l'querre.\",\n      -9,\n      8.6,\n      { couleur: 'lightblue', taille: 2, tempo: 10 },\n    )\n  this.regleRotation(d.angleAvecHorizontale - 90, options)\n  this.regleMontrer(AA, options)\n  this.regleDeplacer(\n    homothetie(rotation(B, A, 90), A, 1.5),\n    Object.assign({}, options, { tempo: 20 }),\n  )\n  if (options.description)\n    this.textePosition(\n      'Remarque : On peut tracer des pointills pour matrialiser la position de la rgle.',\n      -9.5,\n      7.9,\n      { couleur: 'pink', taille: 2, tempo: 10 },\n    )\n  this.crayonMontrer(A, options)\n  this.tracer(homothetie(rotation(B, A, dessus ? 90 : -90), A, 1.5), options)\n  if (options.description)\n    this.textePosition(\n      \"3. Faire glisser l'querre le long de la rgle jusqu'au point M.\",\n      -9,\n      7.2,\n      { couleur: 'lightblue', taille: 2, tempo: 10 },\n    )\n  if (!dessus) {\n    this.equerreRotation(d.angleAvecHorizontale - 90, options)\n  }\n  this.equerreDeplacer(H, Object.assign({}, options, { tempo: 20 }))\n  if (options.description)\n    this.textePosition(\n      '4. Tracer le segment de droite passant par M.',\n      -9,\n      6.5,\n      { couleur: 'lightblue', taille: 2, tempo: 10 },\n    )\n  this.crayonDeplacer(H, options)\n  this.tracer(N, options)\n  this.equerreMasquer(options)\n  if (options.description)\n    this.textePosition(\n      '5. Placer la rgle sur ce segment et prolonger la parallle  (AB).',\n      -9,\n      5.8,\n      { couleur: 'lightblue', taille: 2, tempo: 10 },\n    )\n  this.regleDeplacer(P, options)\n  this.regleRotation(d.angleAvecHorizontale, options)\n  this.tracer(P, options)\n  this.regleMasquer(options)\n  if (options.description)\n    this.textePosition('6. Pour finir, coder la figure.', -9, 5.1, {\n      couleur: 'lightblue',\n      taille: 2,\n      tempo: 20,\n    })\n  this.codageAngleDroit(B, A, H, options)\n  this.codageAngleDroit(A, H, M, options)\n  this.crayonMasquer(options)\n  this.tempo = originalTempo\n}\n\n/**\n *\n * @param {Point} A\n * @param {Point} B\n * @param {Point} C\n * @param {boolean} description\n */\nexport const paralleleAuCompasAvecDescription = function (\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  C: PointAbstrait,\n  options: OptionsCompas = { description: true },\n) {\n  const D = translation2Points(C, A, B, 'D')\n  A.nom = 'A'\n  B.nom = 'B'\n  C.nom = 'C'\n  const AA = homothetie(A, B, 1.5)\n  const BB = homothetie(B, A, 1.5)\n  const N = homothetie(C, D, 1.5)\n  const P = homothetie(D, C, 1.5)\n  const originalTempo = this.tempo\n  this.tempo = 10\n  this.traitRapide(AA, BB, options)\n  this.textePosition(\n    'Parallle  une droite passant par un point (compas et rgle)',\n    -10,\n    10.7,\n    { couleur: 'green', taille: 4, tempo: 20 },\n  )\n  if (options.description)\n    this.textePosition(\n      'On veut construire la parallle  (AB) passant par C  la rgle et au compas.',\n      -10,\n      10,\n      { couleur: 'red', taille: 4, tempo: 30 },\n    )\n  if (options.description)\n    this.textePosition(\n      \"1. Prendre avec le compas l'cartement correspondant  la longueur AB.\",\n      -9,\n      9.3,\n      { couleur: 'lightblue', taille: 2, tempo: 10 },\n    )\n  this.compasEcarter2Points(A, B, options)\n  if (options.description)\n    this.textePosition(\n      '2. Reporter cette longueur  partir du point C.',\n      -9,\n      8.6,\n      { couleur: 'lightblue', taille: 2, tempo: 10 },\n    )\n  this.compasTracerArcCentrePoint(\n    C,\n    D,\n    Object.assign({}, options, { couleur: 'lightgray', epaisseur: 1 }),\n  )\n  if (options.description)\n    this.textePosition(\n      \"3. Prendre ensuite avec le compas l'cartement correspondant  la longueur AC.\",\n      -9,\n      7.9,\n      { couleur: 'lightblue', taille: 2, tempo: 10 },\n    )\n  this.compasEcarter2Points(A, C, options)\n  if (options.description)\n    this.textePosition(\n      '4. Reporter cette longueur  partir du point B.',\n      -9,\n      7.2,\n      { couleur: 'lightblue', taille: 2, tempo: 10 },\n    )\n  this.compasTracerArcCentrePoint(\n    B,\n    D,\n    Object.assign({}, options, { couleur: 'lightgray', epaisseur: 1 }),\n  )\n  this.compasMasquer(options)\n  if (options.description)\n    this.textePosition(\n      \"5. Noter D, le point d'intersection des deux arcs de cercle.\",\n      -9,\n      6.5,\n      { couleur: 'lightblue', taille: 2, tempo: 10 },\n    )\n  this.pointCreer(D, options)\n  if (options.description)\n    this.textePosition('6. Tracer la droite passant par C et D.', -9, 5.8, {\n      couleur: 'lightblue',\n      taille: 2,\n      tempo: 10,\n    })\n  this.regleSegment(N, P, options)\n  this.regleMasquer(options)\n  this.crayonMasquer(options)\n  this.tempo = originalTempo\n}\n\n/**\n *\n * @param {Point} A\n * @param {Point} B\n * @param {Point} C\n * @param {boolean} description\n */\nexport const paralleleAuCompas = function (\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  C: PointAbstrait,\n  options: OptionsCompas = {},\n) {\n  const D = translation2Points(C, A, B)\n  const N = homothetie(C, D, 1.5)\n  const P = homothetie(D, C, 1.5)\n  this.compasEcarter2Points(A, B, options)\n  this.compasTracerArcCentrePoint(C, D, options)\n  this.compasEcarter2Points(A, C, options)\n  this.compasTracerArcCentrePoint(B, D, options)\n  this.compasMasquer(options)\n  // this.pointCreer(D, options)\n  this.regleSegment(N, P, options)\n  return D\n}\n","/**\n ************************************************\n ************** PARALLELOGRAMMES ****************\n ************************************************\n */\n\nimport { droite } from '../../lib/2d/droites'\nimport { pointAdistance, pointSurSegment } from '../../lib/2d/points'\nimport type { PointAbstrait } from '../../lib/2d/points-abstraits'\nimport { longueur } from '../../lib/2d/segmentsVecteurs'\nimport {\n  homothetie,\n  similitude,\n  translation2Points,\n} from '../../lib/2d/transformations'\nimport type Alea2iep from '../Alea2iep'\n\n/**\n * Trace un paralllogramme  partir de la donne de 3 sommets conscutifs\n * @param {point} A\n * @param {point} B\n * @param {point} C\n * @param {string} nomD\n * @param {boolean} description\n */\nexport function parallelogramme3sommetsConsecutifs(\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  C: PointAbstrait,\n  nomD = '',\n  description = true,\n) {\n  const D = translation2Points(C, B, A)\n  D.nom = nomD\n  const xMin = Math.min(A.x, B.x, C.x, D.x)\n  const yMin = Math.min(A.y, B.y, C.y, D.y)\n  // const xMax = Math.max(A.x, B.x, C.x, D.x)\n  // const yMax = Math.max(A.y, B.y, C.y, D.y)\n  this.traitRapide(A, B)\n  this.traitRapide(B, C)\n  this.pointCreer(A, { tempo: 0 })\n  this.pointCreer(B, { tempo: 0 })\n  this.pointCreer(C, { tempo: 0 })\n  if (description) {\n    this.textePosition(\n      `${A.nom + B.nom + C.nom + D.nom} est un paralllogramme donc ses cts opposs sont de mme longueur.`,\n      xMin - 1,\n      yMin - 1,\n    )\n  }\n  this.compasEcarter2Points(B, A)\n  this.textePosition(`${B.nom + A.nom} = ${C.nom + D.nom}`, xMin - 1, yMin - 2)\n  this.compasTracerArcCentrePoint(C, D)\n  this.compasEcarter2Points(B, C)\n  this.textePosition(`${B.nom + C.nom} = ${A.nom + D.nom}`, xMin - 1, yMin - 3)\n  this.compasTracerArcCentrePoint(A, D)\n  this.pointCreer(D)\n  this.compasMasquer()\n  this.regleSegment(C, D)\n  this.regleSegment(D, A)\n  this.regleMasquer()\n  this.crayonMasquer()\n  this.segmentCodage(A, B, {\n    codage: '///',\n    couleur: this.couleurCodage,\n    tempo: 0,\n  })\n  this.segmentCodage(D, C, {\n    codage: '///',\n    couleur: this.couleurCodage,\n    tempo: 0,\n  })\n  this.segmentCodage(B, C, {\n    codage: '//',\n    couleur: this.couleurCodage,\n    tempo: 0,\n  })\n  this.segmentCodage(A, D, {\n    codage: '//',\n    couleur: this.couleurCodage,\n    tempo: 0,\n  })\n}\n/**\n * Trace le paralllogramme ABCD de centre O  partir de [AB] et O.\n * @param {point} A\n * @param {point} B\n * @param {point} O\n * @param {string} nomC\n * @param {string} nomD\n * @param {boolean} description\n */\nexport function parallelogramme2sommetsConsecutifsCentre(\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  O: PointAbstrait,\n  nomC = '',\n  nomD = '',\n  description = true,\n) {\n  const C = translation2Points(O, A, O)\n  C.nom = nomC\n  const D = translation2Points(O, B, O)\n  D.nom = nomD\n  const nom = A.nom + B.nom + C.nom + D.nom\n  if (longueur(A, C) > 12 || longueur(B, D) > 12) {\n    this.regleModifierLongueur(30)\n  }\n  const xMin = Math.min(A.x, B.x, C.x, D.x)\n  const yMin = Math.min(A.y, B.y, C.y, D.y)\n  // const xMax = Math.max(A.x, B.x, C.x, D.x)\n  // const yMax = Math.max(A.y, B.y, C.y, D.y)\n  this.traitRapide(A, B)\n  this.pointCreer(A, { tempo: 0 })\n  this.pointCreer(B, { tempo: 0 })\n  this.pointCreer(O, { tempo: 0 })\n  if (description && nom.length === 4) {\n    this.textePosition(\n      `${A.nom + B.nom + C.nom + D.nom} est un paralllogramme donc ses diagonales se coupent en leur milieu.`,\n      xMin - 1,\n      yMin - 1,\n    )\n  }\n  this.pointilles = true\n  this.epaisseur = 1\n  this.couleur = this.couleurTraitsDeConstruction\n  this.regleDemiDroiteOriginePoint(A, O, { longueur: longueur(A, C) + 3 })\n  this.regleMasquer()\n  this.crayonMasquer()\n  this.compasEcarter2Points(A, O)\n  if (description && nom.length === 4) {\n    this.textePosition(\n      `${A.nom + O.nom} = ${O.nom + C.nom}`,\n      xMin - 1,\n      yMin - 2,\n    )\n  }\n  this.pointilles = false\n  this.compasTracerArcCentrePoint(O, C)\n  this.compasMasquer()\n  this.pointilles = true\n  this.regleDemiDroiteOriginePoint(B, O, { longueur: longueur(B, D) + 3 })\n  this.regleMasquer()\n  this.crayonMasquer()\n  this.pointilles = false\n  this.compasEcarter2Points(B, O)\n  if (description && nom.length === 4) {\n    this.textePosition(\n      `${B.nom + O.nom} = ${O.nom + D.nom}`,\n      xMin - 1,\n      yMin - 3,\n    )\n  }\n  this.compasTracerArcCentrePoint(O, D)\n  this.compasMasquer()\n  this.couleur = 'blue'\n  this.epaisseur = 3\n  this.pointCreer(D)\n  this.regleSegment(A, D)\n  this.regleSegment(D, C)\n  this.regleSegment(C, B)\n  this.regleMasquer()\n  this.compasMasquer()\n  this.crayonMasquer()\n  this.segmentCodage(A, O, {\n    codage: '//',\n    couleur: this.couleurCodage,\n    tempo: 0,\n  })\n  this.segmentCodage(O, C, {\n    codage: '//',\n    couleur: this.couleurCodage,\n    tempo: 0,\n  })\n  this.segmentCodage(B, O, {\n    codage: 'O',\n    couleur: this.couleurCodage,\n    tempo: 0,\n  })\n  this.segmentCodage(O, D, {\n    codage: 'O',\n    couleur: this.couleurCodage,\n    tempo: 0,\n  })\n}\n/**\n * Trace la paralllogramme ABCD de centre O en partant de [AD), [AB) et O (mais sans voir la position de B et D au dpart)\n * @param {point} D\n * @param {point} A\n * @param {point} B\n * @param {point} O\n */\nexport function parallelogrammeAngleCentre(\n  this: Alea2iep,\n  D: PointAbstrait,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  O: PointAbstrait,\n) {\n  const B1 = pointSurSegment(A, B, longueur(A, B) + 2)\n  const D1 = pointSurSegment(A, D, longueur(A, D) + 2)\n  const C = translation2Points(B, A, D)\n  this.traitRapide(A, B1)\n  this.traitRapide(A, D1)\n  this.pointCreer(O, { tempo: 0 })\n  this.pointCreer(A, { tempo: 0 })\n  this.regleDemiDroiteOriginePoint(A, O, {\n    couleur: this.couleurTraitsDeConstruction,\n    epaisseur: 1,\n    pointilles: true,\n  })\n  this.pointilles = false\n  this.regleMasquer()\n  this.crayonMasquer()\n  this.compasEcarter2Points(A, O)\n  this.compasTracerArcCentrePoint(O, C, {\n    couleur: this.couleurTraitsDeConstruction,\n  })\n  this.compasMasquer()\n  this.paralleleRegleEquerre2points3epoint(B1, A, C, {\n    couleur: this.couleurTraitsDeConstruction,\n    epaisseur: 1,\n  })\n  this.equerreMasquer()\n  this.regleDroite(C, D, {\n    couleur: this.couleurTraitsDeConstruction,\n    epaisseur: 1,\n  })\n  this.paralleleRegleEquerre2points3epoint(A, D1, C, {\n    couleur: this.couleurTraitsDeConstruction,\n    epaisseur: 1,\n  })\n  this.equerreMasquer()\n  this.regleDroite(C, B, {\n    couleur: this.couleurTraitsDeConstruction,\n    epaisseur: 1,\n  })\n  this.pointCreer(D, { tempo: 0 })\n  this.pointCreer(B, { tempo: 0 })\n  this.pointCreer(C, { tempo: 0 })\n  this.regleSegment(B, C)\n  this.regleSegment(C, D)\n  this.regleMasquer()\n  this.crayonMasquer()\n}\n/**\n * Macro pour placer le point M sur un segment [AB] tel que AM = n/d AB\n * @param {point} A\n * @param {point} B\n * @param {int} n numrateur\n * @param {int} d dnominateur\n * @param {object} options { distance: 1, monAngle: 40, nom: '', nommerGraduations: false }\n * @returns M\n */\nexport function partageSegment(\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  n: number,\n  d: number,\n  { distance = 1, monAngle = 40, nom = '', nommerGraduations = false } = {},\n) {\n  this.traitRapide(A, B)\n  this.regleMasquerGraduations()\n  this.regleMontrer(A)\n  const y = similitude(\n    B,\n    A,\n    monAngle,\n    ((Math.max(n, d) + 1) * distance) / longueur(A, B),\n  )\n  this.regleSegment(A, y)\n  this.regleMasquer()\n  this.crayonMasquer()\n  const Ax = [A]\n  for (let i = 1; i <= Math.max(n, d); i++) {\n    Ax.push(\n      pointAdistance(\n        A,\n        distance * i,\n        monAngle + droite(A, B).angleAvecHorizontale,\n      ),\n    )\n    this.compasTracerArcCentrePoint(Ax[i - 1], Ax[i])\n    if (nommerGraduations)\n      this.pointCreer(Ax[i], { label: A.nom + '_' + i, dx: -1, dy: 0.5 })\n  }\n  this.compasMasquer()\n  this.regleSegment(Ax[d], B)\n  this.regleMasquer()\n  this.crayonMasquer()\n  const m = this.paralleleAuCompas(Ax[d], B, Ax[n])\n  const M = homothetie(B, A, n / d)\n  if (m.y > M.y) this.regleProlongerSegment(m, M, { longueur: 1 })\n  this.regleSegment(A, M, { couleur: 'red', epaisseur: 3 })\n  if (nom) this.pointCreer(M, { label: nom })\n  this.regleMasquer()\n  this.crayonMasquer()\n  return M\n}\n","import { point, pointAdistance, pointSurSegment } from '../../lib/2d/points'\nimport type { PointAbstrait } from '../../lib/2d/points-abstraits'\nimport { polygoneAvecNom } from '../../lib/2d/polygones'\nimport { rotation } from '../../lib/2d/transformations'\nimport type Alea2iep from '../Alea2iep'\nimport { randint } from '../outils'\n\n/**\n * Macro cre par Sophie Desruelle\n * @param {objet} A\n * @param {number} c\n * @returns polygoneAvecNom\n */\nexport const carre1point1longueur = function (\n  this: Alea2iep,\n  nom: string,\n  A: PointAbstrait,\n  c: number,\n) {\n  const interligne = 1\n  A = point(5, 0, nom[0])\n  const B = pointAdistance(A, c, randint(-20, 20), nom[1])\n  const C = rotation(A, B, -90, nom[2])\n  const D = rotation(B, A, 90, nom[3])\n  const E = pointSurSegment(A, D, c + 2, 'E')\n  const F = pointSurSegment(D, C, c + 2, 'F')\n  this.equerreZoom(((c + 3) * 100) / 7.5)\n  this.tempo = 20\n\n  this.textePosition(\n    `1) On veut construire un carr dont les cts mesurent ${c} cm, donc on commence par tracer un segment, ici [${nom[0] + nom[1]}], de cette longueur.`,\n    0,\n    -2,\n  )\n\n  this.pointCreer(A, { tempo: 0 }) // On coupe la pause pour ne pas voir le dplacement du point\n  this.pointNommer(A, A.nom, { dx: -0.5, dy: 0 }) // On dplace le label du point A vers la gauche\n  this.regleSegment(A, B)\n  this.pointCreer(B)\n  this.regleMasquer()\n  this.longueurSegment(A, B, -1)\n\n  this.textePosition(\n    `2) Un carr possde 4 angles droits, donc on trace la perpendiculaire  (${nom[0] + nom[1]}) passant par ${nom[0]}.`,\n    0,\n    -2 - 1 * interligne,\n  )\n\n  this.equerreMontrer()\n  this.equerreDeplacer(A)\n  this.equerreRotation(B)\n  this.trait(A, E)\n  this.equerreMasquer()\n  this.codageAngleDroit(B, A, D)\n\n  this.textePosition(\n    `3) Les 4 cts d'un carr sont de la mme longueur, donc on place le point ${nom[3]} sur cette perpendiculaire,  ${c} cm de ${nom[0]}.`,\n    0,\n    -2 - 2 * interligne,\n  )\n\n  this.regleSegment(A, D)\n  this.pointCreer(D, { tempo: 0 })\n  this.pointNommer(D, D.nom, { dx: -0.7, dy: 0.5 })\n  this.regleMasquer()\n  this.segmentCodage(A, B)\n  this.segmentCodage(A, D)\n\n  this.textePosition(\n    `4) De mme, on trace la perpendiculaire  (${nom[0] + nom[3]}) passant par ${nom[3]}, puis on place le point ${nom[2]} sur cette perpendiculaire,  ${c} cm de ${nom[3]}.`,\n    0,\n    -2 - 3 * interligne,\n  )\n\n  this.equerreMontrer()\n  this.equerreDeplacer(D)\n  this.equerreRotation(A)\n  this.trait(D, F)\n  this.equerreMasquer()\n  this.codageAngleDroit(A, D, C)\n\n  this.regleSegment(D, C)\n  this.pointCreer(C, { tempo: 0 })\n  this.pointNommer(C, C.nom, { dx: 0, dy: 0.9 })\n  this.regleMasquer()\n  this.segmentCodage(D, C)\n\n  this.textePosition(\n    `5) On trace le segment [${nom[1] + nom[2]}].`,\n    0,\n    -2 - 4 * interligne,\n  )\n\n  this.regleSegment(C, B)\n  this.regleMasquer()\n  this.segmentCodage(B, C)\n\n  this.textePosition(\n    `6) On vrifie que ${nom[1] + nom[2]} = ${c} cm et que les deux derniers angles tracs sont droits.`,\n    0,\n    -2 - 5 * interligne,\n  )\n\n  this.equerreMontrer(C, { tempo: 0 })\n  this.equerreRotation(D)\n  this.equerreMasquer()\n  this.codageAngleDroit(D, C, B)\n\n  this.equerreMontrer(B, { tempo: 0 })\n  this.equerreRotation(C)\n  this.equerreMasquer()\n  this.codageAngleDroit(C, B, A)\n  return polygoneAvecNom(A, B, C, D)\n}\n","import type { Droite } from '../../lib/2d/droites'\nimport { milieu } from '../../lib/2d/points'\nimport type { PointAbstrait } from '../../lib/2d/points-abstraits'\nimport type { Polygone } from '../../lib/2d/polygones'\nimport { longueur, vecteur } from '../../lib/2d/segmentsVecteurs'\nimport {\n  homothetie,\n  rotation,\n  symetrieAxiale,\n  translation,\n} from '../../lib/2d/transformations'\nimport { shuffle } from '../../lib/outils/arrayOutils'\nimport { arrondi } from '../../lib/outils/nombres'\nimport { stringNombre } from '../../lib/outils/texNombre'\nimport type { OptionsCompas } from '../Alea2iep'\nimport type Alea2iep from '../Alea2iep'\nimport { randint } from '../outils'\n\nconst marques = ['/', '//', '///', 'O', '\\\\\\\\']\n\n/**\n *\n * @param {objet} p point dont on construit l'image et qui doit tre trac.\n * @param {objet} d axe de symtrie.\n * @param {string} nom nom de l'image\n * @param {objet} options couleur et couleurCodage\n * @author Liouba Leroux et Jean-Claude Lhote\n */\nexport const symetrieAxialePoint = function (\n  this: Alea2iep,\n  p: PointAbstrait,\n  d: Droite,\n  nom: string,\n  options: OptionsCompas = {},\n) {\n  if (nom === undefined || nom === '') {\n    nom = p.nom + \"'\"\n  }\n  const image = symetrieAxiale(p, d, nom) // on dfinit le point image (pour le viser avec la rgle on ajoute une apostrophe au nom)\n  if (longueur(p, image) !== 0) {\n    const M = milieu(p, image) // on cre le point milieu\n    const N = rotation(p, M, 90)\n    const D = rotation(N, M, 180)\n    this.regleMasquerGraduations(options)\n    this.perpendiculaireRegleEquerre2points3epoint(\n      N,\n      D,\n      p,\n      Object.assign({}, options, {\n        couleur: options.couleur ?? this.couleurTraitsDeConstruction,\n        epaisseur: this.epaisseurTraitsDeConstruction,\n        pointilles: true,\n      }),\n    )\n    this.compasEcarter2Points(M, p, options)\n    this.compasTracerArcCentrePoint(M, image, options)\n    this.regleMasquer(options)\n    this.equerreMasquer(options)\n    this.segmentCodage(p, M, options)\n    this.segmentCodage(image, M, options)\n    this.crayonMasquer(options)\n    this.compasMasquer(options)\n  }\n  this.pointCreer(image, options) // on construit l'image\n}\n\n/**\n *\n * @param {objet} p  le point dont on veut construire l'image\n * @param {objet} centre le centre de la rotation\n * @param {number} angle l'angle de la rotation\n * @param {string} nom le nom de l'image (si pas prcis ce sera le nom de l'antcdent avec un ')\n * @param {objet} param4 options couleur et couleurCodage\n * @author Jean-Claude Lhote\n */\nexport const rotationPoint = function (\n  this: Alea2iep,\n  p: PointAbstrait,\n  centre: PointAbstrait,\n  angle: number,\n  nom: string,\n  options: OptionsCompas = {},\n) {\n  if (nom === undefined || nom === '') {\n    nom = p.nom + \"'\"\n  }\n  const image = rotation(p, centre, angle, nom) // on dfinit le point image (pour le viser avec la rgle on ajoute une apostrophe au nom)\n  this.regleSegment(\n    centre,\n    p,\n    Object.assign({}, options, {\n      epaisseur: this.epaisseurTraitsDeConstruction,\n      pointilles: true,\n    }),\n  ) // On trace le support du rapporteur\n  this.rapporteurMontrer(centre, options)\n  this.rapporteurTracerDemiDroiteAngle(\n    centre,\n    p,\n    angle,\n    Object.assign({}, options, {\n      epaisseur: this.epaisseurTraitsDeConstruction,\n      pointilles: true,\n    }),\n  ) // On trace le deuxime ct\n  this.regleMasquer(options)\n  this.rapporteurMasquer(options)\n  this.compasEcarter2Points(centre, p, options) // on prend l'cartement du compas\n  this.compasTracerArcCentrePoint(centre, image, options) // On fait l'arc qui coupe la demi-droite\n  this.compasMasquer(options)\n  this.pointCreer(image, options) // On marque le point image (qui est nomm)\n  if (options.codage) {\n    if (Math.abs(angle) === 90) {\n      this.codageAngleDroit(p, centre, image, options)\n    } else {\n      this.angleCodage(p, centre, image, options)\n      this.textePoint(\n        Math.abs(angle) + '',\n        translation(\n          homothetie(\n            rotation(p, centre, angle / 2),\n            centre,\n            1.3 / longueur(centre, p),\n          ),\n          vecteur(-0.2, 0.5),\n        ),\n        options,\n      )\n    }\n  }\n}\n\n//   /**\n//  *\n//  * @param {objet} p point dont on construit l'image et qui doit tre trac.\n//  * @param {objet} d axe de symtrie.\n//  * @param {string} nom nom de l'image\n//  * @param {objet} options couleur et couleurCodage\n//  * @author Liouba Leroux et Jean-Claude Lhote\n//  */\n//   this.symetrieAxialePoint = function (p, d, nom, { couleur = this.couleur, couleurCodage = this.couleurCodage, codage = '//' } = {}) {\n//     this.epaisseur = 0.5 // paisseur et couleur de crayon de papier bien taill pour la construction\n//     this.couleur = 'gray'\n//     if (nom === undefined || nom === '') {\n//       nom = p.nom + \"'\"\n//     }\n//     const image = symetrieAxiale(p, d, nom) // on dfinit le point image (pour le viser avec la rgle on ajoute une apostrophe au nom)\n//     if (longueur(p, image) !== 0) {\n//       const M = milieu(p, image) // on cre le point milieu\n//       const N = rotation(p, M, 90)\n//       const D = rotation(N, M, 180)\n//       this.regleMasquerGraduations()\n//       this.perpendiculaireRegleEquerre2points3epoint(N, D, p)\n//       this.compasEcarter2Points(M, p)\n//       this.compasTracerArcCentrePoint(M, image)\n//       this.regleSegment(p, image)\n//       this.regleMasquer()\n//       this.equerreMasquer()\n//       this.segmentCodage(p, M, { codage: codage, couleur: couleurCodage })\n//       this.segmentCodage(image, M, { codage: codage, couleur: couleurCodage })\n//       this.crayonMasquer()\n//       this.compasMasquer()\n//     }\n//     this.pointCreer(image, { couleur: couleur, couleurLabel: couleur }) // on construit l'image\n//   }\n\n/**\n *\n * @param {objet} p  le point dont on veut construire l'image\n * @param {objet} le point de dpart de la translation\n * @param {objet} le point d'arrive de la translation\n * @param {string} nom le nom de l'image (si pas prcis ce sera le nom de l'antcdent avec un ')\n * @param {objet} param4 options couleur et couleurCodage\n * @author Jean-Claude Lhote\n */\nexport const translationPoint = function (\n  this: Alea2iep,\n  p: PointAbstrait,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  nom: string,\n  options: OptionsCompas = {},\n) {\n  const v = vecteur(A, B)\n  if (nom === undefined || nom === '') {\n    nom = p.nom + \"'\"\n  }\n  const image = translation(p, v, nom) // on dfinit le point image (pour le viser avec la rgle on ajoute une apostrophe au nom)\n  if (longueur(A, p) !== 0) {\n    // si le point de dpart A est l'antcdent, alors le point d'arrive B est l'image... pas besoin de construction\n    this.compasEcarter2Points(A, p, options)\n    this.compasTracerArcCentrePoint(B, image, options)\n    this.compasEcarter2Points(A, B, options)\n    this.compasTracerArcCentrePoint(p, image, options)\n  }\n  this.compasMasquer()\n  this.pointCreer(image, options)\n  const choix1 = randint(0, 4)\n  const choix2 = randint(0, 4, choix1)\n  const marque1 = marques[choix1]\n  const marque2 = marques[choix2]\n  this.traitRapide(\n    p,\n    image,\n    Object.assign({}, options, { epaisseur: 0.5, pointilles: true }),\n  )\n  this.traitRapide(\n    A,\n    B,\n    Object.assign({}, options, { epaisseur: 0.5, pointilles: true }),\n  )\n  this.segmentCodage(p, image, Object.assign({}, options, { codage: marque1 }))\n  this.segmentCodage(A, B, Object.assign({}, options, { codage: marque1 }))\n  this.traitRapide(\n    B,\n    image,\n    Object.assign({}, options, { epaisseur: 0.5, pointilles: true }),\n  )\n  this.traitRapide(\n    A,\n    p,\n    Object.assign({}, options, { epaisseur: 0.5, pointilles: true }),\n  )\n  this.segmentCodage(B, image, Object.assign({}, options, { codage: marque2 }))\n  this.segmentCodage(A, p, Object.assign({}, options, { codage: marque2 }))\n}\n\n/**\n *\n * @param {objet} p  le point dont on veut construire l'image\n * @param {objet} centre le centre de symtrie\n * @param {string} nom le nom de l'image (si pas prcis ce sera le nom de l'antcdent avec un ')\n * @param {objet} param3 options couleur, couleurCodage et codage\n * @author Jean-Claude Lhote\n */\nexport const demiTourPoint = function (\n  this: Alea2iep,\n  p: PointAbstrait,\n  centre: PointAbstrait,\n  nom: string,\n  options: OptionsCompas = {},\n) {\n  if (nom === undefined || nom === '') {\n    nom = p.nom + \"'\"\n  }\n  const image = rotation(p, centre, 180, nom) // on dfinit le point image (pour le viser avec la rgle on ajoute une apostrophe au nom)\n  this.compasEcarter2Points(centre, p, options)\n  this.compasTracerArcCentrePoint(centre, image, options)\n  this.compasMasquer(options)\n  this.crayonDeplacer(p, options)\n  this.regleSegment(\n    p,\n    image,\n    Object.assign({}, options, { epaisseur: 0.5, pointilles: true }),\n  ) // on trace le segment\n  this.pointCreer(image, options) // on construit l'image\n  this.regleMasquer(options)\n  this.crayonMasquer(options)\n  this.segmentCodage(p, centre, options)\n  this.segmentCodage(centre, image, options)\n}\n\ntype OptionsHomothetiePoint = OptionsCompas & {\n  positionTexte: { x: number; y: number }\n}\n\n/**\n *\n * @param {objet} p point dont on doit construire l'image\n * @param {objet} centre de l'homothtie\n * @param {number} k rapport de l'homothtie\n * @param {array} noms tableau contenant les diffrents noms des sommets dans le mme ordre que ceux de p. Si vide, alors on ajoute '  ceux de p\n * @param {objet} param4 options (couleur)\n */\nexport const homothetiePoint = function (\n  this: Alea2iep,\n  p: PointAbstrait,\n  centre: PointAbstrait,\n  k: number,\n  nom: string,\n  options: OptionsHomothetiePoint,\n) {\n  let idTexte: number\n  if (nom === undefined || nom === '') {\n    nom = p.nom + \"'\"\n  }\n  const image = homothetie(p, centre, k, nom) // on dfinit le point image (pour le viser avec la rgle on ajoute une apostrophe au nom)\n  if (k > 0) {\n    idTexte = this.textePosition(\n      `Comme le rapport est positif, alors les points ${p.nom} et ${image.nom} sont du mme ct de ${centre.nom}.`,\n      options.positionTexte.x,\n      options.positionTexte.y,\n      Object.assign({ taille: 15 }, options),\n    )\n  } else {\n    idTexte = this.textePosition(\n      `Comme le rapport est ngatif, alors ${centre.nom} est entre les points ${p.nom} et ${image.nom}.`,\n      options.positionTexte.x,\n      options.positionTexte.y,\n      Object.assign({ taille: 15 }, options),\n    )\n  }\n  this.regleSegment(\n    p,\n    centre,\n    Object.assign({}, options, { epaisseur: 0.5, pointilles: true }),\n  )\n  const l = longueur(p, centre)\n  const lprime = arrondi(l, 1) * Math.abs(k)\n  const idTexte1 = this.textePosition(\n    `La mesure de [${centre.nom}${p.nom}] est ${stringNombre(l, 1)} cm et le rapport de l'homothtie est ${stringNombre(k, 3)}`,\n    options.positionTexte.x,\n    options.positionTexte.y - 1,\n    Object.assign({ taille: 15 }, options),\n  )\n  const idTexte2 = this.textePosition(\n    `donc ${centre.nom}${image.nom} est ${stringNombre(l, 1)} cm  ${stringNombre(Math.abs(k), 3)} = ${stringNombre(lprime, 2)} cm.`,\n    options.positionTexte.x,\n    options.positionTexte.y - 2,\n    Object.assign({ taille: 15 }, options),\n  )\n  this.regleSegment(\n    centre,\n    image,\n    Object.assign({}, options, { epaisseur: 0.5, pointilles: true }),\n  )\n  this.regleMasquer(options)\n  this.crayonMasquer(options)\n  this.pointCreer(image, Object.assign({ couleurPoint: 'blue' }, options))\n  this.pause()\n  this.texteMasquer(idTexte1, options)\n  this.texteMasquer(idTexte2, options)\n  this.texteMasquer(idTexte, options)\n}\n/**\n *\n * @param {objet} p le polygone qui est dj trac\n * @param {objet} centre le centre de la rotation\n * @param {number} angle l'angle de rotation\n * @author Jean-Claude Lhote\n * @param {objet} param4 options couleur et couleurCodage\n */\nexport const rotationPolygone = function (\n  this: Alea2iep,\n  p: Polygone,\n  centre: PointAbstrait,\n  angle: number,\n  noms: string[] = [],\n  options: OptionsCompas = {\n    couleur: this.couleur,\n    couleurCodage: this.couleurCodage,\n  },\n) {\n  let nom\n  const p2 = rotation(p, centre, angle) // Pour tracer la figure image  la fin de l'animation avec polygoneRapide\n  let codageAngle\n  const marquesAlea = shuffle(marques) // on mlange les marques pour le codage des angles\n  for (let i = 0; i < p.listePoints.length; i++) {\n    if (noms[i] !== undefined) {\n      nom = noms[i]\n    } else {\n      nom = p.listePoints[i].nom + \"'\"\n    }\n    if (i < 1) {\n      codageAngle = options.codage ?? 'plein'\n    } else {\n      codageAngle = ''\n    }\n    if (longueur(centre, p.listePoints[i]) !== 0) {\n      this.rotationPoint(\n        p.listePoints[i],\n        centre,\n        angle,\n        nom,\n        Object.assign({}, options, { codage: codageAngle }),\n      )\n      this.segmentCodage(\n        p.listePoints[i],\n        centre,\n        Object.assign({}, options, { codage: marquesAlea[i] }),\n      )\n      this.segmentCodage(\n        p2.listePoints[i],\n        centre,\n        Object.assign({}, options, { codage: marquesAlea[i] }),\n      )\n    }\n  }\n  this.polygoneRapide(\n    ...p2.listePoints,\n    Object.assign(options, { epaisseur: 2 }),\n  ) // on trace le polygone image en bleu paisseur 2\n}\n\n/**\n *\n * @param {objet} p polygone dont on construit l'image et qui doit tre trac avec ses points nomms.\n * @param {objet} d axe de symtrie.\n * @param {string[]} noms tableau contenant les noms des sommets dans le mme ordre que p\n * @param {objet} param3 options couleur et couleurCodage\n * @author Liouba Leroux et Jean-Claude Lhote\n */\nexport const symetrieAxialePolygone = function (\n  this: Alea2iep,\n  p: Polygone,\n  d: Droite,\n  noms: string[] = [],\n  options: OptionsCompas = {},\n) {\n  let nom: string\n  const p2 = symetrieAxiale(p, d) // Pour tracer la figure image  la fin de l'animation avec polygoneRapide\n  // const N = homothetie(milieu(p.listePoints[0], p2.listePoints[0]), milieu(p.listePoints[1], p2.listePoints[1]), 1.23456) // crer unh point de l'axe de symtrie pour les alignements et les mesure d'angles\n  let i = 0\n  const marques = ['/', '//', '///', 'O', '\\\\\\\\']\n  for (const sommet of p.listePoints) {\n    // On rpte la construction pour chaque sommet du polygone\n    if (noms[i] !== undefined) {\n      nom = noms[i]\n    } else {\n      nom = sommet.nom + \"'\"\n    }\n    this.symetrieAxialePoint(\n      sommet,\n      d,\n      nom,\n      Object.assign({}, options, { codage: marques[i], epaisseur: 0.5 }),\n    )\n    i++\n  }\n  this.compasMasquer(options)\n  this.crayonMasquer(options)\n  this.polygoneRapide(\n    ...p2.listePoints,\n    Object.assign({}, options, { epaisseur: 2 }),\n  ) // on trace le polygone image en bleu paisseur 2\n}\n\n/**\n *\n * @param {objet} p polygone dont on construit l'image\n * @param {objet} A point de dpart de la translation\n * @param {objet} B point d'arrive de la translation\n * @param {string[]} noms tableau contenant les noms des sommets dans le mme ordre que p\n * @param {objet} param3 options couleur et couleurCodage\n * @author Jean-Claude Lhote\n */\nexport const translationPolygone = function (\n  this: Alea2iep,\n  p: Polygone,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  noms: string[] = [],\n  options: OptionsCompas = {},\n) {\n  let nom\n  const v = vecteur(A, B)\n  const p2 = translation(p, v) // Pour tracer la figure image  la fin de l'animation avec polygoneRapide\n  for (let i = 0; i < p.listePoints.length; i++) {\n    if (noms[i] !== undefined) {\n      nom = noms[i]\n    } else {\n      nom = p.listePoints[i].nom + \"'\"\n    }\n    this.translationPoint(p.listePoints[i], A, B, nom, options)\n  }\n  this.polygoneRapide(\n    ...p2.listePoints,\n    Object.assign({}, options, { epaisseur: 2 }),\n  ) // on trace le polygone image en bleu paisseur 2\n}\n/**\n *\n * @param {objet} p  le polygone dont on veut construire l'image qui doit tre trac\n * @param {objet} centre le centre de symtrie\n * @param {array} noms les noms des sommets images (si pas prcis ce sera le nom de l'antcdent avec un ')\n * @param {objet} param3 options couleur et couleurCodage\n * @author Jean-Claude Lhote\n */\nexport const demiTourPolygone = function (\n  this: Alea2iep,\n  p: Polygone,\n  centre: PointAbstrait,\n  noms: string[] = [],\n  options: OptionsCompas = {},\n) {\n  const p2 = rotation(p, centre, 180) // Pour tracer la figure image  la fin de l'animation avec polygoneRapide\n  let nom\n  let i = 0\n  const marques = ['/', '//', '///', 'O', '\\\\\\\\']\n  for (const sommet of p.listePoints) {\n    // On rpte la construction pour chaque sommet du polygone\n    if (noms[i] !== undefined) {\n      nom = noms[i]\n    } else {\n      nom = sommet.nom + \"'\"\n    }\n    this.demiTourPoint(\n      sommet,\n      centre,\n      nom,\n      Object.assign({}, options, { codage: marques[i] }),\n    )\n    i++\n  }\n  this.polygoneRapide(\n    ...p2.listePoints,\n    Object.assign({}, options, { epaisseur: 2 }),\n  ) // on trace le polygone image en bleu paisseur 2\n}\n\n/**\n *\n * @param {objet} p polygone dont on doit construire l'image\n * @param {objet} centre de l'homothtie\n * @param {number} k rapport de l'homothtie\n * @param {array} noms tableau contenant les diffrents noms des sommets dans le mme ordre que ceux de p. Si vide, alors on ajoute '  ceux de p\n * @param {objet} param4 options (couleur)\n */\nexport const homothetiePolygone = function (\n  this: Alea2iep,\n  p: Polygone,\n  centre: PointAbstrait,\n  k: number,\n  noms = [],\n  options: OptionsCompas = {},\n) {\n  let nom\n  const p2 = homothetie(p, centre, k) // Pour tracer la figure image  la fin de l'animation avec polygoneRapide\n  const t = this.textePosition(\n    'Comme k est ' +\n      (k >= 0 ? 'positif' : 'ngatif') +\n      ' alors ' +\n      (k >= 0\n        ? 'les figures sont du mme ct de ' + centre.nom\n        : centre.nom + ' est entre les figures'),\n    0,\n    0,\n    Object.assign({ taille: 15 }, options),\n  )\n  let i = 0\n  for (const sommet of p.listePoints) {\n    // On rpte la construction pour chaque sommet du polygone\n    if (noms[i] !== undefined) {\n      nom = noms[i]\n    } else {\n      nom = sommet.nom + \"'\"\n    }\n    this.homothetiePoint(\n      sommet,\n      centre,\n      k,\n      nom,\n      Object.assign({}, options, {\n        epaisseur: 1,\n        positionTexte: { x: 0, y: 0 },\n      }),\n    ) // on construit l'image\n    i++\n  }\n  this.polygoneRapide(\n    ...p2.listePoints,\n    Object.assign({}, options, { epaisseur: 2 }),\n  ) // on trace le polygone image en bleu paisseur 2\n  this.texteMasquer(t)\n}\n","import { cercle } from '../../lib/2d/cercle'\nimport { droite, droiteParPointEtPerpendiculaire } from '../../lib/2d/droites'\nimport {\n  point,\n  Point,\n  pointAdistance,\n  pointIntersectionCC,\n  pointIntersectionDD,\n  pointIntersectionLC,\n  pointSurSegment,\n} from '../../lib/2d/points'\nimport type { PointAbstrait } from '../../lib/2d/points-abstraits'\nimport { longueur } from '../../lib/2d/segmentsVecteurs'\nimport { homothetie, rotation } from '../../lib/2d/transformations'\nimport { triangle2points2longueurs } from '../../lib/2d/triangle'\nimport { nombreAvecEspace } from '../../lib/outils/texNombre'\nimport type Alea2iep from '../Alea2iep'\nimport type { OptionsCompas } from '../Alea2iep'\nimport { randint } from '../outils'\n\n/**\n * Macro de construction d'un triangle  partir de ses 3 dimensions. Le premier point aura pour coordonnes (6,0).\n * @param {string} ABC Une chaine de caractre de 3 lettre\n * @param {*} AB Distance entre le 1er et le 2e sommet\n * @param {*} AC Distance entre le 1er et le 3e sommet\n * @param {*} BC Distance entre le 2e et le 3e sommet\n * @param {boolean} description Affichage d'un texte descriptif des tapes de la construction\n * @return {array} [A, B, C] les 3 sommets du triangle (objets MathALEA2D)\n */\nexport const triangle3longueurs = function (\n  this: Alea2iep,\n  ABC: string,\n  AB: number,\n  AC: number,\n  BC: number,\n  options: OptionsCompas = {},\n) {\n  const A = point(6, 0)\n  const B = pointAdistance(A, AB, randint(-20, 20))\n  const p = triangle2points2longueurs(A, B, AC, BC)\n  const C = p.listePoints[2]\n  let description = options.description ?? true\n  if (ABC.length !== 3) {\n    description = false\n  } else {\n    A.nom = ABC[0]\n    B.nom = ABC[1]\n    C.nom = ABC[2]\n  }\n\n  if (description)\n    this.textePosition(\n      `${A.nom + B.nom} = ${nombreAvecEspace(AB)} cm`,\n      0,\n      -2,\n      options,\n    )\n  this.pointCreer(A, options)\n  // this.regleRotation(droite(A,B).angleAvecHorizontale, options)\n  // this.regleMontrer(A, options)\n  this.regleSegment(A, B, options)\n  this.pointCreer(B, options)\n  this.crayonMasquer(options)\n  if (description)\n    this.textePosition(\n      `${A.nom + C.nom} = ${nombreAvecEspace(AC)} cm donc ${C.nom} appartient au cercle de centre ${A.nom} et de rayon ${nombreAvecEspace(AC)} cm.`,\n      0,\n      -3,\n      options,\n    )\n  this.couleur = 'forestgreen'\n  this.epaisseur = 2\n  this.compasMontrer(A, options)\n  this.compasEcarterAvecRegle(AC, options)\n  this.compasTracerArcCentrePoint(A, C, options)\n  if (description)\n    this.textePosition(\n      `${B.nom + C.nom} = ${nombreAvecEspace(BC)} cm donc ${C.nom} appartient au cercle de centre ${B.nom} et de rayon ${nombreAvecEspace(BC)} cm.`,\n      0,\n      -4,\n      options,\n    )\n  this.compasDeplacer(B, options)\n  this.compasEcarterAvecRegle(BC, options)\n  this.compasTracerArcCentrePoint(B, C, options)\n  this.compasMasquer(options)\n  this.couleur = 'blue'\n  this.epaisseur = 3\n  if (description)\n    this.textePosition(\n      `Le point ${C.nom} est  une intersection des deux cercles.`,\n      0,\n      -5,\n      options,\n    )\n  this.pointCreer(C, options)\n  this.regleSegment(B, C, options)\n  this.regleSegment(C, A, options)\n  this.crayonMasquer(options)\n  this.regleMasquer(options)\n  return [A, B, C]\n}\n/**\n * Macro de construction d'un triangle rectangle (l'angle droit est le 2e point dans l'ordre du nom)\n *   partir de la donne de la longueur d'un ct et de la longueur de l'hypotnuse.\n *  Le premier sommet aura pour coordonnes (6, 0)\n * @param {string} ABC Une chaine de caractre de 3 lettre\n * @param {*} AB Distance entre le 1er et le 2e sommet\n * @param {*} AC Distance entre le 1er et le 3e sommet (hypotnuse)\n * @param {boolean} description Affichage d'un texte descriptif des tapes de la construction\n * @return {array} [A, B, C] les 3 sommets du triangle (objets MathALEA2D)\n */\nexport const triangleRectangleCoteHypotenuse = function (\n  this: Alea2iep,\n  ABC: string,\n  AB: number,\n  AC: number,\n  options: OptionsCompas = {},\n) {\n  // Triangle rectangle en B\n  const A = point(6, 0)\n  const B = pointAdistance(A, AB, randint(-20, 20))\n  const dAB = droite(A, B)\n  dAB.isVisible = false\n  const dBC = droiteParPointEtPerpendiculaire(B, dAB)\n  dBC.isVisible = false\n  const cAC = cercle(A, AC)\n  cAC.isVisible = false\n  const C = pointIntersectionLC(dBC, cAC) as Point\n  const c = homothetie(C, B, 1.2)\n  let description = options.description ?? true\n  if (ABC.length !== 3) {\n    description = false\n  } else {\n    A.nom = ABC[0]\n    B.nom = ABC[1]\n    C.nom = ABC[2]\n  }\n\n  if (longueur(A, C) > 8) this.equerreZoom(150)\n  if (description)\n    this.textePosition(`${A.nom + B.nom} = ${nombreAvecEspace(AB)} cm`, 0, -2)\n  this.equerreRotation(dAB.angleAvecHorizontale, options)\n  this.pointCreer(A, options)\n  this.regleSegment(A, B, options)\n  this.pointCreer(B, options)\n  if (description)\n    this.textePosition(\n      `${A.nom + B.nom + C.nom} est un triangle rectangle en ${B.nom} donc ${C.nom} appartient  la perpendiculaire  (${A.nom + B.nom}) passant par ${B.nom}.`,\n      0,\n      -3,\n      options,\n    )\n  this.equerreMontrer(A, options)\n  this.equerreDeplacer(B, options)\n  this.tracer(c, options)\n  this.equerreMasquer(options)\n  this.codageAngleDroit(A, B, C, options)\n  this.crayonMasquer(options)\n  if (description)\n    this.textePosition(\n      `${A.nom + C.nom} = ${nombreAvecEspace(AC)} cm donc ${C.nom} appartient au cercle de centre ${A.nom} et de rayon ${nombreAvecEspace(AC)} cm.`,\n      0,\n      -4,\n      options,\n    )\n  this.compasMontrer(A, options)\n  this.compasEcarterAvecRegle(AC, options)\n  this.couleur = 'forestgreen'\n  this.epaisseur = 2\n  this.compasTracerArcCentrePoint(A, C, options)\n  this.couleur = 'blue'\n  this.epaisseur = 2\n  if (description)\n    this.textePosition(\n      `${C.nom} est  une intersection de la perpendiculaire et du cercle.`,\n      0,\n      -5,\n      options,\n    )\n  this.crayonMontrer(C, options)\n  this.pointCreer(C, options)\n  this.compasMasquer(options)\n  this.regleSegment(A, C, options)\n  this.regleMasquer(options)\n  this.crayonMasquer(options)\n  return [A, B, C]\n}\n\n/**\n * Macro de construction d'un triangle rectangle (l'angle droit est le 2e point dans l'ordre du nom)\n *   partir de la donne de la longueur des deux cts de l'angle droit.\n *  Le premier sommet aura pour coordonnes (6, 0)\n * @param {string} ABC Une chaine de caractre de 3 lettre\n * @param {*} AB Distance entre le 1er et le 2e sommet\n * @param {*} AC Distance entre le 1er et le 3e sommet (hypotnuse)\n * @param {boolean} description Affichage d'un texte descriptif des tapes de la construction\n * @return {array} [A, B, C] les 3 sommets du triangle (objets MathALEA2D)\n */\nexport const triangleRectangle2Cotes = function (\n  this: Alea2iep,\n  ABC: string,\n  AB: number,\n  BC: number,\n  options: OptionsCompas = {},\n) {\n  // Triangle rectangle en B\n  const A = point(6, 0)\n  const B = pointAdistance(A, AB, randint(-20, 20))\n  const dAB = droite(A, B)\n  dAB.isVisible = false\n  const dBC = droiteParPointEtPerpendiculaire(B, dAB)\n  dBC.isVisible = false\n  const cBC = cercle(B, BC)\n  cBC.isVisible = false\n  const C = pointIntersectionLC(dBC, cBC) as Point\n  const c = homothetie(C, B, 1.2)\n  let description = options.description ?? true\n  if (ABC.length !== 3) {\n    description = false\n  } else {\n    A.nom = ABC[0]\n    B.nom = ABC[1]\n    C.nom = ABC[2]\n  }\n\n  if (longueur(A, C) > 8) this.equerreZoom(150, options)\n  if (description)\n    this.textePosition(\n      `${A.nom + B.nom} = ${nombreAvecEspace(AB)} cm`,\n      0,\n      -2,\n      options,\n    )\n  this.equerreRotation(dAB.angleAvecHorizontale, options)\n  this.pointCreer(A, options)\n  this.regleSegment(A, B, options)\n  this.pointCreer(B, options)\n  if (description)\n    this.textePosition(\n      `${A.nom + B.nom + C.nom} est un triangle rectangle en ${B.nom} donc ${C.nom} appartient  la perpendiculaire  (${A.nom + B.nom}) passant par ${B.nom}.`,\n      0,\n      -3,\n      options,\n    )\n  this.equerreMontrer(A, options)\n  this.equerreDeplacer(B, options)\n  this.tracer(c, options)\n  this.equerreMasquer(options)\n  this.codageAngleDroit(A, B, C, options)\n  if (description)\n    this.textePosition(\n      `${B.nom + C.nom} = ${nombreAvecEspace(BC)} cm donc ${C.nom} est  ${nombreAvecEspace(BC)} cm de ${B.nom} sur la perpendiculaire  (${A.nom + B.nom}) passant par ${B.nom}.`,\n      0,\n      -4,\n      options,\n    )\n  this.regleMontrer(B, options)\n  this.regleRotation(C, options)\n  this.crayonDeplacer(C, options)\n  this.pointCreer(C, options)\n  this.couleur = 'blue'\n  this.epaisseur = 2\n  this.compasMasquer(options)\n  this.regleSegment(A, C, options)\n  this.regleMasquer(options)\n  this.crayonMasquer(options)\n\n  return [A, B, C]\n}\n\ntype OptionsTriangle1longueur2angles = OptionsCompas & {\n  mesure?: boolean\n}\n/**\n * Macro de construction d'un triangle  partir d'une longueur et des 2 angles adajcents au ct connu. Le premier point aura pour coordonnes (6,0).\n * @param {string} ABC Une chaine de caractre de 3 lettre\n * @param {*} AB Distance entre le 1er et le 2e sommet\n * @param {*} BAC Angle au 1er sommet\n * @param {*} CBA Angle au 2e sommet\n * @param {boolean} description Affichage d'un texte descriptif des tapes de la construction\n * @return {array} [A, B, C] les 3 sommets du triangle (objets MathALEA2D)\n */\nexport const triangle1longueur2angles = function (\n  this: Alea2iep,\n  NOM: string | string[],\n  AB: number,\n  BAC: number,\n  CBA: number,\n  options: OptionsTriangle1longueur2angles = {},\n) {\n  const angle = randint(-20, 20)\n  const a1 = BAC\n  const a2 = CBA\n  const A = point(6, 0)\n  const B = pointAdistance(A, AB, angle)\n  const D = pointAdistance(A, 5.2, a1 + angle)\n  const D2 = pointSurSegment(A, D, 10)\n  const D1 = pointSurSegment(D, D2, 0.4)\n  const E = pointAdistance(B, 3, 180 - a2 + angle)\n  const E2 = pointSurSegment(B, E, 10)\n  const E1 = pointSurSegment(E, E2, -0.4)\n  const F = pointAdistance(B, 5.2, 180 - a2 + angle)\n  const F1 = pointSurSegment(F, E2, 0.4)\n  const d = rotation(droite(A, B), A, a1)\n  D.isVisible = false\n  const d2 = rotation(droite(B, A), B, -a2)\n  d2.isVisible = false\n  const C = pointIntersectionDD(d, d2) as Point\n  let description = options.description ?? true\n  const mesure = options.mesure ?? false\n  if (NOM.length !== 3) {\n    description = false\n  } else {\n    A.nom = NOM[0]\n    B.nom = NOM[1]\n    C.nom = NOM[2]\n  }\n  this.couleur = 'blue'\n  this.epaisseur = 3\n  this.pointCreer(A, options)\n  if (description)\n    this.textePosition(\n      `On trace le ct [${A.nom + B.nom}] de ${nombreAvecEspace(AB)} cm.`,\n      0,\n      -4,\n      options,\n    )\n  this.regleSegment(A, B, options)\n  this.pointCreer(B, options)\n  this.couleur = 'grey'\n  this.epaisseur = 1\n  this.rapporteurMontrer(A, options)\n  this.rapporteurDeplacer(A, options)\n  this.rapporteurRotation(angle, options)\n  if (description)\n    this.textePosition(\n      `On place un repre  ${a1} degrs pour tracer la demi-droite [${A.nom + C.nom}).`,\n      0,\n      -5,\n      options,\n    )\n  this.epaisseur = 3\n  this.trait(D, D1, Object.assign({}, options, { tempo: 20 }))\n  this.epaisseur = 1\n  this.rapporteurMasquer(options)\n  this.regleSegment(A, D2, options)\n  this.regleMasquer(options)\n  this.angleCodage(B, A, C, options)\n  this.rapporteurMontrer(A, options)\n  this.rapporteurDeplacer(B, options)\n  if (description)\n    this.textePosition(\n      `On place un repre  ${a2} degrs pour tracer la demi-droite [${B.nom + C.nom}).`,\n      0,\n      -6,\n      options,\n    )\n  this.epaisseur = 3\n  this.trait(E, E1, Object.assign({}, options, { tempo: 10 }))\n  this.trait(F, F1, Object.assign({}, options, { tempo: 20 }))\n  this.epaisseur = 1\n  this.rapporteurMasquer(options)\n  this.regleMontrer(B, options)\n  this.regleSegment(B, E2, options)\n  this.angleCodage(C, B, A, options)\n  this.pointCreer(C, options)\n  // this.pointNommer(C, C.nom, -0.5, 1, options)\n  this.couleur = 'blue'\n  this.epaisseur = 3\n  this.regleSegment(B, C, options)\n  this.regleSegment(C, A, options)\n  this.regleMasquer(options)\n  this.crayonMasquer(options)\n  if (description && mesure)\n    this.textePosition(\n      `On peut mesurer ${A.nom + C.nom}  ${nombreAvecEspace(longueur(A, C, 1))} cm et ${B.nom + C.nom}  ${nombreAvecEspace(longueur(B, C, 1))} cm.`,\n      0,\n      -7,\n      options,\n    )\n\n  return [A, B, C]\n}\n/**\n * Macro de construction d'un triangle  partir des longueurs des deux cts d'un angle Le premier point a pour coordonnes (6,0).\n * @param {string} ABC Une chaine de caractre de 3 lettre\n * @param {*} AB Distance entre le 1er et le 2e sommet\n * @param {*} AC Distance entre le 1er et le 3e sommet\n * @param {*} BAC Angle au 1er sommet\n * @param {boolean} description Affichage d'un texte descriptif des tapes de la construction\n * @return {array} [A, B, C] les 3 sommets du triangle (objets MathALEA2D)\n */\nexport const triangle2longueurs1angle = function (\n  this: Alea2iep,\n  NOM: string,\n  AB: number,\n  AC: number,\n  BAC: number,\n  options: OptionsCompas = {},\n) {\n  let description = options.description ?? true\n  const angle = randint(-20, 20)\n  const a1 = BAC\n  const A = point(6, 0)\n  const B = pointAdistance(A, AB, angle)\n  const D = pointAdistance(A, 5.2, a1 + angle)\n  const D2 = pointSurSegment(A, D, 10)\n  const D1 = pointSurSegment(D, D2, 0.4)\n  const C = pointSurSegment(A, D2, AC)\n  if (NOM.length !== 3) {\n    description = false\n  } else {\n    A.nom = NOM[0]\n    B.nom = NOM[1]\n    C.nom = NOM[2]\n  }\n  this.couleur = 'blue'\n  this.epaisseur = 3\n  this.pointCreer(A, options)\n  if (description)\n    this.textePosition(\n      `On trace le ct [${A.nom + B.nom}] de ${nombreAvecEspace(AB)} cm.`,\n      0,\n      -4,\n      options,\n    )\n  this.regleSegment(A, B, options)\n  this.pointCreer(B, options)\n  this.couleur = 'grey'\n  this.epaisseur = 1\n  this.rapporteurMontrer(A, options)\n  this.rapporteurDeplacer(A, options)\n  this.rapporteurRotation(angle, options)\n  if (description)\n    this.textePosition(\n      `On place un repre  ${a1} degrs pour tracer la demi-droite [${A.nom + C.nom}).`,\n      0,\n      -5,\n      options,\n    )\n  this.epaisseur = 3\n  this.trait(D, D1, Object.assign({}, options, { tempo: 20 }))\n  this.epaisseur = 1\n  this.rapporteurMasquer(options)\n  this.regleSegment(A, D2, options)\n  this.angleCodage(B, A, C, options)\n  this.rapporteurMasquer(options)\n  if (description)\n    this.textePosition(\n      `On place le point ${C.nom} sur la demi-droite [${A.nom + C.nom})  ${AC} cm de ${A.nom}.`,\n      0,\n      -6,\n      options,\n    )\n  this.epaisseur = 3\n  this.couleur = 'blue'\n  this.crayonDeplacer(C, options)\n  this.pointCreer(C, options)\n  this.regleSegment(A, C, options)\n  this.crayonMasquer(options)\n  if (description)\n    this.textePosition(`On trace le ct [${B.nom + C.nom}].`, 0, -7, options)\n  this.regleMontrer(C, options)\n  this.crayonMontrer(C, options)\n  this.regleSegment(C, B, options)\n  this.regleMasquer(options)\n  this.crayonMasquer(options)\n  return [A, B, C]\n}\n\n/**\n * Trace un triangle quilatral  partir de la donne de 2 points\n * @param {point} A\n * @param {point} B\n * @param {string} nomC\n * @return {array} [A, B, C]\n */\nexport const triangleEquilateral2Sommets = function (\n  this: Alea2iep,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  nomC: string = '',\n) {\n  const C = rotation(B, A, 60)\n  C.nom = nomC\n  this.traitRapide(A, B)\n  this.pointCreer(A)\n  this.pointCreer(B)\n  this.compasEcarter2Points(A, B)\n  this.compasTracerArcCentrePoint(A, C)\n  this.compasTracerArcCentrePoint(B, C)\n  this.pointCreer(C)\n  this.compasMasquer()\n  this.regleSegment(A, C)\n  this.regleSegment(C, B)\n  this.regleMasquer()\n  this.crayonMasquer()\n  this.segmentCodage(A, B)\n  this.segmentCodage(A, C)\n  this.segmentCodage(B, C)\n  return [A, B, C]\n}\n/**\n * Trace un triangle quilatral  partir de la donne de la longueur du ct. Le premier point a pour coordonnes (6;0)\n * @param {string} NOM\n * @param {number} AB\n * @return {array} [A, B, C]\n */\n\nexport const triangleEquilateral = function (\n  this: Alea2iep,\n  NOM: string | string[],\n  AB: number,\n) {\n  const A = point(6, 0)\n  const B = pointAdistance(A, AB, randint(-20, 20))\n  const C = rotation(B, A, 60)\n  if (NOM.length === 3) {\n    A.nom = NOM[0]\n    B.nom = NOM[1]\n    C.nom = NOM[2]\n  }\n  this.regleSegment(A, B)\n  this.pointCreer(A)\n  this.pointCreer(B)\n  this.compasEcarter2Points(A, B)\n  this.compasTracerArcCentrePoint(A, C)\n  this.compasTracerArcCentrePoint(B, C)\n  this.pointCreer(C)\n  this.compasMasquer()\n  this.regleSegment(A, C)\n  this.regleSegment(C, B)\n  this.regleMasquer()\n  this.crayonMasquer()\n  this.segmentCodage(A, B)\n  this.segmentCodage(A, C)\n  this.segmentCodage(B, C)\n  return [A, B, C]\n}\n\nexport const triangleIsocele2Longueurs = function (\n  this: Alea2iep,\n  NOM: string | string[],\n  AB: number, // cts gaux\n  AC: number, // base,\n  options: OptionsCompas = {},\n) {\n  const A = point(6, 0)\n  const C = pointAdistance(A, AC, randint(-10, 10))\n  const CC = pointAdistance(A, AB, 0)\n  const c1 = cercle(A, AB)\n  const c2 = cercle(C, AB)\n  const B = pointIntersectionCC(c1, c2, 'C', 1) as PointAbstrait\n\n  //\n  if (NOM.length === 3) {\n    A.nom = NOM[0]\n    B.nom = NOM[2]\n    C.nom = NOM[1]\n  }\n  this.pointCreer(A, options)\n  // this.regleRotation(droite(A,B).angleAvecHorizontale, options)\n  // this.regleMontrer(A, options)\n  this.regleSegment(A, C, options)\n  this.compasMontrer(A, options)\n  this.pointCreer(C, options)\n  this.compasEcarterAvecRegle(AB, options)\n  this.compasTracerArcCentrePoint(A, B, options)\n  this.compasTracerArcCentrePoint(C, B, options)\n  this.pointCreer(B, options)\n  this.compasMasquer(options)\n  this.couleur = 'blue'\n  this.epaisseur = 3\n  if (options.description)\n    this.textePosition(\n      `Le point ${B.nom} est  une intersection des deux cercles.`,\n      0,\n      -5,\n      options,\n    )\n  this.pointCreer(B, options)\n  this.regleSegment(B, C, options)\n  this.regleSegment(B, A, options)\n  this.crayonMasquer(options)\n  this.regleMasquer(options)\n  return [A, B, C]\n}\n","// import iepLoadPromise from 'instrumenpoche'\nimport { angleOriente } from '../lib/2d/angles'\nimport { droite } from '../lib/2d/droites'\nimport {\n  milieu,\n  point,\n  pointAdistance,\n  pointSurSegment,\n} from '../lib/2d/points'\nimport { pointAbstrait, PointAbstrait } from '../lib/2d/points-abstraits'\nimport {\n  longueur,\n  norme,\n  Segment,\n  segment,\n  vecteur,\n} from '../lib/2d/segmentsVecteurs'\nimport {\n  homothetie,\n  rotation,\n  translation,\n  translation2Points,\n} from '../lib/2d/transformations'\nimport { context } from './context'\nimport {\n  bissectriceAuCompas,\n  cercleCirconscrit,\n  hauteur,\n  mediane,\n  mediatriceAuCompas,\n  mediatriceRegleEquerre,\n} from './iepMacros/droitesRemarquables'\nimport {\n  paralleleAuCompas,\n  paralleleAuCompasAvecDescription,\n  paralleleRegleEquerre2points3epoint,\n  paralleleRegleEquerreDroitePointAvecDescription,\n  perpendiculaireCompasPoint,\n  perpendiculaireCompasPointSurLaDroite,\n  perpendiculaireRegleEquerre2points3epoint,\n  perpendiculaireRegleEquerreDroitePoint,\n  perpendiculaireRegleEquerrePointSurLaDroite,\n} from './iepMacros/parallelesEtPerpendiculaires'\nimport {\n  parallelogramme2sommetsConsecutifsCentre,\n  parallelogramme3sommetsConsecutifs,\n  parallelogrammeAngleCentre,\n  partageSegment,\n} from './iepMacros/parallelogrammes'\nimport { carre1point1longueur } from './iepMacros/quadrilateres'\nimport {\n  demiTourPoint,\n  demiTourPolygone,\n  homothetiePoint,\n  homothetiePolygone,\n  rotationPoint,\n  rotationPolygone,\n  symetrieAxialePoint,\n  symetrieAxialePolygone,\n  translationPoint,\n  translationPolygone,\n} from './iepMacros/transformations'\nimport {\n  triangle1longueur2angles,\n  triangle2longueurs1angle,\n  triangle3longueurs,\n  triangleEquilateral,\n  triangleEquilateral2Sommets,\n  triangleIsocele2Longueurs,\n  triangleRectangle2Cotes,\n  triangleRectangleCoteHypotenuse,\n} from './iepMacros/triangles'\n\nconst store: Record<string, string> = {}\n\nexport class StoreIep {\n  static getXml(id: string) {\n    return store[id]\n  }\n\n  static saveXml(id: string, xml: string) {\n    store[id] = xml\n  }\n}\n\ntype ObjetIep = {\n  visibilite: boolean\n  position: PointAbstrait\n  angle: number\n  zoom: number\n}\n\ntype Regle = ObjetIep & {\n  longueur: number // Longueur de la rgle en cm\n}\n\ntype Rapporteur = ObjetIep & {\n  rayon: number // Rayon du rapporteur en cm\n}\n\ntype Compas = ObjetIep & {\n  orientation: 'droite' | 'gauche' // Orientation du compas\n  ecartement: number // Ecartement du compas en cm\n  leve: boolean // Le compas est-il lev ?\n}\n\ntype StringOutil =\n  | 'regle'\n  | 'equerre'\n  | 'requerre'\n  | 'rapporteur'\n  | 'compas'\n  | 'crayon'\n\nexport type OptionsIep = {\n  id?: string // Identifiant de l'objet\n  tempo?: number // Temps d'attente aprs l'instruction\n  vitesse?: number // Vitesse de dplacement des instruments\n  couleur?: string // Couleur des traits\n  epaisseur?: number // Epaisseur des traits\n  pointilles?: boolean // Pointills ou traits pleins\n  couleurLabel?: string // Couleur du label des points\n  couleurPoint?: string // Couleur du nom des points\n  description?: boolean // Pour ajouter un texte qui dcrit les tapes de construction\n}\n\nexport type OptionsOutil = OptionsIep & {}\n\nexport type OptionsCrayon = OptionsOutil & {\n  vecteur?: boolean\n}\n\nexport type OptionsOutilMesure = OptionsCrayon & {\n  longueur?: number // Longueur pour la rgle ou le compas\n  codage?: string // Code pour le codage\n  couleurCodage?: string // Couleur du codage\n  sens?: number // Sens de la rotation\n}\n\nexport type OptionsRegle = OptionsOutilMesure & {}\n\nexport type OptionsEquerre = OptionsRegle & {}\n\nexport type OptionsRequerre = OptionsEquerre & {}\n\nexport type OptionsRapporteur = OptionsOutilMesure & {}\n\nexport type OptionsCompas = OptionsRapporteur & {\n  rayon?: number // Rayon du cercle trac par le compas\n  delta?: number // Delta pour l'arc de cercle autour d'un point\n  couleurCompas?: string // Couleur du compas\n}\n\nexport type OptionsPoint = OptionsCrayon & {\n  label?: string // Label du point\n  dx?: number // Dcalage horizontal du label du point\n  dy?: number // Dcalage vertical du label du point\n}\n\nexport type OptionsTexte = OptionsIep & {\n  police?: string\n  taille?: number\n  couleur?: string\n  couleurFond?: string\n  opaciteFond?: string\n  couleurCadre?: string\n  epaisseurCadre?: number\n  marge?: number\n  margeGauche?: number\n  margeDroite?: number\n  margeHaut?: number\n  margeBas?: number\n}\n/*\n * Classe parente de tous les objets Alea2iep\n *\n * @author Rmi Angot\n */\nexport default class Alea2iep {\n  idIEP: number // Identifiant pour les tracs\n  idHTML: number // Identifiant pour les div et le svg\n  tempo: number // Pause par dfaut aprs une instruction\n  vitesse: number // Vitesse par dfaut pour les dplacements d'instruments\n  couleur: string // Couleur par dfaut\n  couleurCompas: string\n  couleurTexte: string\n  couleurPoint: string // Couleur du nom des points\n  couleurCodage: string\n  couleurTraitsDeConstruction: string\n  epaisseur: number\n  epaisseurTraitsDeConstruction: number\n  pointilles: boolean\n  liste_script: string[] // Liste des instructions xml mise  jour par les mthodes\n  translationX: number\n  translationY: number // Par dfaut l'angle en haut  gauche est le point de coordonnes (0,10)\n  xMin: number // Garde en mmoire les coordonnes extrmes des objets crs\n  yMin: number\n  xMax: number\n  yMax: number\n  regle: Regle\n  crayon: ObjetIep\n  equerre: ObjetIep\n  requerre: ObjetIep\n  rapporteur: Rapporteur\n  compas: Compas\n  xml: string // Code XML de l'animation\n  symetrieAxialePoint = symetrieAxialePoint\n  parallelogramme3sommetsConsecutifs = parallelogramme3sommetsConsecutifs\n  parallelogrammeAngleCentre = parallelogrammeAngleCentre\n  partageSegment = partageSegment\n  paralleleRegleEquerre2points3epoint = paralleleRegleEquerre2points3epoint\n  perpendiculaireRegleEquerre2points3epoint =\n    perpendiculaireRegleEquerre2points3epoint\n\n  perpendiculaireRegleEquerreDroitePoint =\n    perpendiculaireRegleEquerreDroitePoint\n\n  perpendiculaireRegleEquerrePointSurLaDroite =\n    perpendiculaireRegleEquerrePointSurLaDroite\n\n  perpendiculaireCompasPointSurLaDroite = perpendiculaireCompasPointSurLaDroite\n  perpendiculaireCompasPoint = perpendiculaireCompasPoint\n  paralleleRegleEquerreDroitePointAvecDescription =\n    paralleleRegleEquerreDroitePointAvecDescription\n\n  paralleleAuCompasAvecDescription = paralleleAuCompasAvecDescription\n  paralleleAuCompas = paralleleAuCompas\n  mediatriceAuCompas = mediatriceAuCompas\n  mediatriceRegleEquerre = mediatriceRegleEquerre\n  hauteur = hauteur\n  mediane = mediane\n  bissectriceAuCompas = bissectriceAuCompas\n  cercleCirconscrit = cercleCirconscrit\n  triangle3longueurs = triangle3longueurs\n  triangleRectangleCoteHypotenuse = triangleRectangleCoteHypotenuse\n  triangleRectangle2Cotes = triangleRectangle2Cotes\n  triangle1longueur2angles = triangle1longueur2angles\n  triangle2longueurs1angle = triangle2longueurs1angle\n  triangleEquilateral2Sommets = triangleEquilateral2Sommets\n  triangleEquilateral = triangleEquilateral\n  carre1point1longueur = carre1point1longueur\n  rotationPoint = rotationPoint\n  translationPoint = translationPoint\n  demiTourPoint = demiTourPoint\n  homothetiePoint = homothetiePoint\n  rotationPolygone = rotationPolygone\n  symetrieAxialePolygone = symetrieAxialePolygone\n  translationPolygone = translationPolygone\n  demiTourPolygone = demiTourPolygone\n  homothetiePolygone = homothetiePolygone\n  parallelogramme2sommetsConsecutifsCentre =\n    parallelogramme2sommetsConsecutifsCentre\n\n  triangleIsocele2Longueurs = triangleIsocele2Longueurs\n\n  constructor() {\n    this.idIEP = 0 // Identifiant pour les tracs\n    this.idHTML = 0 // Identifiant pour les div et le svg\n    this.tempo = 5 // Pause par dfaut aprs une instruction\n    this.vitesse = 10 // Vitesse par dfaut pour les dplacements d'instruments\n    this.couleur = 'blue' // Couleur par dfaut\n    this.couleurCompas = 'forestgreen'\n    this.couleurTexte = 'black'\n    this.couleurPoint = 'black' // Couleur du nom des points\n    this.couleurCodage = '#f15929'\n    this.couleurTraitsDeConstruction = 'gray'\n    this.epaisseur = 2\n    this.epaisseurTraitsDeConstruction = 0.5\n    this.pointilles = false\n    this.liste_script = [] // Liste des instructions xml mise  jour par les mthodes\n\n    this.translationX = 0\n    this.translationY = 10 // Par dfaut l'angle en haut  gauche est le point de coordonnes (0,10)\n\n    // Garde en mmoire les coordonnes extrmes des objets crs\n    this.xMin = 0\n    this.yMin = 0\n    this.xMax = 0\n    this.yMax = 0\n\n    // Sauvegarde de l'tat des instruments\n    this.regle = {\n      visibilite: false,\n      position: point(0, 0),\n      angle: 0,\n      longueur: 15,\n      zoom: 100,\n    }\n\n    this.crayon = {\n      visibilite: false,\n      position: point(0, 0),\n      angle: 0,\n      zoom: 100,\n    }\n\n    this.equerre = {\n      visibilite: false,\n      position: point(0, 0),\n      angle: 0,\n      zoom: 100,\n    }\n\n    this.requerre = {\n      visibilite: false,\n      position: point(0, 0),\n      angle: 0,\n      zoom: 100,\n    }\n\n    this.rapporteur = {\n      visibilite: false,\n      position: point(0, 0),\n      angle: 0,\n      rayon: 5.2,\n      zoom: 100,\n    }\n\n    this.compas = {\n      visibilite: false,\n      position: point(0, 0),\n      angle: 0,\n      orientation: 'droite',\n      ecartement: 0,\n      leve: false,\n      zoom: 100,\n    }\n\n    this.xml = ''\n  }\n  /** **** Fin du constructeur */\n\n  // Transforme les coordonnes MathALEA2D en coordonnes pour le XML d'IEP\n  x(A: PointAbstrait) {\n    const x = Math.round((A.x + this.translationX) * 30)\n    if (A.x > this.xMax) {\n      this.xMax = A.x\n    }\n    if (A.x < this.xMin) {\n      this.xMin = A.x\n    }\n    return x\n  }\n\n  y(A: PointAbstrait) {\n    const y = Math.round((-A.y + this.translationY) * 30)\n    if (A.y < this.yMin) {\n      this.yMin = A.y\n    }\n    if (A.y > this.yMax) {\n      this.yMax = A.y\n    }\n    return y\n  }\n\n  /**\n   * Renvoie le script xml\n   *\n   */\n  script() {\n    if (this.xml.length > 1) {\n      return this.xml\n    } else {\n      let codeXML = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n'\n      codeXML += '<INSTRUMENPOCHE version=\"2\">\\n'\n      codeXML += this.liste_script.join('\\n')\n      codeXML += '\\n</INSTRUMENPOCHE>'\n      return codeXML\n    }\n  }\n\n  /**\n   * Renvoie le code HTML de l'animation\n   * @param {number} numeroExercice - Numro de l'exercice\n   * @param {number} i - Numro de la question\n   */\n  html(numeroExercice: number, id2 = 0) {\n    if (context.isHtml) {\n      // Enregistrer les custom elements InstrumentPoche  la demande\n      this.ensureInstrumenPocheElementsRegistered()\n\n      const id = `IEP_${numeroExercice}_${id2}`\n      StoreIep.saveXml(id, this.script())\n      const codeHTML = `<alea-instrumenpoche id=${id}>`\n      return codeHTML\n    }\n    return ''\n  }\n\n  /**\n   *\n   * @param {number} [id1] NumeroExercice - Numro de l'exercice\n   * @param {number} [id2] Numro de la question\n   * @return Code HTML avec le bouton qui affiche ou masque un div avec l'animation\n   */\n  htmlBouton(id1 = 0, id2 = 0) {\n    if (context.isHtml) {\n      // Enregistrer les custom elements InstrumentPoche  la demande\n      this.ensureInstrumenPocheElementsRegistered()\n\n      const id = `IEP_${id1}_${id2}`\n      StoreIep.saveXml(id, this.script())\n      const codeHTML = `<alea-buttoninstrumenpoche id=${id}>`\n      return codeHTML\n    }\n    return ''\n  }\n\n  /**\n   * Enregistre les custom elements InstrumentPoche si ce n'est pas dj fait\n   */\n  private async ensureInstrumenPocheElementsRegistered() {\n    if (customElements.get('alea-instrumenpoche') === undefined) {\n      try {\n        const { ElementInstrumenpoche, ElementButtonInstrumenpoche } =\n          await import('./ElementInstrumenpoche')\n        if (customElements.get('alea-instrumenpoche') === undefined) {\n          // obliger  vrifier  nouveau car si c'est un appel concurrent,\n          //  le premier peut avoir enregistr les lments\n          customElements.define('alea-instrumenpoche', ElementInstrumenpoche)\n          customElements.define(\n            'alea-buttoninstrumenpoche',\n            ElementButtonInstrumenpoche,\n          )\n        }\n      } catch (error) {\n        // Ignore les erreurs de double enregistrement qui peuvent survenir lors de rechargements\n        if (\n          error instanceof DOMException &&\n          error.name === 'NotSupportedError'\n        ) {\n          console.debug('Custom elements already registered:', error.message)\n        } else {\n          throw error\n        }\n      }\n    }\n  }\n\n  /**\n   **************************\n   *** FONCTIONS COMMUNES ***\n   **************************\n   */\n\n  recadre(xmin: number, ymax: number) {\n    this.translationX = 1 - xmin\n    this.translationY = ymax + 3\n  }\n\n  taille(width: number, height: number) {\n    this.liste_script.push(`<viewBox width=\"${width}\" height=\"${height}\" />`)\n  }\n\n  montrer(outil: StringOutil, A: PointAbstrait, options: OptionsIep = {}) {\n    const tempo = options.tempo ?? this.tempo\n    if (!this[outil].visibilite || this[outil].position !== A) {\n      // On ajoute une ligne xml que si l'objet est cach ou doit apparaitre  un autre endroit\n      let codeXML = ''\n      let A1\n      if (typeof A === 'undefined') {\n        // A1 est une copie de A ou (0,0) si A n'est pas dfini\n        A1 = this[outil].position\n      } else {\n        A1 = A\n      }\n      if (this[outil].visibilite) {\n        // S'il est dj visible, montrer devient un dplacer\n        this.deplacer(outil, A1, options)\n      } else {\n        codeXML = `<action objet=\"${outil}\" mouvement=\"montrer\" abscisse=\"${this.x(A1)}\" ordonnee=\"${this.y(A1)}\" tempo=\"${tempo}\" />`\n        this[outil].visibilite = true\n      }\n      this[outil].position = A1\n      this.liste_script.push(codeXML)\n    }\n  }\n\n  regleMontrer(A?: PointAbstrait, options: OptionsRegle = {}) {\n    this.montrer('regle', A ?? this.regle.position, options)\n  }\n\n  crayonMontrer(A?: PointAbstrait, options: OptionsCrayon = {}) {\n    this.montrer('crayon', A ?? this.crayon.position, options)\n  }\n\n  equerreMontrer(A?: PointAbstrait, options: OptionsEquerre = {}) {\n    this.montrer('equerre', A ?? this.equerre.position, options)\n  }\n\n  requerreMontrer(A?: PointAbstrait, options: OptionsRequerre = {}) {\n    this.montrer('requerre', A ?? this.requerre.position, options)\n  }\n\n  compasMontrer(A?: PointAbstrait, options: OptionsCompas = {}) {\n    this.montrer('compas', A ?? this.compas.position, options)\n  }\n\n  rapporteurMontrer(A?: PointAbstrait, options: OptionsRapporteur = {}) {\n    this.montrer('rapporteur', A ?? this.rapporteur.position, options)\n  }\n\n  masquer(outil: StringOutil, options: OptionsOutil = {}) {\n    const tempo = options.tempo ?? this.tempo\n    if (this[outil].visibilite) {\n      // On ajoute une ligne xml que si l'objet est visible\n      const codeXML = `<action objet=\"${outil}\" mouvement=\"masquer\" tempo=\"${tempo}\" />`\n      this[outil].visibilite = false\n      this.liste_script.push(codeXML)\n    }\n  }\n\n  regleMasquer(options: OptionsRegle = {}) {\n    this.masquer('regle', options)\n  }\n\n  crayonMasquer(options: OptionsCrayon = {}) {\n    this.masquer('crayon', options)\n  }\n\n  equerreMasquer(options: OptionsEquerre = {}) {\n    this.masquer('equerre', options)\n  }\n\n  requerreMasquer(options: OptionsRequerre = {}) {\n    this.masquer('requerre', options)\n  }\n\n  compasMasquer(options: OptionsCompas = {}) {\n    this.masquer('compas', options)\n  }\n\n  rapporteurMasquer(options: OptionsRapporteur = {}) {\n    this.masquer('rapporteur', options)\n  }\n\n  deplacer(outil: StringOutil, A: PointAbstrait, options: OptionsOutil = {}) {\n    const tempo = options.tempo ?? this.tempo\n    const vitesse = options.vitesse ?? this.vitesse\n    if (this[outil].position !== A) {\n      // On n'ajoute une commande xml que s'il y a vraiment un dplacement\n      const codeXML = `<action objet=\"${outil}\" mouvement=\"translation\" abscisse=\"${this.x(A)}\" ordonnee=\"${this.y(A)}\" tempo=\"${tempo}\" vitesse=\"${vitesse}\" />`\n      this[outil].position = A\n      this.liste_script.push(codeXML)\n    }\n  }\n\n  regleDeplacer(A: PointAbstrait, options: OptionsRegle = {}) {\n    this.deplacer('regle', A, options)\n  }\n\n  texteDeplacer(id: string, A: PointAbstrait, options: OptionsIep = {}) {\n    const tempo = options.tempo ?? this.tempo\n    const vitesse = options.vitesse ?? this.vitesse\n    const codeXML = `<action objet=\"texte\" id=\"${id}\" mouvement=\"translation\" abscisse=\"${this.x(A)}\" ordonnee=\"${this.y(A)}\" tempo=\"${tempo}\" vitesse=\"${vitesse}\" />`\n    this.liste_script.push(codeXML)\n  }\n\n  crayonDeplacer(A: PointAbstrait, options: OptionsCrayon = {}) {\n    this.deplacer('crayon', A, options)\n  }\n\n  equerreDeplacer(A: PointAbstrait, options: OptionsEquerre = {}) {\n    this.deplacer('equerre', A, options)\n  }\n\n  requerreDeplacer(A: PointAbstrait, options: OptionsRequerre = {}) {\n    this.deplacer('requerre', A, options)\n  }\n\n  compasDeplacer(A: PointAbstrait, options: OptionsCompas = {}) {\n    this.deplacer('compas', A, options)\n  }\n\n  rapporteurDeplacer(A: PointAbstrait, options: OptionsRapporteur = {}) {\n    this.deplacer('rapporteur', A, options)\n  }\n\n  rotation(\n    outil: StringOutil,\n    angle: number | PointAbstrait,\n    options: OptionsCompas = {},\n  ) {\n    const tempo = options.tempo ?? this.tempo\n    const sens = options.sens ?? Math.round(this.vitesse / 2)\n    let angleDeRotation: number\n    if (typeof angle === 'number') {\n      angleDeRotation = angle\n    } else {\n      const d = droite(this[outil].position, angle)\n      angleDeRotation = d.angleAvecHorizontale\n    }\n    if (this[outil].angle !== angle) {\n      // Si la rotation est inutile, on ne la fait pas\n      // Les angles de MathALEA2D et de IEP sont opposs !!!!!\n      const codeXML = `<action objet=\"${outil}\" mouvement=\"rotation\" angle=\"${-1 * angleDeRotation}\" tempo=\"${tempo}\" sens=\"${sens}\" />`\n      this[outil].angle = angleDeRotation\n      if (typeof angleDeRotation === 'number' && isFinite(angleDeRotation)) {\n        this.liste_script.push(codeXML)\n      } else {\n        console.error(\"Angle de rotation non dfini pour l'objet .\", outil)\n      }\n    }\n  }\n\n  regleRotation(angle: number | PointAbstrait, options: OptionsRegle = {}) {\n    this.rotation('regle', angle, options)\n  }\n\n  crayonRotation(angle: number | PointAbstrait, options: OptionsCrayon = {}) {\n    this.rotation('crayon', angle, options)\n  }\n\n  equerreRotation(angle: number | PointAbstrait, options: OptionsEquerre = {}) {\n    this.rotation('equerre', angle, options)\n  }\n\n  requerreRotation(\n    angle: number | PointAbstrait,\n    options: OptionsRequerre = {},\n  ) {\n    this.rotation('requerre', angle, options)\n  }\n\n  compasRotation(angle: number | PointAbstrait, options: OptionsCompas = {}) {\n    this.rotation('compas', angle, options)\n  }\n\n  rapporteurRotation(\n    angle: number | PointAbstrait,\n    options: OptionsRapporteur = {},\n  ) {\n    this.rotation('rapporteur', angle, options)\n  }\n\n  /**\n   * @param {string} outil - 'regle', 'equerre', 'requerre, 'compas' ou 'rapporteur'\n   * @param {number} echelle 200 pour doubler la taille\n   * @param {objet} [options] tempo = 0 par dfaut\n   */\n  zoom(outil: StringOutil, echelle: number, options: OptionsIep = {}) {\n    const tempo = options.tempo ?? 0\n    this[outil].zoom = echelle\n    this.liste_script.push(\n      `<action echelle=\"${echelle}\" mouvement=\"zoom\" objet=\"${outil}\" tempo=\"${tempo}\" />`,\n    )\n  }\n\n  /**\n   *\n   * @param {number} pourcentage 200 pour doubler la taille\n   * @param {objet} [options] tempo = 0 par dfaut\n   */\n  regleZoom(echelle: number, options: OptionsIep = {}) {\n    this.zoom('regle', echelle, options)\n    this.regle.longueur = (this.regle.longueur * echelle) / 100\n  }\n\n  /**\n   *\n   * @param {number} pourcentage 200 pour doubler la taille\n   * @param {objet} [options] tempo = 0 par dfaut\n   */\n  equerreZoom(echelle: number, options: OptionsIep = {}) {\n    this.zoom('equerre', echelle, options)\n  }\n\n  /**\n   *\n   * @param {number} pourcentage 200 pour doubler la taille\n   * @param {objet} [options] tempo = 0 par dfaut\n   */\n  requerreZoom(echelle: number, options: OptionsIep = {}) {\n    this.zoom('requerre', echelle, options)\n  }\n\n  /**\n   *\n   * @param {number} pourcentage 200 pour doubler la taille\n   * @param {objet} [options] tempo = 0 par dfaut\n   */\n  rapporteurZoom(echelle: number, options: OptionsIep = {}) {\n    this.zoom('rapporteur', echelle, options)\n  }\n\n  /**\n   *\n   * @param {number} pourcentage 200 pour doubler la taille\n   * @param {objet} [options] tempo = 0 par dfaut\n   */\n  compasZoom(echelle: number, options: OptionsIep = {}) {\n    this.zoom('compas', echelle, options)\n  }\n\n  /**\n   **************************\n   ********* POINT **********\n   **************************\n   */\n\n  /**\n   * Crer un point avec la croix pour le situer et son nom en bas  droite par dfaut. L'id sera sauvegard dans l'objet point. S'il n'est pas dfini alors on prend le premier entier disponible.\n   * @param {PointAbstrait} A\n   * @param {objet} [options] Dfaut : { dx = 0.1, dy, label = A.nom, tempo = this.tempo, couleur = this.couleurPoint, couleurLabel = this.couleurTexte, id }\n   */\n  pointCreer(A: PointAbstrait, options: OptionsPoint = {}) {\n    const label = options.label ?? A.nom\n    const couleur = options.couleurPoint ?? options.couleur ?? this.couleurPoint\n    const tempo = options.tempo ?? this.tempo\n    const couleurLabel = options.couleurLabel ?? couleur\n    if (options.id) {\n      A.id = options.id\n    } else {\n      this.idIEP++\n      A.id = this.idIEP\n    }\n    let codeXML\n    if (label) {\n      codeXML = `<action abscisse=\"${this.x(A)}\" ordonnee=\"${this.y(A)}\" couleur=\"${couleur}\" id=\"${A.id}\" mouvement=\"creer\" objet=\"point\" tempo=\"${tempo}\"/>`\n      // codeXML += `\\n<action couleur=\"${couleurLabel}\" nom=\"${label}\" id=\"${this.idIEP}\" mouvement=\"nommer\" objet=\"point\" tempo=\"${tempo}\"  />`\n      const M = point(A.x, A.y)\n      if (options.dx) {\n        M.x += options.dx\n      }\n      if (options.dy) {\n        M.y += options.dy\n      }\n      this.textePoint(`$${label}$`, M, { tempo: 0, couleur: couleurLabel })\n    } else {\n      codeXML = `<action abscisse=\"${this.x(A)}\" ordonnee=\"${this.y(A)}\" couleur=\"${couleur}\" id=\"${A.id}\" mouvement=\"creer\" objet=\"point\" tempo=\"${tempo}\" />`\n    }\n    this.liste_script.push(codeXML)\n  }\n\n  /**\n   *\n   * Cration de plusieurs points\n   * On peut passer des points ou des options. Toutes les options sont intgres  tous les points.\n   */\n  pointsCreer(...args: (PointAbstrait | OptionsPoint)[]) {\n    const options: OptionsPoint = { tempo: 0 }\n    args\n      .filter((arg) => !(arg instanceof PointAbstrait))\n      .forEach((option) => {\n        // On intgre aux options les paramtres des arguments qui ne sont pas des points\n        Object.assign(options, option)\n      })\n    args\n      .filter((arg) => arg instanceof PointAbstrait)\n      .forEach((point) => {\n        this.pointCreer(point, options)\n      })\n  }\n\n  /**\n   * Masquer un point\n   * @param {PointAbstrait} A\n   * @param {objet} [options] Dfaut : { tempo: 0 }\n   */\n  pointMasquer(...args: (PointAbstrait | OptionsPoint)[]) {\n    const options: OptionsPoint = { tempo: 0 }\n    args\n      .filter((arg) => !(arg instanceof PointAbstrait))\n      .forEach((option) => {\n        // On intgre aux options les paramtres des arguments qui ne sont pas des points\n        Object.assign(options, option)\n      })\n    args\n      .filter((arg) => arg instanceof PointAbstrait)\n      .forEach((point) => {\n        this.liste_script.push(\n          `<action id=\"${point.id}\" mouvement=\"masquer\" objet=\"point\" tempo=\"${options.tempo}\" />`,\n        )\n      })\n  }\n\n  /**\n   * Montrer un point qui aurait t cach\n   * @param {PointAbstrait} A\n   * @param {objet} [options] Dfaut : { tempo: 0 }\n   */\n  pointMontrer(A: PointAbstrait, options: OptionsPoint = {}) {\n    const tempo = options.tempo ?? this.tempo\n    this.liste_script.push(\n      `<action id=\"${A.id}\" mouvement=\"montrer\" objet=\"point\" tempo=\"${tempo}\" />`,\n    )\n  }\n\n  /**\n   * Anime la translation d'un point\n   * @param {PointAbstrait} A\n   * @param {number} x Abscisse du point d'arrive\n   * @param {number} y Ordonne du point d'arrive\n   * @param {objet} [options] Dfaut : { tempo: this.tempo, vitesse: this.vitesse }\n   */\n  pointDeplacer(\n    A: PointAbstrait,\n    x: number,\n    y: number,\n    options: OptionsPoint = {},\n  ) {\n    const tempo = options.tempo ?? this.tempo\n    const vitesse = options.vitesse ?? this.vitesse\n    const B = point(x, y)\n    this.liste_script.push(\n      `<action abscisse=\"${this.x(B)}\" ordonnee=\"${this.y(B)}\" id=\"${A.id}\" mouvement=\"translation\" objet=\"point\" tempo=\"${tempo}\" vitesse=\"${vitesse}\" />`,\n    )\n  }\n\n  /**\n   * Ajoute un label au point { dx, dy, couleur = this.couleurPoint, tempo = this.tempo }\n   * @param {PointAbstrait} A\n   * @param {string} nom\n   * @param {objet} [options] dx pour le dplacement vertical du nom du point, dy pour le dplacemetn horizontal, couleur: this.couleurPoint, tempo: this.tempo\n   */\n  pointNommer(A: PointAbstrait, nom: string, options: OptionsPoint = {}) {\n    // const coordonneesTexte = ''\n    const M = point(A.x, A.y)\n    if (options.dx) {\n      M.x += options.dx\n    }\n    if (options.dy) {\n      M.y += options.dy\n    }\n    this.textePoint(`$${nom}$`, M, options)\n    // this.liste_script.push(`<action couleur=\"${couleur}\" nom=\"${nom}\" id=\"${A.id}\" mouvement=\"nommer\" objet=\"point\" tempo=\"${tempo}\" ${coordonneesTexte} />`)\n  }\n\n  /**\n   **************************\n   ********* COMPAS *********\n   **************************\n   */\n\n  /**\n   * Change l'orientation du compas. Par dfaut, elle est vers la droite. L'orientation courante du compas est sauvegarde dans this.compas.orientation\n   * @param {objet} [options] Dfaut : { tempo: this.tempo}\n   */\n  compasRetourner(options: OptionsCompas = {}) {\n    const tempo = options.tempo ?? this.tempo\n    const codeXML = `<action mouvement=\"retourner\" objet=\"compas\" tempo=\"${tempo}\" />`\n    if (this.compas.orientation === 'droite') {\n      this.compas.orientation = 'gauche'\n    } else {\n      this.compas.orientation = 'droite'\n    }\n    this.liste_script.push(codeXML)\n  }\n\n  /**\n   *\n   * @param {number} longueur cartement en cm\n   * @param {objet} [options] Dfaut : { tempo: this.tempo, vitesse: this.vitesse }\n   */\n  compasEcarter(l: number, options: OptionsCompas = {}) {\n    const tempo = options.tempo ?? this.tempo\n    const vitesse = options.vitesse ?? this.vitesse\n    const codeXML = `<action ecart=\"${l * 30}\" mouvement=\"ecarter\" objet=\"compas\" tempo=\"${tempo}\" vitesse=\"${vitesse}\" />`\n    this.compas.ecartement = l\n    this.liste_script.push(codeXML)\n  }\n\n  /**\n   * Fais apparaitre la rgle  l'horizontale, met le compas vertical et carte le compas le long de la rgle pour lire son cartement\n   * @param {number} longueur\n   * @param {*} options Dfaut : { tempo: this.tempo, vitesse: this.vitesse, sens : this.vitesse / 2 }\n   */\n  compasEcarterAvecRegle(l: number, options: OptionsCompas = {}) {\n    this.regleRotation(0, options)\n    this.regleMontrer(this.compas.position, options)\n    this.regleDeplacer(this.compas.position, options)\n    this.compasMontrer(this.compas.position, options)\n    this.compasRotation(0, options)\n    this.compasEcarter(l, options)\n  }\n\n  /**\n   *\n   * @param {PointAbstrait} A Pointe du compas\n   * @param {PointAbstrait} B Mine du compas\n   * @param {objet} [options] Dfaut : { tempo: this.tempo, vitesse: this.vitesse, sens : this.vitesse / 2 }\n   */\n  compasEcarter2Points(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    options: OptionsCompas = {},\n  ) {\n    this.compasMontrer(A, options)\n    this.compasDeplacer(A, options)\n    const s = segment(A, B)\n    s.isVisible = false\n    const angle = s.angleAvecHorizontale\n    this.compasRotation(angle, options)\n    this.compasEcarter(longueur(A, B), options)\n  }\n\n  /**\n   * Remettre le compas en position standard. Son tat est sauvegard dans le boolen this.compas.leve.\n   * @param {objet} [options] Dfaut : { tempo: this.tempo }\n   */\n  compasLever(options: OptionsCompas = {}) {\n    const tempo = options.tempo ?? this.tempo\n    if (!this.compas.leve) {\n      // On ne fait rien si le compas est dj lev\n      const codeXML = `<action mouvement=\"lever\" objet=\"compas\" tempo=\"${tempo} />`\n      this.compas.leve = true\n      this.liste_script.push(codeXML)\n    }\n  }\n\n  /**\n   * Voir le compas en vue de dessus avant qu'il trace un arc de cercle\n   * @param {objet} [options] Dfaut : { tempo: this.tempo }\n   */\n  compasCoucher(options: OptionsCompas = {}) {\n    const tempo = options.tempo ?? this.tempo\n    if (this.compas.leve) {\n      // On ne fait rien si le compas est dj lev\n      const codeXML = `<action mouvement=\"coucher\" objet=\"compas\" tempo=\"${tempo}\" />`\n      this.compas.leve = false\n      this.liste_script.push(codeXML)\n    }\n  }\n\n  /**\n   * Trace un arc de cercle en gardant l'cartement et le centre actuel. L'angle de dpart sera choisi pour tre le plus proche de l'angle actuel\n   * @param {number} angle1\n   * @param {number} angle2\n   * @param {objet} [options] Dfaut : { tempo: this.tempo, sens: this.vitesse / 2, epaisseur: this.epaisseur, couleur: this.couleurCompas, pointilles: this.pointilles }\n   * @return {id}\n   */\n  compasTracerArc2Angles(\n    angle1: number,\n    angle2: number,\n    options: OptionsCompas = {},\n  ) {\n    const tempo = options.tempo ?? this.tempo\n    const sens = options.sens ?? this.vitesse / 2\n    const epaisseur = options.epaisseur ?? 0.5\n    const couleurCompas = options.couleurCompas ?? this.couleurCompas\n    const pointillesTexte = options.pointilles ? 'pointille=\"tiret\"' : ''\n    this.idIEP += 1\n    if (\n      Math.abs(this.compas.angle - angle1) >\n      Math.abs(this.compas.angle - angle2)\n    ) {\n      // On cherche  commencer par le point le plus proche de la position courante du compas\n      ;[angle1, angle2] = [angle2, angle1]\n    }\n    let codeXML = `<action sens=\"${sens}\" angle=\"${-angle1}\" mouvement=\"rotation\" objet=\"compas\" tempo=\"${tempo}\" />\\n`\n    codeXML += '<action mouvement=\"lever\" objet=\"compas\" />\\n'\n    codeXML += `<action sens=\"${sens}\" angle=\"${-angle1}\" mouvement=\"rotation\" objet=\"compas\" />\\n`\n    let sensTexte\n    if (angle2 > angle1) {\n      sensTexte = sens\n    } else {\n      sensTexte = -1 * sens\n    }\n    codeXML += `<action couleur=\"${couleurCompas}\" epaisseur=\"${epaisseur}\" sens=\"${sensTexte}\" debut=\"${-angle1}\" fin=\"${-angle2}\" mouvement=\"tracer\" objet=\"compas\"  ${pointillesTexte} id=\"${this.idIEP}\" />\\n`\n    codeXML += `<action mouvement=\"coucher\" objet=\"compas\" tempo=\"${tempo}\"/>`\n    this.compas.angle = angle2\n    this.liste_script.push(codeXML)\n    return this.idIEP\n  }\n\n  /**\n   * Trace un arc de cercle autour d'un point. La longueur de l'arc est dtermine par l'option delta en degr qui est ajoute de part et d'autre du point\n   * @param {PointAbstrait} centre\n   * @param {PointAbstrait} point\n   * @param {objet} [options] Dfaut : { delta: 10, tempo: this.tempo, sens: this.vitesse / 2, epaisseur: this.epaisseur, couleur: this.couleurCompas, pointilles: this.pointilles }\n   * @return {id}\n   */\n  compasTracerArcCentrePoint(\n    centre: PointAbstrait,\n    point: PointAbstrait,\n    options: OptionsCompas = {},\n  ) {\n    const delta = options.delta ?? 10\n    this.compasMontrer(this.compas.position, options)\n    this.compasDeplacer(centre, options)\n    const s = segment(centre, point)\n    s.visibility = false\n    const angle1 = s.angleAvecHorizontale - delta\n    const angle2 = s.angleAvecHorizontale + delta\n    if (\n      Math.abs(this.compas.ecartement - longueur(this.compas.position, point)) >\n      0.1\n    ) {\n      this.compasEcarter(longueur(centre, point), options)\n    }\n    return this.compasTracerArc2Angles(angle1, angle2, options)\n  }\n\n  /**\n   *\n   * @param {PointAbstrait} centre\n   * @param {PointAbstrait} point Point de dpart du trac du cercle\n   * @param {objet} [options] Dfaut : { tempo: this.tempo, sens: this.vitesse / 2, epaisseur: this.epaisseur, couleur: this.couleurCompas, pointilles: this.pointilles }\n   */\n  compasCercleCentrePoint(\n    centre: PointAbstrait,\n    point: PointAbstrait,\n    options: OptionsCompas = {},\n  ) {\n    this.compasEcarter2Points(centre, point, options)\n    const d = droite(centre, point)\n    const angle1 = d.angleAvecHorizontale\n    this.compasTracerArc2Angles(angle1, angle1 + 360, options)\n  }\n\n  /**\n   **************************\n   ******** REQUERRE ********\n   **************************\n   */\n\n  /**\n   *\n   * @param {number} dplacement en nombre de cm (le dplacement peut tre positif ou ngatif)\n   * @param {*} options Dfaut : { tempo: this.tempo, vitesse: this.vitesse }\n   */\n  requerreGlisserEquerre(deplacement: number, options: OptionsRequerre = {}) {\n    const tempo = options.tempo ?? this.tempo\n    const vitesse = options.vitesse ?? this.vitesse\n    this.liste_script.push(\n      `<action abscisse=\"${deplacement * 30}\" mouvement=\"glisser\" objet=\"requerre\" tempo=\"${tempo}\" vitesse=\"${vitesse}\" />`,\n    )\n  }\n\n  /**\n   **************************\n   ******* RAPPORTEUR *******\n   **************************\n   */\n\n  // Non pris en charge par le lecteur JS\n  // this.rapporteurCirculaire = function (tempo=this.tempo) {\n  // //     this.liste_script.push(`<action mouvement=\"circulaire\" objet=\"rapporteur\" tempo=\"${tempo}\"/>`)\n  // }\n  // this.rapporteurSemiCirculaire = function (tempo=this.tempo) {\n  // //     this.liste_script.push(`<action mouvement=\"semicirculaire\" objet=\"rapporteur\" tempo=\"${tempo}\"/>`)\n  // }\n\n  /**\n   * Montre ou masque les graduations du rapporteur\n   * @param {PointAbstrait} A\n   * @param {string} nom\n   * @param {objet} [options] Dfaut : { tempo: this.tempo }\n   */\n  // rapporteurGraduations ()\n\n  /**\n   * Masque la graduation externe du rapporteur (laisse l'autre graduation visible)\n   * @param {objet} [options] Dfaut : { tempo: this.tempo }\n   */\n\n  rapporteurMasquerGraduationsExterieures(options: OptionsRapporteur = {}) {\n    const tempo = options.tempo ?? this.tempo\n    this.liste_script.push(\n      `<action mouvement=\"masquer_nombres\" objet=\"rapporteur\" tempo=\"${tempo}\"/>`,\n    )\n  }\n\n  /**\n   * Montre la graduation extrieure si elle avait t prcdemment cache\n   * @param {objet} [options] Dfaut : { tempo: this.tempo }\n   */\n  rapporteurMontrerGraduationsExterieures(options: OptionsRapporteur = {}) {\n    const tempo = options.tempo ?? this.tempo\n    this.liste_script.push(\n      `<action mouvement=\"montrer_nombres\" objet=\"rapporteur\" tempo=\"${tempo}\"/>`,\n    )\n  }\n\n  /**\n   * Masque la graduation interne du rapporteur (laisse l'autre graduation visible)\n   * @param {objet} [options] Dfaut : { tempo: this.tempo }\n   */\n  rapporteurMasquerGraduationsInterieures(options: OptionsRapporteur = {}) {\n    const tempo = options.tempo ?? this.tempo\n    this.liste_script.push(\n      `<action mouvement=\"vide\" objet=\"rapporteur\" tempo=\"${tempo}\"/>`,\n    )\n  }\n\n  /**\n   * Montre la graduation interne si elle avait t prcdemment cache\n   * @param {objet} [options] Dfaut : { tempo: this.tempo }\n   */\n  rapporteurMontrerGraduationsInterieures(options: OptionsRapporteur = {}) {\n    const tempo = options.tempo ?? this.tempo\n    this.liste_script.push(\n      `<action mouvement=\"graduations\" objet=\"rapporteur\" tempo=\"${tempo}\"/>`,\n    )\n  }\n\n  /**\n   * Met le rapporteur en position avec le centre en A et le 0 de droite alogn avec le point B\n   * @param {PointAbstrait} A\n   * @param {PointAbstrait} B\n   * @param {objet} [options] Dfaut : { tempo: this.tempo, vitesse: this.vitesse, sens : this.vitesse / 2 }\n   */\n  rapporteurDeplacerRotation2Points(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    options: OptionsRapporteur = {},\n  ) {\n    const d = droite(A, B)\n    d.isVisible = false\n    this.rapporteurMontrer(this.rapporteur.position, options)\n    this.rapporteurDeplacer(A, options)\n    this.rapporteurRotation(d.angleAvecHorizontale, options)\n  }\n\n  /**\n   * Fais une petite marque (couleur et paisseur d'un trait de construction) sur une graduation du rapporteur\n   * @param {number} angle\n   * @param {objet} [options] Dfaut : { tempo: this.tempo, vitesse: this.vitesse, couleur: this.couleurTraitsDeConstruction, epaisseur: this.epaisseurTraitsDeConstruction }\n   */\n  rapporteurCrayonMarqueAngle(angle: number, options: OptionsCrayon = {}) {\n    const O = this.rapporteur.position\n    const distanceBord = (this.rapporteur.rayon * this.rapporteur.zoom) / 100\n    const M = pointAdistance(O, distanceBord, angle + this.rapporteur.angle)\n    const N = pointAdistance(\n      O,\n      distanceBord + 0.3,\n      angle + this.rapporteur.angle,\n    )\n    this.crayonMontrer(this.crayon.position, options)\n    this.crayonDeplacer(M, options)\n    this.tracer(N, options)\n  }\n\n  /**\n   * Le crayon va faire une marque sur la graduation du rapporteur, le rapporteur va se cacher et on trace une demi-droite dont on peut choisir la \"longueur\" (par dfaut 90% de celle de la rgle)\n   * @param {PointAbstrait} A Centre du rapporteur\n   * @param {PointAbstrait} B Point avec lequel le 0 de droite sera align\n   * @param {number} angle\n   * @param {objet} [options] { longueur: 0.9 * this.regle.longueur, couleur: this.couleur, tempo: this.tempo, vitesse: this.vitesse, sens : this.vitesse / 2, epaisseur: this.epaisseur, pointilles: this.pointilles }\n   */\n  rapporteurTracerDemiDroiteAngle(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    angle: number,\n    options: OptionsCrayon = {},\n  ) {\n    if (angle > 0) {\n      this.rapporteurDeplacerRotation2Points(A, B, options)\n      this.rapporteurCrayonMarqueAngle(angle, options)\n    } else {\n      const B2 = rotation(B, A, 180)\n      this.rapporteurDeplacerRotation2Points(A, B2, options)\n      this.rapporteurCrayonMarqueAngle(180 - Math.abs(angle), options)\n    }\n    const d = droite(A, B)\n    d.isVisible = false\n    const M = pointAdistance(\n      A,\n      (this.rapporteur.rayon * this.rapporteur.zoom) / 100,\n      d.angleAvecHorizontale + angle,\n    )\n    this.rapporteurMasquer(options)\n    this.regleDemiDroiteOriginePoint(A, M, options)\n  }\n\n  /**\n   **************************\n   ********* REGLE **********\n   **************************\n   */\n\n  /**\n   * Masquer les graduations sur la rgle\n   * @param {objet} [options] Dfaut : { tempo: this.tempo }\n   */\n  regleMasquerGraduations(options: OptionsIep = {}) {\n    const tempo = options.tempo ?? this.tempo\n    this.liste_script.push(\n      `<action mouvement=\"vide\" objet=\"regle\" tempo=\"${tempo}\"/>`,\n    )\n  }\n\n  /**\n   * Montrer les graduations sur la rgle si elles avaient t masques\n   * @param {objet} [options] Dfaut : { tempo: this.tempo }\n   */\n  regleMontrerGraduations(options: OptionsIep = {}) {\n    const tempo = options.tempo ?? this.tempo\n    this.liste_script.push(\n      `<action mouvement=\"graduations\" objet=\"regle\" tempo=\"${tempo}\"/>`,\n    )\n  }\n\n  /**\n   * Modifie la taille de la rgle\n   * @param {number} longueur\n   * @param {objet} [options] Dfaut : { tempo: this.tempo }\n   */\n  regleModifierLongueur(longueur = 20, options: OptionsIep = {}) {\n    const tempo = options.tempo ?? this.tempo\n    this.regle.longueur = longueur\n    this.liste_script.push(\n      `<action mouvement=\"modifier_longueur\" objet=\"regle\" longueur=\"${this.regle.longueur}\" tempo=\"${tempo}\"/>`,\n    )\n  }\n\n  /**\n   * Trace une demi-droite d'origine O passant par A (ou en direction de A si les points sont trop loigns)\n   * @param {PointAbstrait} O Origine\n   * @param {PointAbstrait} A Direction\n   * @param {objet} [options] Dfaut {longueur: this.regle.longueur, tempo : this.tempo, vitesse: this.vitesse, sens: this.vitesse / 2}\n   */\n  regleDemiDroiteOriginePoint(\n    O: PointAbstrait,\n    A: PointAbstrait,\n    options: OptionsRegle = {},\n  ) {\n    const longueur = options.longueur ?? this.regle.longueur\n    const M = pointSurSegment(O, A, longueur)\n    this.regleSegment(O, M, options)\n  }\n\n  /**\n   * Trace une droite passanrt par les points A et B\n   * @param {PointAbstrait} A\n   * @param {PointAbstrait} B\n   * @param {objet} [options] Dfaut {longueur: this.regle.longueur, tempo : this.tempo, vitesse: this.vitesse, sens: this.vitesse / 2}\n   */\n  regleDroite(A: PointAbstrait, B: PointAbstrait, options: OptionsRegle = {}) {\n    const longueurRegle = options.longueur ?? this.regle.longueur\n    const M = homothetie(\n      B,\n      A,\n      (-longueurRegle * 0.5 + longueur(A, B) * 0.5) / longueur(A, B),\n    )\n    const N = homothetie(\n      A,\n      B,\n      (-longueurRegle * 0.5 + longueur(A, B) * 0.5) / longueur(A, B),\n    )\n    if (this.x(A) <= this.x(B)) {\n      this.regleMontrer(M)\n      this.regleRotation(N, options)\n      this.regleSegment(M, N, options)\n    } else {\n      this.regleMontrer(N)\n      this.regleRotation(M, options)\n      this.regleSegment(N, M, options)\n    }\n  }\n\n  /**\n   * Avec la rgle, on prolonge le segment de l cm du cot de la 2e extrmit si l est positif sinon du ct de la premire extrmit\n   * @param {PointAbstrait} A\n   * @param {PointAbstrait} B\n   * @param {objet} [options] Dfaut {longueur: this.regle.longueur - 3, tempo: this.tempo, vitesse: this.vitesse, sens: this.vitesse / 2}\n   */\n  regleProlongerSegment(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    options: OptionsRegle = {},\n  ) {\n    const longueur = options.longueur ?? this.regle.longueur - 3\n    if (longueur > 0) {\n      const B1 = pointSurSegment(B, A, 3)\n      const B2 = pointSurSegment(B, A, -longueur)\n      this.regleSegment(B1, B2, options)\n    } else {\n      const A1 = pointSurSegment(A, B, 3)\n      const A2 = pointSurSegment(A, B, longueur)\n      this.regleSegment(A1, A2, options)\n    }\n  }\n\n  /**\n   **************************\n   ********* TRAITS *********\n   **************************\n   */\n\n  /**\n   * Le crayon trace un trait de sa position courante jusqu'au point B\n   * @param {PointAbstrait} B\n   * @param {objet} [options] Dfaut { tempo: this.tempo, vitesse: this.vitesse, epaisseur: this.epaisseur, couleur: this.couleur, pointilles: this.pointilles, vecteur: false }\n   * @return {id} id utilise pour le trac\n   */\n  tracer(B: PointAbstrait, options: OptionsCrayon = {}) {\n    const tempo = options.tempo ?? this.tempo\n    const vitesse = options.vitesse ?? this.vitesse\n    const epaisseur = options.epaisseur ?? this.epaisseur\n    const couleur = options.couleur ?? this.couleur\n    const pointilles = options.pointilles ?? this.pointilles\n    const pointillesTexte = pointilles ? 'pointille=\"tiret\"' : ''\n    const vecteurTexte = options.vecteur ? 'style=\"vecteur\"' : ''\n    this.idIEP += 1\n    const codeXML = `<action abscisse=\"${this.x(B)}\" ordonnee=\"${this.y(B)}\" epaisseur=\"${epaisseur}\" couleur=\"${couleur}\" mouvement=\"tracer\" objet=\"crayon\" tempo=\"${tempo}\" vitesse=\"${vitesse}\"  ${pointillesTexte} ${vecteurTexte} id=\"${this.idIEP}\" />`\n    this.crayon.position = B\n    this.liste_script.push(codeXML)\n    return this.idIEP\n  }\n\n  /**\n   * Trace au crayon le segment [AB]\n   * @param {PointAbstrait} A Premire extrmit\n   * @param {PointAbstrait} B Deuxime extrmit\n   * @param {*} options\n   * @return {id} id utilise pour le trac\n   */\n  trait(A: PointAbstrait, B: PointAbstrait, options: OptionsCrayon = {}) {\n    this.crayonDeplacer(A, options)\n    return this.tracer(B, options)\n  }\n\n  /**\n   * Trace au crayon le segment [AB] sans tempo et avec une vitesse multiplie par 1 000\n   * @param {PointAbstrait} A Premire extrmit\n   * @param {PointAbstrait} B Deuxime extrmit\n   * @param {*} options\n   * @return {id} id utilise pour le trac\n   */\n  traitRapide(A: PointAbstrait, B: PointAbstrait, options: OptionsCrayon = {}) {\n    const tempo = 0\n    const vitesse = 10000\n    this.crayonDeplacer(A, Object.assign({ tempo, vitesse }, options))\n    return this.tracer(B, Object.assign({ tempo, vitesse }, options))\n  }\n\n  /**\n   * Masque le trait d'id fourni\n   * @param {number} id\n   * @param {objet} [options] Dfaut : { vitesse: 200 }\n   */\n  traitMasquer(id: number, options: OptionsCrayon = {}) {\n    const vitesse = options.vitesse ?? 200\n    this.liste_script.push(\n      `<action mouvement=\"masquer\" objet=\"trait\" id=\"${id}\" vitesse=\"${vitesse}\" />`,\n    )\n  }\n\n  /**\n   *\n   * @param {segment/point} arg1 Segment  tracer ou premire extrmit\n   * @param {objet/point} arg2 options ou deuxime extrmit\n   * @param {objet} [arg3] si les deux premiers arguments taient des points\n   * @returns {id} identifiant utilis pour le trait\n   */\n  regleSegment(\n    arg1: Segment | PointAbstrait,\n    arg2?: OptionsRegle | PointAbstrait,\n    arg3?: OptionsRegle,\n  ) {\n    let A: PointAbstrait, B: PointAbstrait\n    let id: number = -1\n    let options: OptionsRegle = {}\n    if (arg1 instanceof Segment) {\n      A = arg1.extremite1\n      B = arg1.extremite2\n      if (arg2 instanceof PointAbstrait) {\n        window.notify(\n          \"regleSegment appel avec un mauvais jeu d'arguments (arg1 est un segment mais arg2 est un point)\",\n          { arg1, arg2, arg3 },\n        )\n      } else {\n        if (typeof arg2 === 'object') {\n          options = arg2\n        }\n      }\n    } else {\n      if (arg1 instanceof PointAbstrait && arg2 instanceof PointAbstrait) {\n        A = arg1\n        B = arg2\n      } else {\n        window.notify(\n          \"regleSegment appel avec un mauvais jeu d'arguments (arg1 et arg2 ne sont pas des points)\",\n          { arg1, arg2, arg3 },\n        )\n        A = pointAbstrait(0, 0)\n        B = pointAbstrait(0, 0)\n      }\n      if (typeof arg3 === 'object') {\n        options = arg3\n      }\n    }\n    if (A.x <= B.x) {\n      // Toujours avoir la rgle de gauche  droite\n      this.regleMontrer(A, options)\n      this.regleRotation(B, options)\n    } else {\n      this.regleMontrer(B, options)\n      this.regleRotation(A, options)\n    }\n    if (this.crayon != null) {\n      if (\n        longueur(this.crayon.position, A) < longueur(this.crayon.position, B)\n      ) {\n        // Le crayon ira au point le plus proche\n        this.crayonMontrer(A, options)\n        id = this.tracer(B, options)\n      } else {\n        this.crayonMontrer(B, options)\n        id = this.tracer(A, options)\n      }\n    }\n    return id\n  }\n\n  /**\n   * Trace un polygone avec les options par dfaut que l'on ne peut pas changer ici\n   * @param  {...points} sommets du polygonne spars par des virgules\n   */\n  polygoneTracer(...sommets: PointAbstrait[]) {\n    for (let i = 0; i < sommets.length - 1; i++) {\n      this.regleSegment(sommets[i], sommets[i + 1])\n    }\n    this.regleSegment(sommets[sommets.length - 1], sommets[0])\n  }\n\n  /**\n   * Trace un polygone avec traitRapide()\n   * @param  {...points} sommets du polygonne spars par des virgules\n   */\n  polygoneRapide(...args: (PointAbstrait | OptionsCrayon)[]) {\n    const sommets: PointAbstrait[] = []\n    const option: OptionsCrayon = {}\n    args.forEach((arg) => {\n      if (arg instanceof PointAbstrait) {\n        sommets.push(arg)\n      } else if (typeof arg === 'object') {\n        Object.assign(option, arg)\n      } else {\n        window.notify(\"polygoneRapide appel avec un mauvais jeu d'arguments\", {\n          arg,\n        })\n      }\n    })\n    if (sommets.length > 2) {\n      for (let i = 0; i < sommets.length - 1; i++) {\n        this.traitRapide(sommets[i], sommets[i + 1], option)\n      }\n      this.traitRapide(sommets[sommets.length - 1], sommets[0], option)\n    } else\n      throw Error(\n        `Pour utiliser polygoneRapide, il faut passer une liste de points ! et pas a : ${JSON.stringify(sommets)} `,\n      )\n  }\n\n  /**\n   **************************\n   ********* TEXTE **********\n   **************************\n   */\n\n  /**\n   * Ecris un texte coll au point. On peut choisir un fond, un cadre, l'opacit du fond, la police...\n   * @param {string} texte\n   * @param {PointAbstrait} A\n   * @param {objet} [options] Dfaut : { tempo: this.tempo, police: false, couleur: this.couleurTexte, couleurFond, opaciteFond, couleurCadre, epaisseurCadre, marge, margeGauche, margeDroite, margeHaut, margeBas }\n   * @return {id}\n   */\n  textePoint(texte: string, A: PointAbstrait, options: OptionsTexte = {}) {\n    const tempo = options.tempo ?? this.tempo\n    this.idIEP++\n    const policeTexte = options.police ? `police=\"${options.police}\"` : ''\n    let stringOptions = ''\n    if (options.couleurFond) {\n      stringOptions += ` couleur_fond=\"${options.couleurFond}\"`\n    }\n    if (options.opaciteFond) {\n      stringOptions += ` opacite_fond=\"${options.opaciteFond}\"`\n    }\n    if (options.couleurCadre) {\n      stringOptions += ` couleur_cadre=\"${options.couleurCadre}\"`\n    }\n    if (options.epaisseurCadre) {\n      stringOptions += ` epaisseur_cadre=\"${options.epaisseurCadre}\"`\n    }\n    if (options.marge) {\n      stringOptions += ` marge=\"${options.marge}\"`\n    }\n    if (options.margeGauche) {\n      stringOptions += ` marge_gauche=\"${options.margeGauche}\"`\n    }\n    if (options.margeDroite) {\n      stringOptions += ` marge_droite=\"${options.margeDroite}\"`\n    }\n    if (options.margeBas) {\n      stringOptions += ` marge_bas=\"${options.margeBas}\"`\n    }\n    if (options.margeHaut) {\n      stringOptions += ` marge_haut=\"${options.margeHaut}\"`\n    }\n    if (options.taille) {\n      stringOptions += ` taille=\"${options.taille}\"`\n    }\n    let codeXML = `<action abscisse=\"${this.x(A)}\" ordonnee=\"${this.y(A)}\" id=\"${this.idIEP}\" mouvement=\"creer\" objet=\"texte\" />`\n    codeXML += `\\n<action ${policeTexte} couleur=\"${options.couleur || this.couleurTexte}\" texte=\"${texte}\" id=\"${this.idIEP}\" mouvement=\"ecrire\" objet=\"texte\" ${stringOptions} tempo=\"${tempo}\" />`\n    this.liste_script.push(codeXML)\n    return this.idIEP\n  }\n\n  /**\n   * Ecris un texte coll au point de coordonnes (x,y). On peut choisir un fond, un cadre, l'opacit du fond, la police...\n   * @param {string} texte\n   * @param {number} x Abscisse du coin en haut  gauche\n   * @param {number} y Ordonne du coin en haut  gauche\n   * @param {objet} [options] Dfaut : { tempo: this.tempo, police: false, couleur: this.couleurTexte, couleurFond, opaciteFond, couleurCadre, epaisseurCadre, marge, margeGauche, margeDroite, margeHaut, margeBas }\n   */\n  textePosition(\n    texte: string,\n    x: number,\n    y: number,\n    options: OptionsTexte = {},\n  ) {\n    const A = point(x, y)\n    return this.textePoint(texte, A, options)\n  }\n\n  longueurSegment(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    dy: number,\n    options: OptionsTexte = {},\n  ) {\n    const l = longueur(A, B)\n    const v = vecteur(A, B)\n    const w = vecteur((-v.y * dy) / norme(v), (v.x * dy) / norme(v))\n    const ancrage = translation(\n      translation(pointSurSegment(A, B, l / 2 - 0.7), w),\n      vecteur(0, 1),\n    )\n    return this.textePoint(`${l} cm`, ancrage, options)\n  }\n\n  mesureAngle(A: PointAbstrait, O: PointAbstrait, B: PointAbstrait) {\n    const a = angleOriente(A, O, B)\n    const C = translation(\n      homothetie(rotation(A, O, a / 2), O, 1.3 / longueur(O, A)),\n      vecteur(-0.2, 0.5),\n    )\n    return this.textePoint(Math.abs(a) + '', C)\n  }\n\n  /**\n   * Masque le trait d'id fourni\n   * @param {array} id\n   * @param {objet} [options] Dfaut : { tempo: 0 }\n   */\n  texteMasquer(...args: (number | OptionsIep)[]) {\n    const options: OptionsIep = { tempo: 0 }\n    args\n      .filter((arg) => !(typeof arg === 'number'))\n      .forEach((option) => {\n        // On intgre aux options les paramtres des arguments qui ne sont pas des id\n        Object.assign(options, option)\n      })\n    args\n      .filter((arg) => typeof arg === 'number')\n      .forEach((id) => {\n        this.liste_script.push(\n          `<action mouvement=\"masquer\" objet=\"texte\" id=\"${id}\" tempo=\"${options.tempo}\" />`,\n        )\n      })\n  }\n\n  /**\n   * Change la couleur d'un texte dj cr dont on donne l'id retourn par this.textePoint ou this.textePosition\n   * Ncessit de redonner le texte car on rcrit le texte dans une autre couleur.\n   * @param {string} texte\n   * @param {number} id\n   * @param {string} couleur\n   */\n  texteChangeCouleur(texte: string, id: number, couleur: string) {\n    this.liste_script.push(\n      `\\n<action couleur=\"${couleur}\" texte=\"${texte}\" id=\"${id}\" mouvement=\"ecrire\" objet=\"texte\" />`,\n    )\n  }\n\n  /**\n   * Met l'animation en pause forant l'utilisateur  appuyer sur lecture pour voir la suite\n   */\n  pause() {\n    this.liste_script.push('<action mouvement=\"pause\" />')\n  }\n\n  /**\n   **************************\n   ******* CODAGES **********\n   **************************\n   */\n\n  /**\n   *\n   * @param {segment/point} Segment  coder ou premire extrmit\n   * @param {objet/point} options ou deuxime extrmit\n   * @param {objet} [options] si les deux premiers arguments taient des points. Dfaut : { tempo: this.tempo, couleur: this.couleurCodage, codage: '//', }\n   * @return {id}\n   */\n  segmentCodage(\n    arg1: Segment | PointAbstrait,\n    arg2?: OptionsRegle | PointAbstrait,\n    arg3?: OptionsRegle,\n  ) {\n    let s: Segment\n    let options: OptionsRegle = {}\n    if (arg1 instanceof Segment) {\n      s = arg1\n      if (arg2 instanceof PointAbstrait) {\n        window.notify(\n          \"segmentCodage appel avec un mauvais jeu d'arguments (arg1 est un segment mais arg2 est un point\",\n          { arg1, arg2, arg3 },\n        )\n      } else {\n        if (typeof arg2 === 'object') {\n          options = arg2\n        }\n      }\n    } else {\n      if (arg1 instanceof PointAbstrait && arg2 instanceof PointAbstrait) {\n        s = segment(arg1, arg2)\n      } else {\n        window.notify(\n          \"segmentCodage appel avec un mauvais jeu d'arguments (arg1 et arg2 ne sont pas des points)\",\n          { arg1, arg2, arg3 },\n        )\n        s = segment(pointAbstrait(0, 0), pointAbstrait(0, 0))\n      }\n      if (typeof arg3 === 'object') {\n        options = arg3\n      }\n    }\n    const tempo = options.tempo ?? this.tempo\n    const couleur =\n      options.couleurCodage ?? options.couleur ?? this.couleurCodage\n    const codage = options.codage ?? '\\\\'\n    this.idIEP++\n    const id = this.idIEP\n    const M = milieu(s.extremite1, s.extremite2)\n    const codeXML = `<action abscisse=\"${this.x(M)}\" ordonnee=\"${this.y(M)}\" forme=\"${codage}\"  couleur=\"${couleur}\" id=\"${id}\" tempo=\"${tempo}\" mouvement=\"creer\" objet=\"longueur\" />`\n    this.liste_script.push(codeXML)\n    return id\n  }\n\n  /**\n   *\n   * @param {number} id Identifiant du codage\n   * @param {objet} [options] Dfaut : { tempo: this.tempo }\n   */\n  segmentCodageMasquer(id: number, options: OptionsIep = {}) {\n    const tempo = options.tempo ?? this.tempo\n    this.liste_script.push(\n      `<action id=\"${id}\" mouvement=\"masquer\" objet=\"longueur\" tempo=\"${tempo}\" />`,\n    )\n  }\n\n  /**\n   *\n   * @param {number} id Identifiant du codage\n   * @param {objet} [options] Dfaut : { tempo: this.tempo }\n   */\n  segmentCodageMontrer(id: number, options: OptionsIep = {}) {\n    const tempo = options.tempo ?? this.tempo\n    this.liste_script.push(\n      `<action id=\"${id}\" mouvement=\"montrer\" objet=\"longueur\" tempo=\"${tempo}\" />`,\n    )\n  }\n\n  /**\n   * Trace le petit carr au crayon\n   * @param {PointAbstrait} A Point sur un ct de l'angle\n   * @param {PointAbstrait} B Sommet de l'angle\n   * @param {PointAbstrait} C Point sur un ct de l'angle\n   * @param {objet} [options] Dfaut : {longueur : 0.3, couleur: this.couleurCodage}\n   * @return {array} [idTrait1, idTrait2]\n   */\n  codageAngleDroit(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    C: PointAbstrait,\n    options: OptionsRegle = {},\n  ) {\n    const longueur = options.longueur ?? 0.3\n    const couleur =\n      options.couleurCodage ?? options.couleur ?? this.couleurCodage\n    this.crayonMontrer()\n    const C1 = pointSurSegment(B, C, longueur)\n    const A1 = pointSurSegment(B, A, longueur)\n    const M = translation2Points(A1, B, C1)\n    const options1 = { ...options } // On recopie options pour pouvoir en changer le tempo du premier trac\n    options1.tempo = 0\n    const trait1 = this.trait(C1, M, Object.assign({}, options1, { couleur }))\n    const trait2 = this.trait(M, A1, Object.assign({}, options, { couleur }))\n    return [trait1, trait2]\n  }\n\n  /**\n   * Masque le codage d'un angle droit\n   * @param {number} id Identifiant du codage d'un angle droit\n   * @param {objet} [options] Dfaut { tempo: 0 }\n   */\n  codageAngleDroitMasquer(id: [number, number], options: OptionsIep = {}) {\n    const tempo = options.tempo ?? 0\n    this.traitMasquer(id[0], Object.assign({ tempo }, options))\n    this.traitMasquer(id[1], Object.assign({ tempo }, options))\n  }\n\n  /**\n   * Code un angle. L'option codage peut tre \"simple\", \"/\", \"//\", \"///\", \"O\"\n   * \"double\", \"double/\", \"double//\", \"double///\", \"doubleO\"\n   * \"triple\", \"triple/\", \"triple//\", \"triple///\", \"tripleO\"\n   * \"plein\", \"plein/\", \"plein//\", \"plein///\", \"pleinO\"\n   * @param {PointAbstrait} A Point sur un ct de l'angle\n   * @param {PointAbstrait} B Sommet de l'angle\n   * @param {PointAbstrait} C Point sur un ct de l'angle\n   * @param {objet} [options] Dfaut : { rayon : 1, couleur: this.couleurCodage, codage: 'plein'}\n   * @return {id} L'identifiant correspond  l'identifiant des 3 points de l'angle spars par _\n   */\n  angleCodage(\n    B: PointAbstrait,\n    A: PointAbstrait,\n    C: PointAbstrait,\n    options: OptionsCompas = {},\n  ) {\n    const couleur =\n      options.couleurCodage ?? options.couleur ?? this.couleurCodage\n    const codage = options.codage ?? 'plein'\n    const rayon = options.rayon ?? 1\n    const tempo = options.tempo ?? this.tempo\n    const id = B.id + '_' + A.id + '_' + C.id\n    const d1 = droite(A, B)\n    const d2 = droite(A, C)\n    d1.isVisible = false\n    d2.isVisible = false\n    const angle1 = -d1.angleAvecHorizontale\n    const angle2 = -d2.angleAvecHorizontale\n    const codeXML = `<action abscisse=\"${this.x(A)}\" ordonnee=\"${this.y(A)}\" rayon=\"${rayon * 30}\" angle1=\"${angle1}\" angle2=\"${angle2}\" forme=\"${codage}\"  couleur=\"${couleur}\" id=\"${id}\" tempo=\"${tempo}\" mouvement=\"creer\" objet=\"angle\" />`\n    this.liste_script.push(codeXML)\n    return id\n  }\n\n  /**\n   * Masque un codage pralablement cr\n   * @param {PointAbstrait} A\n   * @param {PointAbstrait} B\n   * @param {PointAbstrait} C\n   * @param {objet} [options] Dfaut { tempo: 0 }\n   */\n  angleCodageMasquer(\n    B: PointAbstrait,\n    A: PointAbstrait,\n    C: PointAbstrait,\n    options: OptionsIep = {},\n  ) {\n    const tempo = options.tempo ?? 0\n    const id = B.id + '_' + A.id + '_' + C.id\n    this.liste_script.push(\n      `<action id=\"${id}\" mouvement=\"masquer\" objet=\"angle\" tempo=\"${tempo}\" />`,\n    )\n  }\n\n  /**\n   * Montre un codage pralablement cr\n   * @param {PointAbstrait} A\n   * @param {PointAbstrait} B\n   * @param {PointAbstrait} C\n   * @param {objet} [options] Dfaut { tempo: 0 }\n   */\n  angleCodageMontrer(\n    B: PointAbstrait,\n    A: PointAbstrait,\n    C: PointAbstrait,\n    options: OptionsIep = {},\n  ) {\n    const tempo = options.tempo ?? 0\n    const id = B.id + '_' + A.id + '_' + C.id\n    this.liste_script.push(\n      `<action id=\"${id}\" mouvement=\"montrer\" objet=\"angle\" tempo=\"${tempo}\" />`,\n    )\n  }\n\n  /**\n   * Affiche une image (donne par son URL) au point A\n   * @param {string} url\n   * @returns {id}\n   */\n  image(url: string, A = point(0, 0)) {\n    this.idIEP++\n    let codeXML\n    codeXML = `<action id=\"${this.idIEP}\" url=\"${url}\" mouvement=\"chargement\" objet=\"image\" />`\n    codeXML += `\\n<action abscisse=\"${this.x(A)}\" ordonnee=\"${this.y(A)}\" id=\"${this.idIEP}\" mouvement=\"translation\" objet=\"image\" vitesse=\"100000\" />`\n    this.liste_script.push(codeXML)\n    return this.idIEP\n  }\n}\n"],"file":"assets/Alea2iep-C31PJqbm.js"}
var Y=Object.defineProperty;var w=h=>{throw TypeError(h)};var $=(h,e,t)=>e in h?Y(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var v=(h,e,t)=>$(h,typeof e!="symbol"?e+"":e,t),q=(h,e,t)=>e.has(h)||w("Cannot "+t);var A=(h,e,t)=>e.has(h)?w("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(h):e.set(h,t);var x=(h,e,t)=>(q(h,e,"access private method"),t);import{D as B}from"./vendors/decimal.js-16C9rIKp.js";import{F as V,X as M,_ as z,p as j,Q as R,z as X,A as H,V as P,r as D}from"./index-DjA7ROjC.js";import{B as J}from"./courbes-Dc3vQIni.js";import{b as K,v as Q,a as _}from"./etudeFonction-LEqxMe_N.js";import{m as C,M as U}from"./Matrice-DFntyMUc.js";import{P as S,c as W}from"./Polynome-gGqMMLAt.js";import{r as y,g as I}from"./vendors/mathjs-oaIJR0Fd.js";function ae(h,e,t=-12/2,i=0,n=2){const r=[],s=e;let o=i,c=Math.cos(Math.random()*Math.PI)*D(1,2);for(let a=t;a<-t+1;a+=n){const b=o;r.push({x:a,y:o,deriveeGauche:c,deriveeDroit:c,isVisible:s});do o=o+j([-1,1])*D(1,2);while(o>5||o<-5);do c=Math.cos(Math.random()*Math.PI)*D(0,2);while(c*(o-b)<0)}return r}var f,N,d;const g=class g{constructor(e){A(this,f);v(this,"n");v(this,"polys");v(this,"nbPointsForApiGeom");v(this,"noeuds");v(this,"x");v(this,"y");v(this,"visibles");v(this,"fonctions");if(this.polys=[],this.x=[],this.y=[],this.noeuds=[],this.visibles=[],this.nbPointsForApiGeom=100,this.fonctions=[],(e==null||!Array.isArray(e)||e.length<2)&&(window.notify("Spline : nombre de noeuds insuffisant",{noeuds:e}),e=[{x:-3,y:-5,deriveeGauche:0,deriveeDroit:2,isVisible:!1},{x:3,y:0,deriveeGauche:-2,deriveeDroit:-2,isVisible:!1}]),!Z(e)){this.n=e.length,window.notify("Il y a un problème avec ces noeuds (peut-être un doublon ?) ",{noeuds:e});return}this.n=e.length;for(let t=0;t<e.length-1;t++){const i=e[t].x,n=e[t].y,r=e[t].deriveeDroit,s=e[t+1].x,o=e[t+1].y,c=e[t+1].deriveeGauche,a=C([[i**3,i**2,i,1],[s**3,s**2,s,1],[3*i**2,2*i,1,0],[3*s**2,2*s,1,0]]);if(n+(s-i)*c===o&&r===c){const b=(o-n)/(s-i),p=n-b*i;this.polys.push(new S({coeffs:[p,b,0,0]}))}else if(a!=null){if(a.determinant()===0){window.notify("Spline : impossible de trouver un polynome ici car la matrice n'est pas inversible, il faut revoir vos noeuds : ",{noeudGauche:e[t],noeudDroit:e[t+1]});return}const b=a.inverse();if(b!=null){const p=[n,o,r,c],l=b.multiply(p);if(l!=null)this.polys.push(new S({useFraction:!0,coeffs:(l instanceof U?l.toArray():l).reverse().map(u=>Number(Number(u).toFixed(6)))}));else{window.notify("Spline : impossible de trouver un polynome ici car la matrice n'est pas inversible, il faut revoir vos noeuds : ",{noeudGauche:e[t],noeudDroit:e[t+1]});return}}}}this.noeuds=[...e],this.n=this.noeuds.length,this.x=this.noeuds.map(t=>t.x),this.y=this.noeuds.map(t=>t.y),this.visibles=this.noeuds.map(t=>t.isVisible),this.n=this.y.length,this.fonctions=x(this,f,N).call(this)}get image(){return this.fonction}pointsOfSpline(e){const t=[],i=(this.x[this.x.length-1]-this.x[0])/this.nbPointsForApiGeom;let n=this.x[0];do t.push(e.create("Point",{x:n,y:x(this,f,d).call(this,n),isVisible:!1})),n+=i;while(n<=this.x[this.x.length-1]);return t.push(e.create("Point",{x:this.x[this.x.length-1],y:x(this,f,d).call(this,this.x[this.x.length-1]),isVisible:!1})),t}add(e,t){if(this.n!==e.n||this.x.filter(n=>e.x.includes(n)).length!==this.n)throw Error("Veuillez vous assurer de donner deux splines compatibles");const i=[];for(let n=0;n<this.n;n++){const r=this.x[n],s=this.y[n]+(t?-1:1)*e.y[n],o=this.noeuds[n].deriveeGauche+(t?-1:1)*e.noeuds[n].deriveeGauche,c=this.noeuds[n].deriveeDroit+(t?-1:1)*e.noeuds[n].deriveeDroit,a=this.noeuds[n].isVisible&&e.noeuds[n].isVisible;i.push({x:r,y:s,deriveeGauche:o,deriveeDroit:c,isVisible:a})}return new g(i)}zeros(e=1){const t=[];for(let i=this.x[0];i<this.x[this.n-1];i+=.5)if(x(this,f,d).call(this,i)*x(this,f,d).call(this,i+.5)<0){const{root:n}=K(this.fonction,i,i+.5,1e-9,100);n!=null&&t.push(y(n,e))}else x(this,f,d).call(this,i)===0&&t.push(y(i,e)),x(this,f,d).call(this,i+.5)===0&&t.push(y(i+.5,e));return Array.from(new Set(t).values())}solve(e,t=2){const i=e;if(e=Number(e),isNaN(e))window.notify(`Spline.solve() a reçu un truc bizarre à la place d'un nombre : ${i} !`,{valeurArgument:i});else{const n=[];for(let r=0;r<this.polys.length;r++){const s=this.polys[r].add(-e);try{const o=s.useFraction?I(...s.monomes.map(Number)):I(...s.monomes.map(Number));for(const c of o){let a;if(typeof c=="number")a=y(c,t);else if(c.toPolar().r<10**(-t-4))a=0;else{const p=c.arg();Math.abs(p)<.001||Math.abs(Math.abs(p)-Math.PI)<.001?a=y(c.re,t):a=null}a!==null&&a>=this.x[r]&&a<=this.x[r+1]&&(n.includes(a)||n.push(a))}}catch(o){const c=o instanceof Error?o.message:String(o);window.notify("Erreur dans Spline.solve()"+c,{valeur_de_y:e})}}return n}}variations(e=new V(1,100)){return Q(this.derivee,this.noeuds[0].x,this.noeuds[this.n-1].x)}signes(){const e=[],t=this.zeros(1);let i;if(t.length===0)return[{xG:this.x[0],xD:this.x[this.n-1],signe:this.y[0]>0?"+":"-"}];this.x[0]!==t[0]&&e.push({xG:this.x[0],xD:t[0],signe:this.y[0]>0?"+":"-"}),i=t[0],e.push({xG:t[0],xD:t[0],signe:"z"});for(let r=1;r<t.length;r++){const s=x(this,f,d).call(this,(i+t[r])/2);e.push({xG:i,xD:t[r],signe:s>0?"+":"-"}),e.push({xG:t[r],xD:t[r],signe:"z"}),i=t[r]}if(t[t.length-1]===this.x[this.n-1])return e;const n=x(this,f,d).call(this,(t[t.length-1]+this.x[this.n-1])/2);return e.push({xG:t[t.length-1],xD:this.x[this.n-1],signe:n>0?"+":"-"}),e}tableauSignes(e="x",t="f(x)"){const i=this.signes(),n=[];for(let s=0;s<i.length;s++)s===0&&n.push(M(i[0].xG,2),10),s>0&&i[s].xG!==i[s-1].xG&&n.push(M(i[s].xG,2),10);i[i.length-1].xD!==i[i.length-1].xG&&n.push(M(i[i.length-1].xD,2),10);const r=["Line",30];z(x(this,f,d).call(this,this.x[0]),0)||r.push("",10);for(let s=0;s<i.length;s++)r.push(i[s].signe,10);return _({tabInit:[[[e,2,10],[t,2,10]],n],tabLines:[r],espcl:3.5,deltacl:.8,lgt:8})}nombreAntecedentsEntiers(e){const t=this.solve(e);return((t==null?void 0:t.filter(n=>Number.isInteger(n)))??[]).length}nombreAntecedents(e){const t=this.solve(e);return(t==null?void 0:t.length)??0}nombreAntecedentsMaximum(e,t,i=!0,n=!0){let r=0;for(let s=e;s<t;s+=i?1:.1)n?r=Math.max(r,this.nombreAntecedentsEntiers(s)):r=Math.max(r,this.nombreAntecedents(s));return r}trouveYPourNAntecedents(e,t,i,n=!0,r=!0){const s=[];if(Number.isInteger(t)&&Number.isInteger(i))if(n)for(let o=t;o<=i;o++)(r&&this.nombreAntecedentsEntiers(o)===e&&this.nombreAntecedents(o)===e||!r&&this.nombreAntecedents(o)===e)&&s.push(o);else for(let o=t;o<=i;o+=.1)(r&&this.nombreAntecedentsEntiers(o)===e&&this.nombreAntecedents(o)===e||!r&&this.nombreAntecedents(o)===e)&&s.push(o);else window.notify("trouveYPourNAntecedentsEntiers() appelé avec des valeurs incorrectes",{n:e,yMin:t,yMax:i});return s.length<1?!1:j(s)}trouveMaxes(){if(Array.isArray(this.noeuds)&&this.noeuds.length>0){const e=Math.ceil(Math.min(...this.noeuds.map(r=>r.x))),t=Math.ceil(Math.min(...this.noeuds.map(r=>r.y))),i=Math.floor(Math.max(...this.noeuds.map(r=>r.x))),n=Math.floor(Math.max(...this.noeuds.map(r=>r.y)));return{xMin:e,xMax:i,yMin:t,yMax:n}}else return window.notify("Spline.trouveMaxes() on demande ça alors que la Spline n'a pas de noeuds !",{laSpline:JSON.stringify(this)}),{xMin:0,xMax:0,yMin:0,yMax:0}}amplitude(){let e=1e3,t=-1e3;for(let i=0;i<this.x.length-1;i++){const{minLocal:n,maxLocal:r}=W({poly:this.polys[i],xG:this.x[i],xD:this.x[i+1]});e=Math.min(e,n),t=Math.max(t,r)}return{yMin:e,yMax:t}}get fonction(){return e=>x(this,f,d).call(this,e)}get derivees(){const e=[];for(let t=0;t<this.polys.length;t++)e.push(this.polys[t].derivee());return e}get derivee(){const e=[];for(let t=0;t<this.noeuds.length-1;t++)e.push({xG:this.noeuds[t].x,xD:this.noeuds[t+1].x});return t=>{const i=e.findIndex(n=>t>=n.xG&&t<=n.xD);return this.derivees[i].image(t)}}get splineDerivee(){const e=[];for(const t of this.noeuds)e.push({x:t.x,y:t.deriveeGauche,deriveeGauche:0,deriveeDroit:0,isVisible:t.isVisible});return new g(e)}courbe({color:e="black",epaisseur:t=1,ajouteNoeuds:i=!1,optionsNoeuds:n={}}={}){return new ee(this,{color:e,epaisseur:t,ajouteNoeuds:i,optionsNoeuds:n})}};f=new WeakSet,N=function(){const e=[];for(let t=0;t<this.n-1;t++)e.push(this.polys[t].fonction);return e},d=function(e){typeof e!="number"&&(e instanceof V?e=e.valeurDecimale:e instanceof B&&(e=e.toNumber()));const t=e;let i=!1,n=0;for(let r=0;r<this.n-1;r++)if(t>=this.x[r]&&t<=this.x[r+1]){n=r,i=!0;break}if(i)return this.fonctions[n](t);{const r=`D = [${this.x[0]} ; ${this.x[this.n-1]}]`;return window.notify("Spline: la valeur de x fournie n'est pas dans lìntervalle de définition de la fonction",{x:e,intervalle:r}),NaN}};let G=g;function ce(h){return new G(h)}function Z(h){let e,t,i,n,r;for(let s=0;s<h.length-1;s++)for(let o=s+1;o<h.length;o++)if(h[s].x>h[o].x)e=h[s].x,t=h[s].y,i=h[s].deriveeGauche,n=h[s].deriveeDroit,r=h[s].isVisible,h[s].x=h[o].x,h[s].y=h[o].y,h[s].deriveeGauche=h[o].deriveeGauche,h[s].deriveeDroit=h[o].deriveeDroit,h[s].isVisible=h[o].isVisible,h[o].x=e,h[o].y=t,h[o].deriveeGauche=i,h[o].deriveeDroit=n,h[o].isVisible=r;else if(z(h[s].x,h[o].x))return!1;return!0}class ee extends R{constructor(e,{color:t="black",epaisseur:i=2,opacite:n=1,ajouteNoeuds:r=!0,optionsNoeuds:s={}}){super(),this.objets=[];const{xMin:o,xMax:c,yMin:a,yMax:b}=e.trouveMaxes();this.bordures=[o,a,c,b];const p=[];for(let l=0;l<e.n-1;l++){const u=e.x[l+1]-e.x[l],m=e.y[l+1]-e.y[l],E=u/3,F=e.noeuds[l].deriveeDroit*u/3,L=2*u/3,k=m-e.noeuds[l+1].deriveeGauche*u/3,O=u,T=m;p.push([[E,F],[L,k],[O,T]])}if(this.objets.push(new J({xStart:e.x[0],yStart:e.y[0],listeOfTriplets:p,color:t,epaisseur:i,opacite:n})),r){for(let l=0;l<e.n;l++)if(e.visibles[l]){const u=X(e.x[l],e.y[l]),m=H(u);s&&(s.color&&(m.color=P(s.color),m.couleurDeRemplissage=P(s.color)),s.epaisseur&&(m.epaisseur=s.epaisseur),s.style&&(m.style=s.style),s.taille&&(m.taille=s.taille)),this.objets.push(m)}}this.svg=function(l){let u="";if(this.objets==null)return u;for(const m of this.objets)u+=`
	`+m.svg(l);return u},this.tikz=function(){let l="";if(this.objets==null)return l;for(const u of this.objets)l+=u.tikz();return l}}}export{G as S,ae as n,ce as s,Z as t};
//# sourceMappingURL=Spline-CZkVr8hL.js.map

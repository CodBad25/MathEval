{"version":3,"mappings":"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BACL,IAAK,qBACL,IAAK,mBACL,IAAK,kBACL,IAAK,qBACL,IAAK,qBACL,IAAK,qBACL,IAAK,kBACL,IAAK,wBACL,IAAK,uBACL,IAAK,wBACL,IAAK,yBACL,IAAK,uBACL,IAAK,sBACL,IAAK,uBACL,IAAK,uBACL,IAAK,uBACL,IAAK,mBACL,IAAK,yBACL,IAAK,wBACL,IAAK,yBACL,IAAK,0BACL,IAAK,wBACL,IAAK,uBACL,IAAK,wBACL,IAAK,wBACL,IAAK,wBACL,IAAK,qBACL,IAAK,2BACL,IAAK,0BACL,IAAK,2BACL,IAAK,4BACL,IAAK,0BACL,IAAK,yBACL,IAAK,0BACL,IAAK,0BACL,IAAK,0BACL,IAAK,sBACL,IAAK,4BACL,IAAK,2BACL,IAAK,4BACL,IAAK,6BACL,IAAK,2BACL,IAAK,0BACL,IAAK,2BACL,IAAK,2BACL,IAAK,2BACL,IAAK,qBACL,IAAK,2BACL,IAAK,0BACL,IAAK,2BACL,IAAK,4BACL,IAAK,0BACL,IAAK,yBACL,IAAK,0BACL,IAAK,0BACL,IAAK,0BACL,IAAK,yBACL,IAAK,6BACL,IAAK,2BACL,IAAK,4BACL,IAAK,8BACL,IAAK,4BACL,IAAK,2BACL,IAAK,8BACL,IAAK,8BACL,IAAK,8BACL,IAAK,0BACL,IAAK,4BACL,IAAK,8BACL,IAAK,+BACL,IAAK,gCACL,IAAK,8BACL,IAAK,6BACL,IAAK,8BACL,IAAK,8BACL,IAAK,8BACL,IAAK,6BACL,IAAK,8BACL,IAAK,+BACL,IAAK,gCACL,IAAK,kCACL,IAAK,gCACL,IAAK,+BACL,IAAK,kCACL,IAAK,kCACL,IAAK,kCACL,IAAK,YACL,IAAK,cACL,IAAK,gBACL,IAAK,iBACL,IAAK,kBACL,IAAK,gBACL,IAAK,eACL,IAAK,gBACL,IAAK,gBACL,IAAK,gBACL,IAAK,eACL,IAAK,gBACL,IAAK,iBACL,IAAK,kBACL,IAAK,oBACL,IAAK,kBACL,IAAK,iBACL,IAAK,oBACL,IAAK,oBACL,IAAK,oBACL,IAAK,iBACL,IAAK,uBACL,IAAK,sBACL,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M,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAClE,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,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EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,QAAS,OAAO,EACvD,MAAO,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,QAAS,OAAO,CACxD,EACMC,GAA0C,CAC9C,OAAQ,CACN,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,QACA,KACA,MACA,OACA,MACA,OAEF,MAAO,CACL,EACA,EACA,EACA,MACA,EACA,EACA,EACA,OACA,EACA,EACA,EACA,MACA,EACA,QACA,KACA,MAEJ,EACMC,GAA2C,CAC/C,OAAQ,CACN,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,QACA,QACA,MACA,OACA,MACA,OAEF,MAAO,CACL,EACA,EACA,EACA,MACA,EACA,EACA,EACA,OACA,EACA,EACA,EACA,MACA,EACA,QACA,QACA,MAEJ,EACMC,GAAqC,CACzC,OAAQ,CACN,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,QACA,QACA,MACA,OACA,MACA,OAEF,MAAO,CACL,EACA,EACA,EACA,MACA,EACA,EACA,EACA,OACA,EACA,EACA,EACA,MACA,EACA,QACA,QACA,MAEJ,EACMC,GAAiC,CACrC,OAAQ,CACN,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,IACA,IACA,KAEF,MAAO,CACL,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,QACA,IACA,IACA,IAEJ,EACMC,GAAuC,CAC3C,OAAQ,CAAC,MAAO,MAAO,OAAQ,MAAO,KAAM,OAAQ,IAAK,GAAG,EAC5D,MAAO,CAAC,MAAO,MAAO,OAAQ,MAAO,KAAM,OAAQ,IAAK,GAAG,CAC7D,EACMC,GAA2C,CAC/C,OAAQ,CACN,MACA,MACA,OACA,MACA,QACA,KACA,MACA,OACA,IACA,IACA,WACA,aAEF,MAAO,CACL,QACA,MACA,MACA,KACA,OACA,MACA,MACA,WACA,OACA,YACA,IACA,IAEJ,EACMC,GAAwC,CAC5C,OAAQ,CAAC,MAAO,MAAO,OAAQ,MAAO,IAAK,OAAQ,IAAK,GAAG,EAC3D,MAAO,CAAC,MAAO,MAAO,OAAQ,MAAO,IAAK,OAAQ,IAAK,GAAG,CAC5D,EACMC,GAAsC,CAC1C,OAAQ,CACN,MACA,MACA,OACA,MACA,OACA,IACA,IACA,IACA,QACA,OACA,KACA,MACA,QACA,MACA,UACA,aAEF,MAAO,CACL,MACA,MACA,QACA,MACA,OACA,MACA,KACA,OACA,IACA,IACA,MACA,UACA,IACA,OACA,QACA,YAEJ,EACMC,GAAkC,CACtC,OAAQ,CACN,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,MACA,KACA,MACA,OACA,YACA,QACA,MACA,OACA,MACA,MACA,OACA,QACA,KACA,QACA,cACA,QACA,SACA,YAEF,MAAO,CACL,OACA,QACA,KACA,MACA,EACA,EACA,EACA,MACA,KACA,OACA,QACA,EACA,EACA,EACA,QACA,cACA,SACA,QACA,EACA,EACA,EACA,MACA,MACA,OACA,MACA,EACA,QACA,YAEJ,EAEMC,GAAmC,CACvC,OAAQ,CACN,WACA,UACA,QACA,WACA,UACA,QACA,KACA,UACA,WACA,WACA,eACA,gBACA,cACA,SACA,MACA,QACA,SACA,WACA,YACA,WACA,eACA,eACA,mBACA,QAEF,MAAO,CACL,WACA,UACA,QACA,WACA,UACA,QACA,KACA,UACA,WACA,WACA,eACA,gBACA,cACA,SACA,MACA,QACA,SACA,WACA,YACA,WACA,eACA,eACA,mBACA,OAEJ,EAEMC,GAAoC,CACxC,OAAQ,CACN,OACA,QACA,WACA,QACA,QACA,QACA,YACA,cACA,MACA,SACA,QACA,KAEF,MAAO,CACL,OACA,QACA,WACA,QACA,QACA,QACA,YACA,cACA,MACA,SACA,QACA,IAEJ,EAEMC,GAAiC,CACrC,OAAQ,CACN,MACA,MACA,QACA,SACA,IACA,IACA,KACA,YACA,OACA,OACA,MACA,SAEF,MAAO,CACL,MACA,MACA,QACA,SACA,IACA,IACA,KACA,YACA,OACA,OACA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ACT,KAAM,EACN,MAAO,uBACP,QAAS,EACX,EAEamB,GAAiC,CAC5C,QAASzC,GACT,KAAM,EACN,MAAO,qBACP,QAAS,EACX,EAEa0C,GAAkC,CAC7C,QAASxC,GACT,KAAM,EACN,MAAO,qBACP,QAAS,EACX,EAEayC,GAAqC,CAChD,QAAS1C,GACT,KAAM,EACN,MAAO,qBACP,QAAS,EACX,EAEa2C,GAAgC,CAC3C,QAASzC,GACT,KAAM,EACN,MAAO,uBACP,QAAS,EACX,EAEa0C,GAA4C,CACvD,QAASzC,GACT,KAAM,EACN,MAAO,0BACP,QAAS,EACX,EAEa0C,GAA4B,CACvC,QAASzC,GACT,KAAM,EACN,MAAO,0BACP,QAAS,EACX,EAEa0C,GAA6B,CACxC,QAASzC,GACT,KAAM,EACN,MAAO,eACP,QAAS,EACX,EAEaz8D,GAAqB,CAChC,QAAS68D,GACT,KAAM,EACN,MAAO,QACP,QAAS,EACX,EAEasC,GAAuB,CAClC,QAASrC,GACT,KAAM,EACN,MAAO,mBACP,QAAS,EACX,EAEa9qB,GAAyB,CACpC,QAAS+qB,GACT,KAAM,EACN,MAAO,cACP,QAAS,EACX,EAEaqC,GAAuB,CAClC,QAASpC,GACT,KAAM,EACN,MAAO,QACP,QAAS,EACX,EAEaqC,GAA8B,CACzC,QAASpC,GACT,KAAM,EACN,MAAO,gBACP,QAAS,EACX,EAEaqC,GAAuB,CAClC,QAASpC,GACT,KAAM,EACN,MAAO,gBACP,QAAS,EACX,EACaqC,GAA0B,CACrC,QAASpC,GACT,KAAM,EACN,MAAO,qBACP,QAAS,EACX,EAEaqC,GAAyB,CACpC,QAAS7B,GACT,KAAM,EACN,MAAO,YACP,QAAS,EACX,EAEa8B,GAAuB,CAClC,QAAS5B,GACT,KAAM,EACN,MAAO,QACP,QAAS,EACX,EAEa6B,GAA0B,CACrC,QAAShD,GACT,KAAM,EACN,MAAO,YACP,QAAS,EACX,EAEaiD,GAAgC,CAC3C,QAAShD,GACT,KAAM,EACN,MAAO,mBACP,QAAS,EACX,EAEaiD,GAAuB,CAClC,QAAShD,GACT,KAAM,EACN,MAAO,SACP,QAAS,EACX,EAEaiD,GAAyB,CACpC,QAAS9B,GACT,KAAM,EACN,MAAO,UACP,QAAS,EACX,EAEa+B,GAA4B,CACvC,QAAS7B,GACT,KAAM,EACN,MAAO,YACP,QAAS,EACX,EAEa8B,GAAwB,CACnC,QAAS5B,GACT,KAAM,EACN,MAAO,SACP,QAAS,EACX,EAEa6B,GAAwB,CACnC,QAAS5C,GACT,KAAM,EACN,MAAO,SACP,QAAS,EACX,EAEa6C,GAA+B,CAC1C,QAAS5C,GACT,KAAM,EACN,MAAO,oBACP,QAAS,EACX,EAEa6C,GAA+B,CAC1C,QAAS5C,GACT,KAAM,EACN,MAAO,oBACP,QAAS,EACX,EAEa6C,GAA+B,CAC1C,QAAS5C,GACT,KAAM,EACN,MAAO,oBACP,QAAS,EACX,EAEa6C,GAA+B,CAC1C,QAAS5C,GACT,KAAM,EACN,MAAO,oBACP,QAAS,EACX,EAEa6C,GAAiC,CAC5C,QAAS3C,GACT,KAAM,EACN,MAAO,mBACP,QAAS,EACX,EAEa4C,GAET,CACF,SAAAf,GACA,OAAAS,GACA,MAAAP,GACA,gBAAAb,GACA,iBAAAC,GACA,oBAAAC,GACA,WAAAgB,GACA,QAAA9tB,GACA,UAAAqsB,GACA,MAAAe,GACA,aAAAC,GACA,SAAAK,GACA,eAAAC,GACA,MAAAC,GACA,MAAAT,GACA,eAAAJ,GACA,IAAA/+D,GACA,QAAAw/D,GACA,2BAAAR,GACA,OAAAe,GACA,QAAAz7D,GACA,aAAAo6D,GACA,SAAAJ,GACA,SAAAC,GACA,kBAAAC,GACA,mBAAAC,GACA,WAAAQ,GACA,YAAAC,GACA,MAAAI,GACA,UAAAp1B,GACA,QAAA21B,GACA,KAAAlB,GACA,cAAAsB,GACA,cAAAC,GACA,cAAAC,GACA,cAAAC,GACA,gBAAAC,EACF,EC5+BaE,GAAe,CAC1B,GAAI,GACJ,GAAI,GACJ,GAAI,GACJ,GAAI,EACN,EACaC,GAAgB,CAC3B,GAAI,GACJ,GAAI,EACN,EACaC,GAAqB,CAChC,GAAI,GACJ,GAAI,GACJ,GAAI,GACJ,GAAI,EACN,EACaC,GAAmB,CAC9B,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,CACN,EAEaC,GAAgB,IAChBC,GAAgB,IAChBC,GAAgB,KAGhBC,GAAU,SACrBC,EACAC,EAC2B,CAC3B,OAAIA,EACKD,GAAcJ,GAAgB,KAAO,KAEvCI,GAAcJ,GACjB,KACAI,GAAcH,GACZ,KACAG,GAAcF,GACZ,KACA,IACV,ECgBO,MAAMI,EAAS,CAGpB,YAAYC,EAAoB,CAFhCjsE,EAAA,cAA0B,CAACmpE,EAAW,GAatCnpE,EAAA,WAAOisE,IACL,KAAK,OAAO,KAAKA,CAAE,EACZ,OAGTjsE,EAAA,aAAQ,IAAY,CAClB,KAAK,OAAO,OAAS,EACrB,KAAK,OAAO,KAAKmpE,EAAW,CAC9B,GAMAnpE,EAAA,sBAAiB,IAAc,KAAK,OAAO,QAM3CA,EAAA,4BAAuB,IAAgB,CACrC,MAAMpL,EAAmB,GACzB,UAAWs3E,KAAS,KAAK,OACvBt3E,EAAO,KAAKs3E,EAAM,QAAQ,OAAO,MAAM,EAEzC,OAAOt3E,CACT,GAMAoL,EAAA,oBAAe,IACb,KAAK,uBAAuB,OAAO,CAACu0C,EAAMhlC,IAAYglC,EAAOhlC,CAAO,GAOtEvP,EAAA,+BAA0B,IAAY,CACN,KAAK,uBAChC,MAAM,CAAC,EACP,OAAO,CAACu0C,EAAMhlC,IAAaglC,EAAOhlC,EAAUA,EAAUglC,EAAO,CAAC,GACpC,IAE3B,KAAK,OAAO,CAAC,EAAE,KAAO,EAE1B,GA1DM03B,GACF,KAAK,OAAO,KAAKA,CAAE,CAEvB,CAwDF,CAEO,MAAME,GAAmB,CAC9BD,EACA5mB,IACW,SAEX,MAAM8mB,IAAez4E,GAAAC,EAAAs4E,GAAA,YAAAA,EAAO,UAAP,YAAAt4E,EAAgB,SAAhB,YAAAD,EAAwB,SAAU,EAEvD,OACEy4E,EAAed,GAAahmB,CAAI,GAC/B8mB,EAAe,GAAKX,GAAiBnmB,CAAI,CAE9C,2BC9FiB+mB,EAAAvN,KAAI,QAAO,2DAFZh7B,EAAA7sB,EAAA,KAAAq1D,EAAA,OAAAxN,KAAI,OAAO,0BAZZh7B,EAAAyoC,EAAA,QAAAC,EAAA,QAAA1N,EAAO,qjBAAgjBA,EAAA,GAChkB,qEACA,4DAA0D,6GACxCA,EAAW,yBAAmBA,EAAY,YALlEV,EAkBQ7qB,EAAAg5B,EAAA1yD,CAAA,EAJN8lD,EAGK4M,EAAAt1D,CAAA,EADH0oD,EAA+B1oD,EAAAojC,CAAA,yFAAlB+kB,EAAA,GAAAiN,OAAAvN,KAAI,QAAO,MAAAzkB,EAAA,UAAAgyB,GAFZjN,EAAA,GAAAkN,OAAA,OAAAxN,KAAI,sBAZLM,EAAA,GAAAoN,OAAA,QAAA1N,EAAO,qjBAAgjBA,EAAA,GAChkB,qEACA,4DAA0D,mIACxCA,EAAW,+BAAmBA,EAAY,6DAChD9rE,GAAC,CACfA,EAAE,eAAc,EAChBA,EAAE,gBAAe,+BArBR,WAAA84E,CAAkB,EAAAvN,GAClB,QAAAkO,CAAa,EAAAlO,GACb,IAAAhtE,CAAW,EAAAgtE,GACX,SAAAwN,CAAiB,EAAAxN,EACjB,WAAAmO,EAAqB,EAAK,EAAAnO,GAC1B,YAAAoO,CAAsD,EAAApO,EAC7DW,4CAQQA,EAAM2D,mBASN7vE,GAAC,CACX25E,EAAYp7E,EAAKyB,CAAC,oQAjBnB4rE,EAAA,EAAEgO,EAActB,GAAaO,GAAQC,EAAYC,CAAQ,oBAEzDnN,EAAA,EAAEiO,EACDf,GAAcJ,GAAgBH,GAAc,GAAKA,GAAc,EAAE,+JCb9D,MAAMuB,GAAgBv7E,GAC3B,CAAC,MAAO,QAAS,OAAQ,MAAO,MAAO,MAAO,KAAK,EAAE,SAASA,EAAI,UAAU,EACjEw7E,GAAax7E,GACxB,CAAC,MAAO,MAAO,KAAK,EAAE,SAASA,EAAI,UAAU,2LCWtCutE,EAAQ,0DANCh7B,EAAA7sB,EAAA,KAAAq1D,EAAA,YAAAxN,KAAM,MACjB,YAAW,EACX,UAAU,KAAK,EACf,QAAQ,gCAAiB,EAAE,EAAE,EAC7B,QAAQ,IAAK,GAAG,WALrBV,EAwCK7qB,EAAAt8B,EAAA4C,CAAA,oKAvCW,CAAAtK,GAAA6vD,EAAA,GAAAkN,OAAA,YAAAxN,KAAM,MACjB,YAAW,EACX,UAAU,KAAK,EACf,QAAQ,gCAAiB,EAAE,EAAE,EAC7B,QAAQ,IAAK,GAAG,6GAuBRA,EAAK,GAAC,QAAQ,KAAK,uBAAxB,OAAInoE,GAAA,uHAHiBmtC,EAAA7sB,EAAA,QAAAsqD,EAAA,kBAAAzC,KAAM,KAAI,mDACfA,EAAO,YAF3BV,EAcK7qB,EAAAt8B,EAAA4C,CAAA,8EAVIilD,EAAK,GAAC,QAAQ,KAAK,oBAAxB,OAAInoE,GAAA,8GAAJ,OAAIA,EAAAq2E,EAAA,OAAAr2E,GAAA,aAHiB,CAAA4Y,GAAA6vD,EAAA,GAAAmC,OAAA,kBAAAzC,KAAM,KAAI,gFACfA,EAAO,iCAEvB,OAAInoE,GAAA,yIAhBCmoE,EAAK,GAAC,QAAQ,MAAM,uBAAzB,OAAInoE,GAAA,uHAHiBmtC,EAAA7sB,EAAA,QAAAsqD,EAAA,kBAAAzC,EAAK,GAAC,QAAQ,OAAO,OAAM,mDAChCA,EAAO,YAF3BV,EAcK7qB,EAAAt8B,EAAA4C,CAAA,8EAVIilD,EAAK,GAAC,QAAQ,MAAM,oBAAzB,OAAInoE,GAAA,8GAAJ,OAAIA,EAAAq2E,EAAA,OAAAr2E,GAAA,aAHiB,CAAA4Y,GAAA6vD,EAAA,GAAAmC,OAAA,kBAAAzC,EAAK,GAAC,QAAQ,OAAO,OAAM,gFAChCA,EAAO,iCAEvB,OAAInoE,GAAA,kKAkBQmoE,EAAG,GACP,IAAA0H,GAAK1H,EAAG,IACF,UAAAgO,GAAahO,EAAG,qIAFlBA,EAAG,IACPM,EAAA,IAAA6N,EAAA,IAAAzG,GAAK1H,EAAG,KACFM,EAAA,IAAA6N,EAAA,UAAAH,GAAahO,EAAG,gOAlBlBA,EAAG,GACP,IAAA0H,GAAK1H,EAAG,IACF,UAAAgO,GAAahO,EAAG,qIAFlBA,EAAG,IACPM,EAAA,IAAA6N,EAAA,IAAAzG,GAAK1H,EAAG,KACFM,EAAA,IAAA6N,EAAA,UAAAH,GAAahO,EAAG,gMAjBnCD,EAAAC,OAAU,QAASG,GAAAH,CAAA,yEAAnBA,OAAU,yMARF,WAAAgN,CAAkB,EAAAvN,GAClB,MAAA2N,CAAoB,EAAA3N,EACpB,UAAAwN,EAAoB,EAAK,EAAAxN,GACzB,YAAAoO,CAAsD,EAAApO,iMAEhEK,EAAA,EAAEsO,EAAUzB,GAAiBI,GAAQC,EAAYC,CAAQ,wQCoDjD/I,EAAAlE,KAAM,MAAK,8HAjByFh7B,EAAAo7B,EAAA,QAAAiE,EAAA,iGAAArE,EAAY,KACjHA,EAAmB,GAACA,KAAM,KAAK,EAC3B,gHACA,2EAAyE,gOACnEA,EAAmB,GAACA,EAAK,GAAC,KAAK,0DAEpBA,EAAmB,GAACA,EAAK,GAAC,KAAK,sCATxDV,EAsBI7qB,EAAAyG,EAAAngC,CAAA,EArBF8lD,EAoBQ3lB,EAAAklB,CAAA,+EADLE,EAAA,GAAA4D,OAAAlE,KAAM,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,EAjByF5D,EAAA,GAAA+D,OAAA,iGAAArE,EAAY,KACjHA,EAAmB,GAACA,KAAM,KAAK,EAC3B,gHACA,2EAAyE,iPACnEA,EAAmB,GAACA,EAAK,GAAC,KAAK,2CAEpBA,EAAmB,GAACA,EAAK,GAAC,KAAK,8MAoB9Ch7B,EAAA7sB,EAAA,QAAAsqD,GAAAzC,EAAY,KAAKA,EAAmB,GAACA,KAAM,KAAK,EACpD,mBACA,oBAAkB,8FACZA,EAAmB,GAACA,EAAK,GAAC,KAAK,0DAElBA,EAAmB,GAACA,EAAK,GAAC,KAAK,kBANxDV,EASK7qB,EAAAt8B,EAAA4C,CAAA,6HARK,CAAAtK,GAAA6vD,EAAA,GAAAmC,QAAAzC,EAAY,KAAKA,EAAmB,GAACA,KAAM,KAAK,EACpD,mBACA,oBAAkB,qHACZA,EAAmB,GAACA,EAAK,GAAC,KAAK,0CAElBA,EAAmB,GAACA,EAAK,GAAC,KAAK,6JAnCnDA,EAAU,yBAAf,OAAInoE,GAAA,8BA4BCmoE,EAAU,yBAAf,OAAInoE,GAAA,kRAjCiBmoE,EAAY,6BACjB3K,GAA+B,2HAJrDiK,EAiDK7qB,EAAA8qB,EAAAxkD,CAAA,EAhDH8lD,EAgCItB,EAAAljB,CAAA,0DAEJwkB,EAaKtB,EAAAqB,CAAA,iFAxCIZ,EAAU,sBAAf,OAAInoE,GAAA,qHAAJ,2CALqBmoE,EAAY,eAiC5BA,EAAU,sBAAf,OAAInoE,GAAA,8GAAJ,OAAIA,EAAAq2E,EAAA,OAAAr2E,GAAA,0CAAJ,OAAIA,GAAA,4HAZgB3D,GAAC,CACfA,EAAE,eAAc,EAChBA,EAAE,gBAAe,+BArDhB,WAAAm6E,EAAU,CACnB9B,GAAe,QACfA,GAAe,MACfA,GAAe,QACfA,GAAe,gBAEN,YAAAsB,CAAsD,EAAApO,GACtD,SAAAwN,CAAiB,EAAAxN,EAQtB,MAAA6O,EAAuBn6E,GAC3BA,EAAE,UAAU,KAAK,EAAE,QAAQ,mBAAoB,EAAE,EAC7Co6E,EAAc,IACfF,EAAW,IAAK91E,GAAM+1E,EAAoB/1E,EAAE,KAAK,IAIhDi2E,EAAiBC,GAAyC,CAC9D3O,EAAA,EAAA4O,EAAeD,CAAQ,QAuBLv6E,IAAC,CACXA,EAAE,eAAc,EAChBA,EAAE,gBAAe,EACjBs6E,EAAcF,EAAoBlB,EAAM,KAAK,wIAzCtDtN,EAAA,EAAE6O,EACD,YAAc/B,GAAgBF,GAAmB,GAAKA,GAAmB,EAAE,EAW5E5M,EAAA,EAAE4O,EAAeH,EAAe,CAAC,wSCkBfvO,EAAW,8CASnBA,EAAM,yBAAX,OAAInoE,GAAA,yJAXKmtC,EAAA47B,EAAA,QAAAgO,EAAA5O,EAAW,GAAC,OAAS,IAAMA,EAAQ,GAAG,OAAS,QAAQ,+GAApEV,EAMK7qB,EAAAmsB,EAAA7lD,CAAA,uBACLukD,EAOK7qB,EAAA8qB,EAAAxkD,CAAA,iGAZYilD,EAAW,iEAFf,CAAAvvD,GAAA6vD,EAAA,IAAAsO,OAAA5O,EAAW,GAAC,OAAS,IAAMA,EAAQ,GAAG,OAAS,sCAWnDA,EAAM,sBAAX,OAAInoE,GAAA,8GAAJ,OAAIA,EAAAq2E,EAAA,OAAAr2E,GAAA,6DAAJ,OAAIA,GAAA,2KAhBCmoE,EAAI,yBAAT,OAAInoE,GAAA,mOADRynE,EAIK7qB,EAAAt8B,EAAA4C,CAAA,8EAHIilD,EAAI,sBAAT,OAAInoE,GAAA,8GAAJ,OAAIA,EAAAq2E,EAAA,OAAAr2E,GAAA,0CAAJ,OAAIA,GAAA,23BAFLmoE,EAAQ,kOAFUA,EAAY,YAFrCV,EA2BK7qB,EAAAt8B,EAAA4C,CAAA,sMAzBoBilD,EAAY,4FA1BxB,WAAAgN,CAAkB,EAAAvN,GAClB,YAAAoP,CAA4B,EAAApP,GAC5B,YAAAqP,CAA4B,EAAArP,GAC5B,KAAAsP,CAAqB,EAAAtP,EAC5B3rE,EACF+6E,EAAY,OAAS,MAAQC,CAAW,EAAQ,IAAAD,KAAgBC,CAAW,GAClE,YAAAjB,CAAsD,EAAApO,GACtD,SAAAwN,CAAiB,EAAAxN,EAI5B,OAAAuP,GAAY,KAEVlP,EAAA,EAAAhsE,EACE+6E,EAAY,OAAS,MACbC,CAAW,EACX,IAAAD,KAAgBC,CAAW,KAGvC7L,GAAW,+QAVVnD,EAAA,EAAE6O,EAAejC,GAAmBK,GAAQC,EAAYC,CAAQ,kKCfnE,MAAMgC,GAA2B,CAC/B,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAG,EACjD,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAG,EACjD,CAAC,MAAO,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAK,EAC3C,CAAC,MAAO,QAAS,QAAS,QAAS,OAAQ,MAAO,OAAO,CAC3D,EACMC,GAA0B,CAC9B,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAG,EACjD,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAG,EACjD,CAAC,MAAO,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAK,EAC3C,CAAC,MAAO,QAAS,QAAS,QAAS,OAAQ,MAAO,OAAO,CAC3D,EACMC,GAAsB,CAC1B,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,CAAC,EAC7B,CACE,MACA,MACA,OACA,MACA,OACA,IACA,QACA,YACA,QACA,YAEF,CAAC,KAAM,OAAQ,MAAO,QAAS,OAAQ,OAAQ,QAAS,MAAO,KAAM,KAAK,EAC1E,CAAC,MAAO,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,WAAY,WAAY,SAAS,CACzE,EAEaC,GAAkE,CAC7E,SAAUH,GACV,QAASC,GACT,QAASC,EACX,yICAmBzH,GAAK1H,EAAG,IAAE,QAAO,qHATXA,EAAG,2iBACfgO,GAAahO,EAAG,IACb,qEACA,oEAAkE,wFALxEV,EAYQ7qB,EAAA2rB,EAAArlD,CAAA,oEADC2sD,GAAK1H,EAAG,IAAE,QAAO,MAAAI,EAAA,UAAAmN,uBATXvN,EAAG,2iBACfgO,GAAahO,EAAG,IACb,qEACA,oEAAkE,qJANnEA,EAAG,yBAAR,OAAInoE,GAAA,8NAHRynE,EAkBK7qB,EAAAt8B,EAAA4C,CAAA,+EAfIilD,EAAG,sBAAR,OAAInoE,GAAA,kHAAJ,4DAJCmoE,EAAI,yBAAT,OAAInoE,GAAA,sPAJVynE,EA0BK7qB,EAAA8qB,EAAAxkD,CAAA,EAzBH8lD,EAwBKtB,EAAAqB,CAAA,0EArBIZ,EAAI,sBAAT,OAAInoE,GAAA,qHAAJ,oEAbO,SAAAw3E,CAA2B,EAAA5P,GAE3B,YAAAoO,CAIF,EAAApO,aAkBavrE,IAAC,CACX25E,EAAYnG,GAAKj1E,CAAG,EAAGyB,EAAGzB,CAAG,gIAxBxCqtE,EAAA,EAAEwP,EAAOF,GAAoBC,CAAQ,wMCwK/BrP,EAAqB,yIA4DVA,EAAQ,GAAG,UAAY,WAAU,iUAqBjCA,EAAqB,GAAG,UAAY,iBAAgB,gDAfhDh7B,EAAAigC,EAAA,QAAAsK,EAAA,cAAAvP,EAAc,IAAC,OAAO,SAAS,cAAc,EAC3D,mCACA,UAAQ,weA9EhBV,EA6FK7qB,EAAAt8B,EAAA4C,CAAA,wBAxCH8lD,EAkBQ1oD,EAAA6sD,CAAA,EADNnE,EAAqDmE,EAAAJ,CAAA,SAGvD/D,EAmBQ1oD,EAAA8sD,CAAA,EADNpE,EAAwEoE,EAAAH,CAAA,ySArB1D9E,EAAQ,GAAG,UAAY,uDAqBvBA,EAAqB,GAAG,UAAY,qCAfhC,CAAAvvD,GAAA6vD,EAAA,MAAAiP,OAAA,cAAAvP,EAAc,IAAC,OAAO,SAAS,cAAc,EAC3D,mCACA,UAAQ,iRAxEYwP,MAAAC,GAAAt3D,EAAAu3D,GAAA,GAAG,OAAQ,QAAS,CAAC,oCAArBF,MAAAC,GAAAt3D,EAAAu3D,GAAA,GAAG,OAAQ,QAAS,CAAC,0JASvB,gBAAA1P,MAAa,QAAO,EACpB,gBAAAA,MAAa,QAAO,EAC/B,KAAAA,KAAMA,EAAgB,wgBAclBA,EAAK,GAAC,SAAW,GAAKA,EAAgB,KAAK,GAAC,CAAKA,EAAQ,wWAazDiF,EAAA,SAAA0K,EAAA3P,EAAK,GAAC,SAAW,GAC1BA,EAAgB,KAAKA,EAAK,GAAC,OAAS,IACnCA,EAAQ,iBAjCFA,EAAQ,GAAG,iBAAmB,cAAc,UAAzDV,EAqCK7qB,EAAAt8B,EAAA4C,CAAA,qBA3BH8lD,EAWQ1oD,EAAA6sD,CAAA,EADNnE,EAAwCmE,EAAAJ,CAAA,SAG1C/D,EAaQ1oD,EAAA8sD,CAAA,EADNpE,EAAuCoE,EAAAH,CAAA,2BAtB5B9E,EAAQ,uCAaRA,EAAO,oDAxBAM,EAAA,IAAAsP,EAAA,gBAAA5P,MAAa,QAAO,GACpBM,EAAA,IAAAsP,EAAA,gBAAA5P,MAAa,QAAO,GAC/BM,EAAA,IAAAsP,EAAA,KAAA5P,KAAMA,EAAgB,sFAclBA,EAAK,GAAC,SAAW,GAAKA,EAAgB,KAAK,GAAC,CAAKA,EAAQ,sBAazD,CAAAvvD,GAAA6vD,EAAA,KAAAqP,OAAA3P,EAAK,GAAC,SAAW,GAC1BA,EAAgB,KAAKA,EAAK,GAAC,OAAS,IACnCA,EAAQ,wCAjCFA,EAAQ,GAAG,iBAAmB,ibAd5CA,EAAS,IAAAG,GAAAH,CAAA,+GAATA,EAAS,8LA4BY9rE,GAAC,CACfA,EAAE,eAAc,EAChBA,EAAE,gBAAe,MAWHA,GAAC,CACfA,EAAE,eAAc,EAChBA,EAAE,gBAAe,MAuBPA,GAAC,CACfA,EAAE,eAAc,EAChBA,EAAE,gBAAe,MAmBHA,GAAC,CACfA,EAAE,eAAc,EAChBA,EAAE,gBAAe,MAvFLA,GAAC,CACfA,EAAE,eAAc,EAChBA,EAAE,gBAAe,wDAnJjB27E,EAAK,GACLf,EAAW,GACXD,EAAW,GACXiB,EAAmB,EACnBC,EACAC,EAAiC,GACjCvqD,EAAY,GACZwnD,EAAW,GACXoC,EAA8B,WAC5B,MAAAY,MAA2B/C,GAE3BgD,EAAY,SAChBL,EAAM,OAAS,EAACA,CAAA,EACZ,IAAAM,EAAoB,EACpBpB,EAAI,GACF,MAAAvoB,EAAOumB,GAAQC,EAAY,EAAI,EAC/BoD,EAAS,IAAOtB,EAAW,GAAKD,CAAW,EAAE,QAAO,OACnDuB,EAAU,OAAS,GAAC,OACnBhD,EAAQgD,EAAU,IAAG,EACrBC,EACJhD,GAAiBD,EAAQ5mB,CAAI,EAAIkmB,GAAmBlmB,CAAI,EACtD2pB,EAAYE,EAAa,GAAMrD,IAEjC6C,EAAM,KAAKd,EAAK,SAAO,EACvBA,EAAI,GACJoB,EAAY,GAEdpB,EAAK,KAAK3B,CAAM,EAChB+C,GAAaE,EAEXtB,EAAK,SAAW,GAClBc,EAAM,KAAKd,EAAK,SAAO,GAI3BxN,GAAc,UAAS,MAAQ7uE,GAAK,KAClC+yB,EAAY/yB,EAAM,SAAS,MAC3Bu6E,EAAWv6E,EAAM,QAAQ,MACzB28E,EAAW38E,EAAM,kBAAkB,EACnCu9E,EAAW,MAAK,YACL7C,KAAS16E,EAAM,OACpB06E,IAAU,gBAAgB6C,EAAW,IAAI1D,GAAea,CAAK,GAEnE6C,EAAW,wBAAuB,MAClCpB,EAAY,OAAS,EAACA,CAAA,MACtBC,EAAY,OAAS,EAACA,CAAA,YACX1B,KAAS6C,EAAW,OAE3B7C,GACA,OAAO,UAAU,eAAe,KAAKA,EAAO,SAAS,GACrDA,EAAM,QAENyB,EAAY,KAAKzB,CAAK,EAEtB0B,EAAY,KAAK1B,CAAK,gBAK1B8C,EAAY,SAERJ,GAAoBD,EAAM,QAAM/P,EAAA,EAAEgQ,EAAmB,CAAC,EAC1DhQ,EAAA,EAAAkQ,EAAwBt9E,EAAM,OAAO,SAAS,cAAc,SACtD49E,GAAI,EACVtV,GAAkB+U,CAAW,IAKhB,eAAAQ,EAASr8E,EAAa,CACnCA,EAAE,eAAc,EAChBA,EAAE,gBAAe,EACb47E,IAAqB,OACvBA,IAAgBA,CAAA,QAIZQ,GAAI,EACVtV,GAAkB+U,CAAW,EAGhB,eAAAS,EAAQt8E,EAAa,CAClCA,EAAE,eAAc,EAChBA,EAAE,gBAAe,EACb47E,IAAqBD,EAAM,OAAS,OACtCC,IAAgBA,CAAA,QAIZQ,GAAI,EACVtV,GAAkB+U,CAAW,EAGzB,MAAAlC,EAAW,CAAIp7E,EAAaspD,EAAmBrpD,IAAY,IAC3DA,GAASu7E,GAAUv7E,CAAK,SAElBA,EAAK,KACN,YACH4wE,EAAe,mBAAqB,WAAUA,CAAA,YAE3C,YACHA,EAAe,mBAAqB,UAASA,CAAA,YAE1C,YACHA,EAAe,mBAAqB,UAASA,CAAA,sBAG7CA,EAAe,mBAAqB,WAAUA,CAAA,gBAI9CvnB,EAAM,yBAAyB,kBAAiB,OAC5C00B,EAAcnN,EAAe,YAC7B7uE,EAAK,SAAS,eACjB,IAAMg8E,GAAa,QAAQ,UAAW,EAAE,GAQvCh8E,GAAM,OACRA,EAAG,MAAK,EACJhC,EAAI,SAAWA,EAAI,UAAY,gBACjC8uE,GAAc,OAAQ7uE,IACpBA,EAAM,UAAY,GAClBA,EAAM,YAAc,GACbA,IAEAD,EAAI,SAAWA,EAAI,QAAQ,CAAC,IAAM,GAE3CgC,EAAG,eAAehC,EAAI,OAAO,EAE7BgC,EAAG,eAAc,CAAE,SAAUhC,EAAI,QAAUA,EAAI,OAAO,0DAmE1CyB,GAAC,CACjBA,EAAE,eAAc,EAChBA,EAAE,gBAAe,EACjBg8E,EAAY,EACZ7M,GAAA9B,GAAA+B,EAAe,SAAQ,CAAIA,EAAe,SAAAA,CAAA,QACpCgN,GAAI,EACVtV,GAAkB+U,CAAW,WAgBb77E,GAAC,CACjBA,EAAE,eAAc,EAChBA,EAAE,gBAAe,EACjB4rE,EAAA,EAAAkQ,EAAqB,CAAIA,CAAA,QACnBM,GAAI,EACVtV,GAAkB+U,CAAW,6CA7ErBA,EAAWhM,WAzJxB,OAAAjE,EAAA,EAAEkN,EAAa,CAAC,oMCFZhN,EAAa,oCAabA,EAAa,+BAjBNh7B,EAAA47B,EAAA,QAAAgO,GAAA5O,EAAW,IAAI,GACnB,SACA,IAAE,uPANoBA,EAAW,oCAiB7Bh7B,EAAAi8B,EAAA,QAAAyP,GAAA1Q,EAAW,GAAG,GAClB,SACA,IAAE,0RAN0BA,EAAW,wGAlBjDV,EA6BK7qB,EAAA0sB,EAAApmD,CAAA,EA1BH8lD,EAYKM,EAAA5B,CAAA,EARHsB,EAOKtB,EAAAqB,CAAA,gBAEPC,EAYKM,EAAAH,CAAA,EARHH,EAOKG,EAAAC,CAAA,6BAdFjB,EAAa,IAJNM,EAAA,GAAAsO,QAAA5O,EAAW,IAAI,GACnB,SACA,IAAE,wLANoBA,EAAW,mBAqBpCA,EAAa,IAJNM,EAAA,GAAAoQ,QAAA1Q,EAAW,GAAG,GAClB,SACA,IAAE,6LAN0BA,EAAW,4DAtBpC,YAAA2Q,CAAmB,EAAAlR,GACnB,cAAAmR,CAAqB,EAAAnR,8gBCGrB,uBAAAoR,CAAsB,EAAApR,EAC3B,MAAAqR,EAAWC,GAAqB,EAElC,IAAAC,EAAU,EACR,MAAAC,EAAWJ,EACb,IAAAD,EAAgB,GAChBD,EAAc,EAEdO,EAAW,OAAO,YAAY,IAAG,EACjCC,YACOC,GAAM,CACT,MAAA/kE,EAAO,OAAO,YAAY,IAAG,EAG/B,GAFJ2kE,GAAW3kE,EAAO6kE,EAEdF,EAAUC,EACZI,EAAc,OAEdF,EAAQ,sBAAsBC,CAAM,EAC9B,MAAAE,EAAQxb,GAAoBmb,EAAWD,CAAO,EAC9CO,EAAa,CACjBD,EAAM,QAAQ,SAAQ,EAAG,SAAS,EAAG,GAAG,EACxCA,EAAM,QAAQ,SAAQ,EAAG,SAAS,EAAG,GAAG,CACxC,OAAK,GAAG,EAEVxR,EAAA,EAAA8Q,EAAgBW,CAAa,EAC7BzR,EAAA,EAAA6Q,GAAeM,EAAWD,GAAWC,CAAQ,EAC7CC,EAAW7kE,aAIFglE,EAAc,KACrBF,GAAO,qBAAqBA,CAAK,EACrCA,EAAQ,OACRL,EAAS,UAAS,CAChB,MAAO,WACP,QAAAE,EACA,SAAAC,EAAQ,GAGZ,OAAApO,GAAS,KACHsO,GAAO,qBAAqBA,CAAK,EACrCA,EAAQ,6VCuCO,SAAAnR,KAAUA,EAAC,KACX,SAAAA,KAAUA,EAAC,wBACD,cACR,QACN,UACG,QAAAA,OAAYA,EAAC,UACfA,EAAC,wFANEM,EAAA,IAAAkR,EAAA,SAAAxR,KAAUA,EAAC,MACXM,EAAA,IAAAkR,EAAA,SAAAxR,KAAUA,EAAC,MAIZM,EAAA,KAAAkR,EAAA,QAAAxR,OAAYA,EAAC,uJA5BA,uBAAAA,KAAkB,kDAC9BA,EAAQ,+DAKb,6HAeC,MAAMA,EAAiB,IAAE,KAAI,yBAAtC,OAAInoE,GAAA,qgBARJmtC,EAAAu6B,EAAA,QAAAkS,EAAA,mIAAAzR,EAAc,GAAC,WAAS,CAAKA,EAAc,GAAC,SAC1C,uBACA,SACFA,EAAc,GAAC,WAAaA,EAAc,GAAC,SACzC,uBACA,SACDA,EAAc,GAAC,UAAuB,GAAX,UAAa,WAgBRh7B,EAAAi8B,EAAA,QAAAyP,EAAA,+BAAA1Q,EAAc,GAAC,WAClDA,EAAc,GAAC,SACX,QACA,SAAKA,EAAc,GAAC,WAAS,CAAKA,EAAc,GAAC,SACjD,QACA,GAAE,mJA9CVV,EA2DK7qB,EAAAusB,EAAAjmD,CAAA,EAxDH8lD,EAYKG,EAAAJ,CAAA,wCACLC,EAuBKG,EAAAzB,CAAA,0DACLsB,EAiBKG,EAAAC,CAAA,2DAnDwBX,EAAA,IAAAoR,EAAA,uBAAA1R,KAAkB,oGAqBlC,MAAMA,EAAiB,IAAE,KAAI,sBAAtC,OAAInoE,GAAA,iHAAJ,OAAIA,EAAAq2E,EAAA,OAAAr2E,GAAA,aARJ,CAAA4Y,GAAA6vD,EAAA,IAAAmR,OAAA,mIAAAzR,EAAc,GAAC,WAAS,CAAKA,EAAc,GAAC,SAC1C,uBACA,SACFA,EAAc,GAAC,WAAaA,EAAc,GAAC,SACzC,uBACA,SACDA,EAAc,GAAC,UAAuB,GAAX,UAAa,mJAgBR,CAAAvvD,GAAA6vD,EAAA,IAAAoQ,OAAA,+BAAA1Q,EAAc,GAAC,WAClDA,EAAc,GAAC,SACX,QACA,SAAKA,EAAc,GAAC,WAAS,CAAKA,EAAc,GAAC,SACjD,QACA,yFAnBF,OAAInoE,GAAA,uUArEG,MAAA2nE,CAAe,EAAAC,EACf,iBAAAkS,EAA0B,EAAE,EAAAlS,GAC5B,aAAAmS,CAAwB,EAAAnS,EAC/BhvD,EAAkB,GACX,UAAAynC,CAAmB,EAAAunB,GACnB,UAAArN,CAAmB,EAAAqN,QACxBgF,EAA4BvsB,EAAU,WACxC25B,EAEJ5O,GAAW,WACH6O,EAAiB,IAAO,OAAO,MAAM,oBAAmB,CAC5D,QAAS,GAAI,EAEf,SAAS,cAAcA,CAAiB,IAGjC,SAAAC,EAAS79E,EAAc,CACxB,MAAA89E,EAAK,SAAS99E,EAAE,OAAO,QAAQ,EAC/BkE,EAAK,SAASlE,EAAE,OAAO,OAAO,EACpCmvE,GAAA7d,GAAA4d,EAAY,uBACVhrE,GAAM45E,EAAK,EAAI,KAAK,OAAOA,EAAK55E,GAAM,GAAI,EAAAgrE,CAAA,EAC5C2C,EAAe,WAORA,GAAe,CAClB3C,EAAY,eACdwO,EAAY,EAEd9R,EAAA,EAAAN,EAAQ,KAAK,WAGNmD,GAAY,CACflyD,EAAUg0D,EAAoB,GAChC3E,EAAA,EAAArvD,GAAW,CAAC,4CAUAohE,EAAc9N,iDA+CxB8N,EAAe,eAAc,ybC3CvB7R,EAAK,GAAGA,KAAO,CAAC,EAAIA,KAAO,CAAC,yOAfmHA,EAAU,8BAAyBA,EAAA,GACtL,kBACA,uBACDA,EAAU,GAAG,kBAAoB,GAAE,2BACnBA,EAAK,GAAGA,KAAO,CAAC,EAAIA,KAAO,CAAC,kGAPtCA,EAAU,kBAWbA,EAAQ,KAAK,KACjB,OACA,QAAM,sBAAqBA,EAAQ,wEAAmEA,EAAA,GACtG,kBACA,kBAAiB,4DArB6BA,EAAY,YAAlEV,EA0BK7qB,EAAA8qB,EAAAxkD,CAAA,EAzBH8lD,EAcQtB,EAAAa,CAAA,EAPNS,EAMIT,EAAA,UAENS,EASKtB,EAAAqB,CAAA,mCApBQZ,EAAM,kLAIwIA,EAAU,8BAAyBA,EAAA,GACtL,kBACA,uBACDA,EAAU,GAAG,kBAAoB,iCACjBA,EAAK,GAAGA,KAAO,CAAC,EAAIA,KAAO,CAAC,oEAPtCA,EAAU,mBAkBXA,EAAK,GAAGA,KAAO,CAAC,EAAIA,KAAO,CAAC,OAAAY,EAAA,UAAA2M,iBAP9BvN,EAAQ,KAAK,KACjB,OACA,QAAM,sBAAqBA,EAAQ,wEAAmEA,EAAA,GACtG,kBACA,4FArB8CA,EAAY,8EArCrD,OAAAiS,EAAM,CAAc,GAAI,EAAE,GAAAxS,EAC1B,OAAA/sE,EAAiB,EAAI,EAAA+sE,EACrB,YAAAyS,EAAsB,EAAK,EAAAzS,EAC3B,cAAA0S,EAAuB,EAAE,EAAA1S,EACzB,UAAA2S,EAAmB,IAAI,EAAA3S,EACvB,YAAA4S,EAAqB,IAAI,EAAA5S,GACzB,GAAAt9D,EAAa,UAAYkzD,GAA+B,GAAAoK,EAE7D,MAAAqR,EAAWC,GAAqB,WAE7BuB,GAAM,CACbxS,EAAA,EAAAptE,GAASA,CAAK,EACdo+E,EAAS,QAAQ,ofC2FT9Q,EAAO,8FANH,wKAoCF,0ZAzCVV,EAOK7qB,EAAAmsB,EAAA7lD,CAAA,uBACLukD,EA6BK7qB,EAAA8qB,EAAAxkD,CAAA,+JA1BGilD,EAAO,wWAqBEuN,EAAAgF,GAAavS,EAAS,GAACA,EAAO,IAAGA,KAAQA,EAAO,sCAN3D;AAAA,aAEE,mCACcA,EAAO,mHALCA,EAAO,iHAD/BV,EAWK7qB,EAAAt8B,EAAA4C,CAAA,SANH8lD,EAKM1oD,EAAAojC,CAAA,wBADG+kB,EAAA,KAAAiN,OAAAgF,GAAavS,EAAS,GAACA,EAAO,IAAGA,KAAQA,EAAO,WAAAzkB,EAAA,UAAAgyB,2BAH3CvN,EAAO,mDALCA,EAAO,6EAXpB,SAAAA,KAAUA,EAAO,IACjB,SAAAA,KAAUA,EAAO,IACP,mBAAAA,KAAqBA,EAAO,IACpC,WAAAA,KAAYA,EAAO,SACzB,qBACG,SACFA,EAAO,sBAGZ,IAAAD,EAAAC,MAAY,eAAawS,GAAAxS,CAAA,2HATjBM,EAAA,MAAAkR,EAAA,SAAAxR,KAAUA,EAAO,KACjBM,EAAA,MAAAkR,EAAA,SAAAxR,KAAUA,EAAO,KACPM,EAAA,MAAAkR,EAAA,mBAAAxR,KAAqBA,EAAO,KACpCM,EAAA,MAAAkR,EAAA,WAAAxR,KAAYA,EAAO,qBAGxBA,EAAO,cAGZA,MAAY,0OAiCdD,EAAAC,MAAY,eAAaC,GAAAD,CAAA,wCAwBxB,+CACA,uCAHWA,EAAiB,uBAAjBA,EAAiB,mEAYvB,MAAMA,EAAiB,KAAE,KAAI,yBAAtC,OAAInoE,GAAA,sHApBN,UACU,kBAEJmoE,EAAI,+wBAzBZV,EAIK7qB,EAAAmsB,EAAA7lD,CAAA,WACLukD,EAgCK7qB,EAAAusB,EAAAjmD,CAAA,wBAlBH8lD,EAQKG,EAAAzB,CAAA,SAJKsB,EAGRtB,EAAAhkB,CAAA,gBAEFslB,EAQKG,EAAAC,CAAA,uBAEP3B,EAwEI7qB,EAAAg+B,EAAA13D,CAAA,gEAtGGilD,MAAY,sFAiBXA,EAAI,4CAKOA,EAAiB,6CAYvB,MAAMA,EAAiB,KAAE,KAAI,sBAAtC,OAAInoE,GAAA,qHAAJ,0LA9BA,UACU,kBAEJmoE,EAAK,oNANXV,EAQK7qB,EAAAt8B,EAAA4C,CAAA,SAJK8lD,EAGR1oD,EAAAojC,CAAA,6BADIykB,EAAK,mJAkDHV,EAEI7qB,EAAAuvB,EAAAjpD,CAAA,0OAbJukD,EASQ7qB,EAAA2rB,EAAArlD,CAAA,wGAgBH23D,EAAAC,GAAgB3S,EAAS,GAACA,OAAI,EAAK,aASnC4S,EAAA5S,KAAqBA,EAAC,YAEtB6S,EAAA7S,KAAYA,EAAC,kBAcX8S,EAAAP,GAAavS,EAAS,GAACA,EAAC,KAAGA,KAAQA,EAAC,6BAnDxC,OAAAA,KAAkBA,EAAC,KAAAE,mEALdU,EAAA,wBAAAZ,MAAI,CAAC,4HAkDjB;AAAA,eAEE,0GAjDQh7B,EAAAu6B,EAAA,QAAAkS,EAAAzR,MAAY,cAAgB,eAAiB,QAAQ,8IAuBnDgB,EAAA,OAAA+R,EAAA,CAAA/S,KAAkBA,EAAC,MAC3BA,EAAiB,GAACA,QAClBA,EAAiB,yKAOTmB,EAAA,OAAA6R,EAAA,CAAAhT,KAAkBA,EAAC,MAC3BA,EAAiB,GAACA,QAClBA,EAAiB,uBAgBLA,EAAC,mHAROA,EAAC,KACfh7B,EAAAiuC,EAAA,QAAAC,EAAAlT,MAAY,gBAAa,CAC/BA,EAAiB,GAACA,SAAOA,EAAiB,KACxC,oFACA,QAAQ,iGAtDlBV,EAiEI7qB,EAAAyG,EAAAngC,CAAA,EAhEF8lD,EA0BK3lB,EAAA+lB,CAAA,EAzBHJ,EAIKI,EAAAL,CAAA,SACLC,EAmBKI,EAAA1B,CAAA,qBAEPsB,EAoCK3lB,EAAAi4B,CAAA,EAnCHtS,EAQKsS,EAAAnS,CAAA,uBACLH,EAUKsS,EAAAhS,CAAA,kCACLN,EAcKsS,EAAAF,CAAA,SANHpS,EAKMoS,EAAA13B,CAAA,+FAtDE+kB,EAAA,MAAAmR,OAAAzR,MAAY,cAAgB,eAAiB,0BA4B9CM,EAAA,GAAAoS,OAAAC,GAAgB3S,EAAS,GAACA,OAAI,EAAK,QAAAgB,EAAA,UAAA0R,GALhCpS,EAAA,MAAAyS,OAAA,CAAA/S,KAAkBA,EAAC,MAC3BA,EAAiB,GAACA,QAClBA,EAAiB,mBAYZM,EAAA,GAAAsS,OAAA5S,KAAqBA,EAAC,UAAAoT,EAAA,EAAAR,CAAA,EAEtBtS,EAAA,GAAAuS,OAAA7S,KAAYA,EAAC,UAAAqT,EAAA,EAAAR,CAAA,EAPVvS,EAAA,MAAA0S,OAAA,CAAAhT,KAAkBA,EAAC,MAC3BA,EAAiB,GAACA,QAClBA,EAAiB,mBAmBVM,EAAA,IAAAwS,OAAAP,GAAavS,EAAS,GAACA,EAAC,KAAGA,KAAQA,EAAC,YAAAzkB,EAAA,UAAAu3B,GAVrCxS,EAAA,MAAA4S,OAAAlT,MAAY,gBAAa,CAC/BA,EAAiB,GAACA,SAAOA,EAAiB,KACxC,oFACA,6EAjJXA,EAAW,IAAC,gBAAkB,SAAOsT,GAAAtT,CAAA,IA+CrCA,EAAW,IAAC,gBAAkB,YAAUG,GAAAH,CAAA,4JAnD3CA,EAAW,IAAC,gBAAkB,QAC5B,kBACA,gBAAe,UAJrBV,EAsKK7qB,EAAAt8B,EAAA4C,CAAA,sDAhKEilD,EAAW,IAAC,gBAAkB,yGA+C9BA,EAAW,IAAC,gBAAkB,iOAnDjCA,EAAW,IAAC,gBAAkB,QAC5B,kBACA,6HA/CKuS,GAAa75B,EAAkB/D,EAAc,CAC/C,OAAAA,EACD+D,EAAS,SAAS,UAAU,GAC5BA,EAAS,SAAS,mBAAmB,EAAU/D,EAC/C+D,EAAS,SAAS,mBAAmB,MAC5B/D,EAAO,MAAM,GAAG,EAAE,CAAC,SAASA,EAAO,MAAM,GAAG,EAAE,CAAC,KACxD+D,EAAS,SAAS,QAAQ,GAAKA,EAAS,SAAS,cAAc,GAE/DA,EAAS,SAAS,WAAW,GAC7BA,EAAS,SAAS,kBAAkB,EAAU/D,EAC3C,IAAM4+B,GAAqB5+B,EAAQ,EAAK,EAAI,IAT/B,SAYb,SAAAg+B,GAAgBnsE,EAAcgtE,EAAwB,GAAI,WACtDhtE,GAAS,SAAQ,MAAS,MACjCA,EAAK,SAAS,aAAa,SACtB+sE,GAAqB/sE,EAAMgtE,CAAY,EAC5C,GAAAhtE,EAAK,SAAS,mBAAmB,SAAUitE,GAAuBjtE,CAAI,EACtE,GAAAA,EAAK,SAAS,SAAS,SAAUktE,GAAYltE,CAAI,EAC/C,MAAA4F,EAAQ,wCACP,OAAA5F,EAAK,QAAQ4F,EAAO,OAAO,EAG3B,SAAAsnE,GAAYltE,EAAY,CACzB,MAAA4F,EAAQ,gCACP,OAAA5F,EAAK,QAAQ4F,EAAO,EAAE,EAGtB,SAAAmnE,GAAqB/sE,EAAcgtE,EAAwB,GAAI,eAC3DhtE,GAAS,SAAiB,IACjCgtE,IAAchtE,EAAOA,EAAK,QAAQ,MAAO,EAAE,GACxCA,EACJ,QAAQ,8BAA+B,EAAE,EACzC,QAAQ,QAAS,OAAO,GAGpB,SAAAitE,GAAuBjtE,EAAY,WAC/BA,GAAS,SAAQ,MAAS,GAC/B,MAAA4F,EAAQ,8BACP,OAAA5F,EAAK,QAAQ4F,EAAO,EAAE,2EA5E3B,IAAAqE,EAAkB,GACX,UAAAynC,CAAmB,EAAAunB,GACnB,UAAArN,CAAmB,EAAAqN,GACnB,YAAApN,CAAqB,EAAAoN,GACrB,qBAAAnN,CAA8B,EAAAmN,GAC9B,QAAAzD,CAAiB,EAAAyD,GACjB,kBAAAiF,CAA4B,EAAAjF,GAC5B,KAAApzD,CAAY,EAAAozD,GACZ,MAAAyB,CAAa,EAAAzB,QAClBgF,EAA4BvsB,EAAU,OACtCy7B,MAAmC,MAAMlP,CAAiB,EAAE,KAAK,EAAK,EAExE,IAAAmP,EAAoB,GAExBlU,GAAO,KACC,MAAAsD,EAAkB,SAAS,eAC/B,eAAe,EAEbA,GACFhI,GAAkBgI,CAAe,IAIrCC,GAAW,KACH,MAAA4Q,EAAkB,SAAS,iBAC/B,0BAA0B,UAEnBh8E,EAAI,EAAGA,EAAIg8E,EAAgB,OAAQh8E,IAAC,OACrCstC,EAAU0uC,EAAgBh8E,CAAC,EACjCmjE,GAAkB71B,CAAO,QAErB2sC,EAAiB,IAAO,OAAO,MAAM,oBAAmB,CAC5D,QAAS,GAAI,EAEf,SAAS,cAAcA,CAAiB,oEAkIrB8B,EAAiBlhF,sBA2BpBotE,EAAA,EAAA6T,EAAkB97E,CAAC,GAAK87E,EAAkB97E,CAAC,EAAA87E,CAAA,2hBC3L/D,IAAIG,GAAc,SAAS,SAAS,WAAa,eAEjD,GAAIA,GAAa,CACf,MAAMC,EAAQ,OAAO,KAAO,OAAO,MAAQ,GAC3CA,EAAK,KAAK,CAAC,eAAe,CAAC,EACzB,UAAY,CACZ,MAAMrpE,EAAI,6BACVqpE,EAAK,KAAK,CAAC,gBAAiBrpE,EAAI,YAAY,CAAC,EAC7CqpE,EAAK,KAAK,CAAC,YAAa,GAAG,CAAC,EAC5B,MAAM1kE,EAAI,SACJ7K,EAAI6K,EAAE,cAAc,QAAQ,EAC5B,EAAIA,EAAE,qBAAqB,QAAQ,EAAE,CAAC,EAC5C7K,EAAE,MAAQ,GACVA,EAAE,IAAMkG,EAAI,YACR,EAAE,YACJ,EAAE,WAAW,aAAalG,EAAG,CAAC,CAElC,GACF,CAEA8/C,GAAS,eAAe,EAExB,MAAM0vB,GAAsB,GACtBC,GAAkB,GAClBC,GAAqB,GACrBxvB,GAAgB,CAAC,EAAE,EACnBD,GAAqB,CAAC,EAAE,EAE9B,SAAS0vB,GAAYruB,EAAwB,CAC3C,MAAMsuB,EAeF,CAAE,KAAMtuB,EAAM,MAClB,OAAIA,EAAM,cAAasuB,EAAI,GAAKtuB,EAAM,aAClCA,EAAM,OAAMsuB,EAAI,EAAItuB,EAAM,MAC1BA,EAAM,MAAKsuB,EAAI,EAAItuB,EAAM,KACzBA,EAAM,UAASsuB,EAAI,GAAKtuB,EAAM,SAC9BA,EAAM,KAAIsuB,EAAI,EAAItuB,EAAM,IACxBA,EAAM,MAAKsuB,EAAI,GAAKtuB,EAAM,IAAI,QAAQ,OAAQ,GAAG,EAAE,QAAQ,QAAS,GAAG,GACvEA,EAAM,OAAMsuB,EAAI,GAAKtuB,EAAM,KAAK,QAAQ,OAAQ,GAAG,EAAE,QAAQ,QAAS,GAAG,GACzEA,EAAM,OAAMsuB,EAAI,GAAKtuB,EAAM,KAAK,QAAQ,OAAQ,GAAG,EAAE,QAAQ,QAAS,GAAG,GACzEA,EAAM,OAAMsuB,EAAI,GAAKtuB,EAAM,KAAK,QAAQ,OAAQ,GAAG,EAAE,QAAQ,QAAS,GAAG,GACzEA,EAAM,OAAMsuB,EAAI,GAAKtuB,EAAM,KAAK,QAAQ,OAAQ,GAAG,EAAE,QAAQ,QAAS,GAAG,GACzEA,EAAM,OAAMsuB,EAAI,EAAItuB,EAAM,MAC1BA,EAAM,aAAYsuB,EAAI,EAAItuB,EAAM,YAChCA,EAAM,YAAWsuB,EAAI,EAAItuB,EAAM,WAC5BsuB,CACT,CAEAnuB,GAAc,UAAWxwD,GAAY,CAGnC,GAFA6uD,GAAS,gBAAiB7uD,CAAO,EAE7BA,EAAS,CACX,GAAIA,EAAQ,IAAM,OAAW,OAC7B,GAAIivD,GAAI,CAAC,KAAOjvD,EAAQ,GAAK,QAAS,CACpC6uD,GAAS,0BAA0B,EACnC,MACF,CAEAI,GAAI,CAAC,EAAIjvD,EAAQ,GAAK,OACtB2uD,GAAI,MAAOM,GAAI,CAAC,CAAC,EACb,OAAO,MAAM,OAAO,KAAK,KAAK,CAAC,aAAc,MAAOA,GAAI,CAAC,CAAC,CAAC,EAE3DjvD,EAAQ,WAAUgvD,GAAS,CAAC,EAAIhvD,EAAQ,UAC5C2uD,GAAI,WAAYK,GAAS,CAAC,CAAC,EAEvB,OAAO,MAAQhvD,EAAQ,UACzB,OAAO,KAAK,KAAK,CAAC,qBAAsB,EAAGA,EAAQ,QAAQ,CAAC,EAG9D,MAAM4+E,EAAsB,GAC5B,QAASx8E,EAAI,EAAGA,EAAIm8E,GAAU,OAAQn8E,IAAK,CACzC,MAAMy8E,EAAY,KAAK,MAAMN,GAAUn8E,CAAC,CAAC,EAEzCusD,GAAIM,GAAI,CAAC,EAAI,IAAM4vB,EAAU,KAAM,OAAQN,GAAUn8E,CAAC,CAAC,EACnD6sD,GAAI,CAAC,IAAM,IACb2vB,EAAU,KACR3vB,GAAI,CAAC,EACH,IACA4vB,EAAU,MACT7vB,GAAS,CAAC,EAAI,IAAMA,GAAS,CAAC,EAAI,IAE3C,CAGAI,GAAUwvB,EAAWH,EAAQ,EAAE,QAAS9uB,GAAW,CACjD,GAAIA,EAAO,WAAa,EACtB,QAAS7pD,EAAI,EAAGA,EAAI6pD,EAAO,WAAY7pD,IACrC24E,GAAS,KAAK9uB,EAAO,KAAK,EAC1BhB,GAAI,WAAYgB,EAAO,MAAO,eAAe,EACzC,OAAO,MACT,OAAO,KAAK,KAAK,CAAC,aAAc,UAAWA,EAAO,KAAK,CAAC,UAEnDA,EAAO,WAAa,EAC7B,QAAS7pD,EAAI,EAAGA,EAAI,KAAK,IAAI6pD,EAAO,UAAU,EAAG7pD,IAAK,CACpD,MAAMjH,EAAQ4/E,GAAS,YAAY9uB,EAAO,KAAK,EAC3C9wD,EAAQ,KACV4/E,GAAS,OAAO5/E,EAAO,CAAC,EACxB8vD,GAAI,iBAAkBgB,EAAO,MAAO,aAAa,EAErD,CAEJ,CAAC,EACDd,GAAS,YAAa4vB,EAAQ,CAChC,CACF,CAAC,EAEDvuB,GAAgB,UAAWxuD,GAAW,CAEpC,GADAmtD,GAAS,kBAAmBntD,CAAM,EAC9BA,EAAQ,CACV,MAAMk9E,EAAsB,GAC5Bl9E,EAAO,QAAS2uD,GAAU,CAEpBmuB,GAAM,SAASnuB,EAAM,IAAI,EAC3BxB,GAAS,oBAAqBwB,EAAM,IAAI,GAExCmuB,GAAM,KAAKnuB,EAAM,IAAI,EACjB,OAAO,MAAM,OAAO,KAAK,KAAK,CAAC,aAAc,OAAQA,EAAM,IAAI,CAAC,EACpE1B,GAAI,SAAW0B,EAAM,IAAI,GAGvBpB,GAAI,CAAC,IAAM,IACb2vB,EAAU,KACR3vB,GAAI,CAAC,EAAI,IAAMoB,EAAM,MAAQrB,GAAS,CAAC,EAAI,IAAMqB,EAAM,SAAW,KAEtE,MAAMsuB,EAAMD,GAAYruB,CAAK,EACzBkuB,GAAU,SAAS,KAAK,UAAUI,CAAG,CAAC,EACxC9vB,GAAS,eAAgBwB,EAAM,IAAI,GAEnCkuB,GAAU,KAAK,KAAK,UAAUI,CAAG,CAAC,EAE9B1vB,GAAI,CAAC,IAAM,IACbN,GAAIM,GAAI,CAAC,EAAI,IAAM0vB,EAAI,KAAM,OAAQ,KAAK,UAAUA,CAAG,CAAC,EAE9D,CAAC,EAED,QAASv8E,EAAIm8E,GAAU,OAAS,EAAGn8E,GAAK,EAAGA,IACzC,GACE,CAACV,EAAO,KACL2uD,GAAU,KAAK,UAAUquB,GAAYruB,CAAK,CAAC,IAAMkuB,GAAUn8E,CAAC,GAE/D,CACA,MAAMunD,EAAM40B,GAAU,OAAOn8E,EAAG,CAAC,EACjCusD,GAAI,oBAAqBhF,CAAG,CAC9B,CAEFkF,GAAS,aAAc0vB,EAAS,EAChC,QAASn8E,EAAIo8E,GAAM,OAAS,EAAGp8E,GAAK,EAAGA,IACrC,GAAI,CAACV,EAAO,KAAM2uD,GAAUA,EAAM,OAASmuB,GAAMp8E,CAAC,CAAC,EAAG,CACpD,MAAMunD,EAAM60B,GAAM,OAAOp8E,EAAG,CAAC,EAC7BusD,GAAI,gBAAiBhF,CAAG,CAC1B,CAEFkF,GAAS,SAAU2vB,EAAK,EACxBpvB,GAAUwvB,EAAWH,EAAQ,EAAE,QAAS9uB,GAAW,CACjD,GAAIA,EAAO,WAAa,EACtB,QAAS7pD,EAAI,EAAGA,EAAI6pD,EAAO,WAAY7pD,IACrC24E,GAAS,KAAK9uB,EAAO,KAAK,EAC1BhB,GAAI,WAAYgB,EAAO,MAAO,eAAe,EACzC,OAAO,MACT,OAAO,KAAK,KAAK,CAAC,aAAc,UAAWA,EAAO,KAAK,CAAC,UAEnDA,EAAO,WAAa,EAC7B,QAAS7pD,EAAI,EAAGA,EAAI,KAAK,IAAI6pD,EAAO,UAAU,EAAG7pD,IAAK,CACpD,MAAMjH,EAAQ4/E,GAAS,YAAY9uB,EAAO,KAAK,EAC3C9wD,EAAQ,KACV4/E,GAAS,OAAO5/E,EAAO,CAAC,EACxB8vD,GAAI,iBAAkBgB,EAAO,MAAO,aAAa,EAErD,CAEJ,CAAC,EACDd,GAAS,YAAa4vB,EAAQ,CAChC,CACF,CAAC,EAEM,SAASK,GAAgB9vB,EAAkBC,EAAa,CAC7DJ,GAAS,uBAAuB,EAChC,QAASzsD,EAAI,EAAGA,EAAIq8E,GAAS,OAAQr8E,IAAK,CACxC,MAAMk6D,EAAOmiB,GAASr8E,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,EACjC,OAAO,MACT,OAAO,KAAK,KAAK,CACf,aACA,WACA6sD,EAAM,IAAMqN,GAAQtN,EAAW,IAAMA,EAAW,IACjD,EAEHL,GAAIM,EAAM,IAAMqN,EAAM,WAAYtN,EAAW,IAAMA,EAAW,EAAE,CAClE,CACF,wDC2RwB,SAAAub,KAAY,+JAAZM,EAAA,MAAAkU,EAAA,SAAAxU,KAAY,uiBAOZA,EAAW,GAAC,kBAAoB,mOAAhCA,EAAW,GAAC,kBAAoB,qPAQ5BA,EAAgB,WAAYA,EAAS,kcAUnDA,EAAgB,WACjBA,EAAS,6XA3Bfc,GAAAd,EAAK,KAAK,SAAWA,OAAU,kBAAewS,GAAAxS,CAAA,EAG9Ce,EAAAf,OAAU,aAAWsT,GAAAtT,CAAA,EAGrByU,EAAAzU,OAAU,QAAMC,GAAAD,CAAA,EAShB0U,EAAA1U,OAAU,OAAKE,GAAAF,CAAA,EAGf2U,EAAA3U,OAAU,aAAWG,GAAAH,CAAA,kmBAtBlBh7B,EAAAg8B,EAAA,QAAA4T,GAAA5U,EAAS,GAAC,SACd,OACA,IAAE,sFAHRV,EAoDK7qB,EAAAusB,EAAAjmD,CAAA,gHAjBH8lD,EAgBKG,EAAAC,CAAA,EAfHJ,EAcOI,EAAAv7C,CAAA,EAVLm7C,EAKCn7C,EAAAshB,CAAA,EADgBA,EAAA,QAAAg5B,KAAU,gBAG3Ba,EAAyDn7C,EAAAk7C,CAAA,SAEzDC,EAA2Dn7C,EAAA65C,CAAA,kDA5C1DS,EAAK,KAAK,SAAWA,OAAU,8GAG/BA,OAAU,0GAGVA,OAAU,qGASVA,OAAU,oGAGVA,OAAU,kHAqBMh5B,EAAA,QAAAg5B,KAAU,WA3CvB,CAAAvvD,GAAA6vD,EAAA,KAAAsU,QAAA5U,EAAS,GAAC,SACd,OACA,IAAE,+XApcF,IAAAR,EAAkB,gBAClBJ,EAAS,GACTlnB,EAAS,GACTka,EAAS,GACTC,EAAW,GACXC,EAAoB,GACpBE,EAAc,GACdC,EAAwB,GACxBiS,EAAiB,GACjB1I,EAAO,GACP6Y,EACJnV,GAAO,UAsDD,GAnDJla,GAAW,UAAW9yD,GAAK,QACzB8sE,EAAQ9sE,EAAM,KAAK,EACf,EAAAA,EAAM,QAAU,aAAeA,EAAM,QAAU,kBAC/CyjE,GAAoB,SAAW,EAGxB,WAAArQ,MAASsZ,EAClBtZ,GAAM,WAAa,GAGV,UAAA3vD,MAAYggE,GAAmB,IACpChgE,GAAS,UAAY,OAAS,CAChC6lE,EAAQ,KAAK,EAAE,WAGX,MAAA0L,EAAO,OAAO,KAAKvxE,GAAS,OAAO,KACrCuxE,EAAK,OAAS,EAAC,CACX,MAAAt7D,EAAQ,cACR3Z,GAAMi1E,EAAK,KAAM9tE,GAAMwS,EAAM,KAAKxS,CAAC,GACzCoiE,EAAQ,KAAKvpE,GAAM0D,GAAS,QAAQ1D,EAAG,EAAI,EAAE,UACpCi1E,EAAK,SAAW,EAAC,CACpB,MAAAh1E,EAAQyD,GAAS,QAAQuxE,EAAK,CAAC,MACjCh1E,GAAA,MAAAA,EAAO,SAAS,kBAAgB,CAClCspE,EAAQ,KAAK,aAAa,QACpBjgB,GAAK,IAAO,YAAY2rB,EAAK,CAAC,GAAK,OAAQh1E,EAAK,EACtD,SAAS,cAAcqpD,EAAK,OAE5BigB,EAAQ,KAAKtpE,EAAQyD,GAAS,QAAQuxE,EAAK,CAAC,GAAK,EAAE,OAGrD1L,EAAQ,KAAK,EAAE,EAGnB,QAAQ,KAAK,UAAWA,CAAO,GAE3B5F,IAAA,YAAAA,GAA4B,qBAAsB,YACpDsO,EAAoBtO,GAA2B,iBAAiB,GAC9DA,IAAA,YAAAA,GAA4B,YAAa,SAC3Cye,EAA2Bze,GAA2B,aAE1DphE,GAAQ,YAAc,GAEtBixD,GAAc,OAAQ6uB,IACpBA,EAAK,eAAiB,IACfA,IAGT1V,EAAS,MAAS,QAAQ,IAAI9N,GAAkB,GAEhD6J,GAAqCl9B,GAAI0nB,EAAe,GAEpDyd,EAAY,cAAa,OAC3BE,EAAe,UAAY,GAAIA,CAAA,EACpB,UAAAxd,KAASsZ,EAClBtZ,EAAM,WAAa,SAIjBivB,EAAe5iB,GAA4BiN,CAAS,MAC1DlnB,EAAS,IAAO68B,EAAa,SAAS,OACtC3iB,EAAS,IAAO2iB,EAAa,SAAS,OACtC1iB,EAAW,IAAO0iB,EAAa,WAAW,OAC1CziB,EAAoB,IAAOyiB,EAAa,oBAAoB,GAC5DviB,EAAc,IAAOuiB,EAAa,cAAc,EAChDtiB,EAAwB,IAAOsiB,EAAa,wBAAwB,UAC3Dl9E,EAAI,EAAGA,EAAIqgD,EAAU,OAAQrgD,IACpCurE,EAAY,kBAAkB,KAAK,EAAK,aAmBnCwO,GAAY,sBACnB2C,GAAgBS,EAAe,UAAY,GAAIA,EAAe,GAAK,EAAE,QAC/DC,EAAW,WACRp9E,EAAI,EAAGA,EAAIqgD,EAAU,OAAQrgD,IAAC,CAC/B,MAAA1B,EAAWipE,EAAU5M,EAAe36D,CAAC,GACrClE,KACJwgD,IAAAF,GAAAp/C,GAAAC,GAAAqB,EAAS,iBAAT,YAAArB,GAA0B29D,EAAyB56D,CAAC,KAApD,YAAAhD,EAAwD,UAAxD,YAAAo/C,EAAiE,QAAjE,YAAAE,GACI,mBAAoBh+C,EAAS,eAC/B,GAAAxC,KAAS,YAAcA,KAAS,iBAClCmsE,EAAA,EAAA4E,EAAkB7sE,CAAC,EAAI,IACrBw8C,EAAAqB,GAAsBv/C,EAAUs8D,EAAyB56D,CAAC,KAA1D,MAAAw8C,EAA8D,MAAIqwB,CAAA,EAGpEuQ,EAAYp9E,CAAC,GACX,KAAAlE,GACA,MAAOkE,EACP,QAAO,CACC,MAAA26D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,KACnD1B,EAAS,aACFq8D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,MAG1D,UACE1B,EAAS,QAAQ,KACVq8D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,MAG1DioE,EAAA,EAAA9D,EAAQnkE,CAAC,EAAIo9E,EAAYp9E,CAAC,EAAE,UAASmkE,CAAA,UAC5BroE,KAAS,UAClB+wE,EAAkB7sE,CAAC,EAAIsoD,GACrBhqD,EACAs8D,EAAyB56D,CAAC,GAC1B,KAAI6sE,CAAA,EAENuQ,EAAYp9E,CAAC,GACX,KAAAlE,GACA,MAAOkE,EACP,QAAS,OAAO,KAAK1B,EAAS,SAAO,IAClC,OACE1D,GACCA,EAAI,WAAU,iBACK+/D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,MAElEpF,EAAI,WAAU,aACC+/D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,MAGjE,OAAQ,CAAA/B,EAAgC8D,MACvC9D,EAAO8D,EAAC,EAAIzD,EAAS,QAASyD,EAAC,EACxB9D,OAEX,UAAW,OAAO,KAAKK,EAAS,SAAO,IACpC,OAAQ1D,GACPA,EAAI,WAAU,aACC+/D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,MAG/D,OAAQ,CAAA/B,EAAgB8D,MACvB9D,EAASK,EAAS,QAASyD,EAAC,EACrB9D,GACN,KAEPgqE,EAAA,EAAA9D,EAAQnkE,CAAC,EAAIo9E,EAAYp9E,CAAC,EAAE,UAASmkE,CAAA,EACrCiZ,EAAYp9E,CAAC,EAAE,QAAQ,KAChB26D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,KAClDo9E,EAAYp9E,CAAC,EAAE,kBACVlE,KAAS,MAAK,KACvB+wE,EAAkB7sE,CAAC,EACjByhD,GAAiBnjD,EAAUs8D,EAAyB56D,CAAC,KAAO,KAAI6sE,CAAA,QAE5DvsB,EACJhiD,EAAS,eAAes8D,EAAyB56D,CAAC,GAAG,aACjDq9E,GAAU,GAChB/8B,EAAc,QAAO,CAAEuB,GAAaC,KAAc,CAE9CxjD,EAAS,QAAQ,KACVq8D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,KAAK8hD,EAAM,MAC3D,KAEFD,GAAY,QAAU,QACxBw7B,GAAW,KAAKx7B,GAAY,KAAK,IAIvComB,EAAA,EAAA9D,EAAQnkE,CAAC,EAAIq9E,GAAW,KAAK,KAAK,EAAAlZ,CAAA,EAClC7lE,EAAS,QAAQ,KACVq8D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,KAClDmkE,EAAQnkE,CAAC,EACbo9E,EAAYp9E,CAAC,GACX,KAAAlE,GACA,MAAOkE,EACP,QAAS,OAAO,KAAK1B,EAAS,SAAO,IAClC,OAAQ1D,IACPA,GAAI,WAAU,KACP+/D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,MAGvD,OAAQ,CAAA/B,GAAgC8D,MACvC9D,GAAO8D,EAAC,EAAIzD,EAAS,QAASyD,EAAC,EACxB9D,QAEX,UAAWkmE,EAAQnkE,CAAC,EAEb,SAAAlE,KAAS,sBAClB+wE,EAAkB7sE,CAAC,EACjB8kD,GACExmD,EACAs8D,EAAyB56D,CAAC,KACtB,KAAI6sE,CAAA,MACZ1I,EAAQnkE,CAAC,IACP08C,GAAAp+C,EAAS,UAAT,YAAAo+C,GAAgB,KACTie,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,SAEtDs9E,EAAAh/E,EAAS,UAAT,YAAAg/E,EAAgB,KACT3iB,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,OAEtD,GAAEmkE,CAAA,EACJiZ,EAAYp9E,CAAC,GACX,KAAAlE,GACA,MAAOkE,EACP,QAAS,OAAO,KAAK1B,EAAS,SAAO,IAClC,OACE1D,GACCA,EAAI,WAAU,KACP+/D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,MAEtDpF,EAAI,WAAU,KACP+/D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,MAGzD,OAAQ,CAAA/B,EAAgC8D,MACvC9D,EAAO8D,EAAC,EAAIzD,EAAS,QAASyD,EAAC,EACxB9D,OAEX,UAAWkmE,EAAQnkE,CAAC,WAEblE,KAAS,mBAClB+wE,EAAkB7sE,CAAC,EACjBsqD,GAA0BhsD,EAAUs8D,EAAyB56D,CAAC,KAC9D,KAAI6sE,CAAA,MACN1I,EAAQnkE,CAAC,EAAIsqE,GACXhsE,EACAs8D,EAAyB56D,CAAC,GAAAmkE,CAAA,EAE5BiZ,EAAYp9E,CAAC,GACX,KAAAlE,GACA,MAAOkE,EACP,QAAS,OAAO,KAAK1B,EAAS,SAAO,IAClC,OAAQ1D,GACPA,EAAI,SAAQ,KACL+/D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,MAGvD,OAAQ,CAAA/B,EAAgC8D,MACvC9D,EAAO8D,EAAC,EAAIzD,EAAS,QAASyD,EAAC,EACxB9D,OAEX,UAAWkmE,EAAQnkE,CAAC,WAEblE,KAAS,SAAQ,CAGtB,GAAAwC,aAAoB4mD,GAAY,OAC5BjnD,EAASK,EAAS,uBACtBs8D,EAAyB56D,CAAC,GAC1B46D,EAAyB56D,CAAC,GAC5B,MAAM,QAAQ/B,CAAM,EACfgqE,EAAA,EAAA4E,EAAkB7sE,CAAC,EAAI/B,EAAO,SAAS,IAAI,EAAA4uE,CAAA,EAC3C5E,EAAA,EAAA4E,EAAkB7sE,CAAC,EAAI/B,IAAW,KAAI4uE,CAAA,OAErC,MAAA5uE,EAASK,EAAS,sBACtBs8D,EAAyB56D,CAAC,GAE5B,MAAM,QAAQ/B,CAAM,EACfgqE,EAAA,EAAA4E,EAAkB7sE,CAAC,EAAI/B,EAAO,SAAS,IAAI,EAAA4uE,CAAA,EAC3C5E,EAAA,EAAA4E,EAAkB7sE,CAAC,EAAI/B,IAAW,KAAI4uE,CAAA,EAE7CuQ,EAAYp9E,CAAC,GACX,KAAAlE,GACA,MAAOkE,EACP,QAAS,OAAO,KAAK1B,EAAS,SAAO,IAClC,OACE1D,GACCA,EAAI,SAAQ,KACL+/D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,MAEtDpF,EAAI,WAAU,YACA+/D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,MAGhE,OAAQ,CAAA/B,EAAgC8D,MACvC9D,EAAO8D,EAAC,EAAIzD,EAAS,QAASyD,EAAC,EACxB9D,OAEX,UAAW,IAEbm/E,EAAYp9E,CAAC,EAAE,UAAY,OAAO,KAAKo9E,EAAYp9E,CAAC,EAAE,SAAO,IAC1D,OAAM,CAAEpF,EAAa6B,KAAkBA,KAAU,CAAC,EAClD,OAAQ,CAAAwB,EAAgB8D,MACvB9D,EAASm/E,EAAYp9E,CAAC,EAAE,QAAS+B,EAAC,EAC3B9D,GACN,QACLkmE,EAAQnkE,CAAC,EAAIo9E,EAAYp9E,CAAC,EAAE,UAAU,SAAS,gBAAgB,EAC3D,cACAo9E,EAAYp9E,CAAC,EAAE,kBAEnBo9E,EAAYp9E,CAAC,GACX,KAAM,UACN,MAAOA,EACP,QAAS,OAAO,KAAK1B,EAAS,SAAO,IAClC,OAAQ1D,GACPA,EAAI,SAAQ,KACL+/D,EAAe36D,CAAC,KAAK46D,EAAyB56D,CAAC,MAGvD,OAAQ,CAAA/B,EAAgC8D,MACvC9D,EAAO8D,EAAC,EAAIzD,EAAS,QAASyD,EAAC,EACxB9D,OAEX,UAAW,IAKX4uE,EAAkB7sE,CAAC,GAAK1B,EAAS,QAAU,QAC7CA,EAAS,QAKF,UAAA2vD,KAASsZ,EAClBtZ,EAAM,WAAa,SAEfsvB,EAAsB,GACnB,QAAAv9E,EAAI,EAAGw9E,EAAM,EAAGx9E,EAAIunE,EAAU,OAAQvnE,IAAC,OACxC2sD,GAAW4a,EAAUvnE,CAAC,UACnB0mB,EAAI,EAAGA,EAAIimC,GAAS,YAAajmC,IAAC,OACnC+2D,GAAK,CACT,KAAM9wB,GAAS,KACf,MAAOA,GAAS,MAChB,OAAQA,GAAS,eACjB,MAAO,OACP,KAAMA,GAAS,KACf,QAASywB,EAAYI,CAAG,EAAE,QAC1B,eAAgB3Q,EAAkB2Q,CAAG,EAAI,EAAI,EAC7C,kBAAmB,EACnB,UAAW3Q,EAAkB2Q,CAAG,EAAI,EAAI,EACxC,kBAAiB,CAAG3Q,EAAkB2Q,CAAG,GACzC,SAAU,KAAK,MACbjS,EAAY,kBAAoB,GAC9BA,EAAY,sBAAsB,GAGxCiS,IACAD,EAAuB,KAAKE,EAAK,MAGrCpsB,GAAkB,OAAQprD,IACxBA,EAAIs3E,EACGt3E,IAELk3E,EAAe,WAAa,SAAQ,CAEhC,MAAAngB,MADU,IAAI,OAAO,SAAS,IAAI,EACrB,aAAa,IAAI,QAAQ,EAC5C,QAAQ,KAAI,CACV,kBAAmB0gB,EACnB,SAAUC,EAAW,EACrB,OAAQ,iBACR,OAAA3gB,IAEF,OAAO,OAAO,aAEV,kBAAmB0gB,EACnB,SAAUC,EAAW,EACrB,OAAQ,iBACR,OAAA3gB,GAEF,aAEOmgB,EAAe,WAAa,WAAU,CAE7C,GAAAS,EAAgB,EAAKC,EAAa,GACjCD,EAAgB,IAAOC,MACtBtf,IAAA,MAAAA,GAA4B,YAC5BA,IAAA,YAAAA,GAA4B,UAAWof,EAAW,SAItDpe,GAAmC,CACjC,eAAgB,MAChB,eAAc,CACZ,SAAUoe,EAAW,EACrB,kBAAA9Q,eAMC8Q,GAAW,QACX,KAAK,MACVpS,EAAY,kBAAoB,GAAKA,EAAY,sBAAsB,WAQlE/B,GAAgB,CAEhB,OADOqU,EAAa,EACZ,IAAMhR,EAAkB,gBAGhCgR,GAAa,CAChB,IAAAxU,EAAQ,EACD,UAAAprE,KAAU4uE,EACf5uE,IAAW,IACborE,WAGGA,WAGAuU,GAAgB,CACnB,IAAAvU,EAAQ,MACR9K,IAAA,YAAAA,GAA4B,qBAAsB,iBACzCtgE,KAAUsgE,GAA2B,kBAC1CtgE,IAAW,IACborE,WAICA,WAMAyU,GAAS,OACV5gB,EACJ8f,GACAzR,EAAY,kBAAoB,GAAKA,EAAY,uBAC7C/2D,EAAOypD,GAAoBf,EAAc,GAAI,SAEjD1oD,EAAK,QAAQ,SAAQ,EAAG,SAAS,EAAG,GAAG,EACvCA,EAAK,QAAQ,SAAQ,EAAG,SAAS,EAAG,GAAG,CACvC,OAAK,GAAG,mHAgDSupE,EAAU,SAAQ,oICvhBzC,IAAIC,GAEG,SAASC,GAAYC,EAAa,CACvC,OAAOA,EAAM,WAAW,iBAAiB,SAAS,eAAe,EAAE,QAAQ,CAC7E,CAUO,SAASC,GACdxvE,EACAyvE,EACA1hB,EAAiB,EACT,CAEJshB,IAAU,OACZA,GAAS,SAAS,cAAc,QAAQ,GAE1C,MAAM7gF,EAA2C6gF,GAAO,WAAW,IAAI,EACvE,GAAI,CAAC7gF,EACH,MAAM,IAAI,MAAM,wBAAwB,EAE1C,OAAAA,EAAQ,KAAOihF,EACcjhF,EAAQ,YAAYwR,CAAI,EACtC,MAAQ+tD,CACzB,CACO,SAAS2hB,GAAY7hF,EAAsB2pC,EAAc,CAC9D,OAAO,OAAO,iBAAiB3pC,EAAS,IAAI,EAAE,iBAAiB2pC,CAAI,CACrE,CAYO,SAASm4C,GAAc/9E,EAAK,SAAS,KAAM,CAChD,MAAMg+E,EAAaF,GAAY99E,EAAI,aAAa,GAAK,SAC/Ci+E,EAAWH,GAAY99E,EAAI,WAAW,GAAK,OAC3Ck+E,EAAaJ,GAAY99E,EAAI,aAAa,GAAK,kBAErD,MAAO,GAAGg+E,CAAU,IAAIC,CAAQ,IAAIC,CAAU,EAChD,CCnDO,SAASC,IAA0B,CACxC,GAAI,CACF,cAAO,aAAa,QAAQ,WAAY,UAAU,EAClD,OAAO,aAAa,WAAW,UAAU,EAClC,EACT,MAAY,CACV,MAAO,EACT,CACF,CCNO,SAASC,GAAehyB,EAA4B,aACzD,GAAIA,GAAY,KAAM,MAAO,GAC7B,IAAIiyB,EAA6B,EACjC,GAAIjyB,EAAS,WAAY,CACvB,GAAI,CAACA,EAAS,gBAAkB,CAAC,MAAM,QAAQA,EAAS,cAAc,EACpE,MAAO,GAET,UAAWkyB,KAAYlyB,EAAS,eAE5BkyB,GAAY,MACZA,EAAS,SAAW,MACpBA,EAAS,QAAQ,OAAS,MAC1BA,EAAS,QAAQ,MAAM,kBAAoB,SAGzC7hF,GAAAC,EAAA4hF,EAAS,UAAT,YAAA5hF,EAAkB,QAAlB,YAAAD,EAAyB,oBAAqB,cAC9Cs/C,GAAAF,EAAAyiC,EAAS,UAAT,YAAAziC,EAAkB,QAAlB,YAAAE,EAAyB,oBAAqB,QAE9CsiC,IAIN,GACEjyB,EAAS,iBAAmB,UAC5B,gBAAiBA,GACjB,MAAM,QAAQA,EAAS,WAAW,EAElC,UAAWrc,KAAcqc,EAAS,YAC5B,MAAM,QAAQrc,CAAU,EAC1BsuC,GAAsBtuC,EAAW,OAEjCsuC,IAIN,OAAOA,CACT,CACA,MAAO,EACT,CCnCO,SAASE,IAA2B,CACzCrG,GAAA,EAAO,KAAK,IAAM,CAChB,GAAI,SAAS,cAAc,wBAAwB,EAAG,CACpD,SAAS,cACP,IAAI,OAAO,MAAM,uBAAwB,CAAE,QAAS,GAAM,GAE5D,MACF,CAEA,MAAMsG,EAAW,IAAI,iBAAiB,IAAM,CACtC,SAAS,cAAc,wBAAwB,IACjD,SAAS,cACP,IAAI,OAAO,MAAM,uBAAwB,CAAE,QAAS,GAAM,GAE5DA,EAAS,aAEb,CAAC,EACDA,EAAS,QAAQ,SAAS,KAAM,CAAE,UAAW,GAAM,QAAS,GAAM,CACpE,CAAC,CACH,8BCiBW1S,EAAAlE,KAAiB,EAAC,oHAQpBA,EAAK,mBAZIA,EAAwB,IAAIA,EAAQ,KAAK,aAC7C,SACA,eAAa,gJAJRA,EAAU,GAAG,OAAS,QAAQ,+BAUtBA,EAAwB,IAAIA,EAAQ,KAAK,aACxD,UACA,WAAS,4FAdIA,EAAc,oCARZA,EAAc,IACmCh7B,EAAA6xC,EAAA,QAAAC,EAAA,mEAAA9W,EAAA,GACpE,uBACA,wBAAuB,oCAL/BV,EA8BK7qB,EAAA0sB,EAAApmD,CAAA,EA7BH8lD,EA4BIM,EAAA0V,CAAA,EArBFhW,EAoBKgW,EAAA7V,CAAA,EAhBHH,EAQKG,EAAAzB,CAAA,EAPHsB,EAMKtB,EAAAqB,CAAA,gBAEPC,EAMKG,EAAAC,CAAA,mBATAX,EAAA,GAAA4D,OAAAlE,KAAiB,EAAC,KAAAsE,GAAAC,EAAAL,CAAA,eAJXlE,EAAwB,IAAIA,EAAQ,KAAK,aAC7C,SACA,eAAa,+JAJRA,EAAU,GAAG,OAAS,oCAchCA,EAAK,+BAJaA,EAAwB,IAAIA,EAAQ,KAAK,aACxD,UACA,WAAS,sDAdIA,EAAc,kDARZA,EAAc,iBACmCM,EAAA,GAAAwW,OAAA,mEAAA9W,EAAA,GACpE,uBACA,2FA3BK,yBAAA7W,CAAiC,EAAAsW,GACjC,SAAAvD,CAAgB,EAAAuD,GAChB,MAAApZ,CAAa,EAAAoZ,GACb,eAAAjN,CAAsB,EAAAiN,EACtB,YAAAsX,EAAa,EAAI,EAAAtX,slHCuBdz6B,EAAA5sB,EAAA,QAAA4+D,EAAA,KAAAhX,WAASA,EAAI,6HAHzBV,EAkEK7qB,EAAAr8B,EAAA2C,CAAA,EA7DH8lD,EAmCMzoD,EAAA6+D,CAAA,EAlCJpW,EAgBQoW,EAAAC,CAAA,EALNrW,EAIOqW,EAAAC,CAAA,EAETtW,EAgBQoW,EAAAG,CAAA,EALNvW,EAIOuW,EAAAC,CAAA,EAGXxW,EASGzoD,EAAA5T,CAAA,EARDq8D,EAGOr8D,EAAA8yE,CAAA,EACPzW,EACSr8D,EAAA+yE,CAAA,EACT1W,EACSr8D,EAAAgzE,CAAA,EAEX3W,EAGOzoD,EAAAq/D,CAAA,EACP5W,EAGOzoD,EAAAs/D,CAAA,EACP7W,EAGQzoD,EAAAu/D,CAAA,EAAA9W,EAGDzoD,EAAAw/D,CAAA,UA9DGtX,EAAA,GAAA0W,OAAA,KAAAhX,WAASA,EAAI,ygHAuEZh7B,EAAA5sB,EAAA,QAAA4+D,EAAA,KAAAhX,WAASA,EAAI,kLAH1BV,EAuEK7qB,EAAAr8B,EAAA2C,CAAA,EAlEH8lD,EAmCMzoD,EAAA6+D,CAAA,EAlCJpW,EAgBQoW,EAAAC,CAAA,EALNrW,EAIOqW,EAAAC,CAAA,EAETtW,EAgBQoW,EAAAG,CAAA,EALNvW,EAIOuW,EAAAC,CAAA,EAGXxW,EASGzoD,EAAA5T,CAAA,EARDq8D,EAGOr8D,EAAA8yE,CAAA,EACPzW,EACSr8D,EAAA+yE,CAAA,EACT1W,EACSr8D,EAAAgzE,CAAA,EAEX3W,EAGOzoD,EAAAq/D,CAAA,EACP5W,EAGOzoD,EAAAs/D,CAAA,EACP7W,EAGOzoD,EAAAu/D,CAAA,EACP9W,EAGOzoD,EAAAw/D,CAAA,EACP/W,EAGOzoD,EAAAy/D,CAAA,UAnEIvX,EAAA,GAAA0W,OAAA,KAAAhX,WAASA,EAAI,maA5EjBA,EAAe,GAAG,SAAW,OAAO,gBAuEnCA,EAAe,GAAG,QAAU,QAAQ,UAvElDV,EAsEK7qB,EAAAmsB,EAAA7lD,CAAA,0BACLukD,EA2EK7qB,EAAA8qB,EAAAxkD,CAAA,iJAlJQilD,EAAe,GAAG,SAAW,2IAuE5BA,EAAe,GAAG,QAAU,mLA7F7B,iBAAA8X,EAA2B,EAAK,EAAArY,EAChC,MAAAxhE,EAAe,CAAC,EAAAwhE,ksBCyEbz6B,EAAAggC,EAAA,QAAA+S,EAAA/X,KAAe,GAAK,OAAO,WAAa,IAC5C,UACA,WAAW,2NANnBV,EAoBK7qB,EAAAt8B,EAAA4C,CAAA,EAjBH8lD,EAUQ1oD,EAAA6sD,CAAA,EAHNnE,EAEImE,EAAAJ,CAAA,SAEN/D,EAAuC1oD,EAAA2sD,CAAA,SACvCjE,EAIQ1oD,EAAA8sD,CAAA,gEAfE3E,EAAA,KAAAyX,OAAA/X,KAAe,GAAK,OAAO,WAAa,IAC5C,UACA,oNA1CK,4CAcJ,KAAAA,EAAA,GACH,wBACA,0BACGA,EAAmB,GAAG,UAAY,4DAE9B,+BACAgY,GAAAhY,SAAuB,4DAaCA,EAAY,QAAU,WAExDA,EAAa,GAAC,WAAa,QAASG,GAAAH,CAAA,gJA3C9Bh7B,EAAA47B,EAAA,QAAAgO,EAAA,CAAA5O,KAAc,SAAWA,EAAa,GAAC,OAAS,IACrD,OACA,QAAQ,EAaJh7B,EAAAu6B,EAAA,QAAAkS,EAAAzR,KAAc,sBAAoB,CACzCA,EAAQ,GAAC,SACRA,EAAQ,GAAC,YAAcA,EAAQ,GAAC,QAAM,CAAMA,KAAS,YACnD,YACA,QAAQ,EAaJh7B,EAAAo7B,EAAA,QAAAiE,EAAArE,EAAa,GAAC,qBAAqBlrE,EAAAkrE,EAAQ,KAAR,MAAAlrE,EAAU,iBACjD,kDACA,QAAQ,EACDkwC,EAAAo7B,EAAA,WAAA6X,EAAAjY,EAAA,GACP,6BACA,mBAAmB,uBA9CwBh7B,EAAAi8B,EAAA,QAAAyP,EAAA,6CAAA1Q,KAAqB,GACtEA,EAAa,GAAC,WAAa,kBACvB,eACA,QAAM,kBAAgBA,EAAa,GAAC,WAAa,SACrDA,EAAa,GAAC,WAAa,QACvB,SACA,OAAM,UAPZV,EA4EK7qB,EAAAwsB,EAAAlmD,CAAA,EAnEH8lD,EAcKI,EAAAL,CAAA,qBACLC,EAgBKI,EAAA1B,CAAA,qBACLsB,EAWQI,EAAAb,CAAA,uEAHK4X,GAAAhY,SAAgB,sDAvClB,CAAAvvD,GAAA6vD,EAAA,GAAAsO,OAAA,CAAA5O,KAAc,SAAWA,EAAa,GAAC,OAAS,IACrD,OACA,sCAoBKM,EAAA,KAAA4X,EAAA,KAAAlY,EAAA,GACH,wBACA,oCACGA,EAAmB,GAAG,UAAY,sBAVnC,CAAAvvD,GAAA6vD,EAAA,GAAAmR,OAAAzR,KAAc,sBAAoB,CACzCA,EAAQ,GAAC,SACRA,EAAQ,GAAC,YAAcA,EAAQ,GAAC,QAAM,CAAMA,KAAS,YACnD,YACA,+DAsBiCA,EAAY,eATzC,CAAAvvD,GAAA6vD,EAAA,GAAA+D,OAAArE,EAAa,GAAC,qBAAqBlrE,EAAAkrE,EAAQ,KAAR,MAAAlrE,EAAU,iBACjD,kDACA,4BACO,CAAA2b,GAAA6vD,EAAA,IAAA2X,OAAAjY,EAAA,GACP,6BACA,yCAMDA,EAAa,GAAC,WAAa,kEApDiB,CAAAvvD,GAAA6vD,EAAA,GAAAoQ,OAAA,6CAAA1Q,KAAqB,GACtEA,EAAa,GAAC,WAAa,kBACvB,eACA,QAAM,kBAAgBA,EAAa,GAAC,WAAa,SACrDA,EAAa,GAAC,WAAa,QACvB,SACA,+OAnBO,SAAAxb,CAAsB,EAAAib,GACtB,mBAAA0Y,CAA0B,EAAA1Y,GAC1B,cAAAxZ,CAAqC,EAAAwZ,GACrC,QAAA2Y,CAAmB,EAAA3Y,GACnB,oBAAAlN,CAA4B,EAAAkN,GAC5B,wBAAA4Y,CAAmC,EAAA5Y,GACnC,aAAA9U,CAAqB,EAAA8U,GACrB,iBAAA6Y,CAA4B,EAAA7Y,GAC5B,aAAA8Y,CAAoB,EAAA9Y,GACpB,mBAAA+Y,CAAkD,EAAA/Y,eAuBvD2Y,EAAO,GA0CUK,EAAA,IAAAD,EAAmB,GAAG,EAOFE,EAAA,IAAAF,EAAmB,GAAG,6xBC3ClD9F,EAAA1S,KAAS,mBAAkB,SAQ7B4S,EAAAhgB,GAAuBoN,EAAQ,GAAC,iBAAiBA,EAAa,qQAlB3Dh7B,EAAA47B,EAAA,QAAAgO,EAAA5O,EAAQ,GAAC,mBAAmB,SAAW,EAC3C,2DACA,QAAQ,kBAPNh7B,EAAAi8B,EAAA,QAAAyP,EAAA1Q,EAAQ,GAAC,mBAAmB,SAAW,EAC3C,6IACA,QAAQ,uGAkBSA,EAAQ,GAAC,aAAe,CAAC,0lBAvB7Bh7B,EAAAmuC,EAAA,KAAAwF,EAAA,iBAAA3Y,SAAgBA,EAAa,YAFlDV,EAsCK7qB,EAAA0+B,EAAAp4D,CAAA,EAlCH8lD,EAkBKsS,EAAAlS,CAAA,EAbHJ,EAQKI,EAAAL,CAAA,EAHHC,EAEID,EAAA/oE,CAAA,SAENgpE,EAGKI,EAAA1B,CAAA,uBAEPsB,EAMKsS,EAAAnS,CAAA,uBACLH,EAIKsS,EAAAhS,CAAA,SACLN,EAEMsS,EAAAF,CAAA,UA3BM3S,EAAA,GAAAsO,OAAA5O,EAAQ,GAAC,mBAAmB,SAAW,EAC3C,2DACA,0BAQGM,EAAA,GAAAoS,OAAA1S,KAAS,mBAAkB,MAAAT,EAAA,UAAAmT,GAf5BpS,EAAA,GAAAoQ,OAAA1Q,EAAQ,GAAC,mBAAmB,SAAW,EAC3C,6IACA,0BAqBGM,EAAA,GAAAsS,OAAAhgB,GAAuBoN,EAAQ,GAAC,iBAAiBA,EAAa,WAAAgB,EAAA,UAAA4R,0BAHhD5S,EAAQ,GAAC,aAAe,CAAC,EAvB7BM,EAAA,GAAAqY,OAAA,iBAAA3Y,SAAgBA,EAAa,wDAL3CuN,EAAA3a,GAAuBoN,EAAQ,GAAC,eAAeA,EAAa,gBAEhEA,EAAmB,IAAAG,GAAAH,CAAA,iDANTh7B,EAAAkW,EAAA,KAAA09B,EAAA,WAAA5Y,SAAgBA,EAAa,sBACrBA,EAAQ,GAAC,SAAW,CAAC,4DAL/Bh7B,EAAA7sB,EAAA,KAAAq1D,EAAA,WAAAxN,SAAgBA,EAAa,+GAF5CV,EAqDK7qB,EAAAt8B,EAAA4C,CAAA,EAhDH8lD,EAMI1oD,EAAA+iC,CAAA,gDADKolB,EAAA,GAAAiN,OAAA3a,GAAuBoN,EAAQ,GAAC,eAAeA,EAAa,WAAA9kB,EAAA,UAAAqyB,GAJtDjN,EAAA,GAAAsY,OAAA,WAAA5Y,SAAgBA,EAAa,wCACrBA,EAAQ,GAAC,SAAW,CAAC,EAKvCA,EAAmB,6DAVXM,EAAA,GAAAkN,OAAA,WAAAxN,SAAgBA,EAAa,2EAR/B,SAAAxb,CAAsB,EAAAib,GACtB,cAAAoZ,CAAqB,EAAApZ,GACrB,cAAAqZ,CAAqB,EAAArZ,GACrB,oBAAAlN,CAA4B,EAAAkN,sbCkkB/BO,EAAmB,mBACNA,EAAa,KACjB,WAAAA,KAAqB,GAChCA,EAAc,IAAC,WAAa,6CACHA,EAAyB,MACzC,SAAAA,MAAe,gLALtBA,EAAmB,4BACNA,EAAa,gBACjB,WAAAA,KAAqB,GAChCA,EAAc,IAAC,WAAa,wDACHA,EAAyB,iBACzC,SAAAA,MAAe,gIAoCTuN,EAAAvN,KAAS,SAAQ,qIAL5BV,EAOK7qB,EAAAt8B,EAAA4C,CAAA,EANH8lD,EAKG1oD,EAAAiM,CAAA,wBADMk8C,EAAA,MAAAiN,OAAAvN,KAAS,SAAQ,MAAA57C,EAAA,UAAAmpD,0CAUjBA,EAAAvN,KAAS,aAAY,qIALhCV,EAOK7qB,EAAAt8B,EAAA4C,CAAA,EANH8lD,EAKG1oD,EAAAiM,CAAA,wBADMk8C,EAAA,MAAAiN,OAAAvN,KAAS,aAAY,MAAA57C,EAAA,UAAAmpD,+IAsBNvN,EAAgB,iPAAhBA,EAAgB,6HAYjC+Y,EAAA/Y,EAAoB,IAAG,EAC9B,eACA,gDAFH,WAAS,sCAJZV,EAOA7qB,EAAA2rB,EAAArlD,CAAA,4CALailD,EAAqB,mBAErBM,EAAA,SAAAyY,OAAA/Y,EAAoB,IAAG,EAC9B,eACA,eAAYsE,GAAA0U,EAAAD,CAAA,mHAzFnB/Y,EAAc,IAAC,WAAa,SAAWA,EAAc,IAAC,WAAa,SAAOsT,GAAAtT,CAAA,iCAiBzDA,EAAc,8DAGRA,EAAgB,mJAiBxBA,EAAQ,GAAC,SAAa,KAAeA,EAAQ,GAAC,SAAS,SAAW,GAACC,GAAAD,CAAA,EAU1EyU,EAAAzU,KAAS,cAAYE,GAAAF,CAAA,EAuBjBiZ,EAAAC,GAAAlZ,KAAS,cAAc,EAA6B,MAAAmZ,EAAAnZ,SAAgB,KAAOA,EAAQ,GAAC,MAAQ,oBAAjG,OAAInoE,GAAA,gDAYP,IAAA68E,EAAA1U,OAAiBA,EAAgB,IAAAG,GAAAH,CAAA,oTAJWA,EAAa,mBAdhDA,EAAQ,GAAC,eAAe,SAAW,GAAC,CAC3CA,EAAQ,GAAC,sBACN,YACA,gBAAc,+HARH,OAAO,WAAa,IACjCA,KAAa,SAAQ,EACrB,GAAG,iBAhCAA,EAAC,IACN,WACA,aAAW,oBAEboZ,EAAAC,EAAA,aAAArZ,EAAc,IAAC,GAAK,GACpB,SAAQ,oCAA4BA,EAAc,IAAC,GAAK,GAAC,kFApBhDA,EAAa,6GAfhCV,EA+FK7qB,EAAAw+B,EAAAl4D,CAAA,wBAnFH8lD,EAkFKoS,EAAA9R,CAAA,EAjFHN,EAgFKM,EAAAH,CAAA,qBAhEHH,EAqDSG,EAAAqY,CAAA,EA7CPxY,EAqBKwY,EAAAzY,CAAA,8CACLC,EAsBKwY,EAAApY,CAAA,EAjBHJ,EAgBII,EAAA5kB,CAAA,0DADFwkB,EAAgExkB,EAAAkjB,CAAA,uDA9ErES,EAAc,IAAC,WAAa,SAAWA,EAAc,IAAC,WAAa,mJAiBlDA,EAAc,oGAGRA,EAAgB,oFAiBxBA,EAAQ,GAAC,SAAa,KAAeA,EAAQ,GAAC,SAAS,SAAW,yDAUzEA,KAAS,kFAuBLiZ,EAAAC,GAAAlZ,KAAS,cAAc,+EAQaA,EAAa,uCAdhDA,EAAQ,GAAC,eAAe,SAAW,GAAC,CAC3CA,EAAQ,GAAC,sBACN,YACA,gBAAc,gKARH,OAAO,WAAa,IACjCA,KAAa,SAAQ,EACrB,GAAG,0BAhCAA,EAAC,IACN,WACA,aAAW,sDAEboZ,EAAAC,EAAA,aAAArZ,EAAc,IAAC,GAAK,GACpB,SAAQ,qDAA4BA,EAAc,IAAC,GAAK,GAAC,KAgDxDA,OAAiBA,EAAgB,4FApEzBA,EAAa,uEAwDlB,OAAInoE,GAAA,wUA3mBL,SAAA2sD,CAAsB,EAAAib,GACtB,cAAAoZ,CAAqB,EAAApZ,GACrB,mBAAA0Y,CAA0B,EAAA1Y,EAC1B,qBAAAlN,EAA+B,EAAK,EAAAkN,EAE3CgC,EACAroB,EACA2I,EACAw2B,EAAee,EAAiBT,CAAa,EAAE,MAAQ,EACvDluB,EAAenG,EAAS,aAAcA,GAAA,YAAAA,EAAU,iBAEhD+0B,EAAmBhnB,EAEnBlM,EACA2uB,EAAe,iBACjB3uB,EAAQ7B,EAAS,GACV,GAAAA,EAAS,GAAG,QAAQ,MAAO,EAAE,EAAE,QAAQ,MAAO,EAAE,OAAOA,EAAS,KAAK,GACxEA,EAAS,MAEb6B,EAAQ7B,EAAS,IAAM,SAGnBstB,EAAiB,IAAO,OAAO,MAAM,oBAAmB,CAC5D,QAAS,GAAI,EAGX,IAAA0H,GAA2C,MAAAnzB,CAAK,EAQhDozB,EAA+B,iBAEpBC,GAAW,CACpBl1B,GAAY,WAChBA,EAAS,eAAiBq0B,EAAar0B,CAAA,QACjCm1B,EAA4B,YAG3BC,GAAa,IAChB5E,EAAe,OAAS,KAAOA,EAAe,WAAa,WAAU,OACjE6E,EAAK,SAAS,cAClB,YAAcr1B,EAAS,eAAiB,IAAI,MAE1Cq1B,GAAA,YAAAA,EAAI,aAAc,gBAAe,OACtB,SAAS,iBAAiB,YAAY,EAC9C,QAASC,IAAK,CACnBA,GAAM,aAAa,WAAY,MAAM,IAIjC,MAAA9d,MAFU,IAAI,OAAO,SAAS,IAAI,EAEpB,aAAa,IAAI,SAAS,EACxC+d,EAAa/d,EAAU,KAAK,MAAMA,CAAO,EAAI,OAEjD,KAAK,UAAUgZ,EAAe,OAAO,IAAM,KAAK,UAAU+E,CAAU,SAEpE/E,EAAe,QAAU+E,EAAU/E,CAAA,EAErC7Z,GAAqCme,CAAgB,EACrD,QAAQ,IAAIriB,GAAoC8iB,CAAU,GAAG,KAAI,KAE3Dh4B,QACFyC,EAAS,OAAS,GAAIA,CAAA,EACtBzC,EAAY,MAAK,MAMzB8gB,GAAS,KACH,GAAcre,EAAS,GAE3BA,EAAS,OAAM,IAGjBkb,GAAO,UAEL,SAAS,iBAAiB,gBAAiB0Y,CAAO,EAClD,SAAS,iBAAiB,mBAAoB4B,CAAgB,EAC9D,SAAS,iBAAiB,sBAAuBC,CAAmB,EACpE,SAAS,iBAAiB,gBAAiBP,CAAW,EACtDQ,EAAa,EACTlF,EAAe,iBAAmB,IACpCgF,EAAgB,EACPhF,EAAe,iBAAmB,KAC3CiF,EAAmB,IAIvBjL,GAAY,UACN,GAAkBxqB,EAAS,QAC/Bi1B,EAAuBjD,GAAehyB,CAAQ,KAIhDye,GAAW,aAILze,UACI8rB,GAAI,EAGVsJ,EAAa,EAGb5e,GAAkByG,CAAW,EAG7BkY,EAA4B,EAGxBn1B,EAAS,YAAU,CAErBgd,GAAaC,CAAW,EAIpBjd,EAAS,iBAAmB,iBAAmB+0B,GACjDh3B,GAA4BiC,CAAQ,MAMlC+xB,GAAuB,GACvB/xB,EAAS,KAAO,QAChBA,EAAS,OAAS,QAClB,OAAO,aAAa,QAAO,GAAIA,EAAS,EAAE,IAAIA,EAAS,IAAI,KACzD,MAEF4zB,EAAO,QAEFlkF,GAAC,CACR,QAAQ,MAAMA,EAAC,GAOf,MAAAs/D,EAAciO,EAAY,uBAAuB,eAAe,EAC3D,UAAAhO,MAAcD,EAAW,CAC5B,MAAAE,EAAUD,GAAW,qBAAqB,KAAK,EAC1C,UAAAr7C,KAAOs7C,EAAO,CACnB,GAAAt7C,EAAI,aAAa,YAAY,IAAM,GAAK,CACpC,MAAAi7C,EAAgBj7C,EAAI,aAAa,OAAO,EAC9CA,EAAI,QAAQ,MAAQi7C,GAAiB,GAEnC,GAAAj7C,EAAI,aAAa,aAAa,IAAM,GAAK,CACrC,MAAAk7C,EAAiBl7C,EAAI,aAAa,QAAQ,EAChDA,EAAI,QAAQ,OAASk7C,GAAkB,GAEnC,MAAA/vC,EACJ,OAAOnL,EAAI,aAAa,YAAY,GAAK,OAAO48D,EAAe,CAAC,EAC5D9pE,GACJ,OAAOkN,EAAI,aAAa,aAAa,GAAK,OAAO48D,EAAe,CAAC,EACnE58D,EAAI,aAAa,QAASmL,EAAE,SAAQ,GACpCnL,EAAI,aAAa,SAAUlN,GAAE,SAAQ,IAGzC,SAAS,cAAc4mE,CAAiB,EACpCyH,GACF5C,GAAwB,mBAIbyB,GAAO,YACpB5zB,EAAS,OAAS,GAAKA,CAAA,EACnB+0B,GAAkBlB,EAAwB,EAAK,EAC7C,MAAAn2D,EAAO44C,GAAoB,MACjCtW,EAAS,KAAOtiC,EAAIsiC,CAAA,EAChBzC,GAAao4B,EAAe,IAC5BrlF,GAAAitD,GAAA,YAAAA,EAAa,UAAb,YAAAjtD,GAAsB,uBAAwB,KAEhDgrE,EAAA,EAAA/d,EAAY,QAAQ,oBAAsB,IAAGA,CAAA,EAE3C3I,GAAQ0mB,EAAA,EAAE1mB,EAAS,UAAY,GAAEA,CAAA,EACrC8gC,EAAa,iBAGAF,GAAgB,CACzBx1B,GAAA,MAAAA,EAAU,iBAAe,CAAKmG,IAChCmV,EAAA,EAAAnV,EAAe,EAAI,EACnBuvB,EAAa,kBAGFD,GAAmB,CAC5Bz1B,GAAA,MAAAA,EAAU,iBAAmBmG,IAC/BmV,EAAA,EAAAnV,EAAe,EAAK,EACpBuvB,EAAa,kBAWFA,GAAa,CAEtB11B,EAAS,eAAiB,WACxBA,EAAS,OAAS,YAAWA,EAAS,KAAOsW,GAAoB,EAAAtW,CAAA,EACrEvhB,GAAWuhB,EAAS,KAAI,CAAI,OAAQ,EAAI,GACxCkO,GAA6BlO,EAAQ,EAAImG,EAAckuB,CAAa,OAEtEr0B,EAAS,WAAamG,EAAYnG,CAAA,EAC9B80B,EAAiBT,CAAa,GAAK,OAGjCS,EAAiBT,CAAa,EAAE,OAASr0B,EAAS,MAAI6e,GAAA1d,GACxD2zB,EAAiBT,CAAa,EAAE,KAAOr0B,EAAS,KAAI80B,CAAA,EAClD3uB,GAAgB2uB,EAAiBT,CAAa,EAAE,aAAe,KAAGxV,GAAA1d,GACpE2zB,EAAiBT,CAAa,EAAE,WAAa,IAAGS,CAAA,EAC7C,CAAA3uB,GAAgB2uB,EAAiBT,CAAa,EAAE,aAAe,KAAGxV,GAAA1d,GACrE2zB,EAAiBT,CAAa,EAAE,WAAa,IAAGS,CAAA,EAEhDf,EAAe,GACfA,IAAiBe,EAAiBT,CAAa,EAAE,YAEjDS,EAAiBT,CAAa,EAAE,KAAON,EAAYe,CAAA,EAEnDf,GAAgB,GAChBe,EAAiBT,CAAa,EAAE,eAAe,MAAM,GACrDS,EAAiBT,CAAa,EAAE,OAAS,QAASxV,GAAA1d,GAElD2zB,EAAiBT,CAAa,EAAE,KAAO,OAASS,CAAA,OAEpD90B,EAAS,eAAiBq0B,EAAar0B,CAAA,EAErCA,IAAa,QACbA,EAAS,eAAiB,UAAQ,OAC3BA,EAAS,wBAA2B,aAEvCA,EAAS,OAAS,YAAWA,EAAS,KAAOsW,GAAoB,EAAAtW,CAAA,EACrEvhB,GAAWuhB,EAAS,KAAI,CAAI,OAAQ,EAAI,GACxCA,EAAS,uBAAuBq0B,CAAa,GAE/C1d,GAAqCme,CAAgB,QAC/CK,EAA4B,WAG3BS,GAAqB,UAExB51B,EAAS,gBAAkB,MAAUA,EAAS,SAAW,IAC3DD,GACEC,EACAwwB,EAAe,UAAY,GAC3BA,EAAe,GAAK,EAAE,MAE1BxwB,EAAS,OAAS,GAAIA,CAAA,EAClBwwB,EAAe,sBAAoBlV,EAAA,EAAEyZ,EAAmB,EAAI,EAC5D/0B,EAAS,gBAAkB,KAAI,OAC3B61B,KACJvlF,EAAAwkF,EAAiB90B,EAAS,cAAc,IAAxC,YAAA1vD,EAA2C,YAAa,GAClD,eAAAwlF,EAAgB,kBAAA7V,CAAiB,EAAK3iB,GAC5C0C,EACApL,EACA2I,CAAW,EAEPw4B,EAAkBD,GAAkBD,GAExCt4B,EAAY,QAAQ,sBAAwB,KAC5Cs4B,KAAsBC,GAMtB,OAAO,OAAM,0BACe91B,EAAS,cAAc,4BAA4B61B,EAAiB,MAAMC,CAAc,sCAEhH,IAAK91B,EACL,cAAewwB,EACf,gBAAiBsE,EACjB,kBAAmB/D,IAKrB,IAAA9d,GAAY4iB,MAEZE,IACF9iB,GAAY6iB,EACZ30B,GAAgB,OAAQ7nD,IACtBA,EAAE0mD,EAAS,cAAwB,EAAE,UAAYiT,GAC1C35D,IAETorD,GAAkB,OAAQprD,IACxBA,EAAE0mD,EAAS,cAAwB,GACjC,KAAMA,EAAS,KACf,MAAOA,EAAS,MAChB,OAAQA,EAAS,eACjB,MAAO,OACP,KAAMA,EAAS,KACf,QAASA,EAAS,QAClB,eAAA81B,EACA,kBAAA7V,EACA,UAAAhN,IAEK35D,KAIPk3E,EAAe,WAAa,SAAQ,CAEhC,MAAAngB,OADU,IAAI,OAAO,SAAS,IAAI,EACrB,aAAa,IAAI,QAAQ,EAC5C,QAAQ,KAAI,CACV,kBAAmB0gB,EACnB,OAAQ,iBACR,OAAA1gB,KAEF,OAAO,OAAO,aAEV,kBAAmB0gB,EACnB,OAAQ,iBACR,OAAA1gB,IAEF,aAEOmgB,EAAe,WAAa,WAAU,CAC3C,GAAAjzB,EAAY,QAAQ,sBAAwB,IAAG,CACjD,QAAQ,KACN,iFAAiF,SAIjFw4B,GACFnjB,GAAmC,CACjC,eAAgByhB,EAAa,aAO9BsB,GAAe,CACtBp4B,EAAY,UAAU,OAAM,GAAIA,EAAY,SAAS,MACrDA,EAAY,GAAE,gBAAmB82B,CAAa,GAAA92B,CAAA,EAC9CA,EAAY,UAAU,IACpB,eACA,OACA,SACA,QACA,OACA,OACA,sBACA,+BACA,wBACA,iCACA,cACA,UACA,gBACA,YACA,UACA,YACA,YACA,qCACA,8CACA,kBACA,qCACA,8CACA,kBACA,qBACA,eACA,sCACA,+CACA,mBACA,aACA,eACA,cACA,eAAe,iBAUJ43B,EACba,EAAsC,GAAK,YAErC,MAAAC,GACJ,SAAS,iBAA6B,aAAa,EAC/C14E,EAAO,OAAOizE,EAAe,GAAK,CAAC,EAErC,GAAAyF,IAAqB,MACnBA,GAAkB,SAAW,UAGtB7gF,EAAI,EAAGA,EAAI6gF,GAAkB,OAAQ7gF,IAAC,IACzC4gF,EAA0B,CAEtB,MAAAE,GAAeD,GAAkB7gF,CAAC,EAAE,aACxC,qBAAqB,EAEjB+gF,GAAgBF,GAAkB7gF,CAAC,EAAE,aACzC,sBAAsB,KAExB6gF,GAAkB7gF,CAAC,EAAE,aACnB,SACC,OAAO8gF,EAAY,EAAI34E,GAAM,UAAQ,EAExC04E,GAAkB7gF,CAAC,EAAE,aACnB,UACC,OAAO+gF,EAAa,EAAI54E,GAAM,UAAQ,EAIvC04E,GAAkB7gF,CAAC,GAAK,MACxB6gF,GAAkB7gF,CAAC,EAAE,eAAiB,KAAI,OAEpCghF,KACJ9lF,EAAA2lF,GACE7gF,CAAC,EACD,gBAFF,YAAA9E,EAEiB,iBACf,kBAAc,GAEP,UAAAiG,MAAO6/E,GAAa,CACvB,MAAA1mF,GAAI6G,GACV7G,GAAE,MAAM,YACN,OACC,OAAOA,GAAE,QAAQ,GAAG,EAAI6N,GAAM,SAAQ,EAAK,IAAI,EAElD7N,GAAE,MAAM,YACN,QACC,OAAOA,GAAE,QAAQ,IAAI,EAAI6N,GAAM,SAAQ,EAAK,IAAI,UASnD84E,IAAchmF,EAAA4lF,GAAkB7gF,CAAC,EACpC,QAAQ,SAAS,IADA,YAAA/E,EAEhB,cAAc,uBAGhBgmF,IACAJ,GAAkB7gF,CAAC,EAAE,YAAcihF,GAAY,YAAW,OAEpD/jE,GACH+jE,GAAY,YAAc,IAC3BJ,GAAkB7gF,CAAC,EAAE,YAEjB+e,GAAQ8hE,GAAkB7gF,CAAC,EAAE,aAAa,OAAO,EACjDgf,GAAS6hE,GAAkB7gF,CAAC,EAAE,aAAa,QAAQ,EACpD,CAAA6gF,GAAkB7gF,CAAC,EAAE,QAAQ,eAAiB+e,IAAS,OAC1D8hE,GAAkB7gF,CAAC,EAAE,QAAQ,cAAgB+e,IAC1C,CAAA8hE,GAAkB7gF,CAAC,EAAE,QAAQ,gBAAkBgf,IAAU,OAC5D6hE,GAAkB7gF,CAAC,EAAE,QAAQ,eAAiBgf,IAC1C,MAAAq7C,IACJ,OAAOwmB,GAAkB7gF,CAAC,EAAE,QAAQ,cAAc,EAClDmI,EACA+U,IACA,SAAQ,EACJo9C,IACJ,OAAOumB,GAAkB7gF,CAAC,EAAE,QAAQ,aAAa,EACjDmI,EACA+U,IACA,SAAQ,KACN6B,KAAUu7C,IACZumB,GAAkB7gF,CAAC,EAAE,aAAa,QAASs6D,EAAQ,EAEjDt7C,KAAWq7C,IACbwmB,GAAkB7gF,CAAC,EAAE,aAAa,SAAUq6D,EAAS,EAIrDwmB,GAAkB7gF,CAAC,GAAK,MACxB6gF,GAAkB7gF,CAAC,EAAE,gBAAkB,KAAI,OAErCghF,KACJ3mC,GAAAwmC,GACE7gF,CAAC,EACD,gBAFF,YAAAq6C,GAEiB,iBACf,kBAAc,GAEP,UAAAl5C,MAAO6/E,GAAa,CACvB,MAAA1mF,GAAI6G,GACJq5D,GAAa,OAAOlgE,GAAE,QAAQ,GAAG,GAAK,EACtCmgE,GAAc,OAAOngE,GAAE,QAAQ,IAAI,GAAK,EAC9CA,GAAE,MAAM,YACN,OACCkgE,GAAat9C,GAAO/U,GAAM,SAAQ,EAAK,IAAI,EAE9C7N,GAAE,MAAM,YACN,QACCmgE,GAAcv9C,GAAO/U,GAAM,SAAQ,EAAK,IAAI,MAW7D,OAAO,SAAQ,KACb43E,EAA6B,EAAI,YAG1BtB,EAAwByC,EAAmB,GAAI,CACtDhb,EAAA,EAAAyZ,GAAoBA,CAAgB,EAElCA,GACAhD,GAAuB,GACvB/xB,EAAS,KAAO,QAEhB,OAAO,aAAa,QAAO,GAAIA,EAAS,EAAE,IAAIA,EAAS,IAAI,GAAI,MAAM,EAGrEs2B,GAAO,CACN9F,EAAe,SAChBxwB,EAAS,YAAU,CAClB+0B,GAAgB,CAChB/0B,EAAS,QAEV4zB,EAAO,EAEL0C,GAASnB,EAA4B,WAGlCrB,GAAgB,CACnBiB,GAAkBlB,EAAuB,EAC7CvY,EAAA,EAAAnV,GAAgBA,CAAY,MAC5BnG,EAAS,WAAamG,EAAYnG,CAAA,QAClC80B,EAAiBT,CAAa,EAAE,WAAaluB,EAAe,IAAM,IAAG2uB,CAAA,EACrEY,EAAa,EAGN,SAAA1B,GAAmBuC,EAAoB,CAC1CA,IAAc,KAAGjb,EAAA,EAAEyY,IAAYA,CAAA,EAC/BwC,IAAc,KAAGjb,EAAA,EAAEyY,IAAYA,CAAA,EACnC2B,EAAa,4CAmFY9gC,EAAQ2qB,0EAQfhiB,EAAWgiB,sDAvFyBtC,EAAWsC,iQAvgB7DpZ,GAAgB5I,GAAao4B,EAAe,EAC3C,CAAAxvB,GAAgBvR,GAAQ0mB,EAAA,EAAE1mB,EAAS,UAAY,GAAEA,CAAA,sOCzDnD,SAAS4hC,GACdvpB,EACwB,CACxB,MAAMwpB,EAAiC,GACvC,UAAWr1B,KAAM6L,EACfwpB,EAAOr1B,EAAG,IAAI,EAAIq1B,EAAOr1B,EAAG,IAAI,EAAIq1B,EAAOr1B,EAAG,IAAI,EAAI,EAAI,EAE5D,OAAOq1B,CACT,CAEO,SAASC,GAAqBzpB,EAAyC,CAC5E,MAAM0pB,EAAsB1pB,EAAW,IAAKrtC,GAAMA,EAAE,IAAI,EAClDg3D,EAAkB,GACxB,SAAW,CAAC,EAAGx1B,CAAE,IAAK6L,EAAW,UAAW,CAC1C,MAAM4pB,EAAeF,EAAU,MAAM,EAAG,EAAI,CAAC,EAAE,OAAQzsE,GAC9CA,IAAMk3C,EAAG,IACjB,EAAE,OACHw1B,EAAM,KAAKC,CAAI,CACjB,CACA,OAAOD,CACT,6OCdoCp2C,EAAAo7B,EAAA,QAAAiE,EAAArE,EAAM,KAAK,EAAI,sBAAwB,EAAE,UAA7EV,EAIQ7qB,EAAA2rB,EAAArlD,CAAA,EAHN8lD,EAEIT,EAAAvoE,CAAA,qBAHamoE,EAAM,oBAAWM,EAAA,GAAA+D,OAAArE,EAAM,KAAK,EAAI,sBAAwB,8EAR9D,OAAArmB,CAAc,EAAA8lB,WAChB6b,GAAM,CACb31B,GAAgB,OAAQ7nD,GACfyrD,GAAazrD,EAAG67C,EAAQA,EAAS,CAAC,oXCQrC3U,EAAAo7B,EAAA,QAAAiE,EAAArE,OAAWA,EAAkB,GAAG,sBAAwB,EAAE,UAFpEV,EAOQ7qB,EAAA2rB,EAAArlD,CAAA,EAHN8lD,EAEIT,EAAAvoE,CAAA,qBALOmoE,EAAS,oBACZM,EAAA,GAAA+D,OAAArE,OAAWA,EAAkB,GAAG,sBAAwB,8EAXrD,OAAArmB,CAAc,EAAA8lB,GACd,mBAAA0Y,CAA0B,EAAA1Y,WAC5B8b,GAAS,CAChB51B,GAAgB,OAAQ7nD,GACfyrD,GAAazrD,EAAG67C,EAAQA,EAAS,CAAC,yPC6HpCqmB,EAAE,0GAACV,EAEJ7qB,EAAA8G,EAAAxgC,CAAA,oBAFCilD,EAAE,6EAgBEA,EAAa,qJAHhBV,EAIM7qB,EAAA8G,EAAAxgC,CAAA,+BADHilD,EAAa,oDAJbA,EAAa,KAAAsT,GAAAtT,CAAA,4BADjBA,EAAS,2CAJIA,EAAc,IAE7Bh7B,EAAA7sB,EAAA,QAAAsqD,EAAA,6HAAAzC,EAAE,IAAIA,EAAE,GAAC,SAAW,EAAI,UAAY,UAAS,UAH9CV,EAaK7qB,EAAAt8B,EAAA4C,CAAA,qDARFilD,EAAS,KACLA,EAAa,sFALJA,EAAc,iBAE7BM,EAAA,GAAAmC,OAAA,6HAAAzC,EAAE,IAAIA,EAAE,GAAC,SAAW,EAAI,UAAY,mRAuFoHA,EAAA,IAC/I,UACA,UAAS,sFALHA,EAAS,IAAG,UAAY,WAAS,uBAP/CV,EAcQ7qB,EAAA2rB,EAAArlD,CAAA,EALN8lD,EAIIT,EAAAvoE,CAAA,wMAHiJmoE,EAAA,IAC/I,UACA,gDALMA,EAAS,IAAG,UAAY,WAAS,4ZAoB/CV,EASQ7qB,EAAA2rB,EAAArlD,CAAA,qBALKilD,EAAM,mGA2BIA,EAAc,8BACXA,EAAc,qJADjBA,EAAc,wCACXA,EAAc,kNArJvCkE,EAAAlE,KAAiB,EAAC,iBASjBA,EAAa,wEANZc,GAAAd,EAAE,IAAIA,EAAE,GAAC,SAAW,GAACwS,GAAAxS,CAAA,4CAwEaA,EAAY,aAc9CA,EAAS,KAAAC,GAAAD,CAAA,KA2BTA,EAAW,KAAAE,GAAAF,CAAA,KA+BXA,EAAU,KAAAG,GAAAH,CAAA,oFAjJdA,EAAQ,gdANCA,EAAgB,IAAC,QAAU,EAC/B,SACA,QAAM,uZARDA,EAAc,IAqE8Hh7B,EAAA4/B,EAAA,QAAAC,EAAA,+IAAA7E,EAAA,IAC/I,mBACA,kBAAiB,EAnB2Bh7B,EAAAggC,EAAA,QAAA+S,EAAA,8CAAA/X,EAAgB,IAClEA,EAAA,GACI,GACA,SAAQ,EACDh7B,EAAAggC,EAAA,WAAAwW,EAAAxb,EAAA,IACP,wBACA,uBAAuB,mFAiBuBA,EAAc,IAAC,mBACjEA,EAAA,GACI,GACA,SAAQ,EACDh7B,EAAAigC,EAAA,WAAAwW,EAAAzb,EAAA,GACP,6BACA,mBAAmB,+LAayIA,EAAA,GAC1J,GACA,SAAQ,sbA2CoCA,EAAA,GAC9C,GACA,SAAQ,8mBAnJtBV,EA0KK7qB,GAAA0+B,EAAAp4D,EAAA,EAzKH8lD,EAwKIsS,EAAA0D,CAAA,EArKFhW,EAqCKgW,EAAA5V,CAAA,EAjCHJ,EAgBKI,EAAA1B,CAAA,EAbHsB,EAMKtB,EAAAqB,CAAA,0EAyBTC,EA8HKgW,EAAA5D,CAAA,EA3HHpS,EAkHKoS,EAAAjS,CAAA,EAtGHH,EAsBQG,EAAAgE,CAAA,EALNnE,EAIImE,EAAAJ,CAAA,SAEN/D,EAYQG,EAAAiE,CAAA,qBACRpE,EAWQG,EAAAkE,CAAA,EALNrE,EAIIqE,EAAAJ,CAAA,kCAmBNjE,EASQG,EAAAoE,CAAA,kCAaRvE,EAcQG,EAAA0a,EAAA,EAHN7a,EAEI6a,GAAArW,CAAA,SAGRxE,EAOKoS,EAAA9R,EAAA,mEA9EUnB,EAAgB,kBAQhBA,EAAO,kBA6BPA,EAAS,+CA9GnB,CAAAvvD,GAAA6vD,GAAA,IAAA4D,OAAAlE,MAAiB,EAAC,KAAAsE,GAAAC,EAAAL,CAAA,0BAJXlE,GAAgB,IAAC,QAAU,EAC/B,SACA,QAAM,8OAIXA,GAAQ,KACJA,GAAE,IAAIA,GAAE,GAAC,SAAW,wFAMrBA,GAAa,sFAnBNA,GAAc,mBAqE8H,CAAAvvD,GAAA6vD,GAAA,OAAAuE,OAAA,+IAAA7E,GAAA,IAC/I,mBACA,sCAnB4C,CAAAvvD,GAAA6vD,GAAA,KAAAyX,OAAA,8CAAA/X,GAAgB,IAClEA,GAAA,GACI,GACA,6BACO,CAAAvvD,GAAA6vD,GAAA,OAAAkb,OAAAxb,GAAA,IACP,wBACA,mFA2BiCA,GAAY,oFAVCA,GAAc,IAAC,mBACjEA,GAAA,GACI,GACA,6BACO,CAAAvvD,GAAA6vD,GAAA,GAAAmb,OAAAzb,GAAA,GACP,6BACA,sNAa4JA,GAAA,GAC1J,GACA,4BAGHA,GAAS,sEA2BTA,GAAW,wIAaoCA,GAAA,GAC9C,GACA,6BAgBDA,GAAU,iSAtPf,MAAA2b,GAAmB,uFAhBd,MAAAt1B,CAAyB,EAAAoZ,GACzB,GAAAt9D,CAAU,EAAAs9D,GACV,eAAAjN,CAAsB,EAAAiN,GACtB,mBAAA0Y,CAA0B,EAAA1Y,GAC1B,gBAAAmc,CAAwB,EAAAnc,EAExB,aAAAoc,EAAc,EAAI,EAAApc,EAClB,eAAAqc,EAAgB,EAAI,EAAArc,EACpB,iBAAAsc,EAAkB,EAAI,EAAAtc,EACtB,kBAAAuc,EAAmB,EAAI,EAAAvc,EACvB,cAAA9U,EAAwB,EAAK,EAAA8U,EAC7B,YAAAwc,EAAsB,EAAI,EAAAxc,EAC1B,aAAAyc,EAAuB,EAAI,EAAAzc,EAC3B,WAAA0c,EAAqB,EAAI,EAAA1c,EAChCh6C,EAAY,GACL,mBAAA22D,EAAoB,EAAI,EAAA3c,EAE/BlN,EAAsB,GAKtB8pB,EACAC,EAYE,MAAAC,EAAkB,OAAO,SAAUC,EAAe,GAClDC,EAAa,MAAM,KAAKvtB,OAAWwtB,EAAQ,GAAI,OAAM,GAAI,IAAKxoF,GAClEA,EAAE,IAAI,MAAM,OAEVb,EACAkpF,EAAgB,UAASznF,EAAAwkF,EAAiB9mB,CAAc,IAA/B,YAAA19D,EAAkC,IAAI,EACjEzB,EAAW,YACFopF,EAAW,UAAS5nF,GAAAykF,EAAiB9mB,CAAc,IAA/B,YAAA39D,GAAkC,IAAI,EACnExB,EAAW,QAEXA,EAAW,WAEP,MAAAy9E,EAAWC,GAAqB,WAE7BuH,GAAgB,CACvBxY,EAAA,EAAAnV,GAAgBA,CAAY,EAC5BmmB,EAAS,kBAAiB,CAAI,aAAAnmB,EAAY,WAGnCytB,GAAO,CACdtH,EAAS,cAAc,WAGhB6L,GAAM,CACbh3B,GAAgB,OAAQ7nD,GAAC,IACpBA,EAAE,MAAM,EAAG00D,CAAc,KACzB10D,EAAE,MAAM00D,EAAiB,CAAC,IAE/Bse,EAAS,iBAAiB,WAGnB8L,GAAS,CAChBj3B,GAAgB,OAAQ7nD,GAAC,OACjB++E,GAAW,IAAQ/+E,EAAE00D,CAAc,GACzC,OAAAqqB,GAAY,KAAO/hB,GAAoB,GAElC,GAAAh9D,EAAE,MAAM,EAAG00D,EAAiB,CAAC,EAChCqqB,GACG,GAAA/+E,EAAE,MAAM00D,EAAiB,CAAC,kBA6FzBsN,EAAA,GAAAvN,EAAmB,CAAIA,CAAA,EACvBue,EAAS,kBAAiB,CACxB,oBAAAve,EACA,iBAAAopB,EAAgB,YAuChB7b,EAAA,GAAAr6C,EAAS,CAAIA,CAAA,EACbqrD,EAAS,eAAc,CAAI,UAAArrD,EAAS,UAyCtCq6C,EAAA,EAAAsc,EAAiB,CAAIA,CAAA,EACrBtL,EAAS,gBAAe,CAAI,kBAAAsL,EAAiB,kpBAlOjD/1B,GAAA,MAAAA,EAAO,SAAS,KAAG,CACf,MAAAy2B,EAAUz2B,EAAM,MAAM,GAAG,OAC/Bi2B,EAAYQ,EAAQ,CAAC,QACrBT,EAAgBS,EAAQ,CAAC,aAEzBR,EAAYj2B,GAAS,EAAE,EACvByZ,EAAA,GAAAuc,EAAgB,EAAE,w7BC6Iarc,EAAa,4XAR5CV,EAeK7qB,EAAAt8B,EAAA4C,CAAA,EAdH8lD,EAIM1oD,EAAAojC,CAAA,SACNslB,EAQC1oD,EAAA6uB,CAAA,OAHcg5B,EAAW,6CACZA,EAAmB,4DAJJA,EAAa,uCAG3BA,EAAW,SAAXA,EAAW,2EAYZA,EAAQ,GAAC,6BAAgC,WAAS+c,GAAA/c,CAAA,sMAFxCA,EAAa,uFASdA,EAAa,0UAZtCV,EAiBK7qB,EAAAt8B,EAAA4C,CAAA,EAhBH8lD,EAOO1oD,EAAAuN,CAAA,wBACPm7C,EAOC1oD,EAAA6uB,CAAA,YAFgBg5B,EAAG,6CACNA,EAAmB,2BAVnBA,EAAQ,GAAC,6BAAgC,sGAF/BA,EAAa,oDASdA,EAAa,qCAEnBA,EAAG,6DARfA,EAAQ,GAAC,4BAA4B,CAAC,+BAAE,IAC3C,mDADGA,EAAQ,GAAC,4BAA4B,CAAC,OAAAsE,GAAAC,EAAAL,CAAA,2FAcxC8Y,GAAA,OAAAA,EAAA,QAAM,QAAQhd,MAAS,MAAM,uNA8B1BkE,EAAAlE,MAAS,MAAK,mEAAC,IACnB,4JAF0BA,EAAa,2DAKdA,EAAa,wXAI9Bh7B,EAAAgC,EAAA,MAAAi2C,EAAAjd,MAAS,MAAM,UAbzBV,EAiBK7qB,EAAAt8B,EAAA4C,CAAA,EAfH8lD,EAIO1oD,EAAAuN,CAAA,uBACPm7C,EASC1oD,EAAA6uB,CAAA,OAFcg5B,EAAG,6CACJA,EAAmB,oBAV7BM,EAAA,SAAA4D,OAAAlE,MAAS,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,sCADQlE,EAAa,sDAKdA,EAAa,iBAI9BM,EAAA,SAAA2c,OAAAjd,MAAS,6CACFA,EAAG,SAAHA,EAAG,wDAlC2BkE,EAAAlE,MAAS,MAAK,qBAShDkd,EAAAhE,GAAAlZ,MAAS,MAAM,uBAApB,OAAInoE,GAAA,+EATkD,IAAE,kMAAlCmoE,EAAa,0ZAKdA,EAAa,IACvBA,EAAG,aAAAmd,GAAA,IAAAnd,EAAA,SAAAnkB,CAAA,wCATcmkB,EAAa,0DADjDV,EAsBK7qB,EAAAt8B,EAAA4C,CAAA,EArBH8lD,EAoBM1oD,EAAAilE,CAAA,EAnBJvc,EAGAuc,EAAA13D,CAAA,uBACAm7C,EAcQuc,EAAAvhC,CAAA,wDAVOmkB,EAAG,iDACJA,EAAmB,uBAPUM,EAAA,SAAA4D,OAAAlE,MAAS,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,sCAA/BlE,EAAa,6BAS9Bkd,EAAAhE,GAAAlZ,MAAS,MAAM,oBAApB,OAAInoE,GAAA,qHAAJ,2CAJqBmoE,EAAa,+BACvBA,EAAG,6CATcA,EAAa,2EAgBrCA,EAAM,yCAFAqd,EAAA,QAAArd,MAAI,oGADdV,EAIA7qB,EAAA4oC,EAAAtiE,CAAA,mCADIilD,EAAM,SAAAsE,GAAAz5D,EAAAyyE,CAAA,sDAiCNtd,EAAQ,GAAC,uBAA0B,WAASud,GAAAvd,CAAA,wEAJ3BA,EAAa,kDAD5CV,EA0BM7qB,EAAA2oC,EAAAriE,CAAA,wCAvBuBilD,EAAmB,2BAElCA,EAAQ,GAAC,uBAA0B,8GAJlBA,EAAa,0EASrCA,EAAQ,GAAC,sBAAsB,CAAC,4DAAE,IACrC,wKAH2BA,EAAa,sZAWZA,EAAa,iKAL5BA,EAAQ,GAAC,sBAAsB,CAAC,WAR7CV,EAKO7qB,EAAA/uB,EAAA3K,CAAA,yBACPukD,EAYK7qB,EAAAt8B,EAAA4C,CAAA,EARH8lD,EAOC1oD,EAAA6uB,CAAA,OAFcg5B,EAAG,4CACLA,EAAmB,mCAZ/BA,EAAQ,GAAC,sBAAsB,CAAC,OAAAsE,GAAAC,EAAAL,CAAA,uCAFRlE,EAAa,uDAWZA,EAAa,oCAExBA,EAAG,SAAHA,EAAG,mBAPPA,EAAQ,GAAC,sBAAsB,CAAC,yGAsBjCA,EAAQ,GAAC,8BAAiC,WAASwd,GAAAxd,CAAA,sMAFzCA,EAAa,gEAQdA,EAAa,iWAXtCV,EAiBK7qB,EAAAt8B,EAAA4C,CAAA,EAhBH8lD,EAOO1oD,EAAAuN,CAAA,wBACPm7C,EAOC1oD,EAAA6uB,CAAA,YAFgBg5B,EAAI,6CACPA,EAAmB,2BAVnBA,EAAQ,GAAC,8BAAiC,sGAFhCA,EAAa,oDAQdA,EAAa,qCAGnBA,EAAI,6DARhBA,EAAQ,GAAC,6BAA6B,CAAC,+BAAE,IAC5C,mDADGA,EAAQ,GAAC,6BAA6B,CAAC,OAAAsE,GAAAC,EAAAL,CAAA,4FAczC8Y,GAAA,OAAAA,EAAA,QAAM,QAAQhd,MAAS,MAAM,uNA8B1BkE,EAAAlE,MAAS,MAAK,mEAAC,IACnB,4JAF0BA,EAAa,yFAMdA,EAAa,mWAG9Bh7B,EAAAgC,EAAA,MAAAi2C,EAAAjd,MAAS,MAAM,UAbzBV,EAiBK7qB,EAAAt8B,EAAA4C,CAAA,EAfH8lD,EAIO1oD,EAAAuN,CAAA,uBACPm7C,EASC1oD,EAAA6uB,CAAA,OAFcg5B,EAAI,6CACLA,EAAmB,oBAV7BM,EAAA,UAAA4D,OAAAlE,MAAS,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,sCADQlE,EAAa,sDAMdA,EAAa,iBAG9BM,EAAA,UAAA2c,OAAAjd,MAAS,6CACFA,EAAI,SAAJA,EAAI,wDAlC0BkE,EAAAlE,MAAS,MAAK,qBAShDyd,EAAAvE,GAAAlZ,MAAS,MAAM,uBAApB,OAAInoE,GAAA,+EATkD,IAAE,kMAAlCmoE,EAAa,maAKdA,EAAa,IACvBA,EAAI,aAAAmd,GAAA,IAAAnd,EAAA,SAAAnkB,CAAA,wCATamkB,EAAa,0DADjDV,EAsBK7qB,EAAAt8B,EAAA4C,CAAA,EArBH8lD,EAoBM1oD,EAAAilE,CAAA,EAnBJvc,EAGAuc,EAAA13D,CAAA,uBACAm7C,EAcQuc,EAAAvhC,CAAA,wDAVOmkB,EAAI,iDACLA,EAAmB,uBAPUM,EAAA,UAAA4D,OAAAlE,MAAS,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,sCAA/BlE,EAAa,8BAS9Byd,EAAAvE,GAAAlZ,MAAS,MAAM,oBAApB,OAAInoE,GAAA,qHAAJ,2CAJqBmoE,EAAa,+BACvBA,EAAI,6CATaA,EAAa,2EAgBrCA,EAAM,yCAFAqd,EAAA,QAAArd,MAAI,oGADdV,EAIA7qB,EAAA4oC,EAAAtiE,CAAA,oCADIilD,EAAM,SAAAsE,GAAAz5D,EAAAyyE,CAAA,sDAiCNtd,EAAQ,GAAC,wBAA2B,WAAS0d,GAAA1d,CAAA,wEAJ5BA,EAAa,kDAD5CV,EA0BM7qB,EAAA2oC,EAAAriE,CAAA,wCAvBuBilD,EAAmB,2BAElCA,EAAQ,GAAC,wBAA2B,8GAJnBA,EAAa,0EASrCA,EAAQ,GAAC,uBAAuB,CAAC,4DAAE,IACtC,wKAH2BA,EAAa,sZAWZA,EAAa,iKAL5BA,EAAQ,GAAC,uBAAuB,CAAC,WAR9CV,EAKO7qB,EAAA/uB,EAAA3K,CAAA,yBACPukD,EAYK7qB,EAAAt8B,EAAA4C,CAAA,EARH8lD,EAOC1oD,EAAA6uB,CAAA,OAFcg5B,EAAI,4CACNA,EAAmB,mCAZ/BA,EAAQ,GAAC,uBAAuB,CAAC,OAAAsE,GAAAC,EAAAL,CAAA,uCAFTlE,EAAa,uDAWZA,EAAa,oCAExBA,EAAI,SAAJA,EAAI,mBAPRA,EAAQ,GAAC,uBAAuB,CAAC,yGAsBlCA,EAAQ,GAAC,8BAAiC,WAAS2d,GAAA3d,CAAA,sMAFzCA,EAAa,gEAQdA,EAAa,iWAXtCV,EAiBK7qB,EAAAt8B,EAAA4C,CAAA,EAhBH8lD,EAOO1oD,EAAAuN,CAAA,wBACPm7C,EAOC1oD,EAAA6uB,CAAA,YAFgBg5B,EAAI,6CACPA,EAAmB,2BAVnBA,EAAQ,GAAC,8BAAiC,sGAFhCA,EAAa,oDAQdA,EAAa,qCAGnBA,EAAI,6DARhBA,EAAQ,GAAC,6BAA6B,CAAC,+BAAE,IAC5C,mDADGA,EAAQ,GAAC,6BAA6B,CAAC,OAAAsE,GAAAC,EAAAL,CAAA,4FAczC8Y,GAAA,OAAAA,EAAA,QAAM,QAAQhd,MAAS,MAAM,uNA8B1BkE,EAAAlE,MAAS,MAAK,mEAAC,IACnB,4JAF0BA,EAAa,oEAKdA,EAAa,wXAI9Bh7B,EAAAgC,EAAA,MAAAi2C,EAAAjd,MAAS,MAAM,UAbzBV,EAiBK7qB,EAAAt8B,EAAA4C,CAAA,EAfH8lD,EAIO1oD,EAAAuN,CAAA,uBACPm7C,EASC1oD,EAAA6uB,CAAA,OAFcg5B,EAAI,6CACLA,EAAmB,oBAV7BM,EAAA,UAAA4D,OAAAlE,MAAS,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,sCADQlE,EAAa,sDAKdA,EAAa,iBAI9BM,EAAA,UAAA2c,OAAAjd,MAAS,6CACFA,EAAI,SAAJA,EAAI,wDAlC0BkE,EAAAlE,MAAS,MAAK,qBAShD4d,EAAA1E,GAAAlZ,MAAS,MAAM,uBAApB,OAAInoE,GAAA,+EATkD,IAAE,kMAAlCmoE,EAAa,maAKdA,EAAa,IACvBA,EAAI,aAAAmd,GAAA,IAAAnd,EAAA,SAAAnkB,CAAA,wCATamkB,EAAa,0DADjDV,EAsBK7qB,EAAAt8B,EAAA4C,CAAA,EArBH8lD,EAoBM1oD,EAAAilE,CAAA,EAnBJvc,EAGAuc,EAAA13D,CAAA,uBACAm7C,EAcQuc,EAAAvhC,CAAA,wDAVOmkB,EAAI,iDACLA,EAAmB,uBAPUM,EAAA,UAAA4D,OAAAlE,MAAS,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,sCAA/BlE,EAAa,8BAS9B4d,EAAA1E,GAAAlZ,MAAS,MAAM,oBAApB,OAAInoE,GAAA,qHAAJ,2CAJqBmoE,EAAa,+BACvBA,EAAI,6CATaA,EAAa,2EAgBrCA,EAAM,yCAFAqd,EAAA,QAAArd,MAAI,oGADdV,EAIA7qB,EAAA4oC,EAAAtiE,CAAA,oCADIilD,EAAM,SAAAsE,GAAAz5D,EAAAyyE,CAAA,sDAiCNtd,EAAQ,GAAC,wBAA2B,WAAS6d,GAAA7d,CAAA,wEAJ5BA,EAAa,kDAD5CV,EA0BM7qB,EAAA2oC,EAAAriE,CAAA,wCAvBuBilD,EAAmB,2BAElCA,EAAQ,GAAC,wBAA2B,8GAJnBA,EAAa,0EASrCA,EAAQ,GAAC,uBAAuB,CAAC,4DAAE,IACtC,wKAH2BA,EAAa,sZAWZA,EAAa,iKAL5BA,EAAQ,GAAC,uBAAuB,CAAC,WAR9CV,EAKO7qB,EAAA/uB,EAAA3K,CAAA,yBACPukD,EAYK7qB,EAAAt8B,EAAA4C,CAAA,EARH8lD,EAOC1oD,EAAA6uB,CAAA,OAFcg5B,EAAI,4CACNA,EAAmB,mCAZ/BA,EAAQ,GAAC,uBAAuB,CAAC,OAAAsE,GAAAC,EAAAL,CAAA,uCAFTlE,EAAa,uDAWZA,EAAa,oCAExBA,EAAI,SAAJA,EAAI,mBAPRA,EAAQ,GAAC,uBAAuB,CAAC,yGAsBlCA,EAAQ,GAAC,8BAAiC,WAAS8d,GAAA9d,CAAA,sMAFzCA,EAAa,gEAQdA,EAAa,iWAXtCV,EAiBK7qB,EAAAt8B,EAAA4C,CAAA,EAhBH8lD,EAOO1oD,EAAAuN,CAAA,wBACPm7C,EAOC1oD,EAAA6uB,CAAA,YAFgBg5B,EAAI,6CACPA,EAAmB,2BAVnBA,EAAQ,GAAC,8BAAiC,sGAFhCA,EAAa,oDAQdA,EAAa,sCAGnBA,EAAI,6DARhBA,EAAQ,GAAC,6BAA6B,CAAC,+BAAE,IAC5C,mDADGA,EAAQ,GAAC,6BAA6B,CAAC,OAAAsE,GAAAC,EAAAL,CAAA,4FAczC8Y,GAAA,OAAAA,EAAA,QAAM,QAAQhd,MAAS,MAAM,uNA8B1BkE,EAAAlE,MAAS,MAAK,mEAAC,IACnB,4JAF0BA,EAAa,oEAKdA,EAAa,wXAI9Bh7B,EAAAgC,EAAA,MAAAi2C,EAAAjd,MAAS,MAAM,UAbzBV,EAiBK7qB,EAAAt8B,EAAA4C,CAAA,EAfH8lD,EAIO1oD,EAAAuN,CAAA,uBACPm7C,EASC1oD,EAAA6uB,CAAA,OAFcg5B,EAAI,6CACLA,EAAmB,oBAV7BM,EAAA,UAAA4D,OAAAlE,MAAS,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,sCADQlE,EAAa,sDAKdA,EAAa,iBAI9BM,EAAA,UAAA2c,OAAAjd,MAAS,8CACFA,EAAI,SAAJA,EAAI,wDAlC0BkE,EAAAlE,MAAS,MAAK,qBAShD+d,EAAA7E,GAAAlZ,MAAS,MAAM,uBAApB,OAAInoE,GAAA,+EATkD,IAAE,kMAAlCmoE,EAAa,maAKdA,EAAa,IACvBA,EAAI,aAAAmd,GAAA,IAAAnd,EAAA,SAAAnkB,CAAA,wCATamkB,EAAa,0DADjDV,EAsBK7qB,EAAAt8B,EAAA4C,CAAA,EArBH8lD,EAoBM1oD,EAAAilE,CAAA,EAnBJvc,EAGAuc,EAAA13D,CAAA,uBACAm7C,EAcQuc,EAAAvhC,CAAA,wDAVOmkB,EAAI,iDACLA,EAAmB,uBAPUM,EAAA,UAAA4D,OAAAlE,MAAS,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,sCAA/BlE,EAAa,8BAS9B+d,EAAA7E,GAAAlZ,MAAS,MAAM,oBAApB,OAAInoE,GAAA,qHAAJ,2CAJqBmoE,EAAa,gCACvBA,EAAI,6CATaA,EAAa,2EAgBrCA,EAAM,yCAFAqd,EAAA,QAAArd,MAAI,oGADdV,EAIA7qB,EAAA4oC,EAAAtiE,CAAA,oCADIilD,EAAM,SAAAsE,GAAAz5D,EAAAyyE,CAAA,sDAkCNtd,EAAQ,GAAC,wBAA2B,WAASge,GAAAhe,CAAA,wEAL5BA,EAAa,6FAD5CV,EA2BM7qB,EAAA2oC,EAAAriE,CAAA,wCAvBuBilD,EAAmB,2BAElCA,EAAQ,GAAC,wBAA2B,8GALnBA,EAAa,0EAUrCA,EAAQ,GAAC,uBAAuB,CAAC,4DAAE,IACtC,wKAH2BA,EAAa,sZAWZA,EAAa,iKAL5BA,EAAQ,GAAC,uBAAuB,CAAC,WAR9CV,EAKO7qB,EAAA/uB,EAAA3K,CAAA,yBACPukD,EAYK7qB,EAAAt8B,EAAA4C,CAAA,EARH8lD,EAOC1oD,EAAA6uB,CAAA,OAFcg5B,EAAI,4CACNA,EAAmB,mCAZ/BA,EAAQ,GAAC,uBAAuB,CAAC,OAAAsE,GAAAC,EAAAL,CAAA,uCAFTlE,EAAa,uDAWZA,EAAa,qCAExBA,EAAI,SAAJA,EAAI,mBAPRA,EAAQ,GAAC,uBAAuB,CAAC,yGAsBlCA,EAAQ,GAAC,8BAAiC,WAASie,GAAAje,CAAA,sMAFzCA,EAAa,gEAQdA,EAAa,iWAXtCV,EAiBK7qB,EAAAt8B,EAAA4C,CAAA,EAhBH8lD,EAOO1oD,EAAAuN,CAAA,wBACPm7C,EAOC1oD,EAAA6uB,CAAA,YAFgBg5B,EAAI,6CACPA,EAAmB,2BAVnBA,EAAQ,GAAC,8BAAiC,sGAFhCA,EAAa,oDAQdA,EAAa,sCAGnBA,EAAI,6DARhBA,EAAQ,GAAC,6BAA6B,CAAC,+BAAE,IAC5C,mDADGA,EAAQ,GAAC,6BAA6B,CAAC,OAAAsE,GAAAC,EAAAL,CAAA,6FAczC8Y,GAAA,OAAAA,EAAA,QAAM,QAAQhd,MAAS,MAAM,uNA8B1BkE,EAAAlE,MAAS,MAAK,mEAAC,IACnB,4JAF0BA,EAAa,oEAKdA,EAAa,wXAI9Bh7B,EAAAgC,EAAA,MAAAi2C,EAAAjd,MAAS,MAAM,UAbzBV,EAiBK7qB,EAAAt8B,EAAA4C,CAAA,EAfH8lD,EAIO1oD,EAAAuN,CAAA,uBACPm7C,EASC1oD,EAAA6uB,CAAA,OAFcg5B,EAAI,6CACLA,EAAmB,oBAV7BM,EAAA,WAAA4D,OAAAlE,MAAS,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,sCADQlE,EAAa,sDAKdA,EAAa,iBAI9BM,EAAA,WAAA2c,OAAAjd,MAAS,8CACFA,EAAI,SAAJA,EAAI,wDAlC0BkE,EAAAlE,MAAS,MAAK,qBAShDiZ,EAAAC,GAAAlZ,MAAS,MAAM,uBAApB,OAAInoE,GAAA,+EATkD,IAAE,kMAAlCmoE,EAAa,maAKdA,EAAa,IACvBA,EAAI,aAAAmd,GAAA,IAAAnd,EAAA,SAAAnkB,CAAA,wCATamkB,EAAa,0DADjDV,EAsBK7qB,EAAAt8B,EAAA4C,CAAA,EArBH8lD,EAoBM1oD,EAAAilE,CAAA,EAnBJvc,EAGAuc,EAAA13D,CAAA,uBACAm7C,EAcQuc,EAAAvhC,CAAA,wDAVOmkB,EAAI,iDACLA,EAAmB,uBAPUM,EAAA,WAAA4D,OAAAlE,MAAS,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,sCAA/BlE,EAAa,+BAS9BiZ,EAAAC,GAAAlZ,MAAS,MAAM,oBAApB,OAAInoE,GAAA,qHAAJ,2CAJqBmoE,EAAa,gCACvBA,EAAI,6CATaA,EAAa,2EAgBrCA,EAAM,yCAFAqd,EAAA,QAAArd,MAAI,oGADdV,EAIA7qB,EAAA4oC,EAAAtiE,CAAA,qCADIilD,EAAM,SAAAsE,GAAAz5D,EAAAyyE,CAAA,sDAkCNtd,EAAQ,GAAC,wBAA2B,WAASwS,GAAAxS,CAAA,wEAL5BA,EAAa,6FAD5CV,EA2BM7qB,EAAA2oC,EAAAriE,CAAA,wCAvBuBilD,EAAmB,2BAElCA,EAAQ,GAAC,wBAA2B,8GALnBA,EAAa,0EAUrCA,EAAQ,GAAC,uBAAuB,CAAC,4DAAE,IACtC,wKAH2BA,EAAa,sZAWZA,EAAa,iKAL5BA,EAAQ,GAAC,uBAAuB,CAAC,WAR9CV,EAKO7qB,EAAA/uB,EAAA3K,CAAA,yBACPukD,EAYK7qB,EAAAt8B,EAAA4C,CAAA,EARH8lD,EAOC1oD,EAAA6uB,CAAA,OAFcg5B,EAAI,4CACNA,EAAmB,mCAZ/BA,EAAQ,GAAC,uBAAuB,CAAC,OAAAsE,GAAAC,EAAAL,CAAA,uCAFTlE,EAAa,uDAWZA,EAAa,qCAExBA,EAAI,SAAJA,EAAI,mBAPRA,EAAQ,GAAC,uBAAuB,CAAC,8VAiBLA,EAAa,uEASnBA,EAAa,0UAVpDV,EAeK7qB,EAAAt8B,EAAA4C,CAAA,EAdH8lD,EAMO1oD,EAAAuN,CAAA,EALLm7C,EAIMn7C,EAAA61B,CAAA,SAERslB,EAMC1oD,EAAA6uB,CAAA,YAFgBg5B,EAAmB,8CACtBA,EAAmB,oEAZUA,EAAa,kEASnBA,EAAa,uCAEjCA,EAAmB,+SAQFA,EAAa,8DASnBA,EAAa,0UAV3CV,EAeK7qB,EAAAt8B,EAAA4C,CAAA,EAdH8lD,EAMO1oD,EAAAuN,CAAA,EALLm7C,EAIMn7C,EAAA61B,CAAA,SAERslB,EAMC1oD,EAAA6uB,CAAA,YAFgBg5B,EAAU,6CACbA,EAAmB,2DAZCA,EAAa,yDASnBA,EAAa,sCAExBA,EAAU,0DA6ClBuN,EAAAvN,KAAS,QAAO,6QALfA,EAAA,IACJ,QACA,UAAQ,wIAhBhBV,EAqBK7qB,EAAA8qB,EAAAxkD,CAAA,EApBH8lD,EAWQtB,EAAAa,CAAA,SACRS,EAOKtB,EAAAqB,CAAA,gFADIN,EAAA,MAAAiN,OAAAvN,KAAS,QAAO,MAAAY,EAAA,UAAA2M,sBALfvN,EAAA,IACJ,QACA,UAAQ,kNAlkBbc,EAAAd,KAAS,uBAAqBke,GAAAle,CAAA,EAkB9Be,EAAAf,KAAS,6BAA2Bme,GAAAne,CAAA,KAoBpCA,EAAQ,KAAAoe,GAAApe,CAAA,EA8CR0U,EAAA1U,KAAS,uBAAqBqe,GAAAre,CAAA,EA+B9B2U,GAAA3U,KAAS,8BAA4Bse,GAAAte,CAAA,KAoBrCA,EAAQ,KAAAue,GAAAve,CAAA,EA8CRwe,GAAAxe,KAAS,wBAAsBye,GAAAze,CAAA,EA+B/B0e,GAAA1e,KAAS,8BAA4B2e,GAAA3e,CAAA,KAoBrCA,EAAQ,KAAA4e,GAAA5e,CAAA,EA8CR6e,GAAA7e,KAAS,wBAAsB8e,GAAA9e,CAAA,EA+B/B+e,GAAA/e,KAAS,8BAA4Bgf,GAAAhf,CAAA,KAoBrCA,EAAQ,KAAAif,GAAAjf,CAAA,EA8CRkf,GAAAlf,KAAS,wBAAsBmf,GAAAnf,CAAA,EAgC/Bof,GAAApf,KAAS,8BAA4Bqf,GAAArf,CAAA,KAoBrCA,EAAQ,KAAAsf,GAAAtf,CAAA,EA8CRuf,GAAAvf,KAAS,wBAAsBsT,GAAAtT,CAAA,EA+B/Bwf,GAAAxf,KAAS,+BAA6BC,GAAAD,CAAA,EAmBtCyf,GAAAzf,EAAQ,aAAY77B,IAAkB67B,KAAS,sBAAoBE,GAAAF,CAAA,KAsCnEA,EAAQ,GAAC,UAAY,QAASG,GAAAH,CAAA,4mBAZjC,SAEA,sTAH0BA,EAAa,qZAOdA,EAAa,4DAbVA,EAAa,0LAtjBhCA,EAAa,IACuDh7B,EAAAi8B,EAAA,QAAAyP,EAAA,6EAAA1Q,EAAA,GAC7E,mBACA,iBAAe,yCAJrBV,EAmmBK7qB,GAAAwsB,EAAAlmD,EAAA,EA7lBH8lD,EAYKI,EAAAL,CAAA,EAXHC,EAUQD,EAAAR,CAAA,SAEVS,EA+kBKI,EAAA1B,CAAA,EA5kBHsB,EAEItB,EAAAmgB,CAAA,mbA8hBJ7e,EAmBMtB,EAAA6d,CAAA,EAdJvc,EAKOuc,EAAA13D,CAAA,gBACPm7C,EAOCuc,EAAAp2C,CAAA,OAFcg5B,EAAI,0FACNA,EAAmB,sBAdLA,EAAmB,wBAhiB3CA,MAAS,gFAkBTA,MAAS,sFAoBTA,GAAQ,sEA8CRA,MAAS,gFA+BTA,MAAS,+FAoBTA,GAAQ,sEA8CRA,MAAS,yFA+BTA,MAAS,+FAoBTA,GAAQ,sEA8CRA,MAAS,yFA+BTA,MAAS,+FAoBTA,GAAQ,sEA8CRA,MAAS,yFAgCTA,MAAS,+FAoBTA,GAAQ,sEA8CRA,MAAS,yFA+BTA,MAAS,gGAmBTA,GAAQ,aAAY77B,IAAkB67B,MAAS,4HAyBxBA,GAAa,yDAOdA,GAAa,wCAEvBA,GAAI,UAAJA,GAAI,+CAfSA,GAAa,iBAmBtCA,GAAQ,GAAC,UAAY,yGAzkBfA,GAAa,kBACuDM,GAAA,MAAAoQ,OAAA,6EAAA1Q,GAAA,GAC7E,mBACA,iBAAe,yTAxJR,SAAA7pE,CAAkB,EAAAspE,GAClB,cAAAkgB,CAAqB,EAAAlgB,EACrB,WAAAh6C,EAAqB,EAAI,EAAAg6C,EAE9B,MAAAqR,EAAWC,GAAqB,MAOlCx5E,EACA05E,EACA2O,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAEAC,EAA8B,GAE9BC,EACAC,EACAC,EACAC,EACAC,EAEAC,EAUJhhB,GAAO,SACLnoE,EAAcpB,EAAS,WAAW,EAClC86E,EAAW96E,EAAS,UAAY,OAChCypF,EAAMzpF,EAAS,MAAQ,QAAU,GAAQA,EAAS,GAAG,MACrD0pF,EAAO1pF,EAAS,OAAS,QAAU,GAAQA,EAAS,IAAI,MACxD2pF,EAAO3pF,EAAS,OAAS,QAAU,GAAQA,EAAS,IAAI,MACxD4pF,EAAO5pF,EAAS,OAAS,QAAU,GAAQA,EAAS,IAAI,MACxD6pF,EAAO7pF,EAAS,OAAS,QAAU,GAAQA,EAAS,IAAI,MACxD8pF,EACE9pF,aAAoBguC,IAAiBhuC,EAAS,YAAc,EAAa,OAC3EgqF,EAAsBhqF,EAAS,mBAAmB,EAGhD,MAAM,QAAQA,EAAS,yBAAyB,GAChDA,EAAS,0BAA0B,OAAS,GAE5C2pE,EAAA,GAAAugB,EAAWM,EAAmBxqF,EAAS,yBAAyB,GAGhE,MAAM,QAAQA,EAAS,0BAA0B,GACjDA,EAAS,2BAA2B,OAAS,GAE7C2pE,EAAA,GAAAwgB,EAAWK,EAAmBxqF,EAAS,0BAA0B,GAGjE,MAAM,QAAQA,EAAS,0BAA0B,GACjDA,EAAS,2BAA2B,OAAS,GAE7C2pE,EAAA,GAAAygB,EAAWI,EAAmBxqF,EAAS,0BAA0B,GAGjE,MAAM,QAAQA,EAAS,0BAA0B,GACjDA,EAAS,2BAA2B,OAAS,GAE7C2pE,EAAA,GAAA0gB,EAAWG,EAAmBxqF,EAAS,0BAA0B,GAGjE,MAAM,QAAQA,EAAS,0BAA0B,GACjDA,EAAS,2BAA2B,OAAS,GAE7C2pE,EAAA,GAAA2gB,EAAWE,EAAmBxqF,EAAS,0BAA0B,KAe5D,SAAAwqF,EACPC,GAEgC,CAE1B,MAAAC,OAEiCD,EAAiB,EAClD,MAAG,CAAC,EAAE,SAASC,GAAQ,MAAM,SAQ3BrpC,GADUqpC,GAAQ,MAAK,GACgB,OACzCnf,MACAmf,GAAQ,OAAS,EAAC,OAEdC,GAAUD,GAAQ,IAAG,EACvBC,GACFpf,GAASof,GACN,MAAM;AAAA,CAAI,EACV,IAAK9nF,IAAMA,GAAE,QAAQ,gBAAiB,EAAE,GAE3C0oE,GAAM,cAIF5qE,GAAM+pF,GAAQ,CAAC,EACrBnf,GAAM,OAAU5qE,IAAQ,SAAWA,GAAM,SAASA,EAAG,EAE9C,aAAA0gD,GAAO,OAAAkqB,EAAM,iBAvBZ,MAAK,QACLvrE,EAAS,IAAI,wDA0BlB4qF,GAAmB,CAC1BjQ,EAAS,WAAU,CACjB,YAAAv5E,EACA,SAAA05E,EACA,IAAA2O,EACA,KAAAC,EACA,KAAAC,EACA,KAAAC,EACA,KAAAC,EACA,WAAAC,EACA,KAAAC,EACA,oBAAAC,iBAeErgB,EAAA,EAAAr6C,EAAS,CAAIA,CAAA,EACbqrD,EAAS,gBAAe,CAAI,UAAArrD,EAAS,gBA0BtBluB,EAAWypF,GAAA,gCAqBTpB,EAAG,iCAiBDA,EAAGqB,GAAA,0BA4BLrB,EAAGoB,GAAA,gCA4BDpB,EAAG,gCAwBLC,EAAI,iCAiBFA,EAAIoB,GAAA,0BA4BNpB,EAAImB,GAAA,iCA4BFnB,EAAI,+BAwBNC,EAAI,kCAiBFA,EAAImB,GAAA,0BA4BNnB,EAAIkB,GAAA,gCA4BFlB,EAAI,+BAwBNC,EAAI,kCAiBFA,EAAIkB,GAAA,0BA4BNlB,EAAIiB,GAAA,iCA6BFjB,EAAI,gCAwBNC,EAAI,kCAiBFA,EAAIiB,GAAA,2BA4BNjB,EAAIgB,GAAA,iCA6BFhB,EAAI,gCAqBNG,EAAmB,mCAmBnBF,EAAU,kCAqBdC,EAAI,gDAUbpgB,EAAA,GAAAsgB,EAAkB,CAAIA,CAAA,WAGtBtgB,EAAA,GAAAsgB,EAAkB,CAAIA,CAAA,wLAtsB1BM,IAAiBvqF,EAAS,YAE5BuqF,EAAevqF,EAAS,IAAI,EAC5B2pE,EAAA,GAAAogB,EAAO/pF,EAAS,MAAQ,EAAE,iZCqnBR6pE,EAAQ,GAAC,SAAa,KAAeA,EAAQ,GAAC,SAAS,SAAW,GAACwS,GAAAxS,CAAA,EAU1Ee,EAAAf,KAAS,cAAYsT,GAAAtT,CAAA,EAqBjBiZ,EAAAC,GAAAlZ,KAAS,cAAc,EAAa,MAAAmZ,GAAAnZ,SAAI,KAAOA,EAAQ,GAAC,MAAQ,oBAArE,OAAInoE,GAAA,oDAmEP,IAAA48E,EAAAzU,EAAY,IAAIA,EAAe,MAAKA,MAAuBA,EAAgB,IAAAE,GAAAF,CAAA,0CAcrEA,EAAQ,iBAEHA,EAAa,WADZA,EAAiB,0BAAjBA,EAAiB,2EAEpBA,EAAiB,4nBAlJnBh7B,EAAAggC,EAAA,QAAA+S,EAAA/X,EAAY,IAAG,EAAI,UAAY,WAAW,6QAyDxCA,EAAQ,GAAC,eAAe,SAAW,GAAC,CAC3CA,EAAQ,GAAC,sBACN,YACA,iBAAe,qHAPJoZ,EAAAnY,EAAA,UAAAjB,MAAa,UAAQ,wEA1BtCoZ,EAAAC,EAAA,aAAArZ,EAAc,IAAC,GAAK,GACpB,SAAQ,oCAA2BA,EAAc,IAAC,GAAK,GAAC,KArCHh7B,EAAAm8B,EAAA,QAAA+f,EAAA,qDAAAlhB,EAAA,GACrD,kBACA,UAAQ,uCACCA,EAAa,6DAL9BV,EA+JK7qB,EAAAw+B,EAAAl4D,CAAA,EA9JH8lD,EAuJKoS,EAAA9R,CAAA,EAjJHN,EA2BKM,EAAAP,CAAA,EAxBHC,EAWQD,EAAAoE,CAAA,EAHNnE,EAEImE,EAAAJ,CAAA,SAEN/D,EAAuCD,EAAAkE,CAAA,SACvCjE,EAUQD,EAAAqE,CAAA,SAEVpE,EAuGSM,EAAAkY,CAAA,EAjGPxY,EAqBKwY,EAAA9Z,CAAA,gDACLsB,EA0EKwY,EAAApY,CAAA,EAtEHJ,EAqEII,EAAA5kB,CAAA,qFAeRwkB,EAAiCM,EAAAH,CAAA,kGA5IrB,CAAAvwD,GAAA6vD,EAAA,SAAAyX,OAAA/X,EAAY,IAAG,EAAI,UAAY,qCA+B3BA,EAAQ,GAAC,SAAa,KAAeA,EAAQ,GAAC,SAAS,SAAW,iEAUzEA,KAAS,gFAqBLiZ,EAAAC,GAAAlZ,KAAS,cAAc,6DALtBA,EAAQ,GAAC,eAAe,SAAW,GAAC,CAC3CA,EAAQ,GAAC,sBACN,YACA,iBAAe,uJAPJoZ,EAAAnY,EAAA,UAAAjB,MAAa,UAAQ,mBA1BtCoZ,EAAAC,EAAA,aAAArZ,EAAc,IAAC,GAAK,GACpB,SAAQ,qDAA2BA,EAAc,IAAC,GAAK,GAAC,KAqGvDA,EAAY,IAAIA,EAAe,MAAKA,MAAuBA,EAAgB,2DA1IvB,CAAAvvD,GAAA6vD,EAAA,OAAA4gB,OAAA,qDAAAlhB,EAAA,GACrD,kBACA,UAAQ,iEACCA,EAAa,mDAqJfA,EAAQ,8BAEHA,EAAa,oCADZA,EAAiB,oOA3GjBpN,GAAuBoN,EAAQ,GAAC,QAAQ,uIALnDV,EAOK7qB,EAAAt8B,EAAA4C,CAAA,EANH8lD,EAKG1oD,EAAAiM,CAAA,uCADMwuC,GAAuBoN,EAAQ,GAAC,QAAQ,QAAA57C,EAAA,UAAAmpD,0CAUxCA,EAAAvN,KAAS,aAAY,qIALhCV,EAOK7qB,EAAAt8B,EAAA4C,CAAA,EANH8lD,EAKG1oD,EAAAiM,CAAA,wBADMk8C,EAAA,MAAAiN,OAAAvN,KAAS,aAAY,MAAA57C,EAAA,UAAAmpD,oDAkDbmF,EAAA1S,KAAS,mBAAkB,SAS7B4S,EAAAhgB,GACLoN,EAAQ,GAAC,iBAAiBA,EAAC,sQApBnBh7B,EAAA47B,EAAA,QAAAgO,GAAA5O,EAAQ,GAAC,mBAAmB,SAAW,EAC3C,YACA,UAAQ,2CAPNh7B,EAAAi8B,EAAA,QAAAyP,EAAA1Q,EAAQ,GAAC,mBAAmB,SAAW,EAC3C,qHACA,QAAQ,yGAkBSA,EAAQ,GAAC,aAC5B,CAAC,qjBAxBch7B,EAAAmuC,EAAA,KAAAwF,EAAA,iBAAA3Y,UAAiBA,EAAC,aAFvCV,EA4CK7qB,EAAA0+B,EAAAp4D,CAAA,EAxCH8lD,EAkBKsS,EAAAlS,CAAA,EAbHJ,EAQKI,EAAAL,CAAA,EAHHC,EAEID,EAAA/oE,CAAA,SAENgpE,EAGKI,EAAA1B,CAAA,uBAEPsB,EASKsS,EAAAnS,CAAA,uBAILH,EAIKsS,EAAAhS,CAAA,SACLN,EAEMsS,EAAAF,CAAA,UAjCM3S,EAAA,MAAAsO,QAAA5O,EAAQ,GAAC,mBAAmB,SAAW,EAC3C,YACA,UAAQ,2CAQLM,EAAA,MAAAoS,OAAA1S,KAAS,mBAAkB,MAAAT,EAAA,UAAAmT,GAf5BpS,EAAA,MAAAoQ,OAAA1Q,EAAQ,GAAC,mBAAmB,SAAW,EAC3C,qHACA,0BAsBGM,EAAA,MAAAsS,OAAAhgB,GACLoN,EAAQ,GAAC,iBAAiBA,EAAC,YAAAgB,EAAA,UAAA4R,6BALR5S,EAAQ,GAAC,aAC5B,CAAC,EAxBcM,EAAA,MAAAqY,OAAA,iBAAA3Y,UAAiBA,EAAC,2DANhCuN,EAAA3a,GAAuBoN,EAAI,kBAE/BA,EAAmB,IAAAC,GAAAD,CAAA,wEANTh7B,EAAAkW,EAAA,KAAA09B,EAAA,WAAA5Y,SAAgBA,EAAC,uBACTA,EAAQ,GAAC,SAAW,CAAC,4DAL/Bh7B,EAAA7sB,EAAA,KAAAq1D,EAAA,WAAAxN,SAAgBA,EAAC,0KAFhCV,EA4DK7qB,EAAAt8B,EAAA4C,CAAA,EAvDH8lD,EAMI1oD,EAAA+iC,CAAA,yDADKolB,EAAA,MAAAiN,OAAA3a,GAAuBoN,EAAI,WAAA9kB,EAAA,UAAAqyB,GAJrBjN,EAAA,MAAAsY,OAAA,WAAA5Y,SAAgBA,EAAC,4CACTA,EAAQ,GAAC,SAAW,CAAC,EAKvCA,EAAmB,0DAVXM,EAAA,MAAAkN,OAAA,WAAAxN,SAAgBA,EAAC,kEAsEzB+Y,EAAA/Y,EAAoB,IAAG,EAC9B,eACA,kDAFH,WAAS,4BAJAA,EAAa,iCADzBV,EAQA7qB,EAAA2rB,EAAArlD,CAAA,4CALailD,EAAa,mBAEbM,EAAA,SAAAyY,OAAA/Y,EAAoB,IAAG,EAC9B,eACA,eAAYsE,GAAA0U,EAAAD,CAAA,yBANN/Y,EAAa,kGAzL3BA,EAAW,oBAkCG,IAChBlrE,EAAAkrE,EAAQ,KAAR,MAAAlrE,EAAU,kBACPkrE,EAAmB,MACpBnrE,EAAAmrE,EAAW,KAAX,MAAAnrE,EAAa,sOAJCmrE,EAAO,6BAMJA,EAAqB,WAGvCA,EAAS,KAAAG,GAAAH,CAAA,0FA5ChBV,EA8MK7qB,EAAAt8B,EAAA4C,CAAA,sGA5MGilD,EAAW,qBAkCG,IAChBlrE,EAAAkrE,EAAQ,KAAR,MAAAlrE,EAAU,kBACPkrE,EAAmB,MACpBnrE,EAAAmrE,EAAW,KAAX,MAAAnrE,EAAa,kCAKdmrE,EAAS,+SA/kBH,SAAAxb,CAAkB,EAAAib,GAClB,cAAAoZ,CAAqB,EAAApZ,GACrB,mBAAA0Y,CAA0B,EAAA1Y,EAC1B,qBAAAlN,EAAsB,EAAK,EAAAkN,GAC3B,cAAA0hB,CAAsC,EAAA1hB,EAE7CgC,EACAroB,EACA2I,EASAq/B,EACFnjD,GAAI0nB,EAAe,EAAEkzB,CAAa,EAChCwI,EAA0BpjD,GAAI0nB,EAAe,EAAE,OAE/CxjD,EACFi/E,GAAmBA,EAAgB,GAC/BA,EAAgB,GACf58B,EAAS,IAAM,GAEhB,MAAA88B,EAAgC37B,GAAgB,UAAWjzD,IAAK,CACpE0xD,EAAI,eAAe,EACf1xD,GAAMmmF,CAAa,IAAMuI,IAE3Bh9B,EAAI,iCAAmC,KAAK,UAAUg9B,CAAe,GACrEA,EAAkB1uF,GAAMmmF,CAAa,GAEnCwI,IAAoB3uF,GAAM,aAC5B2uF,EAAkB3uF,GAAM,MAAM,IAI9B,IAAA6lF,EAAe6I,EAAgB,MAAQ,EACvC37D,EAAY,GACZk2D,EAAmB,GACnBS,EAAoB,GACpBzxB,EAAenG,EAAS,iBACtBo3B,EAAkBp3B,EAAS,gBAC3B+8B,EAAqB,CACxB/8B,EAAS,wBACTA,EAAS,+BAA6B,CACtCA,EAAS,MAAI,CACbA,EAAS,6BAA2B,CACpCA,EAAS,2BAAyB,CAClCA,EAAS,uBAAqB,CAC9BA,EAAS,8BAA4B,CACrCA,EAAS,6BACTA,EAAS,wBAAsB,CAC/BA,EAAS,8BAA4B,CACrCA,EAAS,4BAA0B,CACnCA,EAAS,wBAAsB,CAC/BA,EAAS,8BAA4B,CACrCA,EAAS,4BAA0B,CACnCA,EAAS,yBACTA,EAAS,8BAA4B,CACrCA,EAAS,4BAA0B,CACnCA,EAAS,uBACR,IAAAg9B,EAAoB,SAClBC,EAAqB,KACnB,MAAArG,GAAQF,GAAqBj9C,GAAI0nB,EAAe,GAChDs1B,GAASD,GAAU/8C,GAAI0nB,EAAe,UAE1Cy7B,GACAA,EAAgB,MAChBnG,GAAOmG,EAAgB,IAAI,EAAI,EAExB,IAAMhG,GAAMvC,CAAa,EAEzB,QAGP6I,EAAW,CACb,MAAO,GACP,GAAAv/E,EACA,eAAgB02E,EAChB,mBAAAV,EACA,aAAAxtB,EACA,gBAAAixB,EACA,kBAAAQ,GAoBE3C,EAA+B,QAI7BkI,EAA4B74B,GAAQ,UAAS,KACjDgX,EAAA,EAAA4hB,EAAY,MAAQl9B,EAAS,MAAQi9B,EAAqB,EAAAC,CAAA,mBAG7ChI,GAAW,CACpBl1B,GAAY,WAChBA,EAAS,eAAiBq0B,EAAar0B,CAAA,QACjCm1B,EAA4B,GAG3B,SAAAv1B,EAAI3wD,GAAW,CACX,IAAO,IAAI,OAAO,SAAS,IAAI,EAAE,aAAa,IAAI,KAAK,IAAM,MAEtE,QAAQ,KAAKolF,EAAer0B,EAAS,EAAE,EACvC,QAAQ,KAAK/wD,EAAG,GAIpBu7E,GAAY,UACV5qB,EAAI,gBAAkBI,EAAS,EAAE,EAC7Bi1B,IAAyBjD,GAAehyB,CAAQ,QAClDi1B,EAAuBjD,GAAehyB,CAAQ,GAE5CvmB,GAAI0nB,EAAe,EAAEkzB,CAAa,IAAMuI,IAE1CA,EAAkBnjD,GAAI0nB,EAAe,EAAEkzB,CAAa,EACpDz0B,EAAI,oCAAsC,KAAK,UAAUg9B,CAAe,SAElElH,EAAa,WAUjB0H,EAAiC,KACjCtI,EAAiB,SAAW,IAC9B8H,EAAkBnjD,GAAI0nB,EAAe,EAAEkzB,CAAa,OACpD12E,EAAK87B,GAAI0nB,EAAe,EAAEkzB,CAAa,EAAE,IAAM,EAAE,IAIrDnZ,GAAO,UACLtb,EAAI,WAAaI,EAAS,EAAE,EAC5B,SAAS,iBAAiB,gBAAiB4zB,EAAO,EAClD,SAAS,iBAAiB,mBAAoB4B,CAAgB,EAC9D,SAAS,iBAAiB,sBAAuBC,CAAmB,EACpE,SAAS,iBAAiB,gBAAiBP,CAAW,EACtD,SAAS,iBACP,qBACAkI,CAAiC,QAE7B1H,EAAa,IAGrBrX,GAAS,KACPze,EAAI,YAAcI,EAAS,EAAE,EAE7BA,EAAS,OAAM,EACfA,EAAS,QAAO,EACL,UAAAxmB,MAAQ,OAAO,KAAKwmB,CAAQ,EACrC,QAAQ,eAAeA,EAAUxmB,EAAI,EAEvC,SAAS,oBAAoB,gBAAiBo6C,EAAO,EACrD,SAAS,oBAAoB,mBAAoB4B,CAAgB,EACjE,SAAS,oBAAoB,sBAAuBC,CAAmB,EACvE,SAAS,oBAAoB,gBAAiBP,CAAW,EACzD,SAAS,oBACP,qBACAkI,CAAiC,EAEnCD,EAAyB,EACzBL,EAA6B,IAG/Bre,GAAW,UACT7e,EAAI,eAAiBI,EAAS,EAAE,EAC5BA,UACI8rB,GAAI,EACN3lB,UACI6W,GAAY,GAEhBhd,GAAA,YAAAA,EAAU,kBAAmB,iBAC5B+N,GAEDhQ,GAA4BiC,CAAQ,EAIpC+xB,GAAuB,GACvB/xB,EAAS,KAAO,QAChBA,EAAS,OAAS,QAClB,OAAO,aAAa,QAAO,GAAIA,EAAS,EAAE,IAAIA,EAAS,IAAI,KACzD,MACFm3B,SAEMvD,GAAO,GAGjBpd,GAAkByG,CAAW,EACzB8f,GACFzhB,EAAA,EAAAsc,EAAoB,EAAK,SAIvBtK,GAAiB,IAAO,OAAO,MAAM,oBAAmB,CAC5D,QAAS,GAAI,EAEf,SAAS,cAAcA,EAAiB,EACpCvf,GACFokB,GAAwB,mBAIbyB,IAAO,CACpBh0B,EAAI,UAAYI,EAAS,EAAE,EACvB,OAAO,UAAU,eAAe,KAAKA,EAAU,gBAAgB,IAC7D+N,GAAuB5H,GAAYmV,EAAA,EAAEvN,EAAsB,EAAK,EAElE/N,IAAa,QAAS,OACfA,GAAA,YAAAA,EAAU,eAAiB,YAElCA,EAAS,aAAY,EAEnBzC,GAAao4B,EAAe,EAC5B/gC,GAAQ0mB,EAAA,EAAE1mB,EAAS,UAAY,GAAEA,CAAA,EAEnCm9B,GAAuB,GACvB/xB,EAAS,KAAO,QAChB+N,GAEA,OAAO,aAAa,QAAO,GAAI/N,EAAS,EAAE,IAAIA,EAAS,IAAI,GAAI,MAAM,QAEjE01B,EAAa,kBAIRF,GAAgB,CACzBx1B,GAAA,MAAAA,EAAU,iBAAesb,EAAA,EAAEnV,EAAe,EAAI,QAC5CuvB,EAAa,iBAEND,GAAmB,CAC5Bz1B,GAAA,MAAAA,EAAU,iBAAesb,EAAA,EAAEnV,EAAe,EAAK,QAC7CuvB,EAAa,EAGZ,SAAA2H,GAAkB9lC,GAAkB,CAC3CqI,EAAI,qBAAuB,KAAK,UAAUrI,GAAM,MAAM,GACjDqlC,IAGDrlC,GAAM,OAAO,cACf+jB,EAAA,EAAAtb,EAAS,YAAczI,GAAM,OAAO,YAAWyI,CAAA,EAC/C48B,EAAgB,YAAc58B,EAAS,aAErCzI,GAAM,OAAO,WACf+jB,EAAA,EAAAtb,EAAS,SAAWzI,GAAM,OAAO,SAAQyI,CAAA,EACzC48B,EAAgB,SAAW58B,EAAS,UAElCzI,GAAM,OAAO,MAAQ,SACvB+jB,EAAA,EAAAtb,EAAS,IAAMzI,GAAM,OAAO,IAAGyI,CAAA,EAC/B48B,EAAgB,IAAMrmB,GAAkBvW,EAAS,GAAG,GAElDzI,GAAM,OAAO,OAAS,SACxB+jB,EAAA,EAAAtb,EAAS,KAAOzI,GAAM,OAAO,KAAIyI,CAAA,EACjC48B,EAAgB,KAAOrmB,GAAkBvW,EAAS,IAAI,GAEpDzI,GAAM,OAAO,OAAS,SACxB+jB,EAAA,EAAAtb,EAAS,KAAOzI,GAAM,OAAO,KAAIyI,CAAA,EACjC48B,EAAgB,KAAOrmB,GAAkBvW,EAAS,IAAI,GAEpDzI,GAAM,OAAO,OAAS,SACxB+jB,EAAA,EAAAtb,EAAS,KAAOzI,GAAM,OAAO,KAAIyI,CAAA,EACjC48B,EAAgB,KAAOrmB,GAAkBvW,EAAS,IAAI,GAEpDzI,GAAM,OAAO,OAAS,SACxB+jB,EAAA,EAAAtb,EAAS,KAAOzI,GAAM,OAAO,KAAIyI,CAAA,EACjC48B,EAAgB,KAAOrmB,GAAkBvW,EAAS,IAAI,GAGtDzI,GAAM,OAAO,aAAe,QAC5ByI,aAAoBrgB,KAEpB27B,EAAA,EAAAtb,EAAS,WAAazI,GAAM,OAAO,WAAUyI,CAAA,EAC7C48B,EAAgB,WAAa58B,EAAS,WAAa,IAAM,KAEvDzI,GAAM,OAAO,OAAS,SACxB+jB,EAAA,EAAAtb,EAAS,KAAOzI,GAAM,OAAO,KAAIyI,CAAA,EACjC48B,EAAgB,KAAO58B,EAAS,MAE9BzI,GAAM,OAAO,sBAAwB,SACvC+jB,EAAA,EAAAtb,EAAS,oBAAsBzI,GAAM,OAAO,oBAAmByI,CAAA,EAC/D48B,EAAgB,GAAK58B,EAAS,oBAAsB,IAAM,KAE5DmB,GAAgB,OAAQm8B,IAEfA,IAELN,GAGFA,EAAoB,GACpBpJ,GAAO,GAEP8B,EAAa,kBAIFA,EAAc6H,GAAiB,GAAI,CAChD39B,EAAI,iBAAmBI,EAAS,EAAE,EAEhC,EAAAA,IAAa,MACb48B,IAAoB,QACpB58B,EAAS,OAAS48B,EAAgB,QAKlC58B,EAAS,OAAS,eACXA,EAAS,cAAiB,YAEjCA,EAAS,aAAY,EAEvBvhB,GAAWuhB,EAAS,KAAI,CAAI,OAAQ,EAAI,GACpCA,EAAS,eAAiB,UAAYu9B,IACxCrvB,GAA6BlO,EAAU,EAAQmG,CAAY,MAE7DnG,EAAS,WAAamG,EAAYnG,CAAA,EAC9B48B,EAAgB,OAAS58B,EAAS,MAAQA,EAAS,OAAS,SAE9D48B,EAAgB,KAAO58B,EAAS,KAChCJ,EAAI,+BAAiCg9B,EAAgB,IAAI,EACzDz7B,GAAgB,OAAQm8B,IAEfA,KAGPV,EAAgB,cAAgBz2B,EAAe,IAAM,OAEvDy2B,EAAgB,WAAaz2B,EAAe,IAAM,IAClDvG,EAAI,qCAAuCg9B,EAAgB,UAAU,EACrEz7B,GAAgB,OAAQm8B,IAEfA,KAGPV,EAAgB,OAAS7I,IAEvBA,IAAiB,GAAK6I,EAAgB,OAAS,QACjDA,EAAgB,KAAO,OACvBh9B,EAAI,+BAAiCg9B,EAAgB,IAAI,EACzDz7B,GAAgB,OAAQm8B,IAEfA,KAEAvJ,EAAe,GAAK6I,EAAgB,OAAS7I,IACtD6I,EAAgB,KAAO7I,EACvBn0B,EAAI,+BAAiCg9B,EAAgB,IAAI,EACzDz7B,GAAgB,OAAQm8B,IAEfA,UAIbt9B,EAAS,eAAiBq0B,EAAar0B,CAAA,EAErCA,EAAS,eAAiB,UAAQ,OAC3BA,EAAS,wBAA2B,YAC3Cu9B,IAEAv9B,EAAS,uBAAuBq0B,CAAa,EAE/C1d,GAAoC,QAC9Bwe,EAA4B,YAG3BqI,IAAa,CACpBliB,EAAA,EAAAvN,EAAsB,EAAI,EAC1BivB,EAAoB,GACpBt4B,GAAkB,OAAQprD,IAAC,CACnB,MAAA67C,GAAS6K,EAAS,gBAAkB,EACpC1uD,GAAM,CACP,GAAAgsD,GAAmB0C,EAAUpL,EAAU2I,CAAW,EACrD,OAAApI,IAEE,OAAA7jD,IAAU,OACZgI,GAAE67C,EAAM,EAAI7jD,IAEPgI,cAIFq8E,GAAe,CACtBp4B,EAAY,UAAU,OAAM,GAAIA,EAAY,SAAS,EACrDA,EAAY,UAAU,IACpB,cACA,OACA,SACA,OACA,sBACA,+BACA,wBACA,iCACA,cACA,UACA,gBACA,YACA,UACA,YACA,YACA,qCACA,8CACA,kBACA,qCACA,8CACA,kBACA,qBACA,eACA,sCACA,+CACA,mBACA,aACA,eACA,cACA,eAAe,iBAUJ43B,EACba,GAAsC,GAAK,iBAErClK,GAAI,EACJ,MAAAmK,GACJ,+BAAU,iBAA6B,kBAEvCA,IAAsB,MAEtBA,GAAkB,SAAW,UAEpB7gF,GAAI,EAAGA,GAAI6gF,GAAkB,OAAQ7gF,KAAC,IACzC4gF,GAA0B,CAEtB,MAAAE,GAAeD,GAAkB7gF,EAAC,EAAE,aACxC,qBAAqB,EAEjB+gF,GAAgBF,GAAkB7gF,EAAC,EAAE,aACzC,sBAAsB,KAExB6gF,GAAkB7gF,EAAC,EAAE,aAAa,QAAS8gF,IAAgB,GAAG,EAC9DD,GAAkB7gF,EAAC,EAAE,aAAa,SAAU+gF,IAAiB,GAAG,EAG9DF,GAAkB7gF,EAAC,GAAK,MACxB6gF,GAAkB7gF,EAAC,EAAE,eAAiB,KAAI,OAEpCghF,KACJ9lF,GAAA2lF,GAAkB7gF,EAAC,EAAE,gBAArB,YAAA9E,GAAoC,iBAClC,kBAAc,GAEP,UAAAiG,MAAO6/E,GAAa,CACvB,MAAA1mF,GAAI6G,GACV7G,GAAE,MAAM,YAAY,MAAOA,GAAE,QAAQ,IAAM,IAAI,EAC/CA,GAAE,MAAM,YAAY,OAAQA,GAAE,QAAQ,KAAO,IAAI,IAIjD,MAAA2mF,GAAcJ,GAAkB7gF,EAAC,EAAE,QAAQ,kBAAkB,KAEjEihF,IACAJ,GAAkB7gF,EAAC,EAAE,YAAcihF,GAAY,YAAW,OAEpD/jE,GACH+jE,GAAY,YAAc,IAAQJ,GAAkB7gF,EAAC,EAAE,YACpD+e,GAAQ8hE,GAAkB7gF,EAAC,EAAE,aAAa,OAAO,EACjDgf,GAAS6hE,GAAkB7gF,EAAC,EAAE,aAAa,QAAQ,MACpD6gF,GAAkB7gF,EAAC,EAAE,QAAQ,eAAiB+e,IAAS,OAC1D8hE,GAAkB7gF,EAAC,EAAE,QAAQ,cAAgB+e,KAE1C8hE,GAAkB7gF,EAAC,EAAE,QAAQ,gBAAkBgf,IAAU,OAC5D6hE,GAAkB7gF,EAAC,EAAE,QAAQ,eAAiBgf,IAEhD6hE,GAAkB7gF,EAAC,EAAE,aACnB,UAEE,OAAO6gF,GAAkB7gF,EAAC,EAAE,QAAQ,cAAc,EAAIkd,IACtD,SAAQ,GAEZ2jE,GAAkB7gF,EAAC,EAAE,aACnB,SAEE,OAAO6gF,GAAkB7gF,EAAC,EAAE,QAAQ,aAAa,EAAIkd,IACrD,SAAQ,GAIV2jE,GAAkB7gF,EAAC,GAAK,MACxB6gF,GAAkB7gF,EAAC,EAAE,gBAAkB,KAAI,OAErCghF,KACJ/lF,GAAA4lF,GAAkB7gF,EAAC,EAAE,gBAArB,YAAA/E,GAAoC,iBAClC,kBAAc,GAEP,UAAAkG,MAAO6/E,GAAa,CACvB,MAAA1mF,GAAI6G,GACJq5D,GAAa,OAAOlgE,GAAE,QAAQ,GAAG,GAAK,EACtCmgE,GAAc,OAAOngE,GAAE,QAAQ,IAAI,GAAK,EAC9CA,GAAE,MAAM,YAAY,OAAQkgE,GAAat9C,IAAM,SAAQ,EAAK,IAAI,EAChE5iB,GAAE,MAAM,YACN,QACCmgE,GAAcv9C,IAAM,SAAQ,EAAK,IAAI,MASpD,OAAO,SAAQ,UACP,MAAA6iE,EAA6B,EAAI,GAG1B,eAAAsI,EAAsBlmC,GAAkB,CACjDu9B,EAAiB,SAAW,GAC9B6H,EAAc,EAAI,QAEdjH,EAAa,WAOAn+B,IAAK,CACtB+jB,EAAA,GAAAr6C,EAAYs2B,GAAM,OAAO,YAEPmmC,EAAAnmC,QACjBqgC,EAAoBrgC,GAAM,OAAO,iBAAiB,WACzBA,IAAK,CAC/B+jB,EAAA,EAAA6b,EAAmB5/B,GAAM,OAAO,kBAChC+jB,EAAA,EAAAvN,EAAsBxW,GAAM,OAAO,qBAGjCw6B,GAAuB,GACvB/xB,EAAS,KAAO,QAChB+N,GAEA,OAAO,aAAa,QAAO,GAAI/N,EAAS,EAAE,IAAIA,EAAS,IAAI,GAAI,MAAM,EAEnEmG,IACFmV,EAAA,EAAAnV,EAAY,CAAIA,CAAA,MAChBnG,EAAS,WAAamG,EAAAnG,CAAA,QAChB01B,EAAa,SAEfP,EAA4B,YAER59B,IAAK,CAC/B+jB,EAAA,EAAAnV,EAAe5O,GAAM,OAAO,kBAC5ByI,EAAS,WAAamG,EAAAnG,CAAA,EACtBmB,GAAgB,OAAQxuD,KACtBA,GAAO0hF,CAAa,EAAE,WAAaluB,EAAe,IAAM,IACjDxzD,WAEH+iF,EAAa,gBA0BX3B,IAAYA,CAAA,EACZ2B,EAAc,EAAK,gBAWnB3B,IAAYA,CAAA,EACZ2B,EAAc,EAAK,gDAsHTn4B,EAAWgiB,yDAMV3qB,EAAQ2qB,6FAIRqY,EAAiB1pF,uDAxMN+uE,EAAWsC,+TA3cvC4X,GAAoBhxB,GAAgB5I,GAAao4B,EAAe,EAC/D,CAAAxvB,GAAgBvR,GAAQ0mB,EAAA,EAAE1mB,EAAS,UAAY,GAAEA,CAAA,MACtDsoC,EAAY,cAAa,CAAIH,EAAqBG,CAAA,MAClDA,EAAY,WAAa,GAAIA,CAAA,MAC7BA,EAAY,YAAc,GAAIA,CAAA,MAC9BA,EAAY,UAAY,GAAIA,CAAA,MAC5BA,EAAY,GAAKv/E,EAAEu/E,CAAA,MACnBA,EAAY,aAAe/2B,EAAY+2B,CAAA,MACvCA,EAAY,iBAAmBl9B,EAAS,iBAAiB,OAAS,EAACk9B,CAAA,EACnE5hB,EAAA,EAAA4hB,EAAY,MAAQl9B,EAAS,MAAQi9B,EAAqB,EAAAC,CAAA,MAC1DA,EAAY,eAAiB7I,EAAa6I,CAAA,MAC1CA,EAAY,mBAAqBL,EAAeK,CAAA,MAChDA,EAAY,kBAAoBtF,EAAiBsF,CAAA,6vCC3HhD,OAAA1hB,OAAQ,OAAM,EASTA,OAAQ,QAAO,wWAjBZ,IAAAtb,CAAqB,EAAA+a,GACrB,SAAAjb,CAAsB,EAAAib,GACtB,cAAAoZ,CAAqB,EAAApZ,GACrB,mBAAA0Y,CAA0B,EAAA1Y,EAC1B,qBAAAlN,EAA+B,EAAK,EAAAkN,GACpC,cAAA0hB,CAAsC,EAAA1hB,ogBC8CtBO,EAAmB,wLAAnBA,EAAmB,mIALxCA,EAAmB,6BACIA,EAAyB,cACzCA,EAAc,GAAC,UAAY,2KAFlCA,EAAmB,oCACIA,EAAyB,oBACzCA,EAAc,GAAC,UAAY,mLAJrC,OAAAA,OAAQ,QAAO,sGASMA,EAAc,uEAAxCV,EAES7qB,EAAA0tC,EAAApnE,CAAA,EADP8lD,EAAoCshB,EAAAhqE,CAAA,sMADZ6nD,EAAc,4KAhD3B,IAAAtb,CAAwB,EAAA+a,GACxB,SAAAjb,CAAsB,EAAAib,GACtB,eAAAjN,CAAsB,EAAAiN,GACtB,mBAAA0Y,CAA0B,EAAA1Y,EAEjCgC,QAEE+X,EAAmB,CACvB,MAAOh1B,EAAS,MAChB,GAAI,GACJ,eAAAgO,EACA,mBAAA2lB,EACA,gBAAiB,GACjB,YAAa,GACb,cAAe,GACf,gBAAiB,GACjB,UAAW,IAGbzY,GAAO,UACDlb,EAAS,MAAQ,MACnBid,EAAY,YAAYjd,EAAS,IAAI,QAEjCstB,EAAiB,IAAO,OAAO,MAAM,aAAY,CAAI,QAAS,GAAI,EACxErQ,EAAY,SAAS,CAAC,EAAE,cAAcqQ,CAAiB,IAGzDjP,GAAS,KACHre,EAAS,SAAW,MACtBA,EAAS,QAAO,8EAoBHid,EAAWsC,mOAf1ByV,EAAoB,eAAiBhnB,EAAcgnB,CAAA,MACnDA,EAAoB,mBAAqBrB,EAAkBqB,CAAA,4RCyEtDxZ,EAAQ,IAAAwS,GAAAxS,CAAA,kEAARA,EAAQ,IAAAD,EAAA,EAAAC,EAAAM,CAAA,iDACJyd,EAAA7E,GAAAlZ,KAAS,GAAG,uBAAjB,OAAInoE,GAAA,6JAACkmF,EAAA7E,GAAAlZ,KAAS,GAAG,oBAAjB,OAAInoE,GAAA,6HAAJ,wFAEQmoE,EAAG,MAAAh7B,EAAAo9C,EAAA,MAAAC,CAAA,iDAEkBriB,EAAU,gCAHvCV,EAKC7qB,EAAA2tC,EAAArnE,CAAA,0CAF4BilD,EAAU,uDAalCA,EAAQ,IAAAE,GAAAF,CAAA,srBAHAA,EAAc,YAF/BV,EA8BK7qB,EAAAusB,EAAAjmD,CAAA,EA1BH8lD,EAgBKG,EAAAJ,CAAA,wBAELC,EAIKG,EAAAzB,CAAA,SACLsB,EAEMG,EAAAC,CAAA,UAxBCjB,EAAQ,IAAAD,EAAA,EAAAC,EAAAM,CAAA,2BAHAN,EAAc,+DAIlBiZ,EAAAC,GAAAlZ,KAAS,MAAM,uBAApB,OAAInoE,GAAA,6JAACohF,EAAAC,GAAAlZ,KAAS,MAAM,oBAApB,OAAInoE,GAAA,6HAAJ,4FAKUmoE,EAAG,MAAAh7B,EAAAo9C,EAAA,MAAAC,CAAA,gDAEkBriB,EAAU,oCAHvCV,EAMC7qB,EAAA2tC,EAAArnE,CAAA,qBADYilD,EAA2B,kDAFXA,EAAU,uJALvCV,EAAuD7qB,EAAArwB,EAAArJ,CAAA,mEADpDilD,EAAqB,GAAAC,uNAnChCD,EAAmB,0NAclBA,EAAgB,IAAAsT,GAAAtT,CAAA,IAahBA,EAAmB,IAAAG,GAAAH,CAAA,oHAd1BV,EA+CK7qB,EAAAt8B,EAAA4C,CAAA,kFA5DCilD,EAAmB,6EAclBA,EAAgB,0DAahBA,EAAmB,uMA/GlB7O,EAAqB,IACtBmxB,MACAlxB,MACAC,IAGE,OAAAF,EAAsB,uCAAuC,EAC7D,OAAAA,EAAsB,uBAAuB,EAC7C,OAAAA,EAAsB,wCAAwC,EAC9D,OAAAA,EAAsB,4BAA4B,EAClD,OAAAA,EAAsB,uBAAuB,EAC7C,OAAAA,EAAsB,kBAAkB,MAEpC,KAAAY,CAAY,EAAA0N,GACZ,eAAAjN,CAAsB,EAAAiN,GACtB,mBAAA0Y,CAA0B,EAAA1Y,GAC1B,WAAA8iB,CAAkB,EAAA9iB,GAClB,qBAAArD,CAA6B,EAAAqD,EAClC,MAAA7N,EAAgBtB,GAAyBa,EAAuBY,CAAI,EACtE,GAAAtJ,GAAsBmJ,CAAa,SAC9BgJ,EAAQ4nB,CAAO,EAAI5wB,EAAc,KAAK,MAAM,GAAG,EAClDgJ,IAAW,OACfhJ,EAAc,IAAG,wCAA2CA,EAAc,KAAK,YAAYA,EAAc,IAAI,OAC7GA,EAAc,OAAM,wCAA2CA,EAAc,KAAK,YAAYA,EAAc,IAAI,YAEvGgJ,IAAW,OAClBhJ,EAAc,IAAG,wCAA2CA,EAAc,KAAK,YAAYA,EAAc,IAAI,OAC7GA,EAAc,OAAM,wCAA2CA,EAAc,KAAK,YAAYA,EAAc,IAAI,aAElHA,EAAc,IAAG,oCAAuCgJ,CAAM,IAAIhJ,EAAc,KAAK,YAAYA,EAAc,IAAI,OACnHA,EAAc,OAAM,oCAAuCgJ,CAAM,IAAIhJ,EAAc,KAAK,YAAYA,EAAc,IAAI,YAExH,QAAQ,IAAIA,CAAa,EAEnB,MAAA6wB,EACJl6B,GAAaqJ,CAAa,GAAKpJ,GAAWoJ,CAAa,MAC9CA,CAAa,EAClB,KACAz7D,EACJssF,IAAsB,KAClB,MAEE,IAAG,OACMA,EAAkB,KAAQ,SAC5B,CAAAA,EAAkB,GAAG,EACtBA,EAAkB,IACxB,OAAM,OACGA,EAAkB,QAAW,SAC/B,CAAAA,EAAkB,MAAM,EACzBA,EAAkB,QAE5B,IAAAlwB,EAAsB,GACtBopB,EAAmB,GACnBnC,EACAiJ,IAAsB,OACxBjJ,EAAmB,CACjB,MAAO,GACP,GAAI,GACJ,aAAc,GACd,cAAe,GACf,kBAAmB,GACnB,gBAAiB,GACjB,eAAAhnB,EACA,mBAAA2lB,EACA,YAAa,GACb,gBAAiB/b,GAEflU,GAAiBu6B,CAAiB,EACpCjJ,EAAoB,MAAK,GAAMiJ,EAAkB,aAAa,YAAW,KACvEA,EAAkB,MAAQ,EAC5B,IAAIA,EAAkB,KAAK,IAAIA,EAAkB,IAAI,IAAIA,EAAkB,MAAQ,EAAE,OAAOA,EAAkB,aAAa,GAE3HjJ,EAAoB,MAAQiJ,EAAkB,MAI9C,IAAAC,EAAwB,YAEnBC,GAA2B,CAClC7iB,EAAA,EAAA4iB,EAAwB,EAAI,UAQR3mC,GAAK,CACzB+jB,EAAA,EAAAvN,EAAsBxW,EAAM,OAAO,wBAElBA,GAAK,CACtB+jB,EAAA,EAAA6b,EAAmB5/B,EAAM,OAAO,WAChC+jB,EAAA,EAAAvN,EAAsBxW,EAAM,OAAO,uiBCHnBikB,EAAc,sNAAdA,EAAc,qRAVdA,EAAc,sNAAdA,EAAc,6NARvBA,EAAiB,mMAAjBA,EAAiB,gYARlB,IAAAA,KAAe,6JAAfM,EAAA,MAAAsiB,EAAA,IAAA5iB,KAAe,8QAPd,KAAAA,KAAe,gBACTA,EAAc,GAAC,GAAK,IACR,uBAAAA,KAAe,mLAFjCM,EAAA,IAAAuiB,EAAA,KAAA7iB,KAAe,2BACTA,EAAc,GAAC,GAAK,KACRM,EAAA,MAAAuiB,EAAA,uBAAA7iB,KAAe,yLANvC,OAAAA,OAAiB,SAAQ,EASpBA,OAAiB,OAAM,EAQvBA,OAAiB,SAAQ,EAMzBA,OAAiB,mBAAkB,EAUnCA,OAAiB,kBAAiB,mYAzF/B,eAAAtO,CAA+B,EAAA+N,GAC/B,eAAAjN,CAAsB,EAAAiN,GACtB,mBAAA0Y,CAA0B,EAAA1Y,EAC1B,qBAAAlN,EAAsB,EAAK,EAAAkN,GAC3B,cAAA0hB,CAAsC,EAAA1hB,EAS7Cjb,EACAs+B,EACAC,EAEJrjB,GAAO,UACD/N,GAASD,EAAe,IAAI,EAC9BoO,EAAA,EAAAgjB,EAAe,QAAQ,EACd9wB,GAASN,EAAe,IAAI,GACrCoO,EAAA,EAAAgjB,EAAe,QAAQ,MACvBC,EAAiB,MAASrpB,GAAmBhI,CAAc,SAE3DlN,EAAQ,MAASw+B,EAAYtxB,CAAc,OAC3CoxB,EAAY,MAASG,EAAgBz+B,CAAQ,MAIlC,eAAAw+B,EACbtxB,EAA+B,CAEzB,MAAAlN,EAAQ,MAASsN,GAA6BJ,EAAe,IAAI,EACvE,OAAAlN,EAAS,eAAiBgO,EAC1BX,GAAiCrN,EAAUkN,CAAc,EACrDA,EAAe,WAAUlN,EAAS,MAAQkN,EAAe,UACtDlN,EAGM,eAAAy+B,EAAgBz+B,EAAkB,QAC3CA,EAAS,cAAgBA,EAAS,aAAa,SAAS,MAAM,EACzD,OAGLwwB,EAAe,IAAM,SACrBA,EAAe,IAAM,WACrBA,EAAe,IAAM,UAEd,mBAEA,2rBCRAhwC,EAAA4/B,EAAA,QAAAC,EAAA,MAAA7E,+RACVA,EAAmB,GAAG,wBAA0B,GAAE,wHAUxCh7B,EAAA8/B,EAAA,QAAAC,EAAA,MAAA/E,8RACVA,EAAmB,GAAG,wBAA0B,GAAE,kIAnBvDV,EAUQ7qB,EAAAuwB,EAAAjqD,CAAA,EAJN8lD,EAGImE,EAAAJ,CAAA,WAENtF,EAUQ7qB,EAAAwwB,EAAAlqD,CAAA,EAJN8lD,EAGIoE,EAAAH,CAAA,sBAlBO9E,EAAS,iBAWTA,EAAQ,qBANNM,EAAA,GAAAuE,OAAA,MAAA7E,+RACVA,EAAmB,GAAG,wBAA0B,qBAUtCM,EAAA,GAAAyE,OAAA,MAAA/E,8RACVA,EAAmB,GAAG,wBAA0B,2IA7DxC,SAAA/hE,EAAqD,IAAI,EAAAwhE,EACzD,qBAAAyjB,EAA+B,EAAK,EAAAzjB,EAGzC,MAAA/6C,MADgB,gBAAgB,OAAO,SAAS,MAAM,EACxC,IAAI,GAAG,MACvB3iB,EAAe2iB,EAAI,OAAO,WAAWA,CAAC,EAAI,WAErCy+D,GAAS,CAEhBphF,EAAO,OAAO,YAAYA,EAAO,IAAK,QAAQ,CAAC,GAC/CqhF,EAAU,WAGHC,GAAQ,CAEfthF,EAAO,OAAO,YAAYA,EAAO,IAAK,QAAQ,CAAC,GAC/CqhF,EAAU,WAGHA,GAAU,CACjBn9B,GAAc,OAAQ9uD,IACpBA,EAAO,EAAI4K,EAAK,SAAQ,EACjB5K,IAGH,MAAAq8D,EAAc,SAAS,uBAAuB,eAAe,EACxD,UAAAC,KAAcD,EAAW,CAC5B,MAAAE,EAAUD,EAAW,qBAAqB,KAAK,EACrDE,GAAU,IAAKD,CAAO,EAAG,SAASshB,EAAe,GAAK,GAAG,GAGrD,MAAAphB,EAAa,SAAS,iBAAiB,cAAc,EAC3DD,GAAU,IAAKC,CAAU,EAAG,SAASohB,EAAe,GAAK,GAAG,GAC5D7Z,GAAqCme,CAAgB,QAE/CgK,EAAS,IAAO,YAAY,cAAa,CAC7C,OAAM,CAAI,KAAMtO,EAAe,CAAC,IAElC,SAAS,cAAcsO,CAAS,kQCrB3BtjB,EAAc,8GAHjBV,EAIK7qB,EAAAt8B,EAAA4C,CAAA,2BADFilD,EAAc,sGAKeA,EAAU,+BACvCA,EAAe,IAAI,mDAAkD,UAFxEV,EAGI7qB,EAAA58C,EAAAkjB,CAAA,gDAF4BilD,EAAU,+BACvCA,EAAe,IAAI,sHAVnBc,EAAAd,OAAmB,IAAEE,GAAAF,CAAA,EAOrBe,EAAAf,OAAe,IAAEG,GAAAH,CAAA,yFARDA,EAAI,2CARnBh7B,EAAAo7B,EAAA,QAAAiE,GAAArE,EAAO,GAAC,OACd,IAAE,0DACDA,EAAA,GACC,uCACA,qFAAoF,0BAP1FV,EA0BQ7qB,EAAA2rB,EAAArlD,CAAA,EAfN8lD,EAcGT,EAAAvoE,CAAA,gFAbImoE,OAAmB,0DAOnBA,OAAe,wFARCA,EAAI,2CARnBM,EAAA,IAAA+D,QAAArE,EAAO,GAAC,OACd,IAAE,0DACDA,EAAA,GACC,uCACA,0MAfO,KAAAQ,CAAY,EAAAf,EACZ,OAAApZ,EAAgB,EAAE,EAAAoZ,EAClB,UAAAc,EAAoB,EAAK,EAAAd,EACzB,gBAAA8jB,EAAyB,EAAE,EAAA9jB,EAC3B,YAAA+jB,EAAqB,EAAE,EAAA/jB,EACvB,iBAAAgkB,EAA0B,EAAE,EAAAhkB,2gBCc7BO,EAAO,GAAC,OAAS,wLAJHA,EAAe,sCAC5BA,EAAO,YAFpBV,EAcK7qB,EAAAt8B,EAAA4C,CAAA,wDATOilD,EAAO,GAAC,OAAS,yMAJHA,EAAe,kEAC5BA,EAAO,iHAfP,KAAAQ,CAAY,EAAAf,GACZ,QAAAikB,CAAe,EAAAjkB,EACf,iBAAAkkB,EACT,QAAQ,EAAAlkB,EACC,OAAApZ,EAAgB,EAAE,EAAAoZ,EAClB,UAAAc,EAAoB,EAAK,EAAAd,EACzB,gBAAA8jB,EAAyB,EAAE,EAAA9jB,EAC3B,YAAA+jB,EAAqB,EAAE,EAAA/jB,EACvB,iBAAAgkB,EAA0B,EAAE,EAAAhkB,opBCmBHO,EAAc,KAAAh7B,EAAAo9C,EAAA,MAAAC,CAAA,6BAA5C/iB,EAA4D7qB,EAAA2tC,EAAArnE,CAAA,2BAA9BilD,EAAc,mFADzCA,EAAc,IAAAG,GAAAH,CAAA,qHAQRA,EAAW,gHAObA,EAAW,oRAhBUA,EAAgB,KAAAh7B,EAAA4+C,EAAA,MAAAC,CAAA,gSAXpDvkB,EA6BK7qB,EAAAwsB,EAAAlmD,CAAA,EAzBH8lD,EAkBKI,EAAA1B,CAAA,EAjBHsB,EAICtB,EAAAukB,CAAA,SACDjjB,EAKKtB,EAAAqB,CAAA,EAJHC,EAA+DD,EAAAgjB,CAAA,mGAAjC5jB,EAAgB,mBACzCA,EAAc,0SAxBZ,mBAAA+jB,EAAgC,IAAI,EAAAtkB,EACpC,kBAAAukB,EACT,sDAAsD,EAAAvkB,EAC7C,MAAAe,EAAe,SAAS,EAAAf,WAE1BwkB,GAAW,CAClB,OAAO,QAAQ,aAAY,GAAK,GAAI,OAAO,SAAS,IAAI,EACxDjtB,GAAiB,EAAE,EACnB,OAAO,QAAQ,aAAY,GAAK,GAAI,OAAO,SAAS,IAAI,6VCGhC,UAAQ,uEAKV,SAAO,g5BAbpBgJ,EAAO,GAAC,OAAS,qBAAqB,4DADnDV,EAiBK7qB,EAAAusB,EAAAjmD,CAAA,EAdH8lD,EAaKG,EAAAC,CAAA,EAVHJ,EAIKI,EAAAL,CAAA,wBACLC,EAIKI,EAAA1B,CAAA,oLAdIS,EAAO,GAAC,OAAS,qBAAqB,grBCJnDV,EAWQ7qB,EAAAyvC,EAAAnpE,CAAA,6zBC4bGuiE,EAAAtd,MAAe,MAAK,iGAL8BA,EAAc,IAAC,WAClE,WACI,WACA,uBAAqB,8FAJ3BV,EAOK7qB,EAAAt8B,EAAA4C,CAAA,iBADFulD,EAAA,UAAAgd,OAAAtd,MAAe,MAAK,KAAAsE,GAAAz5D,EAAAyyE,CAAA,oEAL8Btd,EAAc,IAAC,WAClE,WACI,WACA,uBAAqB,+JAqBlBA,EAAgB,eAAuBA,EAAc,oBAA1D,OAAInoE,GAAA,mMAACmoE,EAAgB,8HAsBVA,EAAkB,IAACA,EAAC,KAAE,UACrB,IACAA,EAAkB,IAACA,EAAC,KAAE,kEAPLA,EAAkB,IAACA,EAAC,KACpC,SAAS,sBAAkBA,EAAkB,IAACA,EAAC,KAC/C,iBAAiB,wLAHtBV,EASK7qB,EAAAt8B,EAAA4C,CAAA,qCAHFilD,EAAkB,IAACA,EAAC,KAAE,UACrB,IACAA,EAAkB,IAACA,EAAC,KAAE,oBAAiBsE,GAAAz5D,EAAAyyE,CAAA,gCAPtBtd,EAAkB,IAACA,EAAC,KACpC,SAAS,mCAAkBA,EAAkB,IAACA,EAAC,KAC/C,iBAAiB,iDALvBmkB,EAAAnkB,MAAI,EAAC,6BACDA,EAAkB,IAACA,EAAC,OAAM,QAAS8e,GAAA9e,CAAA,uGAFvCA,EAAa,wGAHMA,EAAC,qaAPAh7B,EAAAo7B,EAAA,QAAAiE,EAAA,mBAAArE,EAAY,KAAKA,EAAA,IACpC,aACA,cAAY,uLACLI,EAAA,SAAAgkB,EAAApkB,OAAiBA,EAAC,yCALjCV,EAkCK7qB,EAAA8qB,EAAAxkD,CAAA,EAjCH8lD,EAgCQtB,EAAAa,CAAA,EAzBNS,EAkBKT,EAAAQ,CAAA,oDACLC,EAEOT,EAAAikB,CAAA,SACPxjB,EAEOT,EAAAkkB,CAAA,kEApBJtkB,EAAa,KACbM,EAAA,MAAA6jB,OAAAnkB,MAAI,EAAC,KAAAsE,GAAAigB,EAAAJ,CAAA,EACDnkB,EAAkB,IAACA,EAAC,OAAM,kGALXA,EAAC,kBAPAM,EAAA,OAAA+D,OAAA,mBAAArE,EAAY,KAAKA,EAAA,IACpC,aACA,cAAY,uMACLM,EAAA,OAAA8jB,OAAApkB,OAAiBA,EAAC,gGAiC5BA,EAAS,eAAiBA,EAAC,IAAG,IAAMA,EAAQ,oBAAjD,OAAInoE,GAAA,mMAACmoE,EAAS,6QAkBHA,EAAiB,GAACA,EAAC,OAAM,GAAO,GAAK,YAAW,6FAIhDA,EAAiB,GAACA,EAAC,OAAM,GAAQ,GAAK,YAAW,UANpDV,EAGM7qB,EAAAmsB,EAAA7lD,CAAA,WACNukD,EAGM7qB,EAAA8qB,EAAAxkD,CAAA,+GALHilD,EAAiB,GAACA,EAAC,OAAM,GAAO,GAAK,4HAIrCA,EAAiB,GAACA,EAAC,OAAM,GAAQ,GAAK,yFAR1CmkB,EAAAnkB,MAAI,EAAC,6BACDA,EAAkB,IAACA,EAAC,OAAM,QAASgf,GAAAhf,CAAA,uGAFvCA,EAAa,wGAHMA,EAAC,gaAPAh7B,EAAAo7B,EAAA,QAAAiE,EAAA,mBAAArE,EAAY,KAAKA,EAAA,IACpC,aACA,cAAY,uLACLI,EAAA,SAAAgkB,EAAApkB,OAAiBA,EAAC,yCALjCV,EAgCK7qB,EAAA8qB,EAAAxkD,CAAA,EA/BH8lD,EA8BQtB,EAAAa,CAAA,EAvBNS,EAgBKT,EAAAQ,CAAA,oDACLC,EAEOT,EAAAikB,CAAA,SACPxjB,EAEOT,EAAAkkB,CAAA,kEAlBJtkB,EAAa,KACbM,EAAA,MAAA6jB,OAAAnkB,MAAI,EAAC,KAAAsE,GAAAigB,EAAAJ,CAAA,EACDnkB,EAAkB,IAACA,EAAC,OAAM,kGALXA,EAAC,kBAPAM,EAAA,MAAA+D,OAAA,mBAAArE,EAAY,KAAKA,EAAA,IACpC,aACA,cAAY,uMACLM,EAAA,MAAA8jB,OAAApkB,OAAiBA,EAAC,kGAyP5BA,EAAS,eAAiBA,EAAC,IAAG,IAAMA,EAAQ,oBAAjD,OAAInoE,GAAA,kOAHRynE,EAyBK7qB,EAAAt8B,EAAA4C,CAAA,+EAtBIilD,EAAS,gFAAd,OAAInoE,GAAA,+JAtICmoE,EAAS,eAAiBA,EAAC,IAAG,IAAMA,EAAQ,oBAAjD,OAAInoE,GAAA,mHADRynE,EAkIK7qB,EAAAt8B,EAAA4C,CAAA,sFAjIIilD,EAAS,gFAAd,OAAInoE,GAAA,iKAdCmoE,EAAgB,eAAuBA,EAAc,oBAA1D,OAAInoE,GAAA,sIAJgBmtC,EAAA7sB,EAAA,QAAAsqD,EAAA,kBAAAzC,EAAc,IAAC,WACjC,eACA,GAAE,UAJRV,EAiBK7qB,EAAAt8B,EAAA4C,CAAA,kFAXIilD,EAAgB,oDAJD,CAAAvvD,GAAA6vD,EAAA,UAAAmC,OAAA,kBAAAzC,EAAc,IAAC,WACjC,eACA,mDAEF,OAAInoE,GAAA,iKAnBCmoE,EAAgB,eAAuBA,EAAc,oBAA1D,OAAInoE,GAAA,sIAJgBmtC,EAAA7sB,EAAA,QAAAsqD,EAAA,kBAAAzC,EAAc,IAAC,WACjC,eACA,GAAE,UAJRV,EAiBK7qB,EAAAt8B,EAAA4C,CAAA,iFAXIilD,EAAgB,oDAJD,CAAAvvD,GAAA6vD,EAAA,UAAAmC,OAAA,kBAAAzC,EAAc,IAAC,WACjC,eACA,mDAEF,OAAInoE,GAAA,+JA/CDmoE,EAAgB,eAAuBA,EAAc,oBAA1D,OAAInoE,GAAA,wMAACmoE,EAAgB,wFAArB,OAAInoE,GAAA,8IA4Na66E,EAAA1S,KAAUA,EAAC,cAIXA,EAAQ,kNARrBV,EAWK7qB,EAAAusB,EAAAjmD,CAAA,EAVH8lD,EASKG,EAAAC,CAAA,EARHJ,EAGKI,EAAAL,CAAA,uBACLC,EAGKI,EAAA1B,CAAA,+BALIe,EAAA,OAAAoS,OAAA1S,KAAUA,EAAC,WAAAY,EAAA,UAAA8R,kBAIX1S,EAAQ,UAAAT,EAAA,UAAAqT,4CAOVhgB,GAAuBoN,EAAW,GAACA,EAAC,kGAH/CV,EAKK7qB,EAAA8qB,EAAAxkD,CAAA,EAJH8lD,EAGKtB,EAAAqB,CAAA,+CADIhO,GAAuBoN,EAAW,GAACA,EAAC,YAAAY,EAAA,UAAA2M,scAhIqBvoC,EAAA47B,EAAA,QAAAgO,EAAA,oDAAA5O,KACtDA,EAAA,OACI,GACF,GACA,SAAQ,EAGqCh7B,EAAAu6B,EAAA,QAAAkS,EAAA,6CAAAzR,KAC/CA,EAAA,OACI,GACF,GACA,SAAQ,UAZdV,EAMM7qB,EAAAmsB,EAAA7lD,CAAA,WACNukD,EAMM7qB,EAAA8qB,EAAAxkD,CAAA,UAZoDulD,EAAA,QAAAsO,OAAA,oDAAA5O,KACtDA,EAAA,OACI,GACF,GACA,2BAG6CM,EAAA,QAAAmR,OAAA,6CAAAzR,KAC/CA,EAAA,OACI,GACF,GACA,kFA0DGpN,GAAuBoN,EAAW,GAACA,EAAC,2BApBxCD,EAAAC,EAAoB,GAACA,EAAC,KAAE,SAAW,GAACmf,GAAAnf,CAAA,+wBANiHA,EAAC,IACvJ,OACA,QAAM,uDAHZV,EAsCK7qB,EAAAusB,EAAAjmD,CAAA,wBAhBH8lD,EAMKG,EAAAJ,CAAA,uBAELC,EAIKG,EAAAzB,CAAA,SACLsB,EAEMG,EAAAC,CAAA,kBA9BDjB,EAAoB,GAACA,EAAC,KAAE,SAAW,yEAoB/BpN,GAAuBoN,EAAW,GAACA,EAAC,YAAAY,EAAA,UAAA2M,6KA1B6GvN,EAAC,IACvJ,OACA,QAAM,wHAeGuN,EAAAvN,KAAqBA,EAAC,kXAVjCV,EAYK7qB,EAAAwsB,EAAAlmD,CAAA,EATH8lD,EAIKI,EAAAL,CAAA,SACLC,EAGKI,EAAA1B,CAAA,wBADIe,EAAA,QAAAiN,OAAAvN,KAAqBA,EAAC,WAAAT,EAAA,UAAAgO,uGAmCjC,6BACA,uBAAuB,sEAJhBvN,EAAyB,IAAG,OAAS,EAAE,UAApDV,EAQK7qB,EAAAt8B,EAAA4C,CAAA,wDARQilD,EAAyB,IAAG,OAAS,6MAJnC,SAAAA,MAAiBA,EAAC,4FAJjCV,EAMK7qB,EAAAt8B,EAAA4C,CAAA,0CAFUulD,EAAA,UAAAkkB,EAAA,SAAAxkB,MAAiBA,EAAC,qIAjGvB+Y,EAAA/Y,MAAI,EAAC,+BA2CJ0S,EAAA1S,KAAUA,EAAC,cAIXA,EAAQ,+BAxCZA,EAAkB,IAACA,EAAC,OAAM,QAASge,GAAAhe,CAAA,oCA2CrC,IAAAe,EAAAf,MAAoBA,EAAC,MAAAie,GAAAje,CAAA,yCA0CvB,OAAAA,EAAS,GAACA,EAAc,GAACA,QAAI,WAAU,EAQlCA,MAAe,qBAAoB,iHArG7C,WACW,sJAEoCh7B,EAAA47B,EAAA,QAAAgO,EAAA,uCAAA5O,EAAY,KACvDA,EAAA,IACI,8BACA,4BAA0B,0EARXA,EAAC,0FAPHh7B,EAAAo7B,EAAA,QAAAiE,EAAA,iBAAArE,EAAY,KAAKA,EAAA,IAClC,8BACA,4BAA0B,gKACnBI,EAAA,SAAAgkB,EAAApkB,OAAiBA,EAAC,kBALpBA,EAAyB,IAAG,GAAK,QAAQ,sMAkD5BoZ,EAAAjG,EAAA,aAAAnT,EAAc,IAAC,GAAK,GAAG,SAAQ,+EANS5W,GAC1D,UACA,GAAE,EANApkB,EAAAy/C,EAAA,QAAAC,EAAA1kB,OAAiBA,EAAC,IAAG,GAAK,QAAQ,wBAC1BA,EAAc,GAACA,EAAC,QAAKA,EAAC,0DA1C1CV,EA8HK7qB,EAAAgxB,EAAA1qD,EAAA,EA7HH8lD,EAsCK4E,EAAAxE,CAAA,EArCHJ,EAoCQI,EAAAb,CAAA,EA7BNS,EA4BKT,EAAAb,CAAA,uBAvBHsB,EAsBKtB,EAAAqB,CAAA,wBAIXC,EAqFK4E,EAAAgf,CAAA,EAjFH5jB,EAgFK4jB,EAAAE,CAAA,EA3EH9jB,EAuDK8jB,EAAAxR,CAAA,EAnDHtS,EASKsS,EAAAF,CAAA,EARHpS,EAGKoS,EAAAjS,CAAA,uBACLH,EAGKoS,EAAA9R,CAAA,yHAhDG,CAAA1wD,GAAA6vD,GAAA,OAAAyY,OAAA/Y,MAAI,EAAC,KAAAsE,GAAA0U,EAAAD,CAAA,EAOR/Y,EAAkB,IAACA,EAAC,OAAM,mEALY,CAAAvvD,GAAA6vD,GAAA,MAAAsO,OAAA,uCAAA5O,EAAY,KACvDA,EAAA,IACI,8BACA,4BAA0B,qGARXA,EAAC,oBAPH,CAAAvvD,GAAA6vD,GAAA,MAAA+D,OAAA,iBAAArE,EAAY,KAAKA,EAAA,IAClC,8BACA,4BAA0B,kLACnB,CAAAvvD,GAAA6vD,GAAA,MAAA8jB,OAAApkB,OAAiBA,EAAC,gDALpBA,EAAyB,IAAG,GAAK,4BAuD7B,CAAAvvD,GAAA6vD,GAAA,QAAAoS,OAAA1S,KAAUA,EAAC,WAAAgB,EAAA,UAAA0R,yBAIX1S,EAAQ,UAAAmB,EAAA,UAAAyR,GAGd5S,MAAoBA,EAAC,mFAZNoZ,EAAAjG,EAAA,aAAAnT,EAAc,IAAC,GAAK,GAAG,SAAQ,2KAV/C,CAAAvvD,GAAA6vD,GAAA,MAAAokB,OAAA1kB,OAAiBA,EAAC,IAAG,GAAK,6DAClBA,EAAc,GAACA,EAAC,QAAKA,EAAC,4MArDrBA,EAAC,uBACGA,EAAgB,GAAC,OAAS,sBACzBA,EAAc,IAAC,WAAa,kJALtDV,EAQK7qB,EAAAt8B,EAAA4C,CAAA,4GALgBilD,EAAC,mCACGA,EAAgB,GAAC,OAAS,sCACzBA,EAAc,IAAC,WAAa,kMArBjCA,EAAC,uBACGA,EAAgB,GAAC,OAAS,EACzB,oBAAAA,MAAoBA,EAAC,+IAL/CV,EAQK7qB,EAAAt8B,EAAA4C,CAAA,4GALgBilD,EAAC,mCACGA,EAAgB,GAAC,OAAS,GACzBM,EAAA,UAAAskB,EAAA,oBAAA5kB,MAAoBA,EAAC,6NA7BvCV,EAAsD7qB,EAAAt8B,EAAA4C,CAAA,8CALnDilD,EAAkB,IAACA,EAAC,KAAE,eACrB,IACAA,EAAkB,IAACA,EAAC,KAAE,0JAL1BV,EAMK7qB,EAAAt8B,EAAA4C,CAAA,qCAHFilD,EAAkB,IAACA,EAAC,KAAE,eACrB,IACAA,EAAkB,IAACA,EAAC,KAAE,oBAAiBsE,GAAAz5D,EAAAyyE,CAAA,iDAPnCvE,EAAA/Y,MAAI,EAAC,sDACVA,EAAkB,IAACA,EAAC,OAAM,OAASC,qHAiBzBD,EAAC,uBACGA,EAAgB,GAAC,OAAS,EACzB,oBAAAA,MAAoBA,EAAC,kGArB3C,WACW,2FAHYA,EAAC,2FAPTh7B,EAAAo7B,EAAA,QAAAiE,EAAA,WAAArE,EAAY,KAAKA,EAAA,IAC5B,8BACA,4BAA0B,gKACnBI,EAAA,SAAAgkB,EAAApkB,OAAiBA,EAAC,kBALpBA,EAAyB,IAAG,GAAK,QAAQ,EA2BzCh7B,EAAAi8B,EAAA,QAAAyP,EAAA1Q,OAAiBA,EAAC,IAAG,GAAK,QAAQ,oDA5BjDV,EAqCK7qB,EAAAusB,EAAAjmD,CAAA,EApCH8lD,EA0BKG,EAAAzB,CAAA,EAzBHsB,EAwBQtB,EAAAa,CAAA,EAjBNS,EAgBKT,EAAAQ,CAAA,0CAGTC,EAQKG,EAAAC,CAAA,mEAvBW,CAAAxwD,GAAA6vD,EAAA,OAAAyY,OAAA/Y,MAAI,EAAC,KAAAsE,GAAA0U,EAAAD,CAAA,yGAHM/Y,EAAC,oBAPT,CAAAvvD,GAAA6vD,EAAA,OAAA+D,OAAA,WAAArE,EAAY,KAAKA,EAAA,IAC5B,8BACA,4BAA0B,kLACnB,CAAAvvD,GAAA6vD,EAAA,OAAA8jB,OAAApkB,OAAiBA,EAAC,+CALpBA,EAAyB,IAAG,GAAK,iGA8BzBA,EAAC,mCACGA,EAAgB,GAAC,OAAS,GACzBM,EAAA,UAAAskB,EAAA,oBAAA5kB,MAAoBA,EAAC,iBALlC,CAAAvvD,GAAA6vD,EAAA,OAAAoQ,OAAA1Q,OAAiBA,EAAC,IAAG,GAAK,gNAsNVh7B,EAAA7sB,EAAA,QAAAsqD,EAAA,+BAAAzC,EAAc,IAAC,UAC9C,QACA,GAAE,UAHRV,EAMK7qB,EAAAt8B,EAAA4C,CAAA,4BALgC,CAAAtK,GAAA6vD,EAAA,YAAAmC,OAAA,+BAAAzC,EAAc,IAAC,UAC9C,QACA,oMAjYHA,EAAc,IAAC,IAAM,WAAaA,EAAc,IAAC,IAAM,YAAS4e,GAAA5e,CAAA,oEAoBlCA,EAAc,IAAC,OAAU,UACpDA,EAAc,IAAC,MAAM,OAAS,kBAatBA,EAAc,IAAC,OAAU,UAAYA,EAAc,IAAC,MAAM,OAAS,GAAC6d,GAAA7d,CAAA,EAyBzEyU,EAAAzU,EAAc,IAAC,WAAa,oBAAsBA,EAAyB,KAAA8d,GAAA9d,CAAA,EAuC3E0U,EAAA1U,EAAc,IAAC,WAAa,0BAA4BA,EAAyB,KAAA6kB,GAAA7kB,CAAA,yDAyCnFA,GAAc,IAAC,WAAa,kBAAiB,EAyCxCA,GAAc,IAAC,WAAa,aAAY,EAmBxCA,GAAc,IAAC,WAAa,SAAWA,GAAc,IAAC,WAAa,QAAO,EAmB1EA,GAAc,IAAC,WAAa,wBAAuB,EAoInDA,GAAc,IAAC,WAAa,SAAQ,qDA+B7CA,EAAc,IAAC,IAAM,WAAaA,EAAc,IAAC,IAAM,WAASG,GAAAH,CAAA,8VA/WhEA,EAAc,IAAC,IAAM,WAAaA,EAAc,IAAC,IAAM,UACpD,iBACA,GAAE,EAZyCh7B,EAAAu6B,EAAA,QAAAkS,EAAA,4CAAAzR,EAAc,IAAC,OAC9D,UACAA,EAAc,IAAC,MAAM,SAAW,GAChCA,EAAc,IAAC,WAAa,cAC7BA,EAAc,IAAC,OAAS,MAAQA,EAAc,IAAC,MAAM,OAAS,EAC3D,WACA,aAAW,qHAqCkDA,EAAc,IAAC,WAC5E,kBACIA,EAAgB,GAAC,OACjBA,KAAU,QAAM,KAChBA,EAAc,IAAC,WAAa,mBAAiB,CAC9CA,OACFA,EAAc,IAAC,WAAa,0BAC1BA,EAAyB,IACxB,qCACA,cAAY,wHA7BHh7B,EAAAg8B,EAAA,QAAA4T,GAAA,OAAA5U,MAAe,OAAU,UACxCA,EAAc,IAAC,MAAM,SAAW,GAChCA,EAAc,IAAC,WAAa,aACxB,SACA,WAAS,wGAnC8Ih7B,EAAAm9C,EAAA,QAAA2C,EAAA,2JAAA9kB,EAAS,IAAC,SACrK,OACA,GAAE,WAJRV,EA4YS7qB,GAAA0tC,EAAApnE,CAAA,wBAnYP8lD,EAqBKshB,EAAA5iB,CAAA,EAZHsB,EAWKtB,EAAAqB,CAAA,qBAEPC,EAkWKshB,EAAAlP,CAAA,EAjWHpS,EA8GKoS,EAAAjS,CAAA,wBA3FHH,EA0FKG,EAAAC,CAAA,8CAGPJ,EAgPKoS,EAAA9R,CAAA,wHA1XFnB,GAAc,IAAC,IAAM,WAAaA,GAAc,IAAC,IAAM,wKAoBzBA,GAAc,IAAC,OAAU,UACpDA,GAAc,IAAC,MAAM,OAAS,sJAPjCA,GAAc,IAAC,IAAM,WAAaA,GAAc,IAAC,IAAM,UACpD,iBACA,uBAZ2C,CAAAvvD,GAAA6vD,EAAA,UAAAmR,OAAA,4CAAAzR,GAAc,IAAC,OAC9D,UACAA,GAAc,IAAC,MAAM,SAAW,GAChCA,GAAc,IAAC,WAAa,cAC7BA,GAAc,IAAC,OAAS,MAAQA,GAAc,IAAC,MAAM,OAAS,EAC3D,WACA,aAAW,uCAwBDA,GAAc,IAAC,OAAU,UAAYA,GAAc,IAAC,MAAM,OAAS,2DAyBxEA,GAAc,IAAC,WAAa,oBAAsBA,GAAyB,6DAuC3EA,GAAc,IAAC,WAAa,0BAA4BA,GAAyB,kJAnDzBA,GAAc,IAAC,WAC5E,kBACIA,GAAgB,GAAC,OACjBA,MAAU,QAAM,KAChBA,GAAc,IAAC,WAAa,mBAAiB,CAC9CA,QACFA,GAAc,IAAC,WAAa,0BAC1BA,GAAyB,IACxB,qCACA,cAAY,0IA7BH,CAAAvvD,GAAA6vD,EAAA,UAAAsU,QAAA,OAAA5U,OAAe,OAAU,UACxCA,GAAc,IAAC,MAAM,SAAW,GAChCA,GAAc,IAAC,WAAa,aACxB,SACA,WAAS,yOA8VZA,GAAc,IAAC,IAAM,WAAaA,GAAc,IAAC,IAAM,qHAjYmG,CAAAvvD,GAAA6vD,EAAA,YAAAwkB,OAAA,2JAAA9kB,GAAS,IAAC,SACrK,OACA,2hBAlXA,IAAArjE,EAAuB,EACvBk8C,EAAS,GACTX,EAAS,GACTka,EAAS,GACTC,EAAW,GACXC,EAAoB,GACpBE,EAAc,GACdC,EAAwB,SACtBiS,EAAiB,GACjBqgB,EAAgB,OAClBxyB,EAAmB,SACjByyB,EAAc,GAChB,IAAAC,EAA6B,SAAS,KAAK,YAC3CC,EACE,MAAAnB,EAAiBoB,EAAQ,MAAM,SAC/BnB,EAAmBmB,EAAQ,QAAQ,kBAEhCC,GAAY,CACb,MAAAC,GAAajqB,GAAoC,EACvDnV,GAAc,OAAM,KAClBo/B,GAAW,EAAI,QACRA,cAYFC,EAAcC,GAAaC,GAAqB,CACnD,GAAAxQ,EAAe,WAAa,cAAgBwQ,KAAkB,QACzD,WAEH,MAAAC,GAAsB,SAAS,eAAe,oBAAoB,EAClEC,GAAmB,SAAS,eAAe,kBAAkB,EAK7DC,IAHyBF,GAC3BA,GAAoB,aAClBF,GAAM,EAAIzP,GAAY,CAAC,GAAK,GAAM,IAEb0P,GAAgB,EAAI1P,GAAY,GAAG,SAE5D6P,IACA3P,GACE,cACAG,GAAcuP,IAAoB,SAAS,IAAI,IAG7CE,GAAyBviB,GAAAla,GAAEy8B,EAA4B,GAAKA,CAAA,EACzD,YAEPD,IACA3P,GAAa,QAASG,GAAcuP,IAAoB,SAAS,IAAI,GACnE,IAEEE,GAAyBviB,GAAAla,GAAEy8B,EAA4B,GAAKA,CAAA,EACzD,MAEPD,IACA3P,GAAa,KAAMG,GAAcuP,IAAoB,SAAS,IAAI,GAAK,IAEnEE,GAAyBviB,GAAAla,GAAEy8B,EAA4B,GAAKA,CAAA,EACzD,KAEFA,GAAyBviB,GAAAla,GAAEy8B,EAA4B,GAAIA,CAAA,EACzD,aAcFC,EAAmBN,GAAaO,GAAqB,CACxD,GAAA9Q,EAAe,WAAa,cAAgB8Q,KAAkB,QACzD,WAEH,MAAAL,GAAsB,SAAS,eAAe,oBAAoB,EAClEM,GAAmB,SAAS,eAAe,kBAAkB,EAK7DJ,IAHyBF,GAC3BA,GAAoB,aAClBF,GAAM,EAAIzP,GAAY,CAAC,GAAK,GAAM,IAEbgQ,GAAgB,EAAIhQ,GAAY,EAAG,SAE5D6P,IACA3P,GACE,cACAG,GAAc4P,IAAoB,SAAS,IAAI,IAGjD1iB,GAAAja,GAAA48B,EAA4B,GAAKA,CAAA,EAC1B,YAEPL,IACA3P,GAAa,OAAQG,GAAc4P,IAAoB,SAAS,IAAI,GAClE,IAEF1iB,GAAAja,GAAA48B,EAA4B,GAAKA,CAAA,EAC1B,KAEPL,IACA3P,GAAa,KAAMG,GAAc4P,IAAoB,SAAS,IAAI,GAAK,IAEvE1iB,GAAAja,GAAA48B,EAA4B,GAAKA,CAAA,EAC1B,KAEP3iB,GAAAja,GAAA48B,EAA4B,GAAIA,CAAA,EACzB,IAaXhX,GAAY,QAIZ/L,GAAW,WAIH6O,GAAiB,IAAO,OAAO,MAAM,oBAAmB,CAC5D,QAAS,GAAI,KAEf,SAAS,cAAcA,EAAiB,EACpCoT,EAAY,CAER,MAAAnjF,GAAO,OADEizE,EACY,CAAC,GAAK,EACjCzhB,GAAc2xB,EAAcnjF,EAAI,SAIhCkkF,GACJvmB,GAAO,aAIDsV,EAAe,WAAa,OAAS,CACjC,MAAAqQ,GAAajqB,GAAoC,EACvDiqB,GAAW,EAAI,QACfp/B,GAAc,OAAM,IACXo/B,IAETD,EAAY,OAGR7P,EAAmB,OAAS,GAC9BrsB,GAAkB,OAAM,WAGxB8rB,EAAe,iBAAmB,IACzB,UAAAlvB,MAASwzB,EACdxzB,GAAM,aAAe,MACvBA,GAAM,WAAa,KAKrBkvB,EAAe,WAAa,0BAM9BlV,EAAA,EAAAjnB,EAAS,MAAS,QAAQ,IAAIyY,GAAkB,IAGhD40B,EAAc,IAIdlR,EAAe,WAAa,YAC5BA,EAAe,WAAa,UAC5BA,EAAe,WAAa,QAC5BA,EAAe,WAAa,mBAGtB1E,GAAI,EAKV2V,GAAc,IAAO,eAAgBjtF,IAAC,CAE9B,MAAA67D,OADU,IAAI,OAAO,SAAS,IAAI,EACrB,aAAa,IAAI,QAAQ,EAC5C,OAAO,OAAO,aAEV,gBAAiB77D,GAAE,CAAC,EAAE,YAAY,OAClC,OAAQ,kBACR,OAAA67D,IAEF,OAIAqwB,GAAgB,MAAMe,GAAe,QAAQf,CAAY,GAG3DlQ,EAAe,WAAa,mBAC9BA,EAAe,kBAAoB,GAAKA,CAAA,EACxC,QAAQ,IAAI,yCAAyC,EACrDpd,GAAc,KAKlBiL,GAAS,KACHojB,IAAgBA,GAAe,WAAU,mBAGhCC,GAAc,OACrBnR,GAAe5iB,GAA4BtZ,CAAS,SAC1DX,EAAS,IAAO68B,GAAa,SAAS,OACtC3iB,EAAS,IAAO2iB,GAAa,SAAS,OACtC1iB,EAAW,IAAO0iB,GAAa,WAAW,OAC1CziB,EAAoB,IAAOyiB,GAAa,oBAAoB,QAC5DxiB,EAAmB,IAAOwiB,GAAa,mBAAmB,OAC1DviB,EAAc,IAAOuiB,GAAa,cAAc,GAChDtiB,EAAwB,IAAOsiB,GAAa,wBAAwB,EAChEC,EAAe,WAAa,wBAAuB,CAErD7Z,GAAqCme,CAAgB,QAC/ChJ,GAAI,EACJ,MAAA6V,GAAO,SAAS,cAA2B,MAAM,EACnDA,IACFnrB,GAAkBmrB,EAAI,EAExB3kB,GAAY,QAGRQ,GADU,SAAS,cAAc,SAAS,EAChB,aAE1BnN,OADU,IAAI,OAAO,SAAS,IAAI,EACrB,aAAa,IAAI,QAAQ,EAC5C,OAAO,OAAO,aAEV,gBAAAmN,GACA,gBAAiBsX,EACjB,OAAQ,gBACR,OAAAzkB,IAEF,KAIW,eAAAuxB,EAAcvuF,GAAS,cAE9B,MAAA1B,GAAW0iD,EAAU2Z,EAAe36D,EAAC,GACvC,IAAAlE,IACFsgD,IAAAp/C,IAAAC,GAAAqB,GAAS,eAAes8D,EAAyB56D,EAAC,KAAlD,YAAA/C,GAAsD,UAAtD,YAAAD,GAA+D,QAA/D,YAAAo/C,GACI,iBAIF,GAHsBtgD,IAAS,OACjCA,GAAOwC,GAAS,gBAEdxC,IAAQ,KAAI,CAEd,OAAO,OACL,8DAEE,SAAUwC,GAAS,KAAI,MAG3BuuE,EAAkB7sE,EAAC,EAAI,GAAK6sE,CAAA,YAG1B/wE,GAAK,YAAW,IAAO,WAAU,OAC7B0yF,GAAO3wC,GACXmD,EAAU2Z,EAAe36D,EAAC,GAC1B46D,EAAyB56D,EAAC,GAE5BioE,EAAA,EAAA4E,EAAkB7sE,EAAC,EAAIwuF,GAAK,OAAS,MAAQA,GAAK,OAAS,GAAI3hB,CAAA,CACtD,MAAA/wE,KAAS,MAClBmsE,EAAA,EAAA4E,EAAkB7sE,EAAC,EACjByhD,GACET,EAAU2Z,EAAe36D,EAAC,GAC1B46D,EAAyB56D,EAAC,KACtB,KAAI6sE,CAAA,EACH/wE,KAAS,kBAClBmsE,EAAA,EAAA4E,EAAkB7sE,EAAC,EACjB8kD,GACE9D,EAAU2Z,EAAe36D,EAAC,GAC1B46D,EAAyB56D,EAAC,KACtB,KAAI6sE,CAAA,EACH/wE,KAAS,eAClBmsE,EAAA,EAAA4E,EAAkB7sE,EAAC,EACjBsqD,GACEtJ,EAAU2Z,EAAe36D,EAAC,GAC1B46D,EAAyB56D,EAAC,KACtB,KAAI6sE,CAAA,EACH/wE,KAAS,UAGlBmsE,EAAA,EAAA4E,EAAkB7sE,EAAC,EACjBghD,EAAU2Z,EAAe36D,EAAC,GAAG,sBAC3B46D,EAAyB56D,EAAC,KACtB,KAAI6sE,CAAA,OAEdqgB,EAAiBltF,EAAC,EAAI,GAAIktF,CAAA,OAC1BxyB,EAAoB16D,EAAC,EAAI,GAAI06D,CAAA,QACvB+d,GAAI,QACJpnC,GAAW,SAAS,cAAa,cACvBspB,EAAe36D,EAAC,KAAK46D,EAAyB56D,EAAC,KAG3DqxC,IAAa,MAAgC8xB,GAAkB9xB,EAAQ,EAC3E8xB,GAAkBgqB,EAAentF,EAAC,GAGrB,eAAAwgF,GAAwBxgF,GAAS,CAC9CioE,EAAA,GAAAvN,EAAoB16D,EAAC,GAAK06D,EAAoB16D,EAAC,EAAA06D,CAAA,EAC3CA,EAAoB16D,EAAC,UACjBy4E,GAAI,EACVtV,GAAkBgqB,EAAentF,EAAC,IAIvB,eAAAyuF,EAAkBC,GAAc,IAC7CzmB,EAAA,EAAAnjE,EAAe4pF,EAAM,EACjBvR,EAAe,WAAa,wBAAuB,OAC/C1E,GAAI,EACJ,MAAAt3B,GAAMH,EAAU2Z,EAAe+zB,EAAM,GACrCC,GAAa,IAAO,YAAY,mBACpC,OAAM,CACJ,KAAMxtC,GAAI,KACV,UAAWwZ,EAAe+zB,EAAM,EAChC,eAAgBA,MAGpB,SAAS,cAAcC,EAAa,EAChCxtC,IAAOA,GAAI,iBAAmB,gBAAkBA,GAAI,YACtDuJ,GAA4BvJ,EAAG,UAExBg8B,EAAe,WAAa,kBAAiB,OAChD1E,GAAI,QACJt3B,GAAMsgC,EAAiBiN,EAAM,EAC7BC,GAAa,IAAO,YAAY,mBACpC,OAAM,CACJ,KAAMxtC,GAAI,KACV,UAAWutC,GACX,eAAgB,QAGpB,SAAS,cAAcC,EAAa,sCA+ET,MAAAC,EAAA5uF,IAAAyuF,EAAkBzuF,EAAC,EAuCnB4gF,EAAA5gF,IAAAyuF,EAAkBzuF,EAAC,EA0CnB6gF,EAAA7gF,IAAAyuF,EAAkBzuF,EAAC,EAgFjB6uF,GAAA9sF,IAAA0sF,EAAkB1sF,EAAC,iDA8DlBorF,EAAeprF,EAAC,EAAAmqE,aAwCX,MAAA4iB,GAAA/sF,IAAAwsF,EAAcxsF,EAAC,EAWdgtF,GAAAhtF,IAAAy+E,GAAwBz+E,EAAC,+CA1VrDsrF,EAAYnhB,sDAtSvBjE,EAAA,GAAE+mB,EAAgBvB,EAAcL,EAAoB3L,EAAiB,MAAM,oBAkD3ExZ,EAAA,GAAEgnB,EAAgBjB,EAAmBZ,EAAoB/sC,EAAU,MAAM,yRCvHvE8nB,EAAQ,IAfCh7B,EAAA4/B,EAAA,QAAAC,EAAA7E,OAAS,SACb,0CACA,QAAQ,EAGJh7B,EAAA8/B,EAAA,QAAAC,EAAA/E,OAAS,SACb,uCACA,QAAQ,kWAlBlBV,EA4BK7qB,EAAAwsB,EAAAlmD,CAAA,EAvBH8lD,EAeKI,EAAAL,CAAA,EAVHC,EAIID,EAAAgE,CAAA,SACJ/D,EAIID,EAAAkE,CAAA,SAENjE,EAMKI,EAAA1B,CAAA,mBAhBOe,EAAA,GAAAuE,OAAA7E,OAAS,SACb,0CACA,0BAGIM,EAAA,GAAAyE,OAAA/E,OAAS,SACb,uCACA,oCAQLA,EAAQ,iDAhDA,aAAA+mB,EAAmB,EAAE,EAAAtnB,EACrB,MAAA9rE,EAA4B,QAAQ,EAAA8rE,4KCqB1C,MAAMunB,GAA6B,CACxC,QAAS,CACP,MAAO,KACP,KAAM,WACN,QAAS,UAEX,QAAS,CACP,MAAO,KACP,KAAM,SACN,QAAS,SAEb,EAOaC,GAAqBC,GAA4B,CAC5D,GAAIA,EAAQ,SAAW,EACrB,MAAM,IAAI,MACR,qBAAqBA,CAAO,yCAG9B,MAAO,oBAAoBA,EAAQ,aAAa,MAEpD,+BCtCKF,GAAUhnB,EAAM,IAAE,MAAK,uLAJfA,EAAO,GAAC,OAAS,EAAE,4GADhCV,EAOK7qB,EAAA8qB,EAAAxkD,CAAA,EAJH8lD,EAAgCtB,EAAA1nE,CAAA,SAChCgpE,EAEKtB,EAAAqB,CAAA,+BADFomB,GAAUhnB,EAAM,IAAE,MAAK,KAAAsE,GAAA0U,EAAAD,CAAA,iBAJf/Y,EAAO,GAAC,OAAS,EAAE,qKAJnB,OAAAlH,CAAgB,EAAA2G,sNCOrB0nB,GAAA/E,EAAA,IAAAC,EAAA4E,GAAkBD,GAAUhnB,MAAQ,KAAK,IAAAh7B,EAAAo9C,EAAA,MAAAC,CAAA,cACzC2E,GAAUhnB,EAAM,IAAE,KAAK,iCAF/BV,EAIC7qB,EAAA2tC,EAAArnE,CAAA,YAHOulD,EAAA,IAAA6mB,GAAA/E,EAAA,IAAAC,EAAA4E,GAAkBD,GAAUhnB,MAAQ,KAAK,6BACzCgnB,GAAUhnB,EAAM,IAAE,sEALb,OAAAlH,CAAgB,EAAA2G,kRC6CMO,EAAG,8GAHPzkB,EAAA,2BAAAykB,KAAK,IAAI,2CAJDh7B,EAAAntC,EAAA,QAAA8sE,EAAA,qBAAA3E,EAAG,GAAC,cAAcA,EAAM,MAAM,EACnD,GACA,SAAQ,6LAVGh7B,EAAAo7B,EAAA,sBAAAJ,KAAK,KAAK,uLANjCV,EAwBI7qB,EAAAyG,EAAAngC,CAAA,EArBF8lD,EAoBQ3lB,EAAAklB,CAAA,EAXNS,EAOKT,EAAAQ,CAAA,EANHC,EAIID,EAAA/oE,CAAA,SACJgpE,EAAmCD,EAAArlB,CAAA,SAErCslB,EAEKT,EAAAb,CAAA,mEARwB,CAAA9uD,GAAA6vD,EAAA,GAAAqE,OAAA,qBAAA3E,EAAG,GAAC,cAAcA,EAAM,MAAM,EACnD,GACA,+MAjBP,OAAO,QAAQgnB,EAAS,wBAA7B,OAAInvF,GAAA,0NAVuBmoE,EAAA,GACvB,aACA,YAAU,kOAKRA,EAAU,GAAG,GAAK,UAAQ,4KAjBtCV,EAgDK7qB,EAAAt8B,EAAA4C,CAAA,EA/CH8lD,EAaQ1oD,EAAAioD,CAAA,qBALNS,EAIIT,EAAAvoE,CAAA,SAENgpE,EAgCI1oD,EAAAkkC,CAAA,sLArC2B2jB,EAAA,GACvB,aACA,YAAU,kIAQT,OAAO,QAAQgnB,EAAS,qBAA7B,OAAInvF,GAAA,8GAAJ,OAAIA,EAAAq2E,EAAA,OAAAr2E,GAAA,8BAHEmoE,EAAU,GAAG,GAAK,UAAQ,mLAGhC,OAAInoE,GAAA,mKAzBG,OAAAihE,CAAgB,EAAA2G,EACvB2nB,EAAsB,IACf,eAAAC,CAAsC,EAAA5nB,eAQ7CK,EAAA,EAAAsnB,EAAU,CAAIA,CAAA,SAwBRC,EAAeC,CAAG,EAClBxnB,EAAA,EAAAsnB,EAAa,kmBCOKpnB,EAAI,uJAJ1BV,EAKK7qB,EAAAt8B,EAAA4C,CAAA,EADH8lD,EAA8B1oD,EAAAtgB,CAAA,kCAAVmoE,EAAI,mFAZvBA,EAAiB,IAAAE,GAAAF,CAAA,EAOjBe,EAAAf,OAAS,IAAEG,GAAAH,CAAA,8kBAzBtBV,EAgDK7qB,EAAA0sB,EAAApmD,CAAA,EA1CH8lD,EAyCQM,EAAAomB,CAAA,EA9BN1mB,EA6BK0mB,EAAAvmB,CAAA,8CAbHH,EAMKG,EAAAJ,CAAA,wBACLC,EAEKG,EAAAzB,CAAA,wBACLsB,EAEKG,EAAAC,CAAA,iGA3BAjB,EAAiB,iGAOjBA,OAAS,odArCP,YAAAwnB,CAAoB,EAAA/nB,EACpB,MAAAe,EAAe,EAAE,EAAAf,EACjB,mBAAAgoB,EAA6B,EAAI,EAAAhoB,EAEtC,MAAAqR,EAAWC,GAAqB,MAElCptB,EA4BqB,MAAA8iC,EAAA,IAAA9iC,EAAO,MAAK,4CAfvBA,EAAMogB,WACI,MAAA0U,EAAA,IAAA90B,EAAO,MAAK,SAEhCmc,EAAA,EAAA0nB,EAAc,IACd1W,EAAS,OAAO,4MAfbntB,GAAU6jC,GAAa7jC,EAAO,UAAS,gBACvCA,GAAM,CAAK6jC,GAAa7jC,EAAO,MAAK,2VCD3C2b,EAAqE7qB,EAAAt8B,EAAA4C,CAAA,8FAyBlCilD,EAAG,8GAHPzkB,EAAA,2BAAAykB,KAAK,IAAI,2CAJDh7B,EAAAntC,EAAA,QAAA8sE,EAAA,qBAAA3E,EAAG,GAAC,cAAcA,EAAM,MAAM,EACnD,GACA,SAAQ,6LAVGh7B,EAAAo7B,EAAA,sBAAAJ,KAAK,KAAK,uLANjCV,EAwBI7qB,EAAAyG,EAAAngC,CAAA,EArBF8lD,EAoBQ3lB,EAAAklB,CAAA,EAXNS,EAOKT,EAAAQ,CAAA,EANHC,EAIID,EAAA/oE,CAAA,SACJgpE,EAAmCD,EAAArlB,CAAA,SAErCslB,EAEKT,EAAAb,CAAA,mEARwB,CAAA9uD,GAAA6vD,EAAA,GAAAqE,OAAA,qBAAA3E,EAAG,GAAC,cAAcA,EAAM,MAAM,EACnD,GACA,yJAjBP,OAAO,QAAQgnB,EAAS,wBAA7B,OAAInvF,GAAA,uNAFVynE,EA8BK7qB,EAAAt8B,EAAA4C,CAAA,EA7BH8lD,EA4BI1oD,EAAAkkC,CAAA,6EA3BK,OAAO,QAAQ2qC,EAAS,qBAA7B,OAAInvF,GAAA,8GAAJ,OAAIA,EAAAq2E,EAAA,OAAAr2E,GAAA,0CAAJ,OAAIA,GAAA,4NAJ0BmoE,EAAuB,4BAAvBA,EAAuB,4LAAvBA,EAAuB,kIALhD,wBAAA0nB,CAAgC,EAAAjoB,GAChC,eAAA4nB,CAAsC,EAAA5nB,GACtC,OAAA3G,CAAgB,EAAA2G,cAgBf4nB,EAAeC,CAAG,EAClBxnB,EAAA,EAAA4nB,EAA0B,mBAdFA,EAAuBh1F,ilBC6FrD4sE,EAEK7qB,EAAAmsB,EAAA7lD,CAAA,uBAELukD,EASK7qB,EAAA8qB,EAAAxkD,CAAA,EARH8lD,EAOQtB,EAAAa,CAAA,uqBAvBwBJ,EAAY,iFAO3CA,EAAc,GAAC,GAAK3H,GAA2B,SAAS2H,EAAc,GAAC,CAAC,qDAmC/D,cAAAA,EAAY,KAAK,SAAW,SAAW,oTA7D9CA,EAAK,4oBANLh7B,EAAA47B,EAAA,QAAAgO,EAAA,qFAAA5O,OAAiB,SACd;;62BA1BhBV,EAoGK7qB,EAAA+vB,EAAAzpD,CAAA,EA9FH8lD,EA6FK2D,EAAAigB,CAAA,EA1FH5jB,EA2CK4jB,EAAAtjB,CAAA,EAvCHN,EAsCKM,EAAAH,CAAA,EAlCHH,EAgCKG,EAAAC,CAAA,EA/BHJ,EAcKI,EAAAL,CAAA,gBACLC,EAeKI,EAAA1B,CAAA,4BAKXsB,EA6CK4jB,EAAAE,CAAA,wBAtBH9jB,EAcO8jB,EAAAj/D,CAAA,EARLm7C,EAKCn7C,EAAAshB,CAAA,EADgBA,EAAA,QAAAg5B,KAAU,gBAE3Ba,EAAyDn7C,EAAAutD,CAAA,SACzDpS,EAA2Dn7C,EAAAytD,CAAA,kJA1DtDnT,EAAK,KANL,CAAAvvD,GAAA6vD,EAAA,GAAAsO,OAAA,qFAAA5O,OAAiB,SACd;;sKAwB0BA,EAAY,+JAoC7Bh5B,EAAA,QAAAg5B,KAAU,qBAMfM,EAAA,IAAAqnB,EAAA,cAAA3nB,EAAY,KAAK,SAAW,SAAW,kbAzH9C,UAAA3Z,EAAgB,UAAU,EAAAoZ,EAC1B,UAAAsnB,EAAmB,EAAE,EAAAtnB,EACrB,cAAAmoB,EAAoC,QAAQ,EAAAnoB,GAC5C,OAAA3G,CAAgB,EAAA2G,GAChB,eAAA4nB,CAAsC,EAAA5nB,EAE7CioB,EAAmC,GA0CZ,MAAAjB,EAAA,IAAAzvB,GAAiB,EAAE,EACjB6wB,EAAA,IAAA7wB,GAAiB,EAAE,SAiDpC8I,EAAA,EAAA4nB,EAAuB,CAAIA,CAAA,gBAiBhB9R,EAAU,SAAQ,oCASjC5e,GAAiB,EAAE,s8BCrInBhyB,EAAAk/C,EAAA,QAAA4D,GAAA9nB,EAAc,GAAC,UACnB,iBACA,QAAM,iJAHZV,EA0BQ7qB,EAAAyvC,EAAAnpE,CAAA,EArBN8lD,EAOGqjB,EAAA6D,CAAA,SAQHlnB,EAKGqjB,EAAAp8D,CAAA,YAxBKw4C,EAAA,GAAAwnB,QAAA9nB,EAAc,GAAC,UACnB,iBACA,QAAM,+SCeL,SAASgoB,GAAUx1F,EAAU,CAClC,MAAMkH,EAAUlH,EAAI,aAAa,UACjC,IAAIggE,EAAiB,GACrB,MAAMuK,EAAwC,GAC9C,UAAWE,KAASvjE,EAClB,GAAIujE,EAAM,CAAC,IAAM,OAAQ,CACvBzK,IACA,MAAMT,EAAOkL,EAAM,CAAC,EACfF,EAAmBvK,CAAc,IACpCuK,EAAmBvK,CAAc,EAAI,CAAE,KAAAT,CAAA,GACzCgL,EAAmBvK,CAAc,EAAE,KAAOT,EAC1CgL,EAAmBvK,CAAc,EAAE,WAAa,GAClD,MAAWyK,EAAM,CAAC,IAAM,IACtBF,EAAmBvK,CAAc,EAAE,YAAc,SAASyK,EAAM,CAAC,CAAC,EACzDA,EAAM,CAAC,IAAM,IACtBF,EAAmBvK,CAAc,EAAE,IAAMyK,EAAM,CAAC,EACvCA,EAAM,CAAC,IAAM,KACtBF,EAAmBvK,CAAc,EAAE,KAAOyK,EAAM,CAAC,EACxCA,EAAM,CAAC,IAAM,KACtBF,EAAmBvK,CAAc,EAAE,KAAOyK,EAAM,CAAC,EACxCA,EAAM,CAAC,IAAM,KACtBF,EAAmBvK,CAAc,EAAE,KAAOyK,EAAM,CAAC,EACxCA,EAAM,CAAC,IAAM,KACtBF,EAAmBvK,CAAc,EAAE,KAAOyK,EAAM,CAAC,EACxCA,EAAM,CAAC,IAAM,OACtBF,EAAmBvK,CAAc,EAAE,KAAOyK,EAAM,CAAC,EACxCA,EAAM,CAAC,IAAM,OACtBF,EAAmBvK,CAAc,EAAE,KAAO,SAASyK,EAAM,CAAC,CAAC,EAClDA,EAAM,CAAC,IAAM,MAAQA,EAAM,CAAC,IAAM,KAAOA,EAAM,CAAC,IAAM,KAC/DF,EAAmBvK,CAAc,EAAE,WAAayK,EAAM,CAAC,EAC9CA,EAAM,CAAC,IAAM,OAASA,EAAM,CAAC,IAAM,KAAOA,EAAM,CAAC,IAAM,OAChEF,EAAmBvK,CAAc,EAAE,GAAKyK,EAAM,CAAC,GAGnD,OAAOF,CACT,CAEO,SAASkrB,GACdC,EACAC,EACA,CACA,IAAI57B,EAAS67B,GACTC,EAAa;AAAA;AAAA,sBACjBA,GAAc;AAAA,sBACdA,GAAc;AAAA,sBACdA,GAAc;AAAA;AAAA,4BACd,UAAWC,KAAYJ,EAAa,UAAW,CAC7C,MAAMK,EAAmBD,EAAS,QAAU,EAC5C,QAASzwF,EAAI,EAAGA,EAAI0wF,EAAkB1wF,IAAK,CACzC,MAAM2wF,EAAQ;AAAA;AAAA,QAEZF,EAAS,KAAK;AAAA;AAAA,mBAEHA,EAAS,KAAK;AAAA;AAAA;AAAA,IAI3B/7B,GAAUi8B,EACVH,GAAcG,EAEd,UAAW/sF,KAAQ6sF,EAAS,MAC1B,GAAIH,EAAmB1sF,CAAI,EACzB,UAAW+oD,KAAY2jC,EAAmB1sF,CAAI,EAC5C+oD,EAAS,SACTA,EAAS,kBACT+H,GAAU;AAAA;AAAA;AAAA,EAAuB/H,EAAS,QAC1C6jC,GAAc;AAAA;AAAA;AAAA,EAAuB7jC,EAAS,iBAItD,CACF,CACA,OAAA6jC,GAAc;AAAA;AAAA,iBACP97B,EAAS87B,CAClB,CAEA,MAAMD,GAAiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EClGvBK,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BCER,SAASC,GAAUC,EAAgC,CACxD,MAAO;AAAA;AAAA;AAAA,iBAEQA,EAAe,aAAe,UAAY,OAAS,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBA4CnDA,EAAe,mBAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAUlCA,EAAe,gBAAgB;AAAA,EAEvD,CAEA,SAASC,GAAqBC,EAAwB,CAmCpDC,GAAa,CAAC,UAAU,EAlCR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAkCoBD,CAAQ,CAC9C,CAEO,SAASE,GACdJ,EACAE,EACA,CACIF,EAAe,QAAU,QAC3BE,EAAS,UAAYG,GAAA,GAEvBC,GAAwBJ,CAAQ,CAClC,CAEA,SAASG,IAAmB,CAC1B,MAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAmHT,CAOO,SAASE,GAAsBL,EAAwB,CAC5DC,GACE,CACE,gBACA,WACA,YACA,cACA,cACA,cACA,SACA,YACA,iBACA,iBACA,gBAEF,4BACAD,CAAA,CAEJ,CAEA,SAASC,GACPK,EACAC,EACAP,EACAQ,EACA,CACA,UAAW32F,KAASy2F,GAEhBN,EAAS,QAAQ,SAASn2F,CAAK,GAC/Bm2F,EAAS,YAAY,SAASn2F,CAAK,KAE9Bm2F,EAAS,SAAS,SAASO,CAAU,IACxCP,EAAS,UAAY;AAAA,EAAKO,CAAU,IAM5C,CAEO,SAASH,GAAwBJ,EAAwB,CAC9DA,EAAS,UAAY;AAAA,2BACrBK,GAAsBL,CAAQ,EAC9BD,GAAqBC,CAAQ,EAC7BC,GAAa,CAAC,WAAW,EAAG,yBAA0BD,CAAQ,EAC9DC,GAAa,CAAC,YAAY,EAAG,uBAAwBD,CAAQ,EAC7DC,GACE,CAAC,YAAa,SAAU,YAAa,UAAW,WAAW,EAC3D,yBACAD,CAAA,EAEFC,GACE,CAAC,eAAgB,eAAe,EAChC,yBACAD,CAAA,EAEFC,GAAa,CAAC,UAAU,EAAG,yBAA0BD,CAAQ,EAC7DC,GACE,CAAC,eAAgB,YAAa,eAAgB,eAAe,EAC7D,yBACAD,CAAA,EAEFC,GACE,CAAC,WAAY,WAAY,cAAe,UAAU,EAClD,yBACAD,CAAA,EAEFC,GAAa,CAAC,YAAY,EAAG,2BAA4BD,CAAQ,EACjEC,GAAa,CAAC,aAAa,EAAG,4BAA6BD,CAAQ,EACnEC,GACE,CAAC,kBAAmB,eAAe,EACnC,2BACAD,CAAA,EAEFC,GAAa,CAAC,WAAW,EAAG,wBAAyBD,CAAQ,EAC7DC,GACE,CAAC,eAAgB,oBAAoB,EACrC,yBACAD,CAAA,EAEFC,GAAa,CAAC,YAAa,WAAW,EAAG,yBAA0BD,CAAQ,EAC3EC,GACE,CAAC,UAAW,WAAY,YAAa,SAAS,EAC9C,yBACAD,CAAA,EAEFC,GACE,CAAC,QAAS,SAAU,SAAS,EAC7B,wBACAD,CAAA,EAEFC,GAAa,CAAC,QAAQ,EAAG,6BAA8BD,CAAQ,EAC/DC,GAAa,CAAC,cAAc,EAAG,wBAAyBD,CAAQ,EAChEC,GAAa,CAAC,aAAc,WAAW,EAAG,yBAA0BD,CAAQ,EAC5EC,GAAa,CAAC,QAAS,QAAQ,EAAG,wBAAyBD,CAAQ,EACnEC,GAAa,CAAC,oBAAoB,EAAG,yBAA0BD,CAAQ,EACvEC,GACE,CAAC,UAAW,UAAW,UAAW,UAAW,UAAU,EACvD,qBACAD,CAAA,EAEFC,GAAa,CAAC,UAAU,EAAG,uBAAwBD,CAAQ,EAC3DC,GACE,CAAC,gBAAgB,EACjB,uCACAD,CAAA,EAEFC,GACE,CAAC,QAAS,QAAS,aAAa,EAChC,0CACAD,CAAA,EAEFC,GAAa,CAAC,WAAW,EAAG,yBAA0BD,CAAQ,EAC9DC,GACE,CAAC,sBAAsB,EACvB,2CACAD,CAAA,EAEFC,GAAa,CAAC,sBAAsB,EAAG,qBAAsBD,CAAQ,EACrEC,GAAa,CAAC,iBAAiB,EAAG,6BAA8BD,CAAQ,EACpEA,EAAS,QAAQ,SAAS,iBAAiB,IAExCA,EAAS,SAAS,SAAS,sBAAsB,IACpDA,EAAS,UAAY;AAAA,4CAEzBC,GAAa,CAAC,eAAe,EAAG,yBAA0BD,CAAQ,EAClEC,GACE,CAAC,iBAAiB,EAClB,iDACAD,CAAA,EAEFC,GACE,CAAC,uBAAwB,uBAAuB,EAChD,6CACAD,CAAA,EAEFC,GACE,CAAC,mBAAoB,qBAAsB,oBAAoB,EAC/D,+CACAD,CAAA,EAEFC,GAAa,CAAC,WAAW,EAAG,wBAAyBD,CAAQ,EAC7DC,GAAa,CAAC,MAAM,EAAG,2BAA4BD,CAAQ,EAC3DC,GAAa,CAAC,oBAAoB,EAAG,2BAA4BD,CAAQ,EACzEC,GACE,CAAC,oBAAoB,EACrB,kCACAD,CAAA,EAEFC,GAAa,CAAC,qBAAqB,EAAG,wBAAyBD,CAAQ,EACvEC,GAAa,CAAC,WAAW,EAAG,0BAA2BD,CAAQ,EAC/DC,GAAa,CAAC,iBAAiB,EAAG,yBAA0BD,CAAQ,EACpEC,GAAa,CAAC,kBAAkB,EAAG,yBAA0BD,CAAQ,EACrEC,GACE,CAAC,kBAAkB,EACnB;AAAA,4CACAD,CAAA,EAEFC,GACE,CAAC,UAAW,OAAQ,QAAS,UAAW,MAAM,EAC9C,8BACAD,CAAA,EAEFC,GAAa,CAAC,UAAU,EAAG,wBAAyBD,CAAQ,EAC5DC,GAAa,CAAC,QAAQ,EAAG,2BAA4BD,CAAQ,EAC7DC,GAAa,CAAC,aAAa,EAAG,yBAA0BD,CAAQ,EAChEC,GACE,CAAC,YAAY,EACb,2DACAD,CAAA,EAGFC,GACE,CAAC,aAAc,YAAY,EAC3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqCAD,CAAA,GAIAA,EAAS,QAAQ,SAAS,YAAY,GACtCA,EAAS,QAAQ,SAAS,WAAW,KAGrCA,EAAS,UAAY;AAAA,wBAEjBA,EAAS,QAAQ,SAAS,WAAW,IAEvCA,EAAS,UAAY;AAAA,qCAGzBC,GACE,CAAC,iBAAiB,EAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gEAYAD,CAEF,EACIA,EAAS,QAAQ,SAAS,kBAAkB,IAG9CA,EAAS,UACP;AAAA,oFACFA,EAAS,UACP;AAAA,kJACFA,EAAS,UAAY;AAAA,IAEvBC,GACE,CACE,OACA,OACA,OACA,OACA,OACA,QACA,OACA,QACA,WACA,OACA,OACA,QACA,OACA,OACA,QACA,OACA,QAEF,yBACAD,CAAA,EAEFC,GACE,CACE,OACA,OACA,OACA,OACA,QACA,OACA,OACA,QACA,YAEF,+BACAD,CAAA,EAEFC,GACE,CAAC,OAAQ,OAAQ,QAAS,OAAQ,QAAS,OAAQ,OAAQ,MAAM,EACjE,+BACAD,CAAA,EAEFC,GACE,CAAC,SAAU,QAAS,SAAU,OAAO,EACrC,iEACAD,CAAA,EAEFC,GACE,CAAC,SAAS,EACV,0EACAD,CAAA,EAEFC,GACE,CAAC,MAAM,EACP,+DACAD,CAAA,EAEFC,GACE,CAAC,OAAO,EACR,wEACAD,CAAA,EAEFC,GACE,CAAC,OAAO,EACR,4EACAD,CAAA,EAEFC,GACE,CAAC,QAAQ,EACT,wFACAD,CAAA,EAEFC,GACE,CAAC,OAAO,EACR,gEACAD,CAAA,EAEFC,GAAa,CAAC,KAAK,EAAG,+BAAgCD,CAAQ,EAC9DC,GACE,CACE,UACA,UACA,SACA,YACA,aACA,WACA,SACA,SACA,SACA,UAEF,wBACAD,CAAA,EAEFC,GACE,CACE,YACA,WACA,uBACA,sBACA,WACA,aACA,aACA,mBACA,QACA,cACA,UAEF,wBACAD,CAAA,EAEFC,GACE,CAAC,iBAAkB,cAAe,YAAY,EAC9C,yBACAD,CAAA,EAEFC,GACE,CAAC,qBAAqB,EACtB,+CACAD,CAAA,EAEFC,GACE,CAAC,UAAW,aAAc,WAAW,EACrC,uBACAD,CAAA,EAEFC,GAAa,CAAC,WAAW,EAAG,sCAAuCD,CAAQ,EAC3EC,GACE,CAAC,YAAY,EACb,0DACAD,CAAA,EAEFC,GACE,CAAC,iBAAiB,EAClB;AAAA,wCACAD,CAAA,EAEFC,GACE,CAAC,WAAW,EACZ;AAAA,qCACAD,CAAA,EAEFC,GACE,CAAC,YAAa,YAAa,cAAc,EACzC,yBACAD,CAAA,EAEFC,GACE,CAAC,iBAAkB,YAAY,EAC/B,wBACAD,CAAA,EAEFC,GAAa,CAAC,MAAM,EAAG,qCAAsCD,CAAQ,EACrEC,GAAa,CAAC,QAAQ,EAAG,yBAA0BD,CAAQ,EAC3DC,GACE,CAAC,UAAU,EACX,8DACAD,CAAA,EAEFC,GACE,CAAC,MAAO,KAAK,EACb,+DACAD,CAAA,EAEFC,GACE,CAAC,SAAS,EACV,2CACAD,CAAA,EAEFC,GAAa,CAAC,QAAQ,EAAG,gCAAiCD,CAAQ,EAClEC,GACE,CAAC,eAAgB,UAAU,EAC3B,2BACAD,CAAA,EAEFC,GAAa,CAAC,eAAe,EAAG,2BAA4BD,CAAQ,EACpEC,GACE,CAAC,UAAW,YAAa,aAAc,QAAS,OAAO,EACvD,gCACAD,CAAA,EAEFC,GAAa,CAAC,cAAc,EAAG,gCAAiCD,CAAQ,EACxEC,GACE,CAAC,cAAe,aAAa,EAC7B,yBACAD,CAAA,EAEFC,GAAa,CAAC,qBAAqB,EAAG,uBAAwBD,CAAQ,EACtEC,GACE,CAAC,YAAY,EACb;AAAA,uCACAD,CAAA,EAEFC,GACE,CAAC,cAAe,gBAAgB,EAChCQ,GAAA,EACAT,CAEF,EACAC,GAAa,CAAC,WAAW,EAAGS,GAAA,EAAWV,CAAQ,EAC/CC,GACE,CAAC,QAAQ,EACT,kDACAD,CAAA,EAEFC,GACE,CAAC,SAAS,EACV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAOAD,CAEF,EACAC,GAAa,CAAC,aAAc,YAAY,EAAG,wBAAyBD,CAAQ,EAC5EC,GAAa,CAAC,YAAY,EAAG,yBAA0BD,CAAQ,EAC/DC,GAAa,CAAC,QAAS,QAAQ,EAAG,4BAA6BD,CAAQ,EACvEC,GACE,CAAC,yBAAyB,EAC1B;AAAA;AAAA;AAAA;AAAA,GACAD,CAEF,EACAC,GAAa,CAAC,YAAY,EAAG,yBAA0BD,CAAQ,EAC/DC,GAAa,CAAC,eAAe,EAAG,wBAAyBD,CAAQ,EACjEC,GACE,CAAC,2BAA2B,EAC5B,8BACAD,CAAA,GAIAA,EAAS,QAAQ,SAAS,iBAAiB,GAC3CA,EAAS,YAAY,SAAS,iBAAiB,KAI/CA,EAAS,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCAOzB,CAEA,SAASS,IAAY,CACnB,MAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAmGT,CAEA,SAASC,IAAU,CACjB,MAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA+FT,CCn1BA,SAAST,GACPK,EACAK,EACAJ,EACA,CACA,IAAIrtF,EAAS,GACb,UAAWrJ,KAASy2F,EAClB,GAAIz2F,EAAM,SAAS82F,CAAa,EAAG,CACjCztF,EAAS,GACT,KACF,CAEF,OAAIA,EACKqtF,EAEF,EACT,CAEA,MAAMK,EAAM,CAEV,aAAc,CADdvoF,EAAA,kBAEE,KAAK,UAAY,EACnB,CAEA,2BAA4B,CAC1B,OAAO,KAAK,UAAU,KAAM,GAAM,EAAE,eAAiB,UAAU,CACjE,CAEA,cAAe,CACb,OAAO,KAAK,UAAU,IAAI,CAAC,EAAGrJ,KAAO,CACnC,MAAO,EAAE,MACT,KAAM,EAAE,KACR,MAAOA,CAAA,EACP,CACJ,CAEA,aAAaghD,EAA2B,CACtC,KAAK,UAAU,KAAK,GAAGA,CAAS,CAClC,CAEA,uBACE8vC,EACAe,EAAwB,EACkB,CAC1C,GAAIf,EAAe,QAAU,eAC3B,MAAO,CACL,QAAS,KAAK,kCACZe,EACAf,CAAA,EAEF,YAAa,IAGjB,GAAIA,EAAe,QAAU,qBAC3B,OAAAA,EAAe,aAAe,aACvB,CACL,QAAS,KAAK,kCACZe,EACAf,CAAA,EAEF,YAAa,IAGjB,IAAIxjD,EAAU,GACVs1B,EAAc,GAElB,GADA,KAAK,yBAAyBivB,CAAa,EACvCf,EAAe,QAAU,MAAO,CAClCxjD,GAAW;AAAA,EACXs1B,GAAe;AAAA,oBACf,UAAWtkE,KAAY,KAAK,UAC1B,GAAIA,GAAY,KAAM,CAEpB,MAAMwzF,EAGA,MAAM,KAAK,CAAE,OAAQxzF,EAAS,eAAe,QAAU,KAAO,CAClE,uBAAwB,EACxB,SAAU,IACV,EAEF,QAAS0B,EAAI,EAAGA,EAAI1B,EAAS,eAAe,OAAQ0B,IAAK,CAEvD,MAAM0gD,EACJpiD,EAAS,iBAAmB,MAC5BA,EAAS,gBAAgB0B,CAAC,IAAM,QAChC1B,EAAS,gBAAgB0B,CAAC,EAAE,SAAW,EACnC1B,EAAS,gBAAgB0B,CAAC,EAC1B1B,EAAS,eAAe0B,CAAC,EAG/B,GACE1B,EAAS,eAAiB,MAC1B,CAACA,EAAS,cAAc,MAAOyzF,GAAWA,EAAO,SAAW,CAAC,GAI3DzzF,EAAS,eAAiB,MAC1BA,EAAS,cAAc0B,CAAC,EAAE,SAAW,GACrC,CAAC8xF,EAAa9xF,CAAC,EAAE,SACjB,CAEA,IAAI0D,EAAI1D,EAAI,EACRgyF,EAAmBtuF,EAAIpF,EAAS,eAAe,OACnD,KAAO0zF,GAELF,EAAapuF,CAAC,EAAE,SAAWpF,EAAS,cAAcoF,CAAC,EAAE,SACnDpF,EAAS,oBAAoB0B,CAAC,GAE5B8xF,EAAapuF,CAAC,EAAE,UAClBouF,EAAa9xF,CAAC,EAAE,yBAElBgyF,EACEF,EAAapuF,CAAC,GAAKA,EAAIpF,EAAS,eAAe,OAAS,EAC1DoF,GAEJ,CAIF4pC,GAAW,kBACPwkD,EAAa9xF,CAAC,EAAE,yBAA2B,IAC7CstC,GAAW,eAAewkD,EAAa9xF,CAAC,EAAE,uBAAyB,CAAC,QAEtEstC,GAAYwkD,EAAa9xF,CAAC,EAAE,SAExB,IADA,MAAMob,GAAOslC,CAAM,CAAC,MAKtBpiD,EAAS,4BAA8B,MACvCA,EAAS,2BAA2B0B,CAAC,IAAM,SAE3CstC,GAAW,IAAIlyB,GAAO9c,EAAS,2BAA2B0B,CAAC,CAAC,CAAC,MAE/DstC,GAAW,2BAGTttC,EAAI,EAAI1B,EAAS,eAAe,QAChCwzF,EAAa9xF,EAAI,CAAC,EAAE,WAEpBstC,GAAW,KAEbA,GAAW;AAAA,CACb,CACA,UAAWmd,KAAcnsD,EAAS,iBAChCskE,GAAe;AAAA,SAAYxnD,GAAOqvC,CAAU,CAAC,EAEjD,CAEFmY,GAAe;AAAA;AAAA,EACft1B,GAAW;AAAA,0BAEXA,EAAUA,EAAQ,QAAQ,YAAa,EAAE,CAC3C,KACE,WAAWhvC,KAAY,KAAK,UAC1B,GAAIA,EAAS,eAAiB,WACxBA,EAAS,UAAY,GACvBgvC,GAAW,uDAEXA,GAAW;AAAA,WAAc2kD,GAAmB3zF,CAAQ,CAAC,GACrDgvC,GAAW;AAAA,eAAkBhvC,EAAS,QAAU,EAAE,IAAIA,EAAS,MAAQ,EAAE,IAAIA,EAAS,OAAS,EAAE,IAAIA,EAAS,MAAQ,EAAE;AAAA,EACxHgvC,GAAW2jD,GACT,CAAC3yF,EAAS,SAAW,EAAE,EACvB,WACA;AAAA,qBAEE,OAAOA,EAAS,MAAM,EAAI,IAC5BgvC,GAAW,sBAAsBhvC,EAAS,MAAM;AAAA,GAElDgvC,GAAWhvC,EAAS,QAChB,OAAOA,EAAS,MAAM,EAAI,IAC5BgvC,GAAW;AAAA;AAAA,GAEbA,GAAW2jD,GACT,CAAC3yF,EAAS,SAAW,EAAE,EACvB,WACA;AAAA,qBAEFgvC,GAAW;AAAA;AAAA,EACXs1B,GAAe;AAAA;AAAA,EACfA,GAAequB,GACb,CAAC3yF,EAAS,aAAe,EAAE,EAC3B,WACA;AAAA,qBAEFskE,GAAetkE,EAAS,YACxBskE,GAAequB,GACb,CAAC3yF,EAAS,aAAe,EAAE,EAC3B,WACA;AAAA,qBAEFskE,GAAe;AAAA;AAAA,OAEZ,CACLA,GAAe;AAAA;AAAA,EACfA,GAAequB,GACb3yF,EAAS,iBACT,WACA;AAAA,qBAEE,OAAOA,EAAS,UAAU,EAAI,IAChCskE,GAAe,sBAAsBtkE,EAAS,UAAU;AAAA,GAEtD,OAAOA,EAAS,WAAW,EAAI,IAC7B,OAAOA,EAAS,WAAW,EAAI,EACjCskE,GAAe;AAAA,6BAAgCtkE,EAAS,WAAW,MAEnEskE,GAAe;AAAA,qBAGnB,UAAWnY,KAAcnsD,EAAS,iBAC5B,OAAOA,EAAS,UAAU,EAAI,EAChCskE,GAAe;AAAA,EAAK,OAAOtkE,EAAS,WAAW,EAAI,EAAI,SAAW,EAAE,qCAAqC8c,GAAOqvC,CAAU,CAAC,kBAE3HmY,GAAe;AAAA,EAAK,OAAOtkE,EAAS,WAAW,EAAI,EAAI,SAAW,EAAE,IAAI8c,GAAOqvC,CAAU,CAAC,GAG1F,OAAOnsD,EAAS,WAAW,EAAI,IACjCskE,GAAe;AAAA;AAAA,GAEb,OAAOtkE,EAAS,UAAU,EAAI,IAChCskE,GAAe;AAAA,GAEjBA,GAAequB,GACb3yF,EAAS,iBACT,WACA;AAAA,qBAEFskE,GAAe;AAAA;AAAA,EACft1B,GAAW;AAAA,WAAc2kD,GAAmB3zF,CAAQ,CAAC,GACrDgvC,GAAW;AAAA,eAAkB2jD,GAAa,CAAC3yF,EAAS,aAAcA,EAAS,SAAU,GAAGA,EAAS,cAAc,EAAG,WAAY;AAAA,oBAAuB,CAAC,GAAG8c,GAAO9c,EAAS,SAAU,EAAK,CAAC,KAAK,OAAOA,EAAS,EAAE,EAAE,QAAQ,MAAO,EAAE,CAAC;AAAA,EACpOgvC,GAAW4kD,GAAkB5zF,EAAS,YAAY,EAClDgvC,GAAW6kD,GACTC,GACE9zF,EAAS,eACTA,EAAS,QACT,EAAQA,EAAS,sBACjB,OAAOA,EAAS,MAAM,GAExB,OAAOA,EAAS,MAAM,GAExBgvC,GAAW2jD,GACT,CACE3yF,EAAS,aACTA,EAAS,SACT,GAAGA,EAAS,gBAEd,WACA;AAAA,qBAEFgvC,GAAW;AAAA;AAAA,CACb,CAGJ,MAAO,CAAE,QAAAA,EAAS,YAAAs1B,CAAA,CACpB,CAEA,yBAAyBivB,EAAwB,EAAG,WAClD,UAAWvzF,KAAY,KAAK,UAAW,CACrC,GAAIA,EAAS,eAAiB,WAAY,GAC1BrB,EAAAqB,GAAA,YAAAA,EAAU,SAAV,YAAArB,EAAkB,iBAClB,QAAU40F,IAAkB,IACxCvzF,EAAS,SAAUtB,EAAAsB,EAAS,UAAT,YAAAtB,EAAkB,WAAW,WAAY,KAC5DsB,EAAS,aAAc89C,EAAA99C,EAAS,cAAT,YAAA89C,EAAsB,WAC3C,WACA,MAGJ,QACF,CACA,GAAI,CAAC,OAAO,UAAU,eAAe,KAAK99C,EAAU,gBAAgB,EAClE,SAEF,MAAM+zF,EAAU/zF,EAAS,KACnB+rB,EACJwnE,EAAgB,EACZvzF,EAAS,KAAOuzF,EAAc,WAC9BvzF,EAAS,KACfA,EAAS,KAAO+rB,EACZ/rB,EAAS,eAAiB,SAC5Bu8D,GAA6Bv8D,EAAU,EAAK,GAE5C8sC,GAAW/gB,EAAM,CAAE,OAAQ,GAAM,EAC7B,OAAO/rB,EAAS,wBAA2B,YAC7CA,EAAS,0BAGbA,EAAS,KAAO+zF,CAClB,CACF,CAEA,kCACER,EAAwB,EACxBf,EACQ,CACR,KAAK,yBAAyBe,CAAa,EAC3C,IAAIvkD,EAAU,GACd,QAASvrC,EAAI,EAAGA,EAAI,KAAK,UAAU,OAAQA,IAAK,CAC9C,MAAMzD,EAAW,KAAK,UAAUyD,CAAC,EAC3BuwF,EAOJxB,EAAe,MAAQA,EAAe,KAAK/uF,CAAC,EACxC+uF,EAAe,KAAK/uF,CAAC,EACrB,GACNurC,GAAW;AAAA,WAAc2kD,GAAmB3zF,EAAUuzF,CAAa,CAAC,GAChEvzF,EAAS,eAAiB,WACxBA,EAAS,UAAY,GACvBgvC,GAAW,uDAEXA,GAAW;AAAA,+BACPwjD,EAAe,eAAiB,aAClCxjD,GAAW;AAAA,oBACTwjD,EAAe,cAAgB,YAC3B,SAASA,EAAe,WAAW,KACnC,EACN;AAAA,qGACyFmB,GAAmB3zF,EAAUuzF,CAAa,CAAC;AAAA,yBAGpIvkD,GAAW;AAAA,mBACTwjD,EAAe,cAAgB,YAC3B,UAAUA,EAAe,WAAW,IACpC,EACN;AAAA,EAEFxjD,GAAWhvC,EAAS,QACpBgvC,GAAW;AAAA;AAAA,EACXA,GAAW;AAAA;AAAA,EACXA,GAAWhvC,EAAS,YACpBgvC,GAAW;AAAA;AAAA,IAGbA,GAAW;AAAA,+BACPwjD,EAAe,eAAiB,aAClCxjD,GAAW;AAAA,oBACTwjD,EAAe,cAAgB,YAC3B,SAASxyF,EAAS,KAAK,KACvB,EACN;AAAA,kFACwE2zF,GAAmB3zF,EAAUuzF,CAAa,CAAC;AAAA,yBAGnHvkD,GAAW;AAAA,mBACTwjD,EAAe,cAAgB,YAC3B,UAAUxyF,EAAS,KAAK,IACxB,EACN;AAAA,EAEFgvC,GAAW2jD,GACT,CACE,GAAG3yF,EAAS,eACZA,EAAS,SACTA,EAAS,cAEX,WACA;AAAA,qBAGAwyF,EAAe,eAAiB,eAC/BxyF,EAAS,aAAa,OAAS,IAAMA,EAAS,SAAS,OAAS,MAGjEgvC,GAAW;AAAA,gBAEbA,GAAW4kD,GAAkB5zF,EAAS,YAAY,EAClDgvC,GAAW;AAAA,EAAOlyB,GAAO9c,EAAS,QAAQ,EAC1CgvC,GAAW6kD,GACTC,GACE9zF,EAAS,eACTA,EAAS,QACT,EAAQA,EAAS,sBACjB,OAAOA,EAAS,MAAM,EACtBg0F,CAAA,EAEFA,EAAQ,KAAOA,EAAQ,KAAO,OAAOh0F,EAAS,MAAM,GAEtDgvC,GAAW2jD,GACT,CACE,GAAG3yF,EAAS,eACZA,EAAS,SACTA,EAAS,cAEX,WACA;AAAA,qBAEFgvC,GAAW;AAAA;AAAA,EACXA,GAAW;AAAA,mBACXA,GAAW2jD,GACT,CAAC,GAAG3yF,EAAS,gBAAgB,EAC7B,WACA;AAAA,qBAEFgvC,GAAW6kD,GACTC,GACE9zF,EAAS,iBACTA,EAAS,YACT,EAAQA,EAAS,sBACjB,OAAOA,EAAS,MAAM,GAExBg0F,EAAQ,UAAYA,EAAQ,UAAY,OAAOh0F,EAAS,UAAU,GAEpEgvC,GAAW2jD,GACT,CAAC,GAAG3yF,EAAS,gBAAgB,EAC7B,WACA;AAAA,qBAEFgvC,GAAW;AAAA;AAAA,EAEf,CACA,OAAOA,CACT,CAEA,MAAM,YAAYwjD,EAAuD,eACvE,MAAME,EAAyB,CAC7B,SAAU,GACV,MAAO,GACP,QAAS,GACT,YAAa,IAEf,GACEF,EAAe,QAAU,gBACzBA,EAAe,QAAU,qBACzB,CACA,GAAIA,EAAe,QAAU,eAC3B,QAAS9wF,EAAI,EAAGA,EAAI8wF,EAAe,WAAa,EAAG9wF,IAAK,CACtD,IAAI/C,EAAA6zF,EAAe,SAAf,MAAA7zF,EAAuB,QACzB,MAAM,IAAI,aACR,qCACA,cAGJ,MAAMs1F,EAAiB,KAAK,kCAC1BvyF,EACA8wF,CAAA,EAEFE,EAAS,SAAW;AAAA,0BAA6BF,EAAe,YAAc,QAAU,OAAS,OAAO,OAAOA,EAAe,YAAc,QAAU,QAAU,MAAM,qBAAqBA,EAAe,UAAY,GAAG,WAAWA,EAAe,WAAa,GAAG,UAAUA,EAAe,WAAa,EAAI,IAAM9wF,EAAI,GAAG,WAAW8wF,EAAe,OAAS,WAAW;AAAA,EACxWE,EAAS,SAAWuB,EAEpBvB,EAAS,SAAW;AAAA,iBACpBA,EAAS,SAAW;AAAA,aACpBA,EAAS,YAAc,EACzB,SACSF,EAAe,QAAU,qBAClC,QAAS9wF,EAAI,EAAGA,EAAI8wF,EAAe,WAAa,EAAG9wF,IAAK,CACtD,IAAIhD,EAAA8zF,EAAe,SAAf,MAAA9zF,EAAuB,QACzB,MAAM,IAAI,aACR,sCACA,cAGJ8zF,EAAe,aAAe,aAC9B,MAAMyB,EAAiB,KAAK,kCAC1BvyF,EACA8wF,CAAA,EAEFE,EAAS,SAAW;AAAA,sFAAyFF,EAAe,UAAY,GAAG,WAAWA,EAAe,WAAa,GAAG,UAAUA,EAAe,WAAa,EAAI,IAAM9wF,EAAI,GAAG,WAAW8wF,EAAe,OAAS,WAAW;AAAA,EAC1RE,EAAS,SAAWuB,EACpBvB,EAAS,SAAW;AAAA,iBACpBA,EAAS,SAAW;AAAA,aACpBA,EAAS,YAAc,EACzB,CAEF,IAAI50C,EAAA00C,EAAe,SAAf,MAAA10C,EAAuB,QACzB,MAAM,IAAI,aACR,sCACA,cAGJ,KAAK,0BAA0B40C,EAAUF,CAAc,EACvDE,EAAS,OAAS;AAAA,kBACpB,KAAO,CACL,QAAShxF,EAAI,EAAGA,EAAI8wF,EAAe,WAAa,EAAG9wF,IAAK,CACtD,IAAIs8C,EAAAw0C,EAAe,SAAf,MAAAx0C,EAAuB,QACzB,MAAM,IAAI,aACR,qCACA,cAGJ,MAAMi2C,EAAiB,KAAK,uBAAuBzB,EAAgB9wF,CAAC,EAChEA,EAAI,IACNgxF,EAAS,SAAW;AAAA,aACpBA,EAAS,SAAW;AAAA,wBACpBA,EAAS,aAAe;AAAA,aACxBA,EAAS,aAAe;AAAA,yBAEtBF,EAAe,WAAa,IAC9BE,EAAS,SAAW;AAAA,YAAehxF,CAAC,IACpCgxF,EAAS,aAAe;AAAA,YAAehxF,CAAC,IACpCA,EAAI,GAAK8wF,EAAe,QAAU,QACpCE,EAAS,SAAW;AAAA,uBACpBA,EAAS,SAAW;AAAA,qCACpBA,EAAS,SAAW;AAAA;AAAA,eAGxBA,EAAS,SAAWuB,EAAe,QACnCvB,EAAS,aAAeuB,EAAe,WACzC,CACA,IAAI/1C,EAAAs0C,EAAe,SAAf,MAAAt0C,EAAuB,QACzB,MAAM,IAAI,aACR,qCACA,cAGAs0C,EAAe,QAAU,OAC3BE,EAAS,UAAY;AAAA;AAAA,EAAmDwB,GAAY1B,EAAgBE,CAAQ,CAAC;AAAA;AAAA,EAC7GA,EAAS,UACP;AAAA;AAAA;AAAA,EACFA,EAAS,UAAY;AAAA,8BACrBA,EAAS,UAAY;AAAA,+BAAkCF,EAAe,mBAAqB,iBAAmB,OAAS,OAAO,IAC9HE,EAAS,UAAY;AAAA,mBAAsBF,EAAe,iBAAiB,MAC3EE,EAAS,OAAS;AAAA,mBAClBA,EAAS,OAAS;AAAA,uBAClBA,EAAS,OAAS;AAAA,qCAClBA,EAAS,OAAS;AAAA,wBAClBA,EAAS,OAAS;AAAA,eAElBA,EAAS,UAAY;AAAA;AAAA,EAAmDwB,GAAY1B,EAAgBE,CAAQ,CAAC;AAAA;AAAA,EAC7GA,EAAS,UAAY,WAAWF,EAAe,KAAK,cAAcA,EAAe,KAAK,KAAKA,EAAe,SAAS,KAAKA,EAAe,QAAQ,IAC/IE,EAAS,OAAS;AAAA;AAAA,EAEtB,CACA,OAAOA,CACT,CAEQ,0BACNA,EACAF,EACA,CACA,MAAM5+B,EAAa,IAAI,IAAI,OAAO,SAAS,IAAI,EAC/CA,EAAW,SAAW,mBACtBA,EAAW,KAAO,GAClBA,EAAW,SAAW,SACtBA,EAAW,aAAa,IAAI,IAAK,OAAO,EACxC8+B,EAAS,SAAW,YAAY9+B,EAAW,KAAK,WAAW,IAAK,KAAK,CAAC,GACtE8+B,EAAS,UAAY;AAAA,8CACrBK,GAAsBL,CAAQ,EAC9BA,EAAS,UAAY;AAAA,sBACrBA,EAAS,UAAY;AAAA,4BACrBA,EAAS,UAAY;AAAA,oCAAuCF,EAAe,mBAAqB,iBAAmB,OAAS,OAAO,IACnIE,EAAS,UACP;AAAA,uEACFA,EAAS,UACP;AAAA,mEACFA,EAAS,UAAY;AAAA,gCACrBA,EAAS,UAAY;AAAA,oBACrBA,EAAS,UAAY;AAAA,wBACrBA,EAAS,UAAY;AAAA,wBACrBA,EAAS,UAAY;AAAA,oBAErBA,EAAS,UAAY;AAAA,oCACrBA,EAAS,UAAY;AAAA,iCACrBA,EAAS,UAAY;AAAA,wBAA2B9+B,EAAW,KAAK,WAAW,IAAK,KAAK,CAAC,eACtF8+B,EAAS,UAAY;AAAA,2BACrBA,EAAS,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA,GAKrBA,EAAS,UAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA2BvBF,EAAe,eAAiB,aAAe;AAAA;AAAA;AAAA;AAAA,EAA+E,EAAE;AAAA,EAEhIA,EAAe,YAAc,OACzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAiBA,EACN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAUIE,EAAS,UAAY;AAAA,sBACrBA,EAAS,UAAY;AAAA,wBACrBA,EAAS,UAAY;AAAA,wBACrBA,EAAS,UAAY;AAAA,6BACrBA,EAAS,UAAY;AAAA,+BACrBI,GAAwBJ,CAAQ,EAChCA,EAAS,UAAYH,GAAUC,CAAc,EAC7C,KAAM,CAAC2B,EAAWC,CAAa,EAAI,KAAK,kBACxC,UAAWC,KAAQD,EAEbC,IAAS,SACN3B,EAAS,SAAS,SAAS,QAAQ,IACtCA,EAAS,UAAY;AAAA,qBAA0B2B,EAAO,KAGxD3B,EAAS,UAAY;AAAA,eAAoB2B,EAAO,IAGpD,UAAWC,KAAOH,EAChBzB,EAAS,UAAY;AAAA,EAAO4B,EAAI,QAAQ,MAAO,EAAE,CAErD,CAEA,MAAM,QAAQ9B,EAAwD,CACpE,MAAME,EAAW,MAAM,KAAK,YAAYF,CAAc,EAChD+B,EAAW7B,GAAA,YAAAA,EAAU,SACrBL,EAAQK,GAAA,YAAAA,EAAU,MAClB1jD,EAAU0jD,GAAA,YAAAA,EAAU,QACpBpuB,EAAcouB,GAAA,YAAAA,EAAU,YAC9B,IAAI8B,EAAuB,GAC3BA,GAAwBnC,EACxBmC,GAAwBxlD,EAEtBwjD,EAAe,QAAU,gBACzBA,EAAe,QAAU,qBAEzBgC,GAAwB;AAAA,iBACfhC,EAAe,QAAU,OAClCgC,GACE;AAAA;AAAA;AAAA;AAAA;AAAA,qBACAlwB,EACA;AAAA;AAAA;AAAA,iBACFkwB,GACE;AAAA;AAAA;AAAA;AAAA,UAEFA,GACE;AAAA;AAAA;AAAA;AAAA,qBACAlwB,EACA;AAAA;AAAA;AAAA,iBACFkwB,GACE;AAAA;AAAA;AAAA;AAAA,SAEJ,MAAMC,EAAoBF,EAAWC,EACrC,MAAO,CAAE,SAAA9B,EAAU,qBAAA8B,EAAsB,kBAAAC,CAAA,CAC3C,CAEA,iBAAkB,CAChB,MAAMC,EAAsB,GAC5B,UAAW7xC,KAAO,KAAK,UACjB,OAAOA,EAAI,eAAkB,SAC/B6xC,EAAU,KAAK7xC,EAAI,aAAa,EACvB,MAAM,QAAQA,EAAI,aAAa,GACxC6xC,EAAU,KAAK,GAAG7xC,EAAI,aAAa,EAGvC,MAAM8xC,EAA4BD,EAAU,OAC1C,CAACn4F,EAAO4B,EAAOC,IAAUA,EAAM,QAAQ7B,CAAK,IAAM4B,CAAA,EAE9C,CAACg2F,EAAWC,CAAa,EAAIO,EAAgB,OACjD,CAACh1F,EAA8BzB,KAC7ByB,EAAOzB,EAAQ,WAAW,KAAK,EAAI,EAAI,CAAC,EAAE,KAAKA,CAAO,EAC/CyB,GAET,CAAC,GAAI,EAAE,GAGT,MAAO,CAACw0F,EAAWC,CAAa,CAClC,CACF,CAEA,SAASR,GAAkB1xC,EAAe,GAAY,CACpD,IAAIlT,EAAU,GACd,OAAIkT,EAAa,OAAS,IACxBlT,GAAW;AAAA,EAAOlyB,GAAOolC,CAAY,GAEhClT,CACT,CAEA,SAAS8kD,GACP/xC,EACAp+C,EAAU,EACVixF,EACAl1F,EAAiB,EACjBs0F,EAII,GACI,CACR,IAAIhlD,EAAU,GACd,MAAM6lD,EAAUb,EAAQ,QACpB,kBAAkBA,EAAQ,QAAQ,MAAM,KAAKA,EAAQ,QAAQ,MAAM,KACnE,GACJ,GAAIjyC,IAAc,QAAaA,EAAU,OAAS,EAAG,CACnD/S,GAAW;AAAA,oBACX,MAAM8lD,EAAkB,GACpBd,EAAQ,UAAY,QAAaA,EAAQ,UAAY,KACvDc,EAAM,KAAK,WAAWd,EAAQ,OAAO,IAAI,EAChCrwF,IAAY,GACrBmxF,EAAM,KAAK,WAAWnxF,CAAO,IAAI,EAE/BqwF,EAAQ,OACVc,EAAM,KAAK,SAASd,EAAQ,MAAM,EAAE,EAC1BY,GACVE,EAAM,KAAK,UAAU,EAEnBA,EAAM,SAAW,IACnB9lD,GAAW,IAAM8lD,EAAM,KAAK,GAAG,EAAI,KAErC,UAAWvyC,KAAYR,EACjBriD,EAAS,EACXsvC,GAAW;AAAA,4CAAgDlyB,GAAOylC,CAAQ,CAAC,mBAAmBsyC,CAAO,GAErG7lD,GAAW;AAAA,UAAclyB,GAAOylC,CAAQ,CAAC,GAAGsyC,CAAO,GAGvD7lD,GAAW;AAAA,iBACb,MACMtvC,EAAS,EACXsvC,GAAW;AAAA,qCAAwClyB,GAAOilC,EAAU,CAAC,CAAC,CAAC,mBAAmB8yC,CAAO,GAEjG7lD,GAAW;AAAA,GAAMlyB,GAAOilC,EAAU,CAAC,CAAC,CAAC,GAAG8yC,CAAO,GAGnD,OAAO7lD,CACT,CAEA,SAAS6kD,GAAYxjF,EAActG,EAAoB,CACrD,OAAIA,EAAK,EAAUsG,EACZ,sBAAsBtG,CAAE,IAAIsG,CAAI;AAAA,iBACzC,CAUO,SAAS0kF,GACdC,EACAC,EACA,CACA,MAAMC,EAAkB,GACxB,OAAAF,EAAgB,QAAQ,CAACnyC,EAAKnhD,IAAM,OAClC,GAAIuzF,EAAUvzF,CAAC,EAAE,SAAW,EAAG,CAC7B,MAAMyzF,EAAOtyC,EAAI,KACXuyC,GAAQz2F,EAAAkkD,GAAA,YAAAA,EAAK,QAAL,YAAAlkD,EAAY,cAC1B,UAAW02F,KAAQJ,EAAUvzF,CAAC,EACxB0zF,IAAU,OACRC,EAAK,OACPH,EAAgB,KACd,GAAG,OAAO,SAAS,MAAM,gBAAgBE,CAAK,IAAID,CAAI,WAAWE,EAAK,IAAI,IAAIA,EAAK,MAAM,IAG3FH,EAAgB,KACd,GAAG,OAAO,SAAS,MAAM,gBAAgBE,CAAK,IAAID,CAAI,WAAWE,EAAK,IAAI,QAGrED,GAAS,KACdC,EAAK,OACPH,EAAgB,KACd,GAAG,OAAO,SAAS,MAAM,gBAAgBE,CAAK,IAAID,CAAI,QAAQE,EAAK,MAAM,IAAIA,EAAK,IAAI,IAAIA,EAAK,MAAM,IAGvGH,EAAgB,KACd,GAAG,OAAO,SAAS,MAAM,gBAAgBE,CAAK,IAAID,CAAI,YAAYE,EAAK,IAAI,QAI/EH,EAAgB,KACd,GAAG,OAAO,SAAS,MAAM,SAASG,EAAK,IAAI,IAAIA,EAAK,MAAM,GAIlE,CACF,CAAC,EACMH,CACT,CAkBO,SAASI,GAAmB5yC,EAA2B,CAC5D,MAAMsyC,EAAgC,GACtC,UAAWnyC,KAAOH,EAAW,CAC3B,IAAI6e,EAAmB,GACnB1e,EAAI,eAAiB,OACvB,OAAO,OAAO0e,EAAM,GAAI,CAAE,QAAS1e,EAAI,SAAW,GAAI,EAC7CA,EAAI,eAAiB,SAC9B,OAAO,OAAO0e,EAAM,GAAI,CAAE,QAAS1e,EAAI,eAAe,KAAK,GAAG,EAAG,EAEjE0e,EAAO,CACL,QAAS1e,EAAI,QACb,YAAaA,EAAI,YACjB,MAAOA,EAAI,OACX,MAAOA,EAAI,KACX,KAAMA,EAAI,MACV,KAAMA,EAAI,KACV,MAAO,CAACA,EAAI,OAAQA,EAAI,KAAMA,EAAI,MAAOA,EAAI,IAAI,EAAE,KAAK,GAAG,GAG/DmyC,EAAgB,KAAKzzB,CAAI,CAC3B,CACA,OAAOyzB,CACT,CACO,SAASO,GAAaP,EAA+B,CAC1D,MAAMQ,EAAW,GACXP,EAAY,GACZQ,EAAwB,qBACxBC,EACJ,6DACIC,EAAkB,iCACxB,UAAW9yC,KAAOmyC,EAChB,GAAInyC,EAAI,QAAS,CACf,MAAM+yC,EAA2B,GAE3B5mD,EAAU,CAAC,GAAG6T,EAAI,QAAQ,SAAS4yC,CAAqB,CAAC,EAC3D5yC,EAAI,aACN7T,EAAQ,KAAK,GAAG6T,EAAI,YAAY,SAAS4yC,CAAqB,CAAC,EAEjEzmD,EAAQ,QAAS28C,GAAS,CAExB,MAAMkK,EAAU,MAAM,KAAKlK,EAAK,CAAC,EAAE,SAAS+J,CAAW,CAAC,EACpDG,IAAY,MAAQA,EAAQ,OAAS,GACvCD,EAAK,KAAK,GAAGC,CAAO,CAExB,CAAC,EACDL,EAAS,KAAKI,CAAI,CACpB,MACEJ,EAAS,KAAK,EAAE,EAGpB,OAAAA,EAAS,QAAQ,CAAC7J,EAAMxtF,IAAU,CAEhC,GADA82F,EAAU,KAAK,EAAE,EACbtJ,EAAK,SAAW,EAClB,UAAWrmF,KAAQqmF,EAAM,CACvB,IAAImK,EACJ,GAAIxwF,EAAK,CAAC,EAAE,MAAMqwF,CAAe,EAAG,CAClC,MAAMI,EAAU,CAAC,GAAGzwF,EAAK,CAAC,EAAE,SAASqwF,CAAe,CAAC,EACjDI,EAAQ,CAAC,EAAE,QAAU,OACvBD,EAAS,CACP,KAAMC,EAAQ,CAAC,EAAE,OAAO,KACxB,OAAQA,EAAQ,CAAC,EAAE,OAAO,QAGhC,MACED,EAAS,CAAE,KAAMxwF,EAAK,CAAC,EAAG,OAAQ,IAEhCwwF,GAAU,MACZb,EAAU92F,CAAK,EAAE,KAAK23F,CAAM,CAEhC,CAEJ,CAAC,EACMb,CACT,CAKO,SAASe,GAAmBtD,EAGhC,CACD,MAAMuD,EAAmB,CACvB,QAASvD,EAAS,QAClB,YAAaA,EAAS,SAGxB,OADa6C,GAAa,CAACU,CAAI,CAAC,EACpB,KAAMl4F,GAAMA,EAAE,OAAS,CAAC,CACtC,CAEO,SAASm4F,GAAmBxzC,EAA2B,CAC5D,MAAMsyC,EAAkBM,GAAmB5yC,CAAS,EAC9CuyC,EAAYM,GAAaP,CAAe,EAC9C,OAAOD,GAAoBC,EAAiBC,CAAS,CACvD,CAQO,SAASn4E,GACdzM,EACA8lF,EAAiC,GACzB,CACR,GAAI9lF,IAAS,OAAW,MAAO,GAC/B,MAAMoyD,EAAOG,GAAA,EACb,IAAI8E,EAAgByuB,EAChB9lF,EAAK,QAAQ,mCAAoC;AAAA;AAAA;AAAA,CAAiB,EAClEA,EAEJ,OAAAq3D,EAAgBA,EACb,QAAQ,aAAc,WAAW,EACjC,QAAQ,QAAS,MAAM,EACvB,QAAQ,YAAa,cAAc,EACnC,QAAQ,SAAU,aAAa,EAC/B,QAAQ,gBAAiB,MAAM,EAC/B,WAAW,IAAK,QAAQ,EACxB,WAAW,IAAK,QAAQ,EACxB,WAAW,IAAK,OAAO,EACvB,WAAW,IAAK,YAAY,EAG3BjF,IAAS,UACXiF,EAAgBA,EAAc,QAAQ,WAAY,QAAQ,GAGrDA,CACT,CAEA,SAASisB,GAAmBlkC,EAAkB/yD,EAAkB,EAAW,CACzE,MAAML,EAAM,IAAI,IAAI,2BAA2B,EAC/C,OAAAA,EAAI,aAAa,OAAO,OAAQ,OAAOozD,EAAG,IAAI,CAAC,EAC3CA,EAAG,KAAO,QAAWpzD,EAAI,aAAa,OAAO,KAAMozD,EAAG,EAAE,EACxDA,EAAG,cAAgB,QACrBpzD,EAAI,aAAa,OAAO,IAAKozD,EAAG,YAAY,UAAU,EAEpDA,EAAG,WAAa,QAClBpzD,EAAI,aAAa,OAAO,IAAKozD,EAAG,SAAS,UAAU,EAEjDA,EAAG,MAAQ,QAAWpzD,EAAI,aAAa,OAAO,IAAKozD,EAAG,GAAG,EACzDA,EAAG,OAAS,QAAWpzD,EAAI,aAAa,OAAO,KAAMozD,EAAG,IAAI,EAC5DA,EAAG,OAAS,QAAWpzD,EAAI,aAAa,OAAO,KAAMozD,EAAG,IAAI,EAC5DA,EAAG,OAAS,QAAWpzD,EAAI,aAAa,OAAO,KAAMozD,EAAG,IAAI,EAC5DA,EAAG,OAAS,QAAWpzD,EAAI,aAAa,OAAO,KAAMozD,EAAG,IAAI,EAC5DA,EAAG,OAAS,QACdpzD,EAAI,aAAa,OACf,OACAK,EAAU,EAAI+yD,EAAG,KAAO/yD,EAAQ,SAAW+yD,EAAG,MAE9CA,EAAG,YAAYpzD,EAAI,aAAa,OAAO,IAAK,GAAG,EAC/CozD,EAAG,sBAAwB,QAC7BpzD,EAAI,aAAa,OAAO,KAAMozD,EAAG,oBAAsB,IAAM,GAAG,EAE9DA,EAAG,SAAW,QAChBpzD,EAAI,aAAa,OAAO,OAAQozD,EAAG,OAAO,UAAU,EAE/CpzD,EAAI,KAAK,WAAW,IAAK,KAAK,CACvC,CAEA,SAAS63F,GAAY1B,EAAgCE,EAAwB,CAC3E,OAAAA,EAAS,UAAYJ,GACrBM,GAAcJ,EAAgBE,CAAQ,EACtCA,EAAS,UAAYH,GAAUC,CAAc,EACtCE,EAAS,QAClB,CCziCO,SAAS0D,GAAYC,EAAqBC,EAAqB,CACpE,MAAMC,EAAM,IAAIC,GAChB,IAAI3nC,EAAQ,EACZwnC,EAAU,QAASh6F,GAAQ,CACzBo6F,GAAW,iBAAiBp6F,EAAK,CAACq6F,EAAKn1B,IAAS,CAC9C,GAAIm1B,EACF,MAAMA,EAER,MAAMC,EAAWt6F,EAAI,MAAM,GAAG,EACxBu6F,EAAWD,EAASA,EAAS,OAAS,CAAC,EAC7CJ,EAAI,KAAKK,EAAUr1B,GAAQ,GAAI,CAAE,OAAQ,GAAM,EAC/C1S,IACIA,IAAUwnC,EAAU,QACtBE,EAAI,cAAc,CAAE,KAAM,OAAQ,EAAE,KAAMvnD,GAAY,CACpD6nD,UAAO7nD,EAASsnD,CAAW,CAC7B,CAAC,CAEL,CAAC,CACH,CAAC,CACH,CASA,eAAsBQ,GACpBR,EACAS,EACAr0C,EACA,CACA,MAAM6zC,EAAM,IAAIC,GACVQ,EAAahB,GAAmBe,EAAU,QAAQ,EAClD/B,EAAkBM,GAAmB5yC,CAAS,EAC9CuyC,EAAYM,GAAaP,CAAe,EAE9C,GADAuB,EAAI,KAAK,WAAYQ,EAAU,iBAAiB,EAC5CC,EAAY,CACd,MAAMC,EAAOlC,GAAoBC,EAAiBC,CAAS,EACrDiC,EAAeX,EAAI,OAAO,QAAQ,EACxC,IAAI1nC,EAAQ,EACZooC,EAAK,QAAS56F,GAAQ,CACpBo6F,GAAW,iBAAiBp6F,EAAK,CAACq6F,EAAKn1B,IAAS,CAC9C,GAAIm1B,EACF,MAAMA,EAER,MAAMC,EAAWt6F,EAAI,MAAM,GAAG,EACxBu6F,EAAWD,EAASA,EAAS,OAAS,CAAC,EAC7CO,GAAA,MAAAA,EAAc,KAAKN,EAAUr1B,GAAQ,GAAI,CAAE,OAAQ,KACnD1S,IACIA,IAAUooC,EAAK,QACjBV,EAAI,cAAc,CAAE,KAAM,OAAQ,EAAE,KAAMvnD,GAAY,CAEpD6nD,UAAO7nD,EAAS,CAACsnD,EAAa,KAAK,EAAE,KAAK,GAAG,CAAC,CAChD,CAAC,CAEL,CAAC,CACH,CAAC,CACH,MACEC,EAAI,cAAc,CAAE,KAAM,OAAQ,EAAE,KAAMvnD,GAAY,CACpD6nD,UAAO7nD,EAAS,CAACsnD,EAAa,KAAK,EAAE,KAAK,GAAG,CAAC,CAChD,CAAC,CAEL,CAEA,eAAsBa,GACpBnoD,EACA4nD,EAC8B,CAC9B,GAAI,CACF,MAAM14F,EAAU,SAAS,cAAc,GAAG,EAC1CA,EAAQ,aACN,OACA,iCAAmC,mBAAmB8wC,CAAO,GAE/D9wC,EAAQ,aAAa,WAAY04F,CAAQ,EACzC14F,EAAQ,MAAM,QAAU,OACxB,SAAS,KAAK,YAAYA,CAAO,EACjCA,EAAQ,QACR,SAAS,KAAK,YAAYA,CAAO,CACnC,OAASvB,EAAO,CACd,eAAQ,MAAM,uCAAwCA,CAAK,EACpD,OACT,CACA,MAAO,SACT,0EC/DEwsE,EAGK7qB,EAAAt8B,EAAA4C,CAAA,cADIilD,EAAc,6BAAdA,EAAc,6FASvBV,EAGK7qB,EAAAt8B,EAAA4C,CAAA,cADIilD,EAAY,6BAAZA,EAAY,kGAjBD,2CACDA,EAAkB,4BAAlBA,EAAkB,8HAUjB,kDACDA,EAAgB,4BAAhBA,EAAgB,0PAXhBA,EAAkB,wGAWlBA,EAAgB,uLAxCxB,iBAAAutB,CAA8C,EAAA9tB,GAC9C,eAAA+tB,CAAsB,EAAA/tB,GACtB,aAAAguB,CAAoB,EAAAhuB,EACpB,iBAAAiuB,EAA0B,GAAI,EAAAjuB,EAErCkuB,EAQAC,gBAgBeD,EAAkBj7F,uBACnB,MAAAm7F,EAAA,IAAA/tB,EAAA,EAAAytB,EAAmB,MAAM,gBAUxBK,EAAgBl7F,uBACjB,MAAAo7F,EAAA,IAAAhuB,EAAA,EAAAytB,EAAmB,MAAM,gPAnCpCA,IAAqB,YAC1BztB,EAAA,EAAA6tB,EAAqB,EAAI,EACzB,gBACE7tB,EAAA,EAAAytB,EAAmB,MAAM,GACxBG,mBAIEH,IAAqB,UAC1BztB,EAAA,EAAA8tB,EAAmB,EAAI,EACvB,gBACE9tB,EAAA,EAAAytB,EAAmB,MAAM,GACxBG,kBAGEH,IAAqB,SAC1BztB,EAAA,EAAA6tB,EAAqB,EAAK,EAC1B7tB,EAAA,EAAA8tB,EAAmB,EAAK,iRCwEhB5tB,EAAO,IAAC,OAAS,+BACdgY,GAAAhY,UAAc,8NADjBA,EAAO,IAAC,OAAS,iPAVjBA,EAAO,IAAC,OAAS,+BACdgY,GAAAhY,UAAc,uQADjBA,EAAO,IAAC,OAAS,kKARxB,OAAAA,OAAS,GAAE,yvBAzEH,OAAAhB,CAA2B,EAAAS,EAC3B,YAAAsuB,EAAqB,EAAE,EAAAtuB,EACvB,eAAAuuB,EAAwB,EAAE,EAAAvuB,EAC1B,UAAAstB,EAAmB,UAAU,EAAAttB,EAC7B,eAAAwuB,EAAyB,EAAK,EAAAxuB,EAC9B,YAAAyuB,EAAsB,EAAK,EAAAzuB,EAE3B,MAAAe,EAAe,EAAE,EAAAf,EACjB,SAAAikB,EAAkB,EAAE,EAAAjkB,EACpB,UAAAc,EAAoB,EAAK,EAAAd,EACzB,gBAAA8jB,EAAyB,EAAE,EAAA9jB,EAC3B,YAAA+jB,EAAqB,EAAE,EAAA/jB,EACvB,iBAAAgkB,EAA0B,EAAE,EAAAhkB,EAE5B,MAAAj5D,EAAe,EAAE,EAAAi5D,EACjB,OAAApZ,EAAgB,EAAE,EAAAoZ,EAClB,UAAAkB,EAAoB,EAAK,EAAAlB,EAEzB,gBAAA+tB,EAAyB,6BAA6B,EAAA/tB,EACtD,cAAAguB,EACT,iEAAiE,EAAAhuB,EACxD,iBAAAiuB,EAA0B,GAAI,EAAAjuB,EAErC8tB,EAAiD,OAEjDY,WAUKC,GAAe,IAClBL,IAAe,IAAE,CAAKE,EAAa,CACrC,QAAQ,MAAM,4BAA4B,EAC1CnuB,EAAA,GAAAytB,EAAmB,OAAO,SAG5B,UAAU,UACP,UACCU,EACIloC,GAAgB,CAAG,WAAAmoC,CAAU,GAAI,SAAQ,EACzCH,CAAU,EAEf,UAEGjuB,EAAA,GAAAytB,EAAmB,SAAS,GAE7BV,GAAG,CACF,QAAQ,MACN,sDACAA,CAAG,EAEL/sB,EAAA,GAAAytB,EAAmB,OAAO,aAKzBc,GAAQ,IACXL,IAAkB,IAAE,CAAKC,EAAa,CACxC,QAAQ,MAAM,8BAA8B,eAGxCznF,EAAI,yDAA4D,UAAUynF,EAAgBloC,OAAqB,SAAQ,EAAKioC,CAAa,oBAC/IV,GAAa9mF,EAAI,GAAKumF,CAAQ,SAAS,KAAMuB,GAAY,CACvDxuB,EAAA,GAAAytB,EAAmBe,CAAY,4xBA1ClCxuB,EAAA,GAAEquB,EAAiBnvB,IAAW,OAASovB,EAAkBC,CAAQ,qBAG3DrvB,IAAW,OAChBc,EAAA,GAAAquB,EAAiBC,CAAe,EAEhCtuB,EAAA,GAAAquB,EAAiBE,CAAQ,ogBC0DhBruB,EAAkB,uDAciBA,EAAc,8CAI3CA,EAAY,0TAQmK,QAC5L,MAACA,EAAY;AAAA,KACf,ibApCuDh7B,EAAAupD,EAAA,QAAAC,EAAA,qDAAAxuB,EAAS,GAAC,SAC/D,OACA,GAAE,UAHRV,EA0CM7qB,EAAA85C,EAAAxzE,CAAA,qBA9BJ8lD,EA0BS0tB,EAAApM,CAAA,EAvBPthB,EAMWshB,EAAAsM,CAAA,OALIzuB,EAAU,iDAkBzBa,EAGKshB,EAAA3b,CAAA,8BAEP3F,EAEQ0tB,EAAAG,CAAA,4DArBSC,EAAsB,6CAX5B3uB,EAAkB,wBAOZA,EAAU,kCAWVA,EAAY,8BASxBA,EAAY,KAnCwC,CAAAvvD,GAAA6vD,EAAA,GAAAkuB,OAAA,qDAAAxuB,EAAS,GAAC,SAC/D,OACA,wPApCK,SAAA2uB,GAAuB5yC,EAAoB,CAC9CA,EAAM,MAAQ,OAChBA,EAAM,eAAc,iGA7ClB6yC,EAAYnpC,GAAS,EAAE,4BACvBopC,EAAcppC,GAAS,EAAE,4BAEzB0iC,EAAkB,YAEf2G,GAAe,KAEd,MAAAC,EAAc,KAAK,MAAMC,CAAU,EACzC,OAAAJ,EAAU,IAAI,KAAK,UAAUG,EAAa,KAAM,CAAC,GAC1C,QACC,CACR,eAAQ,KAAK,iBAAiB,EACvB,mBAIIE,GAAc,KACtBH,EAAe,GAClB,MAAM,eAAe,SAGjB,MAAA5G,EAAe,KAAK,MAAM8G,CAAU,EACpCr+B,GAAQu3B,GAAA,YAAAA,EAAc,QAAK,GACtB,UAAAzsF,KAAQk1D,YACNA,EAAMl1D,CAAI,GAAM,SAAQ,CAC3B,MAAAjJ,EAAG,IAAO,IAAIm+D,EAAMl1D,CAAI,GACxByzF,EAAkBlH,GAAUx1F,CAAG,EAC/B4sE,EAAS,MAAS7E,GAA+B20B,CAAe,EACtE/G,EAAmB1sF,CAAI,EAAI2jE,EAGzB,MAAAj6B,EAAU8iD,GAAcC,EAAcC,CAAkB,EAC9D0G,EAAY,IAAI1pD,CAAO,EACvB,UAAU,UACP,UAAUA,CAAO,EACjB,KAAI,KACH,MAAM,yCAAyC,CAEhD,SAAO0nD,GAAG,CACT,QAAQ,MAAM,mDAAoDA,CAAG,IAkC3E+B,EAAU,IAxBoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAwBQ,eAmBrBI,EAAU,+GCtFtB,SAASG,GAAah5F,EAAUi5F,EAAO,CAC5C,IAAI/+B,EAAM,GAAGl6D,EAAS,EAAE,IAAIA,EAAS,IAAM,KAAOA,EAAS,IAAM,EAAE,GAAGA,EAAS,KAAO,MAAQA,EAAS,KAAO,EAAE,GAAGA,EAAS,KAAO,MAAQA,EAAS,KAAO,EAAE,GAAGA,EAAS,KAAO,MAAQA,EAAS,KAAO,EAAE,GAAGA,EAAS,KAAO,MAAQA,EAAS,KAAO,EAAE,GACnPk6D,EAAIA,EAAI,OAAS,CAAC,IAAM,MAAKA,EAAMA,EAAI,MAAM,EAAG,EAAE,GACtD,MAAMg/B,EAAiBl5F,EAAS,eAC1BqhD,EAAQrhD,EAAS,MACjBxC,EAAOwC,EAAS,QACtB,IAAIm5F,EAAQ,GACRntF,EAAK,EACLotF,EAAgB,gBAChBC,EAAa,GACb1yC,EAAU,GACV2yC,EAAcC,EACdl4F,EAAU,GACVm4F,EACJ,QAASp0F,EAAI,EAAGA,EAAI8zF,EAAe,OAAQ9zF,IAAK,CAC1C8zF,EAAe9zF,CAAC,IAAM,SAExB8zF,EAAe9zF,CAAC,EAAI,IAElB8zF,EAAe9zF,CAAC,EAAE,UAAY,SAC5B8zF,EAAe9zF,CAAC,EAAE,QAAQ,WAAa,OACzCg0F,EAAgB,gBAEhBA,EAAgB,WAEdF,EAAe9zF,CAAC,EAAE,QAAQ,UAC5BuhD,EAAU,IAERuyC,EAAe9zF,CAAC,EAAE,QAAQ,aAAe,SAC3Ci0F,EAAaH,EAAe9zF,CAAC,EAAE,QAAQ,aAG3C,IAAIq0F,EAAe,EASnB,OARIP,EAAe9zF,CAAC,EAAE,UAAY,SAC3B,MAAM,QAAQ8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,IACjD8zF,EAAe9zF,CAAC,EAAE,QAAQ,OAAS,CAAC8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,GACtEq0F,EAAeP,EAAe9zF,CAAC,EAAE,QAAQ,OAAO,CAAC,EAC7C,OAAOq0F,GAAiB,WAC1BA,EAAeA,EAAa,QAAQ,MAAO,EAAE,EAAE,WAAW,IAAK,GAAG,IAG9Dj8F,EAAI,CACV,IAAK,UACL,IAAK,UACCwmD,GAAgBk1C,EAAe9zF,CAAC,EAAE,YAAY,GAChD,QAAQ,MAAM,kBAAkB,EAE9B8zF,EAAe9zF,CAAC,EAAE,SAAW,SAC/B8zF,EAAe9zF,CAAC,EAAE,OAASpF,EAAS,eAAeoF,CAAC,GAEtD+zF,GAAS,aAAaj/B,CAAG;AAAA,GACzBi/B,GAAS,WAAW37F,IAAS,UAAY,WAAa,cAAc,KAAK08D,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,GAAGjtF,EAAK,EAAE;AAAA,GACxHmtF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,MAAM;AAAA,GACpC+zF,GAAS,YAAaC,CAAa,IAC/BzyC,IACFwyC,GAAS,OAEXA,GAAS;AAAA,GACT,QAASz3F,EAAI,EAAGA,EAAIw3F,EAAe9zF,CAAC,EAAE,aAAa,OAAQ1D,IACrD23F,EAAa,GAAK33F,IAAM23F,IAC1BF,GAAS;AAAA,GAEPD,EAAe9zF,CAAC,EAAE,aAAa1D,CAAC,EAAE,OACpCy3F,GAAS,aAAeD,EAAe9zF,CAAC,EAAE,aAAa1D,CAAC,EAAE,KAAK;AAAA,GAE/Dy3F,GAAS,gBAAkBD,EAAe9zF,CAAC,EAAE,aAAa1D,CAAC,EAAE,KAAK;AAAA,GAGtEy3F,GAAS,UAAWC,CAAa;AAAA,GACjCD,GAAS,SAAS37F,IAAS,UAAY,WAAa,cAAc;AAAA;AAAA,GAClEwO,IACA,MAEF,IAAK,UACCktF,EAAe9zF,CAAC,EAAE,SAAW,SAC/B8zF,EAAe9zF,CAAC,EAAE,OAASpF,EAAS,eAAeoF,CAAC,GAElD8zF,EAAe9zF,CAAC,EAAE,eAAiB,SACrC8zF,EAAe9zF,CAAC,EAAE,aAAe,CAC/B,CACE,MAAOpF,EAAS,iBAAiBoF,CAAC,EAClC,OAAQ,GACtB,CACA,GAEQ+zF,GAAS,aAAaj/B,CAAG;AAAA,GACzBi/B,GAAS,sBAAuBj/B,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,GAChFmtF,GAAS,KAAOD,EAAe9zF,CAAC,EAAE,MAAM;AAAA,GACxC+zF,GAAS,eAAiBD,EAAe9zF,CAAC,EAAE,aAAa,CAAC,EAAE,KAAK;AAAA,EACjE+zF,GAAS,gBAAkBD,EAAe9zF,CAAC,EAAE,aAAa,CAAC,EAAE,MAAM,IAC/D8zF,EAAe9zF,CAAC,EAAE,aAAa,CAAC,EAAE,YAAc,OAClD+zF,GAAS,IAAID,EAAe9zF,CAAC,EAAE,aAAa,CAAC,EAAE,SAAS,IAExD+zF,GAAS,UAEPD,EAAe9zF,CAAC,EAAE,aAAa,CAAC,EAAE,aAAe,OACnD+zF,GAAS,IAAID,EAAe9zF,CAAC,EAAE,aAAa,CAAC,EAAE,UAAU,IAEzD+zF,GAAS,SAGXA,GAAS;AAAA;AAAA;AAAA,EACTntF,IACA,MACF,IAAK,SAsBH,GAdIktF,EAAe9zF,CAAC,EAAE,SAAW,SAC/B8zF,EAAe9zF,CAAC,EAAE,OAASpF,EAAS,eAAeoF,CAAC,GAElD8zF,EAAe9zF,CAAC,EAAE,eAAiB,SACrC8zF,EAAe9zF,CAAC,EAAE,aAAe,CAC/B,CACE,MAAOpF,EAAS,iBAAiBoF,CAAC,EAClC,OAAQ,EACtB,CACA,GAEa,MAAM,QAAQ8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,IACjD8zF,EAAe9zF,CAAC,EAAE,QAAQ,OAAS,CAAC8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,GAElE8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,gBAAkB,OAAW,CAC3D8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,oBAAsB,SACxD8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,kBAAoB,KAEtD+zF,GAAS,aAAaj/B,CAAG;AAAA,EACzBi/B,GAAS;AAAA,EACTA,GAAS,0BAA0Bj/B,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,GACnFmtF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,MAAM;AAAA;AAAA,EAChC8zF,EAAe9zF,CAAC,EAAE,eAAiB,SACrC+zF,GAAS,aAAaD,EAAe9zF,CAAC,EAAE,aAAa,CAAC,EAAE,KAAK;AAAA,GAE/D,IAAIs0F,EAAa,EACbR,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,iBAAmB,OACrDs0F,EAAa,KAAK,IAChBR,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,eAChC8E,GACEgvF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,aAChD,CACA,EAEYs0F,EAAaxvF,GACXgvF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,aAC9C,EAEU,IAAIu0F,EAAiB,EAEnBT,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,qBAAuB,OAEvDu0F,EAAiB,KAAK,IACpBT,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,mBAChC8E,GACEgvF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,iBAChD,CACA,EAEYu0F,EAAiBzvF,GACfgvF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,iBAC9C,EAEU+zF,GAAS;AAAA,EACTA,GAAS;AAAA,uBAA8BD,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,aAAa,YAAYs0F,CAAU,oBAAoBR,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,cAAgB,GAAK8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,MAAQ,OAAS,OAAO,aACvO8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,eAAiB,SACnD+zF,GAAS,eAAeD,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,YAAY,KACtE+zF,GAAS,uDAAuDD,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,aAAe,IAAK;AAAA,EACpH+zF,GAAS;AAAA,EACTA,GAAS,wDACTA,GAAS,0BAA0Bj/B,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,CAAC;AAAA,GAClFmtF,GAAS,iBAETA,GAAS;AAAA,uBAAkCD,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,iBAAiB,YAAYu0F,CAAc,kCACtHR,GAAS,uDAAuDD,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,aAAe,IAAK;AAAA,EACpH+zF,GAAS;AAAA;AAAA;AAAA;AAAA,EACTntF,GAAM,CACR,SACEytF,IAAiB,QACjBA,EAAa,MAAQ,OACrB,CAEAN,GAAS,aAAaj/B,CAAG;AAAA,EACzBi/B,GAAS,0BAA0Bj/B,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,GACnFmtF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,MAAM;AAAA,EAChC8zF,EAAe9zF,CAAC,EAAE,eAAiB,SACrC+zF,GAAS,aAAaD,EAAe9zF,CAAC,EAAE,aAAa,CAAC,EAAE,KAAK;AAAA,GAE/D,IAAIw0F,EAAY,EACZV,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,YAAc,OAChDw0F,EAAY,KAAK,IACfV,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,UAChC8E,GAAoCuvF,EAAa,GAAG,CAClE,EACqBP,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,SAAW,OACpDw0F,EAAY,KAAK,IACfV,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,OAChC8E,GAAoCuvF,EAAa,GAAG,CAClE,EAEYG,EAAY1vF,GAAoCuvF,EAAa,GAAG,EAElE,IAAII,EAAY,EACZX,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,YAAc,OAChDy0F,EAAY,KAAK,IACfX,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,WAAa,EAC7C8E,GAAoCuvF,EAAa,GAAG,CAClE,EACqBP,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,SAAW,OACpDy0F,EAAY,KAAK,IACfX,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,OAChC8E,GAAoCuvF,EAAa,GAAG,CAClE,EAEYI,EAAY3vF,GAAoCuvF,EAAa,GAAG,EAElE,IAAIK,EAAW,GACXZ,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,QAAU,OAC5C00F,EAAWZ,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,MAE3C00F,EAAWL,EAAa,QAAU,GAEpC,IAAIM,EACAC,EACAP,EAAa,IAAM,GACrBM,EAAW3wF,GACTqwF,EAAa,IAAMA,EAAa,IAAM,IAAMI,EAC5C,CACd,EACYG,EAAqB5wF,GACnBqwF,EAAa,IACXA,EAAa,IACX,IAAMvvF,GAAoCuvF,EAAa,GAAG,EAC9D,CACd,IAEYM,EAAW3wF,GACTqwF,EAAa,IAAMA,EAAa,IAAM,IAAMI,EAC5C,CACd,EACYG,EAAqB5wF,GACnBqwF,EAAa,IACXA,EAAa,IACX,IAAMvvF,GAAoCuvF,EAAa,GAAG,EAC9D,CACd,GAEUN,GAAS,uBAAuBY,CAAQ,YAAYH,EAAYC,CAAS,aAAaA,CAAS,SAASC,CAAQ,aAChHX,GAAS,+HAA+Ha,CAAkB;AAAA,EAC1Jb,GAAS;AAAA;AAAA;AAAA,EACTntF,GAAM,CACR,KAAO,CACL,IAAIiuF,EAqCJ,GAnCEf,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,qBAAuB,QACvD8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,qBAAuB,GAEvDk0F,EAAe,KAAK,IAClBxvF,GACE0U,GAAsBi7E,CAAY,EAAE,CAAC,CACrD,EACcP,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,UAAY,CAC1D,EACYm0F,EAAe,KAAK,IAClBrvF,GACEsU,GAAsBi7E,CAAY,EAAE,CAAC,CACrD,EACc,MAAMP,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,OAASk0F,CAAY,EACvD,EACAJ,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,OAASk0F,CAC3D,EACYW,EAAiB,KAAK,IACpB/vF,GACEsU,GAAsBi7E,CAAY,EAAE,CAAC,CACrD,EACcP,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,oBAAsB,CACpE,IAEYk0F,EAAe,KAAK,IAClBxvF,GAAqC2vF,CAAY,EACjDP,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,UAAY,CAC1D,EACYm0F,EAAe,KAAK,IAClBrvF,GAAoCuvF,CAAY,EAChD,MAAMP,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,OAASk0F,CAAY,EACvD,EACAJ,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,OAASk0F,CAC3D,GAEcJ,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,mBAAqB,OAAW,CAClE,MAAM80F,EACJhB,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,iBAAmBq0F,EACrDH,EAAe,KAAK,IAClBA,EACAxvF,GAAqCowF,CAAW,CAC9D,EACYT,EAAeP,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,iBAC/C8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,OAC9B8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,SAAW,mBACvC80F,EAAc,IAAMZ,EAAe,EACnCY,EAAc,IAAMZ,CAC5B,CACAH,GAAS,aAAaj/B,CAAG;AAAA,GACzBi/B,GAAS,0BAA0Bj/B,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,GACnFmtF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,MAAM;AAAA,GAChC8zF,EAAe9zF,CAAC,EAAE,eAAiB,SACrC+zF,GAAS,aAAaD,EAAe9zF,CAAC,EAAE,aAAa,CAAC,EAAE,KAAK;AAAA,GAE3D8zF,EAAe9zF,CAAC,EAAE,QAAQ,gBAAkB,SAC9C+zF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,QAAQ,KAAK,KAC7C+zF,GAAS,uBAAuBM,CAAY,YAAYF,EAAeD,CAAY,aAAaA,CAAY,SAASJ,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,KAAK,IACtJ8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,eAAiB,SACnD+zF,GAAS,eAAeD,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,YAAY,KAEpE8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,qBAAuB,QACvD8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,qBAAuB,IAGvD+zF,GAAS,YAAYc,CAAc,aAAaf,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,aAAa,KAG7F8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,SAAW,QAC3C8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,SAAW,IAE3C+zF,GAAS,UAAUD,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,MAAM,IACzD+zF,GAAS,eAAeD,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,aAAe,IAAK,KAG5E8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,WAAa,QAC7C8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,WAEhC+zF,GAAS,YAAYD,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,QAAQ,KAG7D8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,SAAW,QAC3C8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,SAEhC+zF,GAAS,UAAUD,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,MAAM,KAGzD8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,QAAU,QAC1C8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,QAEhC+zF,GAAS,SAASD,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,KAAK,KAGvD8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,SAAW,QAC3C8zF,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,OAEhC+zF,GAAS,WAAWD,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,MAAM,KAE1D+zF,GAAS,cAEXA,GAAS,yDACLD,EAAe9zF,CAAC,EAAE,QAAQ,gBAAkB,UAC9C+zF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,QAAQ,KAAK;AAAA,GAC7C+zF,GAAS;AAAA;AAAA;AAAA,EACTntF,GACF,CACA,MACF,QAaE,GAZIxO,IAAS,cACX,OAAO,OACL,sFACA,CAAE,KAAAA,CAAI,CAClB,EAGY07F,EAAe9zF,CAAC,EAAE,SAAW,SAE/B8zF,EAAe9zF,CAAC,EAAE,OAASpF,EAAS,eAAeoF,CAAC,EAChD8zF,EAAe9zF,CAAC,EAAE,SAAW,SAE/B8zF,EAAe9zF,CAAC,EAAE,eAAiB,OAAW,MAE9C8zF,EAAe9zF,CAAC,EAAE,UAAY,SAChC/D,EAAU63F,EAAe9zF,CAAC,EAAE,SAE9B+zF,GAAS,aAAaj/B,CAAG;AAAA,GACrB,OAAOg/B,EAAe9zF,CAAC,EAAE,QAAY,KACnC8zF,EAAe9zF,CAAC,EAAE,QAAQ,eAC5B+zF,GAAS,gCACLD,EAAe9zF,CAAC,EAAE,QAAQ,gBAC5B+zF,GAAS,MAETA,GAAS,IAEXA,GAAS;AAAA,GAIT,OAAOD,EAAe9zF,CAAC,EAAE,QAAY,KACnC8zF,EAAe9zF,CAAC,EAAE,QAAQ,qBAC5B+zF,GAAS,qBAAqBj/B,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE,iCAI9EktF,EAAe9zF,CAAC,EAAE,gBACpB+zF,GAAS,sCAAsCD,EAAe9zF,CAAC,EAAE,cAAc,CAAC,CAAC;AAAA,GAEnFo0F,EAAyB;AAAA,IAErBN,EAAe9zF,CAAC,EAAE,eAAiB,QACrC8zF,EAAe9zF,CAAC,EAAE,gBAElB+zF,GAAS,kBACTK,EAAyB,IAEvBN,EAAe9zF,CAAC,EAAE,cAAgB,OAEpC+zF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,MAAM,IAAMo0F,EACjCN,EAAe9zF,CAAC,EAAE,YAC3B+zF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,MAAM,IAAMo0F,EACjCN,EAAe9zF,CAAC,EAAE,qBAAuB,QAC9C8zF,EAAe9zF,CAAC,EAAE,oBAAsBA,IAAM,IAChD+zF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,MAAM,IAAMo0F,IAI1CN,EAAe9zF,CAAC,EAAE,eAAiB,QACrC8zF,EAAe9zF,CAAC,EAAE,gBAElB+zF,GAAS,iBAEPD,EAAe9zF,CAAC,EAAE,gBACpB+zF,GAAS;AAAA,iCAAoDD,EAAe9zF,CAAC,EAAE,cAAc,CAAC,CAAC;AAAA,GAE7F,OAAO8zF,EAAe9zF,CAAC,EAAE,QAAY,KACnC8zF,EAAe9zF,CAAC,EAAE,QAAQ,qBAC5B+zF,GAAS;AAAA,GAIT,OAAOD,EAAe9zF,CAAC,EAAE,QAAY,KAErC8zF,EAAe9zF,CAAC,EAAE,QAAQ,WAC1B,CAAC8zF,EAAe9zF,CAAC,EAAE,QAAQ,eAE3B+zF,GAAS,gCACLD,EAAe9zF,CAAC,EAAE,QAAQ,gBAC5B+zF,GAAS,MAETA,GAAS,IAEXA,GAAS;AAAA,GAGb,QACMgB,EAAK,EAAGC,EAAQvyD,EAAMma,EAAcuC,EAAK01C,EAC7CE,EAAKjB,EAAe9zF,CAAC,EAAE,aAAa,OACpC+0F,IAOA,OAJAtyD,EAAOqxD,EAAe9zF,CAAC,EAAE,aAAa+0F,CAAE,EACxCC,EAASvyD,EAAK,KAEdma,EAAena,EAAK,aACZuyD,EAAM,CACZ,IAAK,UACL,IAAK,UACCp2C,GAAgBhC,CAAY,GAC9B,QAAQ,KAAK,kBAAkB,EAE7Bna,EAAK,UAAY,SACfA,EAAK,QAAQ,WAAa,OAC5BuxD,EAAgB,gBAEhBA,EAAgB,WAEdvxD,EAAK,QAAQ,UACf8e,EAAU,IAER9e,EAAK,QAAQ,aAAe,SAC9BwxD,EAAaxxD,EAAK,QAAQ,aAG9BsxD,GAAS,GAAGgB,EAAK,IAAMC,IAAW,WAAcA,IAAW,WAAa,OAAOlB,EAAe9zF,CAAC,EAAE,QAAY,KAAe,CAAC8zF,EAAe9zF,CAAC,EAAE,QAAQ,iBAAoB,wDAA0D,EAAE,GACvO+zF,GACE,OAAOD,EAAe9zF,CAAC,EAAE,QAAY,KACrC8zF,EAAe9zF,CAAC,EAAE,QAAQ,mBACtB;AAAA,wDACA,GACN+zF,GAAS,WAAWiB,IAAW,UAAY,WAAa,cAAc,KAAKlgC,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,GACvH67B,EAAK,SAAW,SAClBsxD,GAAStxD,EAAK,OAAS;AAAA,GASzBsxD,GAAS,YAAaC,CAAa,IAC/BzyC,IACFwyC,GAAS,OAEXA,GAAS;AAAA,GACT,QAASz3F,EAAI,EAAGA,EAAIsgD,EAAa,OAAQtgD,IACnC23F,EAAa,GAAK33F,IAAM23F,IAC1BF,GAAS;AAAA,GAEPtxD,EAAK,aAAanmC,CAAC,EAAE,OACvBy3F,GAAS,aAAen3C,EAAatgD,CAAC,EAAE,KAAK;AAAA,GAE7Cy3F,GAAS,gBAAkBn3C,EAAatgD,CAAC,EAAE,KAAK;AAAA,GAGpDy3F,GAAS,UAAWC,CAAa;AAAA,GACjCD,GAAS,SAASiB,IAAW,UAAY,WAAa,cAAc;AAAA,EACpEpuF,IACA,MACF,IAAK,SAMH,GALAu4C,EAAM1c,EAAK,aAAa,CAAC,EAAE,QACtB,MAAM,QAAQ0c,EAAI,MAAM,IAE3BA,EAAI,OAAS,CAACA,EAAI,MAAM,GAEtBA,EAAI,MAAM,gBAAkB,OAAW,CAErCA,EAAI,MAAM,oBAAsB,SAClCA,EAAI,MAAM,kBAAoB,KAG9B41C,IAAO,GACPjB,EAAe9zF,CAAC,EAAE,yBAA2B,QAC7C8zF,EAAe9zF,CAAC,EAAE,yBAElB+zF,GAAS,iCAAiCj/B,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,GAAGviF,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,GAC3HmtF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,MAAM;AAAA,EACpC+zF,GAAS,wBAIXA,GAAS;AAAA,EACTA,GAAS,GAAGgB,EAAK,GAAMA,IAAO,GAAKjB,EAAe9zF,CAAC,EAAE,yBAA2B,QAAa8zF,EAAe9zF,CAAC,EAAE,uBAA0B,wDAA0D,EAAE,0BAA0B80D,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,GAE3Qg2C,IAAiB,SACnBm3C,GAAS,aAAan3C,EAAa,CAAC,EAAE,KAAK;AAAA,GAE7Cm3C,GAAS,GAAG50C,EAAI,KAAK;AAAA;AAAA,EACrB,IAAIm1C,EAAa,EACbn1C,EAAI,MAAM,iBAAmB,OAC/Bm1C,EAAa,KAAK,IAChBn1C,EAAI,MAAM,eACVr6C,GACEq6C,EAAI,MAAM,aAChC,CACA,EAEkBm1C,EAAaxvF,GACXq6C,EAAI,MAAM,aAC9B,EAEgB,IAAIo1C,EAAiB,EACjBp1C,EAAI,MAAM,qBAAuB,OACnCo1C,EAAiB,KAAK,IACpBp1C,EAAI,MAAM,mBACVr6C,GACEq6C,EAAI,MAAM,iBAChC,CACA,EAEkBo1C,EAAiBzvF,GACfq6C,EAAI,MAAM,iBAC9B,EAEgB40C,GAAS;AAAA,EACTA,GAAS;AAAA,uBAA8B50C,EAAI,MAAM,aAAa,YAAYm1C,CAAU,oBAAoBn1C,EAAI,MAAM,cAAgB,EAAI,OAAS,OAAO,aACtJ40C,GAAS,uDAAuD50C,EAAI,MAAM,aAAe,IAAK;AAAA,EAC9F40C,GAAS;AAAA,EACTA,GAAS,wDACTA,GAAS,0BAA0Bj/B,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,CAAC;AAAA,GAClFmtF,GAAS,iBAETA,GAAS;AAAA,uBAAkC50C,EAAI,MAAM,iBAAiB,YAAYo1C,CAAc,kCAChGR,GAAS,uDAAuD50C,EAAI,MAAM,aAAe,IAAK;AAAA,EAC9F40C,GAAS;AAAA,EAETntF,GAAM,CACR,SAAWu4C,EAAI,OAAO,CAAC,EAAE,MAAQ,OAAW,CAI1Ck1C,EAAel1C,EAAI,OAAO,CAAC,EAGzB41C,IAAO,GACPjB,EAAe9zF,CAAC,EAAE,yBAA2B,QAC7C8zF,EAAe9zF,CAAC,EAAE,yBAElB+zF,GAAS,iCAAiCj/B,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,GAAGviF,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,GAC3HmtF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,MAAM;AAAA,EACpC+zF,GAAS,wBAGXA,GAAS,GAAGgB,EAAK,GAAMA,IAAO,GAAKjB,EAAe9zF,CAAC,EAAE,yBAA2B,QAAa8zF,EAAe9zF,CAAC,EAAE,uBAA0B,wDAA0D,EAAE,0BAA0B80D,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,GACzQg2C,EAAa,CAAC,EAAE,QAAQ,aAAe,SAC3Cm3C,GAAS,WACTA,GAAS,GAAGn3C,EAAa,CAAC,EAAE,QAAQ,UAAU,KAK5Cm4C,IAAO,GACPjB,EAAe9zF,CAAC,EAAE,yBAA2B,QAC7C8zF,EAAe9zF,CAAC,EAAE,yBAGpB+zF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,MAAM;AAAA,GAElC48C,IAAiB,SACnBm3C,GAAS,aAAan3C,EAAa,CAAC,EAAE,KAAK;AAAA,GAE7Cm3C,GAAS,GAAG50C,EAAI,KAAK;AAAA,EACrB,IAAIq1C,EAAY,EACZr1C,EAAI,MAAM,YAAc,OAC1Bq1C,EAAY,KAAK,IACfr1C,EAAI,MAAM,UACVr6C,GAAoCuvF,EAAa,GAAG,CACxE,EAC2Bl1C,EAAI,MAAM,SAAW,OAC9Bq1C,EAAY,KAAK,IACfr1C,EAAI,MAAM,OACVr6C,GAAoCuvF,EAAa,GAAG,CACxE,EAEkBG,EAAY1vF,GACVuvF,EAAa,GACjC,EAEgB,IAAII,EAAY,EACZt1C,EAAI,MAAM,YAAc,OAC1Bs1C,EAAY,KAAK,IACft1C,EAAI,MAAM,UACVr6C,GAAoCuvF,EAAa,GAAG,CACxE,EAC2Bl1C,EAAI,MAAM,SAAW,OAC9Bs1C,EAAY,KAAK,IACft1C,EAAI,MAAM,OACVr6C,GAAoCuvF,EAAa,GAAG,CACxE,EAEkBI,EAAY3vF,GACVuvF,EAAa,GACjC,EAEgB,IAAIK,EAAW,GACXv1C,EAAI,MAAM,QAAU,OACtBu1C,EAAWv1C,EAAI,MAAM,MAErBu1C,EAAWL,EAAa,IAAMA,EAAa,IAAM,EAEnD,IAAIM,EACAC,EAEFz1C,EAAI,MAAM,cAAgB,MAC1BA,EAAI,MAAM,aAAa,KAAO,MAC9BA,EAAI,MAAM,aAAa,KAAO,MAE1Bk1C,EAAa,IAAM,EACrBM,EAAW3wF,GACTqwF,EAAa,IAAMA,EAAa,IAAM,IAAMI,EAC5CA,CACtB,EAEoBE,EAAW3wF,GACTqwF,EAAa,IAAMA,EAAa,IAAM,IAAMI,EAC5CA,CACtB,EAEsBt1C,EAAI,MAAM,aAAa,IAAM,EAC/By1C,EAAqB5wF,GACnBm7C,EAAI,MAAM,aAAa,IACrBA,EAAI,MAAM,aAAa,IAAM,IAAMs1C,EACrCA,CACtB,EAEoBG,EAAqB5wF,GACnBm7C,EAAI,MAAM,aAAa,IACrBA,EAAI,MAAM,aAAa,IAAM,IAAMs1C,CAC3D,GAGsBJ,EAAa,IAAM,GACrBM,EAAW3wF,GACTqwF,EAAa,IAAMA,EAAa,IAAM,IAAMI,EAC5CA,CACtB,EACoBG,EAAqB5wF,GACnBqwF,EAAa,IACXA,EAAa,IACX,IACEvvF,GACEuvF,EAAa,GAC3C,EACsB,CACtB,IAEoBM,EAAW3wF,GACTqwF,EAAa,IAAMA,EAAa,IAAM,IAAMI,EAC5CA,CACtB,EACoBG,EAAqB5wF,GACnBqwF,EAAa,IACXA,EAAa,IACX,IACEvvF,GACEuvF,EAAa,GAC3C,EACsB,CACtB,GAGgBN,GAAS,uBAAuBY,CAAQ,YAAYH,EAAYC,CAAS,aAAaA,CAAS,SAASC,CAAQ,aAChHX,GAAS,+HAA+Ha,CAAkB;AAAA,EACpJh4C,EAAa,CAAC,EAAE,QAAQ,aAAe,SAC3Cm3C,GAAS,SACTA,GAAS,GAAGn3C,EAAa,CAAC,EAAE,QAAQ,UAAU,KAEhDm3C,GAAS;AAAA,EACTntF,GAAM,CACR,KAAO,CAsCL,GAnCEu4C,EAAI,MAAM,qBAAuB,QACjCA,EAAI,MAAM,qBAAuB,GAEjC+0C,EAAe,KAAK,IAClBxvF,GACE0U,GAAsB+lC,EAAI,OAAO,CAAC,CAAC,EAAE,CAAC,CAC5D,EACoBA,EAAI,MAAM,UAAY,CAC1C,EACkBg1C,EAAe,KAAK,IAClBrvF,GACEsU,GAAsB+lC,EAAI,OAAO,CAAC,CAAC,EAAE,CAAC,CAC5D,EACoB,MAAMA,EAAI,MAAM,OAAS+0C,CAAY,EACjC,EACA/0C,EAAI,MAAM,OAAS+0C,CAC3C,EACkBW,EAAiB,KAAK,IACpB/vF,GACEsU,GAAsB+lC,EAAI,OAAO,CAAC,CAAC,EAAE,CAAC,CAC5D,EACoBA,EAAI,MAAM,oBAAsB,CACpD,IAEkB+0C,EAAe,KAAK,IAClBxvF,GAAqCy6C,EAAI,OAAO,CAAC,CAAC,EAClDA,EAAI,MAAM,UAAY,CAC1C,EACkBg1C,EAAe,KAAK,IAClBrvF,GAAoCq6C,EAAI,OAAO,CAAC,CAAC,EACjD,MAAMA,EAAI,MAAM,OAAS+0C,CAAY,EACjCnvF,GAAmBo6C,EAAI,OAAO,CAAC,EAAI+0C,CAAY,EAC/C/0C,EAAI,MAAM,OAAS+0C,CAC3C,GAEoB/0C,EAAI,MAAM,mBAAqB,OAAW,CAC5C,MAAM21C,EAAc31C,EAAI,MAAM,iBAAmBk1C,EACjDH,EAAe,KAAK,IAClBA,EACAxvF,GAAqCowF,CAAW,CACpE,EACkBT,EAAel1C,EAAI,MAAM,iBACzBA,EAAI,MAAM,OACR20C,EAAe9zF,CAAC,EAAE,QAAQ,MAAM,SAChC,mBACI80F,EAAc,IAAMZ,EAAe,EACnCY,EAAc,IAAMZ,CAC5B,CAIEa,IAAO,GACPjB,EAAe9zF,CAAC,EAAE,yBAA2B,QAC7C8zF,EAAe9zF,CAAC,EAAE,yBAElB+zF,GAAS,iCAAiCj/B,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,GAAGviF,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,GAC3HmtF,GAAS,GAAGD,EAAe9zF,CAAC,EAAE,MAAM;AAAA,EACpC+zF,GAAS,wBAKT,OAAOn3C,EAAa,CAAC,EAAE,eAAmB,KAC1CA,EAAa,CAAC,EAAE,iBAEhBm3C,GAAS,gCAEPD,EAAe9zF,CAAC,EAAE,QAAQ,kBAAoB,QAC9C8zF,EAAe9zF,CAAC,EAAE,QAAQ,gBAE1B+zF,GAAS,MAETA,GAAS,IAEXA,GAAS;AAAA,IAITgB,EAAK,GACJA,IAAO,GACNjB,EAAe9zF,CAAC,EAAE,yBAA2B,QAC7C8zF,EAAe9zF,CAAC,EAAE,0BAEpB+zF,GACE;AAAA,wDAEJA,GAAS,0BAA0Bj/B,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,GAM/Eg2C,IAAiB,SACnBm3C,GAAS,aAAan3C,EAAa,CAAC,EAAE,KAAK;AAAA,GAE7Cm3C,GAAS,GAAG50C,EAAI,KAAK;AAAA,EACfvC,EAAa,CAAC,EAAE,QAAQ,aAAe,SAC3Cm3C,GAAS,WACTA,GAAS,GAAGn3C,EAAa,CAAC,EAAE,QAAQ,UAAU,KAEhDm3C,GAAS,uBAAuB50C,EAAI,OAAO,CAAC,CAAC,YAAYg1C,EAAeD,CAAY,aAAaA,CAAY,SAAS/0C,EAAI,MAAM,KAAK,IAEnIA,EAAI,MAAM,qBAAuB,QACjCA,EAAI,MAAM,qBAAuB,IAGjC40C,GAAS,YAAYc,CAAc,aAAa11C,EAAI,MAAM,aAAa,KAErEA,EAAI,MAAM,SAAW,QAAaA,EAAI,MAAM,SAAW,IACzD40C,GAAS,UAAU50C,EAAI,MAAM,MAAM,KAGjCA,EAAI,MAAM,WAAa,QAAaA,EAAI,MAAM,WAChD40C,GAAS,YAAY50C,EAAI,MAAM,QAAQ,KAErCA,EAAI,MAAM,SAAW,QAAaA,EAAI,MAAM,SAC9C40C,GAAS,UAAU50C,EAAI,MAAM,MAAM,KAEjCA,EAAI,MAAM,QAAU,QAAaA,EAAI,MAAM,QAC7C40C,GAAS,SAAS50C,EAAI,MAAM,KAAK,KAGjCA,EAAI,MAAM,eAAiB,QAC3BA,EAAI,MAAM,eAEV40C,GAAS,eAAe50C,EAAI,MAAM,YAAY,KAE5CA,EAAI,MAAM,SAAW,QAAaA,EAAI,MAAM,OAC9C40C,GAAS,WAAW50C,EAAI,MAAM,MAAM,KAEpC40C,GAAS,cAEXA,GACE;AAAA,EACIn3C,EAAa,CAAC,EAAE,QAAQ,aAAe,SAC3Cm3C,GAAS,SACTA,GAAS,GAAGn3C,EAAa,CAAC,EAAE,QAAQ,UAAU,KAEhDm3C,GAAS;AAAA,EAEL,OAAOn3C,EAAa,CAAC,EAAE,aAAiB,KACtCA,EAAa,CAAC,EAAE,eAClBm3C,GAAS;AAAA,GAIbntF,GACF,CACA,MACF,IAAK,UAGD,OAAOg2C,EAAa,CAAC,EAAE,eAAmB,KAC1CA,EAAa,CAAC,EAAE,iBAEhBm3C,GAAS,gCAEPD,EAAe9zF,CAAC,EAAE,UAAY,QAC9B8zF,EAAe9zF,CAAC,EAAE,QAAQ,kBAAoB,QAC9C8zF,EAAe9zF,CAAC,EAAE,QAAQ,gBAE1B+zF,GAAS,MAETA,GAAS,IAEXA,GAAS;AAAA,EACLgB,EAAK,IACPhB,GACE,0DAEFn3C,EAAa,CAAC,EAAE,qBAAuB,OACzCm3C,GAAS,IAAKgB,EAAK,EAAI,wDAA0D,EAAE,qBAAqBjgC,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,EAC/Ig2C,EAAa,CAAC,EAAE,mBACzBm3C,GAAS,IAAKgB,EAAK,EAAI,wDAA0D,EAAE,qBAAqBjgC,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,EAExJmtF,GAAS,4EAA6Ej/B,CAAG,IAAIxjD,GAAoBuiF,EAAQ,CAAC,CAAC,IAAIjtF,EAAK,EAAE;AAAA,EAElIg2C,EAAa,CAAC,EAAE,SAAW,SAC/Bm3C,GAAS,IAAKn3C,EAAa,CAAC,EAAE,MAAM;AAAA,GACtCm3C,GAAS,eAAiBn3C,EAAa,CAAC,EAAE,KAAK;AAAA,EAG/Cm3C,GAAS,gBAAkBn3C,EAAa,CAAC,EAAE,MAAM,IAC5C,MAAMA,EAAa,CAAC,EAAE,SAAS,EAGlCm3C,GAAS,UAFTA,GAAS,IAAIn3C,EAAa,CAAC,EAAE,SAAS,IAInC,MAAMA,EAAa,CAAC,EAAE,UAAU,EAGnCm3C,GAAS,SAFTA,GAAS,IAAIn3C,EAAa,CAAC,EAAE,UAAU,IAMzCm3C,GAAS;AAAA,EACTA,GAAS;AAAA,EAEL,OAAOn3C,EAAa,CAAC,EAAE,aAAiB,KACtCA,EAAa,CAAC,EAAE,eAClBm3C,GAAS;AAAA,GAGbntF,IACA,KACd,CAEY,OAAOktF,EAAe9zF,CAAC,EAAE,QAAY,MAErC8zF,EAAe9zF,CAAC,EAAE,QAAQ,WAC1B8zF,EAAe9zF,CAAC,EAAE,QAAQ,gBAE1B+zF,GAAS;AAAA,GAGTD,EAAe9zF,CAAC,EAAE,gBACpB+zF,GAAS;AAAA,GAEXA,GAAS;AAAA,EACT,KACR,CACE,CACA,OAAAA,EAAQA,EAAM,WACZ,mCACA;AAAA;AAAA;AAAA,CACJ,EACEA,EAAQA,EAAM,WAAW,OAAQ;AAAA,CAAQ,EAClC,CAACA,EAAOj/B,EAAKl6D,EAAS,YAAaqhD,EAAOhgD,CAAO,CAC1D,CAaO,SAASg5F,GAAiB,CAC/B,UAAA33C,EACA,YAAAthD,EAAc,GACd,cAAAk5F,EAAgB,EAChB,QAAAC,EAAU,gBACV,MAAAl5C,EAAQ,aACR,WAAAm5C,EAAa,cACf,OAAE19E,EAAS,IACX,EAAG,CAID,IAAIm8E,EAAQ,EACRzsF,EACAiuF,EACJ,MAAMC,EAA6B,GAC7BC,EAAS73F,GAAQ,EAAG,GAAM,EAC1B83F,EAAoB,GACpBC,EAAe,CAAC,EAAE,EAClBC,EAAgB,GAChBC,EAAkB,GAExB,GADqBr4C,EAAU,OAAQzgD,GAAOA,EAAG,QAAQ,EAAE,SACtC,EAAG,MAAO,GAC/B,UAAWjC,KAAY0iD,EACrBl2C,EAAOwsF,GAAah5F,EAAUi5F,CAAK,EACnCA,IACAwB,EAAcG,EAAkB,QAAQpuF,EAAK,CAAC,CAAC,EAC3CiuF,IAAgB,IAElBG,EAAkB,KAAKpuF,EAAK,CAAC,CAAC,EAC9BiuF,EAAcG,EAAkB,QAAQpuF,EAAK,CAAC,CAAC,EAC/CquF,EAAaJ,CAAW,EAAIO,GAAYxuF,EAAK,CAAC,CAAC,EAG3C,OAAOpL,EAAYq5F,CAAW,EAAM,KACtCC,EAA2BD,CAAW,EAAI,GAC1Cr5F,EAAYq5F,CAAW,EAAIjuF,EAAK,CAAC,GAGjCkuF,EAA2BD,CAAW,EAAI,GAG5CK,EAAcL,CAAW,EAAIjuF,EAAK,CAAC,EACnCuuF,EAAgBN,CAAW,EAAIjuF,EAAK,CAAC,GAGjCquF,EAAaJ,CAAW,EAAE,QAAQjuF,EAAK,CAAC,CAAC,IAAM,KACjDquF,EAAaJ,CAAW,GAAKjuF,EAAK,CAAC,EAE/BkuF,EAA2BD,CAAW,IACxCr5F,EAAYq5F,CAAW,GAAKjuF,EAAK,CAAC,IAO1C,IAAIyuF,EAAyB,GAC7B,MAAMC,EAA+B,SAAS,eAC5C,wBACJ,EACMA,IAAiC,OACnCD,EAAyBC,EAA6B,SAExD,IAAIzuF,EAAY,GAOZ0uF,EAAY;AAAA;AAAA;AAAA;AAAA,EAIZr+E,IAAW,KACbq+E,GAAa,qBAAsBF,EAAyB,WAAa,EAAE;AAAA,EAE3EE,GAAa,qBAAsBF,EAAyB,WAAa,EAAE;AAAA,EAG7EE,GAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAgJb,IAAIC,EAAgB;AAAA;AAAA;AAAA;AAAA,kBAIJT,CAAM;AAAA,WACbA,CAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASf,UAAWtsF,KAAKusF,EAAmB,CACjC,MAAMl5F,EAAIk5F,EAAkB,QAAQvsF,CAAC,EACrC+sF,GAAiBP,EAAan5F,CAAC,CACjC,CAIA,MAAM25F,EAAqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAmBrBC,EAA2B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAU3BC,EAAuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAO7B,IAAIC,EAAc,GACdhB,IAAe,mBACjBgB,GAAe;AAAA,GAEjBA,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAMAlB,CAAa;AAAA;AAAA;AAAA,EAGxBx9E,IAAW,OACb0+E,GAAe;AAAA,GAEjBA,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAYFjB,CAAO;AAAA;AAAA,eAEPl5C,CAAK;AAAA;AAAA;AAAA;AAAA,EAIdm5C,IAAe,iBACjBgB,GAAeD,EACNf,IAAe,cACxBgB,GAAeH,EAEfG,GAAeF,EAEjBE,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAWf,IAAIC,EAAe,GACfjB,IAAe,gBACjBiB,GAAgB,gCAElB,UAAWptF,KAAKusF,EAAmB,CACjC,MAAMl5F,EAAIk5F,EAAkB,QAAQvsF,CAAC,EACrCotF,GAAgB;AAAA;AAAA;AAAA;AAAA,kBAIFX,EAAcp5F,CAAC,CAAC;AAAA;AAAA;AAAA;AAAA,EAIzBq5F,EAAgBr5F,CAAC,IACpB+5F,GAAgB,kBAAkBptF,CAAC;AAAA;AAAA,GAGjCjN,EAAYM,CAAC,EAAI,EACnB+5F,GAAgB,oBAAoBr6F,EAAYM,CAAC,CAAC,KAAK2M,CAAC;AAAA;AAAA,EAExDotF,GAAgB,oBAAoBptF,CAAC;AAAA;AAAA,CAEzC,CACA,OAAIyO,IAAW,OACb2+E,GAAgB;AAAA,GAEdjB,IAAe,iBACjBiB,GAAgB;AAAA;AAAA;AAAA;AAAA,EAIhBA,GAAgB;AAAA,EAIlBhvF,EACE0uF,EAAY;AAAA,EAAOC,EAAgB;AAAA,EAAOI,EAAcC,EACtDjB,IAAe,mBACjB/tF,GACE;AAAA;AAAA;AAAA,GAEJA,GAAa;AAAA,EACNA,CACT,wGCtvCSm2E,EAAA/Y,MAAW,MAAK,iGA/Bdh7B,EAAAgC,EAAA,QAAA6qD,EAAA,gIAAA7xB,EAAO,8eASPA,EAAU,IAAIA,EAAU,IAAC;;4EAIxB,iBAAgB,gDAGfA,EAAI,GAAGA,EAAC,IAAC,UAAQ,EAEdh5B,EAAA,QAAA8qD,EAAA9xB,MAAW,mCACRA,EAAU,IAAIA,EAAU,IAAC,wHAMjCA,EAAa,KAAKA,EAAU,IAAC,MAAQ,gBAAkB,cAAY,KACnEA,EAAU,IAAIA,EAAU,IAAC,WACxB,kBACA,iCAAgC,YAC9BA,EAAI,GAAGA,EAAC,IAAC,UAAQ,2EAlC3BV,EAsCK7qB,EAAAt8B,EAAA4C,CAAA,EArCH8lD,EAyBC1oD,EAAA6uB,CAAA,wBAJcg5B,EAAa,UAK5Ba,EAUO1oD,EAAAuN,CAAA,yDAZOs6C,EAAe,mBApBxBM,EAAA,IAAAuxB,OAAA,gIAAA7xB,EAAO,8eASPA,EAAU,IAAIA,EAAU,IAAC;;4EAIxB,mCAKIM,EAAA,GAAAwxB,OAAA9xB,MAAW,uDACRA,EAAU,IAAIA,EAAU,IAAC,6DAFvBA,EAAa,IAczBM,EAAA,GAAAyY,OAAA/Y,MAAW,MAAK,KAAAsE,GAAA0U,EAAAD,CAAA,6GANd/Y,EAAa,KAAKA,EAAU,IAAC,MAAQ,gBAAkB,cAAY,KACnEA,EAAU,IAAIA,EAAU,IAAC,WACxB,kBACA,gHAlCHA,EAAY,yBAAjB,OAAInoE,GAAA,2GADemoE,EAAW,8CAAlCV,EA0CK7qB,EAAAt8B,EAAA4C,CAAA,4EAzCIilD,EAAY,sBAAjB,OAAInoE,GAAA,qHAAJ,gCADmBmoE,EAAW,+GApDrB,MAAA3Z,CAAa,EAAAoZ,GACb,cAAAsyB,CAA8B,EAAAtyB,GAC9B,aAAAuyB,EAAY,IAAAvyB,EAKZ,YAAAyS,EAAsB,EAAK,EAAAzS,EAC3B,aAAAplD,EAA+B,KAAK,EAAAolD,EACpC,SAAAwyB,EAAkB,qBAAqB,EAAAxyB,QAE5CjjB,EACJ6J,IAAU,OACNA,EACG,WAAW,IAAK,EAAE,EAClB,UAAU,KAAK,EACf,QAAQ,mBAAoB,EAAE,EACjC,KAAK,MAAK,IAAK,KAAI,EAAG,QAAO,GAAI,SAAQ,EACzCyqB,EAAWC,GAAqB,WAC7BmhB,GAAe,CACtBphB,EAAS,UAAU,4BAwDFihB,EAAa,mkBCgKrB7tB,EAAAlE,MAAS,GAAE,KAAE+Y,EAAA/Y,EAAQ,IAAC,IACb,MAAAA,MAAS,GAAG,GAClB,KAAImkB,EAAAnkB,MAAS,KAAc,OAAAA,MAAS,IAAI,GAAK,KAAImyB,EAAAnyB,EAAQ,IAAC,KACnD,OAAAA,MAAS,IAAI,GACpB,eAQGoyB,GAAApyB,MAAS,QAAUA,MAAS,QAAU,gBAAc,0bAL1BA,EAAC,6XAElBA,EAAQ,IAAC,YAAY,UAAQ,iJAV/CV,EAiDK7qB,EAAAt8B,EAAA4C,CAAA,qCA3CH8lD,EAMC1oD,EAAA6uB,CAAA,EADcqrD,GAAArrD,EAAAg5B,KAAiBA,EAAC,aAEjCa,EAAkE1oD,EAAAojC,CAAA,gBAClEslB,EAgBQ1oD,EAAAioD,CAAA,4DA7BPE,EAAA,MAAA4D,OAAAlE,MAAS,GAAE,KAAAsE,GAAAC,EAAAL,CAAA,EAAE5D,EAAA,MAAAyY,OAAA/Y,EAAQ,IAAC,IACb,MAAAA,MAAS,GAAG,GAClB,KAAEsE,GAAA0U,EAAAD,CAAA,EAAEzY,EAAA,MAAA6jB,OAAAnkB,MAAS,KAAc,OAAAA,MAAS,IAAI,GAAK,KAAEsE,GAAAigB,EAAAJ,CAAA,EAAE7jB,EAAA,MAAA6xB,OAAAnyB,EAAQ,IAAC,KACnD,OAAAA,MAAS,IAAI,GACpB,KAAEsE,GAAAguB,EAAAH,CAAA,iBAKUnyB,EAAQ,IAAC,YAAY,SAAQ,yBAC9BM,EAAA,OAAAt5B,EAAA,QAAAg5B,KAAiBA,EAAC,MAAlBqyB,GAAArrD,EAAAg5B,KAAiBA,EAAC,MAE1BM,EAAA,MAAA8xB,QAAApyB,MAAS,QAAUA,MAAS,QAAU,gBAAc,KAAAsE,GAAAiuB,EAAAH,CAAA,sGA2C3D9yB,EAA0B7qB,EAAA8G,EAAAxgC,CAAA,8CAMfilD,EAAS,6CAAdV,EAAmB7qB,EAAAyG,EAAAngC,CAAA,kCAAdilD,EAAS,SAAAsE,GAAAz5D,EAAAyyE,CAAA,gDADTtd,EAAqB,yBAA1B,OAAInoE,GAAA,+CAJ8B;AAAA;AAAA,eAGtC,yKAHFynE,EAQK7qB,EAAAt8B,EAAA4C,CAAA,SALH8lD,EAII1oD,EAAAkkC,CAAA,6EAHK2jB,EAAqB,sBAA1B,OAAInoE,GAAA,qHAAJ,qIAwDdynE,EAAqC7qB,EAAA8G,EAAAxgC,CAAA;uHACrCukD,EAMI7qB,EAAA4H,EAAAthC,CAAA,sHAIWilD,EAAc,mEAH7BV,EAKK7qB,EAAAt8B,EAAA4C,CAAA,4XA7MIilD,EAAkB,wDAgBjB,MAAO,mBAAoB,MAAO,gBAClC,MAAO,sBAAuB,MAAO,mBACrC,MAAO,6BAA8B,MAAO,+BAJ3BA,EAAM,+BAANA,EAAM,+GAkBvB,OAAO,qBAAsB,MAAO,IAAI,GACxC,MAAO,+BAAgC,MAAO,uBAH7BA,EAAM,+BAANA,EAAM,yEA4CtBA,EAAS,6BAAd,OAAInoE,IAAA,gIAsDiBmoE,EAAuB,8BAAvBA,EAAuB,yGAoCjCA,EAAO,6FAGT,wJAGO,iRAmBHA,EAAwB,8BAAxBA,EAAwB,+wBANuH,QAChK,OAACA,EAAO;AAAA,KACV,ulGAjMuDh7B,EAAAupD,EAAA,QAAAC,GAAA,qDAAAxuB,EAAS,IAAC,SAC/D,OACA,GAAE,YAHRV,EA2PM7qB,GAAA85C,EAAAxzE,EAAA,qBA/OJ8lD,EAuLS0tB,EAAApM,CAAA,EAtLPthB,EAkCKshB,EAAAhhB,CAAA,EA/BHN,EAeKM,EAAA5B,CAAA,EAdHsB,EAIKtB,EAAAqB,CAAA,4BAWPC,EAcKM,EAAAH,CAAA,EAbHH,EAIKG,EAAAC,CAAA,4BAWTJ,EAsHKshB,EAAAqQ,CAAA,EAnHH3xB,EAYK2xB,EAAArf,CAAA,EAXHtS,EAIKsS,EAAAF,CAAA,SACLpS,EAKCsS,EAAAsf,CAAA,OAJczyB,EAAO,WAMxBa,EAYK2xB,EAAA/N,CAAA,EAXH5jB,EAIK4jB,EAAAE,CAAA,SACL9jB,EAKC4jB,EAAAiO,CAAA,OAJc1yB,EAAK,WAMtBa,EA2EK2xB,EAAAhtB,CAAA,EA1EH3E,EAIK2E,EAAAC,CAAA,0EAqDL5E,EAgBK2E,EAAAE,CAAA,qBAEP7E,EAYK2xB,EAAAltB,EAAA,EAXHzE,EAIKyE,GAAAC,CAAA,UACL1E,EAKCyE,GAAAqtB,CAAA,OAJc3yB,EAAa,YAQhCa,EAsBKshB,EAAAyQ,CAAA,4CACL/xB,EAGKshB,EAAA3b,EAAA,0DAuBP3F,EAgCM0tB,EAAAnR,EAAA,EA1BJvc,EAKCuc,GAAAyV,EAAA,WACDhyB,EAKCuc,GAAA0V,EAAA,WACDjyB,EAMCuc,GAAA2V,EAAA,qBACDlyB,EAKCuc,GAAA4V,EAAA,WACDnyB,EAAwEuc,GAAA6V,EAAA,wJA/O/DjzB,GAAkB,gEAcAA,GAAM,+EAgBNA,GAAM,+CAmBdA,GAAO,SAAPA,GAAO,wBAaPA,GAAK,SAALA,GAAK,sBAYbA,GAAS,0BAAd,OAAInoE,IAAA,2IAAJ,8GAsDqBmoE,GAAuB,sDAuB/BA,GAAa,SAAbA,GAAa,0CAafA,GAAO,wCAoBrBA,GAAO,iGAKSA,GAAwB,gCArMY,CAAAvvD,IAAA6vD,GAAA,SAAAkuB,SAAA,qDAAAxuB,GAAS,IAAC,SAC/D,OACA,mlBApIAnnB,EAAS,GACT1T,EAAU,GACV+tD,EAAS,cACTjgF,EAAS,KACTy9E,EAAU,GACVl5C,EAAQ,SACN27C,EAAgB,GAChBC,EAAiB,OACnBC,EAQA97F,EAAW,GACXk5F,EAAgB,EAChB6C,EACAC,EAA0B,GAC1BC,EAA2B,kBAEhBC,GAAa,CAC1BL,EAAkB,OAAS,QACrBh4B,GAAoC,MAC1CviB,EAAS,MAAS0hB,GAA+B+e,CAAgB,GACtD,UAAAnjF,KAAY0iD,KAErB7jD,GAAQ,OAAS,GACjBA,GAAQ,MAAQ,GAChBiuC,GAAW9sC,EAAS,KAAI,CAAI,OAAQ,EAAI,GACpCA,EAAS,eAAiB,SAC5Bu8D,GAA6Bv8D,EAAU,EAAK,EAExCA,EAAS,wBAA0B,MACrCA,EAAS,uBAAsB,EAE/BA,EAAS,SAAW,QAEtBi9F,EAAkB,KAAKj9F,EAAS,IAAI,EAChCA,EAAS,IAAM,KACjBk9F,EAAsB,KAAKl9F,EAAS,EAAE,OAEhC,MAAAu9F,GAAuB,OAAO,OAAOv9F,CAAQ,EACnDu9F,GAAW,MAAK,EAChBL,EAAsB,KAAKK,GAAW,KAAK,GAAG,GAIpD5zB,EAAA,EAAAjnB,EAAYA,EAAU,OACnB1iD,GAAQ,CAAMi9F,EAAkB,SAASj9F,EAAS,IAAI,WAKzD2pE,EAAA,GAAAyzB,EAA0BF,EAAsB,SAAW,CAAC,EAG9DI,EAAa,MAoDTE,EAEJj0B,GAAO,UACLi0B,EAAe,SAAS,eAAe,eAAe,aAM/CC,GAAc,KACrBN,EAAgB,MACd,0BAA4B,KAAK,SAAS,mBAAmBnuD,CAAO,IAAAmuD,CAAA,EACtEK,EAAa,OAAM,EACnB7zB,EAAA,GAAA0zB,EAA2B,EAAK,gBA6BLN,EAAMxgG,uBAgBNugB,EAAMvgB,sBAmBdg+F,EAAO,+BAaPl5C,EAAK,gCAwBD27C,EAAiBt7F,CAAC,uCASpBioE,EAAA,EAAAie,GAAAlmF,CAAA,OAAOijE,GAAoB,EAAAjiB,CAAA,EACpC5V,GAAW9sC,EAAS,KAAI,CAAI,OAAQ,EAAI,GACpCA,EAAS,wBAA0B,MACrCA,EAAS,uBAAsB,EACjCktE,GAAA1d,GAAA2zB,EAAiBzhF,CAAC,EAAE,KAAO1B,EAAS,KAAAmjF,CAAA,EACpCne,GAAoC,iBA4BrBo4B,EAAuB7gG,uBAuB/B+9F,EAAazP,GAAA,kFA0B1BlhB,EAAA,GAAA0zB,EAA2B,oBAYdA,EAAwB9gG,oDAuC7B4gG,EAAevvB,0DAlT9B,CAGKmvB,IAAW,kBAAgBpzB,EAAA,EAAE2wB,EAAgB,CAAC,OAOlDl5F,EAAY,OAAS,EAACA,CAAA,UACbM,EAAI,EAAGA,EAAIs7F,EAAiB,OAAQt7F,IAC3CN,EAAY,KAAI,CAAG,cAAeM,EAAG,OAAQs7F,EAAiBt7F,CAAC,6DAI7D44F,GAAiB,MAAI3wB,EAAA,EAAE2wB,EAAgB,CAAC,UACnC54F,EAAI,EAAGA,EAAIghD,EAAU,OAAQhhD,IAAC,OAC/BmhD,GAAMH,EAAUhhD,CAAC,EACjBg8F,EAAMt8F,EAAY,KAAI,CAAEwD,GAAKlD,IAAMkD,GAAI,gBAAkBlD,CAAC,EAC5Dg8F,GAAO,MACL76C,GAAI,YAAc66C,EAAI,SACxB76C,GAAI,YAAc66C,EAAI,OAASpD,EAC/Bz7F,GAAQ,OAAS,GACjBA,GAAQ,MAAQ,GAChBiuC,GAAW+V,GAAI,KAAI,CAAI,OAAQ,EAAI,GAC/BA,GAAI,eAAiB,SACvB0Z,GAA6B1Z,GAAK,EAAK,EAEnCA,GAAI,wBAA0B,MAAMA,GAAI,uBAAsB,GAK1E8mB,EAAA,EAAA36B,EAAUqrD,GAAgB,CACxB,UAAA33C,EACA,WAAYq6C,EACZ,OAAAjgF,EACA,QAAAy9E,EACA,MAAAl5C,EACA,YAAajgD,EAAY,IAAKwD,GAAQA,EAAI,MAAM,EAChD,cAAA01F,WA5FD4C,EAAqB,mgBCoLlB/zB,EAMQ7qB,EAAA2rB,EAAArlD,CAAA,qBAJKilD,EAAQ,yFAY+IA,EAAI,oLADxKV,EAC8K7qB,EAAA+xB,EAAAzrD,CAAA,2BAAVilD,EAAI,2JAlEnKA,EAAkB,aAmDnBA,EAAU,IAAAE,GAAAF,CAAA,IAaXA,EAAI,IAAAG,GAAAH,CAAA;;;;;;;igCAxE4Ch7B,EAAAupD,EAAA,QAAAC,EAAA,qDAAAxuB,EAAS,GAAC,SAC/D,OACA,GAAE,UAHRV,EAkFM7qB,EAAA85C,EAAAxzE,CAAA,qBAtEJ8lD,EAkES0tB,EAAApM,CAAA,EA/DPthB,EAIIshB,EAAA2R,CAAA,SAEJjzB,EA6BGshB,EAAA/9D,CAAA,SACHy8C,EAIIshB,EAAA4R,CAAA,SAEJlzB,EAYKshB,EAAAvhB,CAAA,wBACLC,EAOKshB,EAAA5iB,CAAA,wBAEPsB,EAEQ0tB,EAAAG,CAAA,uDAxEG1uB,EAAkB,cAmDnBA,EAAU,6DAaXA,EAAI,8DAxE4C,CAAAvvD,GAAA6vD,EAAA,GAAAkuB,OAAA,qDAAAxuB,EAAS,GAAC,SAC/D,OACA,2RAvIEg0B,EAAK,OACPn7C,EAEAo7C,EAAa,kBAEFR,GAAa,CAC1Br4B,GAAoC,EACpCviB,EAAS,MAAS0hB,GAA+B+e,CAAgB,EAC7D,IAAAzhF,EAAI,EACG,UAAAiuD,KAASwzB,EAAgB,CAC9B,IAAA4a,EAAW,GACJ,UAAAzhG,KAAO,OAAO,KAAKqzD,CAAK,EAC7BrzD,IAAQ,MACVyhG,GAAQ,KAASpuC,EAAMrzD,CAAG,KACjBA,IAAQ,OACjByhG,GAAQ,MAAUpuC,EAAMrzD,CAAG,KAClBA,IAAQ,OACjByhG,GAAQ,MAAUpuC,EAAMrzD,CAAG,KAClBA,IAAQ,cACjByhG,GAAQ,KAASpuC,EAAMrzD,CAAG,KACjBA,IAAQ,QAAUA,IAAQ,OACnCyhG,GAAQ,GAAOzhG,CAAG,IAAIqzD,EAAMrzD,CAAG,MAGnCyhG,EAAWA,EAAS,MAAM,IAAK,EAE/BF,EAAM,KAAI,CACR,SAAU,WACV,UAAW,WACX,OAAM,CACJ,MAAOn7C,EAAUhhD,CAAC,EAAE,MACpB,IAAK,8BAAgCq8F,KAGzCr8F,IAEFioE,EAAA,EAAAm0B,EAAa,EAAK,EAGpBR,EAAa,EAET,IAAAU,EAAO,SAELC,EAAY,IAAO,IAAI,uBAAuB,WAG3CC,EAAYr1B,EAAgB7nE,EAAM,IACzC,eAAQ,KAAK,eAAgB6nE,EAAQ,KAAK,EACnC,MAAMo1B,EAAY,CACvB,OAAQ,OACR,KAAM,KAAK,UAAS,CAClB,OAAAp1B,EACA,QAAS,EACT,OAAA7nE,CAAM,KAGP,KAAMoN,GAAMA,EAAE,MAAI,EAClB,KAAMA,GAAC,CACF,GAAAA,EAAE,gBACM,MAAMA,EAAE,KAAK,EAEzB,eAAQ,KAAK,eAAgBy6D,EAAQ,cAAc,EAC5Cz6D,EAAE,MAEV,SAAOrQ,GAAC,CACP,cAAQ,MAAM,eAAgB8qE,EAAQ,cAAc,EAC9C9qE,aAIHogG,GAAQ,CACfx0B,EAAA,EAAAq0B,EAAO,EAAE,EAETE,EAAY,mBAAmB,EAC5B,KAAM9vF,GAAC,IACFA,EAAE,aAAe,UACZ,OAAA8vF,EAAY,YAAY,EAErB,gBAAM,wBAAwB,CAG3C,QAAM9vF,GAAC,IACNu7D,EAAA,EAAAq0B,GAAQ;AAAA,CAA4B,GAC/B5vF,EAAE,SAAS,UAAU,EACxB,OAAAu7D,EAAA,EAAAq0B,GAAQ;AAAA,CAA8B,EAC/BE,EAAY,cAAa,CAC9B,UAAW,WACX,cAAa,CAAG,QAAS,KAAK,EAC9B,IAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAEL,cAAa,EAET,KAAM,SACN,MACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EACF,KAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAMf,KAAI,IAEIA,EAAY,aAAY,CAC7B,KAAM,UAAU,IAGnB,KAAI,IACIA,EAAY,cAAa,CAC9B,MAAAL,EAAK,CAGR,OAAM9tC,GACEmuC,EAAY,WAAU,CAC3B,MAAOL,EAAM,OAAM,CAAEO,EAAM18F,IAAMquD,EAAIruD,CAAC,IAGzC,OAAM0M,GAAC,OACAiwF,EAASjwF,EAAE,OACXkwF,EAAoBT,EAAM,OAASzvF,EAAE,WAC3C4vF,GAAI,GAAOK,CAAM,IAAIA,EAAS,EAAI,qBAAuB,kBAAkB,IAAIC,EAA6B,SAAAA,CAAiB,gBAAgBA,EAAoB,EAAI,IAAM,EAAE,KAAO,EAAE;AAAA,EAEvL,SAAOvgG,GAAC,CACP4rE,EAAA,EAAAq0B,GAAQ;AAAA,GAA+CjgG,EAAI;AAAA,CAAI,EAC/D4rE,EAAA,EAAAq0B,GAAQ;AAAA,CAA2B,EACnCr0B,EAAA,EAAAq0B,GAAQ;AAAA,CAAiD,EACzDr0B,EAAA,EAAAq0B,GAAQ;AAAA,CAAuD,EAC/Dr0B,EAAA,EAAAq0B,GAAQ;AAAA,CAAsC,wGC9F/C,IAAA7W,EAAAtd,KAAa,CAAC,kDAAdM,EAAA,GAAAgd,OAAAtd,KAAa,CAAC,OAAAsE,GAAAz5D,EAAAyyE,CAAA,iCAFd,IAAAA,EAAAtd,KAAa,CAAC,kDAAdM,EAAA,GAAAgd,OAAAtd,KAAa,CAAC,OAAAsE,GAAAz5D,EAAAyyE,CAAA,0FADZtd,EAAK,GAAAG,6FAVPH,EAAK,ovDAbKA,EAAE,eACFA,EAAU,aAEXA,EAAK,GAIdh7B,EAAAtf,EAAA,QAAAgvE,EAAA,gHAAA10B,EAAK,GAAG,gBAAkB,cAAY,KACtCA,EAAA,GACG,uCACA,uCAAsC,uBAC9BA,EAAE,wDAOfh7B,EAAAu6B,EAAA,QAAAkS,EAAA,0FAAAzR,EAAA,GACG,uCACA,wCAAsC,KACzCA,EAAM,GAAG,sBAAwB,MAAK,qDA9BdA,EAAO,GAAC,MAAK,KAAGA,EAAA,GACvC,wBACA,uBAAsB,UAJ5BV,EAwCK7qB,EAAAwsB,EAAAlmD,CAAA,EAlCH8lD,EAoBKI,EAAAL,CAAA,EAnBHC,EAQCD,EAAA55B,CAAA,SACD65B,EASOD,EAAAl7C,CAAA,gBAETm7C,EAYKI,EAAA1B,CAAA,kCA1BWS,EAAM,0CAFPA,EAAE,kCACFA,EAAU,oBAEXA,EAAK,cAUdA,EAAK,IANLM,EAAA,GAAAo0B,OAAA,gHAAA10B,EAAK,GAAG,gBAAkB,cAAY,KACtCA,EAAA,GACG,uCACA,+EACQA,EAAE,kFAOfM,EAAA,IAAAmR,OAAA,0FAAAzR,EAAA,GACG,uCACA,wCAAsC,KACzCA,EAAM,GAAG,sBAAwB,iFA9BTA,EAAO,GAAC,MAAK,KAAGA,EAAA,GACvC,wBACA,yGAlBO,MAAA3Z,CAAa,EAAAoZ,GACb,aAAAk1B,EAAY,CAAI,oBAAqB,oBAAoB,GAAAl1B,EACzD,OAAA/sE,EAAiB,EAAI,EAAA+sE,EACrB,YAAAyS,EAAsB,EAAK,EAAAzS,EAC3B,QAAAm1B,EAAkB,EAAK,EAAAn1B,EACvB,IAAAt9D,GAAM,UAAWkzD,GAA+B,GAAI,KAAK,EAAE,GAAAoK,EAChE,MAAAqR,EAAWC,GAAqB,WAE7BuB,GAAM,CACbxS,EAAA,EAAAptE,GAASA,CAAK,EACdo+E,EAAS,QAAQ,ieCoHnBxR,EAA6B7qB,EAAAirC,EAAA3kE,CAAA,kHAIbilD,EAAO,kNAHvBV,EAMK7qB,EAAAwsB,EAAAlmD,CAAA,EALH8lD,EAIKI,EAAA1B,CAAA,EAHHsB,EAEKtB,EAAAqB,CAAA,EADHC,EAAiDD,EAAAwhB,CAAA,+JAStCpiB,EAA0B,2GAK1BA,EAAmB,gJAVpCV,EAaK7qB,EAAA8qB,EAAAxkD,CAAA,EAZH8lD,EAWKtB,EAAAqB,CAAA,qrBAKiBZ,EAAe,iCAAfA,EAAe,udAAfA,EAAe,uOA7I5B,cAAA60B,EAAoB,EAAE,EAAAp1B,EACtB,MAAAe,EAAe,gBAAgB,EAAAf,EAC/B,YAAA+jB,EAAqB,EAAE,EAAA/jB,EACvB,iBAAAgkB,EAA0B,EAAE,EAAAhkB,EAC5B,SAAAikB,EAAkB,EAAE,EAAAjkB,EACpB,eAAAwuB,EAAyB,EAAK,EAAAxuB,EAC9B,YAAAyuB,EAAsB,EAAK,EAAAzuB,EAEhC,MAAAq1B,EAAkBh6B,GAAoB,EAEtCi6B,EAAa,CACjB,qBAAsB,IACtB,KAAM,YACN,QAAS,GACT,OAAQ,EACR,MAAO,EACP,MAAO,IACP,OACE,KAAM,OACN,MAAO,MAAM,GAIb,IAAAvN,EAAc,GACdwN,EAAgD,sBAErCC,GAAiB,CACxB,MAAAziG,EAAMy7F,EACRloC,GAAgB,CAAG,WAAAmoC,CAAU,GAAI,SAAQ,EACzC2G,EACJK,GAAO,UAAU1iG,EAAKuiG,EAAa,CAAGjiG,EAAcN,IAAW,CACvD,MAAA2iG,EAAe,SAAS,eAAeL,CAAO,MAC/CK,GAAY,EAAMA,aAAwB,kBAAgB,CAC7D1qC,GAAO,kCAAiC,CAAI,QAAAqqC,EAAO,YAGjDhiG,EAAK,CACP23D,GAAO,2BAA0B,CAAI,MAAA33D,EAAK,SAG5CqiG,EAAa,aAAa,MAAO3iG,CAAG,mBAIzB4iG,GAA0B,CACvCH,EAAiB,EACX,MAAAE,EAAe,SAAS,eAAeL,CAAO,MAC/CK,GAAY,EAAMA,aAAwB,kBAAgB,CAC7D1qC,4BAAgCqqC,CAAO,kBACvCh1B,EAAA,EAAAk1B,EAAkB,OAAO,aAItBK,GAAwB,GAC3B,QAAQ,MAAM,+CAA+C,EAC7Dv1B,EAAA,EAAAk1B,EAAkB,OAAO,mBAKnBM,EAAI,MAASC,GAAwBJ,CAAY,EACjD,MAAAK,GAAoBF,CAAI,EAC9Bx1B,EAAA,EAAAk1B,EAAkB,SAAS,QACpBliG,EAAK,CACZ23D,GAAO,sCAAqC,CAAI,MAAA33D,EAAK,EACrDgtE,EAAA,EAAAk1B,EAAkB,OAAO,kBAIdS,GAAmB,CAChCR,EAAiB,EACX,MAAAS,EAAS,IAAO,KAAI,EAAG,YAAW,EAAG,MAAM,EAAG,EAAE,EAAE,QAAQ,KAAM,EAAE,EAElEP,EAAe,SAAS,eAAeL,CAAO,MAC/CK,GAAY,EAAMA,aAAwB,kBAAgB,CAC7D1qC,GAAO,kCAAiC,CAAI,QAAAqqC,EAAS,aAAAK,CAAY,UAI7D,MAAAQ,EAAWR,EAAa,aAAa,KAAK,MAC3CQ,EAAQ,CACXlrC,qBAAyBqqC,CAAO,gDAM1BQ,EAAI,MADI,MAAS,MAAMK,CAAQ,GACT,KAAI,EAC1BnjG,EAAM,OAAO,IAAI,gBAAgB8iG,CAAI,EAGrCM,EAAe,SAAS,cAAc,GAAG,EAC/CA,EAAa,MAAM,QAAU,OAC7BA,EAAa,KAAOpjG,EACpBojG,EAAa,SAAQ,oBAAuBF,CAAS,OACrD,SAAS,KAAK,YAAYE,CAAY,EACtCA,EAAa,MAAK,EAClB,OAAO,IAAI,gBAAgBpjG,CAAG,QACvBM,EAAK,CACZ23D,GAAO,uCAAsC,CAAI,MAAA33D,EAAK,gBAWxDmiG,EAAiB,EACjBn1B,EAAA,EAAA0nB,EAAW,CAAIA,CAAA,0CA8BOwN,EAAetiG,ysBCgNdstE,EAAW,GAAC,oBAAsB,QACzCA,EAAW,GAAC,kBAAoB,EAC5B,IACA,4UA7PXA,EAAkB,4EAmHX,MAAO,kCACP,MAAO,eAGP,MAAO,wBACP,MAAO,kBACP,WAAYA,EAAgB,GAAC,SAAW,IAGxC,MAAO,wBACP,MAAO,2BAdUA,EAAQ,+BAARA,EAAQ,+HAqBnB,2BACKA,EAAc,GAAC,WAAa,mBACvCA,EAAc,GAAC,WAAa,2BAEzB,gDAEH,oDACA,0DAJWA,KAAe,aAAU,SAAzB61B,GAAA,MAAA71B,KAAe,kIAsB1B,OAAO,mBAAoB,MAAO,GAAG,EACrC,OAAO,kBAAmB,MAAO,GAAG,EACpC,OAAO,sBAAuB,MAAO,GAAG,IANvBA,EAAc,+BAAdA,EAAc,kIAWzB,8BAEH,sDAEH,0DACA,qEAJWA,KAAe,oBAAiB,SAAhC81B,GAAA,MAAA91B,KAAe,gHAUpB,+BACKA,EAAc,GAAC,iBAAmB,OAE1C,4CAEH,4EACA,mFAJWA,KAAe,UAAO,SAAtB+1B,GAAA,MAAA/1B,KAAe,8EAMhBA,EAAU,6CAYd,2BAEH,sDAEH,yEACA,2DAJWA,KAAe,uBAAoB,SAAnCg2B,GAAA,MAAAh2B,KAAe,mHAwFpB,yBACH,oCAES,YAAAA,KAAY,wBAExB,0EACA,iDAJWA,KAAY,kBAAe,SAA3Bi2B,GAAA,MAAAj2B,KAAY,qIAUX,YAAAA,EAAW,GAAC,WAAS,CAChCA,KAAY,+BAGX,MAAO,kCACP,MAAO,aAGP,MAAO,gCACP,MAAO,WAVUA,KAAY,gBAAa,SAAzBk2B,GAAA,cAAAl2B,KAAY,oHA+B7B,yBAEH,uDAEH,6EACA,iDAJWA,EAAY,uBAAZA,EAAY,iGAiBjB,yBAEH,sCAEH,yCACA,0BAA0B,GAJfA,KAAe,mBAAgB,SAA/Bm2B,GAAA,MAAAn2B,KAAe,uFAMhBA,EAAU,wFASfA,EAAc,wEA4BjB,OAAO,WAAY,MAAO,OAAO,EACjC,OAAO,SAAU,MAAO,OAAO,GAC/B,MAAO,YAAa,MAAO,QAAS,WAAY,+BAJ/BA,EAAiB,+BAAjBA,EAAiB,4GAsBvBja,GAAgB,CAC3B,KAAMia,EAAW,GAAC,UAAY,MAAQ,QACtC,YACEA,EAAoB,GAACA,MAAmB,YAC1C,WAAYA,EAAY,KACvB,SAAQ,EACD,gBACRA,EAAoB,GAACA,MAAmB,qBACnC,8BACMA,EAAoB,GAACA,EAAiB,IAAE,2KAe3C,yBACRA,EAAoB,GAACA,EAAiB,IAAE,gBACxC,cACUja,GAAgB,CAC1B,KAAMia,EAAW,GAAC,UAAY,MAAQ,QACtC,YACEA,EAAoB,GAACA,MAAmB,YAC1C,WAAYA,EAAY,KACvB,SAAQ,aACEA,EAAoB,GAACA,EAAiB,IAAE,mEAaxBja,GAAgB,CAC3C,KAAMia,EAAW,GAAC,UAAY,MAAQ,QACtC,YACEA,EAAoB,GAACA,MAAmB,YAC1C,WAAYA,EAAY,KACvB,SAAQ,0EACD,sBACRA,EAAoB,GAACA,EAAiB,IAAE,gBACxC,SACK,kCACMA,EAAoB,GAACA,EAAiB,IAAE,2MAerCja,GAAgB,CAC9B,KAAMia,EAAW,GAAC,UAAY,MAAQ,QACtC,YACEA,EAAoB,GAACA,MAAmB,YAC1C,WAAYA,EAAY,KACvB,SAAQ,EACA,SAAAA,EAAc,GAAC,MACtBA,EAAc,GAAC,MACf,oIAGM,wCACRA,EAAoB,GAACA,EAAiB,IAAE,gBACxC,SACK,sCACMA,EAAoB,GAACA,EAAiB,IAAE,iTAvc3D,wBAEA,+BAmBA,oBAEA,sRA2CM,gCAEA;8IAgIE,SAEA,+CAYA,QACQ,gBAGC,GACT,sCAOA,cAEA,iuCA3OLh7B,EAAA+iD,EAAA,QAAAqO,EAAA,ufAAAp2B,EAAW,GAAC,UACT,uBACA,sBAAqB,oSAkBxBh7B,EAAAld,EAAA,QAAAuuE,EAAA,ufAAAr2B,EAAW,GAAC,UACT,sBACA,uBAAsB,quCAmDyCA,EAAc,GAAC,OAC5EA,KAAe,MAAM,SAAW,EAC5B,GACA,YAAW,+9BAgIyEh7B,EAAAsxD,GAAA,QAAAC,GAAA,kFAAAv2B,EAAW,GAAC,UAC9F,yCACA,uCAAsC,yfAS9B0yB,GAAA,SAAA8D,GAAA,CAAAx2B,KAAY,UAG8Dh7B,EAAAyxD,GAAA,QAAAC,GAAA,kFAAA12B,EAAW,GAAC,UAC9F,yCACA,uCAAsC,qEAU4Ch7B,EAAA2xD,GAAA,QAAAC,GAAA,kFAAA52B,EAAW,GAAC,UAC9F,yCACA,uCAAsC,ufAS9B2yB,GAAA,SAAAkE,GAAA,CAAA72B,KAAY,2wFArRjCh7B,EAAAupD,EAAA,QAAAC,IAAAxuB,EAAS,GAAC,SACf,OACA,IAAE,0HAHRV,EAggBM7qB,GAAA85C,EAAAxzE,EAAA,qBArfJ8lD,EAmfK0tB,EAAAuI,CAAA,EAhfHj2B,EA+eKi2B,EAAAC,CAAA,EA5eHl2B,EAQKk2B,EAAAn2B,CAAA,SAELC,EA8CIk2B,EAAA16C,CAAA,EAzCFwkB,EAmBIxkB,EAAA26C,CAAA,EAlBFn2B,EAiBGm2B,EAAAjP,CAAA,gBAELlnB,EAoBIxkB,EAAA46C,CAAA,EAnBFp2B,EAkBGo2B,EAAAnvE,CAAA,gBAIP+4C,EAuPKk2B,EAAAG,CAAA,EAtPHr2B,EA2IKq2B,EAAAC,CAAA,EApIHt2B,EAIKs2B,EAAA53B,CAAA,SACLsB,EA8HKs2B,EAAAvE,CAAA,EA7HH/xB,EA+DK+xB,EAAAjO,CAAA,EA9DH9jB,EAIK8jB,EAAA1jB,CAAA,SACLJ,EAsBK8jB,EAAA1R,CAAA,EAnBHpS,EAIKoS,EAAAjS,CAAA,SACLH,EAKCoS,EAAAwf,CAAA,EADcJ,GAAAI,EAAAzyB,KAAe,KAAK,SAEnCa,EAOKoS,EAAA9R,EAAA,qCAuBPN,EAYK8jB,EAAAxR,CAAA,qBAGPtS,EAyCK+xB,EAAAptB,EAAA,EAxCH3E,EAIK2E,GAAAif,EAAA,kCAYL5jB,EAUK2E,GAAAC,EAAA,yBACL5E,EAYK2E,GAAAE,EAAA,wBAEP7E,EAiBK+xB,EAAAJ,EAAA,EAhBH3xB,EAIK2xB,GAAAjtB,EAAA,WACL1E,EAUK2xB,GAAAltB,EAAA,wBAIXzE,EAyGKq2B,EAAAE,EAAA,EAlGHv2B,EAKKu2B,GAAAC,EAAA,WACLx2B,EA2FKu2B,GAAAE,EAAA,EA1FHz2B,EAoDKy2B,GAAAC,EAAA,EAnDH12B,EAIK02B,GAAAC,EAAA,WACL32B,EA6CK02B,GAAAE,EAAA,EA1CH52B,EAyBK42B,GAAAC,EAAA,EAxBH72B,EAMK62B,GAAApB,EAAA,oBACLz1B,EAMC62B,GAAAhF,EAAA,EAFcL,GAAAK,GAAA1yB,KAAY,iBAAiB,WAG5Ca,EASK62B,GAAAjB,EAAA,sCAEP51B,EAeK42B,GAAAE,EAAA,EAdH92B,EAMK82B,GAAAhB,EAAA,oBACL91B,EAMC82B,GAAAhF,EAAA,EAFcN,GAAAM,GAAA3yB,KAAY,QAAQ,WAMzCa,EAoCKy2B,GAAAM,EAAA,EAnCH/2B,EAIK+2B,GAAAC,EAAA,WACLh3B,EA6BK+2B,GAAAE,EAAA,+CAMbj3B,EAwCKk2B,EAAAgB,EAAA,EArCHl3B,EAiBKk3B,GAAAC,EAAA,EAhBHn3B,EAIKm3B,GAAAC,EAAA,WACLp3B,EAUKm3B,GAAAE,EAAA,yBAEPr3B,EAkBKk3B,GAAAI,EAAA,EAjBHt3B,EAIKs3B,GAAAC,EAAA,WACLv3B,EAWKs3B,GAAAE,EAAA,wBAGTx3B,EAQKk2B,EAAAuB,EAAA,wBACLz3B,EAQKk2B,EAAAwB,EAAA,UACL13B,EA6HKk2B,EAAAyB,EAAA,EA5HH33B,EAoBK23B,GAAAC,EAAA,EAjBH53B,EAIK43B,GAAAC,EAAA,WACL73B,EAWK43B,GAAAE,EAAA,yBAEP93B,EAsGK23B,GAAAI,EAAA,EAnGH/3B,EAuBK+3B,GAAAC,EAAA,EAtBHh4B,EAIKg4B,GAAAC,EAAA,WACLj4B,EAgBKg4B,GAAAE,EAAA,yBAEPl4B,EAqBK+3B,GAAAI,EAAA,EApBHn4B,EAKKm4B,GAAAC,EAAA,WACLp4B,EAaKm4B,GAAAE,EAAA,yBAEPr4B,EAwBK+3B,GAAAO,EAAA,EAvBHt4B,EAIKs4B,GAAAC,EAAA,WACLv4B,EAiBKs4B,GAAAE,EAAA,yBAEPx4B,EA2BK+3B,GAAAU,EAAA,EA1BHz4B,EAIKy4B,GAAAC,EAAA,WACL14B,EAoBKy4B,GAAAE,EAAA,6MAhfJx5B,GAAkB,gBA4BlB,CAAAvvD,IAAA6vD,GAAA,IAAA81B,OAAA,ufAAAp2B,GAAW,GAAC,UACT,uBACA,0CAkBH,CAAAvvD,IAAA6vD,GAAA,IAAA+1B,OAAA,ufAAAr2B,GAAW,GAAC,UACT,sBACA,0CAgDeM,GAAA,GAAAmyB,EAAA,QAAAzyB,MAAe,OAAfqyB,GAAAI,EAAAzyB,MAAe,KAAK,8EAG4BA,GAAc,GAAC,OAC5EA,MAAe,MAAM,SAAW,EAC5B,GACA,sEAWF,MAAO,kCACP,MAAO,eAGP,MAAO,wBACP,MAAO,kBACP,WAAYA,GAAgB,GAAC,SAAW,IAGxC,MAAO,wBACP,MAAO,8DAdUA,GAAQ,8DAsBdA,GAAc,GAAC,WAAa,mBACvCA,GAAc,GAAC,WAAa,2CACjBy5B,GAAA,MAAAz5B,MAAe,oFAkBTA,GAAc,4DAYpB05B,GAAA,MAAA15B,MAAe,8EAWfA,GAAc,GAAC,iBAAmB,uBAClC25B,GAAA,MAAA35B,MAAe,iEAmBf45B,GAAA,MAAA55B,MAAe,iDAoC4D,CAAAvvD,IAAA6vD,GAAA,IAAAi2B,SAAA,kFAAAv2B,GAAW,GAAC,UAC9F,yCACA,6DASQ,CAAAvvD,IAAA6vD,GAAA,IAAAk2B,SAAA,CAAAx2B,MAAY,8BADXM,GAAA,IAAA0gB,GAAA0R,GAAA,SAAA1yB,MAAY,mBAAZqyB,GAAAK,GAAA1yB,MAAY,iBAAiB,yBAQnCA,GAAW,GAAC,oBAAsB,QACzCA,GAAW,GAAC,kBAAoB,EAC5B,IACA,KAAEsE,GAAAu1B,GAAAC,EAAA,GAPgF,CAAArpF,IAAA6vD,GAAA,IAAAo2B,SAAA,kFAAA12B,GAAW,GAAC,UAC9F,yCACA,6DAUkF,CAAAvvD,IAAA6vD,GAAA,IAAAs2B,SAAA,kFAAA52B,GAAW,GAAC,UAC9F,yCACA,6DASQ,CAAAvvD,IAAA6vD,GAAA,IAAAu2B,SAAA,CAAA72B,MAAY,8BADXM,GAAA,IAAAqyB,GAAA,QAAA3yB,MAAY,UAAZqyB,GAAAM,GAAA3yB,MAAY,QAAQ,cAmBrBM,GAAA,KAAAy5B,GAAA,YAAA/5B,MAAY,8BADb+5B,GAAA,MAAA/5B,MAAY,uDAUXM,GAAA,KAAA05B,GAAA,YAAAh6B,GAAW,GAAC,WAAS,CAChCA,MAAY,oCAFMg6B,GAAA,cAAAh6B,MAAY,iFAgCxBA,GAAY,4DAkBZi6B,GAAA,MAAAj6B,MAAe,2FAyCPA,GAAiB,gEAsBvBja,GAAgB,CAC3B,KAAMia,GAAW,GAAC,UAAY,MAAQ,QACtC,YACEA,GAAoB,GAACA,OAAmB,YAC1C,WAAYA,GAAY,KACvB,SAAQ,GACDM,GAAA,IAAA45B,GAAA,gBACRl6B,GAAoB,GAACA,OAAmB,sCAE7BA,GAAoB,GAACA,GAAiB,IAAE,8BAe3CM,GAAA,IAAA65B,GAAA,yBACRn6B,GAAoB,GAACA,GAAiB,IAAE,gBACxC,0BACUja,GAAgB,CAC1B,KAAMia,GAAW,GAAC,UAAY,MAAQ,QACtC,YACEA,GAAoB,GAACA,OAAmB,YAC1C,WAAYA,GAAY,KACvB,SAAQ,wBACEA,GAAoB,GAACA,GAAiB,IAAE,oEAaxBja,GAAgB,CAC3C,KAAMia,GAAW,GAAC,UAAY,MAAQ,QACtC,YACEA,GAAoB,GAACA,OAAmB,YAC1C,WAAYA,GAAY,KACvB,SAAQ,2EACDM,GAAA,IAAA85B,GAAA,sBACRp6B,GAAoB,GAACA,GAAiB,IAAE,gBACxC,0BAEWA,GAAoB,GAACA,GAAiB,IAAE,uDAerCja,GAAgB,CAC9B,KAAMia,GAAW,GAAC,UAAY,MAAQ,QACtC,YACEA,GAAoB,GAACA,OAAmB,YAC1C,WAAYA,GAAY,KACvB,SAAQ,GACAM,GAAA,IAAA+5B,GAAA,SAAAr6B,GAAc,GAAC,MACtBA,GAAc,GAAC,MACf,YAGMM,GAAA,IAAA+5B,GAAA,wCACRr6B,GAAoB,GAACA,GAAiB,IAAE,gBACxC,0BAEWA,GAAoB,GAACA,GAAiB,IAAE,mBAtf1D,CAAAvvD,IAAA6vD,GAAA,KAAAkuB,UAAAxuB,GAAS,GAAC,SACf,OACA,IAAE,krCAnFNN,GAAO,KACLsG,QAASs0B,GAAG,EAEZC,EAAU,QACJC,EAAep3B,EAAY,UAC7B,oBACA,wBACEq3B,GAAer3B,EAAY,UAC7B,gBACA,oBACEs3B,EAAa,SAAS,eAAeF,CAAY,EACjDG,GAAa,SAAS,eAAeF,EAAY,EACvDC,GAAA,MAAAA,EAAY,aAAa,qBAAsB,IAC/CC,IAAA,MAAAA,GAAY,aAAa,qBAAsB,YAG3CC,EAAoB,CACxB,MAAK,CACH,gBAAiB,WACjB,KAAM,iBACN,QAAS,GACT,YAAa,IAEf,MAAK,CACH,gBAAiB,YACjB,KAAM,qBACN,QAAS,GACT,YAAa,IAEf,MAAK,CACH,gBAAiB,SACjB,KAAM,UACN,QAAS,GACT,YAAa,KAKb,IAAAC,EAAgC,QAChC1+B,EAAyB6Y,EAAe,gBAAkB,IAC1D9Y,EAKU8Y,EAAe,UAAY,sBAKhC8lB,GAAc,OACf,MAAAC,EAAW33B,EAAY,UAAY,MAAQ,QAC3C5wE,GAAMuzD,GAAgB,CAC1B,KAAMg1C,EACN,YAAaH,EAAqBC,CAAiB,EAAE,YACrD,WAAYG,KAEdlmG,EAAA,OAAO,KAAKtC,GAAK,QAAQ,IAAzB,MAAAsC,EAA4B,QAI1B,IAAAkmG,EAAwB,YACnBT,GAAU,CACN,UAAAz0C,KAASwzB,EACb,CAAA0hB,GAAgBl1C,EAAM,OAAS,OAClCA,EAAM,KAAOgV,GAAoB,EACxBkgC,IACTl1C,EAAM,KAAO,QAGjBqV,GAAqCme,CAAgB,WAG9C2hB,GAAS,CACZ73B,EAAY,iBACd4R,EAAe,eAAiB,IAAGA,CAAA,qBAmD3B5R,EAAY,UAAY,GAAAA,CAAA,gBAoBxBA,EAAY,UAAY,GAAAA,CAAA,EACxB63B,EAAS,gBAwCQjmB,EAAe,MAAK,mCAad9Y,EAAQxpE,2BACRsiF,EAAe,SAAW9Y,EAAQ8Y,CAAA,gBAuBxCkmB,EAAA,aAAAlmB,EAAe,WAAUtiF,CAAA,IAAzBsiF,EAAe,WAAUtiF,2BAkBnBypE,EAAczpE,2BAEhCsiF,EAAe,eAAiB7Y,EAAc6Y,CAAA,gBAUlCkmB,EAAA,aAAAlmB,EAAe,kBAAiBtiF,CAAA,IAAhCsiF,EAAe,kBAAiBtiF,2BAYhCwoG,EAAA,aAAAlmB,EAAe,QAAOtiF,CAAA,IAAtBsiF,EAAe,QAAOtiF,2BAmBtBwoG,EAAA,aAAAlmB,EAAe,qBAAoBtiF,CAAA,IAAnCsiF,EAAe,qBAAoBtiF,0BA8CjC0wE,EAAY,kBAAiB4d,GAAA,mCA0B7B5d,EAAY,SAAQ,mCAkBtB83B,EAAA,aAAA93B,EAAY,gBAAe1wE,CAAA,IAA3B0wE,EAAY,gBAAe1wE,2BASnBwoG,EAAA,aAAA93B,EAAY,cAAa1wE,CAAA,IAAzB0wE,EAAY,cAAa1wE,2BAgCrCsoG,EAAYtoG,wBAkBZwoG,EAAA,aAAAlmB,EAAe,iBAAgBtiF,CAAA,IAA/BsiF,EAAe,iBAAgBtiF,2BAyCvBmoG,EAAiBnoG,+CAvbjD2wE,GAAA7d,GAAE4d,EAAY,cAAgB4R,EAAe,iBAAmB,IAAG5R,CAAA,0OC0CvD,MAAMpD,EAAQ,IAAE,KAAI,yBAA7B,OAAInoE,GAAA,+LA8BI,wvBAHVynE,EAOC7qB,EAAAzN,EAAAjsB,CAAA,wBAHcilD,EAAU,YAIzBV,EAKO7qB,EAAA/uB,EAAA3K,CAAA,oFAxCI,MAAMilD,EAAQ,IAAE,KAAI,sBAA7B,OAAInoE,GAAA,6HAAJ,mCA+BamoE,EAAU,kGAPpB+Y,EAAA/Y,MAAI,EAAC,sIArBEh7B,EAAAgC,EAAA,KAAAm0D,EAAA,OAAAn7B,MAAI,EAAC,cACLA,EAAC,oBAGOh7B,EAAAgC,EAAA,QAAA6qD,EAAA,YAAA7xB,MAAI,GAAC,uCAKah7B,EAAAtf,EAAA,QAAAgvE,EAAA,kIAAA10B,MAAI,GAAC,0SAKpBA,EAAC,IAAG,GAAC,8CAA4CA,EAAC,IACnE,gDACiBA,EAAC,IAClB,GAAC,gDAA8CA,MAC/C,GAAC,8BACMh7B,EAAAtf,EAAA,MAAA01E,EAAA,OAAAp7B,MAAI,EAAC,iBArBhBV,EAOC7qB,EAAAzN,EAAAjsB,CAAA,wBAHcilD,EAAU,YAIzBV,EAgBO7qB,EAAA/uB,EAAA3K,CAAA,yEAtBGulD,EAAA,GAAA66B,OAAA,OAAAn7B,MAAI,6BACJA,EAAC,yCAGOM,EAAA,GAAAuxB,OAAA,YAAA7xB,MAAI,GAAC,wFAFRA,EAAU,IAmBtBM,EAAA,GAAAyY,OAAA/Y,MAAI,EAAC,KAAAsE,GAAA0U,EAAAD,CAAA,EAZ4BzY,EAAA,GAAAo0B,OAAA,kIAAA10B,MAAI,GAAC,0SAKpBA,EAAC,IAAG,GAAC,8CAA4CA,EAAC,IACnE,gDACiBA,EAAC,IAClB,GAAC,gDAA8CA,MAC/C,GAAC,8CACMM,EAAA,GAAA86B,OAAA,OAAAp7B,MAAI,8IAvBdD,EAAAC,KAAW,GAACG,GAAAH,CAAA,uLA1DjB,WAEA,qDAgBA,UAEA,6oBAtBGA,EAAkB,GAAG,YAAc,cAAY,mGAW7CA,EAAkB,GAAG,kBAAoB,kBAAgB,gMAO3DA,EAAmB,GAAG,YAAc,cAAY,wGAW9CA,EAAmB,GAAG,kBAAoB,kBAAgB,sqBAvDjEV,EAiIK7qB,GAAA8qB,EAAAxkD,CAAA,EA5HH8lD,EAQQtB,EAAAyF,CAAA,SACRnE,EAQQtB,EAAA0F,CAAA,SAERpE,EAMMtB,EAAA8kB,CAAA,gBACNxjB,EAUQtB,EAAA2F,CAAA,EANNrE,EAKIqE,EAAAC,CAAA,SAENtE,EAMMtB,EAAA+kB,CAAA,gBACNzjB,EAUQtB,EAAA6F,CAAA,EANNvE,EAKIuE,EAAAC,CAAA,SAENxE,EAKMtB,EAAA87B,CAAA,SACNx6B,EAiBKtB,EAAAqB,CAAA,EAZHC,EAKQD,EAAA8a,CAAA,SACR7a,EAKQD,EAAA+E,CAAA,uDAxEGqS,GAAAhY,SAAc,mDASdgY,GAAAhY,SAAa,0JAOvBA,EAAkB,GAAG,YAAc,cAAY,iHAW7CA,EAAkB,GAAG,kBAAoB,kBAAgB,yLAO3DA,EAAmB,GAAG,YAAc,cAAY,sHAW9CA,EAAmB,GAAG,kBAAoB,kBAAgB,4JA+B1DA,KAAW,mIApGL,mBAAAs7B,CAAuC,EAAA77B,GACvC,oBAAAlN,CAAwC,EAAAkN,GACxC,WAAA87B,CAAkB,EAAA97B,GAClB,SAAA+7B,CAA2B,EAAA/7B,GAC3B,cAAAg8B,CAAsC,EAAAh8B,GACtC,oBAAAi8B,CAA6C,EAAAj8B,GAC7C,qBAAAk8B,CAA8C,EAAAl8B,GAC9C,4BAAAm8B,CAEF,EAAAn8B,GACE,cAAAo8B,CAAyB,EAAAp8B,GACzB,eAAAq8B,CAA0B,EAAAr8B,eAoClBgnB,EAAA,IAAAiV,GAAqBJ,CAAkB,EAkBvC7iB,EAAA,IAAAkjB,GAAsBppC,CAAmB,EAsBvCmmB,EAAA,IAAAkjB,EAA4B,UAAU,EAMtClV,EAAA,IAAAkV,EAA4B,SAAS,eAavCL,EAAU,oBACL,MAAAQ,EAAAlkG,GAAA4jG,EAAc5jG,CAAC,eAyBtB0jG,EAAU,oBACL,MAAAS,EAAA,IAAAP,EAAc,CAAC,y4BCnHlCz7B,EAAkB,GAAG,YAAc,OACnCmkB,EAAAnkB,MAAuBA,EAAkB,GAAG,MAAQ,SACpDA,EAAmB,GAAG,WAAa,0HAFnCA,EAAkB,GAAG,YAAc,KAAEsE,GAAAC,EAAAL,CAAA,EACrC5D,EAAA,GAAA6jB,OAAAnkB,MAAuBA,EAAkB,GAAG,MAAQ,KAAEsE,GAAAigB,EAAAJ,CAAA,cACtDnkB,EAAmB,GAAG,WAAa,KAAEsE,GAAA23B,EAAAC,CAAA,6DAJ/BnjB,EAAA/Y,KAAc,EAAC,oBADF,QACd,2CAACM,EAAA,GAAAyY,OAAA/Y,KAAc,EAAC,KAAAsE,GAAA0U,EAAAD,CAAA,8CAyBPxL,EAAA3a,GAAuBoN,EAAM,GAACA,EAAW,IAAE,UAAUA,EAAC,sCAF/DV,EAGK7qB,EAAAt8B,EAAA4C,CAAA,wBADIulD,EAAA,IAAAiN,OAAA3a,GAAuBoN,EAAM,GAACA,EAAW,IAAE,UAAUA,EAAC,WAAA7nD,EAAA,UAAAo1D,0CAWpDA,EAAA3a,GAAuBoN,EAAM,GAACA,EAAW,IAAE,YAAYA,EAAC,4qBAPnEV,EAqBK7qB,EAAAusB,EAAAjmD,CAAA,EAhBH8lD,EAGKG,EAAAJ,CAAA,uBACLC,EAOKG,EAAAzB,CAAA,SACLsB,EAGMG,EAAAC,CAAA,UAbGX,EAAA,IAAAiN,OAAA3a,GAAuBoN,EAAM,GAACA,EAAW,IAAE,YAAYA,EAAC,WAAAY,EAAA,UAAA2M,kDARhEyP,EAAAhd,EAAmB,IAAIA,EAAgB,GAAC,SAASA,EAAC,QANlDA,EAAkB,IAAAE,GAAAF,CAAA,0DAJpBzkB,EAAA,eAAAykB,KAAQ,CAAC,uPANhBV,EAyCK7qB,EAAAwsB,EAAAlmD,CAAA,EAxCH8lD,EAOKI,EAAAL,CAAA,EANHC,EAKMD,EAAArlB,CAAA,SAERslB,EA+BKI,EAAA1B,CAAA,sDA9BES,EAAkB,0DAMlBM,EAAA,KAAA0c,EAAAhd,EAAmB,IAAIA,EAAgB,GAAC,SAASA,EAAC,mJA7BxDA,EAAM,GAAC,OAAS,EAACC,6BAYfD,EAAK,yBAAV,OAAInoE,GAAA,iPAhBRynE,EAWK7qB,EAAAmsB,EAAA7lD,CAAA,uBACLukD,EAgDK7qB,EAAA8qB,EAAAxkD,CAAA,2IA5CIilD,EAAK,sBAAV,OAAInoE,GAAA,qHAAJ,mFAxBS,mBAAAyjG,CAAuC,EAAA77B,GACvC,oBAAAlN,CAAwC,EAAAkN,GACxC,YAAA08B,CAAmB,EAAA18B,GACnB,MAAA1D,CAAe,EAAA0D,GACf,OAAA28B,CAAe,EAAA38B,GACf,iBAAA48B,CAA0B,EAAA58B,+mBCYnBO,EAAQ,0FAPhBh7B,EAAA7sB,EAAA,QAAAsqD,EAAAzC,EAAkB,KAAK,GAAKA,EAAkB,KAAKA,EAAA,GACvD,GACA,QAAQ,UAHdV,EAaK7qB,EAAAt8B,EAAA4C,CAAA,qIALailD,EAAQ,yFAPhB,CAAAvvD,GAAA6vD,EAAA,IAAAmC,OAAAzC,EAAkB,KAAK,GAAKA,EAAkB,KAAKA,EAAA,GACvD,GACA,wIAJDiZ,EAAAC,GAAA,MAAMlZ,EAAM,GAAC,MAAM,EAAE,MAAI,uBAA9B,OAAInoE,GAAA,0MAACohF,EAAAC,GAAA,MAAMlZ,EAAM,GAAC,MAAM,EAAE,MAAI,oBAA9B,OAAInoE,GAAA,sHAAJ,OAAIA,EAAAq2E,EAAA,OAAAr2E,GAAA,0CAAJ,OAAIA,GAAA,kIARO,mBAAAyjG,CAAuC,EAAA77B,GACvC,oBAAAlN,CAAwC,EAAAkN,GACxC,mBAAA68B,CAA0B,EAAA78B,GAC1B,MAAA1D,CAAe,EAAA0D,GACf,OAAA28B,CAAe,EAAA38B,GACf,iBAAA48B,CAA0B,EAAA58B,q8BCN1B,WAAA88B,CAA0C,EAAA98B,EAMpC,MAAAgnB,EAAA,IAAA8V,EAAW,GAAG,EAKd9jB,EAAA,IAAA8jB,EAAW,GAAG,yTC8JZv8B,EAAkB,YACpBA,EAAM,y3BAvBZh7B,EAAAg8B,EAAA,QAAA4T,EAAA5U,EAAS,GAAC,SAAW,OAAS,EAAE,UAA7CV,EAgDK7qB,EAAAusB,EAAAjmD,CAAA,EA/CH8lD,EAYKG,EAAAzB,CAAA,EANHsB,EAKKtB,EAAAqB,CAAA,qBAEPC,EAiCKG,EAAAC,CAAA,EA7BHJ,EAaOI,EAAAu7B,CAAA,qBACP37B,EAcMI,EAAAstB,CAAA,uIAxBWvuB,EAAkB,sBACpBA,EAAM,kPAvBZ,CAAAvvD,GAAA6vD,EAAA,KAAAsU,OAAA5U,EAAS,GAAC,SAAW,OAAS,+SAlI9B,UAAAZ,EAAS,IAAAK,GACT,UAAAg9B,CAAoB,EAAAh9B,GACpB,gBAAAi9B,CAGF,EAAAj9B,GACE,eAAAq8B,CAA0B,EAAAr8B,EAEjC68B,EAAwC,EACxC/pC,EAAsB,GACtB+oC,EAAqB,GACrB75B,EACA46B,EAAgB,GAEhB7gC,EAQAO,EAUAqgC,EAAM,GA2BD,SAAAT,EAAqBgB,EAA6B,CACzD78B,EAAA,EAAAvN,EAAsBoqC,CAAoB,EACrCpqC,GACHmpC,EAAoB,EAAI,EAInB,SAAAD,EAAc/2C,EAAW,CAC5BwU,GAAqBxU,CAAG,GAC1Bob,EAAA,EAAAw8B,EAAqB53C,CAAG,EAInB,SAAAg3C,EAAoBkB,EAA4B,CACvD98B,EAAA,EAAAw7B,EAAqBsB,CAAmB,EACnCtB,GACHK,EAAqB,EAAI,WAIpBE,GAAa,OACdgB,EAAS,GACJ,UAAA1mG,KAAYipE,EACrBjpE,EAAS,KAAO2kE,GAAoB,EACpC+hC,EAAU,KAAI,CACZ,KAAM1mG,EAAS,KACf,GAAIA,EAAS,GACb,KAAMA,EAAS,KAAK,UAAU,EAAG,CAAC,EAClC,YAAaA,EAAS,YACtB,SAAUA,EAAS,WAGvBwvD,GAAgB,IAAIk3C,CAAS,EAC7BH,EAAgB,EAAI,EACpBvhC,GAAqCme,CAAgB,EACrDxZ,EAAA,EAAAw7B,EAAqB,EAAI,EACzBx7B,EAAA,EAAAvN,EAAsB,EAAK,MAC3B8pC,EAAgB,IAOT,SAAAT,EAA4Bx7B,EAA8B,CAC7DA,IAAW,YACTi8B,EAAiB,SAAW,IAC9BA,EAAiB,IAAG,UAIpBj8B,IAAW,YACTi8B,EAAiB,OAAStgC,EAAM,QAClCsgC,EAAiB,KAAKtgC,EAAMsgC,EAAiB,MAAM,WAMhD,SAAAE,EAAWxhB,EAAoB,CAChC,MAAA+hB,EAAU,OAAO9nB,EAAe,GAAK,CAAC,EACtC+nB,EAAU,QACbhiB,IAAc,IAAM+hB,EAAU,GAAMA,EAAU,IAAK,QAAQ,CAAC,GAE/Dz5B,GAAApd,GAAA+uB,EAAe,EAAI+nB,EAAQ,SAAQ,EAAA/nB,CAAA,EAC7B,MAAAuZ,EAAO,SAAS,cAAc,MAAM,EAC1Cje,GAAI,EAAG,KAAI,IAAOtV,GAAkBuzB,CAAI,GACxCpzB,GAAoC,4CAwCtBsG,EAAWsC,8OAvJ1B,OACO5G,EAAkBs/B,EAAU,OAAO,CAAC,EAAE,KAAK,OAC7CvjC,GAAqBiE,CAAe,GACtC2C,EAAA,EAAAtE,EAAS2B,CAAe,uBAK3B,OACO6/B,EACJP,EAAU,yBAA2BA,EAAU,OAAO,OACxD38B,EAAA,EAAA/D,EACEiZ,EAAe,QAAU,QAAaA,EAAe,MAAM,SAAW,MAC9D,MAAMgoB,CAAW,EAAE,KAAI,GAC3BhoB,EAAe,KAAK,uBAI3B,KACConB,EAAM,IACG,QAAAvkG,EAAI,EAAGA,EAAI2jE,EAAQ3jE,IAAC,OACrB0zF,EAAK,CACT,UAAS,GACT,UAAS,GACT,YAAW,cAEF0R,KAASR,EAAU,OAC5BlR,EAAM,UAAU,KAAK0R,EAAM,KAAKplG,CAAC,EAAE,QAAQ,EAC3C0zF,EAAM,UAAU,KAAK0R,EAAM,KAAKplG,CAAC,EAAE,QAAQ,EAC3C0zF,EAAM,YAAY,KAAK0R,EAAM,KAAKplG,CAAC,EAAE,UAAU,EAEjDukG,EAAO,KAAK7Q,CAAK,mBAKlB+P,GACC/oC,GACA8pC,EAAiB,OAAS,IAC5BC,IAAuB,QAEvBhsB,GAAI,EAAG,KAAI,IAAOtV,GAAkByG,CAAW,qMCpE1C8L,EAAAvN,KAAU,WAAU,iCAF7BV,EAGK7qB,EAAAt8B,EAAA4C,CAAA,0BADIulD,EAAA,GAAAiN,OAAAvN,KAAU,WAAU,MAAA7nD,EAAA,UAAAo1D,oDALhB,UAAA2vB,CAAc,EAAAz9B,6NCWdO,EAAa,+DAFtBV,EAGK7qB,EAAAt8B,EAAA4C,CAAA,sCADIilD,EAAa,QAAAoT,EAAA,EAAA7F,CAAA,uCANjBA,EAAAvN,KAAU,eAAc,OAGxBiZ,EAAAC,GAAAlZ,KAAU,cAAc,uBAA7B,OAAInoE,GAAA,yGALRynE,EAGK7qB,EAAAmsB,EAAA7lD,CAAA,yBACLukD,EAOK7qB,EAAA8qB,EAAAxkD,CAAA,gEATIulD,EAAA,GAAAiN,OAAAvN,KAAU,eAAc,MAAAY,EAAA,UAAA2M,QAGxB0L,EAAAC,GAAAlZ,KAAU,cAAc,oBAA7B,OAAInoE,GAAA,qHAAJ,6EARS,UAAAqlG,CAAc,EAAAz9B,mKCMhBiT,EAAA1S,KAAU,SAAQ,OAIlB4S,EAAA5S,KAAU,SAAQ,0FAP7BV,EASK7qB,EAAAwsB,EAAAlmD,CAAA,EARH8lD,EAGKI,EAAAL,CAAA,uBACLC,EAGKI,EAAA1B,CAAA,0BALIe,EAAA,GAAAoS,OAAA1S,KAAU,SAAQ,MAAAY,EAAA,UAAA8R,GAIlBpS,EAAA,GAAAsS,OAAA5S,KAAU,SAAQ,MAAAT,EAAA,UAAAqT,oDAVhB,UAAAsqB,CAAc,EAAAz9B,qRCQZO,EAAW,+DAFpBV,EAGK7qB,EAAAt8B,EAAA4C,CAAA,sCADIilD,EAAW,QAAAoT,EAAA,EAAA7F,CAAA,2CAkBXvN,EAAW,+DAFpBV,EAGK7qB,EAAAt8B,EAAA4C,CAAA,sCADIilD,EAAW,QAAAoT,EAAA,EAAA7F,CAAA,+CAXbmF,EAAA1S,KAAU,aAAY,OAItB4S,EAAA5S,KAAU,aAAY,OAdxB+d,EAAA7E,GAAAlZ,KAAU,YAAY,uBAA3B,OAAInoE,GAAA,qBAkBC,IAAAohF,EAAAC,GAAAlZ,KAAU,YAAY,uBAA3B,OAAInoE,GAAA,gQApBVynE,EA2BK7qB,EAAAw+B,EAAAl4D,CAAA,EA1BH8lD,EAOKoS,EAAArS,CAAA,0DACLC,EASKoS,EAAAjS,CAAA,EARHH,EAGKG,EAAAzB,CAAA,uBACLsB,EAGKG,EAAAC,CAAA,uBAEPJ,EAOKoS,EAAA9R,CAAA,qEAxBI4c,EAAA7E,GAAAlZ,KAAU,YAAY,oBAA3B,OAAInoE,GAAA,qHAAJ,UAUOyoE,EAAA,GAAAoS,OAAA1S,KAAU,aAAY,MAAAT,EAAA,UAAAmT,GAItBpS,EAAA,GAAAsS,OAAA5S,KAAU,aAAY,MAAAiB,EAAA,UAAA2R,QAIxBqG,EAAAC,GAAAlZ,KAAU,YAAY,oBAA3B,OAAInoE,GAAA,qHAAJ,yEAvBO,UAAAqlG,CAAc,EAAAz9B,yOCkChB6d,EAAAtd,KAAI,EAAC,wOALRV,EAMK7qB,EAAAt8B,EAAA4C,CAAA,iBADFulD,EAAA,KAAAgd,OAAAtd,KAAI,EAAC,KAAAsE,GAAAz5D,EAAAyyE,CAAA,2FAUCtd,EAAe,sHAD2BA,EAAC,YAAlDV,EAMK7qB,EAAAt8B,EAAA4C,CAAA,iMAN4CilD,EAAC,yIAIRA,EAAY,GAAC,KAAKA,EAAC,0FAAnBA,EAAY,GAAC,KAAKA,EAAC,wJAFlBA,EAAY,GAAC,KAAKA,EAAC,0FAAnBA,EAAY,GAAC,KAAKA,EAAC,wKAavDA,EAAe,kFALLA,EAAC,6IADlBV,EAWK7qB,EAAAt8B,EAAA4C,CAAA,mMAVYilD,EAAC,yIAQ0BA,EAAY,GAAC,KAAKA,EAAC,0FAAnBA,EAAY,GAAC,KAAKA,EAAC,wJAFlBA,EAAY,GAAC,KAAKA,EAAC,0FAAnBA,EAAY,GAAC,KAAKA,EAAC,yIA/B/Dc,EAAAd,KAAS,GAACwS,GAAAxS,CAAA,EAcRe,EAAAf,EAAiB,IAAIA,EAAY,GAAC,KAAKA,EAAC,KAAAC,GAAAD,CAAA,EASxCyU,EAAAzU,EAAmB,IAAIA,EAAY,GAAC,KAAKA,EAAC,KAAAG,GAAAH,CAAA,wJAbzBA,EAAC,mGAdxBh7B,EAAAu6B,EAAA,QAAAkS,EAAA,6HAAAzR,EAAM,GAAG,EACN,6DACA,GAAE,UALRV,EA6CK7qB,EAAA8qB,EAAAxkD,CAAA,wBA7BH8lD,EA4BKtB,EAAAqB,CAAA,mEArCAZ,KAAS,yDAcPA,EAAiB,IAAIA,EAAY,GAAC,KAAKA,EAAC,oGASxCA,EAAmB,IAAIA,EAAY,GAAC,KAAKA,EAAC,8IAbzBA,EAAC,8CAdxB,CAAAvvD,GAAA6vD,EAAA,KAAAmR,OAAA,6HAAAzR,EAAM,GAAG,EACN,6DACA,mJAuDH+Y,EAAA/Y,KAAkB,EAAC,oBA7Db,MAAMA,EAAM,IAAE,KAAI,yBAA3B,OAAInoE,GAAA,4KA6DmB,KAAG,MAACmoE,EAAuB,IA/DnDh7B,EAAA47B,EAAA,QAAAgO,EAAA,kEAAA5O,KAAS,EAAI,iCAAmC,cAAa,+CA6DxCoZ,EAAA7Z,EAAA,WAAAS,EAAe,GAAG,GAAKA,KAA2B,GAAG,oUA/D7EV,EAoDK7qB,EAAAmsB,EAAA7lD,CAAA,4DACLukD,EAeQ7qB,EAAAkP,EAAA5oC,CAAA,EARN8lD,EAOKld,EAAAsd,CAAA,EANHJ,EAKKI,EAAA1B,CAAA,yDA9DI,MAAMS,EAAM,IAAE,KAAI,sBAA3B,OAAInoE,GAAA,8GAAJ,OAAIA,EAAAq2E,EAAA,OAAAr2E,GAAA,aAFL,CAAA4Y,GAAA6vD,EAAA,KAAAsO,OAAA,kEAAA5O,KAAS,EAAI,iCAAmC,kCA+D5C,CAAAvvD,GAAA6vD,EAAA,KAAAyY,OAAA/Y,KAAkB,EAAC,KAAAsE,GAAA0U,EAAAD,CAAA,mBAAK/Y,EAAuB,gBAF9BoZ,EAAA7Z,EAAA,WAAAS,EAAe,GAAG,GAAKA,KAA2B,GAAG,+BA3DzE,OAAInoE,GAAA,8IAhBK,YAAAslG,CAA6B,EAAA19B,GAC7B,kBAAA29B,CAA0B,EAAA39B,GAC1B,oBAAAlN,CAA4B,EAAAkN,GAC5B,aAAA49B,CAAmB,EAAA59B,GACnB,gBAAA69B,CAAuB,EAAA79B,GACvB,wBAAA89B,CAA+B,EAAA99B,GAC/B,gBAAA7D,CAAwB,EAAA6D,EAE/BjE,8CA2Bc2hC,EAAYtlG,CAAC,EAAAksE,4ZA1B9BjE,EAAA,EAAEtE,GAAS6hC,GAAA,YAAAA,EAAc,KAAK,SAAU,CAAC,geCwItC/9B,EAKI7qB,EAAA58C,EAAAkjB,CAAA,+RACJukD,EAKI7qB,EAAA58C,EAAAkjB,CAAA,gGAZ2BilD,EAAY,8OAJpCA,EAAY,GAAG,yBAA2B,aAAa,UAHpEV,EAsBQ7qB,EAAA2rB,EAAArlD,CAAA,EAhBN8lD,EAeKT,EAAAjoD,CAAA,sCAjBM6nD,EAAgB,uDAGQA,EAAY,kEAJpCA,EAAY,GAAG,yBAA2B,kIAxG/C,MAAAw9B,GAAQ,sCAtCH,SAAAtnD,EAAQ,UASb,MAAAunD,EACJppG,GAGE,sBAAuBA,GACvB,yBAA0BA,GAC1B,4BAA6BA,GAC7B,wBAAyBA,EAWvBqpG,EACJC,GAGE,mBAAoBA,GACpB,wBAAyBA,GACzB,yBAA0BA,GAC1B,qBAAsBA,EAKtB,IAAAC,EAAe,GAEnBl+B,GAAO,KACL,SAAS,iBAAiB,mBAAoBm+B,CAAsB,IAGtEh7B,GAAS,KACP,SAAS,oBAAoB,mBAAoBg7B,CAAsB,UAGnEA,EAAsB,KACpB,MAAAC,EAAiB,SAAS,mBAAqB,KACrDh+B,EAAA,EAAA89B,EAAeE,CAAc,EAC7B5nD,GAAA,MAAAA,EAAW0nD,IAGPG,EAAgB,UACd,MAAA1pG,EAAU,SAAS,eAAempG,EAAK,MACxCnpG,EAAO,CACV2pG,EAAqB,IAAK,MAAK,IAAKR,EAAK,uBAI3C19B,EAAA,EAAA89B,GAAgBA,CAAY,EAEtB,MAAAE,EAAiB,SAAS,mBAAqB,KACjD,GAAAF,IAAiBE,EACf,GAAAL,EAA2BppG,CAAO,MAE5B,MAAA4pG,EAAkB5pG,CAAO,OACnB,CACZ,QAAQ,MAAM,2CAA2C,OAG3D2pG,EAAqB,IAAK,MAAM,4BAA4B,GAG3D,IAAAJ,GAAgBE,EACf,GAAAJ,EAAwB,QAAQ,YAE1BQ,EAAc,OACR,CACZ,QAAQ,MAAM,0CAA0C,OAG1DF,EAAqB,IAAK,MAAM,sCAAsC,GAG1E9nD,GAAA,MAAAA,EAAW0nD,IAGPK,QACJ5pG,GAA+C,CAG3C,KAAAA,aAAmB,cAAW,CAC/BopG,EAA2BppG,CAAO,GAEnC2pG,EAAqB,IAAK,MAAM,sCAAsC,UAGlE,MAAAG,EACJ9pG,EAAQ,mBACRA,EAAQ,sBACRA,EAAQ,yBACRA,EAAQ,uBACN8pG,YAEMA,EAAO,KAAK9pG,CAAO,OACb,CACZ2pG,EAAqB,IAAK,MAAM,gCAAgC,QAGlEA,EAAqB,IAAK,MAAM,4BAA4B,IAI1DE,EAAc,UACb,IAAAR,EAAwB,QAAQ,GACnCM,EAAqB,IAAK,MAAM,sCAAsC,UAGlE,MAAAG,EACJ,SAAS,gBACT,SAAS,qBACT,SAAS,sBACT,SAAS,iBACPA,QACIA,EAAO,KAAK,QAAQ,EAE1BH,EAAqB,IAAK,MAAM,sCAAsC,IAIpEA,EAAyBlrG,GAAY,CACzC,QAAQ,MAAMA,CAAK,EACnBywD,GAAyB,cAAe,IAAM,6BAA6B,kOCjI9Dyc,EAAa,6DAEjBgY,GAAAhY,SAAQ,6DAGHA,EAAa,6DAElBgY,GAAAhY,SAAS,0MAPLA,EAAa,kDAKZA,EAAa,8NAZlB,SAAAqjB,CAAoB,EAAA5jB,GACpB,UAAA0jB,CAAqB,EAAA1jB,GACrB,cAAA2+B,CAAqB,EAAA3+B,yUCMRO,EAAa,yEAE1BgY,GAAAhY,SAAY,kDAGhBA,EAAO,GAAG,UAAY,YAAU,IAAGA,EAAa,QAAGA,EAAA,GACtD,YACA,oGAKgBA,EAAa,yEAEtBgY,GAAAhY,SAAY,oNAdCA,EAAa,wCAK9BA,EAAO,GAAG,UAAY,YAAU,IAAGA,EAAa,QAAGA,EAAA,GACtD,YACA,wDAKgBA,EAAa,8NArBtB,QAAAq+B,CAAgB,EAAA5+B,GAChB,mBAAA6+B,CAAuC,EAAA7+B,GACvC,aAAA8+B,CAAwB,EAAA9+B,GACxB,aAAAkD,CAAwB,EAAAlD,GACxB,YAAA++B,CAA6C,EAAA/+B,GAC7C,cAAA2+B,CAAqB,EAAA3+B,EAaf,MAAAgnB,EAAA,IAAA+X,EAAY,EAAI,4hBCO9Bx+B,EAAY,qQAhBjBV,EAkBK7qB,EAAAt8B,EAAA4C,CAAA,EAjBH8lD,EASC1oD,EAAA6uB,CAAA,OAFcg5B,EAAe,WAG9Ba,EAMO1oD,EAAAuN,CAAA,sGATQs6C,EAAe,cAQ3BA,EAAY,4DAxBX,IAAAy+B,EAAkB,GAElBC,EAGE,MAAA5tB,EAAWC,GAAqB,eAWvB0tB,EAAezd,GAAA,+BACVlQ,EAAS,SAAU2tB,CAAe,wCAdrD3+B,EAAA,EAAE4+B,EAAevpC,GAAespC,CAAe,uRCKhDn/B,EAMI7qB,EAAAirC,EAAA3kE,CAAA,2aACJukD,EAeK7qB,EAAA8qB,EAAAxkD,CAAA,EAdH8lD,EAKGtB,EAAAn7C,CAAA,SACHy8C,EAOKtB,EAAAqB,CAAA,mPAxBYZ,EAA6B,4BAA7BA,EAA6B,2LAA7BA,EAA6B,kIALrC,kBAAA2+B,CAAoD,EAAAl/B,GACpD,8BAAAm/B,CAAsC,EAAAn/B,UAuB9BvrE,GAAC,OACNuqG,EAAkBvqG,EAAE,OAC1ByqG,EAAkBF,CAAe,iBArBtBG,EAA6BlsG,wWCmC5BstE,EAAa,6DAEhBA,EAAkB,GAAG,SAAWA,KAAuB,qBAC7DA,EAAyB,qCAGrBA,EAAa,qDAEXA,EAAc,iCACpBgY,GAAAhY,SAAiB,iEAGRA,EAAa,6DAEtBgY,GAAAhY,SAAc,qbAdLA,EAAa,4BAEhBA,EAAkB,GAAG,SAAWA,KAAuB,mDAIzDA,EAAa,6BAEXA,EAAc,yDAIXA,EAAa,2YApDtB,kBAAA2+B,CAAoD,EAAAl/B,GACpD,kBAAAo/B,CAA6B,EAAAp/B,GAC7B,eAAAq8B,CAAsC,EAAAr8B,GACtC,MAAAq/B,CAAiB,EAAAr/B,GACjB,KAAAs/B,CAAqC,EAAAt/B,GACrC,mBAAA6+B,CAAuC,EAAA7+B,GACvC,kBAAA29B,CAA0B,EAAA39B,GAC1B,oBAAAlN,CAA4B,EAAAkN,GAC5B,qBAAAu/B,CAA4B,EAAAv/B,GAC5B,cAAA2+B,CAAqB,EAAA3+B,EAE5Bw/B,EAAoC,GAepCL,EAAgC,YAC3BM,GAAyB,CAChCp/B,EAAA,EAAA8+B,EAAgC,EAAI,4iBAfnCO,EAAc,IACX/B,IAAsB7qC,EACjB,IAEL6qC,GAAqB7qC,EAChB,MAEJ,CAAA6qC,GAAqB7qC,EACjB,IAEF,sBAQFqsC,GACLE,EAAK,EACLh/B,EAAA,GAAAm/B,EAAoC,EAAI,GAC/BA,GACTF,EAAK,EAAI,+hCCfbz/B,EAEK7qB,EAAAmsB,EAAA7lD,CAAA,uBACLukD,EASK7qB,EAAA8qB,EAAAxkD,CAAA,uBACLukD,EAaK7qB,EAAAwsB,EAAAlmD,CAAA,4vBA7BG,MAAAqjF,GAAgB,+CAhBX,mBAAAE,CAAuC,EAAA7+B,GACvC,kBAAA29B,CAA0B,EAAA39B,GAC1B,oBAAAlN,CAA4B,EAAAkN,GAC5B,kBAAAk/B,CAAoD,EAAAl/B,GACpD,eAAAq8B,CAAsC,EAAAr8B,GACtC,QAAA4+B,CAAgB,EAAA5+B,GAChB,aAAAkD,CAAwB,EAAAlD,GACxB,aAAA8+B,CAAwB,EAAA9+B,GACxB,kBAAAo/B,CAA6B,EAAAp/B,GAC7B,YAAA++B,CAA6C,EAAA/+B,GAC7C,UAAA0jB,CAAqB,EAAA1jB,GACrB,SAAA4jB,CAAoB,EAAA5jB,GACpB,MAAAq/B,CAAiB,EAAAr/B,GACjB,KAAAs/B,CAAsC,EAAAt/B,GACtC,qBAAAu/B,CAA4B,EAAAv/B,koCC+BhCz6B,EAAAo7B,EAAA,QAAAiE,EAAA,uCAAArE,OAA0BA,EAAC,GAAG,eAAiB,IAAE,KACjDA,EAAqB,IAAIA,EAAC,GAAG,eAAiB,IAAE,2BALrDV,EAOQ7qB,EAAA2rB,EAAArlD,CAAA,0CAHHulD,EAAA,GAAA+D,OAAA,uCAAArE,OAA0BA,EAAC,GAAG,eAAiB,IAAE,KACjDA,EAAqB,IAAIA,EAAC,GAAG,eAAiB,IAAE,gGAN5C,MAAMA,EAAoB,IAAE,KAAI,yBAAzC,OAAInoE,GAAA,mLALWmoE,EAAS,QAAuBoZ,EAAAxY,EAAA,sBAAAZ,KAC7C,IAAG,2KAPWA,EAAkB,iEAFtCV,EAWK7qB,EAAA8qB,EAAAxkD,CAAA,EALH8lD,EAIMtB,EAAAqB,CAAA,WAERtB,EAWI7qB,EAAA4H,EAAAthC,CAAA,kFAfeilD,EAAS,cAAuBoZ,EAAAxY,EAAA,sBAAAZ,KAC7C,IAAG,kCAPWA,EAAkB,mBAWzB,MAAMA,EAAoB,IAAE,KAAI,sBAAzC,OAAInoE,GAAA,qHAAJ,6EA1CS,mBAAAymG,CAAuC,EAAA7+B,GACvC,sBAAA2/B,CAA6B,EAAA3/B,GAC7B,qBAAA4/B,CAA4B,EAAA5/B,GAC5B,aAAA6/B,CAAqC,EAAA7/B,GACrC,UAAA8/B,CAAiB,EAAA9/B,GACjB,qBAAAu/B,CAA4B,EAAAv/B,EAEnC+/B,EACJ9/B,GAAO,KACLI,EAAA,EAAA0/B,EAAU,SAAS,eAAe,SAAS,KAmCxB,MAAA/Y,EAAA5uF,GAAAynG,EAAaznG,CAAC,6WA/B7B2nG,EAAO,CACH,MAAAC,EAAQD,EAAQ,iBAAiB,QAAQ,EAC3CC,EAAML,CAAqB,GAC7BK,EAAML,CAAqB,EAAE,eAAc,EACzCK,EAAML,EAAwB,CAAC,GACjCK,EAAML,EAAwB,CAAC,EAAE,eAAc,EAC7CK,EAAML,EAAwB,CAAC,GACjCK,EAAML,EAAwB,CAAC,EAAE,eAAc,EAC3C,MAAAM,EAAyB,SAAS,eACtC,wBAAwB,EAEtBA,GAAwBA,EAAuB,eAAc,sXCZxD1nB,GAAAhY,SAAa,iJAKbgY,GAAAhY,SAAY,0DAIV,WAAAja,GAAgB,CAAG,KAAM,WAAW,GAAI,SAAQ,6RASjD,mBAAS,gIAKViyB,GAAAhY,SAAc,uOA3B7BV,EA6BK7qB,EAAAt8B,EAAA4C,CAAA,sYAlCQ,cAAA4kF,CAAyB,EAAAlgC,GACzB,eAAAq8B,CAA0B,EAAAr8B,GAC1B,aAAAmgC,CAAwB,EAAAngC,8xBC2ZnCH,EAaK7qB,EAAA8qB,EAAAxkD,CAAA,EANH8lD,EAIKtB,EAAAqB,CAAA,0QA1DuB,sBAAAZ,KAAU,gBACb,mBAAAA,KAAe,WACb,qBAAAA,KAAU,4LAgBf,gBAAAA,KAAU,gBACF,wBAAAA,KAAU,wBAChB,kBAAAA,KAAe,oCAQd,mBAAAA,KAAe,y4BAvC1CV,EAwDK7qB,EAAAt8B,EAAA4C,CAAA,EAlDH8lD,EAYQ1oD,EAAA0nF,CAAA,qBACRh/B,EAcM1oD,EAAAo2E,CAAA,qBACN1tB,EAqBQ1oD,EAAA+rE,CAAA,sCA5CoB5jB,EAAA,OAAAw/B,EAAA,sBAAA9/B,KAAU,iBACbM,EAAA,QAAAw/B,EAAA,mBAAA9/B,KAAe,YACbM,EAAA,OAAAw/B,EAAA,qBAAA9/B,KAAU,4NAgBfM,EAAA,OAAAy/B,EAAA,gBAAA//B,KAAU,iBACFM,EAAA,OAAAy/B,EAAA,wBAAA//B,KAAU,yBAChBM,EAAA,QAAAy/B,EAAA,kBAAA//B,KAAe,sCAQdM,EAAA,QAAA0/B,EAAA,mBAAAhgC,KAAe,0bAxCvCA,EAAS,GAAC,gBAAkBA,EAAS,GAAC,yBAA2BA,EAAS,GAAC,gBAAe,GAAK,2GAFxEA,EAAc,wOA3J/B,SAAAigC,GAAS5rG,EAA2B,CACvC,OAAAA,IAAY,KACL,QAAQ,EAAG,MAAO,CAAC,GAG1B,OACEA,EAAQ,aAAeA,EAAQ,aAC3BA,EAAQ,aACRA,EAAQ,aACd,MACEA,EAAQ,YAAcA,EAAQ,YAC1BA,EAAQ,YACRA,EAAQ,+DA5MT,UAAAooG,CAAoB,EAAAh9B,GACpB,iBAAAygC,CAAkD,EAAAzgC,GAClD,eAAAq8B,CAA0B,EAAAr8B,GAC1B,aAAAmgC,CAAwB,EAAAngC,QAE7B09B,EAAW,GACXrrB,EAAiB,IAAO,OAAO,MAAM,oBAAmB,CAC5D,QAAS,GAAI,EAEX,IAAAvf,EAAsB,GACtB8rC,EAAU,GACV8B,EAAgB,GAChB/C,EAAoB,GACpBgD,EACAb,EAAY,EACZc,EAAW,EACXC,EAAc,EAEd7kC,EAeAM,EAAK,GAOLP,EAGA6hC,EAGA2B,EAUJn8B,GAAS,KACPi8B,GAAK,aAGEP,GAAY,IACf9B,EAAU,kBAAoB,EAAC,CACjCqC,GAAK,EACLhD,EAAc,YAGZqE,EAAa,CACfrgC,EAAA,EAAA28B,EAAU,kBAAeA,CAAA,SAG3B38B,EAAA,EAAAs9B,EAAoB,EAAI,EACxBt9B,EAAA,EAAAvN,EAAsB,EAAK,EAC3BuN,EAAA,EAAAy/B,EAAY,CAAC,EACbz/B,EAAA,EAAA28B,EAAU,kBAAeA,CAAA,WAGlB95B,GAAY,IACfw9B,EAAa,CACfrgC,EAAA,EAAA28B,EAAU,kBAAeA,CAAA,YAGvBhhC,IAAS,QAAUlJ,EAAmB,CACxCuN,EAAA,EAAAs9B,EAAoB,EAAI,EACxBt9B,EAAA,EAAAvN,EAAsB,EAAK,EAC3BuN,EAAA,EAAAy/B,EAAY,CAAC,EACbz/B,EAAA,EAAA28B,EAAU,kBAAeA,CAAA,aAG3BW,EAAoB3hC,IAAS,aAAa,EAC1CqE,EAAA,EAAAvN,EAAsB,EAAI,EAC1BusC,GAAK,EACLyB,EAAc,iBAGDC,GAAmB,IAE9B/D,EAAU,kBAAoBA,EAAU,kCAIpC8D,EAAc,EAChBJ,EAAa,CACfrgC,EAAA,EAAAy/B,EAAY,CAAC,YAGXvqB,EAAe,QAAU,QAAaA,EAAe,MAAQ,MAEvD,MAAAkrB,EAAiBlrB,EAAe,MAAQ,CAAC,EAAE,KAAI,QAC9CliF,EAAK,CACRA,aAAiB,MACfA,EAAM,OAAS,kBACjB,QAAQ,MACN,gFAAgF,EAGlF,QAAQ,MACN,oDACAA,CAAK,EAIT,QAAQ,MAAM,6BAA8BA,CAAK,EAInDkiF,EAAe,qBAAmB,MAC9BzxB,GAAyB,aAAc,GAAI,EACnDw7C,EAAK,EAAK,kBAGGwB,EAAeE,EAA6B,GAAI,CACzDA,IACFH,QAAoBI,EAAe,GAE5B,QAAAC,EAAW,EAAGA,EAAWnlC,EAAQmlC,IAAQ,CAC1C,MAAAC,GAAuB,SAAS,eACpC,oBAAsBD,CAAQ,EAEhC3lC,GAAkB4lC,GAAsBN,EAAcD,CAAQ,EAEhE,SAAS,cAAcvuB,CAAiB,iBAG3B4uB,GAAe,OACtBpwB,GAAI,EACJ,MAAAuwB,MAA0B,MAAMrlC,CAAM,EAAE,KAAK,CAAC,EAC3C,QAAAmlC,EAAW,EAAGA,EAAWnlC,EAAQmlC,IACxCE,EAAoBF,CAAQ,EAAIG,EAAuBH,CAAQ,SAE1D,KAAK,IAAG,GAAIE,CAAmB,EAG/B,SAAAC,EAAuBH,EAAgB,CAExC,MAAAC,GAAuB,SAAS,eACpC,oBAAsBD,CAAQ,EAE1BI,EAAc,SAAS,eAAe,WAAaJ,CAAQ,EAC3DK,GAAgB,SAAS,eAAe,aAAeL,CAAQ,MAChEC,GAAoB,OACnB,MAAA5tC,GACJ4tC,GAAqB,uBAAuB,cAAc,MACjD,UAAA3tC,MAAgBD,GACzBC,GAAa,UAAU,IAAI,MAAM,EACjCA,GAAa,UAAU,IAAI,gBAAgB,EAC3CA,GACG,iBAA8B,aAAa,EAC3C,QAASx3D,IAAI,CACZA,GAAK,MAAM,QAAU,iBAG3Bu/D,GAAkB4lC,GAAsB,CAAC,QACjC,OAAQK,GAAgB,MAAOC,EAAa,EAClDjB,GAASc,CAAW,GACd,OAAQI,GAAkB,MAAOC,EAAe,EACtDnB,GAASe,EAAa,EAClBK,GAAiBT,GAAqB,YACtCU,GAAkBV,GAAqB,aACvCW,GAA2BF,GAAiBH,GAC5CM,GAA6BH,GAAiBD,GAC9CK,GACJH,IAAmBL,GAAiBE,IAC/B,YAAK,IACV,KAAK,IACHI,GACAC,GACAC,EAAmC,EAErC,EAAQ,EAqBZ,OAAO,SAAQ,KACblB,EAAc,GAGP,SAAAmB,EAAextG,EAAgB,CAClCA,EAAE,MAAQ,KAAG,CAAKA,EAAE,SAAO,CAAKA,EAAE,UACpCA,EAAE,eAAc,EAChBmvF,EAAQ,GAENnvF,EAAE,MAAQ,KAAG,CAAKA,EAAE,SAAO,CAAKA,EAAE,UACpCA,EAAE,eAAc,EAChBivF,GAAS,GAEPjvF,EAAE,MAAQ,cACZA,EAAE,eAAc,EAChBqqG,EAAY,GAEVrqG,EAAE,MAAQ,eACZA,EAAE,eAAc,EAChByuE,EAAY,GAEVzuE,EAAE,MAAQ,MACZA,EAAE,eAAc,EAChBsqG,EAAY,EAAI,GAEdtqG,EAAE,MAAQ,UACZA,EAAE,eAAc,EAChB2qG,EAAiB,GAIZ,SAAAF,EAAkBF,EAAuB,OAC1CljC,EAAiBkjC,GAAmB,aAC1CzpB,EAAe,WAAU,CAAIzZ,EAAcyZ,CAAA,QAC3CA,EAAe,eAAiBzZ,EAAcyZ,CAAA,EAC9C8pB,GAAM,EAAI,WAGHzb,GAAQ,CACfgd,GAAY,IACZE,EAAe,EAAK,WAGbpd,IAAS,CACZkd,EAAW,KACbA,GAAY,KAEdE,EAAe,EAAK,iBAEP1B,GAAiB,CAC9BC,GAAK,EACD1B,IAAsB7qC,GACxBuN,EAAA,EAAAs9B,EAAoB,EAAK,EACzBt9B,EAAA,EAAAvN,EAAsB,EAAI,GACjB6qC,GAAqB7qC,GAC9BuN,EAAA,EAAAs9B,EAAoB,EAAI,EACxBt9B,EAAA,EAAAvN,EAAsB,EAAK,GACjB,CAAA6qC,GAAqB7qC,IAC/BuN,EAAA,EAAAs9B,EAAoB,EAAI,EACxBt9B,EAAA,EAAAvN,EAAsB,EAAI,SAEtB+d,GAAI,EACViwB,EAAc,WAGPxB,EAAK4C,EAAwB,GAAK,IACrCpC,GAAa,KACf58B,EAAY,EAEVg/B,IAAcxB,EAAgB,IAC9B,CAAAA,IAGJrgC,EAAA,EAAAu+B,EAAU,EAAK,EACXkB,IAAc,IAEhBz/B,EAAA,EAAAs9B,EAAoB,EAAI,EACxBt9B,EAAA,EAAAvN,EAAsB,EAAK,EAC3BguC,EAAc,GAEZ,CAAAvrB,EAAe,gBAGfziB,EAAmB,CACrBoQ,EAAY,SAGd,cAAcy9B,CAAwB,EACtCA,EAA2B,OAAO,qBAChCb,IAASA,CAAA,EACLA,GAAa,MACf,cAAca,CAAwB,EACjCprB,EAAe,wBAClBrS,EAAY,IAGfq8B,EAAuB,cAGnBF,GAAM6C,EAAwB,GAAK,CACtC3sB,EAAe,aAGnB,cAAcorB,CAAwB,EACtCtgC,EAAA,EAAAu+B,EAAU,EAAI,EACVsD,IAAcxB,EAAgB,cAG3B3B,EAAYmD,EAAwB,GAAK,CAC5C3sB,EAAe,aAGfqpB,GAAWkB,GAAa,IAC1BR,EAAK4C,CAAY,EAEjB7C,GAAM6C,CAAY,GAIb,SAAArC,GAAasC,EAAsB,CAExCA,EAAiB,GACjBA,EAAiBnF,EAAU,8BAI7BA,EAAU,gBAAkBmF,EAAcnF,CAAA,EAC1C38B,EAAA,EAAAy/B,EAAY,CAAC,YAGNI,GAAa,CACpB7/B,EAAA,EAAAs9B,EAAoB,EAAI,EACxBt9B,EAAA,EAAAvN,EAAsB,EAAK,EAC3BusC,GAAM,EAAI,EACVQ,GAAa,CAAC,0OAnUN,OAAAtqB,EAAe,KAAI,KACpB,GACHvZ,EAAO,iBAEJ,GACHA,EAAO,oBAEJ,GACHA,EAAO,wCAMZ,OACOuhC,EACJP,EAAU,yBAA2BA,EAAU,OAAO,YACxD1gC,EAAQiZ,EAAe,WAAa,MAAMgoB,CAAW,EAAE,KAAI,uBAI1DxhC,EAASwZ,EAAe,QAAU,2BAGpClV,EAAA,EAAEu9B,EAAeZ,EAAU,OAAO1gC,EAAM0gC,EAAU,eAAe,sBAGjE38B,EAAA,EAAEk/B,EACDhqB,EAAe,gBACdqoB,GAAgBA,EAAa,SAAS,UACvC,EAAE,mBAEGZ,EAAU,oBACf+D,EAAmB,oWC9CNxoB,GAAAhY,SAAY,sWAX7BV,EAiBK7qB,EAAAusB,EAAAjmD,CAAA,EAhBH8lD,EAKKG,EAAAJ,CAAA,SACLC,EAMKG,EAAAzB,CAAA,qBACLsB,EAEKG,EAAAC,CAAA,yLAnBM,aAAA2+B,CAAwB,EAAAngC,ySCa1BO,EAAO,GAAC,MAAQ,CAAC,EAGhBh7B,EAAAgC,EAAA,QAAA6qD,EAAA7xB,KAAQ,MAAK,uSAOVA,EAAU,8CAhBzBV,EAkBM7qB,EAAA8G,EAAAxgC,CAAA,EAjBJ8lD,EAgBCtlB,EAAAvU,CAAA,uJAXQg5B,EAAO,GAAC,MAAQ,kBAGfM,EAAA,IAAAuxB,OAAA7xB,KAAQ,MAAK,8TAOVA,EAAU,oGAzBZ,GAAA79D,CAAU,EAAAs9D,EACV,KAAA5oE,EAAc,CAAC,EAAA4oE,EACf,KAAA3oE,EAAc,GAAG,EAAA2oE,GACjB,MAAA/sE,CAAa,EAAA+sE,EACb,YAAAyS,EAAsB,EAAK,EAAAzS,EAEhC,MAAAqR,EAAWC,GAAqB,mDAWlBD,EAAS,SAAUp+E,CAAK,gdCoGhC4sE,EAAoC7qB,EAAA8G,EAAAxgC,CAAA,+DALd,eACT,kBACTilD,EAAiB,oDADRV,EAEb7qB,EAAA8G,EAAAxgC,CAAA,4BADIilD,EAAiB,0DA0CtB+Y,EAAA/Y,MAAS,GAAE,OAAKmyB,EAAAnyB,MAAS,MAAK,uHAIDA,EAAC,UACrBA,EAAQ,IAAC,UAAY,GACd,aAAAA,MAAkBA,EAAkB,oHASnBA,EAAC,IACzB,MAAAA,MAAS,uIAhBN,KAAG,yYAVNh7B,EAAAuW,EAAA,QAAAsmD,GAAA7hC,KAAyB,OAAS,GAC1CA,EAAwB,GAAC,OAASA,KAAU,QAC5CA,EAAwB,GAAC,SAASA,EAAC,KAC/B,GACA,aAAW,oVATrBV,EAkDI7qB,EAAAqtD,EAAA/mF,CAAA,EAjDF8lD,EAeIihC,EAAAC,CAAA,EAZFlhC,EAUMkhC,EAAAxmD,CAAA,EAHJslB,EAEItlB,EAAAqpB,CAAA,qCAIR/D,EAUIihC,EAAAE,CAAA,qBACJnhC,EASIihC,EAAAG,CAAA,qBACJphC,EAWIihC,EAAAI,CAAA,EAVFrhC,EASQqhC,EAAA9hC,CAAA,uDA3CE,CAAA3vD,GAAA6vD,EAAA,GAAAuhC,QAAA7hC,KAAyB,OAAS,GAC1CA,EAAwB,GAAC,OAASA,KAAU,QAC5CA,EAAwB,GAAC,SAASA,EAAC,KAC/B,GACA,aAAW,2BAMhB,CAAAvvD,GAAA6vD,EAAA,IAAAyY,OAAA/Y,MAAS,GAAE,KAAAsE,GAAA0U,EAAAD,CAAA,GAAK,CAAAtoE,GAAA6vD,EAAA,IAAA6xB,OAAAnyB,MAAS,MAAK,KAAAsE,GAAAguB,EAAAH,CAAA,2BAKrBnyB,EAAQ,IAAC,UAAY,IACdM,EAAA,KAAA6hC,EAAA,aAAAniC,MAAkBA,EAAkB,yBAU3CM,EAAA,IAAA8hC,EAAA,MAAApiC,MAAS,oMA5EjBmkB,EAAAnkB,KAAyB,OAAM,OAASk8B,EAAAl8B,KAAU,OAAM,uCAoCpBA,EAAqB,gDApBrDA,GAAkB,MAAAG,2BA4BvBH,EAAS,4BAAd,OAAInoE,IAAA,4IAnDJ;AAAA,WAEE,kBAIA,GACG,aAAiC,SAAO,aAAkB,GAC7D,iCAQqD,oBAErD,8GAwBA,SACS,gNAtCNmoE,EAAwB,GAAC,OAAS,EAAI,GAAK,YAAW,8JAW5CA,EAAkB,GAAG,aAAe,EAAE,k+BArC7DV,EA+HK7qB,GAAA0sB,EAAApmD,EAAA,EA1HH8lD,EAyHOM,EAAA7qB,CAAA,EAnHLuqB,EA2DOvqB,EAAA+rD,CAAA,EAvDLxhC,EAsDIwhC,EAAAP,CAAA,EArDFjhC,EAcIihC,EAAAQ,CAAA,SAPFzhC,EAMMyhC,EAAAje,CAAA,4CAERxjB,EAqBIihC,EAAAS,CAAA,EAfF1hC,EAEK0hC,EAAA3hC,CAAA,gBACLC,EAWK0hC,EAAAhjC,CAAA,qBAEPsB,EAcIihC,EAAAU,CAAA,EARF3hC,EAA8B2hC,EAAAvhC,CAAA,SAC9BJ,EAMK2hC,EAAAxhC,CAAA,SAFIH,EACPG,EAAAsjB,CAAA,iBAGJzjB,EAAQihC,EAAAW,CAAA,SAGZ5hC,EAsDOvqB,EAAAosD,EAAA,iFAjGG,CAAAjyF,GAAA6vD,GAAA,IAAA6jB,OAAAnkB,MAAyB,OAAM,KAAAsE,GAAAigB,EAAAJ,CAAA,GAAS,CAAA1zE,GAAA6vD,GAAA,IAAA47B,OAAAl8B,MAAU,OAAM,KAAAsE,GAAA23B,EAAAC,CAAA,iHAFzDl8B,GAAwB,GAAC,OAAS,EAAI,GAAK,iDAWjCA,GAAkB,GAAG,aAAe,8GA2BTA,GAAqB,UAAAsE,GAAAq+B,EAAAC,CAAA,eAQ1D5iC,GAAS,yBAAd,OAAInoE,IAAA,oIAAJ,OAAIA,GAAAq2E,GAAA,OAAAr2E,IAAA,8CAAJ,OAAIA,IAAA,0JAxIC,UAAAunE,CAAqB,EAAAK,GACrB,yBAAAojC,CAAkC,EAAApjC,GAClC,mBAAA6+B,CAA2B,EAAA7+B,GAC3B,gBAAAi9B,CAAwD,EAAAj9B,GACxD,eAAAlE,CAAkC,EAAAkE,GAClC,OAAAkd,CAAuC,EAAAld,EAC9CqjC,EAAoB,aAoBfC,GAAgB,CACnB,IAAAC,EAAM,EACE,UAAAnrG,EAAG1B,CAAQ,IAAKipE,EAAU,QAAO,EAEzCyjC,IAA6B,QAC7BA,EAAyB,OAAS,EAE9BA,EAAyB,SAAShrG,CAAC,IACrCmrG,IACGznC,GAAkBplE,EAAS,UAAY,IAAMA,EAAS,aAG3D6sG,IACGznC,GAAkBplE,EAAS,UAAY,IAAMA,EAAS,mBAGtD6sG,WAGAC,EAAkBprG,EAAWnF,EAAa,CACjDotE,EAAA,EAAAV,EAAUvnE,CAAC,EAAE,YAAcnF,EAAK0sE,CAAA,EAChCzZ,GAAgB,OAAQxuD,IACtBA,EAAOU,CAAC,EAAE,YAAcnF,EACjByE,IAETulG,EAAe,WAGRwG,EAAerrG,EAAWnF,EAAa,CAC9CotE,EAAA,EAAAV,EAAUvnE,CAAC,EAAE,SAAWnF,EAAK0sE,CAAA,EAC7BzZ,GAAgB,OAAQxuD,IACtBA,EAAOU,CAAC,EAAE,SAAWnF,EACdyE,IAETulG,EAAe,aAmGQxoG,IAAC,OACN+8E,EAAW/8E,EAAE,OACnBgvG,EAAerrG,EAAGo5E,CAAQ,QAQf/8E,IAAC,OACNqD,EAAcrD,EAAE,OACtB+uG,EAAkBprG,EAAGN,CAAW,GASjBkvF,EAAA5uF,GAAA8kF,EAAO9kF,CAAC,iVA5KlCsrG,EAAqB,KAClB,IAAAH,EAAM,EACE,UAAAnrG,EAAG1B,CAAQ,IAAKipE,EAAU,QAAO,EACvCyjC,EAAyB,OAAS,EAChCA,EAAyB,SAAShrG,CAAC,IACrCmrG,GAAO7sG,EAAS,aAGlB6sG,GAAO7sG,EAAS,mBAGb6sG,kBAGF5jC,GAAaA,EAAU,OAAS,OACrC0jC,EAAoBhuC,GAAmBiuC,EAAgB,0SCQtD/iC,EAAK,0CAxBaA,EAAE,2BAIlBh7B,EAAAgC,EAAA,QAAA6qD,EAAA,qEAAA7xB,EAAA,GACC,2CACA,kBAAgB,2MAOTA,EAAU,aAGfA,EAAE,IAGLh7B,EAAAo+D,EAAA,QAAAC,EAAA,sEAAArjC,EAAA,GACC,uCACA,uDAAqD,KACtDA,EAAS,GAAG,gBAAkB,aAAY,4EAzBjDV,EA6BK7qB,EAAAt8B,EAAA4C,CAAA,EA5BH8lD,EAgBC1oD,EAAA6uB,CAAA,YAHgBg5B,EAAS,UAI1Ba,EAUO1oD,EAAAirF,CAAA,yHAzBcpjC,EAAE,IAIlBM,EAAA,GAAAuxB,OAAA,qEAAA7xB,EAAA,GACC,2CACA,kBAAgB,iOAOTA,EAAU,oBAFNA,EAAS,cAavBA,EAAK,mBARAA,EAAE,IAGLM,EAAA,GAAA+iC,OAAA,sEAAArjC,EAAA,GACC,uCACA,uDAAqD,KACtDA,EAAS,GAAG,gBAAkB,2FAjCxB,GAAA79D,CAAU,EAAAs9D,GACV,UAAA6jC,CAAkB,EAAA7jC,EAClB,YAAAyS,EAAsB,EAAK,EAAAzS,GAC3B,MAAA/5C,CAAa,EAAA+5C,EAElB,MAAAqR,EAAWC,GAAqB,eAiBrBuyB,EAAS,gCACNxyB,EAAS,SAAUwyB,CAAS,uXCiBhCtjC,EAAkB,sHASlBA,EAAoB,GACnB,WAAAA,EAAS,GAAC,SAAW,GAAKA,EAAkB,mIASjDA,EAAsB,GAChB,YAAAA,MAAwBA,EAAkB,ibAlC9DV,EAyCK7qB,EAAAwsB,EAAAlmD,CAAA,EApCH8lD,EAKKI,EAAAL,CAAA,SACLC,EA6BKI,EAAA1B,CAAA,gGA1BWS,EAAkB,4CASlBA,EAAoB,IACnBM,EAAA,IAAAijC,EAAA,WAAAvjC,EAAS,GAAC,SAAW,GAAKA,EAAkB,uCASjDA,EAAsB,IAChBM,EAAA,KAAAkjC,EAAA,YAAAxjC,MAAwBA,EAAkB,iNAzDjD,UAAAZ,CAAqB,EAAAK,GACrB,mBAAA6+B,CAA2B,EAAA7+B,GAC3B,iBAAAgkC,CAAuD,EAAAhkC,GACvD,eAAAlE,CAAkC,EAAAkE,GAClC,qBAAAikC,CAAkE,EAAAjkC,EAEzEkkC,EAAyBpoC,GAAkB,GAC3CqoC,IAAyBroC,EACpB,SAAAsoC,EAAiCC,EAAgC,CACxEhkC,EAAA,EAAA8jC,EAAuBE,CAAuB,EAE5CJ,EADEE,EACmBD,EAEA,MAFsB,EAMtC,SAAAI,EAA6BC,EAAyB,CAC7DlkC,EAAA,EAAA6jC,EAAyBK,CAAiB,EAC1CN,EAAqBM,CAAiB,UAoBvB9vG,GAAC,OACNovG,EAAYpvG,EAAE,OACpBuvG,EAAiBH,CAAS,KAQfpvG,GAAC,OACNovG,EAAYpvG,EAAE,OACpB2vG,EAAiCP,CAAS,KAO/BpvG,GAAC,OACNyvG,EAAyBzvG,EAAE,OACjC6vG,EAA6BJ,CAAsB,ymBC/CpC3jC,EAAU,0BAAVA,EAAU,6FAOpB,iCACS,eACFA,EAAU,mNAMd,qCACM,eACFA,EAAU,kTA3B9BV,EA8BK7qB,EAAAusB,EAAAjmD,CAAA,EA7BH8lD,EAKKG,EAAAJ,CAAA,SACLC,EAMKG,EAAAzB,CAAA,qBACLsB,EAeKG,EAAAC,CAAA,sFAnBgBjB,EAAU,0DASbA,EAAU,6CAQVA,EAAU,6MA9BxB,IAAAikC,EAAsB,iBAaLA,EAAUvxG,sLCWdstE,EAAiB,WAHXA,EAAS,8BAATA,EAAS,4JAOlBA,EAAe,uTAf/BV,EAKK7qB,EAAAmsB,EAAA7lD,CAAA,WACLukD,EAgBK7qB,EAAA8qB,EAAAxkD,CAAA,0FAdoBilD,EAAS,wDAOlBA,EAAe,kLA5BlB,UAAAkkC,CAA4B,EAAAzkC,GAC5B,gBAAA0kC,CAAuD,EAAA1kC,GACvD,gBAAA7D,CAAwB,EAAA6D,GACxB,sBAAA2kC,CAAyD,EAAA3kC,QAE9D4kC,EAAiB,CACnB,OAAO,kBAAmB,MAAO,CAAC,EAClC,OAAO,YAAa,MAAO,CAAC,EAC5B,OAAO,aAAc,MAAO,CAAC,EAC7B,OAAO,cAAe,MAAO,CAAC,iBAYXH,EAASxxG,SACV,MAAA4xG,EAAA,IAAAH,EAAgBD,CAAS,IAQhChwG,GAAC,OACNovG,EAAYpvG,EAAE,OACpBkwG,EAAsBd,CAAS,gdCrBrBtjC,EAAkB,8PATlCV,EAgBK7qB,EAAA8qB,EAAAxkD,CAAA,EAfH8lD,EAKKtB,EAAAqB,CAAA,iEAGSZ,EAAkB,2HAbrB,mBAAAukC,CAA2B,EAAA9kC,GAC3B,qBAAA+kC,CAA2D,EAAA/kC,UAcvDvrE,GAAC,OACNovG,EAAYpvG,EAAE,OACpBswG,EAAqBlB,CAAS,wSCgCvBmB,EAAAzkC,KAAU,OAAM,sFA3BbA,EAAmB,cAClBA,EAAS,GAAC,SAAW,8IAW1BA,EAAS,GAAC,OAAS,QACjBA,EAAsB,eAChBA,EAAsB,0DAnBxC,iCAEA,iFA6BE,QACQ,4GAjCLA,EAAS,GAAC,SAAW,EAAI,kBAAoB,mBAAkB,EA6B7Dh7B,EAAAuW,EAAA,QAAAsmD,EAAA,sEAAA7hC,EAAA,GACC,yCACA,uCAAsC,4DAnChDV,EAwCK7qB,EAAAwsB,EAAAlmD,CAAA,EAvCH8lD,EAMKI,EAAAL,CAAA,mCAYLC,EAoBKI,EAAA1B,CAAA,qBATHsB,EAQMtB,EAAAhkB,CAAA,qIAlCHykB,EAAS,GAAC,SAAW,EAAI,kBAAoB,oEAOnCA,EAAS,GAAC,SAAW,oCAW1BA,EAAS,GAAC,OAAS,iBACjBA,EAAsB,wBAChBA,EAAsB,eAa7B,CAAAvvD,GAAA6vD,EAAA,IAAAmkC,OAAAzkC,KAAU,OAAM,KAAAsE,GAAAogC,EAAAD,CAAA,GAJpB,CAAAh0F,GAAA6vD,EAAA,GAAAuhC,OAAA,sEAAA7hC,EAAA,GACC,yCACA,kNA7CG,UAAAZ,CAAqB,EAAAK,GACrB,yBAAAojC,CAAkC,EAAApjC,GAClC,gCAAAklC,CAEF,EAAAllC,EAEH,MAAAmlC,EAA+B/B,EAAyB,OAAS,MACnEgC,EAAiChC,EAAyB,eAgB/C3uG,GAAC,OACNovG,EAAYpvG,EAAE,WACpB2wG,EAAyBvB,EAAYlkC,EAAU,OAAS,EAAI,GAC5DulC,EAAgCE,CAAsB,KASzC3wG,GAAC,OACN2wG,EAAyB3wG,EAAE,OACjCywG,EAAgCE,CAAsB,qeCM9C7kC,EAA4B,kJAU1BA,EAA4B,eAC1BA,EAA4B,oJAUhCA,EAAmB,6IASnBA,EAAW,2HAcTA,EAAW,gBAEVA,EAAe,8BADTA,EAAI,+BAAJA,EAAI,mKAUbA,EAAsB,qaAhEtCV,EAuEK7qB,EAAAwsB,EAAAlmD,CAAA,EAtEH8lD,EAKKI,EAAAL,CAAA,4BAULC,EAWKI,EAAA1B,CAAA,uIAlBSS,EAA4B,6CAU1BA,EAA4B,yBAC1BA,EAA4B,2CAUhCA,EAAmB,6CASnBA,EAAW,+CAcTA,EAAW,sCACJA,EAAI,2DAUbA,EAAsB,kVAlGzB,iBAAAkgC,CAKV,EAAAzgC,GACU,oBAAA/D,CAA4B,EAAA+D,GAC5B,MAAA5D,CAAwB,EAAA4D,GACxB,WAAAqlC,CAAqC,EAAArlC,GACrC,0BAAAslC,CAAiE,EAAAtlC,GACjE,WAAAulC,CAA8C,EAAAvlC,GAC9C,6BAAAwlC,CAEF,EAAAxlC,GACE,6BAAAylC,CAAqC,EAAAzlC,GACrC,6BAAA0lC,CAAqC,EAAA1lC,GACrC,uBAAA9D,CAA+B,EAAA8D,QAEpC2lC,EAAe,CACjB,OAAO,QAAS,MAAO,CAAC,EACxB,OAAO,QAAS,MAAO,CAAC,EACxB,OAAO,QAAS,MAAO,CAAC,EACxB,OAAO,QAAS,MAAO,CAAC,OAGxBC,EAAcxpC,EAAQ,QAGpBypC,EAAgB,KAAK,IAAIzpC,EAAQ,EAAG,CAAC,EACvC,IAAA0pC,EAAsBtsC,GAAqBqsC,CAAa,EACxDA,EACA,UAcWpxG,GAAC,OACNovG,EAAYpvG,EAAE,OACpB4wG,EAAWxB,EAAY,EAAI,CAAC,KASfpvG,GAAC,OACNovG,EAAYpvG,EAAE,OACpB4wG,EAAWxB,EAAY,EAAI,CAAC,KAQnBpvG,GAAC,OACNovG,EAAYpvG,EAAE,OACpB6wG,EAA0BzB,CAAS,KAOxBpvG,GAAC,CACMA,EAAE,QAElBgsG,EAAiBqF,CAAI,EAAE,KAAI,EAC3BP,EAAWO,CAAI,GAEfP,IAAa,iBAOIO,EAAI7yG,uBAIvBwtG,EAAiBqF,CAAI,EAAE,KAAI,EAC3BP,EAAWO,CAAI,KAOJrxG,GAAC,OACNovG,EAAYpvG,EAAE,OACpB+wG,EAA6B3B,CAAS,4mBA5EzCxjC,EAAA,EAAEulC,EAAcxpC,EAAQ,CAAC,ggBCsFfmE,EAAkB,uEAUXA,EAAc,GAAC,QAAU,uBAEjB,kBAAAA,KAAe,sFAKX,sBAAAA,KAAe,0BAC/BA,EAAc,GAAC,OAAS,oIAKDA,EAAc,GAAC,OAAS,GACrDA,EAAc,GAAC,OAAS,+BACKA,EAAc,GAAC,OAAS,EAC5B,yBAAAA,KAAe,2CAGpB,oBAAAA,KAAe,sEAKV,yBAAAA,KAAe,QAAM,wFAazB,qBAAAA,KAAe,kCAErB,eAAAA,KAAe,6EASP,qBAAAA,KAAe,gCAErB,eAAAA,KAAe,eACL,yBAAAA,KAAe,QAAM,+rCAvE1DV,EA4FK7qB,EAAAw+B,EAAAl4D,CAAA,qBAhFH8lD,EA+EKoS,EAAA9R,CAAA,EA1EHN,EA+BKM,EAAAP,CAAA,oHAELC,EAwCKM,EAAAH,CAAA,qBA5BHH,EA2BKG,EAAAC,CAAA,qBAfHJ,EAcKI,EAAA1B,CAAA,EAbHsB,EAYQtB,EAAAa,CAAA,+CAJK4X,GAAAhY,SAAc,qDACZgY,GAAAhY,SAAc,4EA1E1BA,EAAkB,gGAUXA,EAAc,GAAC,QAAU,GAEjBM,EAAA,KAAAklC,EAAA,kBAAAxlC,KAAe,qEAKXM,EAAA,KAAAmlC,EAAA,sBAAAzlC,KAAe,oCAC/BA,EAAc,GAAC,OAAS,yCAKDA,EAAc,GAAC,OAAS,GACrDA,EAAc,GAAC,OAAS,yCACKA,EAAc,GAAC,OAAS,GAC5BM,EAAA,KAAAmlC,EAAA,yBAAAzlC,KAAe,8CAGpBM,EAAA,KAAAolC,GAAA,oBAAA1lC,KAAe,uDAKVM,EAAA,KAAAqlC,EAAA,yBAAA3lC,KAAe,QAAM,mDAazBM,EAAA,KAAAslC,GAAA,qBAAA5lC,KAAe,YAErBM,EAAA,KAAAslC,GAAA,eAAA5lC,KAAe,8DASPM,EAAA,KAAAulC,EAAA,qBAAA7lC,KAAe,0CAErBM,EAAA,KAAAulC,EAAA,eAAA7lC,KAAe,gBACLM,EAAA,KAAAulC,EAAA,yBAAA7lC,KAAe,QAAM,4iBAhK7C,UAAAZ,CAAqB,EAAAK,GACrB,gBAAAi9B,CAAwD,EAAAj9B,GACxD,iBAAAygC,CAKV,EAAAzgC,GACU,eAAAqmC,CAA0B,EAAArmC,GAC1B,aAAAmgC,CAAwB,EAAAngC,GACxB,SAAAsmC,CAAoB,EAAAtmC,EAE3BumC,EACAC,EAMK,SAAAtB,EAAgCuB,EAAiC,KACpEC,EAEFD,EAA4B,GAC5BA,EAA4B9mC,EAAU,SAEtC+mC,MACKhoG,GAAoBihE,EAAU,OAAQ8mC,CAAyB,GAClE,MAAM5tG,EAAGC,IAAMD,EAAIC,CAAC,GAExB0tG,EAAoCC,EACpCE,EAAaD,CAAS,EAGf,SAAAhC,EAAgB3oC,EAAyB,OAChDwZ,EAAe,OAASxZ,EAAMwZ,CAAA,EAGvB,SAAA8vB,EAAWrpC,EAAe,OACjCuZ,EAAe,KAAOvZ,EAAIuZ,CAAA,EAGnB,SAAA+vB,EAA0BrpC,EAA4B,OAC7DsZ,EAAe,oBAAsBtZ,EAAmBsZ,CAAA,EAGjD,SAAAiwB,EAA6BtpC,EAA+B,OACnEqZ,EAAe,uBAAyBrZ,EAAsBqZ,CAAA,EAGvD,SAAAgwB,EAAWO,EAAwB,OACpCloC,EAAiBkoC,EAAO,EAC1BrsC,GAAqBmE,CAAc,SACrC2X,EAAe,MAAQ3X,EAAc2X,CAAA,EAIhC,SAAAwvB,EAAqBD,EAA2B,OACvDvvB,EAAe,QAAO,CAAIuvB,EAAkBvvB,CAAA,EAC5C0nB,EAAe,EAGR,SAAA0J,EAAavD,EAA8C,OAClE7tB,EAAe,OAAS6tB,EAAwB7tB,CAAA,EAChD0nB,EAAe,EAGR,SAAA+G,EAAiBnF,EAA2B,OACnDtpB,EAAe,WAAaspB,EAAkBtpB,CAAA,EAGvC,SAAA0uB,EAAqBnoC,EAAkC,OAC9DyZ,EAAe,eAAiBzZ,EAAcyZ,CAAA,EAGvC,SAAAovB,EAAsBxoC,EAAwB,OACrDoZ,EAAe,gBAAkBpZ,EAAeoZ,CAAA,EAGzC,SAAA2H,EAAO9D,EAAqB,CACnCzZ,EAAU,OAAOyZ,EAAe,CAAC,EAC7BzZ,EAAU,SAAW,GACvB2mC,EAAQ,EAEVpB,EAAgCsB,CAAiC,EACjEvJ,EAAe,mDAqECsJ,EAA0BjiC,gUA1IrCiiC,GACLhrC,GAAkBgrC,CAA0B,yOCsQvChmC,EAAS,GAAC,kBAAe,IAAOC,GAAAD,CAAA,IA4BhCA,EAAS,GAAC,gBAAe,IAAKE,GAAAF,CAAA,2GA5B9BA,EAAS,GAAC,kBAAe,4GA4BzBA,EAAS,GAAC,gBAAe,2kBA3BvB,OAAAA,OAAU,QAAO,EAcZA,OAAU,YAAW;;;;8nBAvB9BA,EAAc,GAAC,IAAM,YAAcA,EAAS,GAAC,OAAO,OAAS,EAAC,6EADhCh7B,EAAA7sB,EAAA,QAAAsqD,EAAA,aAAAzC,EAAS,GAAC,SAAW,OAAS,GAAE,UAArEV,EA8CK7qB,EAAAt8B,EAAA4C,CAAA,sKA9CgC,CAAAtK,GAAA6vD,EAAA,IAAAmC,OAAA,aAAAzC,EAAS,GAAC,SAAW,OAAS,oFAvIxD,SAAAqmC,GAAiBC,EAAkB,CAEpC,MAAA3I,MADa,UAAS,EACT,gBAAgB2I,EAAY,WAAW,EACpDC,EAAuB5I,EAAI,iBAAiB,kBAAkB,EAC9D6I,EAAoB7I,EAAI,iBAAiB,YAAY,EACrD3qC,EAAa,IAAOuzC,EAAoB,GAAKC,CAAiB,EAC9DC,EAAO,MAAM,KAAKzzC,CAAa,EAAE,IACpC1b,GAAcA,EAAU,SAAS,EAE9B9wC,EAAOkgG,GAAoB/I,EAAI,KAAK,UAAW8I,CAAI,EAEvD,YAAAA,EACA,KAAAjgG,CAAI,WAICkgG,GAAoBC,EAAuB3zC,EAAuB,CACrE,IAAA4zC,EAA+BD,EACnC,OAAA3zC,EAAc,QAASC,GAAY,CACjC2zC,EAA+BA,EAA6B,QAC1D3zC,EACA,EAAE,IAGC2zC,WAsCAC,GAAYvuG,EAAaC,EAAW,CACvC,GAAAD,EAAE,SAAWC,EAAE,aAAe,WACzBV,EAAI,EAAGA,EAAIS,EAAE,OAAQT,IACxB,GAAAS,EAAET,CAAC,IAAMU,EAAEV,CAAC,QAAU,SAErB,8HAzLHqoG,EAAgB,CACpB,EAAC,IAAM,MAAM,uCAAuC,EACpD,EAAC,IAAM,MAAM,uCAAuC,EACpD,EAAC,IAAM,MAAM,uCAAuC,EACpD,EAAC,IAAM,MAAM,uCAAuC,GAGlD,IAAA1gC,EAAkB,MAClBJ,EAAS,GACTq9B,EAAS,CACX,OAAM,GACN,mBACA,wBAAyB,GAO3B/8B,GAAO,UACDonC,IAAkB,QAAShnC,EAAA,EAAEN,EAAQ,OAAO,EAChDxqE,GAAQ,IAAM,OACd,SAAS,iBAAiB,gBAAiB0kF,CAAW,EACtD5Z,EAAA,EAAAV,QAAkBD,GAA+B,GACjDu9B,EAAgB,GAAO,EAAI,IAG7B75B,GAAS,KACP,SAAS,oBAAoB,gBAAiB6W,CAAW,mBAG5CA,GAAW,CACxBgjB,EAAgB,EAAI,EAGP,eAAAA,EACbqK,EAAsB,GACtBC,EAAsB,GAAK,CAEvBD,GAAqBE,EAAiB7nC,CAAS,EAC/C4V,EAAe,IAAM,YAAYkyB,EAAoB,EACzDF,EACI5rC,GAAoC,EACpC+rC,EAAqB/nC,CAAS,EAClCjE,GAAqCme,CAAgB,EAG9C,SAAA2tB,EAAiBG,EAAwB,aAC1CC,EAAM,GACN7L,EAAWxmB,EAAe,QAAU,EACtC,IAAAuoB,EAA0B,EAClB,UAAA3jG,EAAG4qD,CAAQ,OAAS4iD,CAAY,EAAE,UAAO,CACnDE,EAAO9iD,CAAQ,QACT+iD,KAAazyG,EAAAkgF,EAAe,SAAf,YAAAlgF,EAAuB,SAAS8E,KAAM,GACrD2tG,KAAYhK,GAA2B/4C,EAAS,eAAe,gBAC1D3sD,EAAI,EAAGA,EAAI2sD,EAAS,eAAe,OAAQ3sD,IAAC,CAC7C,MAAAolG,EAAK,CACT,SAAAz4C,EACA,WAAA+iD,GACA,KAAI,IAEG,QAAAC,GAAQ,EAAGA,GAAQhM,EAAUgM,KAAK,CACrCvuC,GAAqBuuC,EAAK,EAC5BF,EAAO9iD,EAAUgjD,EAAK,EAEtB/8C,YAAgB+8C,EAAK,+CAEjBttG,EAAW04D,GACfpO,EAAS,SAAWA,EAAS,aACzB;AAAA,EAAOA,EAAS,SAAWA,EAAS,aACpC,EAAE,EAEF9L,GAAWka,GAAuBpO,EAAS,eAAe3sD,CAAC,GAC3DyqD,EAAasQ,GACjBpO,EAAS,iBAAiB3sD,CAAC,IAErB,KAAM4vG,EAAc,KAAMC,CAAY,EAC5CrB,GAAiB3tD,EAAQ,GACnB,KAAMivD,GAAc,KAAMC,CAAY,EAC5CvB,GAAiBnsG,CAAQ,GACnB,KAAM2tG,GAAgB,KAAMC,EAAc,EAChDzB,GAAiB/jD,CAAU,EAC7B26C,EAAM,KAAK,KAAI,CACb,SAAA/iG,EACA,SAAAw+C,GACA,WAAA4J,EACA,aAAAqlD,GACA,aAAAC,EACA,aAAAH,EACA,aAAAC,EACA,eAAAG,GACA,eAAAC,KAGJT,EAAO,KAAKpK,CAAK,OAGrBR,EAAS,CACP,OAAA4K,EACA,mBACA,wBAAyB9J,GAA2B8J,EAAO,kBAItDC,EAAO9iD,EAAoBgjD,EAAqB,OACnDhjD,EAAS,OAAS,SAAWA,EAAS,KAAOsW,GAAoB,SAC/DitC,EAAevjD,EAAS,KAC1BgjD,IAAU,QAAaA,EAAQ,IACjChjD,EAAS,KAAOA,EAAS,KAAO,OAAOgjD,CAAK,GAC1ChjD,EAAS,eAAiB,SAC5BkO,GAA6BlO,EAAU,EAAK,GAE5CvhB,GAAWuhB,EAAS,KAAI,CAAI,OAAQ,EAAI,IACxC1vD,EAAA0vD,EAAS,yBAAT,MAAA1vD,EAAA,KAAA0vD,IAEFA,EAAS,KAAOujD,WA8BTb,GAAoB,CAGrB,MAAAc,EADJhzB,EAAe,QAAUA,EAAe,OAAO,OAAS,EAEtDizB,EAA2B,EACvB,UAAMxL,EAAU,OAAO,MAAM,EAAE,MAAI,EACvC,IAAA1gC,EACAiZ,EAAe,OAASA,EAAe,MAAM,OAAS,IACxDjZ,EAAQiZ,EAAe,MAAM,MAAM,EAAGgzB,EAAgB,MAAM,IAG3DhzB,EAAe,QAAUA,EAAe,OAAO,OAAS,GACxDA,EAAe,OACdA,EAAe,MAAM,OAASgzB,EAAgB,UAEhDjsC,EAAQisC,GAENhzB,EAAe,UAEd,CAAAA,EAAe,OAChBA,EAAe,MAAM,SAAW,GAChC6xB,GAAY7xB,EAAe,MAAOgzB,CAAe,EAEjDjsC,EAAQzkE,GAAQ0wG,CAAe,EAE3BhzB,EAAe,MAAM,QAAUgzB,EAAgB,OACjDjsC,EAAQiZ,EAAe,MAAM,MAAM,EAAGgzB,EAAgB,MAAM,EAE5DjsC,EAAQzkE,GAAQ0wG,CAAe,SAIrChzB,EAAe,MAAQjZ,EAAKiZ,CAAA,WAWrBizB,GAA2B,OAC5BlwD,EAAO,GACD,UAAAlgD,EAAGolG,CAAK,OAASR,EAAU,MAAM,EAAE,UACzCQ,EAAM,YACRllD,EAAQ,KAAKlgD,CAAC,SAGXkgD,EAGA,SAAAovD,EAAqBC,EAAwB,OAChD,GAAAA,EAAa,SAAWnpE,GAAI0nB,EAAe,EAAE,OAE/CA,GAAgB,OAAQxuD,IACtBA,EAAO,QAAO,CAAE2uD,EAAOjuD,IAAC,SAEpBiuD,EAAM,MACNA,EAAM,SAAShxD,EAAAsyG,EAAavvG,CAAC,EAAE,OAAhB,YAAA/C,EAAsB,UAAU,EAAG,MAElDgxD,EAAM,MAAOjxD,EAAAuyG,EAAavvG,CAAC,EAAE,OAAhB,YAAAhD,EAAsB,UAAU,EAAG,MAE7CsC,eAIH0lG,EAAS,GACJ,UAAA1mG,KAAYixG,EACrBvK,EAAU,KAAI,CACZ,GAAI1mG,EAAS,oBAAsB,IAAM,IACzC,KAAMA,EAAS,KACf,GAAIA,EAAS,GACb,MAAMrB,EAAAqB,EAAS,OAAT,YAAArB,EAAe,UAAU,EAAG,GAClC,YAAaqB,EAAS,YACtB,SAAUA,EAAS,SACnB,IAAK4kE,GAAkB5kE,EAAS,GAAG,EACnC,KAAM4kE,GAAkB5kE,EAAS,IAAI,EACrC,KAAM4kE,GAAkB5kE,EAAS,IAAI,EACrC,KAAM4kE,GAAkB5kE,EAAS,IAAI,EACrC,KAAM4kE,GAAkB5kE,EAAS,IAAI,IAGzCwvD,GAAgB,IAAIk3C,CAAS,YAIxBiJ,GAAc,CACrBpJ,EAAgB,EAAI,QACpB1nB,EAAe,EAAI,YAAWA,CAAA,MAC9BynB,EAAU,gBAAkB,EAACA,CAAA,WAGtBX,GAAc,OACrB9mB,EAAe,EAAI,YAAWA,CAAA,MAC9BynB,EAAU,gBAAe,GAAKA,CAAA,WAGvBsJ,GAAQ,OACf/wB,EAAe,EAAI,GAAEA,CAAA,WAGd4qB,GAAY,OACnB5qB,EAAe,EAAI,WAAUA,CAAA,eAwBnBlV,EAAA,EAAAN,EAAQ,KAAI,2FAlQjBwV,EAAe,IAAM,YAAc5V,EAAU,OAAS,GAC3Ds9B,EAAgB,EAAI,gBACfl9B,IAAU,QAAQsmC,EAAc,4JCkjBZ,MAAAoC,EAAAC,KAAUA,EAAO,mxBA3BoB,iCACpB,MAACnoC,EAAO,QAAC,GAC7C,6hCAlDFV,EAmDK7qB,GAAA0sB,EAAApmD,CAAA,EAlDH8lD,EAEIM,EAAAue,CAAA,SACJ7e,EA2CKM,EAAAH,CAAA,EA1CHH,EAaKG,EAAAJ,CAAA,EAZHC,EAEOD,EAAAwnC,CAAA,SACPvnC,EAOCD,EAAA6xB,CAAA,OALazyB,EAAQ,WAMtBa,EAA2CD,EAAAyjB,CAAA,SAE7CxjB,EAaKG,EAAAzB,CAAA,EAZHsB,EAEOtB,EAAA8oC,CAAA,SACPxnC,EAOCtB,EAAAmzB,CAAA,OALa1yB,EAAO,WAMrBa,EAA2CtB,EAAA+kB,CAAA,SAE7CzjB,EAaKG,EAAAC,CAAA,EAZHJ,EAEOI,EAAAqnC,CAAA,SACPznC,EAOCI,EAAA0xB,CAAA,OALa3yB,EAAO,WAMrBa,EAA2CI,EAAAo6B,CAAA,SAG/Cx6B,EAEGM,EAAA/8C,CAAA,iIAvCe47C,GAAQ,SAARA,GAAQ,2BAcRA,GAAO,SAAPA,GAAO,4BAcPA,GAAO,SAAPA,GAAO,mBAUYA,GAAO,yEAyBvCA,EAAc,yBAAnB,OAAInoE,GAAA,kkBADRynE,EAqJK7qB,EAAAmsB,EAAA7lD,CAAA,4DAGLukD,EAUK7qB,EAAA8qB,EAAAxkD,CAAA,EATH8lD,EAKQtB,EAAAa,CAAA,SACRS,EAEGtB,EAAAn7C,CAAA,qBAPS47C,EAAgB,wCAzJrBA,EAAc,sBAAnB,OAAInoE,GAAA,qHAAJ,0YAZJynE,EAQK7qB,EAAAt8B,EAAA4C,CAAA,wNAdLukD,EAIK7qB,EAAAt8B,EAAA4C,CAAA,gDA6Bc63C,GAAuBoN,EAAQ,IAAC,YAAY,mKAFvDV,EAIK7qB,EAAAt8B,EAAA4C,CAAA,EAHH8lD,EAEG1oD,EAAAiM,CAAA,uCADMwuC,GAAuBoN,EAAQ,IAAC,YAAY,QAAA57C,EAAA,UAAAmpD,4DAoBxCg7B,EAAAvoC,MAAS,KAAI,4RADe,QAC7B,qcAbdV,EAiBK7qB,EAAAwsB,EAAAlmD,CAAA,EAhBH8lD,EAEII,EAAAye,CAAA,SACJ7e,EAYKI,EAAA1B,CAAA,EAXHsB,EAEGtB,EAAAipC,CAAA,SACH3nC,EAOKtB,EAAAqB,CAAA,EANHC,EAEGD,EAAA36C,CAAA,SACH46C,EAEGD,EAAAjkD,CAAA,wBADM2jD,EAAA,MAAAioC,OAAAvoC,MAAS,KAAI,KAAAsE,GAAAmkC,EAAAF,CAAA,2CAUjB31C,GAAuBoN,EAAQ,IAAC,QAAQ,gJAFnDV,EAIK7qB,EAAAt8B,EAAA4C,CAAA,EAHH8lD,EAEG1oD,EAAAiM,CAAA,uCADMwuC,GAAuBoN,EAAQ,IAAC,QAAQ,QAAA57C,EAAA,UAAAmpD,gDAc5C4W,EAAAnkB,MAAO,kBAAoB,iBAAmB,gFAI1CA,EAAsB,0BAA3B,OAAInoE,GAAA,4fAXVynE,EAyBK7qB,EAAAwsB,EAAAlmD,CAAA,EAxBH8lD,EAQKI,EAAAL,CAAA,EAPHC,EAAsED,EAAAx8C,CAAA,SACtEy8C,EAKQD,EAAAR,CAAA,gBAEVS,EAcKI,EAAA1B,CAAA,8FAjBAe,EAAA,MAAA6jB,OAAAnkB,MAAO,kBAAoB,iBAAmB,8BAA2BsE,GAAAigB,EAAAJ,CAAA,kBAIrEnkB,EAAsB,uBAA3B,OAAInoE,GAAA,qHAAJ,wJAS2BwsF,EAAA,eAAAqkB,GAAkB1oC,EAAI,0CACxCA,EAAI,qCAPkFh7B,EAAAo7B,EAAA,QAAAiE,EAAA,yFAAArE,EAAM,IAAC,oBAAoB,SACtHA,EAAA,KAEE,iCACA,8CAA6C,UANnDV,EAUQ7qB,EAAA2rB,EAAArlD,CAAA,EAFN8lD,EAAuDT,EAAAikB,CAAA,SACvDxjB,EAAkBT,EAAAkkB,CAAA,iDAP2EhkB,EAAA,MAAA+D,OAAA,yFAAArE,EAAM,IAAC,oBAAoB,SACtHA,EAAA,KAEE,iCACA,8GAkCOuN,EAAA3a,GAAuBoN,EAAQ,IAAC,eAAeA,EAAM,wHAD9DV,EAEK7qB,EAAAt8B,EAAA4C,CAAA,wBADIulD,EAAA,MAAAiN,OAAA3a,GAAuBoN,EAAQ,IAAC,eAAeA,EAAM,YAAA7nD,EAAA,UAAAo1D,mDAuBvDvN,EAAsB,0BAA3B,OAAInoE,GAAA,iQAHVynE,EAiBK7qB,EAAA8qB,EAAAxkD,CAAA,EAhBH8lD,EAAqEtB,EAAAn7C,CAAA,SACrEy8C,EAcKtB,EAAAqB,CAAA,+EAbIZ,EAAsB,uBAA3B,OAAInoE,GAAA,qHAAJ,qJAS2BwsF,EAAA,eAAAqkB,GAAkB1oC,EAAI,0CACxCA,EAAI,qCAPkFh7B,EAAAo7B,EAAA,QAAAiE,EAAA,yFAAArE,EAAQ,IAAC,YAAY,SAChHA,EAAA,KAEE,iCACA,8CAA6C,UANnDV,EAUQ7qB,EAAA2rB,EAAArlD,CAAA,EAFN8lD,EAAuDT,EAAAikB,CAAA,SACvDxjB,EAAkBT,EAAAkkB,CAAA,iDAP2EhkB,EAAA,MAAA+D,OAAA,yFAAArE,EAAQ,IAAC,YAAY,SAChHA,EAAA,KAEE,iCACA,uLAhCL,IAAAc,EAAAd,MAAS,gBAAkBA,EAAQ,IAAC,eAAeA,EAAM,MAAAsT,GAAAtT,CAAA,kDAqB7D,IAAAe,EAAAf,EAAc,KAAK,SAAWA,MAAO,mBAAiBC,GAAAD,CAAA,mEA/BzC0f,EAAA,wBAAA1f,MAAS,CAAC,snBAsBfh5B,EAAA,MAAA8qD,EAAA9xB,MAAS,6QA/BxBV,EA4DK7qB,EAAA0sB,EAAApmD,CAAA,EAzDH8lD,EAkCKM,EAAAH,CAAA,EAjCHH,EAoBKG,EAAAzB,CAAA,EAnBHsB,EAaKtB,EAAAqB,CAAA,EAZHC,EAIID,EAAA8e,CAAA,SACJ7e,EAMQD,EAAAR,CAAA,+BAQZS,EAWKG,EAAAC,CAAA,EAVHJ,EAAwDI,EAAAv7C,CAAA,SACxDm7C,EAQCI,EAAAj6B,CAAA,yFAhBIg5B,MAAS,gBAAkBA,EAAQ,IAAC,eAAeA,EAAM,+DAYrDM,EAAA,MAAAwxB,OAAA9xB,MAAS,SAAMh5B,EAAA,QAAA8qD,eASvB9xB,EAAc,KAAK,SAAWA,MAAO,6IAnH7CkE,EAAAlE,MAAO,MAAK,UAAIA,EAAM,IAAC,aAAe,GAAC,qBAIrCc,EAAAd,MAAS,cAAYqf,GAAArf,CAAA,IASrBA,EAAQ,IAAC,eAAiB,YAAU2oC,GAAA3oC,CAAA,EAqBpCyU,EAAAzU,MAAS,UAAQsf,GAAAtf,CAAA,EASjB0U,EAAA1U,OAAmB,SAAOwS,GAAAxS,CAAA,EA+BtB+d,EAAA7E,GAAAlZ,MAAO,SAAS,uBAArB,OAAInoE,GAAA,gEA1EQ,IAAE,aAAyB,UAC3C,yUAPFynE,EAgJK7qB,EAAA8qB,EAAAxkD,CAAA,EA7IH8lD,EAIItB,EAAAqpC,CAAA,6HAwEJ/nC,EAgEKtB,EAAAqB,CAAA,qEAzIFN,EAAA,MAAA4D,OAAAlE,MAAO,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,kBAAIlE,EAAM,IAAC,aAAe,GAAC,KAAAsE,GAAAigB,EAAAJ,CAAA,EAIrCnkB,MAAS,oEASTA,EAAQ,IAAC,eAAiB,kEAqB1BA,MAAS,gEASTA,OAAmB,4EA+Bf+d,EAAA7E,GAAAlZ,MAAO,SAAS,oBAArB,OAAInoE,GAAA,qHAAJ,0PAlNJmoE,EAAkB,OAoDnB,IAAAc,EAAAd,OAAmB,SAAOie,GAAAje,CAAA,0BAyD5BA,EAAU,GAAAG,GAMLH,EAAS,GAAC,SAAW,EAACE,qpBAvEvBF,EAAY,QAAC,SAChB,g1BAhBcA,EAAc,aAAAmd,GAAA,IAAAnd,EAAA,SAAAnkB,CAAA,okBArCqB7W,EAAAupD,EAAA,QAAAC,EAAA,qDAAAxuB,EAAS,GAAC,SAC/D,OACA,GAAE,WAHRV,EAiTM7qB,EAAA85C,EAAAxzE,EAAA,qBArSJ8lD,EAgSS0tB,EAAApM,CAAA,EA/RPthB,EAIIshB,EAAAtL,CAAA,SAEJhW,EAIGshB,EAAAqmB,CAAA,SAGH3nC,EA0FKshB,EAAAhhB,CAAA,EAzFHN,EAEIM,EAAAynC,CAAA,SAEJ/nC,EA4BKM,EAAAH,CAAA,EA1BHH,EAYKG,EAAAJ,CAAA,EAXHC,EAEOD,EAAAwnC,CAAA,SACPvnC,EAOQD,EAAA/kB,CAAA,EAHNglB,EAA8ChlB,EAAAgtD,CAAA,EAC9ChoC,EAA0DhlB,EAAAitD,CAAA,EAC1DjoC,EAAyDhlB,EAAAktD,CAAA,OAL7C/oC,EAAc,cAU9Ba,EAUKG,EAAAC,CAAA,EATHJ,EAEOI,EAAAonC,CAAA,SACPxnC,EAEKI,EAAA1B,CAAA,uBACLsB,EAEGI,EAAAh7C,CAAA,4DAqPX46C,EAEQ0tB,EAAAG,EAAA,mGAvSE1uB,EAAkB,+BA6BNA,EAAc,2BAezBA,EAAY,IAQdA,OAAmB,4IA5D6B,CAAAvvD,IAAA6vD,GAAA,QAAAkuB,OAAA,qDAAAxuB,EAAS,GAAC,SAC/D,OACA,yMA3ZKgpC,GAAY5yF,EAAe6yF,EAAqB,CACnD,IAAA/nD,EAAO9qC,EAGX,OAAA8qC,EAAOA,EAAK,QAAQ,uBAAwB,qBAAqB,EACjEA,EAAOA,EAAK,QAAQ,uBAAwB,aAAa,EACzDA,EAAOA,EAAK,QAAQ,qBAAsB,aAAa,EACvDA,EAAOA,EAAK,QAAQ,YAAa,GAAG,EACpCA,EAAOA,EAAK,QAAQ,YAAa,GAAG,EACpCA,EAAOA,EAAK,QAAQ,cAAe,MAAM,EACzCA,EAAOA,EAAK,QAAQ,cAAe,UAAU,EAC7CA,EAAOA,EAAK,QAAQ,gBAAiB,MAAM,EAC3CA,EAAOA,EAAK,QAAQ,WAAY,IAAI,EACpCA,EAAOA,EAAK,QAAQ,mBAAoB,IAAI,EAC5CA,EAAOA,EAAK,QAAQ,qBAAsB,IAAI,EAC9CA,EAAOA,EAAK,QAAQ,WAAY,GAAG,EACnCA,EAAOA,EAAK,QAAQ,YAAa,GAAG,EACpCA,EAAOA,EAAK,QAAQ,OAAQ,GAAG,EAC/BA,EAAOA,EAAK,QAAQ,KAAM,GAAG,EAC7BA,EAAOA,EAAK,QAAQ,SAAU,GAAG,EACjCA,EAAOA,EAAK,QAAQ,OAAQ,GAAG,EAG/BA,EAAOA,EAAK,QAAQ,WAAY,MAAM,EACtCA,EAAOA,EAAK,KAAI,EAETA,EAGA,SAAAgoD,GAAoBC,EAAsBC,EAAyBH,EAAqB,CAE3F,GAAAE,EAAa,KAAI,EAAG,YAAW,EAAG,WAAW,WAAW,GAAKA,EAAa,KAAI,EAAG,YAAW,EAAG,WAAW,OAAO,EACnH,eAAQ,KAAK,8CAA8C,EACpD,KAGL,GAAAC,EAAgB,KAAI,EAAG,YAAW,EAAG,WAAW,WAAW,GAAKA,EAAgB,KAAI,EAAG,YAAW,EAAG,WAAW,OAAO,EACzH,eAAQ,KAAK,4DAA4D,EAClE,cAOAC,EAAalkE,EAAiBmkE,EAAiB,OAChD34C,EAAK,GAGL44C,EAAiBpkE,EAAQ,MAAM,kEAAkE,MAClGokE,EAAc,IAEbN,EAAY,CACR,MAAAO,qCAAiDP,CAAY;;;;8DAKfK,EAAW,SAAW,YAAY;AAAA;AAAA,2BAErEE,CAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAQtB,+CAA+C,EAMnD,MAAAp+F,EAHmBm+F,EAAe,CAAC,EAGV,MAAM,mBAAmB,UAG/C1xG,EAAI,EAAGA,EAAIuT,EAAM,OAAQvT,IAAC,CAC7B,IAAA4xG,EAAcr+F,EAAMvT,CAAC,EAAE,KAAI,EAC3B4xG,IAEFA,EAAcC,GAAkBD,CAAyB,EACzD94C,EAAM,KAAKq4C,GAAYS,CAAyB,WAI7C94C,EAIH,MAAAg5C,EAAcN,EAAaF,EAAc,EAAI,EAG7CS,EAAkBP,EAAaD,EAAiB,EAAK,EAE3D,eAAQ,IAAG,kBAAmBO,EAAY,MAAM,6BAI9C,QAASA,EACT,YAAaC,YAKRF,GAAkBtzF,EAAe6yF,EAAqB,CACzD,IAAApiE,EAAUzwB,QAGRyzF,EAAK,CAAIC,EAAepkF,IAAa;AAAA,gBAE/BokF,CAAK;AAAA,gBACLpkF,CAAK;AAAA,eAIjB,OAAAmhB,EAAUA,EAAQ,QAAQ,6CAA8C,EAAE,EAC1EA,EAAUA,EAAQ,QAAQ,mDAAoDgjE,EAAM,KAAM,QAAQ,GAClGhjE,EAAUA,EAAQ,QAAQ,uDAAwDgjE,EAAM,KAAM,SAAS,GACvGhjE,EAAUA,EAAQ,QAAQ,uCAAwCgjE,EAAM,KAAM,OAAO,GACrFhjE,EAAUA,EAAQ,QAAQ,qBAAsB,EAAE,EAClDA,EAAUA,EAAQ,QAAQ,qDAAsD,EAAE,EAClFA,EAAUA,EAAQ,QAAQ,iCAAkC,EAAE,EAC9DA,EAAUA,EAAQ,QAAQ,4BAA6B,EAAE,EACzDA,EAAUA,EAAQ,QAAQ,4BAA6B,EAAE,EAGzDA,EAAUA,EAAQ,QAAQ,WAAY,EAAE,EAGxCA,EAAUA,EAAQ,QAAQ,OAAQ,GAAG,EACrCA,EAAUA,EAAQ,QAAQ,MAAO,GAAG,EACpCA,EAAUA,EAAQ,QAAQ,SAAU,GAAG,EAEhCA,EAIA,SAAA6hE,GAAkBqB,EAAsB,OACzCvtD,EAAOutD,EAAe,YAAW,SAGnCvtD,EAAK,SAAS,QAAQ,GAAKA,EAAK,SAAS,UAAU,EAC9C,KAELA,EAAK,SAAS,aAAa,GAAKA,EAAK,SAAS,gBAAgB,EACzD,KAELA,EAAK,SAAS,WAAW,GAAKA,EAAK,SAAS,cAAc,EACrD,KAELA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,WAAW,EACjD,KAELA,EAAK,SAAS,WAAW,GAAKA,EAAK,SAAS,cAAc,EACrD,MAELA,EAAK,SAAS,aAAa,GAAKA,EAAK,SAAS,eAAe,EACxD,KAELA,EAAK,SAAS,WAAW,GAAKA,EAAK,SAAS,QAAQ,GAAKA,EAAK,SAAS,QAAQ,EAC1E,KAELA,EAAK,SAAS,SAAS,GAAKA,EAAK,SAAS,UAAU,EAC/C,KAELA,EAAK,SAAS,aAAa,GAAKA,EAAK,SAAS,SAAS,EAClD,KAELA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,WAAW,EACjD,KAELA,EAAK,SAAS,QAAQ,GAAKA,EAAK,SAAS,UAAU,EAC9C,KAELA,EAAK,SAAS,YAAY,GAAKA,EAAK,SAAS,UAAU,EAClD,KAIF,yHAvOL3D,EAAS,GACTo7C,EAAa,GACb+V,EAsBAC,EAAc,GACdC,EAAsB,CACxB,WACA,YACA,cACA,YACA,WACA,aAAa,EAKXC,EAAiC,QACjCC,EAAW,GACXC,EAAU,GACVC,EAAU,kBAmMC7W,GAAa,CAC1Br4B,GAAoC,MACpCviB,EAAS,MAAS0hB,GAA+B+e,CAAgB,GAGtD,UAAA1zB,KAAM/M,SACJ+M,EAAG,iBAAoB,YAChCA,EAAG,gBAAe,EAKtBka,EAAA,EAAAmqC,EAAiBpxD,EAAU,IAAG,CAAE+M,EAAI/tD,IAAC,CAE7B,MAAA0yG,GAAsB3kD,EAAG,eAAiB,WAE5C,IAAA4kD,EAAqB,EACrBhzD,GAAQoO,EAAG,OAAK,YAAgB/tD,EAAI,CAAC,GACrC4yG,EAAwE,QAExEF,GAAmB,CAEf,MAAA3vC,EAAUhV,EAAW,QAAU,GAC/BiJ,EAAQjJ,EAAW,MAAQ,GAC3BkJ,GAASlJ,EAAW,OAAS,GAC7BrvB,EAAQqvB,EAAW,MAAQ,GAC3B+U,GAAiB/U,EAAW,eAAiB,GAEnDpO,GAAK,GAAMojB,CAAM,IAAI/L,CAAI,IAAIC,EAAK,IAAIv4B,CAAI,OAAOokC,EAAa,GAAG,KAAI,EAGhE/U,EAAW,SAAYA,EAAW,aACrC6kD,EAAmBvB,GAAqBtjD,EAAW,QAAUA,EAAW,YAAaA,EAAG,IAAI,EAExF6kD,GACFD,EAAqBC,EAAiB,QAAQ,OAC9C,QAAQ,IAAG,MAAOjzD,EAAK,KAAKgzD,CAAkB,mCAG9C,QAAQ,KAAI,MAAOhzD,EAAK,yDACxBgzD,EAAqB,KAIvB,QAAQ,KAAI,MAAOhzD,EAAK,wDACxBgzD,EAAqB,EAIrBC,EAAgB,CACd,QAAO;;;;;;uBAFQ,eAAkB7kD,EAAG,IAAI,qBAQlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAOtB,YAAW;;4BAOYA,EAAG,gBAAkBA,EAAG,eAAe,OAAS,EAEzE4kD,EAAqB5kD,EAAG,eAAe,OAC9BA,EAAG,cACZ4kD,EAAqB5kD,EAAG,oBAK1B,cAAe/tD,EACR,MAAA2/C,GACP,KAAMoO,EAAG,KACT,oBAAmB,GACnB,kBAAmB,GACnB,UAAW,MAAM,KAAI,CAAG,OAAQ4kD,GAAkB,CAAKxyD,EAAGz8C,IAAC,KACrDg9C,GAAM,YAAeh9C,EAAI,CAAC,GAC1B+mD,SAEAioD,GAEEE,GAAoBA,EAAiB,QAAQ,OAASlvG,GACxDg9C,GAASkyD,EAAiB,QAAQlvG,CAAC,EAC/BkvG,EAAiB,aAAeA,EAAiB,YAAY,OAASlvG,IACxE+mD,EAAamoD,EAAiB,YAAYlvG,CAAC,GAE7C,QAAQ,IAAG,iBAAkBA,EAAI,CAAC,aAAag9C,GAAO,UAAU,EAAG,EAAE,+BAGrEA,GAAM,yCAIJqN,EAAG,gBAAkBA,EAAG,eAAerqD,CAAC,IAC1Cg9C,GAASqN,EAAG,eAAerqD,CAAC,GAI1BqqD,EAAG,kBAAoBA,EAAG,iBAAiBrqD,CAAC,EAC9C+mD,EAAasD,EAAG,iBAAiBrqD,CAAC,EACzBA,IAAM,GAAKqqD,EAAG,WACvBtD,EAAasD,EAAG,WACPrqD,IAAM,GAAKqqD,EAAG,oBACvBtD,EAAasD,EAAG,qBAKlB,cAAerqD,EACf,YAAW,GACX,OAAQ,EACA,OAAAg9C,GACI,WAAA+J,KAGhB,YAAakoD,EACb,gBAAiBD,GACjB,aAAc3kD,EAAG,iBAIrB,QAAQ,IAAI,0BAA2BqkD,CAAc,EACrD,QAAQ,IAAI,sBAAuBpxD,EAAU,IAAI+M,IAAE,CACjD,KAAMA,EAAG,KACT,aAAeA,EAAW,aAC1B,WAAU,EAAMA,EAAW,QAC3B,eAAc,EAAMA,EAAW,YAC/B,gBAAkBA,EAAW,SAAW,IAAI,UAAU,EAAG,GAAG,MAG9Dka,EAAA,EAAAm0B,EAAa,EAAK,EAGpBhxB,GAAW,KACL+mC,IAAmB/V,GAErB,gBACEj5B,GAAkBgvC,CAAc,GAC/B,gBAIEU,EAAyBC,EAAiBC,EAAY,OACvDz0G,GAAW8zG,EAAeU,CAAO,EACjCr2G,EAAQ6B,GAAS,oBAAoB,QAAQy0G,CAAI,EACnDt2G,KACF6B,GAAS,oBAAoB,OAAO7B,EAAO,CAAC,EAE5C6B,GAAS,oBAAoB,KAAKy0G,CAAI,SAKjC,SAAAC,EAAiBF,EAAiBG,EAAgBF,GAAY,CAC/D,MAAAlyD,EAAWuxD,EAAeU,CAAO,EAAE,UAAUG,CAAM,EACnDx2G,GAAQokD,EAAS,YAAY,QAAQkyD,EAAI,EAC3Ct2G,MACFokD,EAAS,YAAY,OAAOpkD,GAAO,CAAC,EAEpCokD,EAAS,YAAY,KAAKkyD,EAAI,SAKzB,SAAAG,EAAwBJ,EAAe,KAC9CV,EAAeU,CAAO,EAAE,mBAAqBV,EAAeU,CAAO,EAAE,kBAAiBV,CAAA,SAI/E,SAAAe,EAAaL,EAAiBG,EAAgB5xF,GAAc,KACnE+wF,EAAeU,CAAO,EAAE,UAAUG,CAAM,EAAE,OAAS5xF,GAAM+wF,CAAA,MAEzDA,EAAeU,CAAO,EAAE,YAAcV,EAAeU,CAAO,EAAE,UAAU,OAAM,CAC3E3H,EAAKzkF,KAAMykF,EAAMzkF,GAAE,OACpB,CAAC,EAAA0rF,CAAA,kBAKIgB,EAAkBN,EAAiBG,EAAc,CACpD,QAAQ,qDAAqD,IAC/Db,EAAeU,CAAO,EAAE,UAAU,OAAOG,EAAQ,CAAC,MAElDb,EAAeU,CAAO,EAAE,YAAcV,EAAeU,CAAO,EAAE,UAAU,OAAM,CAC3E3H,GAAKzkF,IAAMykF,GAAMzkF,EAAE,OACpB,CAAC,EAAA0rF,CAAA,mBAMEiB,GAAgB,CAEvB,aAAa,QAAQ,iBAAkB,KAAK,UAAUjB,CAAc,GACpE,aAAa,QAAQ,sBAAuB,KAAK,UAAS,CACxD,MAAOpxD,EAAU,IAAI+M,GAAMA,EAAG,IAAI,EAClC,MAAO/M,EAAU,IAAI+M,GAAMA,EAAG,IAAI,EAClC,OAAQ0zB,KAEV,aAAa,QAAQ,mBAAoB,KAAK,UAAS,CACrD,eAAA6wB,EACA,SAAAC,EACA,QAAAC,EACA,QAAAC,EACA,aAAAa,KAIF,OAAO,SAAS,KAAO,OAAO,SAAS,OAAS,OAAO,SAAS,SAAW,gBAG7EzrC,GAAO,KACL+zB,EAAa,iBA0CO0W,EAAclpB,GAAA,0BAoCVmpB,EAAQppB,GAAA,gCAcRqpB,EAAOrpB,GAAA,gCAcPspB,EAAOtpB,GAAA,mBA2FC,MAAAyF,EAAAkkB,GAAAI,EAAwBJ,CAAO,WAS7BD,EAAyBC,EAASC,CAAI,WA8BlCK,EAAkBN,EAASG,CAAM,EAoBxCM,EAAA,CAAAT,EAAAG,EAAA52G,KACT82G,EAAaL,EAASG,EAAQ,WAAW52G,GAAE,cAAc,KAAK,GAa5CwyF,EAAA,CAAAikB,EAAAG,EAAAF,KAAAC,EAAiBF,EAASG,EAAQF,EAAI,6CA9P5DZ,EAAcjmC,oDA3ajCjE,EAAA,EAAEqrC,EAAelB,EAAe,OAAQ,CAAAh/F,EAAO9U,IACvC8U,EAAQ9U,EAAS,UAAU,OAAQ,CAAAk1G,GAAgB3yD,IACjD2yD,IAAkB3yD,EAAS,QAAU,GAC3C,GACF,0MC8xFoC,MAAAwvD,EAAAC,MAAwBA,EAAQ,GAACA,EAAmB,IAAE,GAAIA,EAAO,eACjE,MAAAmD,EAAAnD,MAAgBA,EAAO,QAAO,OAAQ,KAAM,QAAS,UAAW,QAAS,oBACrE,MAAAoD,EAAApD,EAAW,GAACA,EAAQ,GAACA,MAAqB,EAAE,mBAClDA,EAAE,KAAC,UAAU,wDAM/B,IAAI,EAAG,GAAI,CAAC,gGArDOA,EAAQ,KAAC,SAAW,OAAU,QAAS,UAAW,QAAS,UAAW,MAAO,MAAO,UAAW,uBAChGA,EAAQ,KAAC,SAAW,MAAS,QAAS,UAAW,QAAS,UAAW,MAAO,KAAM,UAAW,0BAC7FA,EAAQ,KAAC,SAAW,MAAS,QAAS,UAAW,QAAS,UAAW,MAAO,KAAM,UAAW,oBAC7FA,EAAQ,KAAC,SAAW,MAAS,QAAS,UAAW,QAAS,UAAW,MAAO,KAAM,UAAW,0BAC3F,QAAS,UAAW,QAAS,UAAW,MAAO,KAAM,UAAW,iEAtCvED,EAAAC,EAAkB,IAACA,EAAQ,GAACA,MAAqB,EAAE,4JAzN3Cl0D,GAAAp/C,GAAAC,EAAAqzG,EAAW,GAACA,EAAc,KAAC,EAAE,IAA7B,YAAArzG,EAAiCqzG,EAAoB,MAArD,YAAAtzG,EAAyDszG,EAAM,QAA/D,YAAAl0D,EAAkE,SAAU,4KA/FpFi0D,EAAAC,KAAeA,EAAoB,gFAzC1B,MAAAD,EAAAC,MAAgBA,EAAO,QAAO,OAAQ,KAAM,QAAS,UAAW,QAAS,wGArC5EA,EAAQ,KAAC,SAAW,OAAU,QAAS,UAAW,QAAS,UAAW,MAAO,MAAO,UAAW,uBAChGA,EAAQ,KAAC,SAAW,MAAS,QAAS,UAAW,QAAS,UAAW,MAAO,KAAM,UAAW,0BAC7FA,EAAQ,KAAC,SAAW,MAAS,QAAS,UAAW,QAAS,UAAW,MAAO,KAAM,UAAW,oBAC7FA,EAAQ,KAAC,SAAW,MAAS,QAAS,UAAW,QAAS,UAAW,MAAO,KAAM,UAAW,0BAC3F,QAAS,UAAW,QAAS,UAAW,MAAO,KAAM,UAAW,oGAtWtE,MAAAD,EAAAC,KAAS,UAAS,YAAA3uG,EAAA,8CACzB2uG,EAAqB,IAACA,EAAO,KAAC,EAAE,mBAC1BA,EAAc,uBACPA,EAAoB,IAACA,EAAO,KAAC,EAAE,mBACxCA,EAAkB,IAACA,EAAO,KAAC,EAAE,WACxB,MAAAqD,EAAArD,EAAc,GAAC,OAAM,CAAEnF,EAAKp9C,IAAOo9C,EAAMp9C,EAAG,UAAU,OAAQ,CAAC,kBAC3DuiD,EAAuB,IAACA,EAAO,KAAC,EAAE,mBACxCA,EAA+B,IAACA,EAAK,KAAC,QAASA,EAAK,KAAC,MAAOA,EAAkB,eAC1E,MAAAsD,EAAAtD,EAAkB,OAAKA,EAAc,KAAIA,MAAiB,uBAC5Dl0D,GAAAp/C,GAAAC,EAAAqzG,EAAW,GAACA,EAAO,KAAC,EAAE,IAAtB,YAAArzG,EAAyB,cAAzB,YAAAD,EAAsC,SAAtC,MAAAo/C,EAA8C,qGA0MzCk0D,EAAQ,KAAC,SAAW,OAAU,QAAS,UAAW,MAAO,MAAO,UAAW,uBAC5EA,EAAQ,KAAC,SAAW,MAAS,QAAS,UAAW,MAAO,KAAM,UAAW,0BACzEA,EAAQ,KAAC,SAAW,MAAS,QAAS,UAAW,MAAO,KAAM,UAAW,oBACzEA,EAAQ,KAAC,SAAW,MAAS,QAAS,UAAW,MAAO,KAAM,UAAW,0BACvE,QAAS,UAAW,MAAO,KAAM,UAAW,0FArB1C,MAAAD,EAAAC,MAAeA,EAAY,MAAIA,EAAc,IAACA,EAAY,MAAEA,EAAO,OAAM,OAAQ,KAAM,QAAS,UAAW,QAAS,oBACpH,MAAAmD,EAAAnD,EAAuB,IAACA,EAAO,KAAC,GAAIA,EAAO,mGAlI9CA,EAAQ,KAAC,SAAW,OAAU,QAAS,UAAW,MAAO,MAAO,UAAW,uBAC5EA,EAAQ,KAAC,SAAW,MAAS,QAAS,UAAW,MAAO,KAAM,UAAW,0BACzEA,EAAQ,KAAC,SAAW,MAAS,QAAS,UAAW,MAAO,KAAM,UAAW,oBACzEA,EAAQ,KAAC,SAAW,MAAS,QAAS,UAAW,MAAO,KAAM,UAAW,0BACvE,QAAS,UAAW,MAAO,KAAM,UAAW,0FArBzC,MAAAD,EAAAC,MAAeA,EAAY,MAAIA,EAAc,IAACA,EAAY,MAAEA,EAAO,OAAM,OAAQ,KAAM,QAAS,UAAW,QAAS,oBACpH,MAAAmD,EAAAnD,EAAuB,IAACA,EAAO,KAAC,GAAIA,EAAO,uIA7L1DA,EAAmB,yDA8anBD,EAAAC,KAASA,EAAmB,iEAuC5CI,EAAAvoC,OAAe,IAAG,OAAG0rC,EAAA1rC,OAAe,OAAM,aAsBtCA,EAAc,MAAK,SAAW,OAAO,KAAKA,EAAW,KAAE,OAAS,UA0B/B2rC,EAAA3rC,KAAsB,EAAC,OAAK4rC,EAAA5rC,KAAS,OAAM,kEA9D9EA,EAAuB,KAAA6rC,GAAA7rC,CAAA,4BAkBrBA,GAAuB,IAAA8rC,GAOlB9rC,GAAgB,IAAC,MAAQ,EAAC+rC,8CAkD3B/rC,EAAc,6BAAnB,OAAInoE,IAAA,yBAyCL,IAAA68E,GAAA1U,KAAeA,EAAoB,KAAAme,GAAA6tB,GAAAhsC,CAAA,MA4LvCA,EAAoB,KAAAisC,GAAAjsC,CAAA,4VAlPY,QAAM,aAAyB,KAAG,mPA6RrE,mBAEA,6BAMA,iBAEA,o+BAZYoF,GAAA,SAAA8mC,GAAAlsC,OAAwB,gIAQxB0b,GAAA,SAAAywB,GAAAnsC,EAAmB,KAAKA,EAAQ,GAAC,OAAS,0QAxX1DV,EA8XK7qB,GAAA+wB,EAAAzqD,EAAA,EA5XH8lD,EAqFK2E,EAAArE,CAAA,EApFHN,EAKQM,EAAA6D,CAAA,SAERnE,EAqBKM,EAAAP,CAAA,EApBHC,EAKQD,EAAAqE,CAAA,SACRpE,EAKQD,EAAAsE,CAAA,iCAWVrE,EAiDKM,EAAAF,CAAA,EAhDHJ,EAIII,EAAA4V,CAAA,8BACJhW,EA0CKI,EAAA1B,CAAA,8CAGPsB,EAEKM,EAAAH,CAAA,EADHH,EAAuFG,EAAA58C,CAAA,qCAK3Fy8C,EAyOK2E,EAAAC,EAAA,EAvOH5E,EA0CK4E,GAAA0N,CAAA,EAzCHtS,EAwCKsS,EAAAF,CAAA,EAvCHpS,EAEMoS,EAAAyM,EAAA,SACJ7e,EAmCGoS,EAAAzO,EAAA,oEAKT3D,EAyLK4E,GAAAgf,CAAA,EAxLH5jB,EAuLK4jB,EAAAE,CAAA,mDA4CT9jB,EAgBK2E,EAAAE,EAAA,EAfH7E,EAMQ6E,GAAAN,EAAA,oBAERvE,EAMQ6E,GAAAgW,EAAA,0CAxXI1b,EAAc,kBAQZA,EAAmB,kBAMnBA,EAAwB,oEAK/BA,GAAuB,yEAczBM,GAAA,MAAAioC,OAAAvoC,QAAe,IAAG,KAAAsE,GAAAmkC,EAAAF,CAAA,EAAGjoC,GAAA,MAAAorC,OAAA1rC,QAAe,OAAM,KAAAsE,GAAA8nC,EAAAV,CAAA,8FAsBtC1rC,GAAc,MAAK,SAAW,OAAO,KAAKA,GAAW,KAAE,OAAS,0EA0B/BM,GAAA,MAAAqrC,OAAA3rC,MAAsB,EAAC,KAAAsE,GAAA+nC,EAAAV,CAAA,EAAKrrC,GAAA,MAAAsrC,OAAA5rC,MAAS,OAAM,KAAAsE,GAAAgoC,EAAAV,CAAA,0BAaxE5rC,GAAc,0BAAnB,OAAInoE,IAAA,8IAAJ,OAyCDmoE,MAAeA,GAAoB,iFA4LvCA,GAAoB,sEAyCXM,GAAA,MAAA4rC,SAAAlsC,QAAwB,qBAQxBM,GAAA,MAAA6rC,SAAAnsC,GAAmB,KAAKA,GAAQ,GAAC,OAAS,wJA30BlC+Y,EAAA/Y,KAAS,OAAM,mFAkChCA,EAAQ,GAAC,OAAS,GAACse,GAAAiuB,GAAAvsC,CAAA,KAgFnBA,EAAQ,GAAC,OAAS,GAACwsC,GAAAxsC,CAAA,IAwCfA,EAAW,IAAAue,GAAAve,CAAA,KAYbA,EAAW,IAAA0d,GAAA1d,CAAA,OAQTA,EAAgB,KAAoB,MAAAmZ,GAAAnZ,YAAQ,qBAAjD,OAAInoE,IAAA,yGA/KN,mBACmB,aAAiB,WACpC,wFAUI,cAEA,0BAMA,QAEA,+nBAboEmtC,EAAAggC,EAAA,QAAA+S,EAAA,8DAAA/X,QAAwB,YACtF,mCACA,sGAAqG,EAMvCh7B,EAAAigC,EAAA,QAAAsK,EAAA,8DAAAvP,QAAwB,MACtF,mCACA,sGAAqG,++BAvBnHV,EAkdK7qB,GAAAkwC,EAAA5pE,EAAA,EAjdH8lD,EAmCK8jB,EAAA1jB,CAAA,EAlCHJ,EAIII,EAAA4V,CAAA,8BACJhW,EA4BKI,EAAA1B,CAAA,EA1BHsB,EAkBKtB,EAAAqB,CAAA,EAjBHC,EAAgFD,EAAArlB,CAAA,SAChFslB,EAOQD,EAAAoE,CAAA,gBACRnE,EAOQD,EAAAqE,CAAA,gBAEZpE,EAMQtB,EAAA2F,CAAA,qDAgHVrE,EA8BK8jB,EAAA1R,CAAA,EA7BHpS,EAuBKoS,EAAA9R,CAAA,EAtBHN,EAIKM,EAAAH,CAAA,SACLH,EAKCM,EAAAn6B,CAAA,OAHag5B,EAAW,0DAuB7Ba,EA+RK8jB,EAAAxR,CAAA,qHApbSnT,EAAiB,0CAxBTM,GAAA,MAAAyY,OAAA/Y,MAAS,OAAM,KAAAsE,GAAA0U,EAAAD,CAAA,EAQqCzY,GAAA,YAAAyX,OAAA,8DAAA/X,SAAwB,YACtF,mCACA,wHAM8DM,GAAA,YAAAiP,OAAA,8DAAAvP,SAAwB,MACtF,mCACA,wHAgBPA,GAAQ,GAAC,OAAS,oEAgFlBA,GAAQ,GAAC,OAAS,+EAoCLA,GAAW,SAAXA,GAAW,IAIpBA,GAAW,gEAYbA,GAAW,+GAQTA,GAAgB,kNAnNdA,EAAQ,GAAC,OAAS,GAAC8d,GAAA9d,CAAA,IAgBvBA,EAAc,GAAC,OAAS,GAACgf,GAAAhf,CAAA,+bA3B1B;AAAA,iBAEE,2uBA1BVV,EA+DK7qB,EAAA0sB,EAAApmD,CAAA,EA9DH8lD,EAIIM,EAAA0V,CAAA,SAEJhW,EAuDKM,EAAAH,CAAA,EApDHH,EAuCKG,EAAAC,CAAA,EAtCHJ,EAEGI,EAAAunC,CAAA,SAEH3nC,EAIKI,EAAAL,CAAA,SAELC,EA2BKI,EAAA1B,CAAA,EA1BHsB,EAWOtB,EAAA75C,CAAA,SAPLm7C,EAMCn7C,EAAAshB,CAAA,2EAFYg5B,EAAgB,mBAK1BA,EAAQ,GAAC,OAAS,4DAgBtBA,EAAc,GAAC,OAAS,yTAggBzBV,EAKQ7qB,EAAA2rB,EAAArlD,CAAA,iOAwBNukD,EAEK7qB,EAAAt8B,EAAA4C,CAAA,4CALFmpD,EAAAlE,MAAiB,QAAO,OAAGmkB,EAAAnkB,MAAiB,MAAK,OAAIk8B,EAAAl8B,EAAc,IAAC,YAAY,QAAQ,CAAC,0CAAhE,GAAC,aAAwB,IAAE,aAAuC,IAC9F,6FAFAV,EAEK7qB,EAAAt8B,EAAA4C,CAAA,oDADFulD,EAAA,SAAA4D,OAAAlE,MAAiB,QAAO,KAAAsE,GAAAC,EAAAL,CAAA,EAAG5D,EAAA,SAAA6jB,OAAAnkB,MAAiB,MAAK,KAAAsE,GAAAigB,EAAAJ,CAAA,EAAI7jB,EAAA,UAAA47B,OAAAl8B,EAAc,IAAC,YAAY,QAAQ,CAAC,OAAAsE,GAAA23B,EAAAC,CAAA,uCAJzFh4B,EAAAlE,MAAiB,QAAO,OAAGmkB,EAAAnkB,MAAiB,MAAK,OAAIk8B,EAAAl8B,EAAc,IAAC,YAAY,QAAQ,CAAC,SAAQoyB,EAAApyB,MAAe,OAAM,sCAA7F,GAAC,aAAwB,IAAE,aAAuC,OAAK,iEAFlFoZ,EAAAjhE,EAAA,QAAA6nD,MAAe,OAAO,EAAgBoZ,EAAAjhE,EAAA,aAAA6nD,MAAe,OAAO,UAF7EV,EAKK7qB,EAAAt8B,EAAA4C,CAAA,2DADFulD,EAAA,SAAA4D,OAAAlE,MAAiB,QAAO,KAAAsE,GAAAC,EAAAL,CAAA,EAAG5D,EAAA,SAAA6jB,OAAAnkB,MAAiB,MAAK,KAAAsE,GAAAigB,EAAAJ,CAAA,EAAI7jB,EAAA,UAAA47B,OAAAl8B,EAAc,IAAC,YAAY,QAAQ,CAAC,OAAAsE,GAAA23B,EAAAC,CAAA,EAAQ57B,EAAA,UAAA8xB,OAAApyB,MAAe,OAAM,KAAAsE,GAAAiuB,EAAAH,CAAA,cAFxGhZ,EAAAjhE,EAAA,QAAA6nD,MAAe,OAAO,cAAgBoZ,EAAAjhE,EAAA,aAAA6nD,MAAe,OAAO,4CAiBpE,OAAO,QAAQA,EAAW,2BAA/B,OAAInoE,GAAA,4HADRynE,EAmBK7qB,EAAAt8B,EAAA4C,CAAA,+EAlBI,OAAO,QAAQilD,EAAW,wBAA/B,OAAInoE,GAAA,qHAAJ,uDAYKqsE,EAAAlE,OAAU,MAAK,WAEKmkB,EAAAukB,GAAkB1oC,EAAI,iBACVA,EAAI,gNANjBoZ,EAAAxY,EAAA,aAAAZ,OAAU,OAAO,EAC7Bh7B,EAAA47B,EAAA,QAAA6rC,EAAAzsC,OAAU,SAAS,2GAJ/BV,EAUK7qB,EAAA8qB,EAAAxkD,CAAA,EATH8lD,EAMKtB,EAAAqB,CAAA,gBACLC,EAAqDtB,EAAA8kB,CAAA,gBACrDxjB,EAA8CtB,EAAA+kB,CAAA,wBAH3ChkB,EAAA,UAAA4D,OAAAlE,OAAU,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,cAHIkV,EAAAxY,EAAA,aAAAZ,OAAU,OAAO,EAC7BM,EAAA,UAAAmsC,OAAAzsC,OAAU,2BAIGM,EAAA,UAAA6jB,OAAAukB,GAAkB1oC,EAAI,WAAAsE,GAAAigB,EAAAJ,CAAA,qBACVnkB,EAAI,UAAAsE,GAAA23B,EAAAC,CAAA,uCA8C5B5e,EAAAtd,OAAe,KAAI,2CAA1BV,EAAiC7qB,EAAA8G,EAAAxgC,CAAA,iBAA1BulD,EAAA,eAAAgd,OAAAtd,OAAe,KAAI,KAAAsE,GAAAz5D,EAAAyyE,CAAA,iDAJA6U,EAAAnyB,OAAG,MAAK,WAMnCoyB,EAAApyB,OAAe,OAAM,WAIvBA,EAAE,KAAC,UAAU,OAAM,OAAM0sC,EAAA1sC,OAAG,YAAW,eAPjCD,EAAAC,OAAe,MAAI2sC,GAAA3sC,CAAA,+FAJUqkB,EAAA,gBAAArkB,OAAU,CAAC,+FAW1B,MAAI,aAAgB,KAC3C,wMATgHoZ,EAAAkL,EAAA,aAAAtkB,OAAe,OAAO,qMAjBpIA,EAAc,KAAC,SAAW,MAAQ,kCAChCA,EAAc,KAAC,SAAW,KAAO,gCACjCA,EAAc,KAAC,SAAW,KAAO,oCACjCA,EAAc,KAAC,SAAW,KAAO,8BACjCA,EAAc,KAAC,SAAW,KAAO,gCACjCA,EAAc,KAAC,SAAW,KAAO,qCACjCA,EAAc,KAAC,SAAW,cAC1BA,EAAc,KAAC,SAAW,WAAa,kCACT,KAC/BA,EAAoB,KAAKA,EAAO,KAAG,4CAA8C,GAAE,EAC3DoZ,EAAAhZ,EAAA,oBAAAJ,OAAe,OAAO,UAbnDV,EA8BQ7qB,EAAA2rB,EAAArlD,CAAA,EAfN8lD,EAWKT,EAAAa,CAAA,EAVHJ,EAGKI,EAAA1B,CAAA,EAFHsB,EAAoDtB,EAAA8kB,CAAA,SACpDxjB,EAA0CtB,EAAAqB,CAAA,gBAE5CC,EAKMI,EAAAqjB,CAAA,sCAERzjB,EAEKT,EAAAY,CAAA,6EAX2BV,EAAA,MAAA6xB,OAAAnyB,OAAG,MAAK,KAAAsE,GAAAguB,EAAAH,CAAA,EAG/BnyB,OAAe,4DAGnBM,EAAA,eAAA8xB,OAAApyB,OAAe,OAAM,KAAAsE,GAAAiuB,EAAAH,CAAA,mBAJsFhZ,EAAAkL,EAAA,aAAAtkB,OAAe,OAAO,iBAQnIA,EAAE,KAAC,UAAU,OAAM,KAAAsE,GAAAsoC,EAAAC,CAAA,EAAMvsC,EAAA,MAAAosC,OAAA1sC,OAAG,YAAW,KAAAsE,GAAAwoC,EAAAJ,CAAA,qHAzBxC1sC,EAAc,KAAC,SAAW,MAAQ,kCAChCA,EAAc,KAAC,SAAW,KAAO,gCACjCA,EAAc,KAAC,SAAW,KAAO,oCACjCA,EAAc,KAAC,SAAW,KAAO,8BACjCA,EAAc,KAAC,SAAW,KAAO,gCACjCA,EAAc,KAAC,SAAW,KAAO,qCACjCA,EAAc,KAAC,SAAW,cAC1BA,EAAc,KAAC,SAAW,WAAa,kCACT,KAC/BA,EAAoB,KAAKA,EAAO,KAAG,4CAA8C,sCACzDoZ,EAAAhZ,EAAA,oBAAAJ,OAAe,OAAO,6DAiClDkE,EAAAlE,OAAU,MAAK,WAGbA,EAAS,KAAC,UAAU,OAAM,OAAiBk8B,EAAAl8B,OAAU,YAAW,kDAG1D+sC,GAAA7zB,GAAAlZ,OAAU,mBAAmB,0BAAlC,OAAInoE,IAAA,+BASHmoE,EAAqB,KAAAgtC,GAAAhtC,CAAA,IA0BzBA,EAAmB,KAAAitC,GAAA,EA+CfC,EAAAh0B,GAAAlZ,OAAU,SAAS,yBAAxB,OAAInoE,IAAA,qGArF0B,iBAAe,aAAuB,SACpE,ovDAPJynE,EAyCK7qB,GAAAusB,EAAAjmD,CAAA,EAxCH8lD,EAuCKG,EAAAC,CAAA,EAtCLJ,EAEII,EAAA2nC,CAAA,gBACF/nC,EAEKI,EAAAL,CAAA,qCACLC,EAOKI,EAAA1B,CAAA,iHAoCTD,EAoCK7qB,GAAA0+B,EAAAp4D,CAAA,EAnCH8lD,EAkCKsS,EAAAF,CAAA,EAjCLpS,EAEIoS,EAAAk6B,CAAA,SACJtsC,EA6BKoS,EAAA9R,CAAA,EA5BHN,EAMQM,EAAA6D,CAAA,SACRnE,EAMQM,EAAA8D,CAAA,SACRpE,EAMQM,EAAA+D,CAAA,SACRrE,EAMQM,EAAAiE,CAAA,YAMZ9F,EAsFK7qB,GAAAkwC,GAAA5pE,CAAA,mKA7KAulD,EAAA,OAAA4D,OAAAlE,QAAU,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,kBAGblE,GAAS,KAAC,UAAU,OAAM,KAAAsE,GAAAigB,EAAAJ,CAAA,EAAiB7jB,EAAA,OAAA47B,OAAAl8B,QAAU,YAAW,KAAAsE,GAAA23B,EAAAC,CAAA,WAG1D6Q,GAAA7zB,GAAAlZ,QAAU,mBAAmB,wBAAlC,OAAInoE,IAAA,oIAAJ,UASCmoE,GAAqB,wEA0BzBA,GAAmB,0FA+CfktC,EAAAh0B,GAAAlZ,QAAU,SAAS,uBAAxB,OAAInoE,IAAA,mIAAJ,gIAhF6BqsE,EAAAwkC,GAAkB1oC,EAAI,iBACtCA,EAAI,yNAFbV,EAGM7qB,EAAA4mD,EAAAtgF,CAAA,EAFJ8lD,EAAqDw6B,EAAAhX,CAAA,gBACrDxjB,EAAkBw6B,EAAA/W,CAAA,wBADKhkB,EAAA,OAAA4D,OAAAwkC,GAAkB1oC,EAAI,WAAAsE,GAAAC,EAAAL,CAAA,kBACtClE,EAAI,UAAAsE,GAAAigB,EAAAJ,CAAA,6CAuBVnkB,EAAe,IAAG,KAAO,YACzBA,EAAe,IAAG,UAAY,yBAhB5BA,EAAkB,KAAAotC,GAAA,6EAgBqB,kBAC5C,gCANsBptC,EAAe,IAAG,gCAAkC,iCAA+B,qGAChGA,EAAe,IAAG,0BAA4B,0BAA0B,aACrEA,EAAkB,mDAdhCV,EAmBK7qB,EAAAt8B,EAAA4C,CAAA,wBAZH8lD,EAWQ1oD,EAAAioD,CAAA,sEAjBHJ,EAAkB,yEAepBA,EAAe,IAAG,KAAO,QAAKsE,GAAA0U,EAAAD,CAAA,yBAC9B/Y,EAAe,IAAG,UAAY,aAAUsE,GAAAguB,EAAAH,CAAA,yCALrBnyB,EAAe,IAAG,gCAAkC,iCAA+B,8HAChGA,EAAe,IAAG,0BAA4B,wEAC3CA,EAAkB;8JAZ5BV,EAGK7qB,EAAA8qB,EAAAxkD,CAAA,0RAqBbukD,EAEK7qB,EAAAt8B,EAAA4C,CAAA,2CA2DuCilD,EAAQ,KAAC,cAAgB,EAAC,+BADwB,mCACnD,0GADnCV,EAEK7qB,EAAAt8B,EAAA4C,CAAA,wCAD+BilD,EAAQ,KAAC,cAAgB,EAAC,KAAAsE,GAAA0U,EAAAD,CAAA,yCAJtBxL,EAAAvN,OAAS,OAAM,8LADvDV,EAEK7qB,EAAA8qB,EAAAxkD,CAAA,EADH8lD,EAA2DtB,EAAAqB,CAAA,wBAArBN,EAAA,OAAAiN,OAAAvN,OAAS,OAAM,MAAAY,EAAA,UAAA2M,wCAU9C8/B,EAAAn0B,GAAAlZ,OAAS,WAAW,uBAAzB,OAAInoE,GAAA,uHADRynE,EAOK7qB,EAAAt8B,EAAA4C,CAAA,uEANIsyF,EAAAn0B,GAAAlZ,OAAS,WAAW,oBAAzB,OAAInoE,GAAA,qHAAJ,uDAEyBqsE,EAAAwkC,GAAkB1oC,EAAI,iBACtCA,EAAI,oNAFbV,EAGM7qB,EAAA4mD,EAAAtgF,CAAA,EAFJ8lD,EAAqDw6B,EAAAhX,CAAA,gBACrDxjB,EAAkBw6B,EAAA/W,CAAA,wBADKhkB,EAAA,OAAA4D,OAAAwkC,GAAkB1oC,EAAI,WAAAsE,GAAAC,EAAAL,CAAA,kBACtClE,EAAI,UAAAsE,GAAAigB,EAAAJ,CAAA,6CAcN5W,EAAAvN,OAAS,WAAU,2YAN9BV,EAQK7qB,EAAAwsB,EAAAlmD,CAAA,EAPH8lD,EAGKI,EAAAL,CAAA,SACLC,EAEKI,EAAA1B,CAAA,wBADIe,EAAA,OAAAiN,OAAAvN,OAAS,WAAU,MAAAT,EAAA,UAAAgO,gDAjCpBvN,EAAQ,KAAC,cAAgB,EAAC,qFAIjCA,GAAQ,KAAC,QAAUA,QAAS,SAAM,YAAiBA,GAAM,KAAG,CAAC,GAAAstC,6BAU7DttC,EAAS,KAAC,mBAAqBA,OAAS,YAAY,OAAS,GAACke,GAAAle,CAAA,EAY9DyU,EAAAzU,EAAqB,KAAIA,EAAe,KAAIA,OAAS,YAAU+c,GAAA/c,CAAA,0LA3ByB,WAClF,4JAmDT,IAEA,0BAKA,IAEA,0BAKA,IAEA,0BAKA,IAEA,qLAzB6Dh7B,EAAAggC,EAAA,QAAA+S,EAAA,uDAAA/X,SAAkB,KAAO,0BAA4B,+CAA8C,0BAOnGh7B,EAAAigC,EAAA,QAAAsK,EAAA,uDAAAvP,SAAkB,KAAO,wBAA0B,6CAA4C,2BAO/Fh7B,EAAAkgC,EAAA,QAAAqoC,EAAA,uDAAAvtC,SAAkB,KAAO,yBAA2B,8CAA6C,2BAOjGh7B,EAAAogC,EAAA,QAAAooC,EAAA,uDAAAxtC,SAAkB,KAAO,2BAA6B,gDAA+C,ySAzExKV,EAiFK7qB,GAAAw+B,EAAAl4D,EAAA,EAhFH8lD,EAuCKoS,EAAArS,CAAA,EAtCHC,EAEID,EAAA8e,CAAA,wFAuCN7e,EAqCKoS,EAAA9R,CAAA,EApCLN,EAmCOM,EAAAH,CAAA,EAlCLH,EAEKG,EAAAzB,CAAA,SACLsB,EA8BKG,EAAAC,CAAA,EA5BHJ,EAMQI,EAAA+D,CAAA,gBACRnE,EAMQI,EAAAgE,CAAA,gBACRpE,EAMQI,EAAAiE,CAAA,gBACRrE,EAMQI,EAAAmE,CAAA,iIA1EEpF,EAAQ,KAAC,cAAgB,EAAC,KAAAsE,GAAA0U,EAAAD,CAAA,mEAcjC/Y,EAAS,KAAC,mBAAqBA,OAAS,YAAY,OAAS,kEAY7DA,EAAqB,KAAIA,EAAe,KAAIA,OAAS,sEAuBKM,GAAA,OAAAyX,OAAA,uDAAA/X,SAAkB,KAAO,0BAA4B,iEAOrDM,GAAA,OAAAiP,OAAA,uDAAAvP,SAAkB,KAAO,wBAA0B,+DAOnDM,GAAA,OAAAitC,OAAA,uDAAAvtC,SAAkB,KAAO,yBAA2B,gEAOpDM,GAAA,OAAAktC,OAAA,uDAAAxtC,SAAkB,KAAO,2BAA6B,wKAwBtHA,EAAyB,yBAA9B,OAAInoE,GAAA,gpBALVynE,EAiCK7qB,EAAAwsB,EAAAlmD,CAAA,EAhCH8lD,EAEII,EAAAye,CAAA,SACJ7e,EA4BKI,EAAA1B,CAAA,0DAdHsB,EAaKtB,EAAAqB,CAAA,EAZHC,EAKQD,EAAAoE,CAAA,SACRnE,EAKQD,EAAAqE,CAAA,6FAzBHjF,EAAyB,sBAA9B,OAAInoE,GAAA,kHAAJ,oEAEkDmoE,EAAU,cAOvDmkB,EAAAnkB,MAAoBA,EAAU,MAAI,UAAY,2KAJIh7B,EAAAo7B,EAAA,QAAAiE,EAAA,+CAAArE,MAAoBA,EAAU,MAC7E,6CACA,8CAA6C,sGANrDV,EAUK7qB,EAAAt8B,EAAA4C,CAAA,EATH8lD,EAAiE1oD,EAAAojC,CAAA,gBACjEslB,EAOQ1oD,EAAAioD,CAAA,kEARwCJ,EAAU,UAAAsE,GAAAC,EAAAL,CAAA,EAOvD5D,EAAA,SAAA6jB,OAAAnkB,MAAoBA,EAAU,MAAI,UAAY,eAAYsE,GAAAigB,EAAAJ,CAAA,EAJR7jB,EAAA,SAAA+D,OAAA,+CAAArE,MAAoBA,EAAU,MAC7E,6CACA,kOA/sBLgd,GAAAhd,EAAc,MAAK,SAAW,OAAO,KAAKA,EAAU,KAAC,gBAAgB,EAAE,OAAS,KA3C1EA,EAAU,KAAC,kBAAoB,GAACud,GAAAvd,CAAA,sJAFJytC,GAAWztC,EAAU,KAAC,aAAa,uCAClCytC,GAAWztC,EAAU,KAAC,WAAW,qHAUHytC,GAAWztC,EAAU,KAAC,OAAO,yFAI3BytC,GAAWztC,EAAU,KAAC,OAAO,yFAI3BytC,GAAWztC,EAAU,KAAC,OAAO,gFAS/B0tC,GAAA,eAAA1tC,OAAW,UAAU,iGAKrB2tC,EAAA,eAAA3tC,OAAW,SAAS,oGAKpB4tC,GAAA,eAAA5tC,OAAW,cAAc,o9DA7CrGV,EA0EK7qB,GAAA6hD,EAAAv7E,EAAA,EAzEH8lD,EAwEKy1B,EAAAkB,CAAA,EAtEH32B,EA8CK22B,EAAAH,CAAA,EA7CHx2B,EASKw2B,EAAAl2B,CAAA,EARHN,EAOKM,EAAAH,CAAA,EANHH,EAAwDG,EAAAJ,CAAA,SACxDC,EAA2EG,EAAAzB,CAAA,SAC3EsB,EAA0EG,EAAAC,CAAA,iCAO9EJ,EAaKw2B,EAAA5S,CAAA,EAZH5jB,EAGK4jB,EAAAxR,CAAA,EAFHpS,EAA0EoS,EAAAoR,CAAA,SAC1ExjB,EAAqGoS,EAAAqR,CAAA,SAEvGzjB,EAGK4jB,EAAAtR,CAAA,EAFHtS,EAA0EsS,EAAAkoB,CAAA,SAC1Ex6B,EAAuGsS,EAAA06B,CAAA,SAEzGhtC,EAGK4jB,EAAAE,CAAA,EAFH9jB,EAA0E8jB,EAAAmpB,CAAA,SAC1EjtC,EAAyG8jB,EAAAopB,CAAA,SAI7GltC,EAAyDw2B,EAAA5xB,CAAA,SAEzD5E,EAgBKw2B,EAAAF,CAAA,EAfHt2B,EAIKs2B,EAAA3xB,EAAA,EAHH3E,EAAoD2E,GAAAE,CAAA,UACpD7E,EAA8F2E,GAAAkoC,EAAA,UAC9F7sC,EAAmF2E,GAAAwoC,EAAA,SAErFntC,EAIKs2B,EAAA7xB,CAAA,EAHHzE,EAAqDyE,EAAAC,CAAA,UACrD1E,EAA6FyE,EAAAqoC,CAAA,UAC7F9sC,EAAiFyE,EAAA2oC,EAAA,UAEnFptC,EAIKs2B,EAAAvE,EAAA,EAHH/xB,EAAmD+xB,GAAAJ,EAAA,WACnD3xB,EAAkG+xB,GAAAgb,EAAA,WAClG/sC,EAAwF+xB,GAAAsb,EAAA,qCArCnFluC,GAAU,KAAC,kBAAoB,GAACc,GAAA,EAAAd,GAAAM,EAAA,EA2CtCA,GAAA,UAAA0c,GAAAhd,GAAc,MAAK,SAAW,OAAO,KAAKA,GAAU,KAAC,gBAAgB,EAAE,OAAS,gLA1C3CA,EAAU,KAAC,iBAAiB,SAAQA,OAAW,kBAAoB,EAAI,IAAM,EAAE,YAAWA,EAAU,KAAC,kBAAoB,EAAI,IAAM,EAAE,8CAAvKV,EAA8K7qB,EAAAt8B,EAAA4C,CAAA,wDA0D7K,OAAO,KAAKilD,OAAW,gBAAgB,EAAE,OAAS,OAXhD,OAAO,QAAQA,EAAU,KAAC,gBAAgB,EAAE,MAAM,EAAG,CAAC,wBAA3D,OAAInoE,GAAA,+WAJRynE,EAAyE7qB,EAAAmsB,EAAA7lD,CAAA,WAEzEukD,EAgBK7qB,EAAA8qB,EAAAxkD,CAAA,EAfH8lD,EAAmFtB,EAAAhkB,CAAA,wGAC5E,OAAO,QAAQykB,EAAU,KAAC,gBAAgB,EAAE,MAAM,EAAG,CAAC,qBAA3D,OAAInoE,GAAA,kHAAJ,iIAM2BwsF,EAAA,eAAAqkB,GAAkB1oC,EAAI,2CACxCA,EAAI,KAAC,OAAS,EAAIA,OAAK,UAAU,EAAG,CAAC,EAAI,MAAQA,EAAI,yBACxBq7B,EAAA,eAAAr7B,EAAI,KAAC,YAAY,QAAQ,CAAC,yKAL1CoZ,EAAAjhE,EAAA,aAAA6nD,OAAK,OAAO,cACxBA,EAAI,UAAIA,EAAI,KAAC,YAAY,QAAQ,CAAC,SAAOA,EAAI,KAAC,MAAM,UAH9DV,EAQK7qB,EAAAt8B,EAAA4C,CAAA,EAHH8lD,EAAuD1oD,EAAAksE,CAAA,SACvDxjB,EAAmE1oD,EAAAmsE,CAAA,SACnEzjB,EAAuE1oD,EAAAkjF,CAAA,qFAIJ,OAAO,KAAKr7B,OAAW,gBAAgB,EAAE,OAAS,CAAC,+EAAxHV,EAA+H7qB,EAAA8G,EAAAxgC,CAAA,83BAUzIukD,EAsBK7qB,EAAAt8B,EAAA4C,CAAA,EArBH8lD,EAMQ1oD,EAAA6sD,CAAA,SACRnE,EAMQ1oD,EAAA8sD,CAAA,SACRpE,EAMQ1oD,EAAA+sD,CAAA,sBAnBIlF,EAAmB,kBAOnBA,EAAyB,kBAOzBA,EAAU,8dAwBpBV,EAQQ7qB,EAAA2rB,EAAArlD,CAAA,qFAKPmpD,EAAAlE,MAAiB,OAAM,OAA0BmkB,EAAAnkB,KAAS,OAAM,oCAAxC,0BAAwB,0FADnDV,EAEG7qB,EAAArwB,EAAArJ,CAAA,+BADAulD,EAAA,YAAA4D,OAAAlE,MAAiB,OAAM,KAAAsE,GAAAC,EAAAL,CAAA,EAA0B5D,EAAA,MAAA6jB,OAAAnkB,KAAS,OAAM,KAAAsE,GAAAigB,EAAAJ,CAAA,mDAgJxDpL,EAAA/Y,OAAQ,IAAG,SAGXmyB,EAAAnyB,OAAQ,OAAM,6BAiCVoyB,EAAApyB,OAAM,QAAO,WAEsD0rC,EAAA1rC,OAAM,MAAK,aAYpFmuC,EAAAnuC,OAAa,OAAM,eAqBnBA,EAAc,MAAK,SAAW,OAAO,KAAKA,EAAkB,MAAE,OAAS,gBAwC3CA,EAAkB,iBAAUA,EAAc,iDAvDlEA,EAAc,6BAAnB,OAAInoE,IAAA,oFAmELmoE,EAAW,MAAA2e,GAAA3e,CAAA,qRArF8D,GAAC,qLAyElB,GAAC,gBAAgB,YAC1E,kHA3HkBoZ,EAAAxY,EAAA,aAAAZ,OAAa,OAAO,iHAaDouC,GAAcpuC,EAAO,KAAC,IAAI,kQAwBhDh7B,EAAAwyC,EAAA,SAAA62B,EAAAruC,OAAa,OAAO,sDAETA,EAAK,KAAC,QAAUA,EAAK,KAAC,MAAQ,MAAM,QAAQ,CAAC,oJAOnBoZ,EAAAnY,EAAA,QAAAjB,OAAa,OAAO,0VAalDoZ,EAAAqL,GAAA,aAAAzkB,OAAa,OAAO,4cAsEgBA,EAAgB,KAAG,eAAiBA,OAAqB,EAAI,gBAAkB,cAAa,kBAChJA,EAAgB,KAAG,UAAYA,OAAqB,EAAI,WAAa,cAAc,yeAvI/FV,EAiKK7qB,GAAA+9C,EAAAz3E,EAAA,EA9JH8lD,EAGM2xB,EAAA5xB,CAAA,SAENC,EA0HQ2xB,EAAAxtB,CAAA,EArHNnE,EA6CKmE,EAAA2f,CAAA,EA5CH9jB,EAOK8jB,EAAAplB,CAAA,EANHsB,EAEItB,EAAAmgB,CAAA,gBACJ7e,EAEGtB,EAAAn7C,CAAA,gBAILy8C,EAiCK8jB,EAAAxR,CAAA,EAhCHtS,EAsBKsS,EAAA/6D,CAAA,EApBHyoD,EAQCzoD,EAAAm/D,CAAA,EAED1W,EASCzoD,EAAAo/D,CAAA,SAGH3W,EAOKsS,EAAAF,CAAA,EANHpS,EAKKoS,EAAA9R,CAAA,EAJHN,EAEKM,EAAAF,CAAA,gBACLJ,EAAuFM,EAAAH,CAAA,wBAO/FH,EAOKmE,EAAAS,CAAA,EANH5E,EAKK4E,EAAAgf,EAAA,kBAIP5jB,EAaHmE,EAAAU,CAAA,0FAyCG7E,EAIKmE,EAAAO,EAAA,EAHH1E,EAEK0E,GAAAC,EAAA,EADH3E,EAAuD2E,GAAAjqB,EAAA,8CAM7DslB,EAGM2xB,EAAAltB,EAAA,mCAkBNzE,EAMQ2xB,EAAAvtB,EAAA,mGA3JcmU,EAAAxY,EAAA,aAAAZ,OAAa,OAAO,EAWjCM,GAAA,YAAAyY,OAAA/Y,OAAQ,IAAG,KAAAsE,GAAA0U,EAAAD,CAAA,EAGXzY,GAAA,YAAA6xB,OAAAnyB,OAAQ,OAAM,KAAAsE,GAAAguB,EAAAH,CAAA,mDADkBic,GAAcpuC,EAAO,KAAC,IAAI,mBAwBhDM,GAAA,YAAA+tC,OAAAruC,OAAa,iDAEFA,EAAK,KAAC,QAAUA,EAAK,KAAC,MAAQ,MAAM,QAAQ,CAAC,uCAQ9DM,GAAA,YAAA8xB,OAAApyB,OAAM,QAAO,KAAAsE,GAAAiuB,EAAAH,CAAA,iBAD8BhZ,EAAAnY,EAAA,QAAAjB,OAAa,OAAO,EAGIM,GAAA,YAAAorC,OAAA1rC,OAAM,MAAK,KAAAsE,GAAA8nC,GAAAV,CAAA,EAYpFprC,GAAA,YAAA6tC,OAAAnuC,OAAa,OAAM,KAAAsE,GAAAgqC,GAAAH,CAAA,iBAFA/0B,EAAAqL,GAAA,aAAAzkB,OAAa,OAAO,yCAQnCA,EAAc,0BAAnB,OAAInoE,IAAA,4IAAJ,0BAeCmoE,EAAc,MAAK,SAAW,OAAO,KAAKA,EAAkB,MAAE,OAAS,8FAwC3CA,EAAkB,UAAAsE,GAAAiqC,GAAAC,EAAA,oBAAUxuC,EAAc,SAAAsE,GAAAmqC,GAAAC,EAAA,kFAOf1uC,EAAgB,KAAG,eAAiBA,OAAqB,EAAI,gBAAkB,0DACnIA,EAAgB,KAAG,UAAYA,OAAqB,EAAI,WAAa,kCAI1EA,EAAW,0KAvOP+Y,EAAA/Y,OAAQ,IAAG,SAGXmyB,EAAAnyB,OAAQ,OAAM,WAShBykC,EAAAzkC,OAAM,QAAO,OAAGuoC,EAAAvoC,OAAM,MAAK,aAqB3BA,EAAc,MAAK,SAAW,OAAO,KAAKA,EAAkB,MAAE,OAAS,QA0BzEA,EAAkB,eAAGA,EAAc,+BAzC5BA,EAAc,4BAAnB,OAAInoE,IAAA,kFA8CNmoE,EAAW,MAAA4e,GAAA5e,CAAA,mLApDK,GAAC,mHA+CE,GAAC,cAAgB,YACvC,uIAxE4DA,EAAgB,KAAG,eAAiBA,OAAqB,EAAI,gBAAkB,cAAa,gBAChJA,EAAgB,KAAG,UAAYA,OAAqB,EAAI,WAAa,cAAc,0GAapDouC,GAAcpuC,EAAO,KAAC,IAAI,6EAQ9CoZ,EAAAnY,EAAA,QAAAjB,OAAa,OAAO,EAAgBoZ,EAAAnY,EAAA,aAAAjB,OAAa,OAAO,6oBA1B/EV,EAwGK7qB,GAAA0+B,EAAAp4D,EAAA,EArGH8lD,EAGMsS,EAAAvS,CAAA,SAENC,EAqEQsS,EAAAnO,CAAA,EAhENnE,EAiBKmE,EAAAhE,CAAA,EAhBHH,EAOKG,EAAAzB,CAAA,EANHsB,EAEEtB,EAAAmgB,CAAA,gBACF7e,EAEGtB,EAAAn7C,CAAA,gBAILy8C,EAKKG,EAAAC,CAAA,8BAINJ,EAaImE,EAAA7D,CAAA,0FA4BLN,EAEKmE,EAAAiO,CAAA,gEAqBPpS,EAMQsS,EAAAlO,CAAA,8JAnGsDjF,EAAgB,KAAG,eAAiBA,OAAqB,EAAI,gBAAkB,sDACnIA,EAAgB,KAAG,UAAYA,OAAqB,EAAI,WAAa,gCAWtEM,GAAA,YAAAyY,OAAA/Y,OAAQ,IAAG,KAAAsE,GAAA0U,EAAAD,CAAA,EAGXzY,GAAA,YAAA6xB,OAAAnyB,OAAQ,OAAM,KAAAsE,GAAAguB,EAAAH,CAAA,mDADkBic,GAAcpuC,EAAO,KAAC,IAAI,mBAU5DM,GAAA,YAAAmkC,OAAAzkC,OAAM,QAAO,KAAAsE,GAAAogC,EAAAD,CAAA,EAAGnkC,GAAA,YAAAioC,OAAAvoC,OAAM,MAAK,KAAAsE,GAAAmkC,EAAAF,CAAA,iBAFbnvB,EAAAnY,EAAA,QAAAjB,OAAa,OAAO,iBAAgBoZ,EAAAnY,EAAA,aAAAjB,OAAa,OAAO,wCAQjEA,EAAc,yBAAnB,OAAInoE,IAAA,0IAAJ,yBAeAmoE,EAAc,MAAK,SAAW,OAAO,KAAKA,EAAkB,MAAE,OAAS,2FA0BzEA,EAAkB,UAAAsE,GAAAgqC,EAAAH,CAAA,kBAAGnuC,EAAc,SAAAsE,GAAAq+B,EAAAC,CAAA,EAKnC5iC,EAAW,iKA6GCmyB,EAAAnyB,OAAU,EAAC,OAAIykC,EAAAzkC,OAAe,QAAO,OAAGuoC,EAAAvoC,OAAe,OAAM,2CAD/CqkB,EAAA,eAAAsqB,GAAgB3uC,EAAO,8BACxC,IAAE,aAAa,IAAE,aAAwB,GAAC,yIAJ5BoZ,EAAAjhE,EAAA,aAAA6nD,OAAe,OAAO,EACzBh7B,EAAA7sB,EAAA,QAAAy2F,EAAA,aAAA5uC,EAAO,KAAG,GAAC,KAAIA,EAAc,KAAC,QAAO,IAAGA,EAAc,KAAC,OAAM,aAAYA,OAAe,MAAM,UAHjHV,EAOH7qB,EAAAt8B,EAAA4C,CAAA,EAFK8lD,EAAsD1oD,EAAAksE,CAAA,SACtDxjB,EAA6E1oD,EAAAmsE,CAAA,2DAArDhkB,EAAA,YAAAmkC,OAAAzkC,OAAe,QAAO,KAAAsE,GAAAogC,EAAAD,CAAA,EAAGnkC,EAAA,YAAAioC,OAAAvoC,OAAe,OAAM,KAAAsE,GAAAmkC,EAAAF,CAAA,kBAJlDnvB,EAAAjhE,EAAA,aAAA6nD,OAAe,OAAO,EACzBM,EAAA,cAAAsuC,OAAA,aAAA5uC,EAAO,KAAG,GAAC,KAAIA,EAAc,KAAC,QAAO,IAAGA,EAAc,KAAC,OAAM,aAAYA,OAAe,+DAoCtGgd,EAAA,OAAO,KAAKhd,EAAkB,MAAE,OAAS,OAzBvC,OAAO,QAAQA,QAAoB,MAAM,EAAG,CAAC,wBAAlD,OAAInoE,GAAA,mKADRynE,EAiCK7qB,EAAAt8B,EAAA4C,CAAA,sHAhCI,OAAO,QAAQilD,QAAoB,MAAM,EAAG,CAAC,qBAAlD,OAAInoE,GAAA,kHAAJ,OAyBGyoE,EAAA,aAAA0c,EAAA,OAAO,KAAKhd,EAAkB,MAAE,OAAS,uHAbvCkE,EAAAlE,OAAU,MAAK,eAISmkB,EAAAukB,GAAkB1oC,EAAI,kBACkCA,EAAI,KAAC,OAAS,GAAKA,OAAK,UAAU,EAAG,EAAE,EAAI,MAAQA,EAAI,eAIvIoyB,EAAApyB,OAAS,QAAO,OAAG6sC,EAAA7sC,OAAS,MAAK,iJAAhB,GAAC,yIAZCoZ,EAAAxY,EAAA,aAAAZ,OAAU,OAAO,EAC7Bh7B,EAAA47B,EAAA,QAAA6rC,EAAAzsC,OAAU,SAAS,8MAUiBoZ,EAAApY,EAAA,QAAAhB,OAAU,OAAO,gJAdjEV,EAiBK7qB,EAAA0sB,EAAApmD,CAAA,EAhBH8lD,EAMKM,EAAAP,CAAA,gBACLC,EAKKM,EAAAF,CAAA,EAJHJ,EAGKI,EAAA1B,CAAA,EAFHsB,EAAqDtB,EAAA8kB,CAAA,gBACrDxjB,EAA6ItB,EAAA+kB,CAAA,gBAGjJzjB,EAEKM,EAAAH,CAAA,+BAVFV,EAAA,YAAA4D,OAAAlE,OAAU,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,gBAHIkV,EAAAxY,EAAA,aAAAZ,OAAU,OAAO,EAC7BM,EAAA,YAAAmsC,OAAAzsC,OAAU,2BAMOM,EAAA,YAAA6jB,OAAAukB,GAAkB1oC,EAAI,WAAAsE,GAAAigB,EAAAJ,CAAA,wBACkCnkB,EAAI,KAAC,OAAS,GAAKA,OAAK,UAAU,EAAG,EAAE,EAAI,MAAQA,EAAI,WAAAsE,GAAA23B,EAAAC,CAAA,EAIvI57B,EAAA,YAAA8xB,OAAApyB,OAAS,QAAO,KAAAsE,GAAAiuB,EAAAH,CAAA,EAAG9xB,EAAA,YAAAusC,OAAA7sC,OAAS,MAAK,KAAAsE,GAAAsoC,EAAAC,CAAA,gBADUzzB,EAAApY,EAAA,QAAAhB,OAAU,OAAO,2CAQ3D+Y,EAAA,OAAO,KAAK/Y,EAAkB,MAAE,OAAS,EAAC,0CADK,GAChD,aAA4C,WAC/C,wGAHFV,EAIK7qB,EAAAt8B,EAAA4C,CAAA,EAHH8lD,EAEG1oD,EAAAiM,CAAA,+BADCk8C,EAAA,YAAAyY,OAAA,OAAO,KAAK/Y,EAAkB,MAAE,OAAS,EAAC,KAAAsE,GAAA0U,EAAAD,CAAA,2CA8BjDA,EAAA/Y,EAAW,GAACA,EAAO,KAAC,EAAE,EAAE,YAAW,qCAFvB;AAAA;AAAA,mBACf,6jBAJOh7B,EAAAi8B,EAAA,QAAA4tC,EAAA7uC,EAAW,GAACA,EAAO,KAAC,EAAE,EAAE,WAAW,UAF5CV,EAUK7qB,EAAAwsB,EAAAlmD,CAAA,SAJH8lD,EAGKI,EAAA1B,CAAA,gBADHsB,EAAyHtB,EAAAqB,CAAA,UADxHN,EAAA,YAAAyY,OAAA/Y,EAAW,GAACA,EAAO,KAAC,EAAE,EAAE,YAAW,KAAAsE,GAAA0U,EAAAD,CAAA,EAL/BzY,EAAA,YAAAuuC,OAAA7uC,EAAW,GAACA,EAAO,KAAC,EAAE,EAAE,0EA/MjBmyB,EAAAnyB,OAAU,EAAC,OAAIykC,EAAAzkC,OAAe,QAAO,OAAGuoC,EAAAvoC,OAAe,OAAM,2CAD/CqkB,EAAA,eAAAsqB,GAAgB3uC,EAAO,8BACxC,IAAE,aAAa,IAAE,aAAwB,GAAC,4HAJ5BoZ,EAAAjhE,EAAA,aAAA6nD,OAAe,OAAO,EACzBh7B,EAAA7sB,EAAA,QAAAy2F,EAAA,aAAA5uC,EAAO,KAAG,GAAC,KAAIA,EAAc,KAAC,QAAO,IAAGA,EAAc,KAAC,OAAM,aAAYA,OAAe,MAAM,UAHjHV,EAOK7qB,EAAAt8B,EAAA4C,CAAA,EAFH8lD,EAAsD1oD,EAAAksE,CAAA,SACtDxjB,EAA6E1oD,EAAAmsE,CAAA,2DAArDhkB,EAAA,YAAAmkC,OAAAzkC,OAAe,QAAO,KAAAsE,GAAAogC,EAAAD,CAAA,EAAGnkC,EAAA,YAAAioC,OAAAvoC,OAAe,OAAM,KAAAsE,GAAAmkC,EAAAF,CAAA,kBAJlDnvB,EAAAjhE,EAAA,aAAA6nD,OAAe,OAAO,EACzBM,EAAA,cAAAsuC,OAAA,aAAA5uC,EAAO,KAAG,GAAC,KAAIA,EAAc,KAAC,QAAO,IAAGA,EAAc,KAAC,OAAM,aAAYA,OAAe,kEAWrG,OAAO,QAAQA,EAAkB,4BAAtC,OAAInoE,GAAA,mIADRynE,EAoBK7qB,EAAAt8B,EAAA4C,CAAA,gGAnBI,OAAO,QAAQilD,EAAkB,yBAAtC,OAAInoE,GAAA,qHAAJ,uDAYKqsE,EAAAlE,OAAU,MAAK,WAEKmkB,EAAAukB,GAAkB1oC,EAAI,kBACgCA,EAAI,KAAC,OAAS,EAAIA,OAAK,UAAU,EAAG,CAAC,EAAI,MAAQA,EAAI,iBACzEuoC,EAAAvoC,OAAS,QAAO,OAAG0rC,EAAA1rC,OAAS,MAAK,yHAAnC,GAAC,aAAkB,GAAC,aAAgB,GAAC,0HAPtEoZ,EAAAxY,EAAA,aAAAZ,OAAU,OAAO,gBAC7BA,EAAI,UAAIA,EAAQ,KAAC,QAAO,IAAGA,EAAQ,KAAC,MAAK,MAAKA,EAAS,KAAC,SAAS,uQAJ7EV,EAWK7qB,EAAA8qB,EAAAxkD,CAAA,EAVH8lD,EAMKtB,EAAAqB,CAAA,gBACLC,EAAqDtB,EAAA8kB,CAAA,gBACrDxjB,EAAyItB,EAAA+kB,CAAA,gBACzIzjB,EAAkGtB,EAAA87B,CAAA,oDAJ/F/6B,EAAA,YAAA4D,OAAAlE,OAAU,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,gBAHIkV,EAAAxY,EAAA,aAAAZ,OAAU,OAAO,uBAC7BA,EAAI,UAAIA,EAAQ,KAAC,QAAO,IAAGA,EAAQ,KAAC,MAAK,MAAKA,EAAS,KAAC,2BAI3CM,EAAA,YAAA6jB,OAAAukB,GAAkB1oC,EAAI,WAAAsE,GAAAigB,EAAAJ,CAAA,wBACgCnkB,EAAI,KAAC,OAAS,EAAIA,OAAK,UAAU,EAAG,CAAC,EAAI,MAAQA,EAAI,WAAAsE,GAAA23B,EAAAC,CAAA,EACzE57B,EAAA,YAAAioC,OAAAvoC,OAAS,QAAO,KAAAsE,GAAAmkC,EAAAF,CAAA,EAAGjoC,EAAA,YAAAorC,OAAA1rC,OAAS,MAAK,KAAAsE,GAAA8nC,EAAAV,CAAA,6CAsB5D3yB,EAAA/Y,EAAW,GAACA,EAAO,KAAC,EAAE,EAAE,YAAW,uCAF3C;AAAA;AAAA,mBAC5B,0oBALOh7B,EAAAg8B,EAAA,QAAA8tC,EAAA9uC,EAAW,GAACA,EAAO,KAAC,EAAE,EAAE,WAAW,EAC5Bh7B,EAAAg8B,EAAA,eAAA+tC,EAAA/uC,EAAW,GAACA,EAAO,KAAC,EAAE,EAAE,WAAW,UAHnDV,EAYK7qB,EAAAusB,EAAAjmD,CAAA,SALH8lD,EAIKG,EAAAC,CAAA,EAHHJ,EAA2EI,EAAAL,CAAA,gBAE3EC,EAAsJI,EAAA1B,CAAA,UAFpHe,EAAA,YAAAyY,OAAA/Y,EAAW,GAACA,EAAO,KAAC,EAAE,EAAE,YAAW,KAAAsE,GAAA0U,EAAAD,CAAA,EANhEzY,EAAA,YAAAwuC,OAAA9uC,EAAW,GAACA,EAAO,KAAC,EAAE,EAAE,6BACjBM,EAAA,YAAAyuC,OAAA/uC,EAAW,GAACA,EAAO,KAAC,EAAE,EAAE,6FAtFvC,OAAAA,QAAwB,YAAW6d,mQA5N5B9E,EAAA/Y,KAAS,OAAM,kDADuD,KACvE,aAAiB,sBACtB,qRAHFV,EAUK7qB,EAAAt8B,EAAA4C,CAAA,EATH8lD,EAEG1oD,EAAAiM,CAAA,8BACHy8C,EAKQ1oD,EAAAioD,CAAA,qBAJIJ,EAAiB,mBAHvBM,EAAA,MAAAyY,OAAA/Y,KAAS,OAAM,KAAAsE,GAAA0U,EAAAD,CAAA,0DAmBhBoZ,EAAAnyB,KAAe,OAAM,gHAAxB,IAAE,aAAuB,cAAY,6CAC1BA,EAAc,uNANjCV,EAQK7qB,EAAAt8B,EAAA4C,CAAA,EAPH8lD,EAEG1oD,EAAAiM,CAAA,SACHy8C,EAGI1oD,EAAAkkC,CAAA,EAFFwkB,EAA6CxkB,EAAA26C,CAAA,8BAC7Cn2B,EAA2CxkB,EAAA46C,CAAA,UADpC32B,EAAA,MAAA6xB,OAAAnyB,KAAe,OAAM,KAAAsE,GAAAguB,EAAAH,CAAA,+DAq3BHr9F,GAAAkrE,EAAQ,GAACA,EAAmB,MAA5B,YAAAlrE,GAA+B,KAAG,WAAGD,GAAAmrE,EAAQ,GAACA,EAAmB,MAA5B,YAAAnrE,GAA+B,QAAM,uBAwBlG62G,EAAA1rC,MAAiB,QAAO,OAAGmuC,EAAAnuC,MAAiB,MAAK,SAE/C4iC,EAAA5iC,EAAc,IAAC,YAAY,QAAQ,CAAC,qBActCgvC,EAAAhvC,MAAe,OAAM,uBAoCrBA,EAAc,MAAK,SAAW,OAAO,KAAKA,EAAW,KAAE,OAAS,gEAyJ9D85B,GAAA95B,KAAsB,EAAC,SAAGivC,GAAAjvC,KAAS,OAAM,gFAvGvCA,EAAc,6BAAnB,OAAInoE,IAAA,mDAmEImoE,GAAW,OAAAwS,4BAgBZxS,EAAY,KAAAsT,GAAA,KAIdtT,EAAY,KAAAC,GAAAD,CAAA,uEAtN4D,8BACrD,sKAwBE,GAAC,qCAEc,GACzC,6fAyM+C,QAC7C,gBAAyB,GAAC,kDAOhC,mBAEA,oGAWA,iBAEA,8ZArOmBoZ,EAAAnY,EAAA,QAAAjB,MAAe,OAAO,EAAgBoZ,EAAAnY,EAAA,aAAAjB,MAAe,OAAO,wKAgB5DoZ,EAAAjY,GAAA,QAAAnB,MAAe,OAAO,EAAgBoZ,EAAAjY,GAAA,aAAAnB,MAAe,OAAO,m6BAoMnEiF,GAAA,SAAA0K,GAAA3P,OAAwB,8NAaxBoF,GAAA,SAAA8mC,GAAAlsC,EAAmB,KAAKA,EAAQ,GAAC,OAAS,khBA7PhEV,EAsQK7qB,GAAA+iD,EAAAz8E,EAAA,EArQH8lD,EAoQK22B,EAAAH,CAAA,EAnQHx2B,EAkQKw2B,EAAAF,CAAA,EAhQHt2B,EAUKs2B,EAAAv2B,CAAA,EATHC,EAEID,EAAAgoC,CAAA,qCACJ/nC,EAKQD,EAAAoE,CAAA,SAIVnE,EAqNKs2B,EAAA5xB,CAAA,EAlNH1E,EAwGK0E,EAAA4N,CAAA,EAtGHtS,EAaKsS,EAAAnS,CAAA,EAZHH,EAEIG,EAAAkuC,CAAA,SACJruC,EAQKG,EAAAC,CAAA,8BAHHJ,EAEKI,EAAA1B,CAAA,uBAKTsB,EAUKsS,EAAAF,EAAA,EATHpS,EAEIoS,GAAAk8B,CAAA,UACJtuC,EAKKoS,GAAA9R,EAAA,kEAgFTN,EAqGK0E,EAAAC,EAAA,EApGH3E,EAEI2E,GAAA4pC,EAAA,WACJvuC,EAgDK2E,GAAAmf,EAAA,qEAGL9jB,EA6CK2E,GAAAE,EAAA,EA5CH7E,EAEI6E,GAAA2pC,EAAA,WACJxuC,EAKW6E,GAAA+oB,EAAA,QAJGzuB,EAAiB,cAO/Ba,EAgCK6E,GAAAD,EAAA,EA/BH5E,EAEI4E,GAAA0nC,EAAA,WACJtsC,EAoBK4E,GAAAgf,EAAA,8EAeb5jB,EA0BKs2B,EAAAvE,EAAA,EAzBH/xB,EAEK+xB,GAAAttB,EAAA,+CACLzE,EAqBK+xB,GAAAJ,EAAA,EApBH3xB,EAMQ2xB,GAAAvtB,EAAA,oBACRpE,EAKQ2xB,GAAAttB,EAAA,WACRrE,EAMQ2xB,GAAAptB,EAAA,iCAxPEpF,EAAiB,wCAsOfA,EAAe,wCAafA,EAAW,sDAtPMlrE,GAAAkrE,GAAQ,GAACA,GAAmB,MAA5B,YAAAlrE,GAA+B,KAAG,KAAAwvE,GAAA0U,EAAAD,CAAA,oBAAGlkF,GAAAmrE,GAAQ,GAACA,GAAmB,MAA5B,YAAAnrE,GAA+B,QAAM,KAAAyvE,GAAAguB,EAAAH,CAAA,EAwBlG7xB,GAAA,SAAAorC,OAAA1rC,OAAiB,QAAO,KAAAsE,GAAA8nC,EAAAV,CAAA,EAAGprC,GAAA,SAAA6tC,OAAAnuC,OAAiB,MAAK,KAAAsE,GAAAgqC,EAAAH,CAAA,EAE/C7tC,GAAA,UAAAsiC,OAAA5iC,GAAc,IAAC,YAAY,QAAQ,CAAC,OAAAsE,GAAAq+B,EAAAC,CAAA,eAJxBxpB,EAAAnY,EAAA,QAAAjB,OAAe,OAAO,eAAgBoZ,EAAAnY,EAAA,aAAAjB,OAAe,OAAO,EAkB1EM,GAAA,UAAA0uC,OAAAhvC,OAAe,OAAM,KAAAsE,GAAAgrC,GAAAN,CAAA,eAFP51B,EAAAjY,GAAA,QAAAnB,OAAe,OAAO,eAAgBoZ,EAAAjY,GAAA,aAAAnB,OAAe,OAAO,qHAsC1EA,GAAc,MAAK,SAAW,OAAO,KAAKA,GAAW,KAAE,OAAS,mHAkD5DA,GAAc,0BAAnB,OAAInoE,IAAA,8IAAJ,2BAuDYmoE,GAAiB,mFA4BtBA,GAAY,6DAIdA,GAAY,0EAgBdM,GAAA,MAAAw5B,SAAA95B,MAAsB,EAAC,KAAAsE,GAAAu1B,GAAAC,EAAA,EAAGx5B,GAAA,MAAA2uC,SAAAjvC,MAAS,OAAM,KAAAsE,GAAAirC,GAAAN,EAAA,EAKpC3uC,GAAA,MAAAqP,SAAA3P,QAAwB,qBAaxBM,GAAA,MAAA4rC,SAAAlsC,GAAmB,KAAKA,GAAQ,GAAC,OAAS,gJAhM3CA,EAAS,KAAC,GAAK,GAACif,GAAAjf,CAAA,IAQhBA,EAAS,KAAC,GAAK,GAACge,GAAAhe,CAAA,iVAbzBV,EAsBK7qB,EAAA8qB,EAAAxkD,CAAA,EArBH8lD,EAEItB,EAAAiwC,CAAA,SACJ3uC,EAiBKtB,EAAAqB,CAAA,+CAhBEZ,EAAS,KAAC,GAAK,yDAQfA,EAAS,KAAC,GAAK,yHAJbmkB,EAAAnkB,OAAU,GAAE,OAAak8B,EAAAl8B,OAAU,GAAK,EAAI,IAAM,uFAArC,aAAW,4LAH7BV,EAKK7qB,EAAAt8B,EAAA4C,CAAA,EAJH8lD,EAA2F1oD,EAAAksE,CAAA,SAC3FxjB,EAEM1oD,EAAAmsE,CAAA,+BADHhkB,EAAA,MAAA6jB,OAAAnkB,OAAU,GAAE,KAAAsE,GAAAigB,EAAAJ,CAAA,EAAa7jB,EAAA,MAAA47B,OAAAl8B,OAAU,GAAK,EAAI,IAAM,KAAEsE,GAAA23B,EAAAC,CAAA,6CAQpD/X,EAAAnkB,OAAU,GAAE,OAAck8B,EAAAl8B,OAAU,GAAK,EAAI,IAAM,uFAAtC,cAAY,8LAH9BV,EAKK7qB,EAAAt8B,EAAA4C,CAAA,EAJH8lD,EAA6F1oD,EAAAksE,CAAA,SAC7FxjB,EAEM1oD,EAAAmsE,CAAA,+BADHhkB,EAAA,MAAA6jB,OAAAnkB,OAAU,GAAE,KAAAsE,GAAAigB,EAAAJ,CAAA,EAAc7jB,EAAA,MAAA47B,OAAAl8B,OAAU,GAAK,EAAI,IAAM,KAAEsE,GAAA23B,EAAAC,CAAA,kDAerD,OAAO,QAAQl8B,EAAW,2BAA/B,OAAInoE,GAAA,gSALVynE,EAuCK7qB,EAAA8qB,EAAAxkD,CAAA,EAtCH8lD,EAEItB,EAAAmgB,CAAA,SACJ7e,EAkCKtB,EAAAqB,CAAA,+EAjCI,OAAO,QAAQZ,EAAW,wBAA/B,OAAInoE,GAAA,qHAAJ,2DAS6BqsE,EAAAwkC,GAAkB1oC,EAAI,iBACyBA,EAAI,cAO3Ek8B,EAAAl8B,OAAU,MAAK,aAQboyB,EAAApyB,OAAS,QAAO,OAAG6sC,EAAA7sC,OAAS,MAAK,WAGjCA,EAAQ,KAAC,MAAQ,EAAO,GAAAA,EAAQ,KAAC,YAAY,QAAQ,CAAC,KAAO,wKAH5C,GAAC,8OAXDoZ,EAAA7Z,EAAA,aAAAS,OAAU,OAAO,EAC3Bh7B,EAAAu6B,EAAA,QAAAkwC,EAAAzvC,OAAU,SAAS,yFAQZoZ,EAAApY,EAAA,QAAAhB,OAAU,OAAO,oJAjBqBoZ,EAAAjG,EAAA,aAAAnT,OAAU,OAAO,EAAuBoZ,EAAAjG,EAAA,oBAAAnT,OAAU,OAAO,UAApHV,EAyBK7qB,EAAA0+B,EAAAp4D,CAAA,EAxBH8lD,EAYOsS,EAAAlS,CAAA,EAXLJ,EAGKI,EAAAL,CAAA,EAFHC,EAAqDD,EAAAyjB,CAAA,gBACrDxjB,EAAiFD,EAAA0jB,CAAA,gBAEnFzjB,EAMGI,EAAA1B,CAAA,gBAELsB,EAUKsS,EAAAF,CAAA,EATHpS,EAKKoS,EAAAjS,CAAA,8BACLH,EAEKoS,EAAA9R,CAAA,wBApBoBb,EAAA,UAAA4D,OAAAwkC,GAAkB1oC,EAAI,WAAAsE,GAAAC,EAAAL,CAAA,qBACyBlE,EAAI,UAAAsE,GAAAigB,EAAAJ,CAAA,EAO3E7jB,EAAA,UAAA47B,OAAAl8B,OAAU,MAAK,KAAAsE,GAAA23B,EAAAC,CAAA,cAHI9iB,EAAA7Z,EAAA,aAAAS,OAAU,OAAO,EAC3BM,EAAA,UAAAmvC,OAAAzvC,OAAU,2BAUjBM,EAAA,UAAA8xB,OAAApyB,OAAS,QAAO,KAAAsE,GAAAiuB,EAAAH,CAAA,EAAG9xB,EAAA,UAAAusC,OAAA7sC,OAAS,MAAK,KAAAsE,GAAAsoC,EAAAC,CAAA,cAFnBzzB,EAAApY,EAAA,QAAAhB,OAAU,OAAO,qBAK/BA,EAAQ,KAAC,MAAQ,EAAO,GAAAA,EAAQ,KAAC,YAAY,QAAQ,CAAC,KAAO,eAAYsE,GAAAwoC,EAAAJ,CAAA,cAtBrBtzB,EAAAjG,EAAA,aAAAnT,OAAU,OAAO,cAAuBoZ,EAAAjG,EAAA,oBAAAnT,OAAU,OAAO,2CAuE7GA,EAAY,KAAC,GAAK,GAACqf,GAAArf,CAAA,IAKnBA,EAAY,KAAC,GAAK,GAAC2oC,GAAA3oC,CAAA,0FAN1BV,EAWK7qB,EAAAt8B,EAAA4C,CAAA,+CAVEilD,EAAY,KAAC,GAAK,yDAKlBA,EAAY,KAAC,GAAK,mHAHlBkE,EAAAlE,OAAa,GAAE,yCAAC,KACnB,kGAFAV,EAEM7qB,EAAA8G,EAAAxgC,CAAA,wBADHulD,EAAA,OAAA4D,OAAAlE,OAAa,GAAE,KAAAsE,GAAAC,EAAAL,CAAA,uCAKfA,EAAAlE,OAAa,GAAE,yCAAC,KACnB,oGAFAV,EAEM7qB,EAAA8G,EAAAxgC,CAAA,wBADHulD,EAAA,OAAA4D,OAAAlE,OAAa,GAAE,KAAAsE,GAAAC,EAAAL,CAAA,+CAzBqE6U,EAAA/Y,OAAU,EAAC,SACtCmyB,EAAAnyB,OAAG,MAAK,WAInEykC,EAAAzkC,OAAe,OAAM,SAMzBuoC,EAAAvoC,OAAe,QAAO,OAAG0rC,EAAA1rC,OAAe,OAAM,SAC9CA,EAAc,KAAC,OAAS,OAAUA,EAAc,KAAC,QAAQA,EAAc,KAAC,OAAQ,KAAK,QAAQ,CAAC,MAAQ,YAIpGA,EAAY,KAAC,GAAK,GAAKA,EAAY,KAAC,GAAK,IAACsf,GAAAtf,CAAA,8DAhB4C,GAAC,kGAWlE,GAAC,0FAXsCoZ,EAAAiL,EAAA,QAAArkB,OAAe,OAAO,4LAIOoZ,EAAAiiB,EAAA,aAAAr7B,OAAe,OAAO,uJAMjEoZ,EAAApY,EAAA,QAAAhB,OAAe,OAAO,uCAbpBoZ,EAAAjY,EAAA,aAAAnB,OAAe,OAAO,EAAkBoZ,EAAAjY,EAAA,eAAAnB,OAAe,OAAO,UAArHV,EAiCK7qB,EAAA0sB,EAAApmD,CAAA,EAhCH8lD,EAUKM,EAAAF,CAAA,EATHJ,EAGKI,EAAAL,CAAA,EAFHC,EAA2GD,EAAAyjB,CAAA,uBAC3GxjB,EAA6ED,EAAA0jB,CAAA,gBAE/EzjB,EAIKI,EAAA1B,CAAA,EAHHsB,EAEMtB,EAAA87B,CAAA,gBAIVx6B,EAGKM,EAAAH,CAAA,2FAb4DoY,EAAAiL,EAAA,QAAArkB,OAAe,OAAO,EACrBM,EAAA,MAAA6xB,OAAAnyB,OAAG,MAAK,KAAAsE,GAAAguB,EAAAH,CAAA,EAInE7xB,EAAA,eAAAmkC,OAAAzkC,OAAe,OAAM,KAAAsE,GAAAogC,EAAAD,CAAA,mBADkErrB,EAAAiiB,EAAA,aAAAr7B,OAAe,OAAO,EAOjHM,EAAA,MAAAioC,OAAAvoC,OAAe,QAAO,KAAAsE,GAAAmkC,EAAAF,CAAA,EAAGjoC,EAAA,MAAAorC,OAAA1rC,OAAe,OAAM,KAAAsE,GAAA8nC,EAAAV,CAAA,iBAC9C1rC,EAAc,KAAC,OAAS,OAAUA,EAAc,KAAC,QAAQA,EAAc,KAAC,OAAQ,KAAK,QAAQ,CAAC,MAAQ,KAAEsE,GAAAgqC,EAAAH,CAAA,mBAFxD/0B,EAAApY,EAAA,QAAAhB,OAAe,OAAO,EAMpEA,EAAY,KAAC,GAAK,GAAKA,EAAY,KAAC,GAAK,0EAnBOoZ,EAAAjY,EAAA,aAAAnB,OAAe,OAAO,mBAAkBoZ,EAAAjY,EAAA,eAAAnB,OAAe,OAAO,wWA+DjHV,EAKQ7qB,EAAA2rB,EAAArlD,CAAA,WACRukD,EAA2F7qB,EAAA8G,EAAAxgC,CAAA,qBAL/EilD,EAAa,iRARzBV,EAKQ7qB,EAAA2rB,EAAArlD,CAAA,qBAJIilD,EAAc,sLAe1BV,EAA6E7qB,EAAA8G,EAAAxgC,CAAA,oIAM3CilD,EAAY,sLAFhDV,EAIK7qB,EAAAt8B,EAAA4C,CAAA,EAHH8lD,EAEG1oD,EAAAiM,CAAA,EADDy8C,EAA8Bz8C,EAAAsrF,CAAA,2CAAE1vC,EAAY,gDAiD3BkE,EAAAlE,MAAiB,MAAK,WAMlDmkB,EAAAnkB,MAAiB,QAAO,WAexBk8B,EAAAl8B,MAAiB,WAAU,SAS3BoyB,EAAApyB,MAAiB,YAAW,okCAlCrCV,EAsCK7qB,EAAA0sB,EAAApmD,CAAA,EArCH8lD,EAoCKM,EAAAH,CAAA,EAlCHH,EAEKG,EAAAJ,CAAA,EADHC,EAA0DD,EAAA8e,CAAA,gBAI5D7e,EAIKG,EAAAzB,CAAA,EAHHsB,EAEGtB,EAAAn7C,CAAA,gBAILy8C,EAqBKG,EAAAC,CAAA,EApBHJ,EAUQI,EAAA+D,CAAA,gBACRnE,EAQQI,EAAAgE,CAAA,yIA/BuB3E,EAAA,aAAA4D,OAAAlE,MAAiB,MAAK,KAAAsE,GAAAC,EAAAL,CAAA,EAMlD5D,EAAA,aAAA6jB,OAAAnkB,MAAiB,QAAO,KAAAsE,GAAAigB,EAAAJ,CAAA,EAexB7jB,EAAA,aAAA47B,OAAAl8B,MAAiB,WAAU,KAAAsE,GAAA23B,EAAAC,CAAA,EAS3B57B,EAAA,aAAA8xB,OAAApyB,MAAiB,YAAW,KAAAsE,GAAAiuB,EAAAH,CAAA,kKA9tC3BpyB,EAAkB,oCAOrB,GAAAA,OAAgB,QAAO,OAAA6kB,GAmElB,GAAA7kB,OAAgB,WAAU,OAAA8e,GAsd1B,GAAA9e,OAAgB,aAAY,OAAAoe,sFAgZrCpe,EAAgB,KAAAE,GAAAF,CAAA,IA2QhBA,EAAgB,KAAAG,GAAAH,CAAA,yOAnsCmDh7B,EAAAupD,EAAA,QAAAC,EAAA,kEAAAxuB,EAAS,IAAC,SAC5E,OACA,GAAE,UAHRV,EAo7BM7qB,EAAA85C,EAAAxzE,CAAA,wCAr6BJ8lD,EAg6BS0tB,EAAApM,CAAA,wBAETthB,EAEQ0tB,EAAAG,CAAA,2GA16BE1uB,EAAkB,gGAR0C,CAAAvvD,GAAA6vD,EAAA,MAAAkuB,OAAA,kEAAAxuB,EAAS,IAAC,SAC5E,OACA,sBAs7BDA,EAAgB,sEA2QhBA,EAAgB,gSA31FV,SAAAouC,GAAcuB,EAAwB,CACxC,IAAAA,QAAa,mCAEZ,MAAAC,EAAYD,EAAK,YAAW,EAAG,KAAI,EAErC,OAAAC,IAAc,KAAOA,IAAc,SAAWA,IAAc,SAAWA,IAAc,UAChF,mCACEA,IAAc,KAAOA,IAAc,SAAWA,IAAc,UAAYA,IAAc,WACxF,mCAEA,mCA6LF,SAAAnC,GAAWlZ,EAAY,OACxBsb,EAAU,KAAK,MAAMtb,EAAO,EAAE,EAAI,UACjCsb,EAAU,IAAM,EAAIA,EAAQ,QAAQ,CAAC,EAAIA,EAAQ,QAAQ,CAAC,EAyW1D,SAAAlB,GAAgBhvB,EAAqB,OACrC,KAIA,SAAA+oB,GAAkBqB,EAAsB,OACzCvtD,EAAOutD,EAAe,YAAW,EAGnC,OAAAvtD,EAAK,SAAS,QAAQ,GAAKA,EAAK,SAAS,cAAc,GAAKA,EAAK,SAAS,SAAS,EAC9E,KAELA,EAAK,SAAS,WAAW,GAAKA,EAAK,SAAS,QAAQ,GAAKA,EAAK,SAAS,QAAQ,GAAKA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,QAAQ,EAClI,KAELA,EAAK,SAAS,SAAS,GAAKA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,YAAY,EAC9E,KAELA,EAAK,SAAS,aAAa,GAAKA,EAAK,SAAS,aAAa,GAAKA,EAAK,SAAS,SAAS,EAClF,KAELA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,WAAW,GAAKA,EAAK,SAAS,QAAQ,EAC5E,KAELA,EAAK,SAAS,QAAQ,GAAKA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,MAAM,GAAKA,EAAK,SAAS,QAAQ,EAClG,KAELA,EAAK,SAAS,SAAS,GAAKA,EAAK,SAAS,cAAc,GAAKA,EAAK,SAAS,WAAW,GAAKA,EAAK,SAAS,WAAW,EAC/G,KAELA,EAAK,SAAS,YAAY,GAAKA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,WAAW,EAChF,KAELA,EAAK,SAAS,eAAe,GAAKA,EAAK,SAAS,aAAa,GAAKA,EAAK,SAAS,eAAe,EAC1F,KAELA,EAAK,SAAS,WAAW,GAAKA,EAAK,SAAS,eAAe,GAAKA,EAAK,SAAS,aAAa,EACtF,KAELA,EAAK,SAAS,aAAa,GAAKA,EAAK,SAAS,OAAO,GAAKA,EAAK,SAAS,cAAc,EACjF,KAELA,EAAK,SAAS,gBAAgB,GAAKA,EAAK,SAAS,QAAQ,GAAKA,EAAK,SAAS,QAAQ,EAC/E,KAELA,EAAK,SAAS,cAAc,GAAKA,EAAK,SAAS,YAAY,EACtD,MAELA,EAAK,SAAS,SAAS,GAAKA,EAAK,SAAS,gBAAgB,EACrD,KAELA,EAAK,SAAS,YAAY,GAAKA,EAAK,SAAS,WAAW,EACnD,KAELA,EAAK,SAAS,cAAc,GAAKA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,YAAY,EACnF,IAELA,EAAK,SAAS,cAAc,GAAKA,EAAK,SAAS,UAAU,EACpD,KAELA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,aAAa,EAChF,KAELA,EAAK,SAAS,gBAAgB,GAAKA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,aAAa,EACtF,KAELA,EAAK,SAAS,OAAO,GAAKA,EAAK,SAAS,QAAQ,GAAKA,EAAK,SAAS,WAAW,EACzE,KAELA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,WAAW,GAAKA,EAAK,SAAS,eAAe,EACnF,KAIF,KAIA,SAAAszD,GAAwB/F,EAAsB,CAC/C,MAAAvtD,EAAOutD,EAAe,KAAI,EAAG,YAAW,KAC1CvtD,EAAK,SAAS,WAAW,GAAKA,EAAK,SAAS,cAAc,GAAKA,EAAK,SAAS,SAAS,GAAKA,EAAK,SAAS,WAAW,QAC/G,YAEL,GAAAA,EAAK,SAAS,QAAQ,GAAKA,EAAK,SAAS,UAAU,GAAKA,EAAK,SAAS,cAAc,QAC/E,cAELA,EAAK,SAAS,aAAa,GAAKA,EAAK,SAAS,aAAa,QACtD,iBAELA,EAAK,SAAS,WAAW,QACpB,eAELA,EAAK,SAAS,aAAa,QACtB,oBAGHuzD,EAAchG,EAAe,KAAI,SAChCgG,EAAY,OAAO,CAAC,EAAE,YAAW,EAAKA,EAAY,MAAM,CAAC,EA+SzD,SAAAC,GAAWxpG,EAAY,CACzB,IAAAA,SAAaA,EAGd,IAAAypG,EAAYzpG,EAAK,OAAO,CAAC,EAAE,YAAW,EAAKA,EAAK,MAAM,CAAC,EAAE,YAAW,QAGnE,SAAS,KAAKypG,CAAS,IAC1BA,GAAa,KAGRA,qGAniCLhG,EAAc,GACdiG,EAAQ,GACRC,EAAsB,EACtBC,EAAuB,EACvB/9C,EAAW,GACXg+C,EACAC,EAGAC,EAAmD,QAGnDC,EAAyB,GACzBC,EAAmB,GACnBC,EAAuB,GAIvBvG,EAAiC,QACjCC,EAAW,GACXC,EAAU,GACVC,EAAU,GAEVa,EAAe,EAGfwF,GAAqB,QAAS,EAAG,MAAO,CAAC,EACzCC,EAAc,CAAK,OAAQ,aAAc,QAAS,UAAW,QAAS,UAAW,YAAa,GAC9FC,EAAW,GACXC,EAAiB,EACjBC,EAA0B,GAG1BC,EAAmB,GACnBC,EAAsB,GAGtBC,EAAoB,GAGpBC,EAAc,GACdC,GAA0B,KAC1BC,EAAe,GAGfC,EAAqB,EAkBrBC,GAA2C,YAG3CC,EAAc,GACdC,GAAgB,GAGhBC,EAAmB,GACnBC,EAAgB,CAClB,MAAO,GACP,QAAS,GACT,UAAS,OACT,SAAU,KACV,YAAa,YACb,WAAY,WAIVC,EAAwB,GACxBC,GAAkB,GAClBC,EAAqB,YAkBhBC,IAAa,CACf,IAAAP,EAAY,OAAI,CACnB1xC,EAAA,GAAA2xC,GAAmBvB,CAAQ,SAIvB,MAAA8B,GAAQR,EAAY,YAAW,EAAG,KAAI,EAC5C1xC,EAAA,GAAA2xC,GAAmBvB,EAAS,OAAO+B,IAG7B,GADU,GAAMA,GAAQ,GAAG,IAAIA,GAAQ,MAAM,GAAG,YAAW,EAClD,SAASD,EAAK,GAGvBC,GAAQ,MAAQA,GAAQ,KAAK,YAAW,EAAG,SAASD,EAAK,MAGzCC,GAAQ,OAAO,OAAO,CAAC,IAAIA,GAAQ,IAAI,OAAO,CAAC,IAAI,YAAW,EACrE,SAASD,EAAK,GAGvBC,GAAQ,OAAO,YAAW,EAAG,SAASD,EAAK,GAG3CC,GAAQ,IAAI,YAAW,EAAG,SAASD,EAAK,cAYvCE,IAAmB,IACtBhC,EAAS,SAAW,SAEpB,cAAe,EACf,YAAa,EACb,cAAe,EACf,oBAAqB,EACrB,QAAS,EACT,QAAS,EACT,QAAS,EACT,WAAY,EACZ,UAAW,EACX,eAAgB,EAChB,kBAAmB,EACnB,iBAAgB,IAKhB,IAAAiC,GAAsB,EACtBC,GAAa,EACbC,GAAY,EACZC,GAAiB,QACfC,GAAmB,GACnBC,GAAc,GAGdC,GAAcC,GAAc,EAElCxC,EAAS,QAAQ+B,IAAO,CAChB,MAAA/wC,GAAQyxC,GAAsBV,GAAQ,EAAE,EACxCnB,GAAiB7G,EAAe,OAAM,CAAEjH,GAAKp9C,KAAOo9C,GAAMp9C,GAAG,UAAU,OAAQ,CAAC,EAChFgtD,GAAqBC,GAAwBZ,GAAQ,EAAE,EAoBzD,GAlBJE,IAAuBjxC,GAAM,QAGzB0xC,KAAuB9B,IAAkBA,GAAiB,EAC5DsB,KACSQ,GAAqB,EAC9BP,KAEAC,KAIEM,GAAqB,GAAK1xC,GAAM,MAAQ,GAE1CsxC,GAAe,KAAKtxC,GAAM,OAAO,EAI/BipC,IAAmB,QAAO,CACtB,MAAA2I,GAAqBC,GAAqBd,GAAQ,EAAE,EAC1D,OAAO,QAAQa,EAAkB,EAAE,QAAO,EAAGlI,GAAMlzC,EAAI,KAChD66C,GAAoB3H,EAAI,IAC3B2H,GAAoB3H,EAAI,GAAM,MAAO,EAAG,QAAS,CAAC,GAEpD2H,GAAoB3H,EAAI,EAAE,OAASlzC,GAAK,MACxC66C,GAAoB3H,EAAI,EAAE,SAAWlzC,GAAK,mBAM1Cs7C,GAAoBR,GAAe,OAGnCS,GAAgBD,GAAoB,EACtCR,GAAe,OAAM,CAAExP,GAAKzO,KAASyO,GAAMzO,GAAM,CAAC,EAAIye,GACtD,EAGEE,GAAW,IAAOV,EAAc,EAAE,KAAI,CAAEl6G,GAAGC,KAAMD,GAAIC,EAAC,EACtD46G,GAAUD,GAAY,OAAS,EAAIA,GAAY,CAAC,EAAI,EACpDE,GAAUF,GAAY,OAAS,EAAIA,GAAYA,GAAY,OAAS,CAAC,EAAI,EAE3E,IAAAG,GAAU,KACVH,GAAY,OAAS,EAAC,OAClBI,GAAS,KAAK,MAAMJ,GAAY,OAAS,CAAC,EAC5CA,GAAY,OAAS,IAAM,EAE7BG,IAAWH,GAAYI,GAAS,CAAC,EAAIJ,GAAYI,EAAM,GAAK,EAG5DD,GAAUH,GAAYI,EAAM,QAK1BC,GAAgB,GACtB,cAAO,QAAQhB,EAAmB,EAAE,QAAO,EAAG3H,GAAMlzC,EAAI,KAChD,MAAAx4B,GAAcw4B,GAAK,MAAQ,EAAKA,GAAK,QAAUA,GAAK,MAAQ,IAAO,EACrE,IAAA87C,GAAS,KACT5vG,GAAU,UAEVs7B,IAAe,IACjBs0E,GAAS,MACT5vG,GAAU,WACDs7B,IAAe,IACxBs0E,GAAS,KACT5vG,GAAU,WACDs7B,IAAe,KACxBs0E,GAAS,KACT5vG,GAAU,WAGZ2vG,GAAiB3I,EAAI,GAAM,OAAA4I,GAAQ,QAAA5vG,GAAS,YAAAs7B,EAAW,KAIvD,cAAA+zE,GACA,YAAaR,GACb,cAAeN,GACf,oBAAqBc,GACrB,QAAAE,GACA,QAAAC,GACA,QAAAC,GACA,WAAAjB,GACA,UAAAC,GACA,eAAAC,GACA,kBAAAU,GACA,iBAAAO,IAKK,SAAAV,GAAwBY,GAAiB,OAC1CC,GAAqBrhD,EAAYohD,EAAS,EAC3C,IAAAC,SAA2B,GAE5B,IAAA1uD,GAAQ,EACZ,cAAO,QAAQ0uD,EAAkB,EAAE,QAAO,EAAGjhH,GAAKC,EAAK,KAEjDD,KAAQ,eAAa,OAAWC,IAAU,WAC5CsyD,IAAS,OAAO,KAAKtyD,EAAK,EAAE,UAGzBsyD,YAIA2uD,GAAYttD,GAAe9O,GAAiBq8D,GAAuBC,GAAc,YAAaC,GAAa,UAAWC,GAAgC,WAC7JpC,EAAgB,CAAK,MAAAtrD,GAAO,QAAA9O,GAAS,UAAAq8D,GAAW,SAAAG,GAAU,YAAAF,GAAa,WAAAC,KACvEh0C,EAAA,GAAA4xC,EAAmB,EAAI,WAWhBsC,IAAU,OACXC,GAAU,CACd,eAAAhK,EACA,SAAAiG,EACA,YAAA79C,EACA,0BAAAm+C,EACA,oBAAAC,EACA,eAAAtG,EACA,WAAU,IAAM,KAAI,EAAG,YAAW,EAClC,mBAAoB+H,GAAmB,GAGnCgC,GAAU,KAAK,UAAUD,GAAY,KAAM,CAAC,EAC5CE,OAAe,KAAI,CAAED,EAAO,GAAK,KAAM,mBAAkB,EACzD1hH,GAAM,IAAI,gBAAgB2hH,EAAQ,EAClCC,GAAO,SAAS,cAAc,GAAG,EACvCA,GAAK,KAAO5hH,GACZ4hH,GAAK,SAAQ,6BAAgC,KAAI,EAAG,YAAW,EAAG,MAAM,GAAG,EAAE,CAAC,SAC9EA,GAAK,MAAK,EACV,IAAI,gBAAgB5hH,EAAG,WAIhB6hH,IAAmB,CACpB,MAAAC,GAAapC,GAAmB,EAChCqC,GAAc,OAAO,KAAK,GAAI,QAAQ,MACvCA,GAAW,aAEVrzD,GAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAyBqBgvD,EAAS,MAAM;AAAA,yCACT,KAAI,EAAG,mBAAmB,QAAO,CAAI,QAAS,OAAQ,KAAM,UAAW,MAAO,OAAQ,IAAK;;;;8EAItDoE,GAAW,iBAAiB;AAAA;AAAA;AAAA;AAAA,wCAIlE7G,GAAW6G,GAAW,aAAa,KAAK7G,GAAW6G,GAAW,WAAW;AAAA;AAAA;AAAA;AAAA,gEAIjD7G,GAAW6G,GAAW,OAAO;AAAA;AAAA;AAAA;AAAA,gEAI7B7G,GAAW6G,GAAW,OAAO;AAAA;AAAA;AAAA;AAAA,gEAI7B7G,GAAW6G,GAAW,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAOpEA,GAAW,UAAU;AAAA,yBACrBA,GAAW,SAAS;AAAA,yBACpBA,GAAW,cAAc;AAAA;AAAA;AAAA,UAGxCnK,IAAmB,SAAW,OAAO,KAAKmK,GAAW,gBAAgB,EAAE,OAAS;;;;gBAI1E,OAAO,QAAQA,GAAW,gBAAgB,EAAE,IAAG,EAAG1J,GAAMlzC,EAAI;AAAA,mEACTA,GAAK,OAAO;AAAA,oBAC3DkzC,EAAI,KAAKlzC,GAAK,YAAY,QAAQ,CAAC,OAAOA,GAAK,MAAM;AAAA;AAAA,eAExD,OAAK,EAAE;AAAA;AAAA;AAAA,UAGZ,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAeEw4C,EAAS,IAAI+B,IAAO,CACd,MAAA/wC,GAAQyxC,GAAsBV,GAAQ,EAAE,EACxCW,GAAqBC,GAAwBZ,GAAQ,EAAE,EACvDnB,GAAiB7G,EAAe,OAAM,CAAEjH,GAAKp9C,KAAOo9C,GAAMp9C,GAAG,UAAU,OAAQ,CAAC,EAChF4uD,GAAeC,GAAgCvzC,GAAM,QAASA,GAAM,MAAO0xC,EAAkB,EAE7F8B,GADmB9B,KAAuB9B,IAAkBA,GAAiB,EACjD,UAAY8B,GAAqB,EAAI,WAAa;;0BAI1EX,GAAQ,GAAG;AAAA,0BACXA,GAAQ,MAAM;AAAA,kCACNxE,GAAWvsC,GAAM,OAAO,KAAKusC,GAAWvsC,GAAM,KAAK;AAAA,wCAC7CszC,GAAa,OAAO,yBAAyBA,GAAa,MAAM;AAAA,0BAC9EE,EAAM;AAAA;AAAA,iBAGf,QAAK,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAQpBH,GAAY,SAAS,MAAMrzD,EAAI,EAC/BqzD,GAAY,SAAS,MAAK,WAInBI,IAAyB,CAC1B,MAAAJ,GAAc,OAAO,KAAK,GAAI,QAAQ,MACvCA,GAAW,aAEVrzD,GAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAqEJgvD,EAAS,IAAG,CAAE+B,GAAS39G,KAAK,QACtB,MAAA4sE,GAAQyxC,GAAsBV,GAAQ,EAAE,EACxCW,GAAqBC,GAAwBZ,GAAQ,EAAE,EACvDuC,GAAeC,GAAgCvzC,GAAM,QAASA,GAAM,MAAO0xC,EAAkB,EAC7FE,GAAqBC,GAAqBd,GAAQ,EAAE,EACpD2C,KAAc9/G,GAAAu9D,EAAY4/C,GAAQ,EAAE,IAAtB,YAAAn9G,GAAyB,cAAe;gCAGtCR,GAAQ47G,EAAS,OAAS,EAAI,aAAe,EAAE;AAAA;AAAA;AAAA;AAAA;AAAA,wBAKvD+B,GAAQ,GAAG,IAAIA,GAAQ,MAAM;AAAA,iCACpB,KAAI,EAAG,mBAAmB,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA,6CAKrBxE,GAAWvsC,GAAM,OAAO,KAAKusC,GAAWvsC,GAAM,KAAK;AAAA,qDAC3CszC,GAAa,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAMxDvK,EAAe,IAAG,CAAErkD,GAAI+kD,KAAO,CACzB,MAAAkK,GAAiBC,GAAwB7C,GAAQ,GAAItH,EAAO,EAC5DoK,GAAiBC,GAAkB/C,GAAQ,GAAItH,EAAO,EACtD+I,GAAqBrhD,EAAY4/C,GAAQ,EAAE;yCAGxB4C,GAAe,UAAYA,GAAe,OAAS,UAAY,EAAE;AAAA;AAAA,iCAEzElK,GAAU,CAAC,KAAK/kD,GAAG,OAAK,YAAgB+kD,GAAU,CAAC;AAAA;AAAA,0BAE1DkK,GAAe,OAAO,IAAIA,GAAe,MAAM,aAAaE,GAAe,MAAM;AAAA;AAAA;AAAA;AAAA,sBAIrFnvD,GAAG,qBAAuBA,GAAG,oBAAoB,OAAS;;kEAEdA,GAAG,oBAAoB,IAAIglD,IAAQlC,GAAkBkC,EAAI,EAAI,IAAMA,EAAI,EAAE,KAAK,IAAI;AAAA;AAAA,sBAE5H,EAAE;AAAA;AAAA,sBAEJhlD,GAAG,UAAU,IAAG,CAAElN,GAAUoyD,KAAM,QAC5B,MAAAxoD,IAAaxtD,GAAA4+G,IAAA,YAAAA,GAAqB/I,MAArB,YAAA71G,GAAgCg2G,IAC7CmK,IAAS3yD,IAAA,YAAAA,GAAY,SAAU,KAO/B4yD,GANU,CACd,GAAI,CAAI,MAAO,cAAe,OAAQ,oCAAqC,MAAO,WAClF,GAAI,CAAI,MAAO,aAAc,OAAQ,iCAAkC,MAAO,WAC9E,GAAI,CAAI,MAAO,cAAe,OAAQ,uBAAwB,MAAO,WACrE,GAAI,CAAI,MAAO,eAAgB,OAAQ,2BAA4B,MAAO,YAEpDD,EAAM,IAAO,MAAOA,GAAQ,OAAQ,GAAI,MAAO;;;;iDAM5CnK,GAAS,CAAC,cAAcpyD,GAAS,MAAM,SAASA,GAAS,OAAS,EAAI,IAAM,EAAE;AAAA,gCAC/FA,GAAS,aAAeA,GAAS,YAAY,OAAS;;qCAEjDA,GAAS,YAAY,IAAIhqC,IAAKg6F,GAAkBh6F,EAAC,GAAG,KAAK,GAAG;AAAA;AAAA,gCAE/D,EAAE;AAAA;AAAA,8BAENk3C,GAAG;oEACmCqvD,EAAM,YAAYC,GAAK,MAAM;AAAA,kCAC/DA,GAAK,KAAK;AAAA;AAAA,8BAEZ,EAAE;AAAA;AAAA,yDAEuBx8D,GAAS,MAAM;AAAA,4BAC5CkN,GAAG,mBAAqBqvD,KAAW;yFAC0BA,KAAW,KAAO,UAAYA,KAAW,KAAO,UAAY,SAAS,gDAAgDC,GAAK,KAAK;AAAA,gCACxLD,KAAW,KAAO,wBAA0BA,KAAW,KAAO,2BAA6BA,KAAW,KAAO,sBAAwB,EAAE;AAAA;AAAA,4BAEzI,EAAE;AAAA;AAAA,uBAGT,QAAK,EAAE;AAAA,sBACRrvD,GAAG;kEACyCivD,GAAe,UAAYA,GAAe,OAAS,UAAYA,GAAe,QAAU,EAAI,UAAY,SAAS,wBAAwBE,GAAe,OAAO;AAAA,sDAC3KF,GAAe,OAAO,IAAIA,GAAe,MAAM;AAAA,0BAC3EA,GAAe,UAAYA,GAAe,OAAS,uBACnDA,GAAe,QAAU,EAAI,mBAC7B,kBAAkB;AAAA;AAAA;;uEAI2BA,GAAe,OAAO,IAAIA,GAAe,MAAM;AAAA;AAAA;;iBAKrG,QAAK,EAAE;AAAA;AAAA;AAAA,gBAGP1K,IAAmB,SAAW,OAAO,KAAK2I,EAAkB,EAAE,OAAS,GAAM8B;;oBAE1EzK,IAAmB,SAAW,OAAO,KAAK2I,EAAkB,EAAE,OAAS;;;wBAGnE,OAAO,QAAQA,EAAkB,EAAE,IAAG,EAAGlI,GAAMuK,EAAQ;8EACrCA,GAAS,SAAW,MAAU,SAAS,SAAuB,EAC/DA,GAAS,SAAW,KAAS,SAAS,SAAsB,EAC5DA,GAAS,SAAW,KAAS,SAAS,SAAsB,EAC5DA,GAAS,SAAW,KAAS,SAAS,SAAsB,EAC1D,SAAS,SAAsB,GAEa,OAAO;AAAA,8BAChEvK,EAAI,KAAKuK,GAAS,OAAO,IAAIA,GAAS,KAAK;AAAA;AAAA,yBAGhD,OAAK,EAAE;AAAA;AAAA,oBAEV,aAAa;AAAA;AAAA,oBAEfP;;;;0BAIMA,GAAY,QAAQ,MAAO,MAAM;AAAA;AAAA;AAAA,oBAGrC,aAAa;AAAA;AAAA,gBAEjB,EAAE;AAAA;AAAA,WAGT,QAAK,EAAE;AAAA;AAAA;AAAA,MAKdL,GAAY,SAAS,MAAMrzD,EAAI,EAC/BqzD,GAAY,SAAS,MAAK,EAyGnB,SAAAa,GAAmB3B,GAAiB,OACrCC,GAAqBrhD,EAAYohD,EAAS,MAC3CC,GAAkB,OAAW,GAAI,EAAG,GAAI,EAAG,MAAO,CAAC,EAEpD,IAAA2B,GAAc,EACdC,GAAc,EACdxE,GAAiB,EAErB,OAAA7G,EAAe,QAAQrkD,IAAE,CACvBA,GAAG,UAAU,QAAQrnC,IAAC,QACpBuyF,WACMxuD,IAAaxtD,GAAA4+G,GAAmB9tD,GAAG,aAAa,IAAnC,YAAA9wD,GAAuCypB,GAAE,eACtD02F,GAAS3yD,IAAA,YAAAA,GAAY,OAEvB2yD,KAAW,KACbI,KACSJ,KAAW,MACpBK,UAKG,GAAID,GAAa,GAAIC,GAAa,MAAOxE,aAI3CyE,IAAkB,CACnB,MAAAC,GAAc,aAAa,QAAQ,gBAAgB,EACnDC,GAAY,aAAa,QAAQ,kBAAkB,EACnDC,GAAiB,aAAa,QAAQ,2BAA2B,EACjEC,GAAc,aAAa,QAAQ,cAAc,EACjDC,GAAmB,aAAa,QAAQ,qBAAqB,EAG7DC,GAAwB,aAAa,QAAQ,uBAAuB,KACtEA,KAA0B,YAC5BjE,EAAwBiE,KAA0B,MAAM,EACxD/1C,EAAA,GAAA+xC,GAAkB,aAAa,QAAQ,iBAAiB,IAAM,OAAO,GAInE8D,OAEA71C,EAAA,EAAAowC,EAAW,KAAK,MAAMyF,EAAW,GACjC71C,EAAA,GAAA2xC,GAAmBvB,CAAQ,EAC3B,QAAQ,IAAI,4BAA6BA,EAAS,OAAQ,QAAQ,EAG9DA,EAAS,OAAS,GAAK,aAAa,QAAQ,gBAAgB,GAC9DpwC,EAAA,EAAAywC,EAAc,UAAU,QAEnBr8G,GAAC,CACR,QAAQ,MAAM,mDAAoDA,EAAC,KAInEshH,UAEA,QAAQ,IAAI,kCAAmCA,GAAY,UAAU,EAAG,GAAG,EAAI,KAAK,EACpF11C,EAAA,EAAAmqC,EAAiB,KAAK,MAAMuL,EAAW,GAGnCI,OAEM,MAAAE,GAAgB,KAAK,MAAMF,EAAgB,EACjD,QAAQ,IAAI,iCAAkCE,EAAa,EAEvDA,GAAc,OAASA,GAAc,QACvC7L,EAAe,QAAO,CAAErkD,GAAI/tD,KAAC,QAEvBi+G,GAAc,MAAMj+G,EAAC,IACvB+tD,GAAG,KAAOkwD,GAAc,MAAMj+G,EAAC,GAI3B,MAAAV,IAASrC,GAAAghH,GAAc,SAAd,YAAAhhH,GAAuB+C,IAClCV,KACFyuD,GAAG,IAAMzuD,GAAO,IAChByuD,GAAG,KAAOzuD,GAAO,KACjByuD,GAAG,KAAOzuD,GAAO,KACjByuD,GAAG,YAAczuD,GAAO,qBAIvBjD,GAAC,CACR,QAAQ,KAAK,yDAA0DA,EAAC,EAK5E,QAAQ,IAAI,iDAAiD,EAC7D+1G,EAAe,QAAO,CAAErkD,GAAI/tD,KAAC,CAC3B,QAAQ,IAAG,eAAgBA,GAAI,CAAC,KAAK+tD,GAAG,IAAI,MAC1C,KAAMA,GAAG,MAAQ,WACjB,IAAKA,GAAG,KAAO,IACf,YAAaA,GAAG,aAAe,QAKnCqkD,EAAe,QAAQrkD,IAAE,CACvBA,GAAG,oBAAsBA,GAAG,oBAAoB,IAAIglD,IAAQkF,GAAwBlF,EAAI,GACpFhlD,GAAG,mBACLA,GAAG,UAAU,QAAQrnC,IAAC,CACpBA,GAAE,YAAcA,GAAE,YAAY,IAAIqsF,IAAQkF,GAAwBlF,EAAI,OAK5E,QAAQ,IAAI,8CAA+CX,EAAe,IAAIrkD,KAAE,CAC9E,MAAOA,GAAG,MACV,KAAMA,GAAG,KACT,KAAMA,GAAG,KACT,UAAWA,GAAG,UAAU,iBAEnB1xD,GAAC,CACR,QAAQ,MAAM,qDAAuDA,EAAC,EACtE6hH,GAAM,MAAM,iCAAiC,CAC3C,SAAU,IACV,SAAU,oBAIdA,GAAM,MAAM,oFAAqF,CAC/F,SAAU,IACV,SAAU,kBAKd77B,GAAa,EAETw7B,OAEA51C,EAAA,EAAA0wC,EAA4B,KAAK,MAAMkF,EAAc,GAC/C,MAAAM,GAAyB,aAAa,QAAQ,qBAAqB,EACrEA,GACFl2C,EAAA,GAAA2wC,EAAsB,KAAK,MAAMuF,EAAsB,SAGvDvF,EAAmB,IACnBD,EAA0B,QAAQ5F,IAAI,MACpC6F,EAAoB7F,EAAI,EAAI,GAAI6F,CAAA,WAG7Bv8G,GAAC,CACR,QAAQ,MAAM,2DAA4DA,EAAC,EAC3E+hH,GAAmC,OAGrCA,GAAmC,KAGjCR,OAEM,MAAAS,GAAS,KAAK,MAAMT,EAAS,EACnC31C,EAAA,GAAAqqC,EAAiB+L,GAAO,gBAAkB,OAAO,EACjD9L,EAAW8L,GAAO,UAAY,GAC9B7L,EAAU6L,GAAO,SAAW,GAC5B5L,EAAU4L,GAAO,SAAW,GAC5B/K,EAAe+K,GAAO,cAAgB,QAC/BhiH,GAAC,CACR,QAAQ,MAAM,gDAAiDA,EAAC,EAK9D,MAAAiiH,GAAoB,aAAa,QAAQ,oBAAoB,KAC/DA,OAEAr2C,EAAA,EAAAzN,EAAc,KAAK,MAAM8jD,EAAiB,SACnCjiH,GAAC,CACR,QAAQ,MAAM,4CAA6CA,EAAC,MAC5Dm+D,EAAW,IAKf69C,EAAS,QAAQ+B,IAAO,CACjB5/C,EAAY4/C,GAAQ,EAAE,OACzB5/C,EAAY4/C,GAAQ,EAAE,KAAA5/C,CAAA,aAMnB4jD,IAAmC,CACpC,MAAAG,OAAqB,IAG3BnM,EAAe,QAAQrkD,IAAE,CACvBA,GAAG,oBAAoB,QAAQglD,IAAQwL,GAAe,IAAItG,GAAwBlF,EAAI,IAClFhlD,GAAG,mBACLA,GAAG,UAAU,QAAQrnC,IAAKA,GAAE,YAAY,QAAQqsF,IAAQwL,GAAe,IAAItG,GAAwBlF,EAAI,OAI3G9qC,EAAA,EAAA0wC,EAA4B,MAAM,KAAK4F,EAAc,QAGrD3F,EAAmB,IACnBD,EAA0B,QAAQ5F,IAAI,MACpC6F,EAAoB7F,EAAI,EAAI,GAAI6F,CAAA,IAGlC4F,GAA6B,EAC7B,QAAQ,IAAI,4BAA6B7F,CAAyB,WAI3D6F,IAA6B,CACpC,aAAa,QAAQ,4BAA6B,KAAK,UAAU7F,CAAyB,GAC1F,aAAa,QAAQ,sBAAuB,KAAK,UAAUC,CAAmB,YAIvE6F,IAAmB,CAC1Bx2C,EAAA,GAAA4wC,EAAuB,EAAI,EAIpB,SAAA7F,GAAiB0L,GAAkB,CAC1Cz2C,EAAA,GAAA2wC,EAAoB8F,EAAU,GAAK9F,EAAoB8F,EAAU,EAAA9F,CAAA,EACjE4F,GAA6B,WAItBG,IAAwB,CAC3B,QAAQ,oEAAqE,GAC/EP,GAAmC,WAK9BQ,IAAiB,CACxB32C,EAAA,GAAAkxC,EAAmB,EAAK,WAIjB0F,IAAc,CACf,iCAA6B,SAAM,EAAO,sBAAuB,QAAM,CAC3EX,GAAM,qEAAqE,CACzE,KAAM,KACN,SAAU,IACV,SAAU,sBAKR,MAAAY,GAAqB,OAAe,mBAAsB,OAAe,wBAC/EvF,OAAkBuF,GAElBvF,GAAY,KAAO,QACnBA,GAAY,WAAa,GACzBA,GAAY,eAAiB,GAE7BA,GAAY,QAAO,KACjBtxC,EAAA,GAAAqxC,EAAc,EAAI,GAGpBC,GAAY,SAAYr1D,IAAU,CAC5B,IAAA66D,GAAa,GACR,QAAA/+G,GAAIkkD,GAAM,YAAalkD,GAAIkkD,GAAM,QAAQ,OAAQlkD,KACxD++G,IAAc76D,GAAM,QAAQlkD,EAAC,EAAE,CAAC,EAAE,WAI9B,MAAAgmE,GAAgBmyC,GAAW4G,GAAW,KAAI,GAChD92C,EAAA,GAAAuxC,IAAiBA,EAAe,IAAM,IAAMxzC,EAAa,EAGrDqzC,OACFA,GAAqB,IAAMrzC,EAAa,EAExCiC,EAAA,GAAAoxC,EAAoBrzC,EAAa,GAIrCuzC,GAAY,QAAWr1D,IAAU,CAC/B,QAAQ,MAAM,mCAAoCA,GAAM,KAAK,EAC7D+jB,EAAA,GAAAqxC,EAAc,EAAK,GAGrBC,GAAY,MAAK,KACftxC,EAAA,GAAAqxC,EAAc,EAAK,GAGrBC,GAAY,MAAK,WAIVyF,IAAa,CAChBzF,IAAeD,IACjBC,GAAY,KAAI,EAChBtxC,EAAA,GAAAqxC,EAAc,EAAK,YAsBd2F,IAAyB,IAC5B5G,EAAS,OAAS,EAAC,CACf,MAAA6G,GAAmB7G,EAASC,CAAmB,EAAE,GAClD99C,EAAY0kD,EAAgB,GAC/Bj3C,EAAA,EAAAzN,EAAY0kD,EAAgB,KAAA1kD,CAAA,EAI1B6+C,EAAkB,OACpBpxC,EAAA,EAAAzN,EAAY0kD,EAAgB,EAAE,YAAc7F,EAAkB,KAAI,EAAA7+C,CAAA,SAE3DA,EAAY0kD,EAAgB,EAAE,YAIvC,aAAa,QAAQ,qBAAsB,KAAK,UAAU1kD,CAAW,aAKhE2kD,IAAyB,IAC5B9G,EAAS,OAAS,EAAC,CACf,MAAA6G,GAAmB7G,EAASC,CAAmB,EAAE,GACjDuD,GAAqBrhD,EAAY0kD,EAAgB,EAGvDj3C,EAAA,GAAAoxC,GAAoBwC,IAAA,YAAAA,GAAoB,cAAe,EAAE,EACzD5zC,EAAA,GAAAuxC,EAAe,EAAE,YAKZ4F,IAAW,CACd9G,EAAsBD,EAAS,OAAS,IAE1C4G,GAAyB,EAEzBh3C,EAAA,GAAAkxC,EAAmB,EAAK,MACxBb,IAAmBA,CAAA,EACnBrwC,EAAA,EAAAswC,EAAuB,CAAC,EAGxB4G,GAAyB,EAEzB98B,GAAa,EAEb,OAAO,SAAQ,CAAG,IAAK,EAAG,SAAU,SAAQ,YAKvCg9B,IAAe,CAClB/G,EAAsB,IAExB2G,GAAyB,EAEzBh3C,EAAA,GAAAkxC,EAAmB,EAAK,MACxBb,IAAmBA,CAAA,EACnBrwC,EAAA,EAAAswC,EAAuB,CAAC,EAGxB4G,GAAyB,EAEzB98B,GAAa,EAEb,OAAO,SAAQ,CAAG,IAAK,EAAG,SAAU,SAAQ,YAKvCA,IAAa,IAChBg2B,EAAS,OAAS,EAAC,CACf,MAAAuD,GAAYvD,EAASC,CAAmB,EAAE,QAChDQ,EAAmBgC,GAAsBc,EAAS,QAClD7C,EAAiBuG,GAAkBxG,EAAiB,QAASA,EAAiB,KAAK,QACnFE,EAAckC,GAAqBU,EAAS,GAC5C3zC,EAAA,GAAAgxC,EAAiB7G,EAAe,OAAM,CAAEjH,GAAKp9C,KAAOo9C,GAAMp9C,GAAG,UAAU,OAAQ,CAAC,SAG1E8tD,GAAqBrhD,EAAYohD,EAAS,EAC5C,IAAA2D,GAAoB,EACpB1D,IACFzJ,EAAe,QAAQrkD,IAAE,CACvBA,GAAG,UAAU,QAAQrnC,IAAC,cACd+jC,IAAaxtD,GAAA4+G,GAAmB9tD,GAAG,aAAa,IAAnC,YAAA9wD,GAAuCypB,GAAE,eACxD+jC,IAAA,MAAAA,GAAY,QACd80D,SAMF,MAAAC,GAAgBtG,OACtBA,EAA0BqG,KAAsBtG,CAAc,EAGzD,CAAAuG,IAAiBtG,IACpB,QAAQ,IAAI,uFAAuF,EACnGjxC,EAAA,GAAAkxC,EAAmB,EAAI,GAGzB,QAAQ,IAAG,uBAAwBoG,EAAiB,IAAItG,CAAc,sBAAsBC,CAAuB,IACnH,QAAQ,IAAI,sCAAuCA,CAAuB,GAKrE,SAAAuG,GAAiBv7D,GAAY,QAE9B,MAAAyvC,IAAO12F,GADEinD,GAAM,OACD,QAAP,YAAAjnD,GAAe,OACvB02F,GAAI,OAEH,MAAA+rB,OAAa,WACnBA,GAAO,OAAUrjH,IAAC,QACV,MAAAsS,IAAO1R,GAAAZ,GAAE,SAAF,YAAAY,GAAU,OACvB0iH,GAAShxG,EAAI,GAEf+wG,GAAO,WAAW/rB,EAAI,EAGf,SAAAgsB,GAASC,GAAe,CAGzB,MAAAC,GAFQD,GAAQ,KAAI,EAAG,MAAM;AAAA,CAAI,EAEf,MAAM,CAAC,EAE/B33C,EAAA,EAAAowC,EAAWwH,GAAU,IAAG,CAAE9sD,GAAMt2D,KAAK,CAC5B,MAAAmoB,GAAKk7F,GAAQhI,EAAI,EAAI/kD,GAAK,MAAM,GAAG,EAAE,IAAIz2D,IAAKA,GAAE,KAAI,UAEzD,cAAeG,EAAK,GACpB,IAAKmoB,IAAO,GACZ,OAAQk7F,IAAU,GAClB,KAAMhI,IAAQ,OAKlBO,EAAS,QAAQ+B,IAAO,KACtB5/C,EAAY4/C,GAAQ,EAAE,KAAA5/C,CAAA,IAIxByN,EAAA,GAAA2xC,GAAmBvB,CAAQ,EAG3B,aAAa,QAAQ,eAAgB,KAAK,UAAUA,CAAQ,GAExDA,EAAS,OAAS,GACpBpwC,EAAA,EAAAywC,EAAc,UAAU,WAKnBqH,IAAiB,CACxBjE,GACE,gCAC+C,+CAAAzD,EAAS,MAAM;AAAA;AAAA,4DAE9DA,EAAQ,SACNuB,GAAgB,QAClBp/C,EAAW,IACX,aAAa,WAAW,cAAc,EACtC,aAAa,WAAW,oBAAoB,EAC5CyN,EAAA,EAAAywC,EAAc,OAAO,EACrB,QAAQ,IAAI,gCAAgC,GAE5C,sBACA,gBAKW,eAAAsH,GAAuBpE,GAAiB,OAC/CxB,GAAU/B,EAAS,KAAK/7G,IAAKA,GAAE,KAAOs/G,EAAS,EAC/CqE,GAAc7F,GAAa,GAAAA,GAAQ,MAAM,IAAIA,GAAQ,GAAG,GAAK,YAEnE0B,GACE,+FACgEmE,EAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iDAGnE,MAAAC,KAAmBjjH,GAAAo7G,EAASC,CAAmB,IAA5B,YAAAr7G,GAA+B,MAAO2+G,GAC3DsE,KACFj4C,EAAA,EAAAywC,EAAc,UAAU,EACxBzwC,EAAA,GAAAoxC,EAAoB,EAAE,EACtBpxC,EAAA,GAAAuxC,EAAe,EAAE,EACjBvxC,EAAA,EAAAswC,EAAuB,CAAC,QAClB9/B,GAAI,SAIN0nC,GAAc,GACpB,OAAO,KAAK3lD,CAAW,EAAE,QAAQlwD,IAAE,CAC7BA,KAAOsxG,GACTuE,GAAe71G,EAAE,GAAM,YAAa,EAAE,EAEtC61G,GAAe71G,EAAE,EAAIkwD,EAAYlwD,EAAE,IAGvC29D,EAAA,EAAAzN,EAAc2lD,EAAc,EAGtB,MAAAC,kBAAgCxE,EAAS,GAC/C,aAAa,WAAWwE,EAAc,EACtC,aAAa,QAAQ,qBAAsB,KAAK,UAAU5lD,CAAW,QAGrEi/C,IAAkBA,CAAA,QACZhhC,GAAI,EAGVxQ,EAAA,EAAAowC,MAAeA,CAAQ,GACvBpwC,EAAA,EAAAmqC,MAAqBA,CAAc,SAC7B35B,GAAI,EAGV4J,GAAa,QACP5J,GAAI,EAGVylC,GAAM,QAAyB,iBAAA+B,EAAW,+BAA+BC,GAAmB,kDAAqD,EAAE,GACjJ,UAAU,IACV,SAAU,gBAGd,qBACA,gBAKK,SAAAG,GAAgBC,GAAoB,CAKvC,GAH0B,aAAa,QAAQ,uBAAuB,IAG5C,KAAI,CAChCxE,GACE,+BACA;AAAA;AAAA;AAAA;AAAA,sEAGE7zC,EAAA,GAAA8xC,EAAwB,EAAI,EAC5B9xC,EAAA,GAAA+xC,GAAkB,EAAI,EACtB,aAAa,QAAQ,wBAAyB,MAAM,EACpD,aAAa,QAAQ,kBAAmB,MAAM,EAC9CuG,GAAoBD,EAAY,GAElC,gCACA,2BAGEr4C,EAAA,GAAA8xC,EAAwB,EAAK,EAC7B9xC,EAAA,GAAA+xC,GAAkB,EAAK,EACvB,aAAa,QAAQ,wBAAyB,OAAO,EACrD,aAAa,QAAQ,kBAAmB,OAAO,EAC/CuG,GAAoBD,EAAY,WAMtCC,GAAoBD,EAAY,EAInB,eAAAC,GAAoBD,GAAoB,CAEjDhI,IAAwBgI,IAC1BrB,GAAyB,EAG3Bh3C,EAAA,EAAAqwC,EAAsBgI,EAAY,EAClCr4C,EAAA,EAAAswC,EAAuB,CAAC,EACxBtwC,EAAA,EAAAywC,EAAc,YAAY,EAG1ByG,GAAyB,EAGrBpF,SACIyG,GAA4B,EAGpCn+B,GAAa,iBAIAm+B,IAA4B,CACzCv4C,EAAA,GAAAgyC,EAAqB,EAAI,EACzB,QAAQ,IAAI,oCAAoC,EAE5C,IAAAwG,GAAuB,EACvBxH,GAAiB,EAErB7G,EAAe,QAAQrkD,IAAE,CACvBA,GAAG,UAAU,QAAQrnC,IAAC,CACpBuyF,KACIvyF,GAAE,YACJA,GAAE,qBAAuB,GACzB+5F,MAEA/5F,GAAE,qBAAuB,OAK/BuhD,EAAA,GAAAgyC,EAAqB,EAAK,EAC1B,QAAQ,IAAG,4BAA6BwG,EAAoB,IAAIxH,EAAc,cAE1EwH,KAAyB,IAC3B,QAAQ,KAAK,qDAAsD,EACnE,QAAQ,KAAK,+FAAgG,YAKxGC,IAAc,CACrBz4C,EAAA,EAAAywC,EAAc,UAAU,EAIjB,SAAAiI,GAAqB74B,GAAuB7G,GAAuBm8B,GAAiC,IACvG/E,EAAS,SAAW,EAAC,OAEnB,MAAAuD,GAAYvD,EAASC,CAAmB,EAAE,GAG1C6H,OAAsB3lD,CAAW,EAElC2lD,GAAevE,EAAS,IAC3BuE,GAAevE,EAAS,MAErBuE,GAAevE,EAAS,EAAE9zB,EAAa,IAC1Cq4B,GAAevE,EAAS,EAAE9zB,EAAa,MAGzCq4B,GAAevE,EAAS,EAAE9zB,EAAa,EAAE7G,EAAa,GAAM,OAAAm8B,EAAM,EAGlEn1C,EAAA,EAAAzN,EAAc2lD,EAAc,EAC5B,aAAa,QAAQ,qBAAsB,KAAK,UAAU3lD,CAAW,QAGrEi/C,IAAkBA,CAAA,EAElBp3B,GAAa,EAGbu+B,GAA2B94B,EAAa,EAIjC,SAAA84B,GAA2B94B,GAAqB,CACjD,MAAA8zB,GAAYvD,EAASC,CAAmB,EAAE,GAC1Ch6G,GAAW8zG,EAAetqB,EAAa,EACvC+zB,GAAqBrhD,EAAYohD,EAAS,EAG5C,IAAA1C,GAA0B,GAC9B56G,GAAS,UAAU,QAAO,CAAEooB,GAAGusF,KAAM,QAC7B,MAAAxoD,IAAaxtD,GAAA4+G,IAAA,YAAAA,GAAqB/zB,MAArB,YAAA7qF,GAAsCypB,GAAE,iBAC5C+jC,IAAA,YAAAA,GAAY,SAAU,gBAEtB,eACbyuD,GAA0B,MAK1BA,IAA2BpxB,GAAgBsqB,EAAe,OAAS,IACrEnqC,EAAA,GAAAmxC,EAAsB,EAAI,EAC1B,oBACEb,EAAuBzwB,GAAgB,CAAC,EACxC7f,EAAA,GAAAmxC,EAAsB,EAAK,GAC1B,eAKEyH,GAAyB/4B,GAAuBs1B,GAAiC,IACpF/E,EAAS,SAAW,EAAC,OAEnB,MAAAuD,GAAYvD,EAASC,CAAmB,EAAE,GAC1Ch6G,GAAW8zG,EAAetqB,EAAa,MACxCxpF,GAAQ,OAGP,MAAA6hH,OAAsB3lD,CAAW,EAElC2lD,GAAevE,EAAS,IAC3BuE,GAAevE,EAAS,MAErBuE,GAAevE,EAAS,EAAE9zB,EAAa,IAC1Cq4B,GAAevE,EAAS,EAAE9zB,EAAa,MAIzCxpF,GAAS,UAAU,QAAO,CAAE6hD,GAAG8gC,KAAa,CAC1Ck/B,GAAevE,EAAS,EAAE9zB,EAAa,EAAE7G,EAAa,GAAM,OAAAm8B,EAAM,IAIpEn1C,EAAA,EAAAzN,EAAc2lD,EAAc,EAC5B,aAAa,QAAQ,qBAAsB,KAAK,UAAU3lD,CAAW,QAGrEi/C,IAAkBA,CAAA,EAClBp3B,GAAa,EAGTyF,GAAgBsqB,EAAe,OAAS,GAC1C,oBACEmG,EAAuBzwB,GAAgB,CAAC,GACvC,KAKE,SAAA80B,GAAgCkE,GAAuBC,GAAsBhG,GAA0B,CAC1G,GAAAgG,KAAiB,SACV,OAAQ,aAAc,QAAS,UAAW,QAAS,UAAW,YAAa,GAIlF,GAAAhG,KAAuB,SAChB,OAAQ,eAAgB,QAAS,UAAW,QAAS,UAAW,YAAa,GAIlF,MAAA1zE,GAAey5E,GAAgBC,GAAgB,IAEjD,OAAA15E,IAAekrE,GAEf,OAAQ,4BACR,QAAS,UACT,QAAS,UACT,YAAAlrE,IAEOA,IAAemrE,GAEtB,OAAQ,8BACR,QAAS,UACT,QAAS,UACT,YAAAnrE,IAEOA,IAAeorE,GAEtB,OAAQ,wBACR,QAAS,UACT,QAAS,UACT,YAAAprE,KAIA,OAAQ,6BACR,QAAS,UACT,QAAS,UACT,YAAAA,IAMG,SAAAyzE,GAAsBc,GAAiB,OACxCC,GAAqBrhD,EAAYohD,EAAS,EAC3C,IAAAC,UAA6B,QAAS,EAAG,MAAO,CAAC,EAElD,IAAAiF,GAAgB,EAChBC,GAAe,EAEnB,OAAA3O,EAAe,QAAQrkD,IAAE,CACvBA,GAAG,UAAU,QAAQrnC,IAAC,cACd+jC,IAAaxtD,GAAA4+G,GAAmB9tD,GAAG,aAAa,IAAnC,YAAA9wD,GAAuCypB,GAAE,eACtD02F,GAAS3yD,IAAA,YAAAA,GAAY,OAG3Bs2D,IAAgBr6F,GAAE,OAGd02F,KAAW,OACb0D,IAAiBp6F,GAAE,aAKhB,QAASo6F,GAAe,MAAOC,aAIjClG,IAAc,CACd,OAAAzI,EAAe,OAAM,CAAEjH,GAAKp9C,KAAOo9C,GAAMp9C,GAAG,YAAa,CAAC,WAI1DkvD,GAAwBrB,GAAmB9zB,GAAqB,OACjE+zB,GAAqBrhD,EAAYohD,EAAS,EAC1C7tD,GAAKqkD,EAAetqB,EAAa,MAClC+zB,IAAkB,CAAK9tD,GAAE,OAAW,QAAS,EAAG,OAAQ,CAAC,EAE1D,IAAA+yD,GAAgB,EAChBC,GAAe,EAEnB,OAAAhzD,GAAG,UAAU,QAAQrnC,IAAC,QACd,MAAA+jC,IAAaxtD,GAAA4+G,GAAmB/zB,EAAa,IAAhC,YAAA7qF,GAAoCypB,GAAE,eACnD02F,GAAS3yD,IAAA,YAAAA,GAAY,OAE3Bs2D,IAAgBr6F,GAAE,OACd02F,KAAW,OACb0D,IAAiBp6F,GAAE,WAId,QAASo6F,GAAe,OAAQC,aAIlC5D,GAAkBvB,GAAmB9zB,GAAqB,OAI3D+zB,GAAqBrhD,EAAYohD,EAAS,EAC1C7tD,GAAKqkD,EAAetqB,EAAa,EAClC,IAAA+zB,KAAuB9tD,UACjB,OAAQ,eAAgB,QAAS,UAAW,QAAS,WAM5D,IAAAmrD,GAA0B,GAC1BsE,GAAc,EACdwD,GAAwB,EACxBC,GAAwB,EAiBvB,GAfLlzD,GAAG,UAAU,QAAO,CAAErnC,GAAGusF,KAAM,QACvB,MAAAxoD,IAAaxtD,GAAA4+G,GAAmB/zB,EAAa,IAAhC,YAAA7qF,GAAoCypB,GAAE,eACnD02F,IAAS3yD,IAAA,YAAAA,GAAY,SAAU,aAEtB2yD,KAAW,cACxBlE,GAA0B,GAC1B+H,MACS7D,KAAW,KACpBI,KACSJ,KAAW,MACpB4D,OAKC,CAAA9H,IAA2B+H,KAA0BlzD,GAAG,UAAU,cAC5D,OAAQ,eAAgB,QAAS,UAAW,QAAS,UAAW,KAAM,UAI5EmrD,UACM,OAAQ,WAAY,QAAS,UAAW,QAAS,UAAW,KAAM,MAIzE,GAAA8H,KAA0BjzD,GAAG,UAAU,cAChC,OAAQ,KAAM,QAAS,UAAW,QAAS,WAIlD,GAAAyvD,KAAgBzvD,GAAG,UAAU,cACtB,OAAQ,KAAM,QAAS,UAAW,QAAS,WAIhD,MAAAivD,GAAiBC,GAAwBrB,GAAW9zB,EAAa,KAEnEk1B,GAAe,SAAW,SACnB,OAAQ,KAAM,QAAS,UAAW,QAAS,iBAGhD31E,GAAe21E,GAAe,QAAUA,GAAe,OAAU,IAEnE,OAAA31E,IAAekrE,GACR,OAAQ,MAAO,QAAS,UAAW,QAAS,WAC5ClrE,IAAemrE,GACf,OAAQ,KAAM,QAAS,UAAW,QAAS,WAC3CnrE,IAAeorE,GACf,OAAQ,KAAM,QAAS,UAAW,QAAS,YAE3C,OAAQ,KAAM,QAAS,UAAW,QAAS,oBAK/C6M,GAAkBwB,GAAuBC,GAAoB,CAChE,GAAAA,KAAiB,SACV,OAAQ,aAAc,QAAS,UAAW,QAAS,UAAW,YAAa,GAIhF,MAAA15E,GAAey5E,GAAgBC,GAAgB,IAEjD,OAAA15E,IAAekrE,GAEf,OAAQ,4BACR,QAAS,UACT,QAAS,UACT,YAAAlrE,IAEOA,IAAemrE,GAEtB,OAAQ,8BACR,QAAS,UACT,QAAS,UACT,YAAAnrE,IAEOA,IAAeorE,GAEtB,OAAQ,wBACR,QAAS,UACT,QAAS,UACT,YAAAprE,KAIA,OAAQ,6BACR,QAAS,UACT,QAAS,UACT,YAAAA,IAMG,SAAA6zE,GAAqBU,GAAiB,OACvCC,GAAqBrhD,EAAYohD,EAAS,EAG1C5C,GAAW,GAGb6C,IACFzJ,EAAe,QAAQrkD,IAAE,CACvBA,GAAG,UAAU,QAAQrnC,IAAC,cACd+jC,IAAaxtD,GAAA4+G,GAAmB9tD,GAAG,aAAa,IAAnC,YAAA9wD,GAAuCypB,GAAE,eACtD02F,GAAS3yD,IAAA,YAAAA,GAAY,UAGvB2yD,GAAM,OAEF8D,GAAQnzD,GAAG,kBAAoBrnC,GAAE,YAAcqnC,GAAG,oBAExD,QAAQ,IAAI,oBAAqBrnC,GAAE,cAAe,UAAW02F,GAAQ,eAAgB8D,EAAK,EAC1F,QAAQ,IAAI,wBAAyBnzD,GAAG,mBAAmB,EAC3D,QAAQ,IAAI,wBAAyBrnC,GAAE,WAAW,EAClD,QAAQ,IAAI,uBAAwBqnC,GAAG,iBAAiB,EAExDmzD,GAAM,QAAQnO,IAAI,OACVoO,GAAiBlJ,GAAwBlF,EAAI,EAE9CiG,GAAYmI,EAAc,IAC7BnI,GAAYmI,EAAc,GAAM,QAAS,EAAG,MAAO,CAAC,GAGpDnI,GAAYmI,EAAc,EAAE,QACxB/D,KAAW,MACbpE,GAAYmI,EAAc,EAAE,UAE9B,QAAQ,IAAG,cAAeA,EAAc,KAAKnI,GAAYmI,EAAc,EAAE,OAAO,IAAInI,GAAYmI,EAAc,EAAE,KAAK,iBAO3HljH,GAAM,GACZ,cAAO,KAAK+6G,EAAW,EAAE,QAAQjG,IAAI,CAC7B,MAAAqO,GAAUpI,GAAYjG,EAAI,EAAE,QAC5B3/F,GAAQ4lG,GAAYjG,EAAI,EAAE,MAG5B,GAAA3/F,GAAQ,EAAC,CACL,MAAAi0B,GAAe+5E,GAAUhuG,GAAS,IAEpC,IAAAuoG,GAAS,KACTt0E,IAAe,GACjBs0E,GAAS,MACAt0E,IAAe,GACxBs0E,GAAS,KACAt0E,IAAe,KACxBs0E,GAAS,MAGb19G,GAAO80G,EAAI,GAAM,OAAA4I,GAAQ,QAAAyF,GAAS,MAAAhuG,GAAO,YAAAi0B,EAAW,KAG/CppC,GAIT4pE,GAAO,KACL61C,GAAkB,IAGpBtyC,GAAW,KACLqtC,GAAqBC,IAAgB,cACvC,gBACEv1C,GAAkBs1C,CAAiB,GAClC,wDAm/BW,MAAA4I,GAAY9D,GAAmBlF,EAASC,CAAmB,EAAE,EAAE,SAC9D+I,GAAU,GAAK,GAAKA,GAAU,GAAK,gDAl8B3B7I,EAAQtsC,YAoDL,MAAA0U,GAAA,IAAA3Y,EAAA,GAAAyxC,GAAsB,WAAW,EAQjC74B,GAAA,IAAA5Y,EAAA,GAAAyxC,GAAsB,KAAK,gBAuIjCC,EAAW,kBAML,MAAA9qB,GAAA,IAAA5mB,EAAA,EAAA0xC,EAAc,EAAE,EAyChB7qB,GAAAryF,IAAA4jH,GAAgB5jH,EAAK,SAyFLujH,GAAuB5F,GAAQ,EAAE,EAmBjDkH,GAAA7kH,IAAA4jH,GAAgB5jH,EAAK,SAkJLujH,GAAuB5F,GAAQ,EAAE,EApR3BmH,GAAA,CAAAnH,GAAA99G,KAAKA,GAAE,KAAO89G,GAAQ,GA6T5CoH,GAAA,IAAAv5C,EAAA,GAAAkxC,EAAmB,EAAI,EA4EnBsI,GAAA3O,IAAA7qC,EAAA,EAAAswC,EAAuBzF,EAAO,UAsExC7qC,EAAA,GAAA+xC,GAAe,CAAIA,EAAA,EACnB,aAAa,QAAQ,kBAAmBA,GAAgB,SAAQ,WA6BtD6G,GAAyBtI,EAAsB,IAAI,SAOnDsI,GAAyBtI,EAAsB,IAAI,SAOnDsI,GAAyBtI,EAAsB,IAAI,SAOnDsI,GAAyBtI,EAAsB,IAAI,EAiE7CmJ,GAAAzO,IAAA0N,GAAqBpI,EAAsBtF,GAAQ,IAAI,EAOvD0O,GAAA1O,IAAA0N,GAAqBpI,EAAsBtF,GAAQ,IAAI,EAOvD2O,GAAA3O,IAAA0N,GAAqBpI,EAAsBtF,GAAQ,IAAI,EAOvD4O,GAAA5O,IAAA0N,GAAqBpI,EAAsBtF,GAAQ,IAAI,EA6B7D6O,GAAApD,IAAA1L,GAAiB0L,EAAU,EAW7BqD,GAAA,IAAA95C,EAAA,GAAA4wC,EAAuB,EAAK,EAM5BmJ,GAAA,IAAA/5C,EAAA,GAAA4wC,EAAuB,EAAK,SAalCwH,GAAgB,KAAK,IAAI,EAAG/H,EAAsB,CAAC,GAQnD2J,GAAA,IAAA5B,GAAgB,KAAK,IAAIhI,EAAS,OAAS,EAAGC,EAAsB,CAAC,gDAvX3EG,EAAiBvsC,YAqhBqB,MAAAg2C,GAAA,CAAArG,GAAA/I,GAAAn6F,GAAK+N,KAAC,QAC1C,MAAA+jC,IAAaxtD,GAAA4+G,IAAA,YAAAA,GAAqB/I,MAArB,YAAA71G,GAAgCypB,GAAE,eAC/C02F,GAAS3yD,IAAA,YAAAA,GAAY,OACvB,OAAA2yD,KAAW,KAAMzkG,GAAI,KAChBykG,KAAW,MAAMzkG,GAAI,KACvBA,kBA8CG0gG,EAAiB,iCA2Db4F,GAAyB,EAAIL,GAAiB,EAAI8B,GAAc,WAuChF5G,EAAiB,UACnBA,EAAiB,SAAQ,EAE3B7xC,EAAA,GAAA4xC,EAAmB,aAQnBC,EAAiB,UAAS,EAC1B7xC,EAAA,GAAA4xC,EAAmB,KA9BgGsI,GAAA,IAAAl6C,EAAA,GAAA4xC,EAAmB,EAAK,KAA+Cx9G,IAAMA,GAAE,MAAQ,UAAQ4rE,EAAA,GAAK4xC,EAAmB,EAAK,oEAl4FxP5xC,EAAA,GAAEm6C,EAAkBhQ,EAAe,IAAG,CAAErkD,GAAI+kD,KACvCuF,EAAS,SAAW,EAAC,CAAW,OAAQ,KAAM,QAAS,UAAW,QAAS,WAExE8E,GAAkB9E,EAASC,CAAmB,EAAE,GAAIxF,EAAO,8CAInE7qC,EAAA,GAAEo6C,EAAiBhK,EAAS,IAAI+B,IAC/BhI,EAAe,IAAG,CAAErkD,GAAI+kD,KAEfqK,GAAkB/C,GAAQ,GAAItH,EAAO,sBAyEzC6G,IAAgB,QACrBO,GAAa,oYCqFY/xC,EAAM,GAAC,QAAQ,CAAC,sEAAE,GAAC,EADbm6C,EAAA,MAAAC,EAAAp6C,KAASA,EAAQ,iCAFxCV,EAKK7qB,EAAAt8B,EAAA4C,CAAA,EAJH8lD,EAGA1oD,EAAAojC,CAAA,EAFGslB,EACWtlB,EAAA4+D,CAAA,wBADO75C,EAAA,GAAA85C,OAAAp6C,KAASA,EAAQ,6BACvBA,EAAM,GAAC,QAAQ,CAAC,OAAAsE,GAAAC,EAAAL,CAAA,6FAJ9BlE,EAAU,IAAAG,GAAAH,CAAA,mCAmBNA,EAAU,wEAGVA,EAAY,0vBA5DlBA,EAAO,GAAC,OAAS,iHAAiH,2LAoCvHA,EAAK,2HAcLA,EAAK,yBACHA,EAAK,4JAWVA,EAAK,uRA/CRA,EAAK,YAhBvBV,EAYM7qB,EAAA4lE,EAAAt/F,CAAA,EARJ8lD,EAOQw5C,EAAAr1C,CAAA,WAGV1F,EAoDQ7qB,EAAAkP,EAAA5oC,CAAA,EAhDN8lD,EA+CKld,EAAAghC,CAAA,EA9CH9jB,EAeK8jB,EAAAplB,CAAA,EAdHsB,EAaMtB,EAAAhkB,CAAA,EAZJslB,EAWKtlB,EAAAqlB,CAAA,EAVHC,EASQD,EAAAqE,CAAA,SAIdpE,EA6BK8jB,EAAAxR,CAAA,EA5BHtS,EAmBKsS,EAAAhS,CAAA,EAlBHN,EAA2DM,EAAAF,CAAA,SAC3DJ,EAgBKM,EAAAH,CAAA,wBAPHH,EAMSG,EAAAnM,CAAA,SAGbgM,EAA2BsS,EAAAF,CAAA,4BAO3BpS,EAA6BsS,EAAAmnC,CAAA,8BAxDLt6C,EAAqB,gEANtCA,EAAO,GAAC,OAAS,iHAAiH,qBAsChIA,EAAU,sFAmBNA,EAAU,oIA7PrB,MAAAu6C,GAAgB,WAChBC,GAAgB,QAkBb,SAAAC,GAASpzG,EAAoBlI,EAAW/K,EAAS,CAClD,MAAAsmH,EAAM,SAAS,cAAc,OAAO,EAC1CA,EAAI,aAAa,OAAQ,MAAM,EAC/BA,EAAI,aAAa,OAAQv7G,CAAC,EAC1Bu7G,EAAI,MAAQ,mBAAmBtmH,CAAC,EAChCiT,EAAE,YAAYqzG,CAAG,EAGV,SAAAC,GAActzG,EAAoBlI,EAAW/K,EAAS,CACvD,MAAAsmH,EAAM,SAAS,cAAc,OAAO,EAC1CA,EAAI,aAAa,OAAQ,MAAM,EAC/BA,EAAI,aAAa,OAAQv7G,CAAC,EAC1Bu7G,EAAI,MAAQtmH,EACZiT,EAAE,YAAYqzG,CAAG,EAGV,SAAAE,GAAYvzG,EAAoBlI,EAAW/K,EAAS,CACrD,MAAAsmH,EAAM,SAAS,cAAc,UAAU,EAC7CA,EAAI,aAAa,OAAQ,MAAM,EAC/BA,EAAI,aAAa,OAAQv7G,CAAC,EAC1Bu7G,EAAI,YAActmH,EAClBiT,EAAE,YAAYqzG,CAAG,4BAnDR,MAAAtkG,CAAY,EAAAqpD,GACZ,eAAAkpB,CAA8B,EAAAlpB,GAC9B,GAAAt9D,CAAU,EAAAs9D,EAGjBo7C,EAAsB,GAEtBC,EAAQ34G,GAAM,UAEZ44G,EAAW,EAAI,GACfC,EAAyBC,GAAQF,CAAQ,sBAI/Cr7C,GAAO,KACL,OAAO,iBAAiB,UAAWw7C,CAAa,IAElDr4C,GAAS,KACP,OAAO,oBAAoB,UAAWq4C,CAAa,IAE5C,SAAAA,EAAcn/D,EAAoB,EACjBA,EAAM,SAAWA,EAAM,UAAYA,EAAM,MAAQ,MAEvEA,EAAM,eAAc,EACpBo/D,EAAY,GA8BP,SAAAC,EAAmBC,EAAkB,CACtC,MAAAj+B,EAAO,SAAS,sBAAsB09B,CAAK,IACjD19B,EAAK,UAAY,GACjBA,EAAK,OAAS,uCACdA,EAAK,OAAS,OACdA,EAAK,OAAM,UAAa09B,CAAK,GAC7B19B,EAAK,QAAU,sBAEH,UAAA5gC,EAAM9pD,CAAK,IAAK2oH,EAAS,QAAO,EACtC7+D,IAAS,iBACXo+D,GAAYx9B,EAAM5gC,EAAM9pD,EAAM,SAAQ,GAC7B8pD,IAAS,aAClBm+D,GAAcv9B,EAAM5gC,EAAM9pD,EAAM,SAAQ,GAExC+nH,GAASr9B,EAAM5gC,EAAM9pD,EAAM,SAAQ,GAGvC0qF,EAAK,MAAM,QAAU,OACrBA,EAAK,OAAM,WAGJk+B,GAAW,CACZ,MAAAzmD,EAAS,SAAS,yBAAyBimD,CAAK,IAChD51E,EAAS2vB,EAAO,cACtB3vB,GAAA,MAAAA,EAAQ,YAAY2vB,GACd,MAAA0mD,EAAU,SAAS,cAAc,QAAQ,EAC/C,OAAAA,EAAQ,aAAa,QAAS,QAAQ,EACtCA,EAAQ,aAAa,QAAS,MAAM,EACpCA,EAAQ,aAAa,SAAU,MAAM,EACrCA,EAAQ,aAAa,eAAgBT,CAAK,IAC1CS,EAAQ,aAAa,iBAAkBT,CAAK,IAC5C51E,GAAA,MAAAA,EAAQ,YAAYq2E,GACbA,iBAGMJ,GAAY,OAEnBtwG,EADS2wG,iBAAkBV,CAAK,IACrB,SAAQ,EAEnBS,EAAUD,EAAW,EAErBD,MAAe,SACrBA,EAAS,OAAO,iBAAkBxwG,CAAC,EACnCwwG,EAAS,OAAO,aAAc,cAAc,EAC5CA,EAAS,OAAO,SAAUd,EAAa,EACvCc,EAAS,OAAO,SAAUb,EAAa,EAEjC,MAAA3xB,EAAQ,MAASzyE,EAAM,YAAYuyE,CAAc,EACjD8yB,EAAatvB,GAAmBtD,CAAQ,EACxCsC,EAAkBM,GAAmBr1E,EAAM,SAAS,EACpDg1E,EAAYM,GAAaP,CAAe,EACxCuwB,EAAuBD,EACzBvwB,GAAoBC,EAAiBC,CAAS,aAGzCuwB,EAAK,EAAGA,EAAKD,EAAW,OAAQC,IAAE,CACnC,MAAAC,EAASF,EAAWC,CAAE,EAAE,QAC5B,uBACA,OAAO,SAAS,MAAM,EAIlBE,EAAU,MADN,MADE,MAAS,MAAMD,CAAM,GACP,KAAI,GACA,KAAI,EAClCP,EAAS,OAAO,iBAAkBQ,CAAU,EAC5CR,EAAS,OAAO,aAAcO,EAAO,MAAM,GAAG,EAAE,MAAK,EAAG,EAAE,CAAC,GAG7DZ,EAAM,IAAID,CAAQ,EAClBj7C,EAAA,EAAA+6C,EAAa,EAAI,EACX,MAAAiB,EAAY,iBACZC,EAAS,OACXA,IAAMA,CAAA,EAEN,cAAcD,CAAS,GAExB,KAEHP,EAAQ,iBAAiB,OAAM,WAC7Bz7C,EAAA,EAAA+6C,EAAa,EAAK,EAClB,cAAciB,CAAS,EACvBd,EAAM,IAAID,CAAQ,IAGpBK,EAAmBC,CAAQ,iBAMdW,GAAqB,CAC5B,MAAAr4D,EAAS,SAAS,6BAA6Bm3D,CAAK,IACtD,GAAAn3D,EAAO,KACTmc,EAAA,EAAA+6C,EAAa,EAAK,EAClBl3D,EAAO,MAAK,OAEN,MAAAklC,EAAQ,MAASzyE,EAAM,YAAYuyE,CAAc,EACjD8yB,EAAatvB,GAAmBtD,CAAQ,EACxCsC,EAAkBM,GAAmBr1E,EAAM,SAAS,EACpDg1E,EAAYM,GAAaP,CAAe,EACxCuwB,EAAuBD,EACzBvwB,GAAoBC,EAAiBC,CAAS,KAG1C,mBAAAR,CAAiB,QAAWx0E,EAAM,QAAQuyE,CAAc,EAE1DszB,EAAST,iBAAkBV,CAAK,IACtCmB,EAAO,WAAU,EAAG,QAAQ,gBAAgB,EAC5CA,EAAO,WAAU,EAAG,eAAe,MAAM,EACzCA,EAAO,SAAS,mBAAmB,EAEnCA,EAAO,SAAS,WAAU,CACxB,KAAM,gBACN,SAAW,IAAK,SAAU,IAAK,WAAW,EAC1C,KAAeC,EAAU,CACvBA,EAAM,YAAY,MAAM,KAG5BD,EAAO,mBAAmB,EAAK,EAC/BA,EAAO,SAASrxB,CAAiB,EACjCqxB,EAAO,SAAS,CAAC,EAEjBX,EAAW,EAEL,MAAAa,EAAa,SAAS,eAAe,aAAa,EACxDA,EAAW,UAAY,oBAAsBT,EAAW,OACxD/3D,EAAO,UAAS,QACV2sB,GAAI,EACV6qC,EAAY,gBAkDJa,EAAqB,qYChOjC18C,EAA6C7qB,EAAArwB,EAAArJ,CAAA,kFALtCilD,EAAG,KAAAh7B,EAAA6vB,EAAA,MAAAunD,CAAA,qFADV98C,EAIC7qB,EAAAogB,EAAA95C,CAAA,2BAHMilD,EAAG,8EAFPA,EAAG,GAAAG,gNAhBK,SAAAm1B,EAAoB,IAAI,EAAA71B,EAE/BjtE,EAAqB,KASzB,OAAAqwE,GAAS,KACHrwE,GAAK,IAAI,gBAAgBA,CAAG,0EAP3B8iG,IACD9iG,GAAK,IAAI,gBAAgBA,CAAG,EAChCstE,EAAA,EAAAttE,EAAM,IAAI,gBAAgB8iG,CAAI,iHCiOLt1B,EAAM,GAAC,QAAQ,CAAC,sEAAE,GAAC,EADbm6C,EAAA,MAAAC,EAAAp6C,KAASA,EAAQ,iCAFxCV,EAKK7qB,EAAAt8B,EAAA4C,CAAA,EAJH8lD,EAGA1oD,EAAAojC,CAAA,EAFGslB,EACWtlB,EAAA4+D,CAAA,wBADO75C,EAAA,GAAA85C,OAAAp6C,KAASA,EAAQ,6BACvBA,EAAM,GAAC,QAAQ,CAAC,OAAAsE,GAAAC,EAAAL,CAAA,+CAO1BlE,EAAgB,IAAAE,GAAAF,CAAA,+BAcFA,EAAO,2HAD1BV,EAEK7qB,EAAAt8B,EAAA4C,CAAA,2BAfAilD,EAAgB,6FAcFA,EAAO,qLARtB,cACc,MAACA,EAAgB,iBAJvB,IAAI,gBAAgBA,EAAO,oBACvBA,EAAgB,kIAH9BV,EAQK7qB,EAAAt8B,EAAA4C,CAAA,EAPH8lD,EAMG1oD,EAAA7f,CAAA,kCADY0nE,EAAgB,gBAJvB,IAAI,gBAAgBA,EAAO,wCACvBA,EAAgB,+FAf/BA,EAAU,IAAAC,GAAAD,CAAA,IASRA,EAAO,IAAAG,GAAAH,CAAA,mCAwBLA,EAAU,wEAGVA,EAAY,gwBA1ElBA,EAAO,GAAC,OAAS,iHAAiH,2LAoCvHA,EAAK,2PAwCRA,EAAK,uRA7DRA,EAAK,YAhBvBV,EAYM7qB,EAAA4lE,EAAAt/F,CAAA,EARJ8lD,EAOQw5C,EAAAr1C,CAAA,WAGV1F,EAkEQ7qB,EAAAkP,EAAA5oC,CAAA,EA9DN8lD,EA6DKld,EAAA8gC,CAAA,EA5DH5jB,EAeK4jB,EAAAllB,CAAA,EAdHsB,EAaMtB,EAAAhkB,CAAA,EAZJslB,EAWKtlB,EAAAqlB,CAAA,EAVHC,EASQD,EAAAqE,CAAA,SAIdpE,EA2CK4jB,EAAAE,CAAA,EA1CH9jB,EAiCK8jB,EAAA1R,CAAA,EAhCHpS,EAA2DoS,EAAAhS,CAAA,SAC3DJ,EA8BKoS,EAAA9R,CAAA,wBArBHN,EAoBKM,EAAAH,CAAA,wBAGTH,EAA2B8jB,EAAAxR,CAAA,4BAO3BtS,EAA6B8jB,EAAA21B,CAAA,8BAtELt6C,EAAqB,gEANtCA,EAAO,GAAC,OAAS,iHAAiH,qBAsChIA,EAAU,0DASRA,EAAO,kIAwBLA,EAAU,wJAjNlB,SAAAq8C,GAAiB/mD,EAAS,QAASgnD,EAAM,MAAK,CAC/C,MAAAC,MAAU,KACVC,EAAOr9G,GAAc,OAAOA,CAAC,EAAE,SAAS,EAAG,GAAG,EAC9C4vD,KAAUwtD,EAAI,YAAW,KAAMC,EAAID,EAAI,SAAQ,EAAK,CAAC,KAAKC,EAAID,EAAI,QAAO,KACzElwG,KAAUmwG,EAAID,EAAI,SAAQ,KAAMC,EAAID,EAAI,WAAU,KAAMC,EAAID,EAAI,WAAU,KACtE,SAAAjnD,CAAM,IAAIvG,CAAI,IAAI1iD,CAAI,IAAIiwG,CAAG,6BAxC9B,MAAAlmG,CAAY,EAAAqpD,GACZ,eAAAkpB,CAA8B,EAAAlpB,GAC9B,GAAAt9D,CAAU,EAAAs9D,EAEjBg9C,EAAuB,KAEvB5B,EAAsB,GAEtB6B,EAAkC,KAElC5B,EAAQ34G,GAAM,UAEZ44G,EAAW,EAAI,GACfC,EAAyBC,GAAQF,CAAQ,sBAE/Cr7C,GAAO,KACL,OAAO,iBAAiB,UAAWw7C,CAAa,IAElDr4C,GAAS,KACP,OAAO,oBAAoB,UAAWq4C,CAAa,IAE5C,SAAAA,EAAcn/D,EAAoB,EACjBA,EAAM,SAAWA,EAAM,UAAYA,EAAM,MAAQ,MAEvEA,EAAM,eAAc,EACpBo/D,EAAY,kBAIDwB,EAAsBrnB,EAAY37B,EAAgB,CAC/DmG,EAAA,EAAA28C,EAAUnnB,CAAI,EAEdx1B,EAAA,EAAA48C,EAAmB/iD,CAAQ,iBAWdwhD,GAAY,OAEnBtwG,EADS2wG,iBAAkBV,CAAK,IACrB,SAAQ,EAEnBO,MAAe,SACrBA,EAAS,OAAO,OAAQ,cAAc,EACtCA,EAAS,OAAO,eAAgB,cAAc,EAC9CA,EAAS,OAAO,WAAY,KAAI,CAAExwG,CAAC,GAAI,cAAc,EAE/C,MAAAg+E,EAAQ,MAASzyE,EAAM,YAAYuyE,CAAc,EACjD8yB,EAAatvB,GAAmBtD,CAAQ,EACxCsC,EAAkBM,GAAmBr1E,EAAM,SAAS,EACpDg1E,EAAYM,GAAaP,CAAe,EACxCuwB,EAAuBD,EACzBvwB,GAAoBC,EAAiBC,CAAS,aAGzCuwB,EAAK,EAAGA,EAAKD,EAAW,OAAQC,IAAE,CACnC,MAAAC,EAASF,EAAWC,CAAE,EAAE,QAC5B,uBACA,OAAO,SAAS,MAAM,EAGlBrmB,EAAI,MADE,MAAS,MAAMsmB,CAAM,GACP,KAAI,EAE9BP,EAAS,OAAO,OAAQO,EAAO,MAAM,GAAG,EAAE,MAAK,EAAG,EAAE,CAAC,GACrDP,EAAS,OAAO,eAAgBO,EAAO,MAAM,GAAG,EAAE,MAAK,EAAG,EAAE,CAAC,GAC7DP,EAAS,OAAO,OAAQ/lB,EAAMsmB,EAAO,MAAM,GAAG,EAAE,MAAK,EAAG,EAAE,CAAC,GAG7DZ,EAAM,IAAID,CAAQ,EAClBj7C,EAAA,EAAA+6C,EAAa,EAAI,EACX,MAAAiB,EAAY,iBACZC,EAAS,OACXA,IAAMA,CAAA,EAEN,cAAcD,CAAS,GAExB,KAIC,YAAM,6CAA4C,CACtD,OAAQ,OACR,KAAMT,EACN,OAAQ,YAAY,QAAQ,GAAK,GAAI,CACpC,QAAMuB,IACHA,EAAI,OAKDA,EAAI,KAAI,EACd,OAAKtnB,IACNx1B,EAAA,EAAA+6C,EAAa,EAAK,EACX8B,EAAsBrnB,EAAM+mB,GAAiB,WAAY,KAAK,GACpE,QAAOxvB,GAAG,CACX/sB,EAAA,EAAA+6C,EAAa,EAAK,EAClB,QAAQ,MAAM,gBAAkBhuB,CAAG,mBAQtBmvB,GAAqB,CAC5B,MAAAr4D,EAAS,SAAS,6BAA6Bm3D,CAAK,IACtD,GAAAn3D,EAAO,KACTmc,EAAA,EAAA+6C,EAAa,EAAK,EAClB/6C,EAAA,EAAA28C,EAAU,IAAI,EACd94D,EAAO,MAAK,OAEN,MAAAklC,EAAQ,MAASzyE,EAAM,YAAYuyE,CAAc,EACjD8yB,EAAatvB,GAAmBtD,CAAQ,EACxCsC,EAAkBM,GAAmBr1E,EAAM,SAAS,EACpDg1E,EAAYM,GAAaP,CAAe,EACxCuwB,EAAuBD,EACzBvwB,GAAoBC,EAAiBC,CAAS,KAG1C,mBAAAR,CAAiB,QAAWx0E,EAAM,QAAQuyE,CAAc,EAE1DszB,EAAST,iBAAkBV,CAAK,IACtCmB,EAAO,gBAAkB,IACzBA,EAAO,WAAU,EAAG,QAAQ,gBAAgB,EAC5CA,EAAO,WAAU,EAAG,eAAe,MAAM,EACzCA,EAAO,SAAS,mBAAmB,EAEnCA,EAAO,SAAS,WAAU,CACxB,KAAM,gBACN,SAAW,IAAK,SAAU,IAAK,WAAW,EAC1C,KAAeC,EAAU,CACvBA,EAAM,YAAY,MAAM,KAG5BD,EAAO,mBAAmB,EAAK,EAC/BA,EAAO,SAASrxB,CAAiB,EACjCqxB,EAAO,SAAS,CAAC,EAEX,MAAAE,EAAa,SAAS,eAAe,aAAa,EACxDA,EAAW,UAAY,oBAAsBT,EAAW,OACxD/3D,EAAO,UAAS,QACV2sB,GAAI,EACV6qC,EAAY,gBAkDJa,EAAqB,6RCxNnC,MAAAa,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4LCwED78C,EAAQ,4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","names":["minVersion","checkBrowserVersion","uap","UAParser","browser","cpu","device","os","ua","browserName","browserVersion","popupMessage","url","key","value","localVersion","fetchServerVersion","version","error","response","getLocalVersion","forceLocalVersion","checkForServerUpdate","KEYBOARD_CATEGORIES","isKeyboardCategory","category","KeyboardType","obj","convertToKeyboardCategory","str","convertKeyboardTypeToBlocks","type","buildDataKeyboardFromStyle","style","blocks","styleValues","unitValuesMatches","unitValues","e","s","v","element","index","array","getKeyboardShortcusts","mf","keyboardShortcuts","shortcutsByKeyboards","keyboards","_b","_a","keyboard","context","deuxColonnes","cont1","cont2","largeur1","troisColonnes","cont3","largeur2","deuxColonnesResp","options","centrage","texte","texMulticols","nbCols","result","texteCentre","tropDeChiffres","epsilon","listeQuestionsToContenu","exercice","vspace","texConsigne","texIntroduction","texEnumerate","listeQuestionsToContenuSansNumero","retourCharriot","supprimerReferenceCheckbox","texParagraphe","contraindreValeur","min","max","valeur","defaut","accu","gestionnaireFormulaireTexte","params","saisie","listeOfCase","shuffle","nbQuestions","melange","enleveDoublons","exclus","listeIndex","listeIndexProvisoire","i","compteOccurences","rangeMinMax","combinaisonListes","combinaisonListesSansChangerOrdre","Max","enleveDoublonNum","el","egal","a","b","tolerance","FractionEtendue","superieurouegal","inferieurouegal","estentier","round","quotientier","carreParfait","x","randint","listeAEviter","Decimal","range","rand","cpt","checkSum","args","checkString","entries","o","k","liste","spacing","texEnumerateSansNumero","enumerate","enumerateSansPuceSansNumero","consigne","itemize","tableauDeTexte","compareArrays","array1","array2","areSameObject","o1","o2","areSameValues","areSameArray","ar1","ar2","elt","v1","v2","creerCouples","E1","E2","nombreDeCouplesMin","temp","j","enleveElement","item","enleveElementBis","tableaucopie","enleveElementNo","remplaceDansTableau","arr","search","replace","completerNombresUniques","tableau","valeurMax","existants","valeursManquantes","nombreAAjouter","ajouts","choice","listebis","kk","currentIndex","temporaryValue","randomIndex","arrayBis","shuffleLettres","txt","shuffle2tableaux","obj1","obj2","rnd","tmp1","tmp2","shuffle2tableauxSansModif","obj1bis","obj2bis","shuffle3tableaux","obj3","tmp3","tailleMinimale","l","combinaisonListes2","getRandomSubarray","size","shuffled","listOfRandomIndexes","originalArraySize","nbOfIndexes","arrayCloneObject","clonedObj","arrayClone","originalArray","genererBinomesAleatoires","tab","premierNombre","dernierNombre","ordreCroissant","ordreDecroissant","binomes","signe","sommeDesChiffres","n","nString","somme","sommeString","arrondi","nombre","precision","troncature","tmp","tronc","abs","triePositifsNegatifs","positifs","negatifs","nombreDeChiffresDansLaPartieDecimale","nb","except","sauf","nombreDeChiffresDansLaPartieEntiere","nombreDeChiffresDe","ordreDeGrandeur","step","range1","compareNombres","numTrie","unSiPositifMoinsUnSinon","tousDeMemeSigne","val","colours","numId","ObjetMathalea2D","__publicField","colorToLatexOrHTML","coeff","xSVG","ySVG","y","mathalea2d","xmin","ymin","xmax","ymax","pixelsParCm","scale","zoom","optionsTikz","mainlevee","amplitude","id","usePgfplots","centerLatex","objets","ajouteCodeHtml","divsLatex","codeSvg","objet","code","codeLatex","xSvg","ySvg","divOuterHtml","katex","ajouteCodeTikz","skipRepere","axisYMin","axisYMax","codeTikz","shouldNotExpand","codeHTML","listeOptionsTikz","Vide2d","vide2d","convertHexToRGB","couleur","hexDecoupe","convertColorWithDieseToLatex","color","rgb","tabCouleur","convertCodeCouleurToHex","assombrirOuEclaircir","coefficient","convertCodeCouleur","decimalColor","r","g","fixeBordures","rxmin","rymin","rxmax","rymax","rzoom","majBordures","borduresTrouvees","bordures","miseEnEvidence","isArray","coloreUnSeulChiffre","position","getColorLatex","contenu","indexGauche","indexDroite","estDroite","partieEntiere","partieDecimale","avant","chiffreCible","apres","colored","pos","prefixe","suffixe","miseEnCouleur","texteEnCouleur","texteEnCouleurEtGras","barreTexte","text","texteGras","texteItalique","texteEnBoite","ppcm","lcm","sortFractions","f1","f2","ListeFraction","fractions","listetemp","dens","f","listeDesDiviseurs","den","frac","nombreEnLettres","nbstring","nbDec","decstring","partieEntiereEnLettres","dictionnaire","nbString","classeDesMilliards","classeDesMillions","classeDesMilliers","classeDesUnites","obtenirListeFractionsIrreductibles","obtenirListeFractionsIrreductiblesFaciles","listeFractions","fraction","rationnalise","denominateurEnLettre","pluriel","denEnLettre","Grandeur","mesure","unite","uniteParsee","parseUnite","uniteConversion","uniteConversionParsee","isVitesseUnit","baseMps","toMps","cible","fromMps","isDureeUnit","baseSeconds","toSecondsDuree","fromSecondsDuree","exp","facteur","unite2","u1","u2","formatHHMMSS","nbChiffrePartieDecimale","stringNombre","sec","formatDureeTexHMS","texNombre","seconds","hhmmssToSeconds","enSecondes","u","unit","mps","t","H","M","S","total","h","m","parts","puissanceUnite","avantPuissanceUnite","puissancePrefixe","prefixeToPuissance","uniteDeReference","Hms","week","day","hour","minute","second","sign","hms","regexComplete","match","regex","time","creerNomDePolygone","nbsommets","premiersommet","polygone","augmentation","possedeUnCaractereInterdit","motAeviter","lettreDepuisChiffre","saufD","lettreMinusculeDepuisChiffre","lettreIndiceeDepuisChiffre","indiceLettre","sp","premiereLettreEnMajuscule","numAlpha","nospace","numAlphaNum","reverseString","rienSi1","rienSi0","texteExposant","ecritureNombreRelatif","ecritureNombreRelatifc","ecritureAlgebrique","ecritureAlgebriqueSauf1","equal","ecritureAlgebriquec","orangeMathalea","signeMoinsEnEvidence","ecritureParentheseSiNegatif","ecritureParentheseSiMoins","expr","egalOuApprox","reduireAxPlusB","inconnue","reduireAxPlusByPlusC","c","inconnueX","inconnueY","valeurDecimaleFraction","aEgalZero","bEgalZero","cEgalZero","termeA","termeB","termeC","reduirePolynomeDegre3","d","ordreAlphabetique","lister","doubleDeveloppement","reduire","simpleDeveloppement","simpleDeveloppementAvecDoubleX","expression1","expression2","expression3","sommeAGauche","doubleX","xCarre","xSeul","formaterReponse","pgcd","gcd","ppcmListe","numbers","acc","current","obtenirListeFacteursPremiers","facteurs","factorisation","facto","texFactorisation","puissancesOn","texFacto","diviseurs","estPremier","premierMultipleSuperieur","reste","premierMultipleInferieur","listeNombresPremiersStrictJusqua","borneSup","liste1000","cribleEratostheneN","tabEntiers","testMax","premiersEntreBornes","premiersASupprimer","premiersJusqueMax","decompositionFacteursPremiersArray","decomposition","obtenirListeNombresPremiers","prems","isPrime","decompositionFacteursPremiers","premierAvec","inferieur","candidat","produitsEnCroix","quatriemeProportionnelle","p4","extraireRacineCarree","radical","sommeDesTermesParSigne","sommeDesPositifs","sommeDesNegatifs","math","format","evaluate","texRacineCarree","texNombreCoul","positif","negatif","nul","numberFormat","completerZeros","aussiCompleterEntiers","afficherNombre","texNombre2","rangVirgule","texNombre3","nombreAvecEspace","scientifiqueToDecimal","mantisse","fonction","insereEspacesNombre","nbChiffresPartieEntiere","maximumSignificantDigits","trouveLaPrecision","fix","xx","nbFormatAnglais","texPrix","decimalToScientifique","nbDecimal","exposant","mantisseNb","formatMinute","radToDeg","radians","degToRad","degres","degCos","degSin","degTan","angleOppose","angle","Angle","opposeStringArray","complementaireRad","angleEnRadian","supplementaireRad","inverseTan","angleComplementaire","angleSupplementaire","kCosOuKSin","cosOuSin","extractNumerator","latex","num","parenthesesSiNegatif","parenthesesSiNegatifStrigArray","cos","sin","tan","anglesDeBase","moduloDeg","angleEnDegre","coef","moduloRad","angleModulo","valeursTrigo","modulos","mesAngles","mesAnglesNiv1","nombreAnglesDeBase","mesAnglesNiv2","mesAnglesNiv3","PointAbstrait","arg1","arg2","arg3","positionLabel","pointAbstrait","A","isPointAbstrait","isPointsAbstraits","MainLevee","rs","div","svg","x1","y1","x2","y2","epaisseur","roughness","width","height","start","stop","closed","bowing","rayon","points","roughSvg","rough","tikzAncrages","svgAncrages","labelLatexPoint","taille","largeur","hauteur","couleurDeRemplissage","offset","listePoints","unPoint","Point3d","latexParCoordonnees","labelPoint","Point","texteParPosition","TexteParPoint","orientation","ancrageDeRotation","mathOn","opacite","cx","sx","ratioLettreCm","epaisseurTexte","longueurTexte","latex2d","anchor","texteParPoint","TexteParPointEchelle","scaleFigure","latexParPoint","copyThistexte","texteParPointEchelle","texteParPositionEchelle","point","colorBackground","tailleCaracteres","LatexParCoordonnees","hauteurLigne","LatexParCoordonneesBox","dy","dx","demiLargeur","latexParCoordonneesBox","Latex2d","backgroundColor","letterSize","opacity","marge","tailleDeNbVersLatex","translation","O","nom","Polygone","p2","Droite","N","droite","Segment","segment","translation2Points","B","rotation","vecteur","SensDeRotation","A1","centre","sens","arc1","arc","A2","F1","similitude","F2","s1","s2","sensDeRotation","homothetie","Objet","symetrieAxiale","projectionOrtho","affiniteOrtho","q","Vecteur","ra","V","milieu","nomVecteurParPosition","NomVecteurParPosition","P","M0","M1","M2","angleOriente","optionsDraw","tableauOptions","arrowsOption","map","left","right","leftTip","rightTip","mainLevee","amp","fin","pointSurSegment","B1","B2","C1","C2","debut","ab","Cercle","P1","pointIntersectionLC","P2","I","pointIntersectionDD","cd","segmentAvecExtremites","DemiDroite","extremites","demiDroite","longueur","norme","Cordelette","mollesse","distance","nbPointsIntermediaires","pointsSVG","nbPoints","vecteurAB","vecteurPerp","normePerp","longueurAB","frequence1","frequence2","frequence3","amp1","amp2","amp3","seed","calculerDecalage","facteurExtremites","phase1","phase2","phase3","amplitudeDecalage","decalage","decalageGravite","pointDecale","coordonnees","cordelette","matrix","multiply","norm","cross","dot","rotationV3d","point3D","vecteur3D","unitaire","w","matrice","point3d","Vecteur3d","vecteur3d","rotation3d","droite3D","directeur","origine","W","translation3d","Polygone3d","rotated","p","polygone3d","SensDeRotation3d","axe","droite3d","sensDeRotation3d","z","homothetie3d","rapport","CodageAngleDroit3D","C","BA","BC","k1","k2","M3","BM1","BM3","M1M2","arete3d","M2M3","isVisible","label","alpha","MT","visible","Arete3d","point1","point2","p1","Droite3d","demicercle3d","normal","estCache","angledepart","listepoints","demiCercle","polyline","arc3d","cote","angledefin","nbr","cercle3d","pointilles","listepoints3d","arg","segments3d","segments","triangle2points1hauteur","floor","triangle2points2longueurs","l1","l2","c1","cercle","c2","pointIntersectionCC","triangle2points2angles","a1","a2","dAc1","dBc2","triangle2points1angle1longueur","Q","aireTriangle","medianeTriangle","centreGraviteTriangle","hauteurTriangle","CodageHauteurTriangle","codageAngleDroit","codageHauteurTriangle","codageMedianeTriangle","mark","mil","CodageMilieu","centreCercleCirconscrit","mediatrice","barycentre","sommex","sommey","Polyline","binomeXY","X","Y","polygoneToFlatArray","trianglesIndices","earcut","triangles","pattern","segmentCourant","polygoneAvecNom","nommePolygone","sommets","renommePolygone","noms","polygoneRegulier","carre","polygoneRegulierParCentreEtRayon","BoiteBuilder","xMin","xMax","yMin","yMax","backgroudOpacity","textIn","flatArray","parallelogramme2points1hauteur","pointAdistance","D","rectangle1Point2Longueurs","angleRotation","numA","numB","numC","numD","codageSegments","NommePolygone","G","pt","motifs","motif","distanceDesHachures","epaisseurDesHachures","couleurDesHachures","opaciteDeRemplissage","myPattern","trouveCouple","pt1","pt2","couple","TrouveExtremites","couplesPoints","Polyquad","aire","xOrigine","yOrigine","casesAdjacentes","aireTotale","aireExt","caseAdj","carreChoisi","caseAdjDispo","caseOccupe","caseAdjDispoTrouvee","carresOccupes","casesAdjacentesDispo","tetris2","matriceTransfo","xG","xD","fini","car","quad","borduresNonNettoyees","xor","borduresNettoyees","couplesCoords","couplesPointsRestants","seg","elimineBinomesXYIntermediairesAlignes","sontVecteursAlignes","dx1","dy1","dx2","dy2","binomesXY","pt3","triangle","vMA","vMB","vMC","x3","prodvect","prodscal","prodscalABAB","OM","vd","pointDepuisPointAbstrait","Plot","plot","TracePoint","lePoint","objetssvg","objetstikz","tracePoint","TracePointSurDroite","droiteParPointEtPerpendiculaire","tracePointSurDroite","pointSurCercle","pointSurDroite","pointIntersectionNonTrouveEntre","leNom","lAngle","lePositionLabel","xO","yO","Delta","delta","xi","yi","xiPrime","yiPrime","O1","O2","r0","r1","x0","y0","rx","ry","objet1","objet2","valeurParDefaut","labelOnLine","preferedPosition","usedPosition","absNom","ordNom","oneUsedPosition","positions","xgauche","xdroite","coli","dis","XYlabel","XYlabel2","colision","found","disMax","droiteAvecNomLatex","arg4","arg5","xsav","ysav","dessousDessus","positionLabelDroite","xLab","yLab","fXmax","fYmax","fXmin","fYmin","droiteParPointEtVecteur","droiteParPointEtParallele","droiteHorizontaleParPoint","droiteParPointEtPente","droiteVerticaleParPoint","Mediatrice","couleurMediatrice","couleurConstruction","construction","detail","markmilieu","markrayons","epaisseurMediatrice","opaciteMediatrice","pointillesMediatrice","arcm1","traceCompas","arcm2","arcn1","arcn2","codage","codageMediatrice","sAM","sBM","sAN","sBN","codes","Bissectrice","couleurBissectrice","tailleLosange","epaisseurBissectrice","opaciteBissectrice","pointillesBissectrice","demiangle","dMN","sOM","sON","codageBissectrice","tNP","tMP","tOM","tON","sMP","sNP","bissectrice","distancePointDroite","codageMilieu","CodageMediatrice","CodageBissectrice","lieu","codageAngle","CodageCarre","codageCarre","AfficheLongueurSegment","horizontal","afficheLongueurSegment","TexteSurSegment","space","texteSurSegment","placeLatexSurSegment","TexteSurArc","anglerot","d1","determinant","Omegax","Omegay","texteSurArc","AfficheMesureAngle","ecart","mesureEnGras","saillant","colorArc","arcEpaisseur","mesureAngle","mesureAngleString","marque","afficheMesureAngle","AfficheCoteSegment","Cote","positionCote","couleurCote","epaisseurCote","positionValeur","couleurValeur","afficheCoteSegment","codageSegment","echelle","CodageSegments","trouveExtrem","pointsOuSegment","premierElement","condition","CodageAngle","mesureOn","texteACote","tailleTexte","echelleMark","angleArrondi","depart","arcangle","directionLatex2d","directionAB","placeLatex2d","markTypeArray","MarqueAngle","sommet","end","aPrime","aSeconde","marqueGrasse","marqueGrasse1","marqueGrasse2","marqueSimple1","marqueSimple2","marque1","marque2","Rapporteur","semi","avecNombre","precisionAuDegre","stepGraduation","rayonsVisibles","numero","azimut","nbDivisions","arcPlein","azimut2","arc2","rapporteur","OA","OB","AB","CodageAngleDroit","noAngleDroit","angleNumerique","cercleTrigo","cosOrSin","monAngle","tAngle","tCos","tSin","J","I2","J2","cercleCentrePoint","sOI","sMx","sMy","texteAngle","Rx","Ry","texteCosinus","texteSinus","sCos","sSin","marqueAngle","objetsTrigo","Arc","omega","rayons","medX","medY","ee","angleSVG","sweep","large","lng","Omega","arcPointPointAngle","definePropRo","prop","get","numDen","normalizeFraction","maxDecimalesNumDen","quotientNumDen","quotientDenNum","inverseNum","inverseDen","iDen","denTest","inverseDenTest","iNum","numTest","inverseNumTest","prodNumDen","numIrred","denIrred","pourcentage","signeString","texFraction","texFractionSR","texFSD","texFractionSignee","valeurDecimale","texFractionSaufUn","texFractionSaufUnSignee","texFSP","texParentheses","texFractionSimplifiee","estEntiere","estParfaite","estIrreductible","f2Arg","simplify","calcul","commonDenominator","coeffMultiplicatorA","coeffMultiplicatorB","fResult","simplification","symbole","space2","couleurFinale","listenum","listeden","listeNumvf","listeDenvf","numerateur","denominateur","redaction","redactionFinale","n2","n5","detaillee","rac","factoDen","factoNum","etape","unite0","unite1","unegraduation","dep","diviseur","tailleCarres","n1","d2","fractionsSimplifiees","fractionSimplifiee","reponses","reponse","egalesEtSimplifiees","listeFraction1","listeFraction2","listeCouples","ecriture1","ecriture2","exportedNouvelleVersionWrapper","numeroExercice","numeroQuestion","signature","seedrandom","exportedReinit","fig","Figure","leDragAndDrop","listener","exportedApplyNewSeed","generateSeed","empreinteTexte","CryptoJS","exportedQuestionJamaisPosee","argsConcatenes","empreinte","includeUpperCase","includeNumbers","length","startsWithLowerCase","Exercice","ExerciceSimple","hasProp","object","setStyles","styles","paire","paireArr","addText","strict","create","tag","attrs","txtContent","attr","addElement","parent","content","engine","ComputeEngine","cleanFractions","cleanFractionsMemesNegatives","modif","p3","cleanDivisions","replaceUnescapedCommas","string","replaceThinSpaces","cleanComas","cleanSpaces","patterns","cleanDoubleSpaces","cleanEspaceNormal","cleanParentheses","cleanMathRm","cleanUnity","cleanPower","cleanLatex","cleanMultipliyByOne","generateCleaner","operations","cleaningFunctions","operation","cleaned","cleaningFn","inputToGrandeur","input","split","split2","flatten","op","base","expo","exprs","allFactorsMatch","ops1","ops2","exclusifFactorisation","signeCurrent","nbMatchOK","nbNonAttendu","allMatch","op2","newOp2","factorisationCompare","goodAnswer","nbFacteursIdentiquesFactorisation","unSeulFacteurLitteral","clean","aCleaned","bCleaned","saisieParsedInit","reponseParsedInit","saisieHead","answerHead","saisieParsed","reponseParsed","saisieDev","reponseDev","isOk1","feedback","reponseFactors","saisieFactors","result2","nbNumber","hmsCompare","cleanInput","inputHms","parser","lhs","terminator","rhs","fonctionComparaison","expressionsForcementReduites","avecSigneMultiplier","avecFractions","sansTrigo","fractionIrreductible","fractionReduite","fractionDecimale","fractionEgale","fractionIdentique","nombreDecimalSeulement","expressionNumerique","additionSeulementEtNonResultat","soustractionSeulementEtNonResultat","multiplicationSeulementEtNonResultat","divisionSeulementEtNonResultat","ensembleDeNombres","kUplet","suiteDeNombres","suiteRangeeDeNombres","puissance","seulementCertainesPuissances","sansExposantUn","HMS","developpementEgal","intervalle","estDansIntervalle","ecritureScientifique","precisionUnite","texteAvecCasse","texteSansCasse","egaliteExpression","calculFormel","nonReponseAcceptee","variable","entier","domaine","functionCompare","intervalsCompare","intervalCompare","scientifiqueCompare","unitsCompare","comparaisonPuissances","texteAvecCasseCompare","texteSansCasseCompare","egaliteCompare","numberWithSpaceCompare","expressionNumeriqueCompare","ensembleNombres","comparaisonFraction","ontDeveloppementsEgaux","expressionDeveloppeeEtReduiteCompare","customCanonical","expression","cleanIput","cleanGoodAnswer","saisieNativeParsed","reponseNativeParsed","localInput","localGoodAnswer","substitutions","parsedExpression","saisieCalculeeParsed","reponseCalculeeParsed","negateBeforeDelimiter","node","iNeg","iDel","saisieJSON","evaluateExpression","expr1","expr2","expr1Reduite","item1","expr2Reduite","item2","substituted","expressionDeveloppeeEtNonReduiteCompare","isScientific","regex1","regex2","exponent","saisieClean","reponseClean","saisieCleanFormattee","number","decoupageSaisie","mantisseSaisie","reponseCleanFormattee","cleaner","goodAnswerParsed","inputParsed","equalFractionCompareSansRadical","contenuDeuxiemeAccolade","nombreSaisi","goodAnswerSplit","exposantGoodAnswer","exposantSaisi","exposantSaisiNumber","isOk","exposantGoodAnswerNumber","avecAccolades","splitInput","splitGoodAnswer","inputSorted","goodAnswerSorted","isOk2","extractBornesAndOp","extractCrochets","borneAndOpSaisie","borneAndOpReponse","crochetsSaisie","crochetsReponse","inputGrandeur","goodAnswerGrandeur","okPrecision1","okPrecision2","inputNumber","strictGauche","strictDroit","bornes","borneInf","okGauche","okDroit","consecutiveCompare","entierInf","valeurInter","entierSup","goodAnswerEntierInf","goodAnswerEntierSup","diff","diff1","diff2","approximatelyCompare","answerClean","inputFn","cleanAnswer","goodAnswerFn","valAlea","variablea","variableb","variablec","vars","m1","m2","goodAnswerMb1","goodAnswerMb2","isOk3","isOk4","formatNumberWithSpaces","separator","decimal","entierFormate","decimalFormate","inputCleanFirst","inputClean","goodAnswerClean","goodAnswerNew","exprCompare","noUselessParen","nbParenInput","nbParenAnswer","numbersInput","_c","numbersAnswer","_d","opsInput","_e","opsAnswer","_f","checkLeCompteEstBon","target","quatreOperationsObligatoires","answer","addCount","multiplyCount","divideCount","subtractCount","tropDeNombres","nombresEnDoublon","mauvaisNombre","symboleNonAutorise","operationNonAutorisee","listeNombresEnonce","visit","toutPourUnPoint","toutAUnPoint","prev","verifQuestionMathLive","writeResult","noFeedback","champTexte","getCustomFeedback","formatInteractif","spanReponseLigne","bareme","callback","variables","mfe","resultat","table","cellules","compareFunction","spanFedback","ii","nbBonnesReponses","nbReponses","saisies","compteurSaisiesVides","compteurBonnesReponses","spanFeedback","customFeedback","objetReponse","check","types","addFeedback","container","message","titre","cssIcon","divTitre","messageFeedback","shuffleJusquaWithIndexes","lastChoice","newArray","indexes","_","qcmCamExport","questions","propositions","laConsigne","introduction","enonceBis","enonce","props","statuts","question","bonneReponse","qcmCamExportAll","exercices","questionnaire","listExercices","exo","materiel","afficheScore","nbMauvaisesReponses","divScore","divButton","verifQuestionQcm","nbBonnesReponsesAttendues","nbReps","divReponseLigne","proposition","indice","typeFeedback","eltFeedback","propositionsQcm","texteCorr","espace","vertical","classCss","elimineDoublons","isTrueFalse","vrai","faux","vraiProp","fauxProp","formateQ","rep","formateRV","formateRF","isRadio","doublonsTrouves","empty","elts","renderLatexToHTMLFragment","li","renderMathInElement","spanToInvisible","afficheChoice","image","span","ListeDeroulante","choices","choix0","conteneur","sansFleche","select","char","event","fleche","widthSpan","withoutOffset","realIndex","choix","ul","ld","ListeDeroulanteElement","name","oldValue","newValue","verifQuestionListeDeroulante","choixDeroulant","listeDeroulanteToQcm","ordered","MetaExercice","ExercicesCAN","listeTypeDeQuestions","listeDeQuestions","exercicesRef","nbTotalQuestions","repartition","exercices1","exercices2","exercices3","indexQuestion","numExo","UnExercice","Question","formatChampTexte","optionsChampTexte","remplisLesBlancs","handleAnswers","compare","ajouteChampTexteMathLive","that","monQcm","dragStartHandler","dragOverHandler","icone","dragEndHandler","dropHandler","dropTarget","etiquetteId","etiquette","matches","numeroExQuest","numeroEx","numeroQuest","clonedEtiquette","addDeleteButton","touchStartHandler","ele","touchMoveHandler","touch","top","rectangleBounds","touchX","touchY","rectangles","rectangle","touchEndHandler","centerX","centerY","dragEnterHandler","dragLeaveHandler","deleteBtn","verifDragAndDrop","exoDragAndDrops","objetReponses","etiquettesAbsentes","etiquettesMalPlacees","etiquettesBienPlacees","etiquettesDedans","etiquetteDedans","etiquettesIds","etiquettesTxts","listeOfIds","DragAndDrop","etiquettes","enonceATrous","duplicable","html","rule","etiquetteRaw","etiquettesEnDesordreOuPas","resteEnonce","htmlEnonce","chunks","divEtiquettes","isAnswerValueType","isClickFiguresArray","figures","setCliqueFigure","exerciceInteractif","buttonScore","nbQuestionsValidees","nbQuestionsNonValidees","verifExerciceCustom","verifQuestionCliqueFigure","divFeedback","eltExercice","correction","prepareExerciceCliqueFigure","objetFigure","figSvg","mouseOverSvgEffect","mouseOutSvgEffect","mouseSvgClick","erreur","nbFiguresCliquees","eltFigure","setReponse","valeurs","laReponseDemandee","isValidNumber","cleanedValue","handleDefaultValeur","reponseAttendueEstUnNombre","showDialogForLimitedTime","dialogId","nbOfMilliseconds","innerHTML","dialog","sleep","ms","resolve","showPopupAndWait","popup","refreshButton","closeButton","debug","log","optionalParams","logDebug","statsTracker","exercise","recorder","vue","oldUrl","statsPageTracker","getIntrus","list1","list2","count","count1","count2","allKeys","intrus","VueTypeArray","convertVueType","FILTER_SECTIONS_TITLES","canOptions","writable","MathAleaURL","exercicesParams","ex","paramToBeRemoved","param","buildMathAleaURL","global","globalOptions","can","buildEsParams","buildDsParams","title","cryptedUrl","encrypt","mode","presentationMode","es","ds","urlParts","newUrl","nextChar","combinedCharCode","partEncrypted","partToEncrypt","hexPartEncrypted","hex","decrypt","part1","part2withEEEE","codeStr","firstCharCode","lastCharCode","decryptedPart","part2","isCrypted","EXAMS","isExerciceItemInReferentiel","isExamItemInReferentiel","isJSONReferentielEnding","isTool","resourceHasPlace","resourceHasMonth","isLevelType","codeList","isNonEmptyArrayOfStrings","isStaticType","isCrpeType","isStaticWithoutPngUrl","isGeoDynamic","geoDynRegExp","freezeUrl","isInIframe","changes","darkMode","capytaleMode","capytaleStudentAssignment","resultsByExercice","isMenuNeededForExercises","isMenuNeededForQuestions","previousView","bibliothequeDisplayedContent","moveExercice","iDepart","iArrivee","urlToWrite","timerId","updateGlobalOptionsInURL","canStore","presModeId","currentUrl","logParam","pdfParam","bigInt","handleBugsnag","Bugsnag","createURL","isDevMode","notifyLocal","metadatas","notify","appendCell","isInteractif","line","icell","indexCol","indexLine","classes","NoEx","NoQ","cell","spanAvant","classeString","spanApres","spanResultat","classe","fillLine","AddTabPropMathlive","ligne1","ligne2","tableauMathlive","firstLine","entete1","secondLine","entete2","spanCheckOuterHTML","lgn1","lgn2","gras","nbColonnes","output","cellule","AddTabDbleEntryMathlive","newLine","sty","raw","nbLines","tabEntetesColonnes","tabEntetesLignes","tabLignes","headingCols","enTete","headingLines","raws","haveHeadC","haveHeadL","buildDataKeyboardString","ajouteQuestionMathlive","reponseParams","typeInteractivite","typeTableau","texteAvant","texteApres","blocCenter","ajouteChampTexte","ajouteFeedback","ajouteChamp","placeholder","dataKeyboard","balise","blanc","mfeValue","resteContent","YEARS","MONTHS","isLessThan1Month","dateString","jour","mois","annee","date","elapsedTime","unMois","toMap","dico","cle","getRecentExercices","refObj","findResourcesAndPaths","getAllEndings","codeToLevelTitle","levelCode","listeNiveaux","codeListForLevels","listeThemes","codeListForThemes","fetchThrough","referentiel","harvest","goalReachedWith","path","find","ref","retrieveResourceFromUuid","targetUuid","resource","pathToObject","pathsToObjectsArray","items","buildReferentiel","refList","mergeReferentielObjects","objects","isObject","pVal","oVal","allStaticReferentiels","referentielStaticFR","referentielStaticCH","buildExercisesList","filter","promiseExos","exosParams","paramsExercice","isStatic","foundResource","mathaleaHandleParamOfOneExercice","mathaleaLoadExerciceFromUuid","uuid","isSvelte","urlExercice","uuidToUrl","splitExercisesIntoQuestions","consignes","corrections","consignesCorrections","isCorrectionVisible","indiceExercice","indiceQuestionInExercice","mathaleaHandleExerciceSimple","cumulConsignesCorrections","mathaleaFormatExercice","setSizeWithinSvgContainer","originalClientWidth","originalClientHeight","svgContainers","svgContainer","updateFigures","resizeSchemaContainer","schemaContainer","originalWidth","originalHeight","resizeContent","scratchDivs","scratchDiv","svgDivs","resizeTags","checkboxes","checkbox","schemaContainers","svgDiv","figure","newHeight","newWidth","eltsInVariationTables","initialTop","initialLeft","tags","factor","widthUnit","heightUnit","widthAttributeExists","heightAttributeExists","updateIframeSize","iframe","formattedTimeStamp","nbOfSeconds","nbOfHours","nbOfMinutes","nbOfSecondsLeft","setPhraseDuree","duree","getUniqueStringBasedOnTimeStamp","prefix","timeStamp","debounce","delay","immediate","timeout","later","callNow","millisecondToMinSec","milliseconds","serviceId","rpc","RPC","answersFromCapytale","assignmentDataFromCapytale","firstTime","currentMode","toolSetActivityParams","activity","workflow","studentAssignment","assignmentData","canOptionsStore","newExercicesParams","newGlobalOptions","newCanOptions","mathaleaGoToView","mathaleaWriteStudentPreviousAnswers","newState","sendToCapytaleMathaleaHasChanged","sendToCapytaleSaveStudentAssignment","results","newStudentAssignement","evaluation","resultExercice","bestScore","data","sendToCapytaleActivityParams","handleCapytale","activityParams","renderScratch","selector","scratchblocks","scratchFr","scales","ALLOWED_LANGUAGES","isLanguage","VUES_WITH_LANG_STATUS_ONLY","localisedIDToUuid","refToUuidCH","refToUuidFR","referentielLocale","updateReferentielLocaleFromURL","urlString","lang","updateURLFromReferentielLocale","locale","getLang","isIntegerInRange0to2","isIntegerInRange0to3","isIntegerInRange0to4","isIntegerInRange1to4","ERROR_MESSAGE","getExerciceByUuid","root","targetUUID","child","foundObject","getSvelteComponent","filename","directory","__variableDynamicImportRuntimeHelper","__vitePreload","isCan","attempts","maxAttempts","module","modules","loader","ClasseExercice","serverUpdated","mathaleaGetExercicesFromParams","infosExerciceStatique","contentCorr","sujet","numeroInitial","examen","mathaleaHandleStringFromUrl","mathaleaGenerateSeed","mathaleaHandleSup","mathaleaRenderDiv","renderKatex","chaine","mathaleaUpdateUrlFromExercicesParams","mathaleaUpdateExercicesParamsFromUrl","currentRefToUuid","urlNeedToBeFreezed","durationGlobal","nbVues","flow","screenBetweenSlides","pauseAfterEachQuestion","isImagesOnSides","sound","manualMode","order","answers","done","presMode","setInteractive","isSolutionAccessible","isInteractiveFree","oneShot","twoColumns","isTitleDisplayed","beta","canDuration","canTitle","canSolAccess","canSolMode","canIsInteractive","newExercisesParams","previousEntryWasUuid","entry","newExercisesParamsFiltered","nbVuesCandidate","flowCandidate","soundCandidate","cptSecours","getDistracteurs","distracteur","qcm","exerciceSimple","distracteursNonSolutions","reponseReponse","formattedText","destinationView","originView","oldPart","newPart","waitForElement","elementId","timeWait","reject","tempTime","timeWait1000","checkExist","promiseAnswers","sheetElement","reason","idOriginalAndDate","etiquetteOriginale","clock","actions","action","formula","eles","getExercisesFromExercicesParams","exercises","vendor","insert","div1","state","$$props","onMount","counter","interval","nextcount","$$invalidate","if_block","ctx","create_if_block_2","create_if_block_1","create_if_block","button","button_id_value","dirty","disabled","icon","iconFirst","buttontext_changes","inverted","div0","append","if_block0","if_block1","div3","div2","score","div4","subTitle","buildStringScore","getScore","keyboardState","loadMathLive","divExercice","champs","MathfieldElement","handleFocusMathField","handleFocusOutMathField","filteredContent","setMathfield","hauteurExercice","domExerciceInteractifReady","isCorrected","indexQuestionCliqueFigure","elementArray","documentPositionComparator","figs","numbs","questionCliqueFigure","div_class_value","consigneCorrection","nextQuestion","questionContainer","onDestroy","handleKeyUp","handleMathfieldElement","questionContent","afterUpdate","updateInteractivity","ev","$canOptions","set_store_value","$keyboardState","figureCliquables","figureCliquable","clocks","box","apigeoms","handleApigeomClick","selects","onHoverEnd","$$value","i_1","i_1_class_value","t0_value","button_aria_controls_value","button_aria_selected_value","button_class_value","set_data","t0","nav","numberOfQuestions","resultsByQuestion","i_class_value","i0","i0_class_value","i1","i1_class_value","button0","button1","button2","i2","button3","i3","div13","div12","div11","div9","div10","button5","button6","action_destroyer","swipe","handleEndOfRace","initTE","Modal","endButtonDiv","direction","handleSwipe","prefixes","units","Unit","pre","cat","symbol","pow","UnitSystem","prefixList","lengthUnits","areaMetricUnits","areaOtherUnits","volumeMetricUnits","volumeOtherUnits","massUnits","basicKeys","massUnitsKeys","lengthUnitsKeys","areaUnitsKeys","volumeUnitsKeys","capacityUnitsKeys","keys","specialKeysCaps","numbersCaps","complexesCap","numbersCaps2","numbersCapsX","numbersOperationsCaps","numbersOperationsXCaps","numbersSpaceCaps","variableCaps","basicOperationCaps","basicOperationPlusCaps","basicOperationCaps2","fullOperationCaps","terminaleCaps","numerationCaps","probabiliteCaps","ensembleCaps","ensembleDefiniCaps","suiteCaps","hmsCaps","greekCaps","compareCaps","degreCaps","degreCelsiusCaps","trigoCaps","advancedCaps","anglesCaps","aToHCaps","iToPCaps","qToWCaps","xToZCaps","vFONCaps","eosnCaps","lengthsCaps","areasUnitsKeys","areasCaps","volumesUnitsKeys","volumesCaps","capacitiesUnitsKeys","capacitiesCaps","massesUnitsKeys","massesCaps","specialKeys","complexes","numbersX","numbers2","numbersOperations","numbersOperationsX","numbersSpace","vFON","basicOperations","basicOperations2","basicOperationsPlus","fullOperations","clavierFonctionsTerminales","numeration","probabilite","greek","degre","degreCelsius","trigo","advanced","lengths","areas","ensemble","ensembleDefini","suite","volumes","capacities","masses","angles","uppercaseAToH","uppercaseIToP","uppercaseQToW","uppercaseXToZ","estOuestSudNord","keyboardBlocks","KEYCAP_WIDTH","KEYCAP_HEIGHT","GAP_BETWEEN_BLOCKS","GAP_BETWEEN_KEYS","SM_BREAKPOINT","MD_BREAKPOINT","LG_BREAKPOINT","getMode","innerWidth","isInLine","Keyboard","kb","block","inLineBlockWidth","numberOfKeys","raw_value","div_id_value","button_1","button_1_class_value","keyName","isSpecial","clickKeycap","keycapwidth","keycapheight","isSpecialKey","isPageKey","each_blocks","key_1_changes","gapsize","blocksList","toRegularCharacters","possibleBlocks","switchToBlock","newBlock","currentBlock","blockgapsize","div0_class_value","unitsBlocks","usualBlocks","page","beforeUpdate","rowsAlphaLow","rowsAlphaUp","rowsNum","alphanumericLayouts","pageType","rows","button1_class_value","div_transition","create_bidirectional_transition","fly","button1_disabled_value","keyboardpage_changes","pages","currentPageIndex","divKeyboard","alphanumericDisplayed","myKeyboard","computePages","pageWidth","blockList","blockWidth","tick","navRight","navLeft","idMathField","div2_class_value","widthFactor","displayedTime","durationInMilliSeconds","dispatch","createEventDispatcher","elapsed","duration","lastTime","frame","update","terminateTimer","timeD","formattedtime","question_changes","div1_class_value","timer_changes","numberOfSeconds","checkAnswers","timerComponent","exercicesAffiches","endTimer","du","titles","isDisabled","classAddenda","textSize","buttonSize","toggle","formatAnswer","create_if_block_4","ol","raw0_value","removeMathField","raw1_value","raw2_value","raw3_value","div3_hidden_value","div4_hidden_value","div5","div5_class_value","div6","html_tag","html_tag_1","create_if_block_3","cleanFillInTheBlanks","removeDollar","removeInteractiveClock","cleanSelect","solutionDisplayed","displayCorrection","answersContents","activeStats","_paq","paramExos","uuids","vueUuids","paraConvert","par","vueUuids1","parsedExo","statsCanTracker","kickoff_changes","if_block2","if_block3","if_block4","div3_class_value","recordedTimeFromCapytale","gOpt","splitResults","$globalOptions","answersType","qcmAnswers","_g","resultsByExerciceArray","ind","quest","$resultsByExercice","getDuration","getRecordedScore","getScoreTotal","buildTime","$darkMode","canvas","remToPixels","rem","getTextWidth","font","getCssStyle","getCanvasFont","fontWeight","fontSize","fontFamily","isLocalStorageAvailable","countMathField","numbOfAnswerFields","autoCorr","handleCorrectionAffichee","observer","h1","h1_class_value","showNumber","svg_class_value","defs","marker0","path0","marker1","path1","path2","circle0","circle1","path3","path4","path5","path6","path7","isOnStateActive","button0_class_value","is_function","button_data_tip_value","buttontextaction1_changes","indiceLastExercice","newData","switchCorrectionVisible","switchInteractif","columnsCount","columnsCountUpdate","click_handler_1","click_handler_2","div6_id_value","li_id_value","exerciseIndex","questionIndex","t1_value","t1","each_value","ensure_array_like","get_key","set_style","article","$exercicesParams","isCorrectVisible","headerExerciceProps","numberOfAnswerFields","forceUpdate","adjustMathalea2dFiguresWidth","updateAnswers","q1","field","objAnswers","setAllInteractif","removeAllInteractif","updateDisplay","initButtonScore","verifExerciceVueEleve","previousBestScore","numberOfPoints","isThisTryBetter","initialDimensionsAreNeeded","mathalea2dFigures","initialWidth","initialHeight","eltsInFigures","consigneDiv","newdata","plusMinus","uuidCount","counts","exercisesUuidRanking","codesList","ranks","rank","monter","descendre","button0_data_tip_value","button1_data_tip_value","button4","isContentVisible","interactifReady","randomReady","settingsReady","correctionReady","correctionExists","isSortable","isDeletable","isHidable","isSettingsVisible","titleAddendum","titleBase","ressourcesUuids","uuidsRessources","profsUuids","refProfs","remove","duplicate","newExercice","decompo","create_if_block_32","show_if","input_max_value","each_value_4","add_render_callback","form","option","t_value","create_if_block_28","create_if_block_26","each_value_3","create_if_block_22","create_if_block_20","each_value_2","create_if_block_16","create_if_block_14","each_value_1","create_if_block_10","create_if_block_8","create_if_block_33","create_if_block_31","create_if_block_29","create_if_block_27","create_if_block_25","create_if_block_23","if_block6","create_if_block_21","if_block7","create_if_block_19","create_if_block_17","if_block9","create_if_block_15","if_block10","create_if_block_13","create_if_block_11","if_block12","create_if_block_9","if_block13","create_if_block_7","create_if_block_5","if_block15","if_block16","if_block17","h3","exerciceIndex","sup","sup2","sup3","sup4","sup5","versionQcm","alea","correctionDetaillee","isCommentDisplayed","formNum1","formNum2","formNum3","formNum4","formNum5","previousSeed","parseFormNumerique","entreesFormulaire","entrees","dernier","dispatchNewSettings","to_number","select_value","div4_class_value","toggleSidenav","interfaceParams","exercicesNumber","subscribeExercicesParamsStore","exerciceHasNoSettings","isExerciceChecked","generateTitleAddendum","headerProps","unsubscribeToChangesStore","updateExerciceAfterLanguageChange","handleNewSettings","list","withNewVersion","verifExercice","handleExerciseRemoved","clickSettings_handler","section","img","img_src_value","referentielBibliotheque","zoomFactor","filiere","resourceToDisplay","noCorrectionAvailable","handleNoCorrectionAvailable","exercicehtml_changes","exercicestatic_changes","exerciseType","ComponentExercice","getExercise","getExerciseType","isBorderTransparent","zoomMinus","updateSize","zoomPlus","zoomEvent","floatUnderText","cornerIcon","cornerIconClass","tooltip","tooltipPosition","img1","img1_src_value","img0","brandImagePath","productImagePath","goToVueProf","footer","t2_value","button_disabled_value","span0","span1","t2","buttontextaction_changes","div8","div8_class_value","div7","exercice_changes","create_if_block_12","section_class_value","isDisabledButton","divsCorrection","currentWindowWidth","eleveSection","$vendor","urlToDisplay","urlOptions","buildExoTitle","dim","nbOfExercises","navigationHeaderElt","exerciseTitleElt","roomForOne","$isMenuNeededForExercises","buildQuestionTitle","nbOfQuestions","questionTitleElt","$isMenuNeededForQuestions","resizeObserver","buildQuestions","body","checkQuestion","resu","handleIndexChange","exoNum","questionEvent","click_handler","click_handler_3","click_handler_4","toggle_handler","exerciseTitle","questionTitle","subtitle","languages","buildLangIconPath","country","src_url_equal","isMenuOpen","handleLanguage","loc","dialog_1","isDisplayed","isWithCloseButton","showLanguageChoiceModal","buttonicon_changes","subtitleType","keydown_handler","footer_class_value","a0","handleUrl","generateLatex","userSettings","itemsWithExercises","preambuleLight","outputCorr","document","numberOfVersions","intro","genericPreamble","loadFonts","latexFileInfos","loadNoteBasExercices","contents","testIfLoaded","loadPreambule","loadPreambuleCan","loadPackagesFromContent","loadProfCollegeIfNeed","values","valueToPut","display","decompDNB","squareO","valuetoSearch","Latex","indiceVersion","questionLiee","subTab","questionSuivante","getUrlFromExercice","writeIntroduction","writeInCols","writeQuestions","seedOld","confExo","contentVersion","addPackages","latexCmds","latexPackages","pack","cmd","preamble","latexWithoutPreamble","latexWithPreamble","packLatex","packageFiltered","numbersNeeded","blocrep","specs","buildImagesUrlsList","exosContentList","picsNames","imagesFilesUrls","year","serie","file","getExosContentList","getPicsNames","picsList","regDeleteCommentaires","regExpImage","regExpImageName","pics","matchIm","imgObj","imgFile","doesLatexNeedsPics","exos","makeImageFilesUrls","AvecLesDoublesEspaces","downloadZip","filesUrls","zipFileName","zip","JSZip","JSZipUtils","err","splitUrl","fileName","saveAs","downloadTexWithImagesZip","latexFile","withImages","urls","imagesFolder","downloadFile","contentDisplayed","successMessage","errorMessage","displayDuration","isSuccessDisplayed","isErrorDisplayed","close_handler","close_handler_1","textToCopy","urlToDownload","useCurrentUrl","removeSeed","actionFunction","copyToClipboard","download","returnString","main","main_class_value","textarea","footer1","handleKeyDownUserInput","userInput","latexOutput","formatUserInput","parsedInput","$userInput","handleValidate","exercisesParams","exportQcmAmc","idExo","autoCorrection","texQr","horizontalite","lastchoice","nbChiffresPd","nbChiffresPe","sautDeLigneApresEnonce","valeurAMCNum","digitsBase","digitsExposant","digitsNum","digitsDen","signeNum","reponseF","reponseAlsoCorrect","nbChiffresExpo","demiMediane","qr","qrType","creerDocumentAmc","nbExemplaires","matiere","typeEntete","indexOfCode","nombreDeQuestionsIndefinie","graine","groupeDeQuestions","texQuestions","titreQuestion","melangeQuestion","formatLatex","isImpressionRectoVerso","checkBoxImpressionRectoVerso","preambule","debutDocument","enteteTypeCodeGrid","enteteTypeChampnomSimple","enteteTypePreremplie","enteteCopie","contenuCopie","input_class_value","input_value_value","valueSelected","labelsValues","bgColor","valueHasChanged","t3_value","t6_value","set_input_value","t3","t6","div14","input0","input1","input2","div15","input3","input4","input5","input6","input7","entete","nbQuestionsModif","exercicesARetirer","refsExercicesARetirer","textForOverleaf","isNonAMCModaleDisplayed","isOverleafModalDisplayed","initExercices","proprietes","overleafForm","handleOverLeaf","nbQ","h10","h11","notes","chargement","paramUrl","logs","ANKI_API_URL","ankiConnect","importer","note","nbExos","nbExosDejaPresent","label_class_value","explanations","inLine","customUrl","imageId","QRCodeOptions","QRCodeCopyState","updateQRCodeImage","QRCode","imageElement","copyQRCodeImageToClipboard","canCopyImagesToClipboard","blob","getBlobFromImageElement","copyBlobToClipboard","downloadQRCodeImage","timestamp","imageSrc","downloadLink","buttontogglealt0_props","buttontogglealt1_props","buttontogglealt2_props","buttontogglealt3_props","buttontogglealt4_props","formradio2_props","buttontogglealt6_props","a0_class_value","a1_class_value","div19","div19_class_value","input1_disabled_value","div20","div20_class_value","div22","div22_class_value","input2_disabled_value","div59","div58","li0","li1","div31","div16","div30","div17","div29","div25","div18","div24","div21","div23","div28","div26","div27","div38","div34","div32","div33","div37","div35","div36","div39","div40","div57","div43","div41","div42","div56","div46","div44","div45","div49","div47","div48","div52","div50","div51","div55","div53","div54","buttontogglealt0_changes","buttontogglealt1_changes","buttontogglealt2_changes","buttontogglealt3_changes","t34","t34_value","buttontogglealt4_changes","formradio2_changes","buttontogglealt6_changes","buttonactioninfo0_changes","buttonqrcode_changes","buttonactioninfo1_changes","buttonactioninfo2_changes","Tab","handleSeed","btnElementId","tabElementId","btnElement","tabElement","availableLinkFormats","currentLinkFormat","handleVueSetUp","nextView","isDataRandom","toggleCan","$$self","input_id_value","label_for_value","span2","isQuestionsVisible","currentVue","nbOfVues","setCurrentVue","setQuestionsVisible","setCorrectionVisible","handleCorrectionsStepsClick","newDataForAll","backToSettings","change_handler","change_handler_1","t4","t4_value","seriesIndex","series","correctionsSteps","currentSeriesIndex","zoomUpdate","aside","slideshow","updateExercises","correctionVisibility","questionsVisibility","newParams","oldZoom","newZoom","questionsNb","slide","slideView","divQuestion","isQuestionVisible","currentSlide","currentQuestion","selectedQuestionsNumber","appId","isFullscreenRequestEnabled","isFullscreenExitEnabled","doc","isFullScreen","handleFullscreenChange","isInFullScreen","switchFullScreen","handleFullScreenError","requestFullScreen","exitFullScreen","method","BUTTONS_CLASS","isPause","isManualModeActive","prevQuestion","switchPause","cursorTimeValue","messageDuree","handleTimerChange","isTimerSettingsModalDisplayed","switchDisplayMode","pause","play","currentSlideDuration","isTimerSettingsModalDisplayedOnce","displayTimerSettingsModal","getDisplayMode","currentQuestionNumber","totalQuestionsNumber","goToQuestion","ratioTime","stepsUl","steps","diapoProgressContainer","returnToStart","goToOverview","header","slideshowplaysteps_changes","slideshowplayquestion_changes","slideshowplaysettings_changes","getSizes","transitionSounds","isManualPause","advanceRatioTimeInterval","userZoom","optimalZoom","renderAllViews","playCurrentQuestion","optimalZoomUpdate","findOptimalZoom","vueIndex","exerciseContainerDiv","optimalZoomForViews","findOptimalZoomForView","questionDiv","correctionDiv","questionHeight","questionWidth","correctionHeight","correctionWidth","containerWidth","containerHeight","questionWidthOptimalZoom","correctionWidthOptimalZoom","questionCorrectionHeightOptimalZoom","handleShortcut","isUserAction","questionNumber","span_class_value","tr","td0","td1","td2","td3","numberinput0_changes","numberinput1_changes","thead","th0","th1","th2","th3","tbody","t13","t13_value","selectedExercisesIndexes","stringDureeTotale","getTotalDuration","sum","updateQuestionsNb","updateDuration","getTotalNbOfQuestions","label_1","label_1_class_value","isChecked","checkboxwithlabel1_changes","numberinput_changes","updateManualMode","updateDurationGlobal","previousDurationGlobal","isSameDurationForAll","handleChangeIsSameDurationForAll","newIsSameDurationForAll","updatePreviousDurationGlobal","newDurationGlobal","isSameData","nbOfViews","updateNbOfViews","updateIsImagesOnSides","labelsForMultivue","newvalue_handler","isQuestionsOrdered","updateQuestionsOrder","t5_value","t5","applyRandomSelectionOfExercises","isSelectedExercises","selectedExercisesCount","updateFlow","updateScreenBetweenSlides","updateTune","updatePauseAfterEachQuestion","questionThenCorrectionToggle","questionWithCorrectionToggle","labelsForSounds","soundToggle","tuneCandidate","tune","viewsettings_changes","transitionsettings_changes","ordersettings_changes","selectedexercisessettings_changes","globaldurationsettings_changes","exercisessettings_changes","startSlideshow","goToHome","divTableDurationsQuestions","previousNumberOfSelectedExercises","numberOfSelectedExercises","selection","updateSelect","splitSvgFromText","sourceText","mathalea2dContainers","scratchContainers","svgs","removeSvgContainers","wholeQuestion","questionWithoutSvgContainers","isSameArray","$previousView","updateSlidesContent","updateParamsFromUrl","setSlidesContent","adjustQuestionsOrder","updateExerciseParams","newExercises","slides","reroll","isSelected","idVue","questionSvgs","questionText","consigneSvgs","consigneText","correctionSvgs","correctionText","originalSeed","selectedIndexes","getSelectedQuestionsIndexes","constants_0","child_ctx","label0","label1","label2","t7_value","p0","t7","getCompetenceIcon","create_if_block_6","h2","option0","option1","option2","latexToHtml","exerciceUuid","parseLatexQuestions","latexContent","latexCorrection","extractItems","isEnonce","enumerateMatch","mathaleaUrl","itemContent","cleanComplexLatex","enonceItems","correctionItems","badge","emoji","competenceName","sectionElement","evaluationData","competencesDisponibles","modeEvaluation","seuilTBM","seuilMS","seuilMF","estExerciceStatique","nbQuestionsReelles","questionsParsees","toggleCompetenceExercice","exIndex","comp","toggleCompetence","qIndex","toggleDetailParQuestion","updatePoints","supprimerQuestion","ouvrirCorrection","totalCalcul","input_handler","pointsExercice","constants_1","constants_2","constants_5","constants_8","t9_value","t14_value","t16_value","create_if_block_42","create_if_block_40","create_if_block_41","get_if_ctx_2","create_if_block_30","button3_disabled_value","button4_disabled_value","t9","t14","t16","get_if_ctx_1","create_if_block_24","div0_title_value","t10_value","create_if_block_38","t8","t8_value","t10","each_value_11","create_if_block_36","create_if_block_35","each_value_9","h4","create_if_block_37","each_value_10","create_if_block_34","button2_class_value","button3_class_value","formatNote","span6","span8","span10","span3","span4","span5","span7","span9","span11","t11_value","getGenreColor","circle1_stroke_value","t11","t15","t15_value","t17","t17_value","getExerciceIcon","div_title_value","div2_title_value","div3_title_value","div3_data_tooltip_value","t18_value","t36_value","h30","h31","h32","h33","t18","t36","h5","div1_title_value","strong","sexe","sexeLower","rounded","normalizeCompetenceName","trimmedName","formatText","formatted","students","currentStudentIndex","currentExerciceIndex","csvInput","correctionSection","currentPage","competencesPersonnalisees","competencesActivees","showCompetenceEditor","studentScoreData","niveauMaitrise","competences","totalQuestions","toutesQuestionsEvaluees","showSummaryModal","showAutoNextMessage","commentaireGlobal","isListening","recognition","dictatedText","badgeUpdateTrigger","modeAffichageCartes","searchQuery","filteredStudents","showConfirmModal","confirmModalData","modeCorrectionsActive","showCorrections","loadingCorrections","performSearch","query","student","calculateClassStats","pointsObtenusClasse","nbTermines","nbEnCours","nbNonCommences","competencesGlobales","notesCorrigees","baremeTotal","getTotalPoints","calculateStudentScore","correctedQuestions","countCorrectedQuestions","competencesStudent","calculateCompetences","nbCopiesCorrigees","moyenneClasse","notesSorted","noteMin","noteMax","mediane","middle","competencesStats","niveau","studentId","studentCorrections","showConfirm","onConfirm","confirmText","cancelText","onCancel","exportJSON","exportData","dataStr","dataBlob","link","imprimerBilanClasse","classStats","printWindow","niveauGlobal","getNiveauMaitriseAvecNonCorrige","statut","imprimerBilansIndividuels","commentaire","exercicePoints","calculateExercicePoints","exerciceNiveau","getExerciceNiveau","status","info","compData","countQuestionsNRNE","questionsNR","questionsNE","loadEvaluationData","evalDataStr","configStr","competencesStr","studentsStr","evalExercicesStr","preferenceCorrections","evalExercices","toast","competencesActiveesStr","initializeCompetencesFromEvaluation","config","storedCorrections","allCompetences","saveCompetencesPersonnalisees","modifierCompetences","competence","reinitialiserCompetences","closeSummaryModal","startListening","SpeechRecognition","transcript","stopListening","saveCurrentStudentComment","currentStudentId","loadCurrentStudentComment","nextStudent","previousStudent","getNiveauMaitrise","questionsEvaluees","previousState","handleFileUpload","reader","parseCSV","csvText","dataLines","prenom","resetStudentsList","resetStudentCorrection","studentName","isCurrentStudent","newCorrections","competencesKey","startCorrection","studentIndex","proceedToCorrection","loadCorrectionsForEvaluation","correctionsPresentes","backToOverview","updateQuestionStatus","checkAndMoveToNextExercise","updateAllQuestionsStatus","pointsObtenus","pointsTotaux","questionsNEExplicites","questionsNonCorrigees","comps","normalizedComp","correct","statsNRNE","click_handler_6","func_2","click_handler_8","click_handler_9","click_handler_15","click_handler_16","click_handler_17","click_handler_18","click_handler_19","click_handler_20","click_handler_21","click_handler_23","func_4","click_handler_27","exercicesBadges","overviewBadges","progress","progress_value_value","form0","form1","defaultengine","defaultreturn","addinput","inp","addinputnoenc","addtextarea","clockAbled","idkey","original","timer","tweened","handleKeyDown","compileToPDF","submitFormToIframe","formData","resetIframe","iframe2","ace.edit","picsWanted","imagesUrls","im","imaUrl","stringfile","timeValue","$timer","dialogToDisplayToggle","editor","edite","imageLatex","iframe_src_value","generateFilename","ext","now","pad","pdfBlob","downloadFilename","downloadAndExtractPDF","res","ProfMaquette","input1_value_value","textForOverleafInput","textForProfMaquette","copyDocumentToOverleaf","option_value_value","select0","select1","option3","option4","option5","select_option","fieldset","legend","input8","label3","selectedExos","globalConfig","applyGlobalConfig","idx","exoConfig","cancelAllChanges","select_multiple_value","_i","_h","_l","_k","_j","fieldset1","legend0","fieldset0","legend1","label4","label5","select_value_value","input0_value_value","input2_value_value","_m","input3_value_value","_p","_o","_n","input4_value_value","dialogConfigToDisplayToggle","formradio_props","h6","formradio_changes","formradio0_props","formradio1_props","h60","h61","h62","formradio0_changes","formradio1_changes","formradio3_props","formradio4_props","h63","h64","h65","handle_promise","promise_1","formradio3_changes","formradio4_changes","promise","isExerciceStaticInTheList","encodeBase64","decodeBase64","input1_placeholder_value","input2_placeholder_value","buttonactioninfo_changes","img0_src_value","img0_alt_value","img1_alt_value","h12","buildMessageForCopyPaste","decoded","imgStylePartialUrls","dialogLua","messageForCopyPasteModal","divText","isDownloadPicsModalDisplayed","updateLatexWithAbortController","clone","UpdateController","rej","updateLatex","_UpdateController","Carousel","handleActionFromDownloadPicsModal","handleDownloadPicsModalDisplay","toggle_class","showAdvanced","activeTab","indexesToLoad","newPdfParam","a2_class_value","ul0","li2","section0","pre0","section1","h13","h14","h15","pre1","downloadGift","preElt","downloadScorm","contentScorm","indexHtml","contentGift","xmlScorm","xmlManifest","xmlMetadata","xmlSchema","xmlSchemaVersion","xmlOrganizations","xmlOrganization","xmlTitle","xmlResources","aleaType","showTitle","xmlItem","xmlResource","useAlea","xmlDependency","xmlFile","ident","dir","sendActivityParams","exoParams","isBackToTopButtonVisible","backToTop","func","chipexo_changes","chipsListDisplayed","listIdsForChips","Sortable","evt","lIFC","keyValue","div_intro","create_in_transition","reorderModalDisplayed","setupButtonsList","exportButtonsList","setAllInteractive","isAllInteractive","trash","setFullScreen","g1","g0","rect","text_1","tspan","handleExport","exportQcmCam","click_handler_5","hasExercices","isSidenavOpened","isRecorder","inputID","buildUrlAndOpenItInNewTab","showSettingsDialog","importExercises","isExercisesListEmpty","isCapytale","handleRecorder","urlFeuilleEleve","isExerciseDisplayed","isNavBarVisible","inputnumber_props","inputtext_props","div6_class_value","inputnumber_changes","inputtext_changes","buttontoggle_props","buttontoggle_changes","setInteractivity","modalcapytalsettingscan_props","modalcapytalsettingsdata_props","modalcapytalsettingstitles_props","modalcapytalsettingscorrection_props","modalcapytalsettingsinteractivity_changes","modalcapytalsettingscan_changes","modalcapytalsettingsdata_changes","modalcapytalsettingstitles_changes","modalcapytalsettingscorrection_changes","isSettingsDialogDisplayed","updateParams","img_alt_value","application","reversed","selected","loadImages","listeCodes","addAppToList","isPresent","removeAppFromList","matchingIndex","handelSelection","card_changes","thirdAppsChoiceModal","showThirdAppsChoiceDialog","appsTierceInExercisesList","appsTierceReferentielArray","appsTierce","each_blocks_1","video","video_src_value","TRANSITION_DURATION","SLIDE_DURATION","scrollToSlide","slideElement","currentSlideIndex","intervalId","carouselContent","legacyCarouselContent","nextSlide","goToSlide","startAutoPlay","stopAutoPlay","handleMouseEnter","handleMouseLeave","handleIndicatorClick","monthes","span1_data_tip_value","show_if_1","show_if_2","ending","nestedLevelCount","nomDeExercice","selectedCount","compareCodes","countOccurences","unsubscribeToExerciceParams","endingTitre","addToList","newExercise","$changes","removeFromList","mouseIsOut","handleMouseOver","handleMouseOut","regexp","matchs","ul_transition","referentielnode_changes","referentielending_changes","themeCodeisSubthemeCode","themeCode","level","regexp3Auto","themes","themesList","themesCH","themesListCH","subset","unfold","indexBase","levelTitle","pathToThisNode","levels","codeToLevelList","themeTitle","prepareSubset","keyA","valueA","keyB","valueB","key2","jourA","jourB","moisA","bibliothequeUuidInExercisesList","uuidList","$bibliothequeDisplayedContent","stringWithNoAccent","MultiCriteria","criterion","OrCriteria","firstCriterion","secondCriterion","firstResult","secondResult","AtLeastOneOfCriteria","criteriaList","resultCriterion","featuresCriteria","amcCriterion","qcmCriterion","qcmcamCriterion","interactifCriterion","spec","levelCriterion","considerCAN","tagCriterion","selectedTag","monthCriterion","monthToMatch","idCriterion","idToMatch","examCriterion","examToMatch","yearCriterion","yearToMatch","subjectCriterion","subject","isCanIncluded","subjectToLowerCaseWithoutAccent","placeMatch","buildCriteriaFromString","criteria","re","regExpResult","wordsTemp","words","premier","word","theArray","connector","realWord","stringToCriterion","justAndCriteria","orAssociations","orListTransit","first","others","orCriteriaUnion","allFilters","getSelectedLevels","filters","selectedLevels","getSelectedFiltersObjects","filterType","filterObject","getSelectedFeatures","selectedFeatures","handleUncheckingMutipleFilters","clgKeys","lyceeKeys","applyFilters","collection","selectedSpecs","finalLevelsCriterion","levelsCriteria","specsCriteria","filtersHaveChanged","timeTag","handleFiltersChanges","selectedEntry","$filtersHaveChanged","$allFilters","textColor","triggerAction","thisStringRepresentsANumber","customSortingForResources","transformAutomatismId","digit1","letter","digit2","optionalSuffix","sortArrayOfResourcesBasedOnProp","mapped","sortArrayOfResourcesBasedOnYearAndMonth","resourceAYear","resourceBYear","resourceAMonth","resourceBMonth","customSortStringNumber","splitAlphaNumeric","part","compareAlphaNumeric","aParts","bParts","aPart","bPart","comparison","triAnnales","getUniques","uniques","treatedUuids","origin","addExercise","inputSearch","searchField","isFiltersVisible","selectedFilters","lastInput","isInputFocused","isCtrlDown","isKDown","isEnterDown","unsubscribeToFiltersStore","fetchResults","updateResults","inputSearchSamples","typeWriter","resultsWithDuplicates","getResults","unsortedResults","nonStatics","statics","eltA","eltB","nameA","nameB","handleInput","beginsWithQuote","triggerUpdate","onFocusInput","onBlurInput","matchOnResultsList","onEnterDown","matchingResource","onKeyDown","getFocusOnSearchInput","onKeyUp","selectorTarget","textList","textListI","delayMs","inputDiv","resourcesSet","foundResources","searchInput","triggerUpdateFromSearchBlock","toggleThirdAppsChoiceDialog","getContext","createoriginalReferentielsFR","examsReferentiel","referentielExams","activations","referentielsActivation","examens","orderedExamsReferentiel","baseReferentiel","referentielAlea","referentielOutils","referentielProfs","referentielHtml","referentielRessources","biblioReferentiel","baseGeometrieDynamiqueReferentiel","referentielGeometrieDynamique","newExercisesReferentiel","baseAndNewsReferentiel","aleaReferentiel","exercicesGeometrieDynamique","geometrieDynamiqueReferentiel","allReferentielsInMenus","activatedReferentielsInMenu","createoriginalReferentielsCH","examsReferentielCH","referentielExamsCH","examensCH","baseReferentielCH","referentielAleaCH","newExercisesCH","newExercisesReferentielCH","baseAndNewsReferentielCH","exercicesCH","allReferentielsInMenusCH","activatedReferentielsInMenuCH","deepReferentielInMenuCopy","originals","copy","referentiels","localeLangLoaded","getReferentiels","referentielnode_props","searchblock_changes","excludedReferentiels","searchBlock","referentielsForMenu","localeValue","unsubscribeToReferentielLocale","updateRepositories","updatedRepositories","repositoriesInMenu","repositoryInMenu","filteredRepository","buildFilteredRepository","orderFollowingSchoolLevel","allExercices","filteredExercices","keyToBeFirst","buildResourcesSet","refList2","clavier","header_changes","selectedThirdApps","isMd","Sidenav","Collapse","Ripple","addScrollListener","selectedLanguage","localeID","frenchID","updateBackToTopButtonVisibility","updateSelectedThirdApps","exerciceParams","group","app","eventName","tempRecorder","setContext","forceOpening","sideMenuWrapper","sidenav","exercisesQcms","onClose","closePopup","showPopup","globalOptionsUnsubscriber","exercicesParamsUnsubscriber","handlePopupClose","updateContext","updateVendor","canSub","App"],"ignoreList":[],"sources":["../../src/lib/components/browserVersion.ts","../../src/lib/components/version.ts","../../src/lib/interactif/claviers/keyboard.ts","../../src/modules/context.ts","../../src/lib/format/miseEnPage.js","../../src/modules/outils.ts","../../src/lib/outils/arrayOutils.ts","../../src/lib/outils/nombres.ts","../../src/modules/2dGeneralites.ts","../../src/lib/outils/embellissements.ts","../../src/modules/ListeFraction.js","../../src/modules/nombreEnLettres.ts","../../src/modules/fractions.ts","../../src/modules/Grandeur.ts","../../src/modules/Hms.ts","../../src/lib/outils/outilString.ts","../../src/lib/outils/ecritures.ts","../../src/lib/outils/primalite.ts","../../src/lib/outils/calculs.ts","../../src/lib/outils/texNombre.ts","../../src/lib/mathFonctions/trigo.ts","../../src/lib/2d/points-abstraits.ts","../../src/lib/2d/MainLevee.ts","../../src/lib/2d/textes.ts","../../src/lib/2d/transformations.ts","../../src/lib/2d/segmentsVecteurs.ts","../../src/lib/3d/3dProjectionMathalea2d/tranformations.ts","../../src/lib/3d/3dProjectionMathalea2d/elements.ts","../../src/lib/2d/triangle.ts","../../src/lib/2d/polygones.ts","../../src/lib/2d/points.ts","../../src/lib/2d/droites.ts","../../src/lib/2d/codages.ts","../../src/lib/2d/angles.ts","../../src/lib/2d/cercle.ts","../../src/modules/FractionEtendue.ts","../../src/exercices/exerciseMethods.ts","../../src/exercices/Exercice.ts","../../src/exercices/ExerciceSimple.ts","../../src/lib/html/dom.ts","../../src/lib/interactif/comparisonFunctions.ts","../../src/lib/interactif/mathLive.ts","../../src/modules/messages.js","../../src/lib/amc/qcmCam.ts","../../src/lib/interactif/afficheScore.ts","../../src/lib/interactif/qcm.ts","../../src/lib/interactif/listeDeroulante/ListeDeroulante.ts","../../src/lib/interactif/listeDeroulante/ListeDeroulanteElement.ts","../../src/lib/interactif/questionListeDeroulante.ts","../../src/exercices/MetaExerciceCan.ts","../../src/lib/interactif/DragAndDrop.ts","../../src/lib/interactif/gestionInteractif.ts","../../src/lib/components/dialogs.ts","../../src/modules/statsUtils.ts","../../src/lib/types.ts","../../src/lib/stores/canStore.ts","../../src/lib/components/urls.ts","../../src/lib/types/referentiels.ts","../../src/lib/stores/generalStore.ts","../../src/bugsnag.ts","../../src/lib/interactif/tableaux/AjouteTableauMathlive.ts","../../src/lib/interactif/questionMathLive.ts","../../src/lib/types/dates.ts","../../src/lib/components/toMap.js","../../src/lib/components/refUtils.ts","../../src/lib/components/exercisesUtils.ts","../../src/lib/components/sizeTools.ts","../../src/lib/components/time.ts","../../src/lib/handleCapytale.ts","../../src/lib/renderScratch.js","../../src/lib/types/languages.ts","../../src/lib/stores/languagesStore.ts","../../src/lib/types/integerInRange.ts","../../src/lib/mathalea.ts","../../src/lib/stores/vendorStore.ts","../../src/components/display/can/presentationalComponents/CountDown.svelte","../../src/components/shared/forms/ButtonText.svelte","../../src/components/shared/forms/ButtonTextAction.svelte","../../src/components/display/can/presentationalComponents/End.svelte","../../src/components/display/can/presentationalComponents/KickOff.svelte","../../src/components/keyboard/stores/keyboardStore.ts","../../src/modules/loaders.js","../../src/lib/interactif/cliqueFigure.js","../../src/components/display/can/presentationalComponents/Question.svelte","../../src/components/display/can/presentationalComponents/Pagination.svelte","../../src/components/display/can/presentationalComponents/ShortPagination.svelte","../../src/components/display/can/presentationalComponents/NavigationButtons.svelte","../../src/components/keyboard/lib/unitsSystem.ts","../../src/components/keyboard/lib/keycaps.ts","../../src/components/keyboard/layouts/keysBlocks.ts","../../src/components/keyboard/lib/sizes.ts","../../src/components/keyboard/types/keyboardContent.ts","../../src/components/keyboard/presentationalComponents/keyboardpage/keyboardblock/keycap/Keycap.svelte","../../src/components/keyboard/types/keycap.ts","../../src/components/keyboard/presentationalComponents/keyboardpage/keyboardblock/BlockOfKeycaps.svelte","../../src/components/keyboard/presentationalComponents/keyboardpage/keyboardblock/BlockOfKeycapsWithPagination.svelte","../../src/components/keyboard/presentationalComponents/keyboardpage/KeyboardPage.svelte","../../src/components/keyboard/layouts/alphanumericRows.ts","../../src/components/keyboard/presentationalComponents/alphanumeric/Alphanumeric.svelte","../../src/components/keyboard/Keyboard.svelte","../../src/components/display/can/presentationalComponents/ElapsedTime.svelte","../../src/components/display/can/presentationalComponents/Timer.svelte","../../src/components/display/can/presentationalComponents/Race.svelte","../../src/components/shared/forms/ButtonToggle.svelte","../../src/components/display/can/presentationalComponents/Solutions.svelte","../../src/modules/stats.ts","../../src/components/display/can/Can.svelte","../../src/lib/components/measures.ts","../../src/lib/stores/storage.ts","../../src/components/shared/exercice/countMathField.ts","../../src/components/shared/exercice/handleCorrection.ts","../../src/components/shared/exercice/presentationalComponents/shared/HeaderExerciceVueEleve.svelte","../../src/components/shared/icons/TwoStatesIcon.svelte","../../src/components/shared/exercice/exerciceMathalea/exerciceMathaleaVueEleve/presentationalComponents/ExerciceVueEleveButtons.svelte","../../src/components/shared/exercice/exerciceMathalea/exerciceMathaleaVueEleve/presentationalComponents/Question.svelte","../../src/components/shared/exercice/exerciceMathalea/exerciceMathaleaVueEleve/ExerciceMathaleaVueEleve.svelte","../../src/lib/components/counts.ts","../../src/components/shared/exercice/shared/headerExerciceVueProf/BoutonMonter.svelte","../../src/components/shared/exercice/shared/headerExerciceVueProf/BoutonDescendre.svelte","../../src/components/shared/exercice/shared/headerExerciceVueProf/HeaderExerciceVueProf.svelte","../../src/components/shared/exercice/exerciceMathalea/exerciceMathaleaVueProf/presentationalComponents/Settings.svelte","../../src/components/shared/exercice/exerciceMathalea/exerciceMathaleaVueProf/ExerciceMathaleaVueProf.svelte","../../src/components/shared/exercice/exerciceMathalea/ExerciceMathalea.svelte","../../src/components/shared/exercice/presentationalComponents/exerciceHtml/ExerciceHtml.svelte","../../src/components/shared/exercice/presentationalComponents/exerciceStatic/ExerciceStatic.svelte","../../src/components/shared/exercice/Exercice.svelte","../../src/components/shared/ui/btnZoom.svelte","../../src/components/shared/forms/ButtonIcon.svelte","../../src/components/shared/forms/ButtonIconTooltip.svelte","../../src/components/shared/vendors/Banner.svelte","../../src/components/display/eleve/FlipCard.svelte","../../src/components/display/eleve/Footer2.svelte","../../src/components/display/eleve/Eleve.svelte","../../src/components/shared/header/NavBarSubtitle.svelte","../../src/lib/components/languagesUtils.ts","../../src/components/shared/ui/LanguageStatus.svelte","../../src/components/shared/ui/LanguageIcon.svelte","../../src/components/shared/ui/LanguageDropdown.svelte","../../src/components/shared/modal/BasicClassicModal.svelte","../../src/components/shared/modal/ModalLanguageChoice.svelte","../../src/components/shared/header/NavBar.svelte","../../src/components/Footer.svelte","../../src/lib/alacarte.ts","../../src/lib/latex/preambule.tex?raw","../../src/lib/latex/preambuleTex.ts","../../src/lib/Latex.ts","../../src/lib/files.ts","../../src/components/shared/modal/BasicInfoModal.svelte","../../src/components/shared/forms/ButtonActionInfo.svelte","../../src/components/setup/alacarte/Alacarte.svelte","../../src/lib/amc/creerDocumentAmc.js","../../src/components/shared/forms/FormRadio.svelte","../../src/components/setup/amc/Amc.svelte","../../src/components/setup/anki/Anki.svelte","../../src/components/shared/forms/ButtonToggleAlt.svelte","../../src/components/shared/forms/ButtonQRCode.svelte","../../src/components/setup/configEleve/ConfigEleve.svelte","../../src/components/setup/diaporama/slideshowOverview/presentationalComponent/SlideshowOverviewLeftPanel.svelte","../../src/components/setup/diaporama/slideshowOverview/presentationalComponent/mainPanel/SlideshowOverviewSerie.svelte","../../src/components/setup/diaporama/slideshowOverview/presentationalComponent/mainPanel/SlideshowOverviewMainPanel.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/ZoomButtons.svelte","../../src/components/setup/diaporama/slideshowOverview/SlideshowOverview.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlayQuestion/CorrectionWithImagesInside.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlayQuestion/CorrectionWithImagesOnSides.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlayQuestion/QuestionWithImagesInside.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlayQuestion/QuestionWithImagesOnSides.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlayQuestion/SlideshowPlayQuestion.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/FullscreenButton.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlaySettings/SlideshowPlayDisplaySettings.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlaySettings/SlideshowPlayControlSettings.svelte","../../src/components/shared/forms/RangeSlider.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlaySettings/SlideshowPlayTimerSettingsModal.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlaySettings/SlideshowPlayOtherSettings.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/slideshowPlaySettings/SlideshowPlaySettings.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/SlideshowPlaySteps.svelte","../../src/components/setup/diaporama/slideshowPlay/presentationalComponents/SlideshowPlayEndButtons.svelte","../../src/components/setup/diaporama/slideshowPlay/SlideshowPlay.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/DisplaySettings.svelte","../../src/components/shared/forms/InputNumber.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/ExercisesSettings.svelte","../../src/components/shared/forms/CheckboxWithLabel.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/GlobalDurationSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/LinksSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/ViewSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/OrderSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/SelectedExercisesSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/presentationalComponents/TransitionSettings.svelte","../../src/components/setup/diaporama/slideshowSettings/SlideshowSettings.svelte","../../src/components/setup/diaporama/Diaporama.svelte","../../src/components/setup/evaluation/Evaluation.svelte","../../src/components/setup/correction/Correction.svelte","../../src/components/shared/forms/ButtonCompileLatexToPDF.svelte","../../src/components/shared/forms/PDFviewer.svelte","../../src/components/shared/forms/ButtonCompileLatexToPDFLink.svelte","../../src/lib/latex/ProfMaquette.sty?raw","../../src/components/shared/forms/ButtonOverleaf.svelte","../../src/components/shared/ui/SimpleCard.svelte","../../src/components/shared/forms/FormConfigGlobal.svelte","../../src/components/shared/forms/FormConfigIndividual.svelte","../../src/components/shared/forms/ButtonConfig.svelte","../../src/components/setup/latex/FormConfigSection.svelte","../../src/components/setup/latex/LatexConfig.ts","../../src/components/setup/latex/Latex.svelte","../../src/components/setup/latex/PdfResult.svelte","../../src/components/setup/latex/Pdf.svelte","../../src/components/setup/moodle/Moodle.svelte","../../src/lib/handleRecorder.ts","../../src/components/setup/start/presentationalComponents/ButtonBackToTop.svelte","../../src/components/setup/start/presentationalComponents/Exercices.svelte","../../src/components/shared/ui/ChipExo.svelte","../../src/components/shared/ui/ChipsList.svelte","../../src/components/setup/start/presentationalComponents/header/ModalReorder.svelte","../../src/components/shared/ui/ButtonsDeck.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/InteractivityButton.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/ReorderButton.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/NewDataButton.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/TrashButton.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/setupButtons/SetupButtons.svelte","../../src/components/shared/icons/PdfTextIcon.svelte","../../src/components/shared/icons/AmcIcon.svelte","../../src/components/shared/icons/AnkiIcon.svelte","../../src/components/shared/icons/MoodleIcon.svelte","../../src/components/shared/icons/QcmCamIcon.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/exportButtons/ExportButtons.svelte","../../src/components/setup/start/presentationalComponents/header/headerButtons/HeaderButtons.svelte","../../src/components/setup/start/presentationalComponents/header/SideMenuWrapper.svelte","../../src/components/shared/forms/InputText.svelte","../../src/components/setup/start/capytale/NavBarRecorder.svelte","../../src/components/setup/start/presentationalComponents/header/Header.svelte","../../src/components/setup/start/presentationalComponents/modalCapytalSettings/ModalCapytalSettingsCAN.svelte","../../src/components/setup/start/presentationalComponents/modalCapytalSettings/ModalCapytalSettingsCorrection.svelte","../../src/components/setup/start/presentationalComponents/modalCapytalSettings/ModalCapytalSettingsTitles.svelte","../../src/components/setup/start/presentationalComponents/modalCapytalSettings/ModalCapytalSettingsData.svelte","../../src/components/setup/start/presentationalComponents/modalCapytalSettings/ModalCapytalSettingsInteractivity.svelte","../../src/components/setup/start/presentationalComponents/modalCapytalSettings/ModalCapytalSettings.svelte","../../src/components/shared/icons/StarIcon.svelte","../../src/components/shared/ui/Card.svelte","../../src/components/setup/start/presentationalComponents/ModalThirdApps.svelte","../../src/components/setup/start/presentationalComponents/carousel/Carousel.svelte","../../src/components/setup/start/presentationalComponents/Placeholder.svelte","../../src/lib/components/handleDate.ts","../../src/components/shared/icons/NoInteractivityIcon.svelte","../../src/components/setup/start/presentationalComponents/sideMenu/referentielNode/ReferentielEnding.svelte","../../src/components/setup/start/presentationalComponents/sideMenu/referentielNode/ReferentielNode.svelte","../../src/lib/components/textUtils.ts","../../src/lib/components/filters.ts","../../src/components/setup/start/presentationalComponents/sideMenu/filtersStore.ts","../../src/components/setup/start/presentationalComponents/sideMenu/searchBlock/searchInput/Filtres.svelte","../../src/components/setup/start/presentationalComponents/sideMenu/searchBlock/searchInput/Chip.svelte","../../src/lib/components/sorting.ts","../../src/components/setup/start/presentationalComponents/sideMenu/searchBlock/searchInput/SearchInput.svelte","../../src/components/setup/start/presentationalComponents/sideMenu/searchBlock/SearchBlock.svelte","../../src/components/setup/start/presentationalComponents/sideMenu/SideMenuApps.svelte","../../src/lib/stores/referentielsStore.ts","../../src/components/setup/start/presentationalComponents/sideMenu/SideMenu.svelte","../../src/components/setup/start/Start.svelte","../../src/components/shared/modal/Popup.svelte","../../src/components/App.svelte","../../src/main.ts"],"sourcesContent":["import { UAParser } from 'ua-parser-js'\n\nconst minVersion = {\n  // Mgu  ajouter en fonction des problmes...\n  Chrome: 80,\n  Firefox: 75,\n  Safari: 16,\n  Edge: 80,\n  Opera: 67,\n  GSA: 387, // Google Search App (iOS)\n  WebKit: 605, // Apple WebView (iOS)\n  'Samsung Internet': 14,\n  'Mobile Safari': 12,\n  'Mobile Chrome': 63,\n  'Chrome Headless': 80,\n  'Mobile Firefox': 136,\n}\n\nexport function checkBrowserVersion() {\n  const uap = new UAParser()\n  const { browser, cpu, device, os, ua } = uap.getResult()\n\n  // console.log(uap.getResult())\n  // console.log(cpu)\n  // console.log(device)\n\n  const browserName = browser.name\n  const browserVersion = browser.major ? parseInt(browser.major, 10) : 0\n  let popupMessage = ''\n  if (\n    browserName &&\n    minVersion[browserName as keyof typeof minVersion] &&\n    browserVersion < minVersion[browserName as keyof typeof minVersion]\n  ) {\n    popupMessage = `Votre navigateur (${browserName} ${browserVersion}) est trop vieux. Veuillez mettre  jour votre navigateur pour une meilleure exprience.`\n  }\n  if (!minVersion[browserName as keyof typeof minVersion]) {\n    window.notify('Navigateur inconnu', {\n      browserName,\n      browserVersion,\n      browser,\n      cpu,\n      os,\n      device,\n      ua,\n    })\n  }\n  const url = new URL(window.location.href)\n  if (url.hostname === 'localhost' && url.searchParams.get('log') === '2') {\n    popupMessage = Object.entries({\n      browserName,\n      browserVersion,\n      browser,\n      cpu,\n      os,\n      device,\n      ua,\n    })\n      .map(([key, value]) => `${key}: ${value}`)\n      .join('<br>')\n  }\n  return { popupMessage, browserName, browserVersion }\n}\n","let localVersion: string = ''\n\nfetchServerVersion()\n  .then((version) => {\n    localVersion = version\n  })\n  .catch((error) => {\n    console.error('Error fetching local version:', error)\n  })\n\n// Fonction pour rcuprer la version du serveur\nexport async function fetchServerVersion(): Promise<string> {\n  // const path = window.location.href.startsWith('http://localhost') ? '' : '/alea'\n  // const response = await fetch(path + '/version.txt')\n  const path = import.meta.env.DEV ? '' : '/alea'\n  const response = await fetch(`${path}/version.txt`)\n  if (!response.ok) {\n    throw new Error('Failed to fetch server version')\n  }\n\n  const data = await response.json()\n  return data.version\n}\n\nexport function getLocalVersion(): string {\n  return localVersion\n}\n\n/**  ne pas utiliser: pour les tests... */\nexport function forceLocalVersion(): void {\n  localVersion = localVersion + '1'\n}\n\n// Fonction pour vrifier si le serveur a t mis  jour\nexport async function checkForServerUpdate(): Promise<boolean> {\n  try {\n    const serverVersion = await fetchServerVersion()\n    // console.log('Server updated from', localVersion, 'to', serverVersion)\n    if (serverVersion !== localVersion) {\n      return true // Le serveur a t mis  jour\n    }\n    return false // Le serveur n'a pas t mis  jour\n  } catch (error) {\n    console.error('Error checking for server update:', error)\n    return false\n  }\n}\n","import type { MathfieldElement } from 'mathlive'\nimport type { BlockForKeyboard } from '../../../components/keyboard/types/keyboardContent'\n\nconst KEYBOARD_CATEGORIES = [\n  'aire',\n  'alphanumericAvecEspace',\n  'alphanumeric',\n  'angles',\n  'clavierHms',\n  'clavierDeBase',\n  'clavierCompare',\n  'clavierCompareAvecNombres',\n  'clavierDeBaseAvecX',\n  'clavierDeBaseAvecFraction',\n  'clavierDeBaseAvecFractionPuissanceCrochets',\n  'clavierDeBaseAvecEgal',\n  'clavierDeBaseAvecVariable',\n  'clavierEnsemble',\n  'clavierEnsemblePredefini',\n  'clavierFullOperations',\n  'clavierNumbers',\n  'clavierProbabilite',\n  'clavierSuite',\n  'college6eme',\n  'complexes',\n  'geolocalisation',\n  'grecTrigo',\n  'longueur',\n  'lycee',\n  'masse',\n  'clavierFonctionsTerminales',\n  'nombresEtDegre',\n  'nombresEtDegreCelsius',\n  'numbersSpace',\n  'numeration',\n  'vFON',\n  'volume',\n] as const\n\nexport type KeyboardCategory = (typeof KEYBOARD_CATEGORIES)[number] // on cre le type  partir du tableau de strings comme un union type de toutes les strings\n\n/**\n * Dtermine si un type de clavier pass en paramtre est bien connu\n * @param category type de clavier  vrifier\n * @returns `true` si le type de clavier est dans la liste\n */\nexport const isKeyboardCategory = (\n  category: unknown,\n): category is KeyboardCategory =>\n  category !== null &&\n  typeof category === 'string' &&\n  KEYBOARD_CATEGORIES.includes(category as KeyboardCategory)\n\ntype KbType = Record<KeyboardCategory, string>\nexport type PartialKbType = Partial<KbType>\nexport const KeyboardType: PartialKbType = KEYBOARD_CATEGORIES.reduce(\n  (obj, key) => {\n    return { ...obj, [key]: key }\n  },\n  {},\n)\n\nexport const convertToKeyboardCategory = (\n  str: string,\n): KeyboardCategory | undefined => {\n  const type = isKeyboardCategory(str) ? str : undefined\n  return type\n}\n\nexport const convertKeyboardTypeToBlocks = (\n  type: KeyboardCategory,\n): BlockForKeyboard[] => {\n  switch (type) {\n    case KeyboardType.clavierDeBase:\n      return ['numbersOperations']\n    case KeyboardType.vFON:\n      return ['numbersOperations', 'vFON']\n    case KeyboardType.clavierDeBaseAvecX:\n      return ['numbersOperationsX']\n    case KeyboardType.grecTrigo:\n      return ['numbers', 'fullOperations', 'greek', 'trigo']\n    case KeyboardType.clavierHms:\n      return ['numbers', 'hms']\n    case KeyboardType.clavierCompare:\n      return ['compare']\n    case KeyboardType.clavierCompareAvecNombres:\n      return ['numbers', 'compare', 'basicOperations']\n    case KeyboardType.clavierFonctionsTerminales:\n      return ['clavierFonctionsTerminales']\n    case KeyboardType.lycee:\n      return ['numbers', 'fullOperations', 'variables', 'advanced']\n    case KeyboardType.college6eme:\n      return ['numbersOperations']\n    case KeyboardType.clavierDeBaseAvecFraction:\n      return ['numbers', 'basicOperations']\n    case KeyboardType.clavierDeBaseAvecFractionPuissanceCrochets:\n      return ['numbers', 'basicOperationsPlus']\n    case KeyboardType.clavierDeBaseAvecEgal:\n      return ['numbers2', 'basicOperations']\n    case KeyboardType.clavierDeBaseAvecVariable:\n      return ['numbers', 'basicOperations', 'variables']\n    case KeyboardType.clavierEnsemble:\n      return ['numbersX', 'ensemble', 'ensembleDefini']\n    case KeyboardType.clavierEnsemblePredefini:\n      return ['ensembleDefini']\n    case KeyboardType.clavierSuite:\n      return ['numbers', 'fullOperations', 'suite']\n    case KeyboardType.clavierNumbers:\n      return ['numbers']\n    case KeyboardType.complexes:\n      return ['complexes']\n    case KeyboardType.numbersSpace:\n      return ['numbersSpace']\n    case KeyboardType.clavierFullOperations:\n      return ['numbers', 'fullOperations']\n    case KeyboardType.clavierProbabilite:\n      return [\n        'numbers',\n        'probabilite',\n        'uppercaseXToZ',\n        'uppercaseQToW',\n        'uppercaseIToP',\n        'uppercaseAToH',\n      ]\n    case KeyboardType.alphanumeric:\n      return ['alphanumeric']\n    case KeyboardType.alphanumericAvecEspace:\n      return ['alphanumeric']\n    case KeyboardType.longueur:\n      return ['numbers', 'lengths']\n    case KeyboardType.numeration:\n      return ['numbers', 'numeration']\n    case KeyboardType.aire:\n      return ['numbers', 'areas']\n    case KeyboardType.volume:\n      return ['numbers', 'volumes', 'capacities']\n    case KeyboardType.masse:\n      return ['numbers', 'masses']\n    case KeyboardType.angles:\n      return [\n        'angles',\n        'uppercaseXToZ',\n        'uppercaseQToW',\n        'uppercaseIToP',\n        'uppercaseAToH',\n      ]\n    case KeyboardType.nombresEtDegre:\n      return ['numbers', 'degre']\n    case KeyboardType.geolocalisation:\n      return ['numbers', 'estOuestSudNord']\n    case KeyboardType.nombresEtDegreCelsius:\n      return ['numbers', 'degreCelsius']\n\n    default:\n      throw new Error(\n        \"This error shouldn't occur. Clavier type: '\" + type + \"'\",\n      )\n  }\n}\n\nexport const buildDataKeyboardFromStyle = (\n  style: string,\n): BlockForKeyboard[] => {\n  // traitement\n  if (style === '') {\n    // clavier basique\n    return ['numbers', 'fullOperations', 'variables']\n  }\n  const blocks: BlockForKeyboard[] = []\n  const styleValues = style?.split(' ')\n  for (const value of styleValues) {\n    if (isKeyboardCategory(value)) {\n      blocks.push(...convertKeyboardTypeToBlocks(value))\n    } else {\n      // peut-tre des units... du style unites[longueurs,aires]\n      if (value.startsWith('unit') || value.startsWith('Unit')) {\n        // extraire les informations entre les [...] pour avoir les units\n        const unitValuesMatches = value.match(/\\[(.*?)\\]/g)\n        const unitValues =\n          unitValuesMatches\n            ?.map((e) => e.slice(1, -1))\n            .join(',')\n            .split(',')\n            .map((s) => s.toLowerCase().replace(/[s]$/, '')) || [] // tout en minuscule et virer les 's'  la fin\n        for (const v of unitValues) {\n          if (isKeyboardCategory(v)) {\n            blocks.push(...convertKeyboardTypeToBlocks(v))\n          }\n        }\n      }\n    }\n  }\n  if (blocks.length !== 0) {\n    const blks = blocks.filter((element, index, array) => {\n      return array.indexOf(element) === index\n    })\n    return blks\n  }\n  return ['numbers', 'fullOperations', 'variables']\n}\n\ntype Shortcut = {\n  mode: 'math' | 'text'\n  value: string\n}\n\ntype ShortcutsByKeyboards = {\n  [keyboard: string]: {\n    [key: string]: Shortcut | string\n  }\n}\n\nexport function getKeyboardShortcusts(mf: MathfieldElement): void {\n  let keyboardShortcuts = { ...shortcutsByKeyboards.default }\n  const keyboards = mf.dataset?.keyboard?.split(' ')\n  if (keyboards == null) return\n  for (const keyboard of keyboards) {\n    if (keyboard in shortcutsByKeyboards) {\n      keyboardShortcuts = {\n        ...keyboardShortcuts,\n        ...shortcutsByKeyboards[keyboard],\n      }\n    }\n    if (\n      ['lengths', 'volumes', 'capacities', 'masses', 'areas'].includes(\n        keyboard as KeyboardCategory,\n      )\n    ) {\n      keyboardShortcuts = {\n        ...keyboardShortcuts,\n        ...shortcutsByKeyboards.unit,\n      }\n    }\n  }\n  mf.inlineShortcuts = keyboardShortcuts\n}\n\nconst shortcutsByKeyboards = {\n  default: {\n    // D: { mode: 'math', value: 'd' }, // On avait un problme avec la notation D et mathLive\n    '*': { mode: 'math', value: '\\\\times' },\n    '.': { mode: 'math', value: '{,}' },\n    ',': { mode: 'math', value: '{,}' },\n    '%': { mode: 'math', value: '\\\\%' },\n    '': { mode: 'math', value: '^2' },\n    '': { mode: 'math', value: '^3' },\n    '**': { mode: 'math', value: '^{#1}' },\n    pi: { mode: 'math', value: '\\\\pi' },\n    ang: { mode: 'math', value: '\\\\widehat{#@}' },\n    rac: { mode: 'math', value: '\\\\sqrt{#@}' },\n    frac: { mode: 'math', value: '\\\\frac{#@}{#1}' },\n    '/': { mode: 'math', value: '\\\\frac{#@}{#1}' },\n    '<': '<',\n    '>': '>',\n    '>=': '\\\\geq',\n    '<=': '\\\\leq',\n    '(': '\\\\lparen',\n    ')': '\\\\rparen',\n\n    alpha: { mode: 'math', value: '\\\\alpha' },\n    beta: { mode: 'math', value: '\\\\beta' },\n    gamma: { mode: 'math', value: '\\\\gamma' },\n    delta: { mode: 'math', value: '\\\\delta' },\n    epsilon: { mode: 'math', value: '\\\\epsilon' },\n    theta: { mode: 'math', value: '\\\\theta' },\n    omega: { mode: 'math', value: '\\\\omega' },\n    lambda: { mode: 'math', value: '\\\\lambda' },\n    cos: { mode: 'math', value: '\\\\cos(#0)' },\n    sin: { mode: 'math', value: '\\\\sin(#0)' },\n    tan: { mode: 'math', value: '\\\\tan(#0)' },\n    '{': { mode: 'math', value: '\\\\{#0\\\\}' },\n    '[': { mode: 'math', value: '$[$' },\n    singleton: { mode: 'math', value: '\\\\{#0\\\\}' },\n    inf: { mode: 'math', value: '\\\\infty' },\n    union: { mode: 'math', value: '\\\\cup' },\n    inter: { mode: 'math', value: '\\\\cap' },\n    sauf: { mode: 'math', value: '\\\\backslash\\\\{#0\\\\}' },\n    integ: { mode: 'math', value: '\\\\int_#0^#1' },\n    lim: { mode: 'math', value: '\\\\lim_{#0\\\\to\\\\ #1}}' },\n    som: { mode: 'math', value: '\\\\sum_#0^#1' },\n    Un: { mode: 'math', value: 'U_n' },\n    ln: { mode: 'math', value: '\\\\ln(#0)' },\n    exp: { mode: 'math', value: 'e^#0' }, //\n    parmi: { mode: 'math', value: '\\\\tbinom{#0}{#1}' },\n    pasachantb: { mode: 'math', value: 'P_{#0}({#1})' },\n    barre: { mode: 'math', value: '\\\\overline{#@}' },\n    vec: { mode: 'math', value: '\\\\overrightarrow{#@}' },\n    pow: { mode: 'math', value: '#@^{#1}' },\n    gdC: { mode: 'math', value: '\\\\mathbb{C}' },\n    gdR: { mode: 'math', value: '\\\\mathbb{R}' },\n    gdQ: { mode: 'math', value: '\\\\mathbb{Q}' },\n    gdZ: { mode: 'math', value: '\\\\mathbb{Z}' },\n    gdN: { mode: 'math', value: '\\\\mathbb{N}' },\n  },\n\n  hms: {\n    D: { mode: 'math', value: 'd' },\n    sem: { mode: 'text', value: '{\\\\:\\\\text{semaines}\\\\:}' },\n    j: { mode: 'text', value: '{\\\\:\\\\text{j}\\\\:}' },\n    h: { mode: 'text', value: '{\\\\:\\\\text{h}\\\\:}' },\n    H: { mode: 'text', value: '{\\\\:\\\\text{h}\\\\:}' },\n    min: { mode: 'text', value: '{\\\\:\\\\text{min}\\\\:}' },\n    MIN: { mode: 'text', value: '{\\\\:\\\\text{min}\\\\:}' },\n    s: { mode: 'text', value: '{\\\\:\\\\text{s}\\\\:}' },\n    S: { mode: 'text', value: '{\\\\:\\\\text{s}\\\\:}' },\n    '*': { mode: 'math', value: '\\\\times' },\n    '.': { mode: 'math', value: ',' },\n  },\n\n  complexes: {\n    i: { mode: 'text', value: '{\\\\text{i}}' },\n  },\n\n  unit: {\n    mg: { mode: 'math', value: '\\\\operatorname{mg}' },\n    cg: { mode: 'math', value: '\\\\operatorname{cg}' },\n    dg: { mode: 'math', value: '\\\\operatorname{dg}' },\n    g: { mode: 'math', value: '\\\\operatorname{g}' },\n    dag: { mode: 'math', value: '\\\\operatorname{dag}' },\n    hg: { mode: 'math', value: '\\\\operatorname{hg}' },\n    kg: { mode: 'math', value: '\\\\operatorname{kg}' },\n    mL: { mode: 'math', value: '\\\\operatorname{mL}' },\n    cL: { mode: 'math', value: '\\\\operatorname{cL}' },\n    dL: { mode: 'math', value: '\\\\operatorname{dL}' },\n    L: { mode: 'math', value: '\\\\operatorname{L}' },\n    daL: { mode: 'math', value: '\\\\operatorname{daL}' },\n    hL: { mode: 'math', value: '\\\\operatorname{hL}' },\n    mm: { mode: 'math', value: '\\\\operatorname{mm}' },\n    cm: { mode: 'math', value: '\\\\operatorname{cm}' },\n    dm: { mode: 'math', value: '\\\\operatorname{dm}' },\n    m: { mode: 'math', value: '\\\\operatorname{m}' },\n    dam: { mode: 'math', value: '\\\\operatorname{dam}' },\n    hm: { mode: 'math', value: '\\\\operatorname{hm}' },\n    km: { mode: 'math', value: '\\\\operatorname{km}' },\n    mm2: { mode: 'math', value: '\\\\operatorname{mm}^2' },\n    cm2: { mode: 'math', value: '\\\\operatorname{cm}^2' },\n    dm2: { mode: 'math', value: '\\\\operatorname{dm}^2' },\n    m2: { mode: 'math', value: '\\\\operatorname{m}^2' },\n    dam2: { mode: 'math', value: '\\\\operatorname{dam}^2' },\n    hm2: { mode: 'math', value: '\\\\operatorname{hm}^2' },\n    km2: { mode: 'math', value: '\\\\operatorname{km}^2' },\n    mm3: { mode: 'math', value: '\\\\operatorname{mm}^3' },\n    cm3: { mode: 'math', value: '\\\\operatorname{cm}^3' },\n    dm3: { mode: 'math', value: '\\\\operatorname{dm}^3' },\n    m3: { mode: 'math', value: '\\\\operatorname{m}^3' },\n    dam3: { mode: 'math', value: '\\\\operatorname{dam}^3' },\n    hm3: { mode: 'math', value: '\\\\operatorname{hm}^3' },\n    km3: { mode: 'math', value: '\\\\operatorname{km}^3' },\n    a: { mode: 'math', value: '\\\\operatorname{a}' },\n    ha: { mode: 'math', value: '\\\\operatorname{ha}' },\n    '*': { mode: 'math', value: '\\\\times' },\n    '.': { mode: 'math', value: ',' },\n  },\n\n  numbersOperations: {\n    '/': { mode: 'math', value: '\\\\div' },\n  },\n\n  numbersSpace: {\n    ' ': '\\\\,',\n  },\n} as ShortcutsByKeyboards\n","// valeurs par dfaut\nexport const context = {\n  isInEditor: false,\n  isHtml: true,\n  isAmc: false,\n  isAlc: false,\n  isMoodle: false,\n  issortieNB: false,\n  isDiaporama: false,\n  anglePerspective: 30,\n  coeffPerspective: 0.5,\n  pixelsParCm: 20,\n  scale: 1,\n  unitesLutinParCm: 50,\n  isMainlevee: false,\n  amplitude: 1,\n  fenetreMathalea2d: [-1, -10, 29, 10],\n  objets2D: [],\n  graine: '',\n  // duree: 10,\n  nbBonnesReponses: 0,\n  nbMauvaisesReponses: 0,\n  zoom: 1,\n  seedSpecial: false, // Change le numro de srie si une correction est cache\n  son: 0, // pour ajouter du son au changement de diapo dans le diaporama\n  vue: '', // context.vue = 'diaporama' est utilis pour modifier l'affichage d'un exercice en mode diaporama\n  questionCanEnCours: 0,\n  timer: '',\n}\n\nexport function setOutputHtml() {\n  context.isHtml = true\n  context.isAmc = false\n}\n\nexport function setOutputMoodle() {\n  context.isHtml = true\n  context.isAmc = false\n  context.isMoodle = true\n}\n\nexport function setOutputLatex() {\n  context.isHtml = false\n  context.isAmc = false\n}\n\nexport function setOutputAmc() {\n  context.isHtml = false\n  context.isAmc = true\n}\n\nexport function setOutputAlc() {\n  context.isHtml = false\n  context.isAmc = false\n  context.isAlc = true\n}\n","import { context } from '../../modules/context'\n\n/**\n * Renvoie le html ou le latex qui met les 2 chaines de caractres fournies sur 2 colonnes diffrentes\n * @author Rmi Angot\n * @param {string} cont1 - Contenu de la premire colonne\n * @param {string} cont2 - Contenu de la deuxime colonne\n * @param {number} [largeur1=50] Largeur de la premire colonne\n * @return {string}\n */\nexport function deuxColonnes(cont1, cont2, largeur1 = 50) {\n  if (context.isHtml) {\n    return `\n    <div>\n    <div class=\"question\" style=\"float:left;max-width: ${largeur1}%;margin-right: 30px\">\n    ${cont1}\n   </div>\n   <div style=\"float:left; max-width: ${90 - largeur1}%\">\n    ${cont2}\n   </div>\n   <div style=\"clear:both\"></div>\n   <div class=\"ui hidden divider\"></div>\n   </div>\n`\n  } else {\n    return `\\\\begin{multicols}{2}\n    ${cont1.replaceAll('<br>', '\\\\\\\\\\n')}\n\n    ${cont2.replaceAll('<br>', '\\\\\\\\\\n')}\n    \\\\end{multicols}\n`\n  }\n}\n\n/**\n * Renvoie le html ou le latex qui met les 2 chaines de caractres fournies sur 2 colonnes diffrentes\n * @author Nathan Scheinmann\n * @param {string} cont1 - Contenu de la premire colonne\n * @param {string} cont2 - Contenu de la deuxime colonne\n * @param {string} cont3 - Contenu de la deuxime colonne\n * @param {number} [largeur1=33] Largeur de la premire colonne\n * @param {number} [largeur2=33] Largeur de la premire colonne\n * @return {string}\n */\nexport function troisColonnes(\n  cont1,\n  cont2,\n  cont3,\n  largeur1 = 33,\n  largeur2 = 33,\n) {\n  if (context.isHtml) {\n    return `\n    <div>\n      <div class=\"question\" style=\"float:left;max-width: ${largeur1}%;margin-right: 10px;\">\n        ${cont1}\n      </div>\n      <div style=\"float:left; max-width: ${largeur2}%;margin-right: 10px;\">\n        ${cont2}\n      </div>\n      <div style=\"float:left; max-width: ${100 - largeur1 - largeur2}%;margin-right: 10px;\">\n        ${cont3}\n      </div>\n      <div style=\"clear:both\"></div>\n      <div class=\"ui hidden divider\"></div>\n    </div>\n    `\n  } else {\n    return `\\\\begin{multicols}{3}\n    ${cont1.replaceAll('<br>', '\\\\\\\\\\n')}\n\n    ${cont2.replaceAll('<br>', '\\\\\\\\\\n')}\n\n    ${cont3.replaceAll('<br>', '\\\\\\\\\\n')}\n    \\\\end{multicols}\n    `\n  }\n}\n/**\n * Renvoie le html ou le latex qui met les 2 chaines de caractres fournies sur 2 colonnes diffrentes\n * Si en sortie html, il n'y a pas assez de places alors on passe en momocolonne !\n * @author Mickael Guironnet\n * @param {string} cont1 - Contenu de la premire colonne\n * @param {string} cont2 - Contenu de la deuxime colonne\n * @param {{eleId?: string, largeur1: number, widthmincol1: string, widthmincol2: string, stylecol1?: string, stylecol2?: string}} options\n *          eleId : identifiant ID pour retrouver la colonne\n *          largeur1 : largeur de la premire colonne en latex en pourcentage\n *          widthmincol1 : largeur de la premire minimum en html en px\n *          widthmincol2 : largeur de la deuxime minimum en html en px\n *  ex : deuxColonnesResp (enonce, correction, {eleId : '1_1', largeur1:50, widthmincol1: '400px', widthmincol2: '200px'})\n * @return {string}\n */\nexport function deuxColonnesResp(cont1, cont2, options) {\n  if (options === undefined) {\n    options = { largeur1: 50 }\n  } else if (typeof options === 'number') {\n    options = { largeur1: options }\n  }\n  if (options.largeur1 === undefined) {\n    options.largeur1 = 50\n  }\n  if (options.stylecol1 === undefined) {\n    options.stylecol1 = ''\n  }\n  if (options.stylecol2 === undefined) {\n    options.stylecol2 = ''\n  }\n  if (options.widthmincol1 === undefined) {\n    options.widthmincol1 = '0px'\n  }\n  if (options.widthmincol2 === undefined) {\n    options.widthmincol2 = '0px'\n  }\n\n  if (context.isHtml) {\n    return `\n    <style>\n    .cols-responsive {\n      max-width: 1200px;\n      margin: 0 auto;\n      display: grid;\n      grid-gap: 1rem;\n    }\n    /* Screen larger than 900px? 2 column */\n    @media (min-width: 900px) {\n      .cols-responsive { grid-template-columns: repeat(2, 1fr); }\n    }\n    </style>\n    <div class='cols-responsive'>\n      <div id='cols-responsive1-${options.eleId}'style='min-width:${options.widthmincol1};${options.stylecol1}' >\n      ${cont1}\n      </div>\n      <div id='cols-responsive2-${options.eleId}' style='min-width:${options.widthmincol2};${options.stylecol2}' >\n      ${cont2}\n      </div>\n    </div>\n`\n  } else {\n    return `\\\\begin{minipage}{${options.largeur1 / 100}\\\\linewidth}\n    ${cont1.replaceAll('<br>', '\\\\\\\\\\n')}\n    \\\\end{minipage}\n    \\\\begin{minipage}{${(100 - options.largeur1) / 100}\\\\linewidth}\n    ${cont2.replaceAll('<br>', '\\\\\\\\\\n')}\n    \\\\end{minipage}\n    `\n  }\n}\n\n/**\n *\n * @param {string} texte\n * @returns le texte centr dans la page selon le contexte.\n * @author Jean-Claude Lhote\n */\nexport function centrage(texte) {\n  return context.isHtml\n    ? `<center>${texte}</center>`\n    : `\\\\begin{center}\\n \\t${texte}\\n \\\\end{center}\\n`\n}\n\n/**\n * Renvoie un environnent LaTeX multicolonnes\n * @author Rmi Angot\n */\nexport function texMulticols(texte, nbCols = 2) {\n  let result\n  if (nbCols > 1) {\n    result =\n      '\\\\begin{multicols}{' + nbCols + '}\\n' + texte + '\\n\\\\end{multicols}'\n  } else {\n    result = texte\n  }\n  return result\n}\n\n/**\n * Centre un texte\n *\n * @author Rmi Angot\n */\nexport function texteCentre(texte) {\n  if (context.isHtml) {\n    return `<p style=\"text-align: center\">${texte}</p>`\n  } else {\n    return `\\\\begin{center}\n${texte}\n\\\\end{center}`\n  }\n}\n","import { round } from 'mathjs'\nimport {\n  combinaisonListes,\n  combinaisonListesSansChangerOrdre,\n  compteOccurences,\n  enleveDoublonNum,\n} from '../lib/outils/arrayOutils'\nimport { texMulticols } from '../lib/format/miseEnPage'\nimport { arrondi, rangeMinMax } from '../lib/outils/nombres'\nimport { context } from './context'\nimport Decimal from 'decimal.js'\nimport FractionEtendue from './FractionEtendue'\nimport type Exercice from '../exercices/Exercice'\n\nexport const tropDeChiffres = 'Trop de chiffres'\nexport const epsilon = 0.000001\n\n/**\n * Affecte les proprits contenues et contenuCorrection (d'aprs les autres proprits de l'exercice)\n * @param {Exercice} exercice\n */\nexport function listeQuestionsToContenu(exercice: Exercice) {\n  let vspace = ''\n  if (exercice.vspace) {\n    vspace = `\\\\vspace{${exercice.vspace} cm}\\n`\n  }\n  if (!context.isAmc) {\n    exercice.contenu =\n      texConsigne(exercice.consigne) +\n      vspace +\n      texIntroduction(exercice.introduction) +\n      texMulticols(\n        texEnumerate(exercice.listeQuestions, exercice.spacing),\n        exercice.nbCols,\n      )\n  }\n  exercice.contenuCorrection =\n    texConsigne('') +\n    texIntroduction(exercice.consigneCorrection) +\n    texMulticols(\n      texEnumerate(exercice.listeCorrections, exercice.spacingCorr),\n      exercice.nbColsCorr,\n    )\n  exercice.contenuCorrection = exercice.contenuCorrection.replace(\n    /\\\\\\\\\\n*/g,\n    '\\\\\\\\\\n',\n  )\n  // console.log(exercice.contenu) // Pour rcuprer le code latex des exos pour les cahiers de vacances\n  exercice.contenu = exercice.contenu?.replace(/\\\\\\\\\\n*/g, '\\\\\\\\\\n')\n}\n\n/**\n * Utilise liste_questions et liste_corrections pour remplir contenu et contenuCorrection\n * La liste des questions devient une liste HTML ou LaTeX avec html_ligne() ou tex_paragraphe()\n * @param {Exercice} exercice\n * @param {boolean} retourCharriot\n * @author Rmi Angot\n */\nexport function listeQuestionsToContenuSansNumero(\n  exercice: Exercice,\n  retourCharriot = true,\n) {\n  const supprimerReferenceCheckbox = document.getElementById(\n    'supprimer_reference',\n  )\n  if (\n    supprimerReferenceCheckbox &&\n    supprimerReferenceCheckbox instanceof HTMLInputElement &&\n    supprimerReferenceCheckbox.checked === true\n  ) {\n    exercice.contenu =\n      texConsigne(exercice.consigne) +\n      texIntroduction(exercice.introduction) +\n      texMulticols(\n        texParagraphe(\n          exercice.listeQuestions,\n          exercice.spacing,\n          retourCharriot,\n        ),\n        exercice.nbCols,\n      )\n  } else {\n    exercice.contenu =\n      texConsigne(exercice.consigne) +\n      `\\n\\\\marginpar{\\\\footnotesize ${exercice.id}}` +\n      texIntroduction(exercice.introduction) +\n      texMulticols(\n        texParagraphe(\n          exercice.listeQuestions,\n          exercice.spacing,\n          retourCharriot,\n        ),\n        exercice.nbCols,\n      )\n  }\n  // exercice.contenuCorrection = texConsigne(exercice.consigneCorrection) + texMulticols(texEnumerateSansNumero(exercice.listeCorrections,exercice.spacingCorr),exercice.nbColsCorr)\n  exercice.contenuCorrection =\n    texConsigne(exercice.consigneCorrection) +\n    texMulticols(\n      texParagraphe(\n        exercice.listeCorrections,\n        exercice.spacingCorr,\n        retourCharriot,\n      ),\n      exercice.nbColsCorr,\n    )\n}\n\n/**\n * Contraint une valeur  rester dans un intervalle donn. Si elle est trop petite, elle prend la valeur min, si elle est trop grande elle prend la valeur max\n * @author Jean-Claude Lhote  partir du code d'Eric Elter\n * @param {number|string} min borne infrieure\n * @param {number|string} max borne suprieure\n * @param {number|string} valeur la valeur  contraindre\n * @param {number|string} defaut valeur par dfaut si non entier\n */\nexport function contraindreValeur(\n  min: number,\n  max: number,\n  valeur: string | number,\n  defaut: number,\n) {\n  // if (isNaN(min) || isNaN(max) || (defaut !== undefined && isNaN(defaut))) { // Rajout de Remi\n  if (isNaN(min) || isNaN(max) || isNaN(defaut)) {\n    throw Error(\n      `Erreur dans contraindreValeur : un des paramtres de contrainte est NaN : ${[\n        'min : ' + String(min) + ' ',\n        max,\n        valeur,\n        defaut,\n      ].reduce(\n        (accu, value, index) =>\n          String(accu) +\n          ['min', ',max', ',valeur', ',defaut'][index] +\n          ' : ' +\n          String(value) +\n          ' ',\n      )}`,\n    )\n  }\n  return !isNaN(Number(valeur))\n    ? Number(valeur) < Number(min)\n      ? Number(min)\n      : Number(valeur) > Number(max)\n        ? Number(max)\n        : Number(valeur)\n    : Number(defaut)\n}\n\ntype GestionnaireFormulaireTexteParams = {\n  saisie: string | number\n  min?: number\n  max: number\n  defaut: number\n  listeOfCase?: string[] | number[]\n  shuffle?: boolean\n  nbQuestions: number\n  melange: number\n  enleveDoublons?: boolean\n  exclus?: number[]\n}\n\n/**\n * @param {Object} params - Les paramtres de la fonction\n * @param {string|number} params.saisie - Ce qui vient du formulaireTexte donc une srie de nombres spars par des tirets ou un seul nombre (normalement en string) ou rien\n * @param {number?} [params.min=1]\n * @param {number} params.max - Obligatoirement >min\n * @param {number} params.defaut - Obligatoirement compris entre min et max inclus ou alors gal  melange\n * @param {string[] | number[]} [params.listeOfCase] - La liste des valeurs  mettre dans la liste en sortie. Si aucune liste n'est fournie, ce sont les nombres qui seront dans la liste. La premire valeur de listeOfCase correspond  la saisie numrique min et listeOfCase doit contenir max-min+1 valeurs\n * @param {boolean} [params.shuffle=true] - Si true, on brasse la liste en sortie sinon on garde l'ordre\n * @param {number} params.nbQuestions - Obligatoire : c'est la taille de la liste en sortie. Si 0, alors le nbQuestions correspond  la longueur de saisie.\n * @param {number} params.melange - La valeur utilise pour l'option mlange\n * @param {boolean} [params.enleveDoublons=false] - Si true, la liste en sortie ne peut pas contenir deux fois la mme valeur\n * @param {number[]} [params.exclus] - Liste de valeurs  exclure entre min et max\n */\nexport function gestionnaireFormulaireTexte(\n  params: GestionnaireFormulaireTexteParams,\n) {\n  let {\n    saisie,\n    min = 1,\n    max,\n    defaut,\n    listeOfCase,\n    shuffle = true,\n    nbQuestions,\n    melange = 0,\n    enleveDoublons = false,\n    exclus,\n  } = params\n  if (exclus) {\n    exclus = exclus.filter((element) => element >= min && element <= max)\n  }\n  if (max == null || isNaN(max) || max < min)\n    throw Error(\n      'La fonction gestionnaireFormulaireTexte rclame un paramtre max de type number',\n    )\n  if (\n    defaut == null ||\n    isNaN(defaut) ||\n    defaut < min ||\n    (defaut > max && defaut !== melange)\n  )\n    throw Error(\n      `La fonction gestionnaireFormulaireTexte rclame un paramtre defaut (ici, ${defaut}) compris entre min (ici, ${min}) et max (ici, ${max})`,\n    )\n  let listeIndex, listeIndexProvisoire\n  listeIndex = []\n  if (\n    typeof saisie === 'boolean' ||\n    saisie === '' ||\n    saisie === null ||\n    saisie === undefined\n  ) {\n    // Si aucune liste n'est saisie\n    listeIndex = [defaut]\n  } else {\n    if (typeof saisie === 'number' || Number.isInteger(saisie)) {\n      // Si c'est un nombre, c'est que le nombre a t saisi dans la barre d'adresses\n      listeIndex = [\n        contraindreValeur(\n          Math.min(min, melange ?? min),\n          Math.max(max, melange ?? max),\n          saisie,\n          defaut,\n        ),\n      ]\n    } else {\n      listeIndexProvisoire = saisie.split('-') // Sinon on cre un tableau  partir des valeurs spares par des tirets\n      for (let i = 0; i < listeIndexProvisoire.length; i++) {\n        // on a un tableau avec des strings : ['1', '1', '2']\n        if (!isNaN(parseInt(listeIndexProvisoire[i]))) {\n          listeIndex.push(\n            contraindreValeur(\n              Math.min(min, melange ?? min),\n              Math.max(max, melange ?? max),\n              parseInt(listeIndexProvisoire[i]),\n              defaut,\n            ),\n          )\n        } // parseInt en fait un tableau d'entiers\n      }\n    }\n  }\n  if (listeIndex.length === 0) listeIndex = [defaut] // EE : Le cas o finalement listeIndex est vide car la saisie n'tait pas un paramtre attendu.\n\n  if (exclus && exclus.length > 0) {\n    listeIndex = listeIndex.filter((element) => !exclus.includes(element))\n  }\n  if (listeIndex.length === 0) listeIndex = [defaut] // EE : Le cas o finalement listeIndex est vide car la saisie n'tait pas un paramtre attendu.\n\n  if (melange != null && compteOccurences(listeIndex, melange)) {\n    listeIndex = rangeMinMax(min, max, exclus)\n  }\n  if (nbQuestions === 0) {\n    nbQuestions = listeIndex.length\n  } else {\n    nbQuestions = Math.min(nbQuestions, 100) // Faut pas dconner, un jour quelqu'un a fait pter la fonction en demandant une liste de 10000 questions !\n  }\n  listeIndex = shuffle\n    ? combinaisonListes(listeIndex, nbQuestions)\n    : combinaisonListesSansChangerOrdre(listeIndex, nbQuestions)\n\n  const Max = Math.max(...listeIndex)\n  if (enleveDoublons) listeIndex = enleveDoublonNum(listeIndex)\n  if (Array.isArray(listeOfCase)) {\n    // si une listeOfCase est fournie, on retourne la liste des valeurs construites avec listeIndex\n    if (listeOfCase.length < Max)\n      throw Error(\n        'La liste de cas fournie ne contient pas assez de valeurs par rapport  max',\n      )\n    return listeIndex.map((el) => listeOfCase[el - min]).slice(0, nbQuestions)\n  }\n  return listeIndex.slice(0, nbQuestions)\n}\n\n/** Retourne un nombre dcimal entre a et b, sans tre trop prs de a et de b\n * @param {number} a borne infrieure\n * @param {number} b borne suprieure\n * @author Eric Elter\n * @returns {number}\n */\nexport function entreDeux(a: number, b: number) {\n  if (a < b) return arrondi(a + ((b - a) * randint(10, 90)) / 100, 2)\n  else return arrondi(b + ((a - b) * randint(10, 90)) / 100, 2)\n}\n\n/**\n * Compare deux nombres (pour les nombres en virgule flottante afin d'viter les effets de la conversion en virgule flottante).\n * Devient compatible avec les FractionEtendue le 7/05/2024 en comparant leur valeur dcimale\n * Pour les Decimal, la conversion automatique en number doit fonctionner.\n * @author Jean-Claude Lhote\n * @param {number} a premier nombre\n * @param {number} b deuxime nombre\n * @param {number} [tolerance=0.000001] seuil positif en dessous duquel une valeur est considre comme nulle\n * @return {boolean}\n */\nexport function egal(\n  a: number | FractionEtendue,\n  b: number | FractionEtendue,\n  tolerance = epsilon,\n) {\n  tolerance = tolerance === 0 ? 1e-10 : tolerance\n  if (a instanceof FractionEtendue) a = a.valeurDecimale\n  if (b instanceof FractionEtendue) b = b.valeurDecimale\n  return Math.abs(a - b) <= tolerance\n}\n\n/**\n * Retourne true si le nombre a est infrieur  b\n * @param {number} a premier nombre\n * @param {number} b deuxime nombre\n * @param {number} [tolerance=0.000001] seuil positif en dessous duquel une valeur est considre comme nulle\n * @return {boolean}\n */\nexport function inferieur(a: number, b: number, tolerance = epsilon) {\n  return b - a > tolerance\n}\n\n/**\n * Retourne true si le nombre a est suprieur ou gal  b\n * @param {number} a premier nombre\n * @param {number} b deuxime nombre\n * @param {number} [tolerance=0.000001] seuil positif en dessous duquel une valeur est considre comme nulle\n * @return {boolean}\n */\nexport function superieurouegal(a: number, b: number, tolerance = epsilon) {\n  return a - b > tolerance || egal(a, b, tolerance)\n}\n\n/**\n * Retourne true si le nombre a est infrieur ou gal  b\n * @param {number} a premier nombre\n * @param {number} b deuxime nombre\n * @param {number} [tolerance=0.000001] seuil positif en dessous duquel une valeur est considre comme nulle\n * @return {boolean}\n */\nexport function inferieurouegal(a: number, b: number, tolerance = epsilon) {\n  return b - a > tolerance || egal(a, b, tolerance)\n}\n\n/**\n * Retourne true si le nombre a est entier ou \"presque\" entier\n * @param {number} a premier nombre\n * @param {number} [tolerance=0.000001] seuil positif en dessous duquel une valeur est considre comme nulle\n * @return {boolean}\n */\nexport function estentier(a: number, tolerance = epsilon) {\n  if (typeof a !== 'number') window.notify('Erreur dans estEntier()', { a })\n  return Math.abs(a - round(a)) < tolerance\n}\n\n/**\n * Retourne le quotient entier (donc sans le reste) de a/b si a & b sont entiers, false sinon\n * @param {number} a\n * @param {number} b\n * @return {number}\n */\nexport function quotientier(a: number, b: number) {\n  if (estentier(a) && estentier(b)) return Math.floor(a / b)\n  return Math.floor(Math.round(a) / Math.round(b))\n}\n\n/**\n * Retourne true si x est un carr parfait ( epsilon prs)\n * @param {number} x\n * @return {boolean}\n */\nexport function carreParfait(x: number) {\n  return estentier(Math.sqrt(x))\n}\n\n// Fonctions mathmatiques\n\n/**\n * Choisit un nombre au hasard entre min et max sans appartenir  liste\\_a\\_eviter.\n * @param {number} min\n * @param {number} max\n * @param {number | Array<number>} [listeAEviter] - Tous les lments que l'on souhaite supprimer\n * @return {number} Nombre au hasard entre min et max non compris dans la listeAEviter\n *\n * @example\n * // Renvoie 1, 2 ou 3\n * randint (1,3)\n * @example\n * // Renvoie -1 ou 1\n * randint(-1,1,[0])\n * @example\n * Renvoie 0 ou 1 ou 4 ou 6 ou 8 ou 9\n * randint(0,9, '2357') // mme rsultat avec randint(0,9, ['2','3','5','7']) ou randint(0,9, [2,3,5,7])\n * @author Rmi Angot\n * @see https://gist.github.com/pc035860/6546661\n */\nexport function randint(\n  min: number | Decimal,\n  max: number | Decimal,\n  listeAEviter: (number | Decimal | string)[] | string | number = [],\n) {\n  // Source : https://gist.github.com/pc035860/6546661\n  if (min instanceof Decimal) min = min.toNumber()\n  if (max instanceof Decimal) max = max.toNumber()\n  if (!Number.isInteger(min) || !Number.isInteger(max)) {\n    window.notify('Les min et max de randint doivent tre entiers', {\n      min,\n      max,\n    })\n    min = Math.floor(min)\n    max = Math.ceil(max)\n    if (max - min < 1) max = min + 1\n  }\n  const range = max - min\n  let rand = Math.floor(Math.random() * (range + 1))\n  if (typeof listeAEviter === 'string') {\n    listeAEviter = listeAEviter.split('')\n  }\n  if (typeof listeAEviter === 'number') {\n    if (Number.isInteger(listeAEviter)) {\n      listeAEviter = [listeAEviter]\n    } else {\n      window.notify(\n        \"Le nombre fourni  randint en exclusion n'est pas un entier\",\n        { listeAEviter },\n      )\n      listeAEviter = [listeAEviter] // ce n'est pas grave de mettre un nombre non entier, randint ne choisit que des entiers\n    }\n  }\n  if (Array.isArray(listeAEviter)) {\n    listeAEviter = listeAEviter\n      .map(Number)\n      .filter((el) => Math.round(el) === el) // on filtre les non-nombres et les non-entiers\n  } else {\n    window.notify(\n      \"La liste d'exclusion de randint n'est pas d'un type pris en compte\",\n      { listeAEviter },\n    )\n    listeAEviter = []\n  }\n  if (listeAEviter.length > 0) {\n    let cpt = 0\n    while (listeAEviter.includes(min + rand) && cpt < 50) {\n      // On met une condition de fin car si toutes les valeurs sont dans la liste  viter, ce serait une boucle infinie\n      rand = Math.floor(Math.random() * (range + 1))\n      cpt++\n    }\n    if (cpt === 50) {\n      window.notify(\n        `Randint n'a pas pu trouver de valeur en dehors de la liste  viter, c'est donc cette valeur qui a t choisie : ${min + rand}`,\n        { min, max, listeAEviter, rand },\n      )\n    }\n  }\n  return min + rand\n}\n\n/**\n * fonction qui retourne une chaine construite en concatnant les arguments\n * Le rle de cette fonction est de construire un identifiant unique de question\n * afin de contrler que l'alatoire ne produit pas deux questions identiques.\n * @author Jean-Claude Lhote\n */\nexport function checkSum(...args: number[]) {\n  let checkString = ''\n  for (let i = 0; i < args.length; i++) {\n    if (typeof args[i] === 'number') {\n      checkString += Number(args[i]).toString()\n    } else {\n      checkString += args[0]\n    }\n  }\n  return checkString\n}\n\n/**\n * Polyfill Object.fromEntries\n *\n * @see : https://gitlab.com/moongoal/js-polyfill-object.fromentries/\n */\nif (!Object.fromEntries) {\n  Object.defineProperty(Object, 'fromEntries', {\n    value(entries: Iterable<[string, any]>) {\n      if (!entries || typeof (entries as any)[Symbol.iterator] !== 'function') {\n        throw new Error(\n          'Object.fromEntries() requires a single iterable argument',\n        )\n      }\n      const o: Record<string, any> = {}\n      for (const [k, v] of entries as Iterable<[string, any]>) {\n        o[k] = v\n      }\n      return o\n    },\n  })\n}\n\n/*\nconst sansPrecision = (arrondir === undefined)\n  // if (sansPrecision) arrondir = 6\n  if (typeof x === 'string') {\n    window.notify('Calcul : Reoit une chaine de caractre et pas un nombre', { x })\n    x = parseFloat(evaluate(x))\n  }\n  if (sansPrecision && !egal(x, arrondi(x, arrondir), 10 ** (-arrondir - 1))) {\n    window.notify('calcul : arrondir semble avoir tronqu des dcimales sans avoir eu de paramtre de prcision', {\n      x,\n      arrondir\n    })\n  }\n  return parseFloat(x.toFixed(arrondir))\n}\n*/\n\n// Fonctions LaTeX\n\n/**\n * * Retourne un environnement LaTeX enumerate  partir d'une liste.\n * * `<br>`est remplac par un saut de paragraphe\n * * `<br><br>` est remplac par un saut de paragraphe et un medskip\n * * L'espacement est gnr avec spacing\n * @author Rmi Angot\n */\nexport function texEnumerate(liste: string[], spacing: number) {\n  let result = ''\n  if (liste.length > 1) {\n    result = '\\\\begin{enumerate}\\n'\n    if (spacing > 1) {\n      result += `\\\\begin{spacing}{${spacing}}\\n`\n    }\n    for (const i in liste) {\n      result += '\\t\\\\item ' + liste[i] + '\\n'\n    }\n    if (spacing > 1) {\n      result += '\\\\end{spacing}\\n'\n    }\n    result += '\\\\end{enumerate}\\n'\n  } else {\n    if (spacing > 1) {\n      result += `\\\\begin{spacing}{${spacing}}\\n`\n    }\n    result += liste[0] + '\\n'\n    if (spacing > 1) {\n      result += '\\\\end{spacing}\\n'\n    }\n  }\n  return result\n    .replace(/(<br *\\/?>[\\n\\t ]*)+<br *\\/?>/gim, '\\n\\n\\\\medskip\\n')\n    .replace(/<br>/g, '\\\\\\\\\\n')\n    .replace(//g, '\\\\euro{}')\n}\n\n/**\n * * Retourne un environnement LaTeX enumerate  partir d'une liste sans afficher les numros.\n * * `<br>` est remplac par un saut de paragraphe\n * * `<br><br>` est remplac par un saut de paragraphe et un medskip\n * * L'espacement est gnr avec spacing\n * @author Rmi Angot\n */\nexport function texEnumerateSansNumero(liste: string[], spacing: number) {\n  // return texEnumerate(liste,spacing).replace('\\\\begin{enumerate}[label={}]','\\\\begin{enumerate}[label={}]')\n  return texEnumerate(liste, spacing).replace(\n    '\\\\begin{enumerate}',\n    '\\\\begin{enumerate}[label={}]',\n  )\n}\n\n/**\n * * Concatne les lments d'une liste avec un saut de ligne entre chaque lment\n * * `<br>` est remplac par un saut de paragraphe\n * * `<br><br>` est remplac par un saut de paragraphe et un medskip\n * @author Rmi Angot\n */\nexport function texParagraphe(\n  liste: string[],\n  spacing: number = 0,\n  retourCharriot: boolean,\n) {\n  let result = ''\n  if (spacing > 1) {\n    result = `\\\\begin{spacing}{${spacing}}\\n`\n  }\n\n  for (const i in liste) {\n    if (retourCharriot) {\n      result += `\\t${liste[i]}\\\\\\\\\\n`\n    } else {\n      result += `\\t${liste[i]}\\n`\n    }\n  }\n  if (spacing > 1) {\n    result += '\\\\end{spacing}'\n  }\n  // les <br> peuvent tre 2 ou plus et peuvent tre spars par des sauts de ligne ou des espaces\n  return result\n    .replace(/(<br *\\/?>[\\n\\t ]*)+<br *\\/?>/gim, '\\n\\n\\\\medskip\\n')\n    .replace(/<br>/g, '\\\\\\\\\\n')\n    .replace(//g, '\\\\euro{}')\n}\n\n/**\n * * Recopie le texte.\n * * `<br>` est remplac par un saut de paragraphe\n * * `<br><br>` est remplac par un saut de paragraphe et un medskip\n * @param {string} texte\n * @return {string}\n * @author Rmi Angot\n */\nexport function texIntroduction(texte: string) {\n  if (typeof texte === 'string' && texte !== '') {\n    return texte\n      .replace(/(<br *\\/?>[\\n\\t ]*)+<br *\\/?>/gim, '\\n\\n\\\\medskip\\n')\n      .replace(/<br>/g, '\\\\\\\\\\n')\n  } else {\n    return ''\n  }\n}\n\n/**\n * Renvoie une liste HTML ou LaTeX suivant le contexte\n *\n * @param liste une liste de questions\n * @param spacing interligne (line-height en css)\n * @author Rmi Angot\n */\nexport function enumerate(liste: string[], spacing: number) {\n  return texEnumerate(liste, spacing)\n}\n\n/**\n * Renvoie une liste sans puce ni numro HTML ou LaTeX suivant le contexte\n *\n * @param liste une liste de questions\n * @param spacing interligne (line-height en css)\n * @author Sbastien Lozano\n */\nexport function enumerateSansPuceSansNumero(liste: string[], spacing: number) {\n  return texEnumerate(liste, spacing).replace(\n    '\\\\begin{enumerate}',\n    '\\\\begin{enumerate}[label={}]',\n  )\n}\n\n/**\n * Renvoie \\exo{consigne}\n * @author Rmi Angot\n */\nexport function texConsigne(consigne: string) {\n  return (\n    (consigne != null && typeof consigne === 'string'\n      ? consigne.replace(/<br>/g, '\\\\\\\\')\n      : '') + '\\n\\n'\n  )\n}\n\n/**\n * @author Frdric Piou\n * @param {number} nb\n * @returns retourne un nombre au format franais sans espace aprs la virgule\n */\nexport function num(nb: number) {\n  if (typeof nb === 'number') {\n    return Intl.NumberFormat('fr-FR', { maximumFractionDigits: 20 })\n      .format(nb)\n      .toString()\n      .replace(/\\s+/g, '\\\\thickspace ')\n      .replace(',', '{,}')\n  } else {\n    window.notify(\"Fonction num() appele avec autre chose qu'un number\", {\n      nb,\n    })\n  }\n}\n\n/**\n * Affiche un lien vers une URL\n * @param {string} texte  afficher\n * @param {string} lien\n * @author Rmi Angot\n */\nexport function href(texte: string, lien: string) {\n  if (\n    typeof texte === 'string' &&\n    texte !== '' &&\n    typeof lien === 'string' &&\n    lien !== ''\n  ) {\n    if (context.isHtml) {\n      return `<a target=\"_blank\" href=${lien}> ${texte} </a>`\n    } else {\n      return `\\\\href{${lien}}{${texte}}`\n    }\n  }\n}\n\n/**\n * Retourne un environnement LaTeX itemize  partir d'une liste\n * @author Rmi Angot\n */\nexport function itemize(tableauDeTexte: string[]) {\n  if (\n    Array.isArray(tableauDeTexte) &&\n    tableauDeTexte.filter((el) => typeof el === 'string').length !== 0\n  ) {\n    let texte\n    if (context.isHtml) {\n      texte = '<div>'\n      for (let i = 0; i < tableauDeTexte.length; i++) {\n        texte += '<div>  ' + tableauDeTexte[i] + '</div>'\n      }\n      texte += '</div>'\n    } else {\n      texte = '\\t\\\\begin{itemize}\\n'\n      for (let i = 0; i < tableauDeTexte.length; i++) {\n        texte += '\\t\\t\\\\item ' + tableauDeTexte[i] + '\\n'\n      }\n      texte += '\\t\\\\end{itemize}'\n    }\n    return texte\n  } else {\n    window.notify(\n      \"Fonction itemize appele avec autre chose qu'un array de string\",\n      { tableauDeTexte },\n    )\n  }\n}\n","import { egal, epsilon } from '../../modules/outils'\ndeclare global {\n  interface Window {\n    notify: (message: string, object: unknown) => void\n    notifyLocal: (message: string, object: unknown) => void\n  }\n}\n/**\n *\n * @param {any[]} array1\n * @param {any[]} array2\n * @return boolean\n */\nexport function compareArrays(array1: unknown[], array2: unknown[]): boolean {\n  if (!Array.isArray(array1)) array1 = [array1]\n  if (!Array.isArray(array2)) array2 = [array2]\n  if (array1.length !== array2.length) return false\n  for (let i = 0; i < array1.length; i++) {\n    // le test suivant ne fonctionne pas avec des array contenant des objets, car objet1 === objet2 est toujours false.\n    // il fonctionne avec des arrays d'array ou de primitives.\n    const test = Array.isArray(array1[i])\n      ? compareArrays(array1[i] as unknown[], array2[i] as unknown[])\n      : array1[i] === array2[i]\n    if (!test) return false\n  }\n  return true\n}\n\n/**\n * Retourne true si o1 et o2 ont les mmes proprits avec les mmes valeurs\n * @param o1\n * @param o2\n */\nexport function areSameObject(o1: unknown, o2: unknown): boolean {\n  if (typeof o1 !== 'object' || typeof o2 !== 'object') return false\n  // les deux sont object\n  if (o1 === null) return o2 === null\n  // o1 objet non null\n  if (o2 === null) return false\n  if (Object.keys(o1).length !== Object.keys(o2).length) return false\n  // return Object.entries(o1).every(([key, value]) => areSameValues((o2)[key], value))\n  // EE 24/10/2024 : Tentative de typage de la dernire ligne en remmplacement de la prcdente maintenant commente\n  return Object.entries(o1).every(([key, value]) =>\n    areSameValues((o2 as Record<string, unknown>)[key], value),\n  )\n}\n/**\n * Retourne true si ar1 et ar2 sont deux tableaux de mme longueur, avec les mme valeurs dans le mme ordre\n */\nexport function areSameArray(ar1: unknown[], ar2: unknown[]): boolean {\n  if (!Array.isArray(ar1) || !Array.isArray(ar2) || ar1.length !== ar2.length) {\n    return false\n  }\n  return ar1.every((elt, i) => areSameValues(elt, ar2[i]))\n}\n/**\n * Retourne true si v1 et v2 ont la mme valeur (gaux pour string|boolean|number, mme contenu pour Object|Array)\n * Ne fonctionne pas pour les Object qui ne sont pas des \"plain object\" comme Regexp, Date, etc.\n */\nexport function areSameValues(v1: unknown, v2: unknown): boolean {\n  // une valeur qui n'est pas gale  elle mme en js\n  if (typeof v1 === 'undefined') return typeof v2 === 'undefined'\n  if (v1 === null) return v2 === null\n  if (Number.isNaN(v1)) return Number.isNaN(v2)\n  if (Array.isArray(v1)) return Array.isArray(v2) ? areSameArray(v1, v2) : false\n  if (typeof v1 === 'object') {\n    if (v1 instanceof Date) {\n      if (!(v2 instanceof Date)) return false\n      return v1.valueOf() === v2.valueOf()\n    }\n    if (v1 instanceof RegExp) {\n      if (!(v2 instanceof RegExp)) return false\n      return v1.source === v2.source && v1.flags === v2.flags\n    }\n    return areSameObject(v1, v2)\n  }\n  return v1 === v2\n}\n\n/**\n * Cr tous les couples possibles avec un lment de E1 et un lment de E2.\n * L'ordre est pris en compte, donc on pourra avoir (3,4) et (4,3).\n * Si le nombre de couples possibles est infrieur  nombreDeCouplesMin alors\n * on concatne 2 fois la mme liste, mais avec des ordres diffrents.\n * @param {int} nombreDeCouplesMin=10 - Nombre de couples souhaits\n * @author Rmi Angot\n */\nexport function creerCouples<T1, T2>(\n  E1: T1[],\n  E2: T2[],\n  nombreDeCouplesMin = 10,\n) {\n  let result = []\n  let temp = []\n  for (const i of E1) {\n    for (const j of E2) {\n      result.push([i, j])\n    }\n  }\n\n  temp = shuffle(result).slice(0) // crer un clone du tableau result mlang\n  result = temp.slice(0)\n  while (result.length < nombreDeCouplesMin) {\n    result = result.concat(shuffle(temp))\n  }\n  return result\n}\n\n/**\n * Enlve toutes les occurences d'un lment d'un tableau donn\n * Ajout par Jean-Claude Lhote : la gestion des listes contenant des listes. (par exemple, dans 6N20-2).\n * @param liste\n * @param element\n *\n * @author Rmi Angot\n */\nexport function enleveElement<T>(array: Array<T>, item: T) {\n  //\n  for (let i = array.length - 1; i >= 0; i--) {\n    if (typeof item === 'number') {\n      if (egal(array[i] as number, item)) {\n        array.splice(i, 1)\n      }\n    } else if (Array.isArray(array[i]) && Array.isArray(item)) {\n      if (compareArrays(array[i] as unknown[], item)) {\n        array.splice(i, 1)\n      }\n    } else {\n      if (array[i] === item) {\n        array.splice(i, 1)\n      }\n    }\n  }\n}\n\n/**\n * Enlve toutes les occurences d'un lment d'un tableau donn (array1) et enlve les lments associs dans un autre tableau (array2)\n * @param array array1\n * @param array array2\n * @param element item\n *\n * @author Rmi Angot\n */\nexport function enleveElementDouble<T>(array1: T[], array2: T[], item: T) {\n  //\n  for (let i = array1.length - 1; i >= 0; i--) {\n    if (typeof item === 'number') {\n      if (egal(array1[i] as number, item)) {\n        array1.splice(i, 1)\n        array2.splice(i, 1)\n      }\n    } else {\n      if (array1[i] === item) {\n        array1.splice(i, 1)\n        array2.splice(i, 1)\n      }\n    }\n  }\n}\n\n/**\n *\n * Compter les occurences d'un item dans un tableau\n * @param {array} array\n * @param item\n * @Author Rmi Angot\n */\nexport function compteOccurences<T>(array: T[], value: T): number {\n  let cpt = 0\n  array.forEach((v) => v === value && cpt++)\n  return cpt\n}\n\n/**\n * Enlve toutes les occurences d'un lment d'un tableau donn, mais sans modifier le tableau en paramtre et renvoie le tableau modifi\n * @author Rmi Angot & Jean-Claude Lhote\n */\n\nexport function enleveElementBis<T>(array: T[], item?: T) {\n  const tableaucopie = []\n  for (let i = 0; i < array.length; i++) {\n    tableaucopie.push(array[i])\n  }\n  for (let i = tableaucopie.length - 1; i >= 0; i--) {\n    if (tableaucopie[i] === item) {\n      tableaucopie.splice(i, 1)\n    }\n  }\n  return tableaucopie\n}\n\n/**\n * Enlve l'lment index d'un tableau attention ! modifie le tableau pass en argument ne retourne rien\n * @param {Array<any>} le tableau  modifier\n * @param {number} index de l'lment  retirer\n * @author Jean-Claude Lhote\n */\nexport function enleveElementNo<T>(array: T[], index: number) {\n  if (index >= 0 && index < array.length) array.splice(index, 1)\n}\n\n/**\n * Enlve l'lment index d'un tableau sans modifier le tableau et retourne le rsultat\n * @param {Array<any>} le tableau  modifier\n * @param {number} index de l'lment  retirer\n * @return {Array<any>} une copie du tableau modifi\n * @author Jean-Claude Lhote\n */\nexport function nouveauTableauPriveDunElement<T>(array: T[], index: number) {\n  const tableaucopie = array.slice()\n  return tableaucopie.splice(index, 1)\n}\n\n/**\n * Remplace toutes les occurrences d'une valeur dans un tableau par une autre.\n *\n * @template T - Type des lments du tableau (string ou number).\n * @param {T[]} arr - Le tableau original dans lequel effectuer le remplacement.\n * @param {T} search - La valeur  rechercher dans le tableau.\n * @param {T} replace - La valeur de remplacement  insrer  la place de `search`.\n * @returns {T[]} Un nouveau tableau avec les valeurs remplaces.\n * @author Eric Elter\n * @example\n * remplaceDansTableau(['a', 'b', 'a'], 'a', 'z'); // ['z', 'b', 'z']\n *\n * @example\n * remplaceDansTableau([1, 2, 3, 2], 2, 99); // [1, 99, 3, 99]\n */\nexport function remplaceDansTableau<T extends string | number>(\n  arr: T[],\n  search: T,\n  replace: T,\n): T[] {\n  return arr.map((item) => (item === search ? replace : item))\n}\n\n/**\n * Complte un tableau de nombres uniques dans une plage donne jusqu' atteindre nbQuestions,\n * en ajoutant des nombres alatoires qui ne sont pas dj prsents dans le tableau.\n *\n * @param {number[]} tableau - Le tableau actuel de nombres uniques.\n * @param {number} nbQuestions - Le nombre total de valeurs souhaites.\n * @param {number} valeurMax - La valeur maximale autorise (minimum = 1).\n * @returns {number[]} Un nouveau tableau complt, sans doublons, avec des valeurs entre 1 et valeurMax.\n * @author Eric Elter\n *\n * @throws {Error} Si nbQuestions est suprieur  valeurMax.\n *\n * @example\n * completerNombresUniques([1, 3, 5], 5, 10); // [1, 3, 5, 8, 2] (par exemple)\n */\nexport function completerNombresUniques(\n  tableau: number[],\n  nbQuestions: number,\n  valeurMax: number,\n): number[] {\n  if (nbQuestions > valeurMax) {\n    throw new Error(\n      `Impossible de gnrer ${nbQuestions} valeurs uniques entre 1 et ${valeurMax}.`,\n    )\n  }\n\n  if (tableau.length >= nbQuestions) {\n    return tableau.slice(0, nbQuestions)\n  }\n\n  const existants = new Set(tableau)\n\n  // Gnrer les valeurs manquantes\n  let valeursManquantes: number[] = []\n  for (let i = 1; i <= valeurMax; i++) {\n    if (!existants.has(i)) {\n      valeursManquantes.push(i)\n    }\n  }\n\n  valeursManquantes = shuffle(valeursManquantes)\n\n  const nombreAAjouter = nbQuestions - tableau.length\n  const ajouts = valeursManquantes.slice(0, nombreAAjouter)\n\n  return [...tableau, ...ajouts]\n}\n\n/**\n * Retourne un lment au hasard de la liste sans appartenir  une liste donne\n * @param {liste}\n * @param {listeAEviter}\n *\n * @example\n * // Renvoie 1, 2 ou 3\n * choice([1,2,3])\n * @example\n * // Renvoie Rmi ou La\n * choice(['Rmi','La'])\n *\n * @author Rmi Angot\n */\nexport function choice<T>(liste: T[], listeAEviter: T[] | T = []): T {\n  if (!Array.isArray(listeAEviter)) {\n    listeAEviter = [listeAEviter]\n  }\n  const listebis = liste.slice()\n  // Supprime les lments de liste  viter\n  for (let i = 0; i < listeAEviter.length; i++) {\n    enleveElement(listebis, listeAEviter[i])\n  }\n  const index = Math.floor(Math.random() * listebis.length)\n  if (listebis[index] != null) return listebis[index]\n  else {\n    window.notify(\n      'choice a limin toutes les possibilits, il ne reste rien  choisir ! ',\n      { liste, listeAEviter },\n    )\n    return listebis[index] // C'est null...\n  }\n}\n\n/**\n * retourne un tableau dans lequel les doublons ont t supprims s'il y en a MAIS SANS TRI\n * @param {array} arr Tableau duquel on veut supprimer les doublons numriques\n * @param {number} tolerance La diffrence minimale entre deux valeurs pour les considrer comme gales\n * @author Jean-Claude Lhote\n **/\nexport function enleveDoublonNum(arr: number[], tolerance = epsilon) {\n  let k = 0\n  while (k < arr.length - 1) {\n    let kk = k + 1\n    while (kk <= arr.length - 1) {\n      if (egal(arr[k], arr[kk], tolerance)) {\n        arr[k] = (arr[k] + arr[kk]) / 2 // On remplace la valeur dont on a trouv un double par la moyenne des deux valeurs\n        arr.splice(kk, 1) // on supprime le doublon.\n      } else {\n        kk++\n      }\n    }\n    k++\n  }\n  return arr\n}\n\n/**\n * Mlange les items d'un tableau, sans modifier le tableau pass en argument\n *\n * @Example\n * tableau_melange = shuffle (tableau_origine)\n * @see https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array\n */\nexport function shuffle<T>(array: T[]): T[] {\n  let currentIndex = array.length\n  let temporaryValue\n  let randomIndex\n\n  // While there remain elements to shuffle...\n  const arrayBis = [...array]\n  while (currentIndex !== 0) {\n    // Pick a remaining element...\n    randomIndex = Math.floor(Math.random() * currentIndex)\n    currentIndex -= 1\n\n    // And swap it with the current element.\n    temporaryValue = arrayBis[currentIndex]\n    arrayBis[currentIndex] = arrayBis[randomIndex]\n    arrayBis[randomIndex] = temporaryValue\n  }\n\n  return arrayBis\n}\n\nexport function shuffleJusqua<T>(array: T[], indice: number): T[] {\n  if (indice > array.length || indice < 0 || indice === undefined) {\n    return shuffle(array)\n  } else {\n    const tableau1 = array.slice(0, indice)\n    const tableau2 = array.slice(indice)\n    return [...shuffle(tableau1), ...tableau2]\n  }\n}\n\n/**\n * Mlange les lettres d'un string\n *\n * @Example\n * motMelange = shuffleLettres (mot)\n * @see https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array\n */\nexport function shuffleLettres(txt: string) {\n  const array = txt.split('')\n  return shuffle(array).join('')\n}\n\n/**\n * Mlange les items de deux tableaux de la mme manire\n *\n *\n * @see https://stackoverflow.com/questions/18194745/shuffle-multiple-javascript-arrays-in-the-same-way\n */\nexport function shuffle2tableaux<T, U>(obj1: T[], obj2: U[]): void {\n  let index = obj1.length\n  let rnd, tmp1, tmp2\n\n  while (index) {\n    rnd = Math.floor(Math.random() * index)\n    index -= 1\n    tmp1 = obj1[index]\n    tmp2 = obj2[index]\n    obj1[index] = obj1[rnd]\n    obj2[index] = obj2[rnd]\n    obj1[rnd] = tmp1\n    obj2[rnd] = tmp2\n  }\n}\n\n/**\n * Mlange les items de deux tableaux de la mme manire\n *\n *\n * @see https://stackoverflow.com/questions/18194745/shuffle-multiple-javascript-arrays-in-the-same-way\n */\nexport function shuffle2tableauxSansModif<T, U>(\n  obj1: T[],\n  obj2: U[],\n): [T[], U[]] {\n  let index = obj1.length\n  let rnd, tmp1, tmp2\n  const obj1bis = obj1.slice()\n  const obj2bis = obj2.slice()\n  while (index) {\n    rnd = Math.floor(Math.random() * index)\n    index -= 1\n    tmp1 = obj1bis[index]\n    tmp2 = obj2bis[index]\n    obj1bis[index] = obj1bis[rnd]\n    obj2bis[index] = obj2bis[rnd]\n    obj1bis[rnd] = tmp1\n    obj2bis[rnd] = tmp2\n  }\n  return [obj1bis, obj2bis]\n}\n\n/**\n * Mlange les items de trois tableaux de la mme manire\n *\n *\n */\nexport function shuffle3tableaux<T, U, V>(\n  obj1: T[],\n  obj2: U[],\n  obj3: V[],\n): void {\n  let index = obj1.length\n  let rnd, tmp1, tmp2, tmp3\n\n  while (index) {\n    rnd = Math.floor(Math.random() * index)\n    index -= 1\n    tmp1 = obj1[index]\n    tmp2 = obj2[index]\n    tmp3 = obj3[index]\n    obj1[index] = obj1[rnd]\n    obj2[index] = obj2[rnd]\n    obj3[index] = obj3[rnd]\n    obj1[rnd] = tmp1\n    obj2[rnd] = tmp2\n    obj3[rnd] = tmp3\n  }\n}\n\n/**\n * Concatne liste  elle-mme en changeant l'ordre  chaque cycle\n * @param {Array | ReadonlyArray} liste - Un tableau\n * @param {number} tailleMinimale - La taille minimale du tableau de sortie\n * @returns {Array} Un tableau du mme type que liste\n *\n * @Example\n * combinaisonListes([A,B,C],7)\n * // [B,C,A,C,B,A,A,B,C]\n *\n * @author Rmi Angot\n */\nexport function combinaisonListes<T>(liste: T[], tailleMinimale?: number) {\n  if (tailleMinimale === undefined) tailleMinimale = liste.length\n  if (liste.length === 0) {\n    window.notify(\n      'erreur dans CombinaisonListes : la liste  combiner est vide',\n      { liste },\n    )\n  }\n  let l = shuffle(liste) // on ne modifie pas la liste passe en argument !\n  while (l.length < tailleMinimale) {\n    l = l.concat(shuffle(liste))\n  }\n  return l\n}\n\n/**\n * Concatne liste  elle-mme en imposant  la nouvelle liste de contenir au moins tous les lements\n * de la liste initiale, mais sans gestion de nombre de doublons.\n * @Example\n * combinaisonListes2([A,B,C],7)\n * // [B,C,B,B,C,A,B]\n * combinaisonListes2([A,B,C,D],6)\n * // [B,C,D,B,C,A,B]\n * @author Eric Elter\n */\nexport function combinaisonListes2<T>(liste: T[], tailleMinimale: number) {\n  if (liste.length === 0) {\n    window.notify(\n      'erreur dans CombinaisonListes : la liste  combiner est vide',\n      { liste },\n    )\n  }\n  let l = [...liste] // on ne modifie pas la liste passe en argument !\n  while (l.length < tailleMinimale) {\n    l = l.concat(choice(liste) as T[])\n  }\n  return shuffle(l)\n}\n\nexport function combinaisonListesSansChangerOrdre<T>(\n  liste: T[],\n  tailleMinimale: number,\n) {\n  // Concatne liste  elle-mme sans changer l'ordre\n  if (liste.length === 0) {\n    window.notify(\n      'erreur dans CombinaisonListes : la liste  combiner est vide',\n      { liste },\n    )\n  }\n  let l = [...liste] // on ne modifie pas la liste passe en argument !\n  while (l.length < tailleMinimale) {\n    l = l.concat(liste)\n  }\n  return l\n}\n\nexport function getRandomSubarray<T>(arr: T[], size: number): T[] {\n  // Copy the array to avoid mutating the original\n  const shuffled = [...arr]\n  let i = arr.length\n  const min = i - size\n  while (i > min) {\n    // Generate a random index from 0 to i (exclusive)\n    const index = Math.floor(Math.random() * i)\n    i--\n    // Swap elements\n    ;[shuffled[i], shuffled[index]] = [shuffled[index], shuffled[i]]\n  }\n  // Return the last 'size' elements after shuffling\n  return shuffled.slice(min)\n}\n\n/**\n * Construit une liste d'index alatoires base sur la taille\n * du tableau originel et le nombre d'index  prlever dans\n * ce tableau.\n * @param {number} originalArraySize taille du tableau d'origine\n * @param {number} nbOfIndexes nombre d'index  choisir\n * @returns {number[]} tableau d'index\n * @author sylvain\n */\nexport function listOfRandomIndexes(\n  originalArraySize: number,\n  nbOfIndexes: number,\n) {\n  const indexes = shuffle([...Array(originalArraySize).keys()])\n  return indexes.slice(0, nbOfIndexes)\n}\n\nexport // Fonction utilitaire pour cloner rcursivement un objet simple\nfunction arrayCloneObject(obj: any): any {\n  const clonedObj: any = {}\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      const value = obj[key]\n      if (Array.isArray(value)) {\n        clonedObj[key] = arrayClone(value)\n      } else if (value && typeof value === 'object') {\n        clonedObj[key] = arrayCloneObject(value)\n      } else {\n        clonedObj[key] = value\n      }\n    }\n  }\n  return clonedObj\n}\n\nexport function arrayClone(originalArray: any[]): any[] {\n  return originalArray.map((item) => {\n    if (Array.isArray(item)) {\n      return arrayClone(item)\n    } else if (item && typeof item === 'object') {\n      // Clone rcursif pour les objets simples\n      const clonedObj: any = {}\n      for (const key in item) {\n        if (Object.prototype.hasOwnProperty.call(item, key)) {\n          const value = item[key]\n          if (Array.isArray(value)) {\n            clonedObj[key] = arrayClone(value)\n          } else if (value && typeof value === 'object') {\n            clonedObj[key] = arrayCloneObject(value)\n          } else {\n            clonedObj[key] = value\n          }\n        }\n      }\n      return clonedObj\n    } else {\n      // Primitives (number, string, boolean, null, undefined)\n      return item\n    }\n  })\n}\n\ntype OptionsBinomes = {\n  premierNombre?: number\n  dernierNombre?: number\n  ordreCroissant?: boolean\n  ordreDecroissant?: boolean\n}\n\n/**\n * Gnre tous les binmes possibles  partir dun tableau de nombres,\n * en respectant ventuellement certaines options de filtrage.\n *\n * @param {number[]} tab - Tableau de nombres  combiner.\n * @param {Object} [options={}] - Options permettant de restreindre ou filtrer les binmes.\n * @param {number} [options.premierNombre] - Si dfini, ne garde que les binmes dont le premier lment est ce nombre.\n * @param {number} [options.dernierNombre] - Si dfini, ne garde que les binmes dont le second lment est ce nombre.\n * @param {boolean} [options.ordreCroissant=false] - Si true, ne conserve que les binmes [a, b] o a < b.\n * @param {boolean} [options.ordreDecroissant=false] - Si true, ne conserve que les binmes [a, b] o a > b.\n * @returns {[number, number][]} Liste de binmes valides.\n * @author Eric Elter\n *\n * @example\n * genererBinomesAleatoires([0,1,2,3])\n * // =>\n * // [\n * //   [0,1],[0,2],[0,3],\n * //   [1,0],[1,2],[1,3],\n * //   [2,0],[2,1],[2,3],\n * //   [3,0],[3,1],[3,2]\n * // ]\n *\n * @example\n * genererBinomesAleatoires([0,1,2,3], { ordreCroissant: true })\n * // => [[0,1],[0,2],[0,3],[1,2],[1,3],[2,3]]\n *\n * @example\n * genererBinomesAleatoires([0,1,2,3], { premierNombre: 2 })\n * // => [[2,0],[2,1],[2,3]]\n *\n * @example\n * genererBinomesAleatoires([0,1,2,3], { dernierNombre: 2 })\n * // => [[0,2],[1,2],[3,2]]\n *\n * @example\n * genererBinomesAleatoires([0,1,2,3], { premierNombre: 1, dernierNombre: 3 })\n * // => [[1,3]]\n */\nexport function genererBinomesAleatoires(\n  tab: number[],\n  options: OptionsBinomes = {},\n): [number, number][] {\n  const {\n    premierNombre = undefined,\n    dernierNombre = undefined,\n    ordreCroissant = false,\n    ordreDecroissant = false,\n  } = options\n\n  const binomes: [number, number][] = []\n\n  for (let i = 0; i < tab.length; i++) {\n    for (let j = 0; j < tab.length; j++) {\n      if (i === j) continue\n\n      const a = tab[i]\n      const b = tab[j]\n\n      // Appliquer les options\n      if (premierNombre !== undefined && a !== premierNombre) continue\n      if (dernierNombre !== undefined && b !== dernierNombre) continue\n      if (ordreCroissant && a >= b) continue\n      if (ordreDecroissant && a <= b) continue\n\n      binomes.push([a, b])\n    }\n  }\n\n  // Mlange alatoire (Fisher-Yates)\n  for (let i = binomes.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1))\n    ;[binomes[i], binomes[j]] = [binomes[j], binomes[i]]\n  }\n  return binomes\n}\n","/**\n * Retourne le signe d'un nombre\n * @Example\n * // + ou -\n * @author Rmi Angot\n */\nimport Decimal from 'decimal.js'\nimport { round } from 'mathjs'\nimport { enleveElement } from './arrayOutils'\n\nexport function signe(a: number) {\n  // + ou -\n  let result\n  if (a > 0) {\n    result = '+'\n  } else {\n    result = '-'\n  }\n  return result\n}\n\n/**\n * Retourne la somme des chiffres (ou d'un tableau de chiffres) d'un nombre en valeur et sous forme de String [valeur, String]\n * @Example\n * sommeDesChiffres(123)\n * // [ 6, '1+2+3']\n * @author Rmi Angot (Rajout Tableau par EE)\n */ export function sommeDesChiffres(n: number | number[]): [number, string] {\n  let nString\n  if (Array.isArray(n)) nString = n.join('').toString()\n  else nString = n.toString()\n  let somme = 0\n  let sommeString = ''\n  for (let i = 0; i < nString.length - 1; i++) {\n    if (\n      ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'].indexOf(nString[i]) !==\n      -1\n    ) {\n      sommeString += nString[i] + '+'\n      somme += Number(nString[i])\n    }\n  }\n  if (\n    ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'].indexOf(\n      nString[nString.length - 1],\n    ) !== -1\n  ) {\n    sommeString += nString[nString.length - 1]\n    somme += Number(nString[nString.length - 1])\n  }\n  return [somme, sommeString]\n}\n\n/**\n * Retourne l'arrondi (par dfaut au millionime prs)\n * @author Rmi Angot\n * @param {number} nombre\n * @param {number} precision\n * @return {number}\n */\nexport function arrondi(nombre: number, precision = 6) {\n  if (isNaN(nombre)) {\n    window.notify(\"Le nombre  arrondir n'en est pas un, a retourne NaN\", {\n      nombre,\n      precision,\n    })\n    return NaN\n  } else {\n    return round(nombre, precision)\n  }\n}\n\n/**\n * Retourne la troncature signe de nombre.\n * @author Jean-Claude Lhote\n */\nexport function troncature(nombre: number, precision: number) {\n  const tmp = Math.pow(10, precision)\n  const absolu = new Decimal(nombre).abs()\n  const tronc = absolu.mul(tmp).floor().div(tmp)\n  if (nombre < 0) return tronc.mul(-1).toNumber()\n  else return tronc.toNumber()\n}\n\n/**\n * Renvoie la valeur absolue\n * @author Rmi Angot + ajout du support des dcimaux par Jean-Claude Lhote\n * @returns {number|Decimal}\n */\nexport function abs<T extends number | Decimal>(a: T): T {\n  if (a instanceof Decimal) return a.abs() as T\n  return Math.abs(a) as T\n}\n\n/**\n * prend une liste de nombres relatifs et la retourne avec les positifs au dbut et les ngatifs  la fin.\n * @param {array} liste la liste de nombres  trier\n */\nexport function triePositifsNegatifs(liste: number[]) {\n  const positifs = []\n  const negatifs = []\n  for (let i = 0; i < liste.length; i++) {\n    if (liste[i] > 0) positifs.push(liste[i])\n    else negatifs.push(liste[i])\n  }\n  return positifs.concat(negatifs)\n}\n\n/**\n * Renvoie le nombre de chiffres de la partie dcimale\n * @param {number} nb : nombre dcimal\n * @param {number} except : chiffre  ne pas compter (0 par exemple) [Ajout EE]\n * @author Rmi Angot\n */\nexport function nombreDeChiffresDansLaPartieDecimale(\n  nb: number | string | Decimal,\n  except?: number,\n) {\n  let sauf = 0\n  if (nb instanceof Decimal || typeof nb === 'number') nb = nb.toString()\n  if (nb.indexOf('.') > 0) {\n    if (except && !isNaN(except))\n      sauf = String(nb).split('.')[1].split(String(except)).length - 1\n    return nb.split('.')[1].length - sauf\n  } else {\n    return 0\n  }\n}\n\n/**\n * Renvoie le nombre de chiffres dans la partie entire\n * @author ?\n */\nexport function nombreDeChiffresDansLaPartieEntiere(\n  nb: number,\n  except?: number,\n) {\n  let nombre\n  let sauf = 0\n  if (nb < 0) {\n    nombre = -nb\n  } else {\n    nombre = nb\n  }\n  if (String(nombre).indexOf('.') > 0) {\n    if (except && !isNaN(except))\n      sauf = String(nombre).split('.')[0].split(String(except)).length - 1\n    return String(nombre).split('.')[0].length - sauf\n  } else {\n    // if (!isNaN(except)) sauf = (String(nombre).split(String(except)).length - 1) @fixme  quoi sert cette affectation inutile ?\n    return String(nombre).length\n  }\n}\n\n/**\n * Renvoie le nombre de chiffres d'un nombre dcimal\n * @param {number} nb : nombre dcimal\n * @param {number} except : chiffre  ne pas compter (0 par exemple) [Ajout EE]\n * @author Jean-Claude Lhote\n */\nexport function nombreDeChiffresDe(nb: number | Decimal, except?: number) {\n  if (nb instanceof Decimal) nb = nb.toNumber()\n  return (\n    nombreDeChiffresDansLaPartieDecimale(nb, except) +\n    nombreDeChiffresDansLaPartieEntiere(nb, except)\n  )\n}\n\n/**\n *\n * x le nombre dont on cherche l'ordre de grandeur\n * type = 0 pour la puissance de 10 infrieure, 1 pour la puissance de 10 suprieur et 2 pour la plus proche\n */\nexport function ordreDeGrandeur(x: number, type: number) {\n  let signe\n  if (x < 0) signe = -1\n  else signe = 1\n  x = Math.abs(x)\n  const P = 10 ** Math.floor(Math.log10(x))\n  if (type === 0) return P * signe\n  else if (type === 1) return P * 10 * signe\n  else if (x - P < 10 * P - x) return P * signe\n  else return P * 10 * signe\n}\n\n/**\n * Retourne une liste des entiers de 0  max sans appartenir  une liste donne\n * @param {number} max\n * @param {number[]} listeAEviter\n *\n * @example\n * // Renvoie [0,1,4,5,6,7,8,9,10]\n * range(10,[2,3])\n *\n * @author Rmi Angot\n */\nexport function range(max: number = 10, listeAEviter: number[] = []) {\n  // Crer un tableau avec toutes les valeurs de 0  max sauf celle de la liste  viter\n  const liste = [...Array(max + 1).keys()]\n  for (let i = 0; i < listeAEviter.length; i++) {\n    enleveElement(liste, listeAEviter[i])\n  }\n  return liste\n}\n\n/**\n * Retourne une liste entre 2 bornes sans appartenir  une liste donne (par dfaut des entiers, mais on peut changer le pas)\n * @param {number} min\n * @param {number} max\n * @param {number[]} listeAEviter\n * @param {number} step\n * @example\n * // Renvoie [6,7,10]\n * rangeMinMax(6,10,[8,9])\n *\n * @author Rmi Angot\n */\nexport function rangeMinMax(\n  min: number,\n  max: number,\n  listeAEviter: number | number[] = [],\n  step = 1,\n) {\n  // Crer un tableau avec toutes les valeurs de 0  max sauf celle de la liste  viter\n  const liste = []\n  for (let i = min; i <= max; i = i + step) {\n    liste.push(i)\n  }\n  if (typeof listeAEviter === 'number') listeAEviter = [listeAEviter]\n  for (let i = 0; i < listeAEviter.length; i++) {\n    enleveElement(liste, listeAEviter[i])\n  }\n  return liste\n}\n\n/**\n * Cr un tableau avec toutes les valeurs de 1  max sauf celle de la liste  viter\n *\n *\n * @param {number} max\n * @param {number[]} listeAEviter valeurs  viter\n * @author Rmi Angot\n */\nexport function range1(max: number = 10, listeAEviter: number[] = []) {\n  const liste = []\n  for (let i = 1; i <= max; i++) {\n    liste.push(i)\n  }\n  for (let i = 0; i < listeAEviter.length; i++) {\n    enleveElement(liste, listeAEviter[i])\n  }\n  return liste\n}\n\n/**\n * Fonction de comparaison  utiliser avec <tableau.sort(compareNombres)>\n *\n *\n * @author Rmi Angot\n */\nexport function compareNombres(a: number, b: number) {\n  return a - b\n}\n\n/**\n *\n * Copi sur https://delicious-insights.com/fr/articles/le-piege-de-array-sort/\n */\nexport function numTrie(arr: number[]) {\n  return arr.sort(function (a, b) {\n    return a - b\n  })\n}\n\n/**\n *\n * @param {number} a\n * -1 si a est ngatif, 1 sinon.\n * @author Jean-Claude Lhote\n */\nexport function unSiPositifMoinsUnSinon(a: number) {\n  if (a < 0) return -1\n  else return 1\n}\n\n/**\n *\n * @param a retourne vrai si tous les lments de a sont de mme signe\n * @returns boolean\n * @author Jean-Claude Lhote\n */\nexport function tousDeMemeSigne(a: number[]) {\n  if (a.length === 0) return true\n  return a.every((val) => {\n    return signe(val) === signe(a[0])\n  })\n}\n","import katex from 'katex'\nimport type { Latex2d } from '../lib/2d/textes'\nimport { arrondi } from '../lib/outils/nombres'\nimport { context } from './context'\nexport type ObjetDivLatex = {\n  x: number\n  y: number\n  orientation: number\n  opacity: number\n  backgroundColor: string\n  color: string\n  latex: string\n  letterSize: string\n}\nexport type NestedObjetMathalea2dArray = (\n  | ObjetMathalea2D\n  | Latex2d\n  | NestedObjetMathalea2dArray\n)[]\n\nexport const colours = {\n  aliceblue: '#f0f8ff',\n  antiquewhite: '#faebd7',\n  aqua: '#00ffff',\n  aquamarine: '#7fffd4',\n  azure: '#f0ffff',\n  beige: '#f5f5dc',\n  bisque: '#ffe4c4',\n  black: '#000000',\n  blanchedalmond: '#ffebcd',\n  blue: '#0000ff',\n  blueviolet: '#8a2be2',\n  brown: '#a52a2a',\n  burlywood: '#deb887',\n  cadetblue: '#5f9ea0',\n  chartreuse: '#7fff00',\n  chocolate: '#d2691e',\n  coral: '#ff7f50',\n  cornflowerblue: '#6495ed',\n  cornsilk: '#fff8dc',\n  crimson: '#dc143c',\n  cyan: '#00ffff',\n  darkblue: '#00008b',\n  darkcyan: '#008b8b',\n  darkgoldenrod: '#b8860b',\n  darkgray: '#a9a9a9',\n  darkgreen: '#006400',\n  darkkhaki: '#bdb76b',\n  darkmagenta: '#8b008b',\n  darkolivegreen: '#556b2f',\n  darkorange: '#ff8c00',\n  darkorchid: '#9932cc',\n  darkred: '#8b0000',\n  darksalmon: '#e9967a',\n  darkseagreen: '#8fbc8f',\n  darkslateblue: '#483d8b',\n  darkslategray: '#2f4f4f',\n  darkturquoise: '#00ced1',\n  darkviolet: '#9400d3',\n  deeppink: '#ff1493',\n  deepskyblue: '#00bfff',\n  dimgray: '#696969',\n  dodgerblue: '#1e90ff',\n  firebrick: '#b22222',\n  floralwhite: '#fffaf0',\n  forestgreen: '#228b22',\n  fuchsia: '#ff00ff',\n  gainsboro: '#dcdcdc',\n  ghostwhite: '#f8f8ff',\n  gold: '#ffd700',\n  goldenrod: '#daa520',\n  gray: '#808080',\n  green: '#008000',\n  greenyellow: '#adff2f',\n  honeydew: '#f0fff0',\n  hotpink: '#ff69b4',\n  'indianred ': '#cd5c5c',\n  indigo: '#4b0082',\n  ivory: '#fffff0',\n  khaki: '#f0e68c',\n  lavender: '#e6e6fa',\n  lavenderblush: '#fff0f5',\n  lawngreen: '#7cfc00',\n  lemonchiffon: '#fffacd',\n  lightblue: '#add8e6',\n  lightcoral: '#f08080',\n  lightcyan: '#e0ffff',\n  lightgoldenrodyellow: '#fafad2',\n  lightgray: '#d3d3d3',\n  lightgrey: '#d3d3d3',\n  lightgreen: '#90ee90',\n  lightpink: '#ffb6c1',\n  lightsalmon: '#ffa07a',\n  lightseagreen: '#20b2aa',\n  lightskyblue: '#87cefa',\n  lightslategray: '#778899',\n  lightsteelblue: '#b0c4de',\n  lightyellow: '#ffffe0',\n  lime: '#00ff00',\n  limegreen: '#32cd32',\n  linen: '#faf0e6',\n  magenta: '#ff00ff',\n  maroon: '#800000',\n  mediumaquamarine: '#66cdaa',\n  mediumblue: '#0000cd',\n  mediumorchid: '#ba55d3',\n  mediumpurple: '#9370d8',\n  mediumseagreen: '#3cb371',\n  mediumslateblue: '#7b68ee',\n  mediumspringgreen: '#00fa9a',\n  mediumturquoise: '#48d1cc',\n  mediumvioletred: '#c71585',\n  midnightblue: '#191970',\n  mintcream: '#f5fffa',\n  mistyrose: '#ffe4e1',\n  moccasin: '#ffe4b5',\n  navajowhite: '#ffdead',\n  navy: '#000080',\n  oldlace: '#fdf5e6',\n  olive: '#808000',\n  olivedrab: '#6b8e23',\n  orange: '#ffa500',\n  orangered: '#ff4500',\n  orchid: '#da70d6',\n  palegoldenrod: '#eee8aa',\n  palegreen: '#98fb98',\n  paleturquoise: '#afeeee',\n  palevioletred: '#d87093',\n  papayawhip: '#ffefd5',\n  peachpuff: '#ffdab9',\n  peru: '#cd853f',\n  pink: '#ffc0cb',\n  plum: '#dda0dd',\n  powderblue: '#b0e0e6',\n  purple: '#800080',\n  rebeccapurple: '#663399',\n  red: '#ff0000',\n  rosybrown: '#bc8f8f',\n  royalblue: '#4169e1',\n  saddlebrown: '#8b4513',\n  salmon: '#fa8072',\n  sandybrown: '#f4a460',\n  seagreen: '#2e8b57',\n  seashell: '#fff5ee',\n  sienna: '#a0522d',\n  silver: '#c0c0c0',\n  skyblue: '#87ceeb',\n  slateblue: '#6a5acd',\n  slategray: '#708090',\n  snow: '#fffafa',\n  springgreen: '#00ff7f',\n  steelblue: '#4682b4',\n  tan: '#d2b48c',\n  teal: '#008080',\n  thistle: '#d8bfd8',\n  tomato: '#ff6347',\n  turquoise: '#40e0d0',\n  violet: '#ee82ee',\n  wheat: '#f5deb3',\n  white: '#ffffff',\n  whitesmoke: '#f5f5f5',\n  yellow: '#ffff00',\n  yellowgreen: '#9acd32',\n}\nexport type ColourNames = keyof typeof colours\n/*\n  MathALEA2D\n @name      mathalea2d\n @author    Rmi Angot et Jean-Claude Lhote\n @license   MIT License - CC-BY-SA\n @homepage  https://coopmaths.fr/mathalea2d.html\n */\n\n/*\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%% OBJET PARENT %%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n*/\n\nlet numId = 0 // Crer un identifiant numrique unique par objet SVG\n\n/*\n * Classe parente de tous les objets de MathALEA2D\n *\n * @author Rmi Angot\n */\n/* export function ObjetMathalea2D ({ classe = true } = {}) {\n  this.positionLabel = 'above'\n  // @deprecated cette proprit servait dans l'diteur Mathalea2d en ligne pour dire qu'on ne voulait pas reprsenter des objets crs juste comme constructeurs\n  // this.isVisible = true // Si on veut qu'un objet soit visible, on le passe dans la liste d'objets  mathalea2d(), si on n'en veut pas, on ne l'y met pas.\n  // Si l'diteur en ligne de figure mathalea2d revoit le jour, peut-tre que cette proprit sera utile ?\n  this.color = colorToLatexOrHTML('black')\n  this.style = '' // stroke-dasharray=\"4 3\" pour des hachures //stroke-width=\"2\" pour un trait plus pais\n  // this.styleTikz = ''\n  this.epaisseur = 1\n  this.opacite = 1\n  this.pointilles = 0\n  this.id = numId\n  this.opacite = 1\n  numId++\n  if (classe && context.isInEditor) context.objets2D.push(this)\n}\n  */\n\n/*\n * Classe parente de tous les objets de MathALEA2D\n *\n * @author Rmi Angot\n */\nexport class ObjetMathalea2D {\n  [x: string]: any //  typer quand on passera  TypeScript\n  positionLabel: string\n  color: [string, string] // Couleur au format HTML et au format LaTeX\n  style: string\n  epaisseur: number\n  opacite: number\n  id: number | string\n  pointilles: number\n  bordures: [number, number, number, number] // Doit rester undefined pour identifier les objets qui ne dfinissent pas leurs bordures (un notify sera envoy)\n  objets?: (ObjetMathalea2D | Latex2d)[]\n  typeObjet?: string\n\n  constructor() {\n    this.positionLabel = 'above'\n    this.color = colorToLatexOrHTML('black')\n    this.style = ''\n    this.epaisseur = 1\n    this.opacite = 1\n    this.pointilles = 0\n    this.id = numId\n    this.bordures = [NaN, NaN, NaN, NaN]\n    numId++\n  }\n\n  svg(coeff: number): string | ObjetDivLatex {\n    return ''\n  }\n\n  tikz(...args: any[]): string | ObjetDivLatex {\n    return ''\n  }\n}\n\n/**\n * Une fonction pour convertir des abscisses en unit Mathal en abscisses svg\n * @param x\n * @param coeff\n * @return {number}\n */\nexport const xSVG = (x: number, coeff: number) =>\n  arrondi(x * coeff, 1) as number\n/**\n * Une fonction pour convertir des ordonnes en unit Mathal en ordonnes svg\n * @param y\n * @param coeff\n * @return {number}\n */\nexport const ySVG = (y: number, coeff: number) =>\n  arrondi(-y * coeff, 1) as number\n/**\n * mathalea2d(xmin,xmax,ymin,ymax,objets)\n *\n * @author Rmi Angot\n *\n *\n * Le paramtre optionsTikz est un tableau de strings contenant exclusivement des options Tikz  ajouter\n * si scale existe autre que 1 il faut que le code reste comme avant\n * sinon on ajoute scale quoi qu'il en soit quitte  ce que xscale et yscale viennent s'ajouter\n * de cette manire d'autres options Tikz pourront aussi tre ajoutes\n * si il n'y a qu'une optionsTikz on peut passer un string\n * @param {object} options\n *  @param {number} [options.xmin = 0]\n *  @param {number} [options.ymin = 0]\n *  @param {number} [options.xmax = 15]\n *  @param {number} [options.ymax = 6]\n *  @param {number?} [options.pixelsParCm]\n *  @param {number?} [options.scale = 1]\n *  @param {number?} [options.zoom = 1]\n *  @param {string|string[]?} [options.optionsTikz = []]\n *  @param {boolean?} [options.mainlevee]\n *  @param {number?} [options.amplitude]\n *  @param {string?} [options.style = '']\n *  @param {string?} [options.id = '']\n * @param {(ObjetMathalea2D|ObjetMathalea2D[])[]} objets\n */\nexport function mathalea2d(\n  {\n    xmin = 0,\n    ymin = 0,\n    xmax = 15,\n    ymax = 6,\n    pixelsParCm = 20,\n    scale = 1,\n    zoom = 1,\n    optionsTikz = [],\n    mainlevee = false,\n    amplitude = 1,\n    style = 'display: block',\n    id = '', // L'id peut-tre utile pour des animations, c'est celui du svg. Le div englobant aura un id en M2D + id\n    usePgfplots = false,\n    centerLatex = false,\n  }: {\n    xmin?: number\n    ymin?: number\n    xmax?: number\n    ymax?: number\n    pixelsParCm?: number\n    scale?: number\n    zoom?: number\n    optionsTikz?: string | string[]\n    mainlevee?: boolean\n    amplitude?: number\n    style?: string\n    id?: string\n    usePgfplots?: boolean\n    centerLatex?: boolean\n  } = {},\n  ...objets: NestedObjetMathalea2dArray\n) {\n  const ajouteCodeHtml = (\n    mainlevee: boolean,\n    objets: ObjetMathalea2D | NestedObjetMathalea2dArray,\n    divsLatex: string[],\n    xmin: number,\n    ymax: number,\n  ) => {\n    let codeSvg = ''\n    // Dans le cas d'objets composites avec des objets Mathalea2d et des divLatex, il faut que ces objets exposent une proprit objets qui contient la liste des objets qui les composent.\n    // Cette list est substitue  l'objet ici\n    if (objets instanceof ObjetMathalea2D) {\n      if (objets.objets != null) {\n        objets = objets.objets as ObjetMathalea2D[]\n      }\n    } // c'est un objet compos d'objets. Exemple : Repere\n    if (!Array.isArray(objets) && objets != null) {\n      try {\n        const objet = objets as ObjetMathalea2D\n        if (!mainlevee || typeof objet?.svgml === 'undefined') {\n          if (objet?.svg) {\n            const code = objet.svg(pixelsParCm)\n            if (typeof code === 'string') {\n              codeSvg = '\\t' + objet.svg(pixelsParCm) + '\\n'\n            } else {\n              const codeLatex = code as ObjetDivLatex\n              // on a  faire  un divLatex.\n              if (typeof codeLatex !== 'object') {\n                window.notify(\n                  \"Dans mathalea2d, la mthode svg() de l'objet a renvoy quelque chose d'inconnu\",\n                  { codeLatex },\n                )\n                return codeSvg\n              }\n              const xSvg = (codeLatex.x - xmin) * pixelsParCm * zoom\n              const ySvg = -(codeLatex.y - ymax) * pixelsParCm * zoom\n\n              codeLatex.backgroundColor = codeLatex.backgroundColor\n                .replace('{', '')\n                .replace('}', '')\n              codeLatex.color = codeLatex.color\n                .replace('{', '')\n                .replace('}', '')\n\n              const divOuterHtml =\n                codeLatex.backgroundColor !== '' &&\n                codeLatex.backgroundColor !== 'none'\n                  ? `<div class=\"divLatex\" style=\"background-color: ${codeLatex.backgroundColor}; position: absolute; top: ${ySvg}px; left: ${xSvg}px; transform: translate(-50%,-50%) rotate(${-codeLatex.orientation}deg); opacity: ${codeLatex.opacity};\" data-top=${ySvg} data-left=${xSvg}>${katex.renderToString('\\\\' + codeLatex.letterSize + ' {\\\\color{' + codeLatex.color + '}{' + codeLatex.latex + '}}')}</div>`\n                  : `<div class=\"divLatex\" style=\"position: absolute; top: ${ySvg}px; left: ${xSvg}px; transform: translate(-50%,-50%) rotate(${-codeLatex.orientation}deg); opacity: ${codeLatex.opacity};\" data-top=${ySvg} data-left=${xSvg}>${katex.renderToString('{\\\\color{' + codeLatex.color + '} \\\\' + codeLatex.letterSize + '{' + codeLatex.latex + '}}')}</div>`\n              divsLatex.push(divOuterHtml)\n            }\n          } else {\n            window.notify(\n              'Un problme avec ce mathalea2d, la liste des objets contient un truc louche',\n              { objets: JSON.stringify(objets) },\n            )\n          }\n        } else {\n          if (objet?.svgml) {\n            codeSvg = '\\t' + objet.svgml(pixelsParCm, amplitude) + '\\n'\n          }\n        }\n      } catch (error: unknown) {\n        window.notify(\n          error instanceof Error ? (error as Error).message : String(error),\n          { objet: JSON.stringify(objets) },\n        )\n      }\n    } else {\n      if (objets != null && Array.isArray(objets)) {\n        for (const objet of objets) {\n          codeSvg += ajouteCodeHtml(mainlevee, objet, divsLatex, xmin, ymax)\n        }\n      } else {\n        window.notify(\n          'Un problme avec ce mathalea2d, la liste des objets contient un truc louche',\n          { objets: JSON.stringify(objets) },\n        )\n      }\n    }\n    return codeSvg\n  }\n  const ajouteCodeTikz = (\n    mainlevee: boolean,\n    objets: ObjetMathalea2D | NestedObjetMathalea2dArray,\n    skipRepere = false,\n    axisYMin?: number,\n    axisYMax?: number,\n  ) => {\n    let codeTikz = ''\n    // Skip Repere objects when using pgfplots (pgfplots handles axis/grid)\n    // Check BEFORE expanding objets.objets\n    if (\n      skipRepere &&\n      objets instanceof ObjetMathalea2D &&\n      objets.constructor.name === 'Repere'\n    ) {\n      return codeTikz\n    }\n    // Don't expand Courbe objects when using pgfplots (they handle their own tikz output)\n    // Check BEFORE expanding objets.objets\n    const shouldNotExpand =\n      objets instanceof ObjetMathalea2D &&\n      objets.constructor.name === 'Courbe' &&\n      (objets as any).usePgfplots === true\n    if (objets instanceof ObjetMathalea2D) {\n      if (objets.objets != null && !shouldNotExpand) {\n        objets = objets.objets as ObjetMathalea2D[]\n      }\n    } // c'est un objet compos d'objets. Exemple : Repere\n    if (!Array.isArray(objets)) {\n      try {\n        if (!mainlevee || typeof objets.tikzml === 'undefined') {\n          if (typeof objets.tikz === 'function') {\n            // Pass axis bounds to Courbe's tikz method\n            if (\n              objets.constructor.name === 'Courbe' &&\n              (objets as any).usePgfplots === true\n            ) {\n              codeTikz = '\\t' + objets.tikz(axisYMin, axisYMax) + '\\n'\n            } else {\n              codeTikz = '\\t' + objets.tikz() + '\\n'\n            }\n          }\n        } else {\n          if (typeof objets.tikzml === 'function') {\n            codeTikz = '\\t' + objets.tikzml(amplitude) + '\\n'\n          }\n        }\n      } catch (error: unknown) {\n        console.log(error instanceof Error ? error.message : String(error))\n      }\n    } else {\n      for (const objet of objets) {\n        codeTikz += ajouteCodeTikz(\n          mainlevee,\n          objet,\n          skipRepere,\n          axisYMin,\n          axisYMax,\n        )\n      }\n    }\n    return codeTikz\n  }\n  // On prpare le code HTML\n  const divsLatex: string[] = []\n  let codeSvg = `<svg class=\"mathalea2d\" ${style} ${id !== '' ? `id=\"${id}\"` : ''}\" width=\"${(xmax - xmin) * pixelsParCm * zoom}\" height=\"${\n    (ymax - ymin) * pixelsParCm * zoom\n  }\" viewBox=\"${xmin * pixelsParCm} ${-ymax * pixelsParCm} ${\n    (xmax - xmin) * pixelsParCm\n  } ${(ymax - ymin) * pixelsParCm}\" xmlns=\"http://www.w3.org/2000/svg\" >\\n`\n  codeSvg += ajouteCodeHtml(mainlevee, objets, divsLatex, xmin, ymax)\n  codeSvg += '\\n</svg>'\n  codeSvg = codeSvg.replace(/\\\\thickspace/gm, ' ')\n  const codeHTML = `<div class=\"svgContainer\" ${style ? `style=\"${style}\"` : ''}>\n        <div ${id !== '' ? `id=\"M2D${id}\"` : ''} style=\"position: relative;${style}\">\n          ${codeSvg}\n          ${divsLatex.join('\\n')}\n        </div>\n      </div>`\n  // On prpare le code Latex\n  // si scale existe autre que 1 il faut que le code reste comme avant\n  // sinon on ajoute scale quoi qu'il en soit quitte  ce que xscale et yscale viennent s'ajouter\n  // de cette manire d'autres options Tikz pourront aussi tre ajoutes\n  // si il n'y a qu'une optionsTikz on peut passer un string\n  let codeTikz\n  const listeOptionsTikz: string[] = []\n  if (optionsTikz !== undefined) {\n    if (typeof optionsTikz === 'string') {\n      listeOptionsTikz.push(optionsTikz)\n    } else {\n      optionsTikz.forEach((e) => listeOptionsTikz.push(e))\n    }\n  }\n\n  if (usePgfplots) {\n    // Use pgfplots with axis environment instead of tikzpicture\n    codeTikz = centerLatex ? '{\\\\centering\\n' : ''\n    codeTikz += '\\\\begin{tikzpicture}[baseline'\n    for (let l = 0; l < listeOptionsTikz.length; l++) {\n      codeTikz += `,${listeOptionsTikz[l]}`\n    }\n    if (scale !== 1) {\n      codeTikz += `,scale = ${scale}`\n    }\n    codeTikz += ']\\n'\n    codeTikz += '\\\\begin{axis}[\\n'\n    codeTikz += `  xmin=${xmin}, xmax=${xmax},\\n`\n    codeTikz += `  ymin=${ymin}, ymax=${ymax},\\n`\n    codeTikz += '  axis lines=middle,\\n'\n    codeTikz += '  axis line style={-Stealth},\\n'\n    codeTikz += '  xlabel={},\\n'\n    codeTikz += '  ylabel={},\\n'\n    codeTikz += '  xtick distance=2,\\n'\n    codeTikz += '  ytick distance=2,\\n'\n    codeTikz += '  minor tick num=1,\\n'\n    codeTikz += '  grid=both,\\n'\n    codeTikz += '  grid style={line width=.1pt, draw=gray!30},\\n'\n    codeTikz += '  major grid style={line width=.2pt,draw=gray!50},\\n'\n    codeTikz += '  tick label style={font=\\\\scriptsize},\\n'\n    codeTikz += '  every axis plot/.append style={line width=1pt},\\n'\n    codeTikz += '  clip=true,\\n'\n    codeTikz += ']\\n'\n    // code += codeTikz(...objets)\n    codeTikz += ajouteCodeTikz(mainlevee, objets, true, ymin, ymax) // Skip Repere when using pgfplots, pass axis bounds\n    codeTikz += '\\\\end{axis}\\n'\n    codeTikz += '\\\\end{tikzpicture}'\n    if (centerLatex) codeTikz += '\\\\par}'\n  } else {\n    // Standard tikzpicture behavior\n    codeTikz = centerLatex ? '{\\\\centering\\n' : ''\n    if (scale === 1) {\n      codeTikz += '\\\\begin{tikzpicture}[baseline'\n      for (let l = 0; l < listeOptionsTikz.length; l++) {\n        codeTikz += `,${listeOptionsTikz[l]}`\n      }\n      codeTikz += ']\\n'\n    } else {\n      codeTikz += '\\\\begin{tikzpicture}[baseline'\n      for (let l = 0; l < listeOptionsTikz.length; l++) {\n        codeTikz += `,${listeOptionsTikz[l]}`\n      }\n      codeTikz += `,scale = ${scale}`\n      codeTikz += ']\\n'\n    }\n\n    codeTikz += `\n    \\\\tikzset{\n      point/.style={\n        thick,\n        draw,\n        cross out,\n        inner sep=0pt,\n        minimum width=5pt,\n        minimum height=5pt,\n      },\n    }\n    \\\\clip (${xmin},${ymin}) rectangle (${xmax},${ymax});\n    `\n    // code += codeTikz(...objets)\n    codeTikz += ajouteCodeTikz(mainlevee, objets)\n    codeTikz += '\\n\\\\end{tikzpicture}'\n    if (centerLatex) codeTikz += '\\\\par}'\n  }\n\n  if (style.includes('display: block') && !centerLatex) codeTikz += '\\\\\\\\\\n'\n  if (context.isHtml) return codeHTML\n  else return codeTikz\n}\n\nexport class Vide2d extends ObjetMathalea2D {\n  x: number\n  y: number\n  constructor(x: number, y: number) {\n    super()\n    this.x = x\n    this.y = y\n    this.bordures = [x, y, x, y]\n    this.tikz = () => ''\n    this.svg = () => ''\n  }\n}\n\n/**\n * Un objet pour rien mettre  la place de quelque chose.\n * @param x\n * @param y\n * @returns {Vide2d}\n */\nexport function vide2d(x = 0, y = 0) {\n  return new Vide2d(x, y)\n}\n\n/**\n * convertHexToRGB convertit une couleur en hexadcimal (sans le #) en un tableau RVB avec des valeurs entre 0 et 255.\n * @param {string} [couleur='000000'] Code couleur HTML sans le #\n * @example convertHexToRGB('f15929')=[241,89,41]\n * @author Eric Elter\n * @return {number[]}\n */\n// JSDOC Validee par EE Juin 2022\nfunction convertHexToRGB(couleur = '000000') {\n  const hexDecoupe = couleur.match(/.{1,2}/g)\n  if (hexDecoupe !== null && hexDecoupe.length === 3) {\n    return [\n      Number.parseInt(hexDecoupe[0], 16),\n      Number.parseInt(hexDecoupe[1], 16),\n      Number.parseInt(hexDecoupe[2], 16),\n    ]\n  } else {\n    window.notify(\n      'Une couleur est mal forme. Veuillez le signaler aux dveloppeurs de MathALEA.',\n      { couleur },\n    )\n    return [0, 0, 0]\n  }\n}\n\nexport function convertColorWithDieseToLatex(color: string) {\n  if (!color.startsWith('#')) return color\n  const rgb = convertHexToRGB(color.replace('#', ''))\n  return '{rgb,255:red,' + rgb[0] + ';green,' + rgb[1] + ';blue,' + rgb[2] + '}'\n}\n/**\n * colorToLatexOrHTML prend en paramtre une couleur sous forme prdfinie ('red','yellow',...) ou sous forme HTML en hexadcimal (avec #, genre '#f15929')\n * La sortie de cette fonction est un tableau o :\n * - le premier lment est cette couleur exploitable en SVG, donc en HTML.\n * - le second lment est cette couleur exploitable en TikZ, donc en Latex.\n * @param {string} couleur Une couleur du type 'blue' ou du type '#f15929'\n * @example colorToLatexOrHTML('red')=['red','{red}']\n * @example colorToLatexOrHTML('#f15929')=['#f15929','{rgb,255:red,241;green,89;blue,41}']\n * @example colorToLatexOrHTML('')=''\n * @example colorToLatexOrHTML('none')=['none','none']\n * @author Eric Elter\n * @return {[string,string]}\n */\n// JSDOC Validee par EE Juin 2022\nexport function colorToLatexOrHTML(couleur: string): [string, string] {\n  // let rgb = []\n  if (Array.isArray(couleur) && couleur.length === 2) {\n    if (couleur[1] === 'none') couleur[1] = '' // pas de 'none' comme couleur en latex !\n    if (couleur.length === 2) {\n      return [String(couleur[0]), String(couleur[1])]\n    } else {\n      window.notify(\n        'Une couleur est mal forme. Veuillez le signaler aux dveloppeurs de MathALEA.',\n        { couleur },\n      )\n      return ['', '']\n    }\n    // Si jamais une fonction rappelle une couleur qui aurait dj t transforme par cette mme fonction\n    // else if (couleur === undefined || couleur === '') return '' // EE : 01/10/2023 : Code comment au profit de celui de dessus pour vrifier si une couleur nulle se ballade dans le projet.\n  } else if (couleur === undefined || couleur === '') {\n    window.notify(\n      'Une couleur est undefined ou bien une chaine vide. Veuillez le signaler aux dveloppeurs de MathALEA.',\n      { couleur },\n    )\n    return ['', '']\n  } else if (couleur === 'none') {\n    return ['none', ''] // 'none' n'est pas une couleur valide en latex ! Modifi par Jean-Claude Lhote le 19:&:\"\n  } else {\n    const tabCouleur: string[] = []\n    tabCouleur[0] = couleur\n    if (couleur[0] === '#') {\n      tabCouleur[1] = convertColorWithDieseToLatex(couleur)\n    } else {\n      tabCouleur[1] = `{${couleur}}`.replace('{{', '{').replace('}}', '}')\n    }\n    return tabCouleur.slice(0, 2) as [string, string]\n  }\n}\n\n/**\n * Convertit un code couleur en sa valeur hexadecimale\n * @param {string} color Une couleur du type 'blue' et uniquement de ce type\n * @example convertCodeCouleurToHex('beige')='#f5f5dc'\n * @author Eric Elter\n * @return {boolean||string} Retourne false si le code couleur ne peut pas tre converti car non trouv dans la liste\n */\n// JSDOC Validee par EE Novembre 2022\nexport function convertCodeCouleurToHex(color: ColourNames) {\n  if (typeof colours[color] !== 'undefined') {\n    return colours[color]\n  }\n  window.notify(\n    'La couleur ' +\n      color +\n      \" n'a pas t trouve dans la liste des couleurs prdfinies.\",\n    { color },\n  )\n  return '#ffffff'\n}\n\n/**\n * Assombrit ou claircit une couleur\n * @param {string} couleur Une couleur du type 'blue' ou du type '#f15929'\n * @param {number} coefficient Plus grand est un coefficient positif et plus on claircit. Plus petit est un coefficient ngatif et plus on assombrit.\n * @example assombrirOuEclaircir('beige',20) renvoie une couleur beige plus claire.\n * @example assombrirOuEclaircir('f15929',-30) renvoie une couleur orange plus fonce.\n * @author Eric Elter\n * @return {string} Retourne le code hexadecimal de la nouvelle couleur\n */\n// JSDOC Validee par EE Novembre 2022\nexport function assombrirOuEclaircir(\n  couleur: ColourNames,\n  coefficient: number,\n) {\n  let convertCodeCouleur = convertCodeCouleurToHex(couleur) ?? couleur\n  convertCodeCouleur = convertCodeCouleur.replace('#', '')\n  if (convertCodeCouleur.length === 6) {\n    const decimalColor = Number.parseInt(convertCodeCouleur, 16)\n    let r = (decimalColor >> 16) + coefficient\n    r > 255 && (r = 255)\n    r < 0 && (r = 0)\n    let g = (decimalColor & 0x0000ff) + coefficient\n    g > 255 && (g = 255)\n    g < 0 && (g = 0)\n    let b = ((decimalColor >> 8) & 0x00ff) + coefficient\n    b > 255 && (b = 255)\n    b < 0 && (b = 0)\n    return `#${(g | (b << 8) | (r << 16)).toString(16)}`\n  } else {\n    return convertCodeCouleur\n  }\n}\n\n/*\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%% LES FONCTIONS - FORMATAGE %%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n*/\n\n/**\n * codeSvg(segment(A,B),polygone(D,E,F),labelPoints(A,B))\n *\n * @author Rmi Angot\n * @private\n */\n// JSDOC Validee par EE Juin 2022\n/* Ce code n'est plus utilis : il l'tait dans l'diteur 2d\n\nexport function codeSvg (fenetreMathalea2d, pixelsParCm, mainlevee, ...objets) {\n  let code\n  const fenetrexmin = fenetreMathalea2d[0]\n  const fenetreymin = -fenetreMathalea2d[3]\n  const fenetrexmax = fenetreMathalea2d[2]\n  const fenetreymax = -fenetreMathalea2d[1]\n\n  code = `<svg width=\"${(fenetrexmax - fenetrexmin) * pixelsParCm}\" height=\"${(fenetreymax - fenetreymin) * pixelsParCm}\" viewBox=\"${fenetrexmin * pixelsParCm} ${fenetreymin * pixelsParCm} ${(fenetrexmax - fenetrexmin) * pixelsParCm} ${(fenetreymax - fenetreymin) * pixelsParCm}\" xmlns=\"http://www.w3.org/2000/svg\">\\n`\n  for (const objet of objets) {\n    if (Array.isArray(objet)) {\n      for (let i = 0; i < objet.length; i++) {\n        try {\n          if (!mainlevee || typeof objet[i].svgml === 'undefined') { code += '\\t' + objet[i].svg(pixelsParCm) + '\\n' } else {\n            code += '\\t' + objet[i].svgml(pixelsParCm, context.amplitude) + '\\n'\n          }\n        } catch (error) {\n          console.log(error.message)\n        }\n      }\n    }\n    try {\n      if (!mainlevee || typeof objet.svgml === 'undefined') { code += '\\t' + objet.svg(pixelsParCm) + '\\n' } else code += '\\t' + objet.svgml(pixelsParCm, context.amplitude) + '\\n'\n    } catch (error) {\n      console.log(error.message)\n    }\n  }\n  code += '</svg>'\n  return code\n}\n*/\n\n/**\n * codeTikz(segment(A,B),polygone(D,E,F),labelPoints(A,B))\n *\n * @author Rmi Angot\n * @private\n */\n/* Ce code n'est plus utilis : il l'tait dans l'diteur 2d\n// JSDOC Validee par EE Juin 2022\nexport function codeTikz (fenetreMathalea2d, scale, mainlevee, ...objets) {\n  let code = ''\n  const fenetrexmin = fenetreMathalea2d[0]\n  const fenetreymin = fenetreMathalea2d[3] * -1\n  const fenetrexmax = fenetreMathalea2d[2]\n  const fenetreymax = fenetreMathalea2d[1] * -1\n  const sortie = context.isHtml\n\n  context.isHtml = false\n  if (scale === 1) {\n    code += '\\\\begin{tikzpicture}[baseline]\\n'\n  } else {\n    code += `\\\\begin{tikzpicture}[baseline,scale = ${scale.toFixed(2)}]\\n`\n  }\n  code += `\\\\tikzset{\n    point/.style={\n      thick,\n      draw,\n      cross out,\n      inner sep=0pt,\n      minimum width=5pt,\n      minimum height=5pt,\n    },\n  }\n  \\\\clip (${fenetrexmin},${fenetreymin}) rectangle (${fenetrexmax},${fenetreymax});\n\n  \\n\\n`\n\n  for (const objet of objets) {\n    if (Array.isArray(objet)) {\n      for (let i = 0; i < objet.length; i++) {\n        try {\n          if (!mainlevee || typeof objet[i].tikzml === 'undefined') { code += '\\t' + objet[i].tikz(scale) + '\\n' } else code += '\\t' + objet[i].tikzml(context.amplitude) + '\\n'\n        } catch (error) {\n          console.log(error.message)\n        }\n      }\n    }\n    try {\n      if (!mainlevee || typeof objet.tikzml === 'undefined') { code += '\\t' + objet.tikz(scale) + '\\n' } else code += '\\t' + objet.tikzml(context.amplitude) + '\\n'\n    } catch (error) {\n      console.log(error.message)\n    }\n  }\n  code += '\\\\end{tikzpicture}\\n'\n\n  context.isHtml = sortie\n  return code\n}\n*/\n\n/**\n * @param {object} options\n * @param {number} [options.rxmin] marge  gauche 0.5 par dfaut (peut tre fixe  0 si on veut)\n * @param {number} [options.rxmax] marge  droite 0.5 par dfaut\n * @param {number} [options.rymin] marge en bas 0.5 par dfaut (peut tre fixe  0 si on veut)\n * @param {number} [options.rymax] marge en haut 0.5 par dfaut\n * @param {number} [options.rzoom] facteur multiplicatif des marges... implment en cas de problme avec le zoom ?\n * @param {object} objets // tableau contenant les objets  afficher\n * Les objets affichables doivent avoir un attribut this.bordures = [xmin, ymin, xmax, ymax] 4 nombres dans cet ordre.\n * Si this.bordures n'est pas dfini ou n'est pas un tableau de 4 lments, l'objet est ignor\n * Si aucun objet pass en argument n'a de \"bordures\" alors la fonction retourne une zone inaffichable et un message d'erreur est cr\n * @return {{xmin: number, ymin:number, xmax:number, ymax:number}}\n */\nexport function fixeBordures(\n  objets: NestedObjetMathalea2dArray,\n  { rxmin = -0.5, rymin = -0.5, rxmax = 0.5, rymax = 0.5, rzoom = 1 } = {},\n) {\n  /**\n   *\n   * @param{number} xmin\n   * @param{number} ymin\n   * @param{number} xmax\n   * @param{number} ymax\n   * @param objets\n   * @param bordures\n   * @returns {[number,number,number,number,boolean]}\n   */\n  const majBordures: (\n    xmin: number,\n    ymin: number,\n    xmax: number,\n    ymax: number,\n    objets: ObjetMathalea2D | NestedObjetMathalea2dArray,\n    borduresTrouvees: boolean,\n  ) => [number, number, number, number, boolean] = (\n    xmin: number,\n    ymin: number,\n    xmax: number,\n    ymax: number,\n    objets: ObjetMathalea2D | NestedObjetMathalea2dArray,\n    borduresTrouvees: boolean,\n  ) => {\n    if (objets == null) return [xmin, ymin, xmax, ymax, borduresTrouvees]\n    if (!Array.isArray(objets)) {\n      const bordures = objets.bordures ?? null\n      if (bordures === null || isNaN(bordures[0])) {\n        window.notify(\n          `l y a un problme avec les bordures de ${objets.constructor.name}... elles ne sont pas dfinies !`,\n          { objets },\n        )\n      } else if (!Array.isArray(bordures)) {\n        window.notify(\n          `Les bordures de ${objets.constructor.name} ne sont pas un array : ${JSON.stringify(bordures)}`,\n          { ...objets },\n        )\n      } else if (bordures.filter((el) => isNaN(el)).length > 0) {\n        window.notify(\n          `Les bordures de ${objets.constructor.name} sont bien un array mais contiennent autre chose que des nombres : ${bordures}`,\n          { ...objets },\n        )\n      } else {\n        xmin = Math.min(xmin, bordures[0])\n        xmax = Math.max(xmax, bordures[2])\n        ymin = Math.min(ymin, bordures[1])\n        ymax = Math.max(ymax, bordures[3])\n        borduresTrouvees = true\n      }\n    } else {\n      for (const objet of objets) {\n        ;[xmin, ymin, xmax, ymax, borduresTrouvees] = majBordures(\n          xmin,\n          ymin,\n          xmax,\n          ymax,\n          objet,\n          borduresTrouvees,\n        )\n      }\n    }\n    return [xmin, ymin, xmax, ymax, borduresTrouvees]\n  }\n  let xmin = 1000\n  let ymin = 1000\n  let xmax = -1000\n  let ymax = -1000\n  let borduresTrouvees = false\n  ;[xmin, ymin, xmax, ymax, borduresTrouvees] = majBordures(\n    xmin,\n    ymin,\n    xmax,\n    ymax,\n    objets,\n    borduresTrouvees,\n  )\n  if (!borduresTrouvees) {\n    window.notify('fixeBordures : aucun objet ne dfinit de bordures valides', {\n      ...objets,\n    })\n  }\n  return {\n    xmin: xmin + rxmin * rzoom,\n    xmax: xmax + rxmax * rzoom,\n    ymin: ymin + rymin * rzoom,\n    ymax: ymax + rymax * rzoom,\n  }\n}\n","import { isArray, isInteger } from 'mathjs'\nimport { context } from '../../modules/context'\nimport { choice } from './arrayOutils'\nimport FractionEtendue from '../../modules/FractionEtendue'\n\n/**\n * Met en couleur et en gras\n *\n * Met en couleur et gras un texte. JCL dit : \"S'utilise entre $ car utilise des commandes qui fonctionnent en math inline\"\n * @param {string|number} texte  mettre en couleur\n * @param {string} couleur en anglais ou code couleur hexadcimal par dfaut c'est le orange de CoopMaths\n * @author Rmi Angot\n */\nexport function miseEnEvidence(\n  texte: string | FractionEtendue | number,\n  couleur: string = '#f15929',\n) {\n  if (texte instanceof FractionEtendue) texte = texte.texFraction\n  if (typeof texte === 'number') texte = String(texte)\n  if (isArray(couleur)) couleur = couleur[0]\n  if (context.isHtml) {\n    return `{\\\\color{${couleur}}\\\\boldsymbol{${texte}}}`\n  } else {\n    if (couleur[0] === '#') {\n      return `{\\\\color[HTML]{${couleur.replace('#', '')}}\\\\boldsymbol{${texte}}}`\n    } else if (couleur === 'green') {\n      return `{\\\\color[HTML]{008002}\\\\boldsymbol{${texte}}}`\n    } else {\n      return `{\\\\color{${couleur.replace('#', '')}}\\\\boldsymbol{${texte}}}`\n    }\n  }\n}\n\n/**\n * Met en vidence un seul chiffre dun nombre au format LaTeX, en le coloriant et le mettant en gras.\n *\n * - Si le texte contient une virgule, la fonction identifie la partie entire ( gauche)\n *   et la partie dcimale ( droite), puis colore le chiffre selon la position demande.\n * - Si le texte ne contient pas de virgule, seul un chiffre de la partie entire est cibl.\n *\n * @param {string | FractionEtendue | number} texte - Le nombre ou texte  analyser.\n *   Peut tre :\n *   - une chane (ex. \"123,45\")\n *   - un nombre (ex. 123.45)\n *   - une instance de `FractionEtendue` (sa proprit `texFraction` sera utilise)\n *\n * @param {string} [couleur='#f15929'] - Couleur  utiliser pour le chiffre mis en vidence.\n *   Peut tre un nom de couleur LaTeX (ex. `\"red\"`) ou un code hexadcimal (ex. `\"#FF0000\"`).\n *\n * @param {number} [position=1] - La position du chiffre  mettre en vidence :\n *   - `0.001`  3e chiffre  droite de la virgule (millime)\n *   - `0.01`   2e chiffre  droite de la virgule (centime)\n *   - `0.1`    1er chiffre  droite de la virgule (dixime)\n *   - `1`      chiffre immdiatement  gauche de la virgule (unit)\n *   - `10`     2e chiffre  gauche de la virgule (dizaine)\n *   - `100`    3e chiffre  gauche de la virgule (centaine)\n *   - `1000`   4e chiffre  gauche de la virgule (millier)\n * @author Eric Elter\n * @returns {string} Une chane LaTeX avec un seul chiffre mis en couleur et en gras.\n *   Le reste du nombre est laiss tel quel.\n */\n\nexport function coloreUnSeulChiffre(\n  texte: string | FractionEtendue | number,\n  couleur: string = '#f15929',\n  position: number = 1,\n): string {\n  if (texte instanceof FractionEtendue) texte = texte.texFraction\n  if (typeof texte === 'number') texte = String(texte)\n  if (Array.isArray(couleur)) couleur = couleur[0]\n\n  const getColorLatex = (contenu: string): string => {\n    if (context.isHtml) {\n      return `\\\\color{${couleur}}\\\\boldsymbol{${contenu}}`\n    } else if (couleur === 'green') {\n      return `\\\\color[HTML]{008002}\\\\boldsymbol{${contenu}}`\n    } else if (couleur.startsWith('#')) {\n      return `\\\\color[HTML]{${couleur.slice(1)}}\\\\boldsymbol{${contenu}}`\n    } else {\n      return `\\\\color{${couleur}}\\\\boldsymbol{${contenu}}`\n    }\n  }\n\n  const indexGauche = new Map<number, number>([\n    [1, -1], // units\n    [10, -2], // dizaines\n    [100, -3], // centaines\n    [1000, -6], // milliers -6  cause du sparateur de milliers\n  ])\n\n  const indexDroite = new Map<number, number>([\n    [0.1, 0], // diximes\n    [0.01, 1], // centimes\n    [0.001, 2], // millimes\n  ])\n\n  const estDroite = position < 1\n  const index = estDroite\n    ? indexDroite.get(position)\n    : indexGauche.get(position)\n  if (index === undefined) return texte // scurit\n\n  // Cas avec virgule\n  if (texte.includes('{,}')) {\n    const [partieEntiere, partieDecimale] = texte.split('{,}')\n\n    if (estDroite) {\n      if (index >= partieDecimale.length) return texte\n      const avant = partieDecimale.slice(0, index)\n      const chiffreCible = partieDecimale.charAt(index)\n      const apres = partieDecimale.slice(index + 1)\n      const colored = getColorLatex(chiffreCible)\n      return `\\\\boldsymbol{${partieEntiere}{,}${avant}}{${colored}}\\\\boldsymbol{${apres}}`\n    } else {\n      const pos = partieEntiere.length + index\n      if (pos < 0 || pos >= partieEntiere.length) return texte\n      const prefixe = partieEntiere.slice(0, pos)\n      const chiffreCible = partieEntiere.charAt(pos)\n      const suffixe = partieEntiere.slice(pos + 1)\n      const colored = getColorLatex(chiffreCible)\n\n      return `\\\\boldsymbol{${prefixe}}{${colored}}\\\\boldsymbol{${suffixe}{,}${partieDecimale}}`\n    }\n  }\n\n  // Cas sans virgule\n  const partieEntiere = texte\n  if (estDroite) {\n    // Pas de partie dcimale  on ne peut pas accder  des chiffres  droite\n    return texte\n  } else {\n    const pos = partieEntiere.length + index\n    if (pos < 0 || pos >= partieEntiere.length) return texte\n    const prefixe = partieEntiere.slice(0, pos)\n    const chiffreCible = partieEntiere.charAt(pos)\n    const suffixe = partieEntiere.slice(pos + 1)\n    const colored = getColorLatex(chiffreCible)\n    return `\\\\boldsymbol{${prefixe}}{${colored}}\\\\boldsymbol{${suffixe}}`\n  }\n}\n\n/**\n * Met en couleur\n * Met en couleur un texte. JCL dit : \"S'utilise entre $ car utilise des commandes qui fonctionnent en math inline\"\n * @param {string} texte  mettre en couleur\n * @param {string} couleur en anglais ou code couleur hexadcimal par dfaut c'est le orange de CoopMaths\n * @author Guillaume Valmont d'apres MiseEnEvidence() de Rmi Angot\n */\nexport function miseEnCouleur(\n  texte: string | number,\n  couleur: string = '#f15929',\n) {\n  texte = typeof texte === 'number' ? String(texte) : texte\n  if (isArray(couleur)) couleur = couleur[0]\n  if (context.isHtml) {\n    return `{\\\\color{${couleur}} ${texte}}`\n  } else {\n    if (couleur[0] === '#') {\n      return `{\\\\color[HTML]{${couleur.replace('#', '')}} ${texte}}`\n    } else if (couleur === 'green') {\n      return `{\\\\color[HTML]{008002} ${texte}}`\n    } else {\n      return `{\\\\color{${couleur}} ${texte}}`\n    }\n  }\n}\n\n/**\n * Met en couleur un texte\n * @param {string} texte  mettre en couleur\n * @param {string} couleur en anglais ou code couleur hexadcimal par dfaut c'est le orange de CoopMaths\n * @author Rmi Angot\n */\nexport function texteEnCouleur(texte: string | number, couleur = '#f15929') {\n  texte = typeof texte === 'number' ? String(texte) : texte\n  if (isArray(couleur)) couleur = couleur[0]\n  if (context.isHtml) {\n    return `<span style=\"color:${couleur};\">${texte}</span>`\n  } else {\n    if (couleur[0] === '#') {\n      return `{\\\\color[HTML]{${couleur.replace('#', '')}}${texte}}`\n    } else if (couleur === 'green') {\n      return `{\\\\color[HTML]{008002} ${texte}}`\n    } else {\n      return `{\\\\color{${couleur.replace('#', '')}}${texte}}`\n    }\n  }\n}\n\n/**\n * Met en couleur et gras un texte. JCL dit : \"Ne fonctionne qu'en dehors de $....$\". Utiliser miseEnEvidence si $....$.\n * @param {string} texte  mettre en couleur\n * @param {string} couleur en anglais ou code couleur hexadcimal par dfaut c'est le orange de CoopMaths\n * @author Rmi Angot\n */\nexport function texteEnCouleurEtGras(\n  texte: string | number,\n  couleur = '#f15929',\n) {\n  if (typeof texte === 'number') texte = String(texte)\n  if (isArray(couleur)) couleur = couleur[0]\n  if (context.isHtml) {\n    return `<span style=\"color:${couleur};font-weight: bold;\">${texte}</span>`\n  }\n  if (couleur[0] === '#') {\n    return `{\\\\bfseries \\\\color[HTML]{${couleur.replace('#', '')}}${texte}}`\n  }\n  if (couleur === 'green') {\n    return `{\\\\bfseries \\\\color[HTML]{008002} ${texte}}`\n  }\n  return `{\\\\bfseries \\\\color{${couleur.replace('#', '')}}${texte}}`\n}\n\nexport function barreTexte(text: string) {\n  if (context.isHtml) {\n    return `<span class=\"oblique-strike\">${text}</span>`\n  } else {\n    return `\\\\strike{${text}}`\n  }\n}\n\n/**\n * couleurAleatoire() renvoie le code d'une couleur au hasard\n *\n * @author Rmi Angot\n */\nexport function couleurAleatoire() {\n  return choice([\n    'white',\n    'black',\n    'red',\n    'green',\n    'blue',\n    'cyan',\n    'magenta',\n    'yellow',\n  ])\n}\n\n/**\n * couleurTab() renvoie :\n * soit le code d'une couleur au hasard, ainsi que sa traduction franaise au masculin et au fminin,\n * soit le code d'une couleur impose, ainsi que sa traduction franaise au masculin et au fminin.\n * @example couleurTab() peut renvoyer ['black','noir','noire'].\n * @example couleurTab(0) renverra de faon certaine ['black','noir','noire'].\n * @author Eric Elter\n */\nexport function couleurTab(choixCouleur = 999) {\n  const panelCouleurs = [\n    ['black', 'noir', 'noire'],\n    ['red', 'rouge', 'rouge'],\n    ['green', 'vert', 'verte'],\n    ['blue', 'bleu', 'bleue'],\n    ['HotPink', 'rose', 'rose'],\n    ['Sienna', 'marron', 'marron'],\n    ['darkgray', 'gris', 'grise'],\n    ['DarkOrange', 'orange', 'orange'],\n  ]\n  return choixCouleur === 999 ||\n    choixCouleur >= panelCouleurs.length ||\n    !isInteger(choixCouleur)\n    ? choice(panelCouleurs)\n    : panelCouleurs[choixCouleur]\n}\n\nexport function arcenciel(i: number, fondblanc = true) {\n  let couleurs\n  if (fondblanc)\n    couleurs = ['violet', 'purple', 'blue', 'green', 'lime', '#f15929', 'red']\n  else\n    couleurs = ['violet', 'indigo', 'blue', 'green', 'yellow', '#f15929', 'red']\n  return couleurs[i % 7]\n}\n\nexport function texcolors(i: number, fondblanc = true) {\n  const couleurs = [\n    'black',\n    'blue',\n    'brown',\n    'green',\n    'cyan',\n    'darkgray',\n    'pink',\n    'orange',\n    'red',\n    'magenta',\n    'purple',\n    'violet',\n    'white',\n    'yellow',\n  ]\n  if (fondblanc && i % couleurs.length >= couleurs.length - 2) i += 2\n  return couleurs[i % couleurs.length]\n}\n\n/**\n * Met gras un texte\n * @param {string} texte  mettre en gras\n * @author Rmi Angot\n */\nexport function texteGras(texte: string) {\n  if (context.isHtml) {\n    return `<b>${texte}</b>`\n  } else {\n    return `\\\\textbf{${texte}}`\n  }\n}\n\n/**\n * Texte en italique\n */\nexport function texteItalique(texte: string) {\n  if (context.isHtml) {\n    return `<i>${texte}</i>`\n  } else {\n    return `\\\\textit{${texte}}`\n  }\n}\n\nexport function blocCode(texte: string) {\n  if (context.isHtml) {\n    return `<pre style=\"background-color: #f0f0f0; border: 1px solid #ccc; border-radius: 4px; padding: 10px; font-family: Courier New, monospace; white-space: pre-wrap;\">\n    ${texte}</pre>`\n  }\n  return `\\\\fbox{\n    \\\\parbox{0.5\\\\linewidth}{\n    \\\\setlength{\\\\parskip}{.5cm}\n    \\\\texttt{${texte}\n    }\n    }\\\\newline`\n}\n\nexport function texteCode(texte: string) {\n  if (context.isHtml) {\n    return `<span style=\"background-color: #f0f0f0; border: 1px solid #ccc; border-radius: 4px; font-family: Courier New, monospace; white-space: pre-wrap;\">${texte}</span>`\n  }\n  return `\\\\colorbox{lightgray}{\\\\texttt{${texte}}}`\n}\n\nexport function texteEnBoite(texte: string) {\n  if (context.isHtml) {\n    return `<div style=\"display: inline-block; max-width: fit-content; border: 2px solid #444; border-radius: 4px; padding: 10px;\">${texte}</div>`\n  }\n  return `\\\\fbox{\\\\parbox{0.5\\\\linewidth}{\\\\setlength{\\\\parskip}{.5cm}${texte}}}\\\\newline`\n}\n","import { lcm } from 'mathjs'\nimport { listeDesDiviseurs } from '../lib/outils/primalite'\n\nfunction ppcm([...n]) {\n  return parseInt(lcm(...n))\n}\n\n/**\n * Trie la liste pour la retourner dans l'ordre croissant\n * @private\n * @param {Fraction[]} liste\n * @return {Fraction[]}\n */\nconst sortFractions = (liste) =>\n  liste.slice().sort((f1, f2) => f1.valeurDecimale - f2.valeurDecimale)\n\n/**\n * Classe ListeFraction qui propose des mthodes utiles sur les collections de fractions\n * @author Jean-Claude Lhote sur une ide de Sbastien Lozano\n */\nclass ListeFraction {\n  constructor(...fractions) {\n    /**\n     * La liste des fractions passes au constructeur (une par argument)\n     * @type {Fraction[]}\n     */\n    this.liste = fractions\n    /**\n     * @typedef listeNombres\n     * @type {number[]}\n     */\n    /**\n     * Les tableaux contenant les diviseurs diffrents de 1 de chaque dnominateur\n     * @type {listeNombres[]}\n     */\n    this.denominateurs_amis = []\n    let listetemp = []\n    const dens = []\n    this.liste.forEach((f) => {\n      dens.push(f.d)\n      listetemp = listeDesDiviseurs(f.d)\n      listetemp.splice(0, 1)\n      this.denominateurs_amis.push(listetemp)\n    })\n    const den = ppcm(dens)\n    /**\n     * La liste des fractions mises au mme dnominateur dans le mme ordre que this.liste\n     * @type {listeNombres[]}\n     */\n    this.listeMemeDenominateur = []\n    this.liste.forEach((f) => {\n      this.listeMemeDenominateur.push(f.reduire(Math.round(den / f.d)))\n    })\n\n    /**\n     * La liste de fraction range dans l'ordre croissant.\n     * @type {Fraction[]}\n     */\n    this.listeRangee = sortFractions(this.liste)\n    /**\n     * La liste des fractions mises au mme dnominateur par ordre croissant\n     * @type {Fraction[]}\n     */\n    this.listeRangeeMemeDenominateur = sortFractions(this.listeMemeDenominateur)\n    /**\n     * la liste des fractions simplifies (dans le mme ordre que celles fournies)\n     * @type {Fraction[]}\n     */\n    this.listeSimplifiee = this.liste.map((f) => f.simplifie())\n    /**\n     * la liste des fractions simplifies par ordre croissant\n     * @type {Fraction[]}\n     */\n    this.listeRangeeSimplifiee = sortFractions(this.listeSimplifiee)\n    /**\n     * La liste des fractions au format LaTeX, spares par ;\n     * @type {string}\n     */\n    this.texListe = this.liste.map((f) => f.texFraction).join(' ; ')\n  }\n\n  /**\n   * @todo virer cette mthode jamais utilise\n   * @param {...Fraction}\n   */\n  completeListe(...frac) {\n    const dens = [this.listeMemeDenominateur[0].d]\n    for (let i = 0; i < frac.length; i++) {\n      this.liste.push(frac[i])\n      dens.push(frac[i].d)\n      const listetemp = listeDesDiviseurs(frac[i].d)\n      listetemp.splice(0, 1)\n      this.denominateurs_amis.push(listetemp)\n    }\n    const den = ppcm(dens)\n    this.listeMemeDenominateur = []\n    for (let i = 0; i < this.liste.length; i++) {\n      this.listeMemeDenominateur.push(\n        this.liste[i].reduire(Math.round(den / this.liste[i].d)),\n      )\n    }\n    this.listeSimplifiee = []\n    for (let i = 0; i < this.liste.length; i++) {\n      this.listeSimplifiee.push(this.liste[i].simplifie())\n    }\n    this.texListe = ''\n    for (let i = 0; i < this.liste.length - 1; i++) {\n      this.texListe += this.liste[i].texFraction + ' ; '\n    }\n    this.texListe += this.liste[this.liste.length - 1].texFraction\n    this.listeRangee = sortFractions(this.liste) // La liste de fraction range dans l'ordre croissant.\n    this.listeRangeeMmeDenominateur = sortFractions(this.listeMemeDenominateur)\n    this.listeRangeeSimplifiee = sortFractions(this.listeSimplifiee)\n  }\n}\n\nexport default ListeFraction\n","import Decimal from 'decimal.js'\nimport { nombreDeChiffresDansLaPartieEntiere } from '../lib/outils/nombres'\nimport { estentier } from './outils'\n\nexport function nombreEnLettres(nb: number, type = 1) {\n  let partieEntiere, partieDecimale, nbstring, nbDec, decstring\n  if (estentier(nb)) return partieEntiereEnLettres(nb)\n  else {\n    partieEntiere = Math.floor(nb)\n    partieDecimale = new Decimal(nb).sub(partieEntiere).toDP(3)\n    nbDec = partieDecimale.toString().replace(/\\d*\\./, '').length\n    partieDecimale = partieDecimale.mul(10 ** nbDec).toNumber()\n\n    switch (nbDec) {\n      case 1:\n        if (partieDecimale > 1) decstring = ' diximes'\n        else decstring = ' dixime'\n        break\n      case 2:\n        if (partieDecimale > 1) decstring = ' centimes'\n        else decstring = ' centime'\n        break\n      case 3:\n        if (partieDecimale > 1) decstring = ' millimes'\n        else decstring = ' millime'\n        break\n    }\n\n    if (type === 1) {\n      nbstring =\n        partieEntiereEnLettres(partieEntiere) +\n        ' units et ' +\n        partieEntiereEnLettres(partieDecimale) +\n        decstring\n    } else if (nbDec === nombreDeChiffresDansLaPartieEntiere(partieDecimale)) {\n      nbstring =\n        partieEntiereEnLettres(partieEntiere) +\n        ' virgule ' +\n        partieEntiereEnLettres(partieDecimale)\n    } else {\n      nbstring = partieEntiereEnLettres(partieEntiere) + ' virgule '\n      for (\n        let n = 0;\n        n < nbDec - nombreDeChiffresDansLaPartieEntiere(partieDecimale);\n        n++\n      ) {\n        nbstring += 'zro-'\n      }\n      nbstring += partieEntiereEnLettres(partieDecimale)\n    }\n  }\n  return nbstring\n}\n\n/**\n *\n *\n * @param {int} nb\n\n *\n */\nexport function partieEntiereEnLettres(nb: number) {\n  if (nb === 0) return 'zro'\n  const dictionnaire = {\n    0: 'zro',\n    '000': '',\n    1: 'un',\n    2: 'deux',\n    3: 'trois',\n    4: 'quatre',\n    5: 'cinq',\n    6: 'six',\n    7: 'sept',\n    8: 'huit',\n    9: 'neuf',\n    10: 'dix',\n    11: 'onze',\n    12: 'douze',\n    13: 'treize',\n    14: 'quatorze',\n    15: 'quinze',\n    16: 'seize',\n    17: 'dix-sept',\n    18: 'dix-huit',\n    19: 'dix-neuf',\n    20: 'vingt',\n    21: 'vingt et un',\n    22: 'vingt-deux',\n    23: 'vingt-trois',\n    24: 'vingt-quatre',\n    25: 'vingt-cinq',\n    26: 'vingt-six',\n    27: 'vingt-sept',\n    28: 'vingt-huit',\n    29: 'vingt-neuf',\n    30: 'trente',\n    31: 'trente et un',\n    32: 'trente-deux',\n    33: 'trente-trois',\n    34: 'trente-quatre',\n    35: 'trente-cinq',\n    36: 'trente-six',\n    37: 'trente-sept',\n    38: 'trente-huit',\n    39: 'trente-neuf',\n    40: 'quarante',\n    41: 'quarante et un',\n    42: 'quarante-deux',\n    43: 'quarante-trois',\n    44: 'quarante-quatre',\n    45: 'quarante-cinq',\n    46: 'quarante-six',\n    47: 'quarante-sept',\n    48: 'quarante-huit',\n    49: 'quarante-neuf',\n    50: 'cinquante',\n    51: 'cinquante et un',\n    52: 'cinquante-deux',\n    53: 'cinquante-trois',\n    54: 'cinquante-quatre',\n    55: 'cinquante-cinq',\n    56: 'cinquante-six',\n    57: 'cinquante-sept',\n    58: 'cinquante-huit',\n    59: 'cinquante-neuf',\n    60: 'soixante',\n    61: 'soixante et un',\n    62: 'soixante-deux',\n    63: 'soixante-trois',\n    64: 'soixante-quatre',\n    65: 'soixante-cinq',\n    66: 'soixante-six',\n    67: 'soixante-sept',\n    68: 'soixante-huit',\n    69: 'soixante-neuf',\n    70: 'soixante-dix',\n    71: 'soixante et onze',\n    72: 'soixante-douze',\n    73: 'soixante-treize',\n    74: 'soixante-quatorze',\n    75: 'soixante-quinze',\n    76: 'soixante-seize',\n    77: 'soixante-dix-sept',\n    78: 'soixante-dix-huit',\n    79: 'soixante-dix-neuf',\n    80: 'quatre-vingts',\n    81: 'quatre-vingt-un',\n    82: 'quatre-vingt-deux',\n    83: 'quatre-vingt-trois',\n    84: 'quatre-vingt-quatre',\n    85: 'quatre-vingt-cinq',\n    86: 'quatre-vingt-six',\n    87: 'quatre-vingt-sept',\n    88: 'quatre-vingt-huit',\n    89: 'quatre-vingt-neuf',\n    90: 'quatre-vingt-dix',\n    91: 'quatre-vingt-onze',\n    92: 'quatre-vingt-douze',\n    93: 'quatre-vingt-treize',\n    94: 'quatre-vingt-quatorze',\n    95: 'quatre-vingt-quinze',\n    96: 'quatre-vingt-seize',\n    97: 'quatre-vingt-dix-sept',\n    98: 'quatre-vingt-dix-huit',\n    99: 'quatre-vingt-dix-neuf',\n    100: 'cent',\n    101: 'cent un',\n    102: 'cent deux',\n    103: 'cent trois',\n    104: 'cent quatre',\n    105: 'cent cinq',\n    106: 'cent six',\n    107: 'cent sept',\n    108: 'cent huit',\n    109: 'cent neuf',\n    110: 'cent dix',\n    111: 'cent onze',\n    112: 'cent douze',\n    113: 'cent treize',\n    114: 'cent quatorze',\n    115: 'cent quinze',\n    116: 'cent seize',\n    117: 'cent dix-sept',\n    118: 'cent dix-huit',\n    119: 'cent dix-neuf',\n    120: 'cent vingt',\n    121: 'cent vingt et un',\n    122: 'cent vingt-deux',\n    123: 'cent vingt-trois',\n    124: 'cent vingt-quatre',\n    125: 'cent vingt-cinq',\n    126: 'cent vingt-six',\n    127: 'cent vingt-sept',\n    128: 'cent vingt-huit',\n    129: 'cent vingt-neuf',\n    130: 'cent trente',\n    131: 'cent trente et un',\n    132: 'cent trente-deux',\n    133: 'cent trente-trois',\n    134: 'cent trente-quatre',\n    135: 'cent trente-cinq',\n    136: 'cent trente-six',\n    137: 'cent trente-sept',\n    138: 'cent trente-huit',\n    139: 'cent trente-neuf',\n    140: 'cent quarante',\n    141: 'cent quarante et un',\n    142: 'cent quarante-deux',\n    143: 'cent quarante-trois',\n    144: 'cent quarante-quatre',\n    145: 'cent quarante-cinq',\n    146: 'cent quarante-six',\n    147: 'cent quarante-sept',\n    148: 'cent quarante-huit',\n    149: 'cent quarante-neuf',\n    150: 'cent cinquante',\n    151: 'cent cinquante et un',\n    152: 'cent cinquante-deux',\n    153: 'cent cinquante-trois',\n    154: 'cent cinquante-quatre',\n    155: 'cent cinquante-cinq',\n    156: 'cent cinquante-six',\n    157: 'cent cinquante-sept',\n    158: 'cent cinquante-huit',\n    159: 'cent cinquante-neuf',\n    160: 'cent soixante',\n    161: 'cent soixante et un',\n    162: 'cent soixante-deux',\n    163: 'cent soixante-trois',\n    164: 'cent soixante-quatre',\n    165: 'cent soixante-cinq',\n    166: 'cent soixante-six',\n    167: 'cent soixante-sept',\n    168: 'cent soixante-huit',\n    169: 'cent soixante-neuf',\n    170: 'cent soixante-dix',\n    171: 'cent soixante et onze',\n    172: 'cent soixante-douze',\n    173: 'cent soixante-treize',\n    174: 'cent soixante-quatorze',\n    175: 'cent soixante-quinze',\n    176: 'cent soixante-seize',\n    177: 'cent soixante-dix-sept',\n    178: 'cent soixante-dix-huit',\n    179: 'cent soixante-dix-neuf',\n    180: 'cent quatre-vingts',\n    181: 'cent quatre-vingt-un',\n    182: 'cent quatre-vingt-deux',\n    183: 'cent quatre-vingt-trois',\n    184: 'cent quatre-vingt-quatre',\n    185: 'cent quatre-vingt-cinq',\n    186: 'cent quatre-vingt-six',\n    187: 'cent quatre-vingt-sept',\n    188: 'cent quatre-vingt-huit',\n    189: 'cent quatre-vingt-neuf',\n    190: 'cent quatre-vingt-dix',\n    191: 'cent quatre-vingt-onze',\n    192: 'cent quatre-vingt-douze',\n    193: 'cent quatre-vingt-treize',\n    194: 'cent quatre-vingt-quatorze',\n    195: 'cent quatre-vingt-quinze',\n    196: 'cent quatre-vingt-seize',\n    197: 'cent quatre-vingt-dix-sept',\n    198: 'cent quatre-vingt-dix-huit',\n    199: 'cent quatre-vingt-dix-neuf',\n    200: 'deux cents',\n    201: 'deux cent un',\n    202: 'deux cent deux',\n    203: 'deux cent trois',\n    204: 'deux cent quatre',\n    205: 'deux cent cinq',\n    206: 'deux cent six',\n    207: 'deux cent sept',\n    208: 'deux cent huit',\n    209: 'deux cent neuf',\n    210: 'deux cent dix',\n    211: 'deux cent onze',\n    212: 'deux cent douze',\n    213: 'deux cent treize',\n    214: 'deux cent quatorze',\n    215: 'deux cent quinze',\n    216: 'deux cent seize',\n    217: 'deux cent dix-sept',\n    218: 'deux cent dix-huit',\n    219: 'deux cent dix-neuf',\n    220: 'deux cent vingt',\n    221: 'deux cent vingt et un',\n    222: 'deux cent vingt-deux',\n    223: 'deux cent vingt-trois',\n    224: 'deux cent vingt-quatre',\n    225: 'deux cent vingt-cinq',\n    226: 'deux cent vingt-six',\n    227: 'deux cent vingt-sept',\n    228: 'deux cent vingt-huit',\n    229: 'deux cent vingt-neuf',\n    230: 'deux cent trente',\n    231: 'deux cent trente et un',\n    232: 'deux cent trente-deux',\n    233: 'deux cent trente-trois',\n    234: 'deux cent trente-quatre',\n    235: 'deux cent trente-cinq',\n    236: 'deux cent trente-six',\n    237: 'deux cent trente-sept',\n    238: 'deux cent trente-huit',\n    239: 'deux cent trente-neuf',\n    240: 'deux cent quarante',\n    241: 'deux cent quarante et un',\n    242: 'deux cent quarante-deux',\n    243: 'deux cent quarante-trois',\n    244: 'deux cent quarante-quatre',\n    245: 'deux cent quarante-cinq',\n    246: 'deux cent quarante-six',\n    247: 'deux cent quarante-sept',\n    248: 'deux cent quarante-huit',\n    249: 'deux cent quarante-neuf',\n    250: 'deux cent cinquante',\n    251: 'deux cent cinquante et un',\n    252: 'deux cent cinquante-deux',\n    253: 'deux cent cinquante-trois',\n    254: 'deux cent cinquante-quatre',\n    255: 'deux cent cinquante-cinq',\n    256: 'deux cent cinquante-six',\n    257: 'deux cent cinquante-sept',\n    258: 'deux cent cinquante-huit',\n    259: 'deux cent cinquante-neuf',\n    260: 'deux cent soixante',\n    261: 'deux cent soixante et un',\n    262: 'deux cent soixante-deux',\n    263: 'deux cent soixante-trois',\n    264: 'deux cent soixante-quatre',\n    265: 'deux cent soixante-cinq',\n    266: 'deux cent soixante-six',\n    267: 'deux cent soixante-sept',\n    268: 'deux cent soixante-huit',\n    269: 'deux cent soixante-neuf',\n    270: 'deux cent soixante-dix',\n    271: 'deux cent soixante et onze',\n    272: 'deux cent soixante-douze',\n    273: 'deux cent soixante-treize',\n    274: 'deux cent soixante-quatorze',\n    275: 'deux cent soixante-quinze',\n    276: 'deux cent soixante-seize',\n    277: 'deux cent soixante-dix-sept',\n    278: 'deux cent soixante-dix-huit',\n    279: 'deux cent soixante-dix-neuf',\n    280: 'deux cent quatre-vingts',\n    281: 'deux cent quatre-vingt-un',\n    282: 'deux cent quatre-vingt-deux',\n    283: 'deux cent quatre-vingt-trois',\n    284: 'deux cent quatre-vingt-quatre',\n    285: 'deux cent quatre-vingt-cinq',\n    286: 'deux cent quatre-vingt-six',\n    287: 'deux cent quatre-vingt-sept',\n    288: 'deux cent quatre-vingt-huit',\n    289: 'deux cent quatre-vingt-neuf',\n    290: 'deux cent quatre-vingt-dix',\n    291: 'deux cent quatre-vingt-onze',\n    292: 'deux cent quatre-vingt-douze',\n    293: 'deux cent quatre-vingt-treize',\n    294: 'deux cent quatre-vingt-quatorze',\n    295: 'deux cent quatre-vingt-quinze',\n    296: 'deux cent quatre-vingt-seize',\n    297: 'deux cent quatre-vingt-dix-sept',\n    298: 'deux cent quatre-vingt-dix-huit',\n    299: 'deux cent quatre-vingt-dix-neuf',\n    300: 'trois cents',\n    301: 'trois cent un',\n    302: 'trois cent deux',\n    303: 'trois cent trois',\n    304: 'trois cent quatre',\n    305: 'trois cent cinq',\n    306: 'trois cent six',\n    307: 'trois cent sept',\n    308: 'trois cent huit',\n    309: 'trois cent neuf',\n    310: 'trois cent dix',\n    311: 'trois cent onze',\n    312: 'trois cent douze',\n    313: 'trois cent treize',\n    314: 'trois cent quatorze',\n    315: 'trois cent quinze',\n    316: 'trois cent seize',\n    317: 'trois cent dix-sept',\n    318: 'trois cent dix-huit',\n    319: 'trois cent dix-neuf',\n    320: 'trois cent vingt',\n    321: 'trois cent vingt et un',\n    322: 'trois cent vingt-deux',\n    323: 'trois cent vingt-trois',\n    324: 'trois cent vingt-quatre',\n    325: 'trois cent vingt-cinq',\n    326: 'trois cent vingt-six',\n    327: 'trois cent vingt-sept',\n    328: 'trois cent vingt-huit',\n    329: 'trois cent vingt-neuf',\n    330: 'trois cent trente',\n    331: 'trois cent trente et un',\n    332: 'trois cent trente-deux',\n    333: 'trois cent trente-trois',\n    334: 'trois cent trente-quatre',\n    335: 'trois cent trente-cinq',\n    336: 'trois cent trente-six',\n    337: 'trois cent trente-sept',\n    338: 'trois cent trente-huit',\n    339: 'trois cent trente-neuf',\n    340: 'trois cent quarante',\n    341: 'trois cent quarante et un',\n    342: 'trois cent quarante-deux',\n    343: 'trois cent quarante-trois',\n    344: 'trois cent quarante-quatre',\n    345: 'trois cent quarante-cinq',\n    346: 'trois cent quarante-six',\n    347: 'trois cent quarante-sept',\n    348: 'trois cent quarante-huit',\n    349: 'trois cent quarante-neuf',\n    350: 'trois cent cinquante',\n    351: 'trois cent cinquante et un',\n    352: 'trois cent cinquante-deux',\n    353: 'trois cent cinquante-trois',\n    354: 'trois cent cinquante-quatre',\n    355: 'trois cent cinquante-cinq',\n    356: 'trois cent cinquante-six',\n    357: 'trois cent cinquante-sept',\n    358: 'trois cent cinquante-huit',\n    359: 'trois cent cinquante-neuf',\n    360: 'trois cent soixante',\n    361: 'trois cent soixante et un',\n    362: 'trois cent soixante-deux',\n    363: 'trois cent soixante-trois',\n    364: 'trois cent soixante-quatre',\n    365: 'trois cent soixante-cinq',\n    366: 'trois cent soixante-six',\n    367: 'trois cent soixante-sept',\n    368: 'trois cent soixante-huit',\n    369: 'trois cent soixante-neuf',\n    370: 'trois cent soixante-dix',\n    371: 'trois cent soixante et onze',\n    372: 'trois cent soixante-douze',\n    373: 'trois cent soixante-treize',\n    374: 'trois cent soixante-quatorze',\n    375: 'trois cent soixante-quinze',\n    376: 'trois cent soixante-seize',\n    377: 'trois cent soixante-dix-sept',\n    378: 'trois cent soixante-dix-huit',\n    379: 'trois cent soixante-dix-neuf',\n    380: 'trois cent quatre-vingts',\n    381: 'trois cent quatre-vingt-un',\n    382: 'trois cent quatre-vingt-deux',\n    383: 'trois cent quatre-vingt-trois',\n    384: 'trois cent quatre-vingt-quatre',\n    385: 'trois cent quatre-vingt-cinq',\n    386: 'trois cent quatre-vingt-six',\n    387: 'trois cent quatre-vingt-sept',\n    388: 'trois cent quatre-vingt-huit',\n    389: 'trois cent quatre-vingt-neuf',\n    390: 'trois cent quatre-vingt-dix',\n    391: 'trois cent quatre-vingt-onze',\n    392: 'trois cent quatre-vingt-douze',\n    393: 'trois cent quatre-vingt-treize',\n    394: 'trois cent quatre-vingt-quatorze',\n    395: 'trois cent quatre-vingt-quinze',\n    396: 'trois cent quatre-vingt-seize',\n    397: 'trois cent quatre-vingt-dix-sept',\n    398: 'trois cent quatre-vingt-dix-huit',\n    399: 'trois cent quatre-vingt-dix-neuf',\n    400: 'quatre cents',\n    401: 'quatre cent un',\n    402: 'quatre cent deux',\n    403: 'quatre cent trois',\n    404: 'quatre cent quatre',\n    405: 'quatre cent cinq',\n    406: 'quatre cent six',\n    407: 'quatre cent sept',\n    408: 'quatre cent huit',\n    409: 'quatre cent neuf',\n    410: 'quatre cent dix',\n    411: 'quatre cent onze',\n    412: 'quatre cent douze',\n    413: 'quatre cent treize',\n    414: 'quatre cent quatorze',\n    415: 'quatre cent quinze',\n    416: 'quatre cent seize',\n    417: 'quatre cent dix-sept',\n    418: 'quatre cent dix-huit',\n    419: 'quatre cent dix-neuf',\n    420: 'quatre cent vingt',\n    421: 'quatre cent vingt et un',\n    422: 'quatre cent vingt-deux',\n    423: 'quatre cent vingt-trois',\n    424: 'quatre cent vingt-quatre',\n    425: 'quatre cent vingt-cinq',\n    426: 'quatre cent vingt-six',\n    427: 'quatre cent vingt-sept',\n    428: 'quatre cent vingt-huit',\n    429: 'quatre cent vingt-neuf',\n    430: 'quatre cent trente',\n    431: 'quatre cent trente et un',\n    432: 'quatre cent trente-deux',\n    433: 'quatre cent trente-trois',\n    434: 'quatre cent trente-quatre',\n    435: 'quatre cent trente-cinq',\n    436: 'quatre cent trente-six',\n    437: 'quatre cent trente-sept',\n    438: 'quatre cent trente-huit',\n    439: 'quatre cent trente-neuf',\n    440: 'quatre cent quarante',\n    441: 'quatre cent quarante et un',\n    442: 'quatre cent quarante-deux',\n    443: 'quatre cent quarante-trois',\n    444: 'quatre cent quarante-quatre',\n    445: 'quatre cent quarante-cinq',\n    446: 'quatre cent quarante-six',\n    447: 'quatre cent quarante-sept',\n    448: 'quatre cent quarante-huit',\n    449: 'quatre cent quarante-neuf',\n    450: 'quatre cent cinquante',\n    451: 'quatre cent cinquante et un',\n    452: 'quatre cent cinquante-deux',\n    453: 'quatre cent cinquante-trois',\n    454: 'quatre cent cinquante-quatre',\n    455: 'quatre cent cinquante-cinq',\n    456: 'quatre cent cinquante-six',\n    457: 'quatre cent cinquante-sept',\n    458: 'quatre cent cinquante-huit',\n    459: 'quatre cent cinquante-neuf',\n    460: 'quatre cent soixante',\n    461: 'quatre cent soixante et un',\n    462: 'quatre cent soixante-deux',\n    463: 'quatre cent soixante-trois',\n    464: 'quatre cent soixante-quatre',\n    465: 'quatre cent soixante-cinq',\n    466: 'quatre cent soixante-six',\n    467: 'quatre cent soixante-sept',\n    468: 'quatre cent soixante-huit',\n    469: 'quatre cent soixante-neuf',\n    470: 'quatre cent soixante-dix',\n    471: 'quatre cent soixante et onze',\n    472: 'quatre cent soixante-douze',\n    473: 'quatre cent soixante-treize',\n    474: 'quatre cent soixante-quatorze',\n    475: 'quatre cent soixante-quinze',\n    476: 'quatre cent soixante-seize',\n    477: 'quatre cent soixante-dix-sept',\n    478: 'quatre cent soixante-dix-huit',\n    479: 'quatre cent soixante-dix-neuf',\n    480: 'quatre cent quatre-vingts',\n    481: 'quatre cent quatre-vingt-un',\n    482: 'quatre cent quatre-vingt-deux',\n    483: 'quatre cent quatre-vingt-trois',\n    484: 'quatre cent quatre-vingt-quatre',\n    485: 'quatre cent quatre-vingt-cinq',\n    486: 'quatre cent quatre-vingt-six',\n    487: 'quatre cent quatre-vingt-sept',\n    488: 'quatre cent quatre-vingt-huit',\n    489: 'quatre cent quatre-vingt-neuf',\n    490: 'quatre cent quatre-vingt-dix',\n    491: 'quatre cent quatre-vingt-onze',\n    492: 'quatre cent quatre-vingt-douze',\n    493: 'quatre cent quatre-vingt-treize',\n    494: 'quatre cent quatre-vingt-quatorze',\n    495: 'quatre cent quatre-vingt-quinze',\n    496: 'quatre cent quatre-vingt-seize',\n    497: 'quatre cent quatre-vingt-dix-sept',\n    498: 'quatre cent quatre-vingt-dix-huit',\n    499: 'quatre cent quatre-vingt-dix-neuf',\n    500: 'cinq cents',\n    501: 'cinq cent un',\n    502: 'cinq cent deux',\n    503: 'cinq cent trois',\n    504: 'cinq cent quatre',\n    505: 'cinq cent cinq',\n    506: 'cinq cent six',\n    507: 'cinq cent sept',\n    508: 'cinq cent huit',\n    509: 'cinq cent neuf',\n    510: 'cinq cent dix',\n    511: 'cinq cent onze',\n    512: 'cinq cent douze',\n    513: 'cinq cent treize',\n    514: 'cinq cent quatorze',\n    515: 'cinq cent quinze',\n    516: 'cinq cent seize',\n    517: 'cinq cent dix-sept',\n    518: 'cinq cent dix-huit',\n    519: 'cinq cent dix-neuf',\n    520: 'cinq cent vingt',\n    521: 'cinq cent vingt et un',\n    522: 'cinq cent vingt-deux',\n    523: 'cinq cent vingt-trois',\n    524: 'cinq cent vingt-quatre',\n    525: 'cinq cent vingt-cinq',\n    526: 'cinq cent vingt-six',\n    527: 'cinq cent vingt-sept',\n    528: 'cinq cent vingt-huit',\n    529: 'cinq cent vingt-neuf',\n    530: 'cinq cent trente',\n    531: 'cinq cent trente et un',\n    532: 'cinq cent trente-deux',\n    533: 'cinq cent trente-trois',\n    534: 'cinq cent trente-quatre',\n    535: 'cinq cent trente-cinq',\n    536: 'cinq cent trente-six',\n    537: 'cinq cent trente-sept',\n    538: 'cinq cent trente-huit',\n    539: 'cinq cent trente-neuf',\n    540: 'cinq cent quarante',\n    541: 'cinq cent quarante et un',\n    542: 'cinq cent quarante-deux',\n    543: 'cinq cent quarante-trois',\n    544: 'cinq cent quarante-quatre',\n    545: 'cinq cent quarante-cinq',\n    546: 'cinq cent quarante-six',\n    547: 'cinq cent quarante-sept',\n    548: 'cinq cent quarante-huit',\n    549: 'cinq cent quarante-neuf',\n    550: 'cinq cent cinquante',\n    551: 'cinq cent cinquante et un',\n    552: 'cinq cent cinquante-deux',\n    553: 'cinq cent cinquante-trois',\n    554: 'cinq cent cinquante-quatre',\n    555: 'cinq cent cinquante-cinq',\n    556: 'cinq cent cinquante-six',\n    557: 'cinq cent cinquante-sept',\n    558: 'cinq cent cinquante-huit',\n    559: 'cinq cent cinquante-neuf',\n    560: 'cinq cent soixante',\n    561: 'cinq cent soixante et un',\n    562: 'cinq cent soixante-deux',\n    563: 'cinq cent soixante-trois',\n    564: 'cinq cent soixante-quatre',\n    565: 'cinq cent soixante-cinq',\n    566: 'cinq cent soixante-six',\n    567: 'cinq cent soixante-sept',\n    568: 'cinq cent soixante-huit',\n    569: 'cinq cent soixante-neuf',\n    570: 'cinq cent soixante-dix',\n    571: 'cinq cent soixante et onze',\n    572: 'cinq cent soixante-douze',\n    573: 'cinq cent soixante-treize',\n    574: 'cinq cent soixante-quatorze',\n    575: 'cinq cent soixante-quinze',\n    576: 'cinq cent soixante-seize',\n    577: 'cinq cent soixante-dix-sept',\n    578: 'cinq cent soixante-dix-huit',\n    579: 'cinq cent soixante-dix-neuf',\n    580: 'cinq cent quatre-vingts',\n    581: 'cinq cent quatre-vingt-un',\n    582: 'cinq cent quatre-vingt-deux',\n    583: 'cinq cent quatre-vingt-trois',\n    584: 'cinq cent quatre-vingt-quatre',\n    585: 'cinq cent quatre-vingt-cinq',\n    586: 'cinq cent quatre-vingt-six',\n    587: 'cinq cent quatre-vingt-sept',\n    588: 'cinq cent quatre-vingt-huit',\n    589: 'cinq cent quatre-vingt-neuf',\n    590: 'cinq cent quatre-vingt-dix',\n    591: 'cinq cent quatre-vingt-onze',\n    592: 'cinq cent quatre-vingt-douze',\n    593: 'cinq cent quatre-vingt-treize',\n    594: 'cinq cent quatre-vingt-quatorze',\n    595: 'cinq cent quatre-vingt-quinze',\n    596: 'cinq cent quatre-vingt-seize',\n    597: 'cinq cent quatre-vingt-dix-sept',\n    598: 'cinq cent quatre-vingt-dix-huit',\n    599: 'cinq cent quatre-vingt-dix-neuf',\n    600: 'six cents',\n    601: 'six cent un',\n    602: 'six cent deux',\n    603: 'six cent trois',\n    604: 'six cent quatre',\n    605: 'six cent cinq',\n    606: 'six cent six',\n    607: 'six cent sept',\n    608: 'six cent huit',\n    609: 'six cent neuf',\n    610: 'six cent dix',\n    611: 'six cent onze',\n    612: 'six cent douze',\n    613: 'six cent treize',\n    614: 'six cent quatorze',\n    615: 'six cent quinze',\n    616: 'six cent seize',\n    617: 'six cent dix-sept',\n    618: 'six cent dix-huit',\n    619: 'six cent dix-neuf',\n    620: 'six cent vingt',\n    621: 'six cent vingt et un',\n    622: 'six cent vingt-deux',\n    623: 'six cent vingt-trois',\n    624: 'six cent vingt-quatre',\n    625: 'six cent vingt-cinq',\n    626: 'six cent vingt-six',\n    627: 'six cent vingt-sept',\n    628: 'six cent vingt-huit',\n    629: 'six cent vingt-neuf',\n    630: 'six cent trente',\n    631: 'six cent trente et un',\n    632: 'six cent trente-deux',\n    633: 'six cent trente-trois',\n    634: 'six cent trente-quatre',\n    635: 'six cent trente-cinq',\n    636: 'six cent trente-six',\n    637: 'six cent trente-sept',\n    638: 'six cent trente-huit',\n    639: 'six cent trente-neuf',\n    640: 'six cent quarante',\n    641: 'six cent quarante et un',\n    642: 'six cent quarante-deux',\n    643: 'six cent quarante-trois',\n    644: 'six cent quarante-quatre',\n    645: 'six cent quarante-cinq',\n    646: 'six cent quarante-six',\n    647: 'six cent quarante-sept',\n    648: 'six cent quarante-huit',\n    649: 'six cent quarante-neuf',\n    650: 'six cent cinquante',\n    651: 'six cent cinquante et un',\n    652: 'six cent cinquante-deux',\n    653: 'six cent cinquante-trois',\n    654: 'six cent cinquante-quatre',\n    655: 'six cent cinquante-cinq',\n    656: 'six cent cinquante-six',\n    657: 'six cent cinquante-sept',\n    658: 'six cent cinquante-huit',\n    659: 'six cent cinquante-neuf',\n    660: 'six cent soixante',\n    661: 'six cent soixante et un',\n    662: 'six cent soixante-deux',\n    663: 'six cent soixante-trois',\n    664: 'six cent soixante-quatre',\n    665: 'six cent soixante-cinq',\n    666: 'six cent soixante-six',\n    667: 'six cent soixante-sept',\n    668: 'six cent soixante-huit',\n    669: 'six cent soixante-neuf',\n    670: 'six cent soixante-dix',\n    671: 'six cent soixante et onze',\n    672: 'six cent soixante-douze',\n    673: 'six cent soixante-treize',\n    674: 'six cent soixante-quatorze',\n    675: 'six cent soixante-quinze',\n    676: 'six cent soixante-seize',\n    677: 'six cent soixante-dix-sept',\n    678: 'six cent soixante-dix-huit',\n    679: 'six cent soixante-dix-neuf',\n    680: 'six cent quatre-vingts',\n    681: 'six cent quatre-vingt-un',\n    682: 'six cent quatre-vingt-deux',\n    683: 'six cent quatre-vingt-trois',\n    684: 'six cent quatre-vingt-quatre',\n    685: 'six cent quatre-vingt-cinq',\n    686: 'six cent quatre-vingt-six',\n    687: 'six cent quatre-vingt-sept',\n    688: 'six cent quatre-vingt-huit',\n    689: 'six cent quatre-vingt-neuf',\n    690: 'six cent quatre-vingt-dix',\n    691: 'six cent quatre-vingt-onze',\n    692: 'six cent quatre-vingt-douze',\n    693: 'six cent quatre-vingt-treize',\n    694: 'six cent quatre-vingt-quatorze',\n    695: 'six cent quatre-vingt-quinze',\n    696: 'six cent quatre-vingt-seize',\n    697: 'six cent quatre-vingt-dix-sept',\n    698: 'six cent quatre-vingt-dix-huit',\n    699: 'six cent quatre-vingt-dix-neuf',\n    700: 'sept cents',\n    701: 'sept cent un',\n    702: 'sept cent deux',\n    703: 'sept cent trois',\n    704: 'sept cent quatre',\n    705: 'sept cent cinq',\n    706: 'sept cent six',\n    707: 'sept cent sept',\n    708: 'sept cent huit',\n    709: 'sept cent neuf',\n    710: 'sept cent dix',\n    711: 'sept cent onze',\n    712: 'sept cent douze',\n    713: 'sept cent treize',\n    714: 'sept cent quatorze',\n    715: 'sept cent quinze',\n    716: 'sept cent seize',\n    717: 'sept cent dix-sept',\n    718: 'sept cent dix-huit',\n    719: 'sept cent dix-neuf',\n    720: 'sept cent vingt',\n    721: 'sept cent vingt et un',\n    722: 'sept cent vingt-deux',\n    723: 'sept cent vingt-trois',\n    724: 'sept cent vingt-quatre',\n    725: 'sept cent vingt-cinq',\n    726: 'sept cent vingt-six',\n    727: 'sept cent vingt-sept',\n    728: 'sept cent vingt-huit',\n    729: 'sept cent vingt-neuf',\n    730: 'sept cent trente',\n    731: 'sept cent trente et un',\n    732: 'sept cent trente-deux',\n    733: 'sept cent trente-trois',\n    734: 'sept cent trente-quatre',\n    735: 'sept cent trente-cinq',\n    736: 'sept cent trente-six',\n    737: 'sept cent trente-sept',\n    738: 'sept cent trente-huit',\n    739: 'sept cent trente-neuf',\n    740: 'sept cent quarante',\n    741: 'sept cent quarante et un',\n    742: 'sept cent quarante-deux',\n    743: 'sept cent quarante-trois',\n    744: 'sept cent quarante-quatre',\n    745: 'sept cent quarante-cinq',\n    746: 'sept cent quarante-six',\n    747: 'sept cent quarante-sept',\n    748: 'sept cent quarante-huit',\n    749: 'sept cent quarante-neuf',\n    750: 'sept cent cinquante',\n    751: 'sept cent cinquante et un',\n    752: 'sept cent cinquante-deux',\n    753: 'sept cent cinquante-trois',\n    754: 'sept cent cinquante-quatre',\n    755: 'sept cent cinquante-cinq',\n    756: 'sept cent cinquante-six',\n    757: 'sept cent cinquante-sept',\n    758: 'sept cent cinquante-huit',\n    759: 'sept cent cinquante-neuf',\n    760: 'sept cent soixante',\n    761: 'sept cent soixante et un',\n    762: 'sept cent soixante-deux',\n    763: 'sept cent soixante-trois',\n    764: 'sept cent soixante-quatre',\n    765: 'sept cent soixante-cinq',\n    766: 'sept cent soixante-six',\n    767: 'sept cent soixante-sept',\n    768: 'sept cent soixante-huit',\n    769: 'sept cent soixante-neuf',\n    770: 'sept cent soixante-dix',\n    771: 'sept cent soixante et onze',\n    772: 'sept cent soixante-douze',\n    773: 'sept cent soixante-treize',\n    774: 'sept cent soixante-quatorze',\n    775: 'sept cent soixante-quinze',\n    776: 'sept cent soixante-seize',\n    777: 'sept cent soixante-dix-sept',\n    778: 'sept cent soixante-dix-huit',\n    779: 'sept cent soixante-dix-neuf',\n    780: 'sept cent quatre-vingts',\n    781: 'sept cent quatre-vingt-un',\n    782: 'sept cent quatre-vingt-deux',\n    783: 'sept cent quatre-vingt-trois',\n    784: 'sept cent quatre-vingt-quatre',\n    785: 'sept cent quatre-vingt-cinq',\n    786: 'sept cent quatre-vingt-six',\n    787: 'sept cent quatre-vingt-sept',\n    788: 'sept cent quatre-vingt-huit',\n    789: 'sept cent quatre-vingt-neuf',\n    790: 'sept cent quatre-vingt-dix',\n    791: 'sept cent quatre-vingt-onze',\n    792: 'sept cent quatre-vingt-douze',\n    793: 'sept cent quatre-vingt-treize',\n    794: 'sept cent quatre-vingt-quatorze',\n    795: 'sept cent quatre-vingt-quinze',\n    796: 'sept cent quatre-vingt-seize',\n    797: 'sept cent quatre-vingt-dix-sept',\n    798: 'sept cent quatre-vingt-dix-huit',\n    799: 'sept cent quatre-vingt-dix-neuf',\n    800: 'huit cents',\n    801: 'huit cent un',\n    802: 'huit cent deux',\n    803: 'huit cent trois',\n    804: 'huit cent quatre',\n    805: 'huit cent cinq',\n    806: 'huit cent six',\n    807: 'huit cent sept',\n    808: 'huit cent huit',\n    809: 'huit cent neuf',\n    810: 'huit cent dix',\n    811: 'huit cent onze',\n    812: 'huit cent douze',\n    813: 'huit cent treize',\n    814: 'huit cent quatorze',\n    815: 'huit cent quinze',\n    816: 'huit cent seize',\n    817: 'huit cent dix-sept',\n    818: 'huit cent dix-huit',\n    819: 'huit cent dix-neuf',\n    820: 'huit cent vingt',\n    821: 'huit cent vingt et un',\n    822: 'huit cent vingt-deux',\n    823: 'huit cent vingt-trois',\n    824: 'huit cent vingt-quatre',\n    825: 'huit cent vingt-cinq',\n    826: 'huit cent vingt-six',\n    827: 'huit cent vingt-sept',\n    828: 'huit cent vingt-huit',\n    829: 'huit cent vingt-neuf',\n    830: 'huit cent trente',\n    831: 'huit cent trente et un',\n    832: 'huit cent trente-deux',\n    833: 'huit cent trente-trois',\n    834: 'huit cent trente-quatre',\n    835: 'huit cent trente-cinq',\n    836: 'huit cent trente-six',\n    837: 'huit cent trente-sept',\n    838: 'huit cent trente-huit',\n    839: 'huit cent trente-neuf',\n    840: 'huit cent quarante',\n    841: 'huit cent quarante et un',\n    842: 'huit cent quarante-deux',\n    843: 'huit cent quarante-trois',\n    844: 'huit cent quarante-quatre',\n    845: 'huit cent quarante-cinq',\n    846: 'huit cent quarante-six',\n    847: 'huit cent quarante-sept',\n    848: 'huit cent quarante-huit',\n    849: 'huit cent quarante-neuf',\n    850: 'huit cent cinquante',\n    851: 'huit cent cinquante et un',\n    852: 'huit cent cinquante-deux',\n    853: 'huit cent cinquante-trois',\n    854: 'huit cent cinquante-quatre',\n    855: 'huit cent cinquante-cinq',\n    856: 'huit cent cinquante-six',\n    857: 'huit cent cinquante-sept',\n    858: 'huit cent cinquante-huit',\n    859: 'huit cent cinquante-neuf',\n    860: 'huit cent soixante',\n    861: 'huit cent soixante et un',\n    862: 'huit cent soixante-deux',\n    863: 'huit cent soixante-trois',\n    864: 'huit cent soixante-quatre',\n    865: 'huit cent soixante-cinq',\n    866: 'huit cent soixante-six',\n    867: 'huit cent soixante-sept',\n    868: 'huit cent soixante-huit',\n    869: 'huit cent soixante-neuf',\n    870: 'huit cent soixante-dix',\n    871: 'huit cent soixante et onze',\n    872: 'huit cent soixante-douze',\n    873: 'huit cent soixante-treize',\n    874: 'huit cent soixante-quatorze',\n    875: 'huit cent soixante-quinze',\n    876: 'huit cent soixante-seize',\n    877: 'huit cent soixante-dix-sept',\n    878: 'huit cent soixante-dix-huit',\n    879: 'huit cent soixante-dix-neuf',\n    880: 'huit cent quatre-vingts',\n    881: 'huit cent quatre-vingt-un',\n    882: 'huit cent quatre-vingt-deux',\n    883: 'huit cent quatre-vingt-trois',\n    884: 'huit cent quatre-vingt-quatre',\n    885: 'huit cent quatre-vingt-cinq',\n    886: 'huit cent quatre-vingt-six',\n    887: 'huit cent quatre-vingt-sept',\n    888: 'huit cent quatre-vingt-huit',\n    889: 'huit cent quatre-vingt-neuf',\n    890: 'huit cent quatre-vingt-dix',\n    891: 'huit cent quatre-vingt-onze',\n    892: 'huit cent quatre-vingt-douze',\n    893: 'huit cent quatre-vingt-treize',\n    894: 'huit cent quatre-vingt-quatorze',\n    895: 'huit cent quatre-vingt-quinze',\n    896: 'huit cent quatre-vingt-seize',\n    897: 'huit cent quatre-vingt-dix-sept',\n    898: 'huit cent quatre-vingt-dix-huit',\n    899: 'huit cent quatre-vingt-dix-neuf',\n    900: 'neuf cents',\n    901: 'neuf cent un',\n    902: 'neuf cent deux',\n    903: 'neuf cent trois',\n    904: 'neuf cent quatre',\n    905: 'neuf cent cinq',\n    906: 'neuf cent six',\n    907: 'neuf cent sept',\n    908: 'neuf cent huit',\n    909: 'neuf cent neuf',\n    910: 'neuf cent dix',\n    911: 'neuf cent onze',\n    912: 'neuf cent douze',\n    913: 'neuf cent treize',\n    914: 'neuf cent quatorze',\n    915: 'neuf cent quinze',\n    916: 'neuf cent seize',\n    917: 'neuf cent dix-sept',\n    918: 'neuf cent dix-huit',\n    919: 'neuf cent dix-neuf',\n    920: 'neuf cent vingt',\n    921: 'neuf cent vingt et un',\n    922: 'neuf cent vingt-deux',\n    923: 'neuf cent vingt-trois',\n    924: 'neuf cent vingt-quatre',\n    925: 'neuf cent vingt-cinq',\n    926: 'neuf cent vingt-six',\n    927: 'neuf cent vingt-sept',\n    928: 'neuf cent vingt-huit',\n    929: 'neuf cent vingt-neuf',\n    930: 'neuf cent trente',\n    931: 'neuf cent trente et un',\n    932: 'neuf cent trente-deux',\n    933: 'neuf cent trente-trois',\n    934: 'neuf cent trente-quatre',\n    935: 'neuf cent trente-cinq',\n    936: 'neuf cent trente-six',\n    937: 'neuf cent trente-sept',\n    938: 'neuf cent trente-huit',\n    939: 'neuf cent trente-neuf',\n    940: 'neuf cent quarante',\n    941: 'neuf cent quarante et un',\n    942: 'neuf cent quarante-deux',\n    943: 'neuf cent quarante-trois',\n    944: 'neuf cent quarante-quatre',\n    945: 'neuf cent quarante-cinq',\n    946: 'neuf cent quarante-six',\n    947: 'neuf cent quarante-sept',\n    948: 'neuf cent quarante-huit',\n    949: 'neuf cent quarante-neuf',\n    950: 'neuf cent cinquante',\n    951: 'neuf cent cinquante et un',\n    952: 'neuf cent cinquante-deux',\n    953: 'neuf cent cinquante-trois',\n    954: 'neuf cent cinquante-quatre',\n    955: 'neuf cent cinquante-cinq',\n    956: 'neuf cent cinquante-six',\n    957: 'neuf cent cinquante-sept',\n    958: 'neuf cent cinquante-huit',\n    959: 'neuf cent cinquante-neuf',\n    960: 'neuf cent soixante',\n    961: 'neuf cent soixante et un',\n    962: 'neuf cent soixante-deux',\n    963: 'neuf cent soixante-trois',\n    964: 'neuf cent soixante-quatre',\n    965: 'neuf cent soixante-cinq',\n    966: 'neuf cent soixante-six',\n    967: 'neuf cent soixante-sept',\n    968: 'neuf cent soixante-huit',\n    969: 'neuf cent soixante-neuf',\n    970: 'neuf cent soixante-dix',\n    971: 'neuf cent soixante et onze',\n    972: 'neuf cent soixante-douze',\n    973: 'neuf cent soixante-treize',\n    974: 'neuf cent soixante-quatorze',\n    975: 'neuf cent soixante-quinze',\n    976: 'neuf cent soixante-seize',\n    977: 'neuf cent soixante-dix-sept',\n    978: 'neuf cent soixante-dix-huit',\n    979: 'neuf cent soixante-dix-neuf',\n    980: 'neuf cent quatre-vingts',\n    981: 'neuf cent quatre-vingt-un',\n    982: 'neuf cent quatre-vingt-deux',\n    983: 'neuf cent quatre-vingt-trois',\n    984: 'neuf cent quatre-vingt-quatre',\n    985: 'neuf cent quatre-vingt-cinq',\n    986: 'neuf cent quatre-vingt-six',\n    987: 'neuf cent quatre-vingt-sept',\n    988: 'neuf cent quatre-vingt-huit',\n    989: 'neuf cent quatre-vingt-neuf',\n    990: 'neuf cent quatre-vingt-dix',\n    991: 'neuf cent quatre-vingt-onze',\n    992: 'neuf cent quatre-vingt-douze',\n    993: 'neuf cent quatre-vingt-treize',\n    994: 'neuf cent quatre-vingt-quatorze',\n    995: 'neuf cent quatre-vingt-quinze',\n    996: 'neuf cent quatre-vingt-seize',\n    997: 'neuf cent quatre-vingt-dix-sept',\n    998: 'neuf cent quatre-vingt-dix-huit',\n    999: 'neuf cent quatre-vingt-dix-neuf',\n  }\n  type IndexNb = keyof typeof dictionnaire\n\n  const nbString = nb.toString()\n  let classeDesMilliards = ''\n\n  if (\n    nbString.substring(nbString.length - 12, nbString.length - 9).length > 0\n  ) {\n    classeDesMilliards = dictionnaire[\n      nbString\n        .substring(nbString.length - 12, nbString.length - 9)\n        .replace(/^0{1,2}/, '') as IndexNb\n    ].replaceAll(' ', '-')\n  }\n  let classeDesMillions = ''\n  if (nbString.substring(nbString.length - 9, nbString.length - 6).length > 0) {\n    classeDesMillions = dictionnaire[\n      nbString\n        .substring(nbString.length - 9, nbString.length - 6)\n        .replace(/^0{1,2}/, '') as IndexNb\n    ].replaceAll(' ', '-')\n  }\n  let classeDesMilliers = ''\n  if (\n    nbString.substring(nbString.length - 6, nbString.length - 3) === '080' ||\n    nbString.substring(nbString.length - 6, nbString.length - 3) === '80'\n  ) {\n    classeDesMilliers = 'quatre-vingt'\n  } else if (\n    nbString.substring(nbString.length - 5, nbString.length - 3) === '00' &&\n    nbString.substring(nbString.length - 6, nbString.length - 5) !== '1'\n  ) {\n    classeDesMilliers = dictionnaire[\n      nbString\n        .substring(nbString.length - 6, nbString.length - 3)\n        .replace(/^0{1,2}/, '') as IndexNb\n    ]\n      .replaceAll(' ', '-')\n      .replace('cents', 'cent')\n  } else if (\n    nbString.substring(nbString.length - 6, nbString.length - 3).length > 0\n  ) {\n    classeDesMilliers = dictionnaire[\n      nbString\n        .substring(nbString.length - 6, nbString.length - 3)\n        .replace(/^0{1,2}/, '') as IndexNb\n    ].replaceAll(' ', '-')\n  }\n  let classeDesUnites = ''\n  if (nbString.substring(nbString.length - 3, nbString.length).length > 0) {\n    classeDesUnites = dictionnaire[\n      nbString\n        .substring(nbString.length - 3, nbString.length)\n        .replace(/^0{1,2}/, '') as IndexNb\n    ].replaceAll(' ', '-')\n  }\n  let result = ''\n  if (classeDesMilliards.length > 1) {\n    classeDesMilliards === 'un'\n      ? (result += classeDesMilliards + '-milliard')\n      : (result += classeDesMilliards + '-milliards')\n    if (\n      classeDesMillions !== 'zro' ||\n      classeDesMilliers !== 'zro' ||\n      classeDesUnites !== 'zro'\n    ) {\n      result += '-'\n    }\n  }\n  if (classeDesMillions.length > 1 && classeDesMillions !== 'zro') {\n    classeDesMillions === 'un'\n      ? (result += classeDesMillions + '-million')\n      : (result += classeDesMillions + '-millions')\n    if (classeDesMilliers !== 'zro' || classeDesUnites !== 'zro') {\n      result += '-'\n    }\n  }\n  if (classeDesMilliers.length > 1 && classeDesMilliers !== 'zro') {\n    classeDesMilliers === 'un'\n      ? (result += 'mille')\n      : (result += classeDesMilliers + '-mille')\n    if (classeDesUnites !== 'zro') {\n      result += '-'\n    }\n  }\n  if (classeDesUnites.length > 1 && classeDesUnites !== 'zro') {\n    result += classeDesUnites\n  }\n  result = result.replace('deux-cents-mille', 'deux-cent-mille')\n  result = result.replace('trois-cents-mille', 'trois-cent-mille')\n  result = result.replace('quatre-cents-mille', 'quatre-cent-mille')\n  result = result.replace('cinq-cents-mille', 'cinq-cent-mille')\n  result = result.replace('six-cents-mille', 'six-cent-mille')\n  result = result.replace('sept-cents-mille', 'sept-cent-mille')\n  result = result.replace('huit-cents-mille', 'huit-cent-mille')\n  result = result.replace('neuf-cents-mille', 'neuf-cent-mille')\n  return result\n}\n","import FractionEtendue, { rationnalise } from './FractionEtendue'\nimport ListeFraction from './ListeFraction'\nimport { nombreEnLettres } from './nombreEnLettres'\n\n/**\n * Des fonctions pour manipuler des objets Fraction ou ListeFraction\n * @module\n */\n\n/**\n * Retourne une liste de fractions irrducibles\n * @return {FractionEtendue[]}\n */\nexport function obtenirListeFractionsIrreductibles() {\n  // sous forme de fractions\n  return [\n    new FractionEtendue(1, 2),\n    new FractionEtendue(1, 3),\n    new FractionEtendue(2, 3),\n    new FractionEtendue(1, 4),\n    new FractionEtendue(3, 4),\n    new FractionEtendue(1, 5),\n    new FractionEtendue(2, 5),\n    new FractionEtendue(3, 5),\n    new FractionEtendue(4, 5),\n    new FractionEtendue(1, 6),\n    new FractionEtendue(5, 6),\n    new FractionEtendue(1, 7),\n    new FractionEtendue(2, 7),\n    new FractionEtendue(3, 7),\n    new FractionEtendue(4, 7),\n    new FractionEtendue(5, 7),\n    new FractionEtendue(6, 7),\n    new FractionEtendue(1, 8),\n    new FractionEtendue(3, 8),\n    new FractionEtendue(5, 8),\n    new FractionEtendue(7, 8),\n    new FractionEtendue(1, 9),\n    new FractionEtendue(2, 9),\n    new FractionEtendue(4, 9),\n    new FractionEtendue(5, 9),\n    new FractionEtendue(7, 9),\n    new FractionEtendue(8, 9),\n    new FractionEtendue(1, 10),\n    new FractionEtendue(3, 10),\n    new FractionEtendue(7, 10),\n    new FractionEtendue(9, 10),\n  ]\n}\n\n/**\n * Retourne une liste de fractions irrducibles simples (1/2, 1/3, 2/3, 1/5  4/5, 1/7  6/7)\n * @return {FractionEtendue[]}\n */\nexport function obtenirListeFractionsIrreductiblesFaciles() {\n  // sous forme de fractions\n  return [\n    new FractionEtendue(1, 2),\n    new FractionEtendue(1, 3),\n    new FractionEtendue(2, 3),\n    new FractionEtendue(1, 5),\n    new FractionEtendue(2, 5),\n    new FractionEtendue(3, 5),\n    new FractionEtendue(4, 5),\n    new FractionEtendue(1, 7),\n    new FractionEtendue(2, 7),\n    new FractionEtendue(3, 7),\n    new FractionEtendue(4, 7),\n    new FractionEtendue(5, 7),\n    new FractionEtendue(6, 7),\n  ]\n}\n\nexport function listeFractions(...fractions: FractionEtendue[]): ListeFraction {\n  return new ListeFraction(...fractions)\n}\n\n/**\n * Construit et Retourne un objet FractionEtendue(a, b)\n * @param {number} a\n * @param {number|undefined} b\n * @return {FractionEtendue}\n */\nexport function fraction(a: number, b: number | undefined): FractionEtendue {\n  if (b === undefined) {\n    // pas d'argument b\n    if (a === undefined) {\n      window.notify(\"fraction de fractions : aucun argument n'est dfini \", {\n        a,\n        b,\n      })\n      throw new Error(\"fraction de fractions : aucun argument n'est dfini \")\n    } else {\n      if (typeof a === 'number') {\n        const frac = rationnalise(a)\n        return frac\n      } else if (!isNaN(a)) {\n        const frac = rationnalise(Number(a))\n        return frac\n      }\n      window.notify(\n        \"fraction de fractions : l'argument est de type inconvenant \",\n        { a },\n      )\n      throw new Error(\n        \"fraction de fractions : l'argument est de type inconvenant \",\n      )\n    }\n  } else {\n    // on a un argument b\n    if (a === undefined) {\n      window.notify(\n        \"fraction de fractions : le premier argument n'est pas dfini \",\n        { a, b },\n      )\n      throw new Error(\n        \"fraction de fractions : le premier argument n'est pas dfini \",\n      )\n    } else {\n      if (typeof a === 'number' && typeof b === 'number') {\n        return new FractionEtendue(a, b)\n      } else if (!isNaN(b) && !isNaN(a)) {\n        return new FractionEtendue(Number(a), Number(b))\n      }\n      window.notify(\n        'fraction de fractions : les arguments sont de type inconvenant ',\n        { a, b },\n      )\n      throw new Error(\n        'fraction de fractions : les arguments sont de type inconvenant ',\n      )\n    }\n  }\n}\n\nexport function denominateurEnLettre(den: number, pluriel: boolean): string {\n  let denEnLettre\n  switch (den) {\n    case 2:\n      return pluriel ? 'demis' : 'demi'\n    case 3:\n      return 'tiers'\n    case 4:\n      return pluriel ? 'quarts' : 'quart'\n    case 9:\n      return pluriel ? 'neuvimes' : 'neuvime'\n    default:\n      denEnLettre = nombreEnLettres(den)\n      if (den === 5) return pluriel ? 'cinquimes' : 'cinquime'\n      if (!denEnLettre.endsWith('e')) {\n        return `${denEnLettre}ime${pluriel ? 's' : ''}`\n      }\n      return `${denEnLettre.substring(0, denEnLettre.length - 1)}ime${pluriel ? 's' : ''}`\n  }\n}\n","import Decimal from 'decimal.js'\nimport { stringNombre, texNombre } from '../lib/outils/texNombre'\n\n/**\n * @class\n * @param {number|Decimal} mesure\n * @param {string} unite (cm, cm^2, m^3, L, kg, m/s, km/h, hhmmss, hdec, mindec, a, ha, ...)\n * Keeps existing behavior and adds vitesse & dure conversions.\n * @author Jean-Claude Lhote et Sbastien Lozano, Nathan Scheinmann (ajout des unit de vitesse et de dure)\n*/\nclass Grandeur {\n  mesureDecimal: Decimal\n  unite: string\n  puissanceUnite: number\n  uniteDeReference: string\n  prefixe: string\n  puissancePrefixe: number\n\n  constructor (mesure: number | Decimal, unite: string) {\n    this.mesureDecimal = mesure instanceof Decimal ? mesure : new Decimal(mesure)\n    this.unite = unite\n    const uniteParsee = parseUnite(unite)\n    this.puissanceUnite = uniteParsee.puissanceUnite\n    this.uniteDeReference = uniteParsee.uniteDeReference\n    this.prefixe = uniteParsee.prefixe\n    this.puissancePrefixe = uniteParsee.puissancePrefixe\n  }\n\n  get mesure() {\n    return this.mesureDecimal.toNumber()\n  }\n\n  set mesure(mesure: number) {\n    this.mesureDecimal = new Decimal(mesure)\n  }\n\n  /**\n   * Conversion rules preserved + extended:\n   * - Same reference unit with SI prefixes (existing)\n   * - m^3  L (existing)\n   * - m^2  a/ha (existing)\n   * - NEW: vitesse (m/s  km/h)\n   * - NEW: dure (hhmmss  hdec  mindec) [base = seconds]\n   * @param {string} uniteConversion\n   * @returns {Grandeur}\n   */\n  convertirEn (uniteConversion: string) {\n    const uniteConversionParsee = parseUnite(uniteConversion)\n\n    // ===== NEW: vitesse (m/s <-> km/h) =====\n    if (isVitesseUnit(this.unite) && isVitesseUnit(uniteConversion)) {\n      const baseMps = toMps(this.mesureDecimal, this.unite)                 //  m/s\n      const cible = fromMps(baseMps, uniteConversion)                       //  m/s -> target\n      return new Grandeur(cible, uniteConversion)\n    }\n\n    // ===== NEW: dure (hhmmss <-> hdec <-> mindec) =====\n    if (isDureeUnit(this.unite) && isDureeUnit(uniteConversion)) {\n      const baseSeconds = toSecondsDuree(this.mesureDecimal, this.unite)    //  s\n      const cible = fromSecondsDuree(baseSeconds, uniteConversion)          //  s -> target unit\n      return new Grandeur(cible, uniteConversion)\n    }\n\n    // ===== Existing logic kept below =====\n    if (\n      uniteConversionParsee.puissanceUnite === this.puissanceUnite &&\n      uniteConversionParsee.uniteDeReference === this.uniteDeReference\n    ) {\n      // Same underlying unit (e.g., m  cm, m^2  cm^2, g  kg, etc.)\n      // factor = 10^((p_src - p_dst)*power)\n      const exp = new Decimal(this.puissancePrefixe)\n        .minus(uniteConversionParsee.puissancePrefixe)\n        .times(this.puissanceUnite)\n      const facteur = new Decimal(10).pow(exp)\n      return new Grandeur(this.mesureDecimal.times(facteur), uniteConversion)\n\n    } else if (uniteConversionParsee.uniteDeReference === 'm^3' && this.uniteDeReference === 'L') {\n      // Tout en litres -> m^3\n      // src in L-derivatives to m^3: exp = (p_src - p_dst - 3)*power\n      const exp = new Decimal(this.puissancePrefixe)\n        .minus(uniteConversionParsee.puissancePrefixe)\n        .minus(3)\n        .times(this.puissanceUnite)\n      const facteur = new Decimal(10).pow(exp)\n      return new Grandeur(this.mesureDecimal.times(facteur), 'L') // keep target doc behavior (existing)\n\n    } else if (uniteConversionParsee.uniteDeReference === 'L' && this.uniteDeReference === 'm^3') {\n      // Tout en m^3 -> L\n      // exp = p_src*power + 3\n      const exp = new Decimal(this.puissancePrefixe)\n        .times(this.puissanceUnite)\n        .plus(3)\n      const facteur = new Decimal(10).pow(exp)\n      return new Grandeur(this.mesureDecimal.times(facteur), 'm^3') // keep target doc behavior (existing)\n\n    } else if (uniteConversionParsee.uniteDeReference === 'm^2' && this.uniteDeReference === 'a') {\n      // a/ha -> m^2\n      // a = 100 m^2 ; ha = 10000 m^2\n      const exp = new Decimal(this.puissancePrefixe).plus(2)\n      const facteur = new Decimal(10).pow(exp)\n      return new Grandeur(this.mesureDecimal.times(facteur), 'm^2')\n\n    } else if (uniteConversionParsee.uniteDeReference === 'a' && this.uniteDeReference === 'm^2') {\n      // m^2 -> a/ha\n      const exp = new Decimal(this.puissancePrefixe).times(this.puissanceUnite).minus(2)\n      const facteur = new Decimal(10).pow(exp)\n      return new Grandeur(this.mesureDecimal.times(facteur), 'a')\n\n    } else {\n      throw new Error(`Conversion impossible de ${this.unite} en ${uniteConversion}`)\n    }\n  }\n\n  estEgal(unite2: Grandeur) {\n    if (unite2.uniteDeReference !== this.uniteDeReference) return false\n    try {\n      const u1 = this.convertirEn(this.uniteDeReference)\n      const u2 = unite2.convertirEn(this.uniteDeReference)\n      if (u1 && u2) {\n        return u1.mesure === u2.mesure\n      } else {\n        return false\n      }\n    } catch (error) {\n      console.error(error)\n      return false\n    }\n  }\n\n  /**\n   * La prcision est donne dans l'unit la plus petite des deux grandeurs\n   */\n  estUneApproximation(unite2: Grandeur, precision: number) {\n    if (unite2.uniteDeReference !== this.uniteDeReference) return false\n    try {\n      let u1: Grandeur\n      let u2: Grandeur\n      if (this.puissancePrefixe > unite2.puissancePrefixe) {\n        u1 = this.convertirEn(unite2.unite)\n        u2 = unite2\n      } else {\n        u1 = this.convertirEn(this.unite)\n        u2 = unite2.convertirEn(this.unite)\n      }\n      if (u1 !== undefined && u2 !== undefined) {\n        return Math.abs(u1.mesure - u2.mesure) <= precision\n      } else {\n        return false\n      }\n    } catch (error) {\n      console.error(error)\n      return false\n    }\n  }\n\n  /**\n   * Retourne une chane :\n   * - valeurs usuelles : '12,345 cm'\n   * - NEW dure hhmmss : '3 h 45 min 28 s'\n   */\n  toString (precision = 12) {\n    if (this.unite === 'hhmmss') {\n      return formatHHMMSS(this.mesureDecimal)\n    }\n    const nbChiffrePartieDecimale = String(this.mesure).split('.')[1]?.length\n    if (nbChiffrePartieDecimale < precision) precision = nbChiffrePartieDecimale\n    return `${stringNombre(this.mesure, precision).replace('.', ',')}\\u202f${this.unite}`\n  }\n\n  /**\n   * Retourne une chane LaTeX :\n   * - valeurs usuelles : '12,345~\\\\text{cm}'\n   * - NEW dure hhmmss : '3~\\\\text{h} 45~\\\\text{min} 28~\\\\text{s}'\n   */\n  toTex (precision = 12) {\n    if (isDureeUnit(this.unite)) {\n      const sec = toSecondsDuree(this.mesureDecimal, this.unite) // Decimal seconds\n      return formatDureeTexHMS(sec)\n    }\n    return `${texNombre(this.mesure, precision).replace('.', ',')}~\\\\text{${this.unite}}`\n  }\n\n  get latexUnit () {\n    if (isVitesseUnit(this.unite) || isDureeUnit(this.unite)) {\n      // vitesse/dure: render raw unit (already human-friendly)\n      return `\\\\text{${this.unite}}`\n    }\n    return `\\\\text{${this.prefixe}${this.uniteDeReference.split('^')[0]}}${this.puissanceUnite === 1 ? '' : `^{${this.puissanceUnite.toString()}}`}`\n  }\n\n  /**\n   * Cre une grandeur  partir d'un texte '1 cm', '2 m^2', '3~\\\\text{L}'...\n   * (existing behavior kept; not parsing hh:mm:ss literal)\n   */\n  static fromString (text: string) {\n    text = text.replace('\\\\,', '')\n    text = text.replace('~', '')\n    text = text.replace(',', '.')\n    text = text.replace(' ', '')\n    text = text.replace(/\\\\text{([^}]+)}/g, '$1')\n    const mesure = parseFloat(text)\n    const unite = text.replace(String(mesure), '')\n    const grandeur = new Grandeur(mesure, unite)\n    return grandeur\n  }\n  /**\n   * Cre une grandeur de dure  partir d'une chane \"HH:MM:SS\" ou \"HHMMSS\".\n   * La valeur interne est stocke en secondes, unit = \"hhmmss\".\n   */\n  static fromHHMMSS (text: string): Grandeur {\n    const seconds = hhmmssToSeconds(text) // helper already defined below\n    return new Grandeur(seconds, 'hhmmss')\n  }\n\n    /**\n   * Retourne toujours la valeur convertie en HH:MM:SS (string).\n   * Utile mme si la grandeur n'est pas dj en \"hhmmss\".\n   */\n    toHHMMSS (): string {\n      if (!isDureeUnit(this.unite)) {\n        throw new Error(`Impossible d'appeler toHHMMSS() sur une grandeur qui n'est pas une dure (unit: ${this.unite})`)\n      }\n      // convertir vers hhmmss si besoin\n      const enSecondes = toSecondsDuree(this.mesureDecimal, this.unite)\n      return formatHHMMSS(enSecondes)\n    }\n    \n}\n\nexport default Grandeur\n\n// =======================================================\n// ===== Helpers: units, parsing, vitesse & dure logic ===\n// =======================================================\n\nfunction isVitesseUnit (u: string) {\n  return u === 'm/s' || u === 'km/h'\n}\n\nfunction isDureeUnit (u: string) {\n  return u === 'hhmmss' || u === 'hdec' || u === 'mindec' || u === 'sec'\n}\n\n// vitesse base = m/s\nfunction toMps (value: Decimal, unit: string): Decimal {\n  if (unit === 'm/s') return value\n  if (unit === 'km/h') return value.div(3.6)\n  throw new Error(`Unit de vitesse inconnue: ${unit}`)\n}\nfunction fromMps (mps: Decimal, unit: string): Decimal {\n  if (unit === 'm/s') return mps\n  if (unit === 'km/h') return mps.times(3.6)\n  throw new Error(`Unit de vitesse inconnue: ${unit}`)\n}\n\n// dure base = secondes\nfunction toSecondsDuree (value: Decimal, unit: string): Decimal {\n  if (unit === 'hhmmss') return value // convention: value already in seconds\n  if (unit === 'hdec') return value.times(3600)\n  if (unit === 'mindec') return value.times(60)\n  if (unit === 'sec') return value // already in seconds\n  throw new Error(`Unit de dure inconnue: ${unit}`)\n}\nfunction fromSecondsDuree (seconds: Decimal, unit: string): Decimal {\n  if (unit === 'hhmmss') return seconds // stocke en secondes\n  if (unit === 'hdec') return seconds.div(3600)\n  if (unit === 'mindec') return seconds.div(60)\n  if (unit === 'sec') return seconds // already in seconds\n  throw new Error(`Unit de dure inconnue: ${unit}`)\n}\n\nfunction hhmmssToSeconds (str: string): Decimal {\n  const t = str.trim()\n  if (/^\\d{1,2}:\\d{2}:\\d{2}$/.test(t)) {\n    const [H, M, S] = t.split(':').map(Number)\n    return new Decimal(H).times(3600).plus(new Decimal(M).times(60)).plus(S)\n  }\n  if (/^\\d{6}$/.test(t)) {\n    const H = Number(t.slice(0,2))\n    const M = Number(t.slice(2,4))\n    const S = Number(t.slice(4,6))\n    return new Decimal(H).times(3600).plus(new Decimal(M).times(60)).plus(S)\n  }\n  throw new Error(`Format hhmmss invalide: \"${str}\"`)\n}\n\nfunction formatDureeTexHMS (seconds: Decimal): string {\n  const total = seconds.toDecimalPlaces(0, Decimal.ROUND_HALF_UP).toNumber()\n  const h = Math.floor(total / 3600)\n  const m = Math.floor((total % 3600) / 60)\n  const s = total % 60\n  const parts: string[] = []\n  if (h > 0) parts.push(`${h}~\\\\text{h}`)\n  if (m > 0) parts.push(`${m}~\\\\text{min}`)\n  if (s > 0) parts.push(`${s}~\\\\text{s}`)\n  return parts.join('~')\n}\n\nfunction formatHHMMSS (seconds: Decimal): string {\n  const total = seconds.toDecimalPlaces(0, Decimal.ROUND_HALF_UP).toNumber()\n  const h = Math.floor(total / 3600)\n  const m = Math.floor((total % 3600) / 60)\n  const s = total % 60\n  const parts: string[] = []\n  if (h > 0) parts.push(`${h} h`)\n  if (m > 0) parts.push(`${m} min`)\n  if (s > 0) parts.push(`${s} s`)\n  return parts.join(' ')\n}\n\n/**\n * parseUnite:\n *  - Keeps existing SI/prefix parsing\n *  - Adds vitesse & dure special cases with reasonable bases:\n *      vitesse -> base 'm/s'\n *      dure   -> base 's' (seconds)\n */\nfunction parseUnite (unite: string) {\n  // vitesse\n  if (isVitesseUnit(unite)) {\n    return {\n      prefixe: '',\n      uniteDeReference: 'm/s',\n      puissanceUnite: 1,\n      puissancePrefixe: 0\n    }\n  }\n  // dure\n  if (isDureeUnit(unite)) {\n    return {\n      prefixe: '',\n      uniteDeReference: 's',\n      puissanceUnite: 1,\n      puissancePrefixe: 0\n    }\n  }\n\n  let puissanceUnite: number\n  let avantPuissanceUnite: string\n\n  if (unite === '') {\n    puissanceUnite = 1\n    avantPuissanceUnite = ''\n  }\n  if (unite === 'C') {\n    puissanceUnite = 1\n    avantPuissanceUnite = 'C'\n  }\n\n  if (unite.indexOf('^') > 0) { // m^2, m^3 et drives\n    puissanceUnite = Number(unite.split('^')[1])\n    avantPuissanceUnite = unite.split('^')[0]\n  } else if (unite.indexOf('ha') === 0) {\n    // hectares\n    puissanceUnite = 1\n    avantPuissanceUnite = 'ha'\n  } else if (unite.indexOf('a') === 0) {\n    // ares\n    puissanceUnite = 1\n    avantPuissanceUnite = 'a'\n  } else if (unite.indexOf('ca') === 0) {\n    // centiares\n    puissanceUnite = 1\n    avantPuissanceUnite = 'ca'\n  } else {\n    // m, g, L et leurs drives\n    puissanceUnite = 1\n    avantPuissanceUnite = unite\n  }\n\n  const prefixe =\n    unite === 'C'\n      ? ''\n      : ['t', 'q'].includes(unite)\n        ? unite\n        : avantPuissanceUnite.substring(0, avantPuissanceUnite.length - 1) // tonne/quintal handled below\n\n  const puissancePrefixe = prefixeToPuissance(prefixe, unite)\n  const uniteDeReference = ['t', 'q'].includes(unite) ? 'g' : unite.substring(prefixe.length)\n\n  return { prefixe, uniteDeReference, puissanceUnite, puissancePrefixe }\n}\n\nfunction prefixeToPuissance(prefixe: string, unite: string) {\n  let puissancePrefixe: number\n  switch (prefixe) {\n    case 'm': puissancePrefixe = -3; break\n    case 'c': puissancePrefixe = -2; break\n    case 'd': puissancePrefixe = -1; break\n    case '':  puissancePrefixe = 0;  break\n    case 'da': puissancePrefixe = 1; break\n    case 'h': puissancePrefixe = 2; break\n    case 'k': puissancePrefixe = 3; break\n    case 'q': puissancePrefixe = unite === 'q' ? 5 : NaN; break\n    case 't': puissancePrefixe = unite === 't' ? 6 : NaN; break\n    case 'M': puissancePrefixe = 6; break\n    case 'G': puissancePrefixe = 9; break\n    case 'T': puissancePrefixe = 12; break\n    case '\\\\mu{}': puissancePrefixe = -6; break\n    case 'n': puissancePrefixe = -9; break\n    default: puissancePrefixe = NaN\n  }\n  return puissancePrefixe\n}\n","/**\n * Classe pour grer les dures au format HMS (Heures, Minutes, Secondes)\n * @author Rmi Angot\n * @example const time = new Hms({hour: 2, minute: 5, second: 30})\n * @example const time = Hms.fromString('2 h 5 min 30 s')\n * @example const time = Hms.fromString('5min')\n * @example const time = Hms.fromString('14000s')\n * time.normalize().toString() // 3 h 53 min 20 s\n *\n */\nclass Hms {\n  week: number\n  day: number\n  hour: number\n  minute: number\n  second: number\n  sign: '' | '+' | '-'\n  constructor({\n    week = 0,\n    day = 0,\n    hour = 0,\n    minute = 0,\n    second = 0,\n    sign = '',\n  }: {\n    week?: number\n    day?: number\n    hour?: number\n    minute?: number\n    second?: number\n    sign?: '+' | '-' | ''\n  } = {}) {\n    this.week = week\n    this.day = day\n    this.hour = hour\n    this.minute = minute\n    this.second = second\n    this.sign = sign\n  }\n\n  static fromString(text: string): Hms {\n    const hms = new Hms()\n    text = text.replaceAll(' ', '')\n    text = text.replaceAll('&nbsp;', '')\n    text = text.replaceAll('{\\\\:\\\\text{semaines}\\\\:}', 'semaines')\n    text = text.replaceAll('{\\\\:\\\\text{j}\\\\:}', 'j')\n    text = text.replaceAll('{\\\\:\\\\text{h}\\\\:}', 'h')\n    text = text.replaceAll('{\\\\:\\\\text{min}\\\\:}', 'min')\n    text = text.replaceAll('{\\\\:\\\\text{s}\\\\:}', 's')\n    text = text.replaceAll('sem', 'semaines')\n    // Format avec semaines et jours\n    const regexComplete =\n      /(?:(?<sign>[+,-]))?(?:(?<week>\\d+)\\s*semaines\\s*)?(?:(?<day>\\d+)\\s*j\\s*)?(?:(?<hour>\\d+)\\s*h\\s*)?(?:(?<minute>\\d+)\\s*min\\s*)?(?:(?<second>\\d+)\\s*s)?/gm\n    for (const match of text.matchAll(regexComplete)) {\n      if (match.groups !== undefined) {\n        if (Number.isInteger(parseInt(match.groups.week)))\n          hms.week = parseInt(match.groups.week)\n        if (Number.isInteger(parseInt(match.groups.day)))\n          hms.day = parseInt(match.groups.day)\n        if (Number.isInteger(parseInt(match.groups.hour)))\n          hms.hour = parseInt(match.groups.hour)\n        if (Number.isInteger(parseInt(match.groups.minute)))\n          hms.minute = parseInt(match.groups.minute)\n        if (Number.isInteger(parseInt(match.groups.second)))\n          hms.second = parseInt(match.groups.second)\n        if (match.groups.sign === '+' || match.groups.sign === '-')\n          hms.sign = match.groups.sign\n      }\n    }\n    if (text.includes('min') && !text.endsWith('s')) {\n      // Format sans le s pour les secondes 4min33, 5h3min15\n      const regex =\n        /(?:(?<sign>[+,-]))?(?:(?<week>\\d+)\\s*semaines\\s*)?(?:(?<day>\\d+)\\s*j\\s*)?(?:(?<hour>\\d+)\\s*h\\s*)?(?:(?<minute>\\d+)\\s*min\\s*)?(?:(?<second>\\d+))?/gm\n      for (const match of text.matchAll(regex)) {\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.week))\n        )\n          hms.week = parseInt(match.groups.week)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.day))\n        )\n          hms.day = parseInt(match.groups.day)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.hour))\n        )\n          hms.hour = parseInt(match.groups.hour)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.minute))\n        )\n          hms.minute = parseInt(match.groups.minute)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.second))\n        )\n          hms.second = parseInt(match.groups.second)\n        if (\n          match.groups !== undefined &&\n          (match.groups.sign === '+' || match.groups.sign === '-')\n        )\n          hms.sign = match.groups.sign\n      }\n    } else if (\n      text.includes('h') &&\n      !text.includes('min') &&\n      !text.endsWith('s')\n    ) {\n      // Format sans le min pour les minutes 5h13\n      const regex =\n        /(?:(?<sign>[+,-]))?(?:(?<week>\\d+)\\s*semaines\\s*)?(?:(?<day>\\d+)\\s*j\\s*)?(?:(?<hour>\\d+)\\s*h\\s*)?(?:(?<minute>\\d+))?/gm\n      for (const match of text.matchAll(regex)) {\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.week))\n        )\n          hms.week = parseInt(match.groups.week)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.day))\n        )\n          hms.day = parseInt(match.groups.day)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.hour))\n        )\n          hms.hour = parseInt(match.groups.hour)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.minute))\n        )\n          hms.minute = parseInt(match.groups.minute)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.second))\n        )\n          hms.second = parseInt(match.groups.second)\n        if (\n          match.groups !== undefined &&\n          (match.groups.sign === '+' || match.groups.sign === '-')\n        )\n          hms.sign = match.groups.sign\n      }\n    } else {\n      // Format HMS classique\n      const regex =\n        /(?:(?<sign>[+,-]))?(?:(?<week>\\d+)\\s*semaines\\s*)?(?:(?<day>\\d+)\\s*j\\s*)?(?:(?<hour>\\d+)\\s*h\\s*)?(?:(?<minute>\\d+)\\s*min\\s*)?(?:(?<second>\\d+)\\s*s)?/gm\n      for (const match of text.matchAll(regex)) {\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.week))\n        )\n          hms.week = parseInt(match.groups.week)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.day))\n        )\n          hms.day = parseInt(match.groups.day)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.hour))\n        )\n          hms.hour = parseInt(match.groups.hour)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.minute))\n        )\n          hms.minute = parseInt(match.groups.minute)\n        if (\n          match.groups !== undefined &&\n          Number.isInteger(parseInt(match.groups.second))\n        )\n          hms.second = parseInt(match.groups.second)\n        if (\n          match.groups !== undefined &&\n          (match.groups.sign === '+' || match.groups.sign === '-')\n        )\n          hms.sign = match.groups.sign\n      }\n    }\n    return hms\n  }\n\n  toString(): string {\n    let result = ''\n    if (this.week > 0) {\n      result += `${this.week} semaines `\n      if (this.day > 0 || this.hour > 0 || this.minute > 0 || this.second > 0)\n        result += ' '\n    }\n    if (this.day > 0) {\n      result += `${this.day} jours `\n      if (this.hour > 0 || this.minute > 0 || this.second > 0) result += ' '\n    }\n    if (this.hour > 0) {\n      if (this.hour % 24 === 0) {\n        result += '0 h'\n      } else {\n        result += `${this.hour} h`\n      }\n      if (this.minute > 0 || this.second > 0) result += ' '\n    }\n    if (this.minute > 0) {\n      result += this.minute > 9 ? `${this.minute} min` : `0${this.minute} min`\n      if (this.second > 0) result += ' '\n    }\n    if (this.second > 0) result += `${this.second} s`\n    return result\n  }\n\n  /** Sortie string sans la dernire unit si elle n'est pas seule\n   * Exemples : 4 h 12 ou 2 min 54\n   */\n  toString2(): string {\n    if (this.hour > 0 && this.second === 0)\n      return this.toString().replace(' min', '')\n    else if (this.minute > 0) return this.toString().replace(' s', '')\n    else return this.toString()\n  }\n\n  isGreaterThan(time: Hms): boolean {\n    return this.toSeconds() > time.toSeconds()\n  }\n\n  /** Dures identiques */\n  isEqual(time: Hms): boolean {\n    return this.toSeconds() === time.toSeconds()\n  }\n\n  /** Dures identiques et crites de la mme manire\n   * 1 min et 60 s => false\n   */\n  isTheSame(time: Hms): boolean {\n    return (\n      this.week === time.week &&\n      this.day === time.day &&\n      this.hour === time.hour &&\n      this.minute === time.minute &&\n      this.second === time.second\n    )\n  }\n\n  /**\n   * Dure identiques\n   */\n  isEquivalentToString(text: string): boolean {\n    return Hms.fromString(text).toSeconds() === this.toSeconds()\n  }\n\n  toSecondsString(): string {\n    return `${this.toSeconds()} s`\n  }\n\n  toSeconds(): number {\n    return (\n      this.week * 604800 +\n      this.day * 86400 +\n      this.hour * 3600 +\n      this.minute * 60 +\n      this.second\n    )\n  }\n\n  /**\n   * Normalise l'criture au format HMS. Les secondes et les minutes seront infrieures  60\n   */\n  normalize(): Hms {\n    this.minute += Math.floor(this.second / 60)\n    this.second = this.second % 60\n    this.hour += Math.floor(this.minute / 60)\n    this.minute = this.minute % 60\n    return this\n  }\n\n  add(time: Hms): Hms {\n    const result = new Hms()\n    result.second = this.toSeconds() + time.toSeconds()\n    result.normalize()\n    return result\n  }\n\n  /**\n   * Renvoie la valeur absolue de la diffrence des temps au format HMS\n   * @param time HMS\n   * @returns HMS\n   */\n  substract(time: Hms): Hms {\n    const result = new Hms()\n    result.second = Math.abs(this.toSeconds() - time.toSeconds())\n    result.normalize()\n    return result\n  }\n}\n\nexport default Hms\n","import { context } from '../../modules/context'\nimport { quotientier, randint } from '../../modules/outils'\n\n/**\n * Cr un string de nbsommets caractres dans l'ordre alphabtique et en majuscule qui ne soit pas dans la liste donne en 2e argument\n * @param {number} nbsommets\n * @param {string|string[]} listeAEviter\n * @author Rmi Angot\n * Ajout des while pour s'assurer de bien avoir des lettres majuscules le 08/05/2022 par Guillaume Valmont\n **/\nexport function creerNomDePolygone(\n  nbsommets: number,\n  listeAEviter: string | string[] = [],\n) {\n  let premiersommet = randint(65, 90 - nbsommets)\n  let polygone = ''\n  if (typeof listeAEviter === 'string') listeAEviter = Array.from(listeAEviter)\n  for (let i = 0; i < nbsommets; i++) {\n    let augmentation = i\n    while (premiersommet + augmentation > 90) augmentation -= 26\n    while (premiersommet + augmentation < 65) augmentation += 26\n    polygone += String.fromCharCode(premiersommet + augmentation)\n  }\n\n  if (listeAEviter.length <= 26 - nbsommets) {\n    // On vite la liste  viter si elle n'est pas trop grosse sinon on n'en tient pas compte\n    let cpt = 0\n    while (possedeUnCaractereInterdit(polygone, listeAEviter) && cpt < 20) {\n      polygone = ''\n      premiersommet = randint(65, 90 - nbsommets)\n      for (let i = 0; i < nbsommets; i++) {\n        polygone += String.fromCharCode(premiersommet + i)\n      }\n      cpt++ // Au bout de 20 essais, on laisse tomber la liste  viter\n    }\n  } else {\n    console.info(\n      'Trop de questions donc plusieurs polygones peuvent avoir le mme nom',\n    )\n  }\n  return polygone\n}\n\n/**\n * Vrifie dans un texte si un de ses caractres appartient  une liste  viter\n * @author Rmi Angot\n */\nexport function possedeUnCaractereInterdit(\n  texte: string,\n  listeAEviter: string[],\n) {\n  let result = false\n  for (const motAeviter of listeAEviter) {\n    for (let i = 0; i < motAeviter.length; i++) {\n      if (texte.indexOf(motAeviter[i]) > -1) {\n        result = true\n      }\n    }\n  }\n  return result\n}\n\n/**\n * Renvoie une lettre majuscule depuis un nombre compris entre 1 et 702\n * Le 2e paramtre est un boolen qui permet d'viter la lettre D (et donc dcale tout d'une lettre aprs le C) en vue du bug de MathLive\n * @author Rmi Angot\n *@Example\n * // 0 -> @ 1->A ; 2->B...\n * // 27->AA ; 28 ->AB ...\n */\nexport function lettreDepuisChiffre(i: number, saufD = false) {\n  let result = ''\n  if (i <= 26) {\n    result = String.fromCharCode(64 + i)\n    if (saufD && i >= 4) result = String.fromCharCode(64 + i + 1)\n  } else {\n    if (i % 26 === 0) {\n      result = String.fromCharCode(64 + Math.floor(i / 26) - 1)\n      result += String.fromCharCode(64 + 26)\n    } else {\n      result = String.fromCharCode(64 + Math.floor(i / 26))\n      result += String.fromCharCode(64 + (i % 26))\n    }\n  }\n  return result\n}\n\n/**\n * Renvoie une lettre minuscule depuis un nombre compris entre 1 et 702\n * @author Rmi Angot\n *@Example\n * // 0 -> @ 1->a ; 2->b...\n * // 27->aa ; 28 ->ab ...\n */\nexport function lettreMinusculeDepuisChiffre(i: number) {\n  return lettreDepuisChiffre(i).toLowerCase()\n}\n\n/**\n * Renvoie une lettre majuscule (ventuellement indice) depuis un nombre compris entre 1 et... sans limite.\n * @author Eric Elter\n *@Example\n * // 0 -> @ 1->A ; 2->B...\n * // 27->A_1 ; 28 ->A_2 ...\n */\nexport function lettreIndiceeDepuisChiffre(i: number) {\n  const indiceLettre =\n    quotientier(i - 1, 26) === 0 ? '' : quotientier(i - 1, 26)\n  return (\n    String.fromCharCode(64 + ((i - 1) % 26) + 1) +\n    (i > 26 ? `_{${indiceLettre}}` : '')\n  )\n}\n\n/**\n * Renvoie une lettre minuscule (ventuellement indice) depuis un nombre compris entre 1 et... sans limite.\n * @author EricElter\n *@Example\n * // 0 -> @ 1->a ; 2->b...\n * // 27->a_1 ; 28 ->a_2 ...\n */\nexport function lettreIndiceeMinusculeDepuisChiffre(i: number) {\n  return lettreIndiceeDepuisChiffre(i).toLowerCase()\n}\n\n/**\n * Renvoie un espace inscable pour le mode texte suivant la sortie html ou Latex.\n * @author Jean-Claude Lhote\n */\nexport function sp(nb = 1) {\n  let s = ''\n  for (let i = 0; i < nb; i++) {\n    if (context.isHtml) s += '&nbsp;'\n    else s += '\\\\,'\n  }\n  return s\n}\n\nexport function insertCharInString(str: string, index: number, char: string) {\n  return str.substring(0, index) + char + str.substring(index, str.length)\n}\n\n/**\n * Convertit en majuscule la premire lettre\n * @author Rmi Angot\n */\nexport function premiereLettreEnMajuscule(text: string) {\n  if (typeof text === 'string' && text.length > 0)\n    return (text + '').charAt(0).toUpperCase() + text.substring(1)\n  else return ''\n}\n\n/**\n * Cre une liste de questions alphabtique\n * @param {number} k valeur numrique\n * @author Sbastien Lozano (Rajout par EE, l'opportunit d'enlever l'espace final qui est par dfaut)\n */\nexport function numAlpha(k: number, nospace = false) {\n  if (context.isHtml)\n    return (\n      '<span style=\"color:#f15929; font-weight:bold\">' +\n      String.fromCharCode(97 + k) +\n      ')' +\n      (nospace ? '' : '&nbsp;') +\n      '</span>'\n    )\n  else\n    return (\n      '\\\\textbf {' + String.fromCharCode(97 + k) + '.}' + (nospace ? '' : ' ')\n    )\n}\n\n/**\n * Cre une liste de questions numrique\n * @param {number} k valeur numrique\n * @author Eric Elter\n */\nexport function numAlphaNum(k: number, nospace = false) {\n  k = k + 1\n  if (context.isHtml)\n    return (\n      '<span style=\"color:#f15929; font-weight:bold\">' +\n      k +\n      ')' +\n      (nospace ? '' : '&nbsp;') +\n      '</span>'\n    )\n  else return '\\\\textbf {' + k + '.}' + (nospace ? '' : ' ')\n}\n\nexport function reverseString(s: string) {\n  let str = ''\n  for (let i = 0; i < s.length; i++) {\n    str += s[s.length - 1 - i]\n  }\n  return str\n}\n","import { orangeMathalea } from 'apigeom/src/elements/defaultValues'\nimport Decimal from 'decimal.js'\nimport { equal, round } from 'mathjs'\nimport { context } from '../../modules/context'\nimport FractionEtendue from '../../modules/FractionEtendue'\nimport { fraction } from '../../modules/fractions'\nimport Grandeur from '../../modules/Grandeur'\nimport Hms from '../../modules/Hms'\nimport { egal } from '../../modules/outils'\nimport type { ReponseComplexe } from '../interactif/gestionInteractif'\nimport { miseEnEvidence } from './embellissements'\nimport { arrondi } from './nombres'\nimport { lettreDepuisChiffre } from './outilString'\nimport { stringNombre, texNombre } from './texNombre'\n\n/**\n * crit le nombre, mais pas un nombre s'il est gal  1\n * @Example\n * //rienSi1(1)+'x' -> x\n * //rienSi1(-1)+'x' -> -x\n * @author Rmi Angot et Jean-Claude Lhote pour le support des fractions\n */\nexport function rienSi1(a: number | FractionEtendue | Decimal) {\n  if (typeof a === 'number') {\n    if (a === 1) return ''\n    if (a === -1) return '-'\n    return texNombre(a)\n  }\n  if (a instanceof Decimal) {\n    if (a.eq(1)) return ''\n    if (a.eq(-1)) return '-'\n    return texNombre(a)\n  }\n  if (\n    a instanceof FractionEtendue &&\n    !(a.isEqual(fraction(1, 1)) || a.isEqual(fraction(-1, 1)))\n  ) {\n    return a.toLatex()\n  }\n  if (a instanceof FractionEtendue && a.isEqual(fraction(1, 1))) return ''\n  if (a instanceof FractionEtendue && a.isEqual(fraction(-1, 1))) return '-'\n  if (!(a instanceof FractionEtendue)) {\n    if (egal(a, 1)) return ''\n    if (egal(a, -1)) return '-'\n  }\n  if (typeof a === 'string') {\n    window.notify(\"rienSi1() n'accepte pas les string.\", { argument: a })\n    return texNombre(Number(a), 7)\n  }\n  window.notify('rienSi1 : type de valeur non prise en compte : ', { a })\n  return String(a)\n}\n\n/**\n * @param a Un nombre, une fraction ou une chane de caractres\n * @example\n * // rienSi0(0) -> ''\n * // rienSi0(2) -> '2'\n * @author Guillaume Valmont\n */\nexport function rienSi0(a: number | FractionEtendue | Decimal) {\n  if (typeof a === 'number') {\n    if (a === 0) return ''\n    return texNombre(a)\n  }\n  if (a instanceof Decimal) {\n    if (a.isZero()) return ''\n    return texNombre(a)\n  }\n  if (a instanceof FractionEtendue && !a.isEqual(fraction(0, 1))) {\n    return a.toLatex()\n  }\n  if (a instanceof FractionEtendue && a.isEqual(fraction(0, 1))) return ''\n  if (!(a instanceof FractionEtendue)) {\n    if (egal(a, 0)) return ''\n  }\n  if (typeof a === 'string') {\n    window.notify(\"rienSi0() n'accepte pas les string.\", { argument: a })\n    return texNombre(Number(a), 7)\n  }\n  window.notify('rienSi0 : type de valeur non prise en compte : ', { a })\n  return String(a)\n}\n\n/**\n * Gre l'criture de l'exposant en mode text (ne doit pas s'utiliser entre $ $)\n * Pour le mode maths (entre $ $) on utilisera tout simplement ^3 pour mettre au cube ou ^{42} pour la puissance 42.\n * @Example\n * // 'dm'+texteExposant(3)\n * @author Rmi Angot\n */\nexport function texteExposant(texte: string | number) {\n  if (typeof texte === 'number') texte = String(texte)\n  if (context.isHtml) {\n    return `<sup>${texte}</sup>`\n  } else {\n    return `\\\\up{${texte}}`\n  }\n}\n\n/**\n * Ajoute les parenthses et le signe\n * @Example\n * //(+3) ou (-3)\n * @author Rmi Angot\n */\nexport function ecritureNombreRelatif(a: number) {\n  if (typeof a === 'string') {\n    window.notify(\"ecritureNombreRelatif() n'accepte pas les string.\", {\n      argument: a,\n    })\n    a = Number(a)\n  }\n  if (a > 0) {\n    return '(+' + texNombre(a) + ')'\n  } else if (a < 0) {\n    return '(' + texNombre(a) + ')'\n  }\n  // ne pas mettre de parenthses pour le nombre 0.\n  return '0'\n}\n\n/**\n * Idem ecritureNombreRelatif avec le code couleur : vert si positif, rouge si ngatif, noir si nul\n * @param {number} a\n */\nexport function ecritureNombreRelatifc(\n  a: string | number,\n  { color = null }: { color?: string | null } = {},\n) {\n  if (typeof a === 'string') {\n    window.notify(\"ecritureNombreRelatifc() n'accepte pas les string.\", {\n      argument: a,\n    })\n    a = Number(a)\n  }\n  let result = ''\n  if (a > 0) {\n    result = miseEnEvidence('(+' + texNombre(a, 7) + ')', color ?? 'blue')\n  } else if (a < 0) {\n    result = miseEnEvidence('(' + texNombre(a, 7) + ')', color ?? 'green') // EE : Je change cette couleur pour ne pas avoir le orange de la correction.\n  } else {\n    // ne pas mettre de parenthses pour le nnombre 0.\n    result = miseEnEvidence('0', color ?? 'black')\n  }\n  return result\n}\n\n/**\n * Ajoute le + devant les nombres positifs\n * @Example\n * //+3 ou -3\n * @author Rmi Angot et Jean-claude Lhote pour le support des fractions\n */\nexport function ecritureAlgebrique(a: number | FractionEtendue | Decimal) {\n  if (typeof a === 'string') {\n    window.notify(\"ecritureAlgebrique() n'accepte pas les string.\", {\n      argument: a,\n    })\n    return a\n  } else if (a instanceof FractionEtendue) {\n    return a.texFractionSignee\n  } else if (typeof a === 'number') {\n    if (a >= 0) {\n      return '+' + texNombre(a, 7)\n    } else {\n      return texNombre(a, 7)\n    }\n  } else if (a instanceof Decimal) {\n    if (a.isPos()) {\n      return '+' + texNombre(a, 7)\n    } else {\n      return texNombre(a, 7)\n    }\n  } else {\n    window.notify('ecritureAlgebrique() : type de valeur non prise en compte', {\n      argument: a,\n    })\n    return ''\n  }\n}\n\n/**\n * Ajoute le + devant les nombres positifs, n'crit rien si 1\n * @Example\n * //+3 ou -3\n * @author Rmi Angot et Jean-Claude Lhote pour le support des fractions\n */\nexport function ecritureAlgebriqueSauf1(a: FractionEtendue | number | Decimal) {\n  if (a instanceof FractionEtendue) {\n    if (a.num === 1 && a.den === 1) return '+'\n    else if (a.num === -1 && a.den === 1) return '-'\n    else return a.texFractionSignee\n  }\n  if (typeof a === 'string') {\n    window.notify(\"ecritureAlgebriqueSauf1() n'accepte pas les string.\", {\n      argument: a,\n    })\n    a = Number(a)\n  }\n  if (equal(a, 1)) return '+'\n  else if (equal(a, -1)) return '-'\n  else if (typeof a === 'number' || a instanceof Decimal) {\n    return ecritureAlgebrique(a)\n  } else {\n    window.notify(\n      'ecritureAlgebriqueSauf1 : type de valeur non prise en compte',\n      {},\n    )\n    return 'erreur type de valeur non prise en compte'\n  }\n}\n\n/**\n * Idem ecritureAlgebrique mais retourne le nombre en couleur (vert si positif, rouge si ngatif et noir si nul).\n * @param {number} a\n */\nexport function ecritureAlgebriquec(a: number | string, color?: string) {\n  if (typeof a === 'string') {\n    window.notify(\"ecritureAlgebriquec() n'accepte pas les string.\", {\n      argument: a,\n    })\n    a = Number(a)\n  }\n  let result = ''\n  if (a > 0) {\n    result = miseEnEvidence('+' + texNombre(a, 7), color ?? 'blue')\n  } else if (a < 0) {\n    result = miseEnEvidence(texNombre(a, 7), color ?? orangeMathalea)\n  } else result = miseEnEvidence(texNombre(a, 7), color ?? 'black')\n  return result\n}\n\n/**\n * @param {number} r Un nombre relatif\n * @param {number} precision nombre de chiffres maximum aprs la virgule pour texNombre.\n * @returns {string} met en vidence le signe - si r < 0\n */\n\nexport function signeMoinsEnEvidence(r: number, precision = 0) {\n  if (typeof r !== 'number') {\n    window.notify(\n      \"signeMoinsEnEvidence() appel avec autre chose qu'un nombre.\",\n      { argument: r },\n    )\n  } else if (r < 0) {\n    return miseEnEvidence('-') + texNombre(Math.abs(r), precision)\n  } else return texNombre(Math.abs(r), precision)\n}\n\n/**\n * Ajoute des parenthses aux nombres ngatifs\n * @Example\n * // 3 ou (-3)\n * @author Rmi Angot\n * @return {string}\n */\nexport function ecritureParentheseSiNegatif(\n  a: Decimal | number | FractionEtendue,\n): string {\n  let result = ''\n  if (a instanceof Decimal) {\n    if (a.gte(0)) {\n      return texNombre(a, 8)\n      // On met 8 dcimales, mais cette fonctions s'utilise presque exclusivement avec des entiers donc a ne sert  rien\n    } else return `(${texNombre(a, 8)})`\n  } else if (typeof a === 'number') {\n    if (a >= 0) {\n      result = texNombre(a, 8) // j'ai pass le nombre dans texNombre, car la fonction ne prenait pas en compte l'criture dcimale !\n    } else {\n      result = `(${texNombre(a, 8)})`\n    }\n    return result\n  } else if (a instanceof FractionEtendue) {\n    return a.ecritureParentheseSiNegatif\n  } else {\n    window.notify(\n      \"ecritureParentheseSiNegatif() appele avec autre chose qu'un nombre\",\n      { argument: a },\n    )\n    return 'undefined'\n  }\n}\n\n/**\n * Ajoute des parenthses si une expression commence par un moins\n * @Example\n * // (-3x)\n * @author Rmi Angot\n */\nexport function ecritureParentheseSiMoins(\n  expr: string | number | FractionEtendue,\n) {\n  if (typeof expr === 'string' && expr[0] === '-') return `(${expr})`\n  else if (typeof expr === 'string') {\n    return expr\n    // Il faut sortir si c'est un string, il n'y a rien  faire de plus !\n  } else if (typeof expr === 'number' && expr < 0) {\n    return `(${stringNombre(expr, 7)})`\n  } else if (typeof expr === 'number') return stringNombre(expr, 7)\n  else if (expr instanceof FractionEtendue && expr.s === -1) {\n    return `(${expr.texFSD})`\n  } else {\n    // avant on passait ici quand c'tait un string sans signe - devant... c'tait une mauvaise ide !\n    window.notify(\n      \"ecritureParentheseSiMoins() n'accepte pas ce type d'argument.\",\n      { argument: expr },\n    )\n    return String(expr)\n  }\n}\n\n/**\n *\n * @author Jean-claude Lhote\n * @param {numero} 1=A, 2=B ...\n * @param {etapes} tableau de chaines comportant les expressions  afficher dans le membre de droite.\n */\n\nexport function calculAligne(numero: number, etapes: number[]) {\n  let script = `$\\\\begin{aligned}${miseEnEvidence(lettreDepuisChiffre(numero))}&=${etapes[0]}`\n  for (let i = 1; i < etapes.length - 1; i++) {\n    script += `\\\\\\\\&=${etapes[i]}`\n  }\n  script += `\\\\\\\\${miseEnEvidence(lettreDepuisChiffre(numero) + '&=' + etapes[etapes.length - 1])}$`\n  return script\n}\n\n/**\n * Retourne gal si la valeur est gale  l'arrondi souhait ou environ gal si ce n'est pas le cas\n * Le nombre a est compar  son arrondi  prcision prs. Si la diffrence est infrieure  epsilon, alors on retourne '=' sinon '\\\\approx'\n * fonctionne aussi si a est une fraction : permet de finir un calcul par la valeur dcimale si on veut.\n * @author Jean-Claude Lhote\n */\nexport function egalOuApprox(\n  a: number | FractionEtendue | Decimal,\n  precision: number,\n) {\n  if (a instanceof FractionEtendue) {\n    // @ ts-expect-errors\n    return egal(a.num / a.den, arrondi(a.num / a.den, precision))\n      ? '='\n      : '\\\\approx'\n  } else if (a instanceof Decimal) {\n    return a.eq(a.toDP(precision)) ? '=' : '\\\\approx'\n  } else if (!isNaN(a) && !isNaN(precision)) {\n    return egal(a, round(a, precision), 10 ** (-precision - 2))\n      ? '='\n      : '\\\\approx'\n  } else {\n    window.notify(\"egalOuApprox : l'argument n'est pas un nombre\", {\n      a,\n      precision,\n    })\n    return 'Mauvais argument (nombres attendus).'\n  }\n}\n\n/**\n * renvoie une chaine correspondant  l'criture rduite d'ax+b selon les valeurs de a et b\n * La lettre par dfaut utilise est 'x' mais peut tre tout autre chose.\n * @author Eric Elter\n * @param {number | Decimal | FractionEtendue} a\n * @param {number | Decimal | FractionEtendue} b\n * @param {string} [inconnue = 'x'] 'x' par dfaut, mais on peut prciser autre chose.\n */\nexport function reduireAxPlusB(\n  a: number | Decimal | FractionEtendue,\n  b: number | Decimal | FractionEtendue,\n  inconnue: string = 'x',\n  options: OptionsReduireAxPlusByPlusC = {},\n) {\n  return reduireAxPlusByPlusC(a, 0, b, inconnue, undefined, options)\n}\n\n/* Ancienne version de Jean-Claude Lhote\n\nif (!(a instanceof Decimal)) a = new Decimal(a)\n  if (!(b instanceof Decimal)) b = new Decimal(b)\n  let result = ''\n  if (!a.isZero()) {\n    if (a.eq(1)) result = inconnue\n    else if (a.eq(-1)) result = '-' + inconnue\n    else result = `${texNombre(a, 7)}${inconnue}`\n  }\n  if (!b.isZero()) {\n    if (a.isZero()) result = texNombre(b, 7)\n    else result += ecritureAlgebrique(b)\n  } else if (a.isZero()) result = '0'\n  return result\n} */\n\ntype OptionsReduireAxPlusByPlusC = {\n  ordreInverse?: boolean // Si true, on inverse l'ordre des termes dans la chane de caractres retourne\n}\n\n/**\n * renvoie une chaine correspondant  l'criture rduite d'ax+by+c selon les valeurs de a, b et c\n * Les lettres par dfaut utilises sont 'x' et y mais peut tre tout autre chose.\n * @author Eric Elter\n * @param {number | Decimal | FractionEtendue} a\n * @param {number | Decimal | FractionEtendue} b\n * @param {number | Decimal | FractionEtendue} c\n * @param {string} [inconnueX = 'x'] 'x' par dfaut, mais on peut prciser autre chose.\n * @param {string} [inconnueY = 'y'] 'y' par dfaut, mais on peut prciser autre chose.\n * @example reduireAxPlusByPlusC(3,-4,5) // renvoie 3x-4y+5\n * @example reduireAxPlusByPlusC(1,-1,0) // renvoie x-y\n * @example reduireAxPlusByPlusC(0,2,-7) // renvoie 2y-7\n * @example reduireAxPlusByPlusC(3,0,6) // renvoie 3x+6\n * @example reduireAxPlusByPlusC(0,0,0) // renvoie 0\n * @example reduireAxPlusByPlusC(3,-4,5,'a','b') // renvoie 3a-4b+5\n * @return {string}\n */\nexport function reduireAxPlusByPlusC(\n  a: number | Decimal | FractionEtendue,\n  b: number | Decimal | FractionEtendue,\n  c: number | Decimal | FractionEtendue,\n  inconnueX = 'x',\n  inconnueY = 'y',\n  options: OptionsReduireAxPlusByPlusC = {},\n) {\n  if (!(a instanceof Decimal) && !(a instanceof FractionEtendue)) {\n    a = new Decimal(a)\n  }\n  if (!(b instanceof Decimal) && !(b instanceof FractionEtendue)) {\n    b = new Decimal(b)\n  }\n  if (!(c instanceof Decimal) && !(c instanceof FractionEtendue)) {\n    c = new Decimal(c)\n  }\n  let valeurDecimaleFraction: number\n  let aEgalZero: boolean\n  let bEgalZero: boolean\n  let cEgalZero: boolean\n  let termeA: string\n  let termeB: string\n  let termeC: string\n  if (a instanceof Decimal) {\n    aEgalZero = a.isZero()\n    termeA = aEgalZero\n      ? ''\n      : (a.eq(1)\n          ? options.ordreInverse\n            ? '+'\n            : ''\n          : a.eq(-1)\n            ? '-'\n            : options.ordreInverse\n              ? ecritureAlgebriqueSauf1(a)\n              : texNombre(a)) + inconnueX\n  } else {\n    valeurDecimaleFraction = a.valeurDecimale\n    aEgalZero = valeurDecimaleFraction === 0\n    termeA = aEgalZero\n      ? ''\n      : (valeurDecimaleFraction === 1\n          ? options.ordreInverse\n            ? '+'\n            : ''\n          : valeurDecimaleFraction === -1\n            ? '-'\n            : options.ordreInverse\n              ? a.texFractionSignee\n              : a.texFSD) + inconnueX\n  }\n  if (b instanceof Decimal) {\n    bEgalZero = b.isZero()\n    termeB = bEgalZero\n      ? ''\n      : (b.eq(-1)\n          ? '-'\n          : b.eq(1) && aEgalZero\n            ? ''\n            : b.eq(1) && !aEgalZero\n              ? '+'\n              : aEgalZero\n                ? texNombre(b)\n                : ecritureAlgebrique(b)) + inconnueY\n  } else {\n    valeurDecimaleFraction = b.valeurDecimale\n    bEgalZero = valeurDecimaleFraction === 0\n    termeB = bEgalZero\n      ? ''\n      : (valeurDecimaleFraction === -1\n          ? '-'\n          : valeurDecimaleFraction === 1 && aEgalZero\n            ? ''\n            : valeurDecimaleFraction === 1 && !aEgalZero\n              ? '+'\n              : bEgalZero\n                ? `${b.texFSD}`\n                : `${b.texFractionSignee}`) + inconnueY\n  }\n  if (c instanceof Decimal) {\n    cEgalZero = c.isZero()\n    termeC =\n      aEgalZero && bEgalZero && cEgalZero\n        ? '0'\n        : cEgalZero\n          ? ''\n          : (aEgalZero && bEgalZero) || options.ordreInverse\n            ? texNombre(c)\n            : ecritureAlgebrique(c)\n  } else {\n    valeurDecimaleFraction = c.valeurDecimale\n    cEgalZero = valeurDecimaleFraction === 0\n    termeC =\n      aEgalZero && bEgalZero && cEgalZero\n        ? '0'\n        : cEgalZero\n          ? ''\n          : (aEgalZero && bEgalZero) || options.ordreInverse\n            ? `${c.texFSD}`\n            : `${c.texFractionSignee}`\n  }\n  const result = options.ordreInverse\n    ? `${termeC}${termeB}${termeA}`\n    : `${termeA}${termeB}${termeC}`\n  return result\n}\n/*\nvaleurDecimaleFraction = new FractionEtendue(n, d).valeurDecimale\nreponse = valeurDecimaleFraction === 0 ? '' : valeurDecimaleFraction === 1 ? 'x' : valeurDecimaleFraction === -1 ? '-x' : `${new FractionEtendue(n, d).texFractionSimplifiee}x`\nvaleurDecimaleFraction = new FractionEtendue(d * yA - n * xA, d).valeurDecimale\nreponse += new FractionEtendue(n, d).valeurDecimale === 0 && valeurDecimaleFraction === 0 ? '0' : valeurDecimaleFraction === 0 ? '' : `${new FractionEtendue(d * yA - n * xA, d).simplifie().texFractionSignee}`\n*/\n/**\n * renvoie une chaine correspondant  l'criture rduite d'ax^3+bx^2+cx+d selon les valeurs de a, b, c et d\n * @author Jean-Claude Lhote\n */\nexport function reduirePolynomeDegre3(\n  a: number | string,\n  b: number | string,\n  c: number | string,\n  d: number | string,\n  x = 'x',\n) {\n  ;[a, b, c, d].forEach((el) => (typeof el === 'number' ? el : Number(el)))\n  let result = ''\n  if (a !== 0) {\n    switch (a) {\n      case 1:\n        result += `${x}^3`\n        break\n      case -1:\n        result += `-${x}^3`\n        break\n      default:\n        result += `${a}${x}^3`\n        break\n    }\n    if (b !== 0) {\n      switch (b) {\n        case 1:\n          result += `+${x}^2`\n          break\n        case -1:\n          result += `-${x}^2`\n          break\n        default:\n          result += `${typeof b === 'number' ? ecritureAlgebrique(b) : b}${x}^2`\n          break\n      }\n    }\n    if (c !== 0) {\n      switch (c) {\n        case 1:\n          result += `+${x}`\n          break\n        case -1:\n          result += `-${x}`\n          break\n        default:\n          result += `${typeof c === 'number' ? ecritureAlgebrique(c) : c}${x}`\n          break\n      }\n    }\n    if (d !== 0) {\n      result += `${typeof d === 'number' ? ecritureAlgebrique(d) : d}`\n    }\n  } else {\n    // degr 2 pas de degr 3\n    if (b !== 0) {\n      switch (b) {\n        case 1:\n          result += `${x}^2`\n          break\n        case -1:\n          result += `-${x}^2`\n          break\n        default:\n          result += `${b}${x}^2`\n          break\n      }\n      if (c !== 0) {\n        switch (c) {\n          case 1:\n            result += `+${x}`\n            break\n          case -1:\n            result += `-${x}`\n            break\n          default:\n            result += `${typeof c === 'number' ? ecritureAlgebrique(c) : c}${x}`\n            break\n        }\n      }\n      if (d !== 0) {\n        result += `${typeof d === 'number' ? ecritureAlgebrique(d) : d}`\n      }\n    } else if (c !== 0) {\n      // degr 1 pas de degr 2 ni de degr 3\n      switch (c) {\n        case 1:\n          result += `${x}`\n          break\n        case -1:\n          result += `-${x}`\n          break\n        default:\n          result += `${c}${x}`\n          break\n      }\n      if (d !== 0) {\n        result += `${typeof d === 'number' ? ecritureAlgebrique(d) : d}`\n      }\n    } else {\n      // degr 0 a=0, b=0 et c=0\n      result += `${d}`\n    }\n  }\n  return result\n}\n\nexport function ordreAlphabetique(str: string): string {\n  const chars = Array.from(str)\n  const orderedChars = chars.sort((a, b) => a.charCodeAt(0) - b.charCodeAt(0))\n  return orderedChars.join('')\n}\n\n/**\n * Liste les diffrents lments d'un array spars par une virgule et un \"et\" avant le dernier lment\n * @param array\n * @returns une chane  afficher\n */\nexport function lister(array: unknown[]): string {\n  let str = ''\n  for (let i = 0; i < array.length - 1; i++) {\n    if (i !== 0) str += ', '\n    str += array[i]\n  }\n  if (array.length > 1) str += ' et '\n  str += array[array.length - 1]\n  return str\n}\n\n/**\n * Retourne le double dveloppement de (ax+b)(cx+d) sous forme d'un tableau.\n * La premier lment est le dveloppement terme par terme.\n * Le second lment est ce dveloppement rduit terme par terme.\n * Si reduire est vrai, et qu'il y a des parenthses encadrant les termes ngatifs, on renvoie aussi le dveloppement rduit en somme algbrique.\n * @param {Object} parametres  saisir entre accolades\n * @param {number} [a=1] Un entier actuellement uniquement (par dfaut, c'est 1)\n * @param {number} [b=1] Un entier actuellement uniquement (par dfaut, c'est 1)\n * @param {number} [c=1] Un entier actuellement uniquement(par dfaut, c'est 1)\n * @param {string} [x='x'] Le nom de la variable (par dfaut, c'est 'x')\n * @param {boolean} [reduire=false] Vrai si on veut rduire le dveloppement en somme algbrique\n * @return {string[]}\n * @author Eric Elter\n * @example doubleDeveloppement({ a:5, b:-2, c:-1, d:4})[0] renvoie 5x*(-x)+5x*4+(-2)*(-x)+(-2)*4\n * @example doubleDeveloppement({ a:5, b:-2, c:-1, d:4})[1] renvoie -5x^2+20x+2x+(-8)\n * @example doubleDeveloppement({ a:5, b:-2, c:-1, d:4, variable:'y})[0] renvoie 5y*(-y)+5y*4+(-2)*(-y)+(-2)*4\n * @example doubleDeveloppement({ a:5, b:-2, c:-1, d:4, variable:'y})[1] renvoie -5y^2+20y+2y+(-8)\n */\nexport function doubleDeveloppement({\n  a = 1,\n  b = 1,\n  c = 1,\n  d = 1,\n  x = 'x',\n  reduire = false,\n} = {}) {\n  if (a === 0) {\n    return [\n      ...simpleDeveloppement({ a: c, b: d, c: b, x, sommeAGauche: false }),\n    ]\n  }\n  if (b === 0) {\n    return [\n      ...simpleDeveloppementAvecDoubleX({\n        a: c,\n        b: d,\n        c: a,\n        x,\n        sommeAGauche: false,\n      }),\n    ]\n  }\n  if (c === 0) return [...simpleDeveloppement({ a, b, c: d, x })]\n  if (d === 0) return [...simpleDeveloppementAvecDoubleX({ a, b, c, x })]\n  const expression1 = `${rienSi1(a)}${x}\\\\times ${ecritureParentheseSiMoins(rienSi1(c) + x)} + \n  ${ecritureParentheseSiMoins(rienSi1(a) + x)}\\\\times ${ecritureParentheseSiNegatif(d)} +\n  ${ecritureParentheseSiNegatif(b)} \\\\times ${ecritureParentheseSiMoins(rienSi1(c) + x)}  +\n  ${ecritureParentheseSiNegatif(b)} \\\\times ${ecritureParentheseSiNegatif(d)}`\n  const expression2 = `${rienSi1(a * c)}${x}^2 + \n  ${ecritureParentheseSiMoins(rienSi1(a * d) + x)} +\n  ${ecritureParentheseSiMoins(rienSi1(b * c) + x)} +\n  ${ecritureParentheseSiNegatif(b * d)}`\n  const expression3 = `${rienSi1(a * c)}${x}^2\n  ${ecritureAlgebriqueSauf1(a * d)}${x}\n  ${ecritureAlgebriqueSauf1(b * c)}${x}\n  ${ecritureAlgebrique(b * d)}`\n  return reduire && expression2 !== expression3\n    ? [expression1, expression2, expression3]\n    : [expression1, expression2]\n}\n\n/**\n * Retourne le simple dveloppement de (ax+b)c ou c(ax+b) sous forme d'un tableau.\n * La premier lment est le dveloppement terme par terme.\n * Le second lment est ce dveloppement rduit terme par terme.\n * @param {Object} parametres  saisir entre accolades\n * @param {number} [a=1] Un entier actuellement uniquement (par dfaut, c'est 1)\n * @param {number} [b=1] Un entier actuellement uniquement (par dfaut, c'est 1)\n * @param {number} [c=1] Un entier actuellement uniquement(par dfaut, c'est 1)\n * @param {string} [x='x'] Le nom de la variable (par dfaut, c'est 'x')\n * @param {boolean} [sommeAGauche=true] Vrai si (ax+b)c, Faux si c(ax+b)\n * @return {string[]}\n * @author Eric Elter\n * @example simpleDeveloppement({ a:5, b:-2, c:3})[0] renvoie 5x*3+(-2)*3\n * @example simpleDeveloppement({ a:5, b:-2, c:3})[1] renvoie 15x+(-6)\n * @example simpleDeveloppement({ a:5, b:-2, c:3, variable:'y, sommeAGauche:false})[0] renvoie 3*5y+3*(-2)\n * @example simpleDeveloppement({ a:5, b:-2, c:3, variable:'y, sommeAGauche:false})[1] renvoie 15y+(-6)\n */\nexport function simpleDeveloppement({\n  a = 1,\n  b = 1,\n  c = 1,\n  x = 'x',\n  sommeAGauche = true,\n} = {}) {\n  if (a === 0) {\n    return [\n      sommeAGauche\n        ? `${rienSi1(b)} \\\\times ${ecritureParentheseSiNegatif(c)}`\n        : `${rienSi1(c)} \\\\times ${ecritureParentheseSiNegatif(b)}`,\n      `${rienSi1(b * c)}`,\n    ]\n  }\n  if (b === 0) {\n    return [\n      sommeAGauche\n        ? `${rienSi1(a)}${x}} \\\\times ${ecritureParentheseSiNegatif(c)}`\n        : `${rienSi1(c)} \\\\times ${ecritureParentheseSiMoins(rienSi1(a) + x)}`,\n      `${rienSi1(a * c)}${x}`,\n    ]\n  }\n  if (c === 0) {\n    return [0, 0]\n  }\n  return [\n    sommeAGauche\n      ? `${rienSi1(a)}${x}\\\\times ${ecritureParentheseSiNegatif(c)} +\n    ${ecritureParentheseSiNegatif(b)} \\\\times ${ecritureParentheseSiNegatif(c)}`\n      : `${rienSi1(c)} \\\\times ${ecritureParentheseSiMoins(rienSi1(a) + x)} +\n      ${ecritureParentheseSiNegatif(c)} \\\\times ${ecritureParentheseSiNegatif(b)}`,\n    `${rienSi1(a * c)}${x} + \n    ${ecritureParentheseSiMoins(rienSi1(b * c) ?? '')}`,\n  ]\n}\n\n/**\n * Retourne le simple dveloppement de (ax+b)cx ou cx(ax+b) sous forme d'un tableau.\n * La premier lment est le dveloppement terme par terme.\n * Le second lment est ce dveloppement rduit terme par terme.\n * @param {Object} parametres  saisir entre accolades\n * @param {number} [a=1] Un entier actuellement uniquement (par dfaut, c'est 1)\n * @param {number} [b=1] Un entier actuellement uniquement (par dfaut, c'est 1)\n * @param {number} [c=1] Un entier actuellement uniquement(par dfaut, c'est 1)\n * @param {string} [x='x'] Le nom de la variable (par dfaut, c'est 'x')\n * @param {boolean} [sommeAGauche=true] Vrai si (ax+b)c, Faux si c(ax+b) (par dfaut, c'est vrai)\n * @return {string[]}\n * @author Eric Elter\n * @example simpleDeveloppementAvecDoubleX({ a:5, b:-2, c:3})[0] renvoie 5x*3x+(-2)*3x\n * @example simpleDeveloppementAvecDoubleX({ a:5, b:-2, c:3})[1] renvoie 15x^2+(-6x)\n * @example simpleDeveloppementAvecDoubleX({ a:5, b:-2, c:3, variable:'y, sommeAGauche:false})[0] renvoie 3y*5y+3y*(-2)\n * @example simpleDeveloppementAvecDoubleX({ a:5, b:-2, c:3, variable:'y, sommeAGauche:false})[1] renvoie 15y^2+(-6y)\n */\nexport function simpleDeveloppementAvecDoubleX({\n  a = 1,\n  b = 1,\n  c = 1,\n  x = 'x',\n  sommeAGauche = true,\n  doubleX = true,\n} = {}) {\n  const xCarre = doubleX ? x + '^2' : x\n  const xSeul = doubleX ? x : ''\n  if (a === 0) {\n    return [\n      sommeAGauche\n        ? `${rienSi1(b)} \\\\times ${ecritureParentheseSiMoins(rienSi1(c) + x)}`\n        : `${rienSi1(c)}${x} \\\\times ${ecritureParentheseSiNegatif(b)}`,\n      `${rienSi1(b * c)}${x}`,\n    ]\n  }\n  if (b === 0) {\n    return [\n      sommeAGauche\n        ? `${rienSi1(a)}${x}} \\\\times ${ecritureParentheseSiMoins(rienSi1(c) + x)}`\n        : `${rienSi1(c)}${x} \\\\times ${ecritureParentheseSiMoins(rienSi1(a) + x)}`,\n      `${rienSi1(a * c)}${x}`,\n    ]\n  }\n  if (c === 0) {\n    return [0, 0]\n  }\n  return [\n    sommeAGauche\n      ? `${rienSi1(a)}${x}\\\\times ${ecritureParentheseSiMoins(rienSi1(c) + xSeul)} +\n    ${ecritureParentheseSiNegatif(b)} \\\\times ${ecritureParentheseSiMoins(rienSi1(c) + xSeul)}`\n      : `${rienSi1(c)}${xSeul} \\\\times ${ecritureParentheseSiMoins(rienSi1(a) + x)} +\n      ${ecritureParentheseSiMoins(rienSi1(c) + xSeul)} \\\\times ${ecritureParentheseSiNegatif(b)}`,\n    `${rienSi1(a * c)}${xCarre} + \n      ${ecritureParentheseSiMoins(rienSi1(b * c) + xSeul)}`,\n  ]\n}\n\n/**\n * Formate une rponse pour son affichage, par exemple pour formater les diffrents distracteurs de la version qcm d'un exercice de type simple.\n * Si la rponse est un tableau, elle formate le premier lment.\n * @param a La valeur  formater\n * @returns {string} La valeur formate pour l'affichage\n */\nexport function formaterReponse(a: ReponseComplexe | undefined) {\n  if (Array.isArray(a)) {\n    return formaterReponse(a[0])\n  }\n  if (typeof a === 'number' || a instanceof Decimal) {\n    return `$${texNombre(a, 7)}$`\n  }\n  if (a instanceof FractionEtendue) {\n    return `$${a.texFraction}$`\n  }\n  if (typeof a === 'string') {\n    return a\n  }\n  if (a instanceof Grandeur) {\n    return `$${a.toTex()}$`\n  }\n  if (a instanceof Hms) {\n    return a.toString()\n  }\n  window.notify('formaterReponse : type de valeur non prise en compte : ', {\n    a,\n  })\n  return String(a)\n}\n","import { gcd, isPrime } from 'mathjs'\nimport { egal } from '../../modules/outils.js'\nimport { ecritureParentheseSiNegatif } from './ecritures'\nimport { abs } from './nombres'\n\n/**\n * Renvoie le PGCD de deux nombres\n * @author Rmi Angot\n */\nexport function pgcd(...args: number[]) {\n  return gcd(...args)\n}\n\n/**\n * Renvoie le PPCM de deux nombres\n * @author Rmi Angot\n */\nexport function ppcm(a: number, b: number): number {\n  if (a === 0 || b === 0) return 0\n  return Math.abs(a * b) / pgcd(a, b)\n}\n\n/**\n * Renvoie le PPCM d'une liste de nombres\n * @param numbers - Liste des nombres\n * @returns Le PPCM de tous les nombres de la liste\n * @author Nathan Scheinmann\n */\nexport function ppcmListe(numbers: number[]): number {\n  if (numbers.length === 0) return 0\n  if (numbers.length === 1) return Math.abs(numbers[0])\n\n  return numbers.reduce((acc, current) => ppcm(acc, current))\n}\n\n/**\n * Donne la liste des facteurs premiers d'un nombre\n * @param { number } n - Nombre  dcomposer\n * @returns {number[]} - Liste des facteurs premiers\n */\nexport function obtenirListeFacteursPremiers(n: number) {\n  if (n === 1 || n === 0) return [] // 1 n'est pas premier, mais, sinon, a retourne [NaN]\n  const facteurs = []\n  const signe = n < 0 ? -1 : 1\n  for (let i = 2; i <= Math.abs(n); i++) {\n    while (n % i === 0) {\n      facteurs.push(i)\n      n /= i\n    }\n  }\n  facteurs[0] = signe * facteurs[0]\n  return facteurs\n}\n\n/**\n *\n * @param {Entier} n\n * Retourne la factorisation d'un entier sous la forme [[a0,n0],[a1,n1],...] o a0,a1 sont les facteurs premiers et n0, n1 sont les exposants de ces facteurs.\n * @author Jean-Claude Lhote\n */\n\nexport function factorisation(n: number): [number, number][] {\n  if (n === 1) return [[1, 1]]\n  const liste = obtenirListeFacteursPremiers(n)\n  const facto: [number, number][] = []\n  let index = 0\n  for (let i = 0; i < liste.length; ) {\n    if (liste[i] === 0) i++\n    else {\n      facto.push([liste[i], 1])\n      index++\n      for (let j = i + 1; j < liste.length; j++) {\n        if (liste[j] === liste[i]) {\n          facto[index - 1][1]++\n          liste[j] = 0\n        }\n      }\n      i++\n    }\n  }\n  return facto\n}\n\n/**\n *\n * @param {number} n\n * @param {boolean} puissancesOn\n * @returns {string} texFacto\n */\nexport function texFactorisation(n: number, puissancesOn = true) {\n  let texFacto = ''\n  let facto = []\n  if (puissancesOn) {\n    facto = factorisation(n)\n    for (let i = 0; i < facto.length - 1; i++) {\n      texFacto += `${facto[i][0]}${facto[i][1] > 1 ? '^{' + facto[i][1] + '}\\\\times ' : '\\\\times '}`\n    }\n    texFacto += `${facto[facto.length - 1][0]}${facto[facto.length - 1][1] > 1 ? '^{' + facto[facto.length - 1][1] + '}' : ''}`\n  } else {\n    facto = obtenirListeFacteursPremiers(n)\n    for (let i = 0; i < facto.length - 1; i++) {\n      texFacto += `${facto[i]}\\\\times `\n    }\n    texFacto += `${facto[facto.length - 1]}`\n  }\n  return texFacto\n}\n\n/**\n * Renvoie un tableau contenant les diviseurs d'un nombre entier, rangs dans l'ordre croissant\n * @param {number} n\n * @author Sbastien Lozano\n */\nexport function listeDesDiviseurs(n: number) {\n  let i = 2\n  const diviseurs = [1]\n  while (i <= n) {\n    if (n % i === 0) {\n      diviseurs.push(i)\n    }\n    i++\n  }\n  return diviseurs\n}\n\nexport function estPremier(n: number) {\n  return listeDesDiviseurs(n).length === 2 && n > 1\n}\n/**\n * Retourne la liste des nombres premiers infrieurs  N N<300 N exclu\n * @param {number} k On cherchera un multiple de k\n * @param {number} n Ce multiple sera suprieur ou gal  n\n * @author Rmi Angot\n */\nexport function premierMultipleSuperieur(k: number, n: number) {\n  let result = n\n  let reste\n  if (Number.isInteger(k) && Number.isInteger(n)) {\n    while (result % k !== 0) {\n      result += 1\n    }\n    return result\n  } else {\n    if (egal(Math.floor(n / k), n / k)) return n\n    else {\n      reste = n / k - Math.floor(n / k)\n      return n - reste * k + k\n    }\n  }\n}\n\nexport function premierMultipleInferieur(k: number, n: number) {\n  const result = premierMultipleSuperieur(k, n)\n  if (result !== n) return result - k\n  else return n\n}\n\n/**\n * Retourne la liste des nombres premiers infrieurs  N N<1000 N exclu\n * @param {number} borneSup\n * @author Sbastien Lozano\n * Augment des N<300  N<1000 par Guillaume Valmont\n */\nexport function listeNombresPremiersStrictJusqua(borneSup: number) {\n  // tableau contenant les 1000 premiers nombres premiers\n  const liste1000 = [\n    2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71,\n    73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151,\n    157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233,\n    239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317,\n    331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419,\n    421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503,\n    509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601, 607,\n    613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701,\n    709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773, 787, 797, 809, 811,\n    821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911,\n    919, 929, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997, 1009, 1013,\n    1019, 1021, 1031, 1033, 1039, 1049, 1051, 1061, 1063, 1069, 1087, 1091,\n    1093, 1097, 1103, 1109, 1117, 1123, 1129, 1151, 1153, 1163, 1171, 1181,\n    1187, 1193, 1201, 1213, 1217, 1223, 1229, 1231, 1237, 1249, 1259, 1277,\n    1279, 1283, 1289, 1291, 1297, 1301, 1303, 1307, 1319, 1321, 1327, 1361,\n    1367, 1373, 1381, 1399, 1409, 1423, 1427, 1429, 1433, 1439, 1447, 1451,\n    1453, 1459, 1471, 1481, 1483, 1487, 1489, 1493, 1499, 1511, 1523, 1531,\n    1543, 1549, 1553, 1559, 1567, 1571, 1579, 1583, 1597, 1601, 1607, 1609,\n    1613, 1619, 1621, 1627, 1637, 1657, 1663, 1667, 1669, 1693, 1697, 1699,\n    1709, 1721, 1723, 1733, 1741, 1747, 1753, 1759, 1777, 1783, 1787, 1789,\n    1801, 1811, 1823, 1831, 1847, 1861, 1867, 1871, 1873, 1877, 1879, 1889,\n    1901, 1907, 1913, 1931, 1933, 1949, 1951, 1973, 1979, 1987, 1993, 1997,\n    1999, 2003, 2011, 2017, 2027, 2029, 2039, 2053, 2063, 2069, 2081, 2083,\n    2087, 2089, 2099, 2111, 2113, 2129, 2131, 2137, 2141, 2143, 2153, 2161,\n    2179, 2203, 2207, 2213, 2221, 2237, 2239, 2243, 2251, 2267, 2269, 2273,\n    2281, 2287, 2293, 2297, 2309, 2311, 2333, 2339, 2341, 2347, 2351, 2357,\n    2371, 2377, 2381, 2383, 2389, 2393, 2399, 2411, 2417, 2423, 2437, 2441,\n    2447, 2459, 2467, 2473, 2477, 2503, 2521, 2531, 2539, 2543, 2549, 2551,\n    2557, 2579, 2591, 2593, 2609, 2617, 2621, 2633, 2647, 2657, 2659, 2663,\n    2671, 2677, 2683, 2687, 2689, 2693, 2699, 2707, 2711, 2713, 2719, 2729,\n    2731, 2741, 2749, 2753, 2767, 2777, 2789, 2791, 2797, 2801, 2803, 2819,\n    2833, 2837, 2843, 2851, 2857, 2861, 2879, 2887, 2897, 2903, 2909, 2917,\n    2927, 2939, 2953, 2957, 2963, 2969, 2971, 2999, 3001, 3011, 3019, 3023,\n    3037, 3041, 3049, 3061, 3067, 3079, 3083, 3089, 3109, 3119, 3121, 3137,\n    3163, 3167, 3169, 3181, 3187, 3191, 3203, 3209, 3217, 3221, 3229, 3251,\n    3253, 3257, 3259, 3271, 3299, 3301, 3307, 3313, 3319, 3323, 3329, 3331,\n    3343, 3347, 3359, 3361, 3371, 3373, 3389, 3391, 3407, 3413, 3433, 3449,\n    3457, 3461, 3463, 3467, 3469, 3491, 3499, 3511, 3517, 3527, 3529, 3533,\n    3539, 3541, 3547, 3557, 3559, 3571, 3581, 3583, 3593, 3607, 3613, 3617,\n    3623, 3631, 3637, 3643, 3659, 3671, 3673, 3677, 3691, 3697, 3701, 3709,\n    3719, 3727, 3733, 3739, 3761, 3767, 3769, 3779, 3793, 3797, 3803, 3821,\n    3823, 3833, 3847, 3851, 3853, 3863, 3877, 3881, 3889, 3907, 3911, 3917,\n    3919, 3923, 3929, 3931, 3943, 3947, 3967, 3989, 4001, 4003, 4007, 4013,\n    4019, 4021, 4027, 4049, 4051, 4057, 4073, 4079, 4091, 4093, 4099, 4111,\n    4127, 4129, 4133, 4139, 4153, 4157, 4159, 4177, 4201, 4211, 4217, 4219,\n    4229, 4231, 4241, 4243, 4253, 4259, 4261, 4271, 4273, 4283, 4289, 4297,\n    4327, 4337, 4339, 4349, 4357, 4363, 4373, 4391, 4397, 4409, 4421, 4423,\n    4441, 4447, 4451, 4457, 4463, 4481, 4483, 4493, 4507, 4513, 4517, 4519,\n    4523, 4547, 4549, 4561, 4567, 4583, 4591, 4597, 4603, 4621, 4637, 4639,\n    4643, 4649, 4651, 4657, 4663, 4673, 4679, 4691, 4703, 4721, 4723, 4729,\n    4733, 4751, 4759, 4783, 4787, 4789, 4793, 4799, 4801, 4813, 4817, 4831,\n    4861, 4871, 4877, 4889, 4903, 4909, 4919, 4931, 4933, 4937, 4943, 4951,\n    4957, 4967, 4969, 4973, 4987, 4993, 4999, 5003, 5009, 5011, 5021, 5023,\n    5039, 5051, 5059, 5077, 5081, 5087, 5099, 5101, 5107, 5113, 5119, 5147,\n    5153, 5167, 5171, 5179, 5189, 5197, 5209, 5227, 5231, 5233, 5237, 5261,\n    5273, 5279, 5281, 5297, 5303, 5309, 5323, 5333, 5347, 5351, 5381, 5387,\n    5393, 5399, 5407, 5413, 5417, 5419, 5431, 5437, 5441, 5443, 5449, 5471,\n    5477, 5479, 5483, 5501, 5503, 5507, 5519, 5521, 5527, 5531, 5557, 5563,\n    5569, 5573, 5581, 5591, 5623, 5639, 5641, 5647, 5651, 5653, 5657, 5659,\n    5669, 5683, 5689, 5693, 5701, 5711, 5717, 5737, 5741, 5743, 5749, 5779,\n    5783, 5791, 5801, 5807, 5813, 5821, 5827, 5839, 5843, 5849, 5851, 5857,\n    5861, 5867, 5869, 5879, 5881, 5897, 5903, 5923, 5927, 5939, 5953, 5981,\n    5987, 6007, 6011, 6029, 6037, 6043, 6047, 6053, 6067, 6073, 6079, 6089,\n    6091, 6101, 6113, 6121, 6131, 6133, 6143, 6151, 6163, 6173, 6197, 6199,\n    6203, 6211, 6217, 6221, 6229, 6247, 6257, 6263, 6269, 6271, 6277, 6287,\n    6299, 6301, 6311, 6317, 6323, 6329, 6337, 6343, 6353, 6359, 6361, 6367,\n    6373, 6379, 6389, 6397, 6421, 6427, 6449, 6451, 6469, 6473, 6481, 6491,\n    6521, 6529, 6547, 6551, 6553, 6563, 6569, 6571, 6577, 6581, 6599, 6607,\n    6619, 6637, 6653, 6659, 6661, 6673, 6679, 6689, 6691, 6701, 6703, 6709,\n    6719, 6733, 6737, 6761, 6763, 6779, 6781, 6791, 6793, 6803, 6823, 6827,\n    6829, 6833, 6841, 6857, 6863, 6869, 6871, 6883, 6899, 6907, 6911, 6917,\n    6947, 6949, 6959, 6961, 6967, 6971, 6977, 6983, 6991, 6997, 7001, 7013,\n    7019, 7027, 7039, 7043, 7057, 7069, 7079, 7103, 7109, 7121, 7127, 7129,\n    7151, 7159, 7177, 7187, 7193, 7207, 7211, 7213, 7219, 7229, 7237, 7243,\n    7247, 7253, 7283, 7297, 7307, 7309, 7321, 7331, 7333, 7349, 7351, 7369,\n    7393, 7411, 7417, 7433, 7451, 7457, 7459, 7477, 7481, 7487, 7489, 7499,\n    7507, 7517, 7523, 7529, 7537, 7541, 7547, 7549, 7559, 7561, 7573, 7577,\n    7583, 7589, 7591, 7603, 7607, 7621, 7639, 7643, 7649, 7669, 7673, 7681,\n    7687, 7691, 7699, 7703, 7717, 7723, 7727, 7741, 7753, 7757, 7759, 7789,\n    7793, 7817, 7823, 7829, 7841, 7853, 7867, 7873, 7877, 7879, 7883, 7901,\n    7907, 7919, 7927, 7933, 7937, 7949, 7951, 7963, 7993, 8009, 8011, 8017,\n    8039, 8053, 8059, 8069, 8081, 8087, 8089, 8093, 8101, 8111, 8117, 8123,\n    8147, 8161, 8167, 8171, 8179, 8191, 8209, 8219, 8221, 8231, 8233, 8237,\n    8243, 8263, 8269, 8273, 8287, 8291, 8293, 8297, 8311, 8317, 8329, 8353,\n    8363, 8369, 8377, 8387, 8389, 8419, 8423, 8429, 8431, 8443, 8447, 8461,\n    8467, 8501, 8513, 8521, 8527, 8537, 8539, 8543, 8563, 8573, 8581, 8597,\n    8599, 8609, 8623, 8627, 8629, 8641, 8647, 8663, 8669, 8677, 8681, 8689,\n    8693, 8699, 8707, 8713, 8719, 8731, 8737, 8741, 8747, 8753, 8761, 8779,\n    8783, 8803, 8807, 8819, 8821, 8831, 8837, 8839, 8849, 8861, 8863, 8867,\n    8887, 8893, 8923, 8929, 8933, 8941, 8951, 8963, 8969, 8971, 8999, 9001,\n    9007, 9011, 9013, 9029, 9041, 9043, 9049, 9059, 9067, 9091, 9103, 9109,\n    9127, 9133, 9137, 9151, 9157, 9161, 9173, 9181, 9187, 9199, 9203, 9209,\n    9221, 9227, 9239, 9241, 9257, 9277, 9281, 9283, 9293, 9311, 9319, 9323,\n    9337, 9341, 9343, 9349, 9371, 9377, 9391, 9397, 9403, 9413, 9419, 9421,\n    9431, 9433, 9437, 9439, 9461, 9463, 9467, 9473, 9479, 9491, 9497, 9511,\n    9521, 9533, 9539, 9547, 9551, 9587, 9601, 9613, 9619, 9623, 9629, 9631,\n    9643, 9649, 9661, 9677, 9679, 9689, 9697, 9719, 9721, 9733, 9739, 9743,\n    9749, 9767, 9769, 9781, 9787, 9791, 9803, 9811, 9817, 9829, 9833, 9839,\n    9851, 9857, 9859, 9871, 9883, 9887, 9901, 9907, 9923, 9929, 9931, 9941,\n    9949, 9967, 9973,\n  ]\n  const liste = []\n  let i = 0\n  while (liste1000[i] < borneSup) {\n    liste.push(liste1000[i])\n    i++\n  }\n  return liste\n}\n\n/**\n * Liste les nombres premiers jusque n avec la mthode du crible d'Eratosthene optimise\n * @param {number} n\n * @author Sbastien Lozano\n */\nexport function cribleEratostheneN(n: number) {\n  const tabEntiers = [] // pour tous les entiers de 2  n\n  const testMax = Math.sqrt(n + 1) // inutile de tester au dela de racine de n\n  const liste = [] // tableau de la liste des premiers jusqu' n\n\n  // On rempli un tableau avec des booleens de 2  n\n  for (let i = 0; i < n + 1; i++) {\n    tabEntiers.push(true)\n  }\n\n  // On supprime les multiples des nombres premiers  partir de 2, 3, 5,...\n  for (let i = 2; i <= testMax; i++) {\n    if (tabEntiers[i]) {\n      for (let j = i * i; j < n + 1; j += i) {\n        tabEntiers[j] = false\n      }\n    }\n  }\n\n  // On rcupre tous les indices du tableau des entiers dont le boolen est  true qui sont donc premiers\n  for (let i = 2; i < n + 1; i++) {\n    if (tabEntiers[i]) {\n      liste.push(i)\n    }\n  }\n\n  return liste\n}\n\n/**\n * Liste les premiers compris entre min et max au sens large,\n * min est inclu\n * max est inclu.\n * @param {number} min\n * @param {number} max\n * @author Sbastien Lozano\n */\n\nexport function premiersEntreBornes(min: number, max: number) {\n  // on cre les premiers jusque min\n  const premiersASupprimer = cribleEratostheneN(min - 1)\n  // on cre les premiers jusque max\n  const premiersJusqueMax = cribleEratostheneN(max)\n  // on supprime le dbut de la liste jusque min\n  premiersJusqueMax.splice(0, premiersASupprimer.length)\n  // on renvoie le tableau restant\n  return premiersJusqueMax\n}\n\n/**\n * renvoie un tableau avec la decomposition en facteurs premiers sous forme dveloppe\n * @param {number} n\n * @author Sbastien Lozano\n */\nexport function decompositionFacteursPremiersArray(n: number) {\n  const decomposition = []\n  const liste = obtenirListeFacteursPremiers(n)\n  for (const i in liste) {\n    decomposition.push(liste[i])\n  }\n  return decomposition\n}\n\n/**\n * Retourne la liste des nombres premiers infrieurs  300\n * @author Rmi Angot\n */\nexport function obtenirListeNombresPremiers(n = 300) {\n  const prems = [\n    2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71,\n    73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151,\n    157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233,\n    239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293,\n  ]\n  for (let i = 307; i <= n; i++) {\n    if (isPrime(i)) prems.push(i)\n  }\n  return prems\n}\n\n/**\n * Retourne le code LaTeX de la dcomposition en produit de facteurs premiers d'un nombre\n * @author Rmi Angot\n */\nexport function decompositionFacteursPremiers(n: number) {\n  let decomposition = ''\n  if (abs(n) === 1) return n // EE : Ncessaire pour 4C22... Vrifier si aucun dommage collatral ailleurs (29/04/2024)\n  const liste = obtenirListeFacteursPremiers(n)\n  for (const i in liste) {\n    decomposition += ecritureParentheseSiNegatif(liste[i]) + '\\\\times'\n  }\n  decomposition = decomposition.substr(0, decomposition.length - 6)\n  return decomposition\n}\n\n/**\n *\n * @param {number} n\n * @param {boolean} infrieur si true, commence la recherche  2 en croissant sinon commence  n+1\n * @returns {number}\n */\nexport function premierAvec(\n  n: number,\n  listeAEviter: number[] = [],\n  inferieur = true,\n) {\n  if (n < 2) throw Error(`Impossible de trouver un nombre premier avec ${n}`)\n  let candidat = inferieur ? 2 : n + 1\n  do {\n    if (pgcd(n, candidat) === 1 && !listeAEviter.includes(candidat))\n      return candidat\n    candidat++\n  } while (true)\n}\n","import Decimal from 'decimal.js'\nimport { factorisation } from './primalite'\nimport { texNombre } from './texNombre'\n\n/**\n * Retourne la somme des chiffres (ou d'un tableau de chiffres) d'un nombre en valeur et sous forme de String [valeur, String]\n * @Example\n * sommeDesChiffres(123)\n * // [ 6, '1+2+3']\n * @author Rmi Angot (Rajout Tableau par EE)\n */ export function sommeDesChiffres(n: number) {\n  let nString: string\n  if (Array.isArray(n)) nString = n.join('').toString()\n  else nString = n.toString()\n  let somme = 0\n  let sommeString = ''\n  for (let i = 0; i < nString.length - 1; i++) {\n    if (\n      ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'].indexOf(nString[i]) !==\n      -1\n    ) {\n      sommeString += nString[i] + '+'\n      somme += Number(nString[i])\n    }\n  }\n  if (\n    ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'].indexOf(\n      nString[nString.length - 1],\n    ) !== -1\n  ) {\n    sommeString += nString[nString.length - 1]\n    somme += Number(nString[nString.length - 1])\n  }\n  return [somme, sommeString]\n}\n\n/**\n * Retourne l'galit des produits en croix  partir d'un tableau contenant les deux fractions [[a,b],[c,d]] pour a/b=c/d retourne ad=bc\n * Le rsultat est un string en mode maths inline\n * @author Jean-Claude Lhote\n */\n\nexport function produitsEnCroix([[a, b], [c, d]]: [\n  [number | string, number | string],\n  [number | string, number | string],\n]): string {\n  // crit une chaine pour a*d=b*c\n  let result = ''\n  result += `$${a}\\\\times${d}=${b}\\\\times${c}$`\n  return result\n}\n\n/**\n * Retourne la quatrime proportionnelle de 3 nombres en fonction d'une prcision demande\n * Le rsultat est un string qui doit tre entour de $ pour le mode mathmatique\n * @author Jean-Claude Lhote\n */\n\nexport function quatriemeProportionnelle(\n  a: number | string,\n  b: number | string,\n  c: number | string,\n  precision = 0,\n): string {\n  // calcul de b*c/a\n  let result = ''\n  if (typeof a === 'number' && typeof b === 'number' && typeof c === 'number') {\n    if (a === 0) {\n      result = '=erreur : division par zro'\n      return result\n    }\n    const p4 = new Decimal(b).mul(c).div(a)\n    result += `\\\\dfrac{${texNombre(b, precision)}\\\\times${texNombre(c, precision)}}{${texNombre(a, precision)}}`\n    if (p4.eq(p4.toDP(precision))) result += '='\n    else result += '\\\\approx'\n    result += `${texNombre(p4, precision)}`\n    return result\n  } else {\n    return `\\\\dfrac{${b} \\\\times${c}}{${a}}`\n  }\n}\n\n/**\n *\n * @param {number} n\n * Extrait le plus grand nombre possible de la racine carre de n\n * retourne le rsulat [a, b] pour ab=n\n * @author Jean-Claude Lhote\n */\nexport function extraireRacineCarree(n: number): [number, number] {\n  if (n === 1) return [1, 1]\n  const facto = factorisation(n) as number[][]\n  let radical = 1\n  let facteur = 1\n  for (let i = 0; i < facto.length; i++) {\n    if (facto[i][1] % 2 === 0) {\n      facteur *= facto[i][0] ** (facto[i][1] >> 1)\n    } else if (facto[i][1] > 1) {\n      facteur *= facto[i][0] ** ((facto[i][1] - 1) >> 1)\n      radical *= facto[i][0]\n    } else radical *= facto[i][0]\n  }\n  return [facteur, radical]\n}\n\n/**\n * Renvoie un tableau (somme des termes positifs, somme des termes ngatifs)\n * @author Rmi Angot\n */\nexport function sommeDesTermesParSigne(liste: number[]) {\n  let sommeDesPositifs = 0\n  let sommeDesNegatifs = 0\n  for (let i = 0; i < liste.length; i++) {\n    if (liste[i] > 0) {\n      sommeDesPositifs += liste[i]\n    } else {\n      sommeDesNegatifs += liste[i]\n    }\n  }\n  return [sommeDesPositifs, sommeDesNegatifs]\n}\n","import Decimal from 'decimal.js'\nimport { evaluate, format, round } from 'mathjs'\nimport { context } from '../../modules/context'\nimport { tropDeChiffres } from '../../modules/outils'\nimport { miseEnEvidence } from './embellissements'\nimport { extraireRacineCarree } from './calculs'\nimport { nombreDeChiffresDansLaPartieDecimale } from './nombres'\nimport { sp } from './outilString'\nimport FractionEtendue from '../../modules/FractionEtendue'\nconst math = { format, evaluate }\n/**\n *\n * @param {number} n\n * retourne le code Latex de la racine carre de n rduite\n * @author Jean-CLaude Lhote\n */\nexport function texRacineCarree(n: number) {\n  const result = extraireRacineCarree(n)\n  if (result[1] === 1) return `${result[0]}`\n  else if (result[0] === 1) return `\\\\sqrt{${result[1]}}`\n  else return `${result[0]}\\\\sqrt{${result[1]}}`\n}\n\n/**\n * renvoie le rsultat de l'expression en couleur (vert=positif, rouge=ngatif, noir=nul)\n * @param {number|Decimal} nombre l'expression  calculer\n * @param {string} positif couleur si positif\n * @param {string} negatif couleur si negatif\n * @param {string} nul couleur si 0\n * @param {number} precision\n */\nexport function texNombreCoul(\n  nombre: number | Decimal,\n  positif = 'green',\n  negatif = 'red',\n  nul = 'black',\n  precision: number,\n) {\n  if (typeof nombre === 'string') {\n    window.notify(\n      \"texNombreCouleur appel avec un string  la place d'un nombre\",\n      { nombre },\n    )\n  }\n  if (nombre instanceof Decimal) {\n    if (nombre.isZero()) return miseEnEvidence(texNombre(0, precision), nul)\n    else if (nombre.isNeg())\n      return miseEnEvidence(texNombre(nombre, precision), negatif)\n    else return miseEnEvidence(texNombre(nombre, precision), positif)\n  } else {\n    if (nombre > 0) return miseEnEvidence(texNombre(nombre, precision), positif)\n    else if (nombre < 0)\n      return miseEnEvidence(texNombre(nombre, precision), negatif)\n    else return miseEnEvidence(texNombre(0, precision), nul)\n  }\n}\n\n/**\n * @author Frdric Piou\n * @param {number} nb\n * @returns retourne un nombre au format franais\n */\nexport function numberFormat(nb: number) {\n  return Intl.NumberFormat('fr-FR', { maximumFractionDigits: 20 })\n    .format(nb)\n    .toString()\n    .replace(/\\s+/g, '\\\\thickspace ')\n}\n\n/**\n * La chane de caractres en sortie doit tre interprte par KateX et doit donc tre place entre des $ $\n * Renvoie \"Trop de chiffres\" s'il y a plus de 15 chiffres significatifs (et donc un risque d'erreur d'approximation)\n * S'utilise indiffremment avec des nombres (nb) au format natif (entier, flottant) ou au format Decimal (ncessite la librairie decimal.js)\n * Avec comme avantage immdiat pour le format Decimal : precision est illimit.\n * Sinon, renvoie un nombre dans le format franais (avec une virgule et des espaces pour sparer les classes dans la partie entire et la partie dcimale)\n * @author Guillaume Valmont\n * @param {number|Decimal|FractionEtendue} nb nombre qu'on veut afficher\n * @param {number} precision nombre de dcimales demand\n * @param {boolean} completerZeros si true, le nombre de dcimale en precision est impos (ajout de zros inutiles ventuels)\n * @param {boolean} aussiCompleterEntiers si true ajoute des zros inutiles aux entiers si complterZeros est true aussi\n * @returns string avec le nombre dans le format franais  mettre entre des $ $\n */\nexport function texNombre(\n  nb: number | Decimal | FractionEtendue,\n  precision = 8,\n  completerZeros = false,\n  aussiCompleterEntiers = false,\n) {\n  // if (precision == null) window.notifyLocal('Il faut 2 arguments  texNombre ! La prcision attendue est obligatoire !', { nombre: nb, precision })\n  if (typeof nb === 'string') {\n    window.notify(\"texNombre appel avec un string  la place d'un nombre\", {\n      nombre: nb,\n    })\n    nb = Number(nb)\n  }\n  const result = afficherNombre(\n    nb,\n    precision,\n    'texNombre',\n    completerZeros,\n    aussiCompleterEntiers,\n  )\n  return result.replace(',', '{,}').replace(/\\s+/g, '\\\\,')\n}\n\n/**\n * Renvoie un nombre dans le format franais (sparateur de classes) pour la partie entire comme pour la partie dcimale\n * @author Rmi Angot\n */\nexport function texNombre2(nb: number) {\n  if (typeof nb === 'string') {\n    window.notify(\"texNombre2 appel avec un string  la place d'un nombre\", {\n      nombre: nb,\n    })\n  }\n  let nombre = math\n    .format(nb, {\n      notation: 'auto',\n      lowerExp: -12,\n      upperExp: 12,\n      precision: 12,\n    })\n    .replace('.', ',')\n  const rangVirgule = nombre.indexOf(',')\n  let partieEntiere\n  if (rangVirgule !== -1) {\n    partieEntiere = nombre.substring(0, rangVirgule)\n  } else {\n    partieEntiere = nombre\n  }\n  let partieDecimale = ''\n  if (rangVirgule !== -1) {\n    partieDecimale = nombre.substring(rangVirgule + 1)\n  }\n\n  for (let i = partieEntiere.length - 3; i > 0; i -= 3) {\n    partieEntiere =\n      partieEntiere.substring(0, i) + '\\\\,' + partieEntiere.substring(i)\n  }\n  for (let i = 3; i < partieDecimale.length; i += 5) {\n    partieDecimale =\n      partieDecimale.substring(0, i) + '\\\\,' + partieDecimale.substring(i)\n    i += 12\n  }\n  if (partieDecimale === '') {\n    nombre = partieEntiere\n  } else {\n    nombre = partieEntiere + '{,}' + partieDecimale\n  }\n  return nombre\n}\n\n/**\n * Renvoie un nombre dans le format franais (sparateur de classes) pour la partie entire comme pour la partie dcimale\n * Avec espace gr par nbsp en HTML pour pouvoir l'inclure dans une phrase formate en franais et pas seulement un calcul.\n * Modif EE pour la gestion de l'espace dans un texte non mathmatique\n * @author Eric Elter d'aprs la fonction de Rmi Angot\n * Rajout Octobre 2021 pour 6C14\n */\nexport function texNombre3(nb: number) {\n  if (typeof nb === 'string') {\n    window.notify(\"texNombre3 appel avec un string  la place d'un nombre\", {\n      nombre: nb,\n    })\n  }\n  let nombre = math\n    .format(nb, {\n      notation: 'auto',\n      lowerExp: -12,\n      upperExp: 12,\n      precision: 12,\n    })\n    .replace('.', ',')\n  const rangVirgule = nombre.indexOf(',')\n  let partieEntiere\n  if (rangVirgule !== -1) {\n    partieEntiere = nombre.substring(0, rangVirgule)\n  } else {\n    partieEntiere = nombre\n  }\n  let partieDecimale = ''\n  if (rangVirgule !== -1) {\n    partieDecimale = nombre.substring(rangVirgule + 1)\n  }\n\n  for (let i = partieEntiere.length - 3; i > 0; i -= 3) {\n    partieEntiere =\n      partieEntiere.substring(0, i) + sp() + partieEntiere.substring(i)\n  }\n  for (let i = 3; i <= partieDecimale.length; i += 3) {\n    partieDecimale =\n      partieDecimale.substring(0, i) + sp() + partieDecimale.substring(i)\n    i += 12\n  }\n  if (partieDecimale === '') {\n    nombre = partieEntiere\n  } else {\n    nombre = partieEntiere + ',' + partieDecimale\n  }\n  return nombre\n}\n\n/**\n * Renvoie un nombre dans le format franais (sparateur de classes)\n * Fonctionne sans le mode maths contrairement  texNombre()\n * insereEspaceDansNombre fonctionne peut-tre mieux\n * @author Rmi Angot\n */\nexport function nombreAvecEspace(nb: number) {\n  if (isNaN(nb)) {\n    window.notify('nombreAvecEspace : argument NaN ou undefined', { nb })\n    return 'NaN'\n  }\n  // Ecrit \\nombre{nb} pour tous les nombres suprieurs  1 000 (pour la gestion des espaces)\n  if (context.isHtml) {\n    return Intl.NumberFormat('fr-FR', { maximumFractionDigits: 20 })\n      .format(nb)\n      .toString()\n      .replace(/\\s+/g, ' ')\n  } else {\n    let result\n    if (nb > 999 || nombreDeChiffresDansLaPartieDecimale(nb) > 3) {\n      result = '\\\\numprint{' + nb.toString().replace('.', ',') + '}'\n    } else {\n      result = Number(nb).toString().replace('.', '{,}')\n    }\n    return result\n  }\n}\n\n/**\n *\n * @param {number} mantisse\n * @param {number} exp\n * @returns {string} criture dcimale avec espaces\n */\nexport function scientifiqueToDecimal(mantisse: number, exp: number) {\n  if (exp < -6) Decimal.set({ toExpNeg: exp - 1 })\n  else if (exp > 20) Decimal.set({ toExpPos: exp + 1 })\n  return texNombre(new Decimal(mantisse).mul(Decimal.pow(10, exp)), 10)\n}\n\n/**\n * Destine  tre utilise hors des $ $\n * Signale une erreur en console s'il y a plus de 15 chiffres significatifs (et donc qu'il y a un risque d'erreur d'approximation)\n * Sinon, renvoie le nombre  afficher dans le format franais (avec virgule et des espaces pour sparer les classes dans la partie entire et la partie dcimale)\n * @author Jean-Claude Lhote\n * @author Guillaume Valmont\n * @param {number|Decimal} nb nombre qu'on veut afficher\n * @param {number} precision nombre de dcimales demand\n * @param {boolean?} completerZeros=false si true, le nombre de dcimale en precision est impos (ajout de zros inutiles ventuels)\n * @param {boolean?} aussiCompleterEntiers=false si true ajoute des zros inutiles aux entiers si complterZeros est true aussi\n * @returns string avec le nombre dans le format franais  placer hors des $ $\n */\nexport function stringNombre(\n  nb: number | Decimal,\n  precision?: number,\n  completerZeros?: boolean,\n  aussiCompleterEntiers?: boolean,\n) {\n  if (completerZeros === undefined) completerZeros = false\n  if (aussiCompleterEntiers === undefined) aussiCompleterEntiers = false\n  if (precision === undefined) precision = 8\n  if (typeof nb === 'string') {\n    window.notify(\"stringNombre appel avec un string  la place d'un nombre\", {\n      nombre: nb,\n    })\n  }\n  return afficherNombre(\n    nb,\n    precision,\n    'stringNombre',\n    completerZeros,\n    aussiCompleterEntiers,\n  )\n}\n\n/**\n * Fonction auxiliaire aux fonctions stringNombre et texNombre\n * Vrifie le nombre de chiffres significatifs en fonction du nombre de chiffres de la partie entire de nb et du nombre de dcimales demandes par le paramtre precision\n * S'il y a plus de 15 chiffres significatifs, envoie un message  bugsnag et renvoie un nombre avec 15 chiffres significatifs\n * Sinon, renvoie un nombre avec le nombre de dcimales demand\n * @author Guillaume Valmont\n * @param {number|string|FractionEtendue|Decimal} nb nombre qu'on veut afficher\n * @param {number} precision nombre de dcimales demand\n * @param {'stringNombre'|'texNombre'} fonction nom de la fonction qui appelle afficherNombre (texNombre ou stringNombre) -> sert pour le message envoy  bugsnag\n * @param {boolean} completerZeros si true, le nombre de dcimale en precision est impos (ajout de zros inutiles ventuels)\n * @param {boolean} aussiCompleterEntiers true si on veut ajouter des zros inutiles aux entiers\n */\nfunction afficherNombre(\n  nb: number | Decimal | FractionEtendue | string,\n  precision: number,\n  fonction: 'texNombre' | 'stringNombre',\n  completerZeros = false,\n  aussiCompleterEntiers: boolean,\n) {\n  /**\n   * Fonction auxiliaire de stringNombre pour une meilleure lisibilit\n   * Elle renvoie un nombre dans le format franais (avec virgule et des espaces pour sparer les classes dans la partie entire et la partie dcimale)\n   * @author Rmi Angot\n   * @author Guillaume Valmont\n   * @param {number|string|FractionEtendue|Decimal} nb nombre  afficher\n   * @param {number} nbChiffresPartieEntiere nombre de chiffres de la partie entire\n   * @param {number} precision nombre de dcimales demand\n   * @param {'stringNombre'|'texNombre'} fonction la fonction appelante\n   * @returns string avec le nombre dans le format franais\n   */\n\n  function insereEspacesNombre(\n    nb: number | Decimal,\n    nbChiffresPartieEntiere: number,\n    precision: number,\n    fonction: 'stringNombre' | 'texNombre',\n  ) {\n    let signe\n    let nombre\n    const maximumSignificantDigits = nbChiffresPartieEntiere + precision\n    if (nb instanceof Decimal) {\n      Decimal.set({ toExpNeg: -precision - 1 })\n      signe = nb.isNeg()\n      if (nb.abs().gte(1)) {\n        if (completerZeros) {\n          nombre = nb.toFixed(precision).replace('.', ',')\n        } else {\n          nombre = nb.toDP(precision).toString().replace('.', ',')\n        }\n      } else {\n        if (completerZeros) {\n          nombre = nb.toFixed(precision).replace('.', ',')\n        } else {\n          nombre = nb.toDP(precision).toString().replace('.', ',')\n        }\n      }\n    } else {\n      // nb est un number\n      signe = nb < 0\n      // let nombre = math.format(nb, { notation: 'fixed', lowerExp: -precision, upperExp: precision, precision: precision }).replace('.', ',')\n      if (Math.abs(nb) < 1) {\n        // si il est < 1, on n'a pas  se proccuper de savoir si il est entier pour aussiCompleterEntiers\n        if (completerZeros) {\n          nombre = Intl.NumberFormat('fr-FR', {\n            maximumFractionDigits: precision,\n            minimumFractionDigits: precision,\n          }).format(nb)\n        } else {\n          nombre = Intl.NumberFormat('fr-FR', {\n            maximumFractionDigits: precision,\n          })\n            .format(nb)\n            .replaceAll(/\\s+/g, ' ')\n        }\n      } else {\n        if (\n          completerZeros &&\n          ((aussiCompleterEntiers && Number.isInteger(nb)) ||\n            !Number.isInteger(nb))\n        ) {\n          nombre = Intl.NumberFormat('fr-FR', {\n            maximumSignificantDigits,\n            minimumSignificantDigits: Math.min(maximumSignificantDigits, 15),\n          })\n            .format(nb)\n            .replaceAll(/\\s+/g, ' ')\n        } else {\n          nombre = Intl.NumberFormat('fr-FR', {\n            maximumSignificantDigits: Math.min(maximumSignificantDigits, 15),\n          })\n            .format(nb)\n            .replaceAll(/\\s+/g, ' ')\n        }\n      }\n    }\n    const rangVirgule = nombre.indexOf(',')\n    let partieEntiere\n    if (rangVirgule !== -1) {\n      partieEntiere = nombre.substring(0, rangVirgule)\n    } else {\n      partieEntiere = nombre\n    }\n    let partieDecimale = ''\n    if (rangVirgule !== -1) {\n      partieDecimale = nombre.substring(rangVirgule + 1)\n    }\n    // La partie entire est dj formate par le Intl.NumberFormat('fr-FR', { maximumSignificantDigits }).format(nb)\n    // Dans le cas d'un Number, mais pas d'un Decimal\n    if (nb instanceof Decimal) {\n      if (signe) partieEntiere = partieEntiere.substring(1)\n      for (let i = partieEntiere.length - 3; i > 0; i -= 3) {\n        partieEntiere =\n          partieEntiere.substring(0, i) + ' ' + partieEntiere.substring(i)\n      }\n      if (signe) partieEntiere = '-' + partieEntiere\n    }\n    for (\n      let i = 3;\n      i < partieDecimale.length;\n      i += fonction === 'texNombre' ? 5 : 4\n    ) {\n      // des paquets de 3 nombres + 1 espace\n      partieDecimale =\n        partieDecimale.substring(0, i) +\n        (fonction === 'texNombre' ? '\\\\,' : ' ') +\n        partieDecimale.substring(i)\n    }\n    if (partieDecimale === '') {\n      nombre = partieEntiere\n    } else {\n      nombre = partieEntiere + ',' + partieDecimale\n    }\n    return nombre\n  } // fin insereEspacesNombre()\n  /**\n   * retourne la prcision souhaite pour le number x, c'est  dire le nombre de chiffres significatifs aprs la virgule\n   * @param {number} x\n   * @return {number}\n   */\n  const trouveLaPrecision = function (x: number) {\n    if (Math.abs(x) > 1e-10 && Math.abs(x) < 1e11) {\n      let fix = x.toFixed(18)\n      if (fix.includes('.')) {\n        fix = fix.split('.')[1]\n      }\n      const xx = Number('.' + fix)\n      let precision = 1\n      for (let i = 1; i < fix.length; i++) {\n        const x = round(Number('.' + fix.substring(0, i + 1)), i)\n        const diff = Math.abs(x - xx)\n        if (diff > 1e-10) {\n          precision++\n        } else {\n          return precision\n        }\n      }\n      return precision\n    } else {\n      // On a  faire  un number trop petit ou trop grand pour que l'algorithme classique fonctionne.\n      // x.toFixed(18) ne contiendrait pas assez de chiffres significatifs\n      // afficherNombre n'est pas prvu pour des nombres pareils sauf ventuellement au format Decimal\n      window.notify(\n        `trouveLaPrecision de ${x} n'est pas possible : il ne peut pas tre transform en criture dcimale. Il faut adapter le code de l'exercice ou verifier que ce nombre n'est pas un bug`,\n        { x },\n      )\n      return 10\n    }\n  }\n  // fin trouveLaPrecision()\n  // eh oui, il y a eu des appels  texNombre() avec des FractionEtendue... alors que c'est pas fait pour a.\n  if (!(nb instanceof Decimal) && typeof nb !== 'number') {\n    if (nb instanceof FractionEtendue) {\n      nb = nb.toNumber()\n    } else if (typeof nb === 'string') {\n      const nbFormatAnglais = nb.replaceAll(',', '.') ?? ''\n      if (nb !== '') {\n        nb = new Decimal(nbFormatAnglais)\n      } else {\n        window.notify(`TrouveLaPrecision : problme avec ce nombre : ${nb}`, {\n          nb,\n        })\n      }\n    } else if (typeof nb !== 'number') {\n      window.notify(\n        `afficherNombre a reu un argument de type inconnu come nombre : ${nb}`,\n        { nombreEntrant: nb },\n      )\n      nb = Number(nb)\n      if (isNaN(nb)) {\n        window.notify(\n          \"Et ce paramtre n'est pas convertible en nombre ! il faut donc vrifier l'exercice qui comporte un bug !\",\n          { nb },\n        )\n        nb = 0\n      }\n    }\n  }\n\n  if (precision === undefined) {\n    // la prcision n'a pas t fournie  texNombre ou  stringNombre, alors on va essayer de la deviner.\n    if (nb instanceof Decimal) {\n      precision = nb.e < 0 ? nb.precision() + -nb.e : nb.precision(true)\n    } else {\n      if (Number.isInteger(nb)) {\n        precision = 0\n      } else {\n        const ordreGrandeur = Math.round(Math.log10(Number(nb)))\n        if (ordreGrandeur < -10) {\n          // a veut dire que le nombre est trop insignifiant pour donner un rsultat affich convenable\n          precision = 0 // on retourne 0 pour avoir un arrondi  zro !\n        } else {\n          precision = trouveLaPrecision(Number(nb))\n        }\n      }\n    }\n  }\n  // si nb n'est pas un nombre, on le retourne tel quel, on ne fait rien.\n  if (Number.isNaN(nb) && !(nb instanceof Decimal)) {\n    window.notify(\"AfficherNombre : Le nombre n'en est pas un\", {\n      nb,\n      precision,\n      fonction,\n    })\n    return ''\n  }\n  if (nb instanceof Decimal) {\n    if (nb.isZero()) return '0'\n  } else if (Number(nb) === 0) return '0'\n  let nbChiffresPartieEntiere\n  if (nb instanceof Decimal) {\n    if (nb.abs().lt(1)) {\n      nbChiffresPartieEntiere = 0\n    } else {\n      nbChiffresPartieEntiere = nb.abs().floor().toFixed(0).length\n    }\n    if (nb.isInteger() && !aussiCompleterEntiers) precision = 0\n    else if (typeof precision !== 'number') {\n      // Si precision n'est pas un nombre, on le remplace par la valeur max acceptable\n      precision = 15 - nbChiffresPartieEntiere\n    } else if (precision < 0) {\n      precision = 0\n    }\n  } else {\n    // nb est un number\n    if (Math.abs(Number(nb)) < 1) {\n      nbChiffresPartieEntiere = 0\n    } else {\n      // attention 9.7 donner 10 avec Math.abs(9.7).toFixed(0)\n      nbChiffresPartieEntiere = Math.floor(Math.abs(Number(nb))).toFixed(\n        0,\n      ).length\n    }\n    if (Number.isInteger(nb) && !completerZeros) {\n      precision = 0\n    } else {\n      if (typeof precision !== 'number') {\n        // Si precision n'est pas un nombre, on le remplace par la valeur max acceptable\n        precision = 15 - nbChiffresPartieEntiere\n      } else if (precision < 0) {\n        precision = 0\n      }\n    }\n  }\n\n  const maximumSignificantDigits = nbChiffresPartieEntiere + precision\n\n  if (maximumSignificantDigits > 15 && !(nb instanceof Decimal)) {\n    // au del de 15 chiffres significatifs, on risque des erreurs d'arrondi\n    window.notify(\n      fonction +\n        ` : ${tropDeChiffres} le nombre pass  la fonction a trop de chiffres significatifs, soit c'est un bug  corriger, soit il faut utiliser un Decimal !`,\n      { nb, precision },\n    )\n    return insereEspacesNombre(\n      Number(nb),\n      nbChiffresPartieEntiere,\n      precision,\n      fonction,\n    )\n  } else {\n    return insereEspacesNombre(\n      Number(nb),\n      nbChiffresPartieEntiere,\n      precision,\n      fonction,\n    )\n  }\n}\n\n/**\n * Pour bien afficher les centimes avec 2 chiffres aprs la virgule\n * @author Rmi Angot\n */\nexport function texPrix(nb: number | Decimal) {\n  if (nb instanceof Decimal) {\n    if (nb.isInteger()) return texNombre(nb, 0)\n    else return texNombre(nb, 2, true)\n  }\n  const nombre = Number(nb)\n  if (nombre.toString() === nombre.toFixed(0)) {\n    return texNombre(nb, 0)\n  } else {\n    return texNombre(nb, 2, true)\n  }\n}\n\n/**\n * Fonction qui renvoie un tableau contenant la mantisse et l'exposant de l'criture scientique d'un nombre donn en paramtres sous sa forme dcimale.\n * @param nbDecimal\n *\n * @example\n * // Renvoie [4.1276,1]\n * range(decimalToScientifique,[41.276])\n * // Renvoie [3.48,-2]\n * range(decimalToScientifique,[0.0348])\n * // Renvoie [-2.315,3]\n * range(decimalToScientifique,[-2315])\n *\n * @author Eric Elter\n */\nexport function decimalToScientifique(nbDecimal: number) {\n  let exposant = 0\n  let mantisseNb = new Decimal(nbDecimal)\n  if (mantisseNb.abs().gte(10)) {\n    while (exposant < 50 && mantisseNb.abs().gt(10)) {\n      mantisseNb = mantisseNb.div(10)\n      exposant++\n    }\n    return [mantisseNb.toNumber(), exposant]\n  } else if (mantisseNb.abs().lt(1)) {\n    while (exposant < 50 && mantisseNb.abs().lt(1)) {\n      mantisseNb = mantisseNb.mul(10)\n      exposant++\n    }\n    return [mantisseNb.toNumber(), -1 * exposant]\n  } else return [nbDecimal, 0]\n}\n\n/**\n * Fonction qui renvoie une chaine avec un O pour chiffre des dizaines si celui-ci n'en contient pas.\n * @param nbDecimal\n *\n * @example\n\n * @author Rmi Angot\n */\nexport function formatMinute(minute: number): string {\n  return minute < 10 ? `0${minute}` : minute.toString()\n}\n","import { arrondi } from '../outils/nombres'\nimport { texNombre } from '../outils/texNombre'\n\n/**\n * Convertit un angle de radian vers degrs et fonction inverse\n * @Example\n * // PI->180\n * @author Jean-Claude Lhote\n */\nexport function radToDeg(radians: number) {\n  return (radians * 180) / Math.PI\n}\n\nexport function degToRad(degres: number) {\n  return (degres * Math.PI) / 180\n}\n\n/**\n * @param {number} a angle en degrs\n * @returns flottant : le cosinus de l'angle\n * @author Jean-Claude Lhote\n */\nexport function degCos(a: number) {\n  return Math.cos(degToRad(a))\n}\n\n/**\n * @param {number} a angle en degrs\n * @returns flottant : le sinus de l'angle\n * @author Jean-Claude Lhote\n */\nexport function degSin(a: number) {\n  return Math.sin(degToRad(a))\n}\n\n/**\n * @param {number} a angle en degrs\n * @returns flottant : la tangente de l'angle\n * @author Jean-Claude Lhote\n */\nexport function degTan(a: number) {\n  return Math.tan(degToRad(a))\n}\n\n/**\n * @param {number} x un nombre qui correspond au cosinus de l'angle\n * @returns flottant : la mesure de l'angle en degrs\n * @author Jean-Claude Lhote\n */\nexport function degAcos(x: number) {\n  return arrondi(radToDeg(Math.acos(x)), 1)\n}\n\n/**\n * @param {number} x un nombre qui correspond au sinus de l'angle\n * @returns flottant : la mesure de l'angle en degrs\n * @author Jean-Claude Lhote\n */\nexport function degAsin(x: number) {\n  return arrondi(radToDeg(Math.asin(x)), 1)\n}\n\n/**\n * @param {number} x un nombre qui correspond  la tangente de l'angle\n * @returns flottant : la mesure de l'angle en degrs\n * @author Jean-Claude Lhote\n */\nexport function degAtan(x: number) {\n  return arrondi(radToDeg(Math.atan(x)), 1)\n}\n\nexport function angleOppose(angle: Angle) {\n  // retourne l'angle oppos d'un angle du premier cadrant (sinon, on pourrait avoir plusieurs signe '-' colls ensemble)\n  if (angle.degres === '0') {\n    return angle\n  } else {\n    return new Angle({\n      degres: '-' + angle.degres,\n      cos: angle.cos,\n      sin:\n        angle.sin === '0'\n          ? angle.sin\n          : (opposeStringArray(angle.sin) as string),\n      tan: angle.tan === '0' ? angle.tan : '-' + angle.tan,\n      radians: '-' + angle.radians,\n    })\n  }\n}\n\nexport function complementaireRad(angleEnRadian: string) {\n  // retourne la mesure en radians du complmentaire d'un angle du premier quadrant donn galement en radians\n  switch (angleEnRadian) {\n    case '\\\\dfrac{\\\\pi}{4}':\n      return angleEnRadian\n    case '\\\\dfrac{\\\\pi}{6}':\n      return '\\\\dfrac{\\\\pi}{3}'\n    case '\\\\dfrac{\\\\pi}{3}':\n      return '\\\\dfrac{\\\\pi}{6}'\n    case '\\\\dfrac{\\\\pi}{2}':\n      return '0'\n    case '0':\n      return '\\\\dfrac{\\\\pi}{2}'\n  }\n}\n\nexport function supplementaireRad(angleEnRadian: string) {\n  // retourne la mesure en radians du supplmentaire d'un angle du premier quadrant donn galement en radians\n  switch (angleEnRadian) {\n    case '\\\\dfrac{\\\\pi}{4}':\n      return '\\\\dfrac{3\\\\pi}{4}'\n    case '\\\\dfrac{\\\\pi}{6}':\n      return '\\\\dfrac{5\\\\pi}{6}'\n    case '\\\\dfrac{\\\\pi}{3}':\n      return '\\\\dfrac{2\\\\pi}{3}'\n    case '\\\\dfrac{\\\\pi}{2}':\n      return '\\\\dfrac{\\\\pi}{2}'\n    case '0':\n      return '\\\\pi'\n  }\n}\n\nexport function inverseTan(angle: Angle) {\n  switch (angle.tan) {\n    case '\\\\infin':\n    case '-\\\\infin':\n      return '0'\n    case '1':\n      return '1'\n    case '\\\\sqrt{3}':\n      return '\\\\dfrac{\\\\sqrt{3}}{3}'\n    case '\\\\dfrac{\\\\sqrt{3}}{3}':\n      return '\\\\sqrt{3}'\n  }\n}\n\nexport function angleComplementaire(angle: Angle) {\n  // retourne l'angle complmentaire d'un angle du premier cadrant\n  return new Angle({\n    degres: (90 - parseInt(angle.degres)).toString(),\n    cos: angle.sin,\n    sin: angle.cos,\n    tan: inverseTan(angle),\n    radians: complementaireRad(angle.radians),\n  })\n}\n\nexport function angleSupplementaire(angle: Angle) {\n  // retourne l'angle supplmentaire d'un angle du premier cadrant\n  return new Angle({\n    degres: (180 - parseInt(angle.degres)).toString(),\n    cos: angle.cos === '0' ? '0' : (opposeStringArray(angle.cos) as string),\n    sin: angle.sin,\n    tan: angle.tan === '\\\\infin' ? '\\\\infin' : '-' + angle.tan,\n    radians: supplementaireRad(angle.radians),\n  })\n}\n\nexport function opposeStringArray(value: string[] | string): string[] | string {\n  if (Array.isArray(value)) {\n    const result = []\n    for (const e of value) {\n      result.push('-' + e)\n    }\n    return result\n  } else return '-' + value\n}\n/**\n *\n * @param k Cette fonction intervient dans le calcul des parties relles et imaginaires de k.e^{i.teta} = k.cos(teta) + i.k.sin(teta)\n * elle retourne la valeur exacte en latex de k.cosOuSin\n * @param cosOuSin\n */\nexport function kCosOuKSin(k: number, cosOuSin: string) {\n  function extractNumerator(latex: string): string | null {\n    const num = latex.split('\\\\dfrac{')[1].split('}{')[0]\n    return num\n  }\n  const signe = cosOuSin.startsWith('-') ? '-' : ''\n  if (signe === '-') cosOuSin = cosOuSin.slice(1)\n  if (cosOuSin.includes('{2}')) {\n    // On a  faire  \\\\dfrac{1}{2} ou \\\\dfrac{\\\\sqrt{2}}{2}\n    if (Number.isInteger(k) && k % 2 === 0) {\n      // k tant pair, on simplifie par 2\n      k /= 2\n      const num = extractNumerator(cosOuSin)\n      if (num === '1') return `${signe}${k}`\n      else return `${signe}${k !== 1 ? k : ''}${num}`\n    } else {\n      const num = extractNumerator(cosOuSin)\n      if (num === '1') return `${signe}\\\\dfrac{${k}}{2}`\n      return `${signe}\\\\dfrac{${k}${extractNumerator(cosOuSin)}}{2}`\n    }\n  } else {\n    // Pas de dnominateur 2, on est sur un nombre dcimal comme 0.5\n    const val = parseFloat(cosOuSin)\n    return `${signe}${texNombre(k * val)}`\n  }\n}\n\nfunction parenthesesSiNegatif(value: string): string {\n  if (value[0] === '-') {\n    return `\\\\left(${value}\\\\right)`\n  } else return value\n}\nexport function parenthesesSiNegatifStrigArray(\n  value: string[] | string,\n): string[] | string {\n  if (Array.isArray(value)) {\n    const result = []\n    for (const e of value) {\n      result.push(parenthesesSiNegatif(e))\n    }\n    return result\n  } else return parenthesesSiNegatif(value)\n}\n\n/**\n * @class\n * Cre un objet qui contient les proprits suivantes : degres, cos, sin, tan et radians.\n */\nexport class Angle {\n  /**\n   * @constructor\n   * @param {object} param\n   * @param {string} [param.degres] mesure de l'angle en degrs sous forme de string\n   * @param {string} [param.cos] valeur du cosinus sous forme de string\n   * @param {string} [param.sin] valeur du sinus sous forme de string\n   * @param {string} [param.tan] valeur de la tangente sous forme de string\n   * @param {string} [param.radians] mesure de l'angle en radians sous forme de string\n   * @example const a = new Angle({ degres: '90', radians: '\\\\dfrac{5\\\\pi}{2}' }) => {degres: '90', cos: '0', sin: '1', tan: '\\\\infin', radians: '\\\\dfrac{5\\\\pi}{2}'}\n   * @author Jean-Claude Lhote\n   */\n  degres: string\n  cos: string | string[]\n  sin: string | string[]\n  tan: string | string[]\n  radians: string\n\n  constructor({\n    degres,\n    cos = undefined,\n    sin = undefined,\n    tan = undefined,\n    radians = undefined,\n  }: {\n    degres: string\n    cos?: string | string[]\n    sin?: string | string[]\n    tan?: string | string[]\n    radians?: string\n  }) {\n    // il faut au moins fournir la mesure en degrs\n    this.degres = degres\n    const anglesDeBase = [\n      {\n        degres: '90',\n        cos: '0',\n        sin: '1',\n        tan: '\\\\infin',\n        radians: '\\\\dfrac{\\\\pi}{2}',\n      },\n      {\n        degres: '45',\n        cos: '\\\\dfrac{\\\\sqrt{2}}{2}',\n        sin: '\\\\dfrac{\\\\sqrt{2}}{2}',\n        tan: '1',\n        radians: '\\\\dfrac{\\\\pi}{4}',\n      },\n      {\n        degres: '60',\n        cos: ['\\\\dfrac{1}{2}', '0.5'],\n        sin: '\\\\dfrac{\\\\sqrt{3}}{2}',\n        tan: '\\\\sqrt{3}',\n        radians: '\\\\dfrac{\\\\pi}{3}',\n      },\n      {\n        degres: '30',\n        sin: ['\\\\dfrac{1}{2}', '0.5'],\n        cos: '\\\\dfrac{\\\\sqrt{3}}{2}',\n        tan: '\\\\dfrac{\\\\sqrt{3}}{3}',\n        radians: '\\\\dfrac{\\\\pi}{6}',\n      },\n      { degres: '0', cos: '1', sin: '0', tan: '0', radians: '0' },\n    ]\n    const angle = anglesDeBase.find(\n      (el) => el.degres === (parseInt(degres) % 360).toString(),\n    )\n    if (angle === undefined) {\n      // si ce n'est pas un des anglesDeBase, alors il faut les autres arguments.\n      if (\n        cos === undefined ||\n        sin === undefined ||\n        tan === undefined ||\n        radians === undefined\n      ) {\n        window.notify(\n          'Il faut fournir les valeurs du cosinus, du sinus, de la tangente et de la mesure en radians',\n          { cos, sin, tan, radians },\n        )\n      }\n      this.cos = cos ?? ''\n      this.sin = sin ?? ''\n      this.tan = tan ?? ''\n      this.radians = radians ?? ''\n    } else {\n      // si l'angle en degr est fourni, on aura par dfaut les valeurs de l'angle de base si les paramtres ne sont pas donns\n      this.cos = cos ?? angle.cos\n      this.sin = sin ?? angle.sin\n      this.tan = tan ?? angle.tan\n      this.radians = radians ?? angle.radians\n    }\n  }\n}\n\nexport const anglesDeBase = [\n  new Angle({\n    degres: '90',\n    cos: '0',\n    sin: '1',\n    tan: '\\\\infin',\n    radians: '\\\\dfrac{\\\\pi}{2}',\n  }),\n  new Angle({\n    degres: '45',\n    cos: '\\\\dfrac{\\\\sqrt{2}}{2}',\n    sin: '\\\\dfrac{\\\\sqrt{2}}{2}',\n    tan: '1',\n    radians: '\\\\dfrac{\\\\pi}{4}',\n  }),\n  new Angle({\n    degres: '60',\n    cos: ['\\\\dfrac{1}{2}', '0.5'],\n    sin: '\\\\dfrac{\\\\sqrt{3}}{2}',\n    tan: '\\\\sqrt{3}',\n    radians: '\\\\dfrac{\\\\pi}{3}',\n  }),\n  new Angle({\n    degres: '30',\n    sin: ['\\\\dfrac{1}{2}', '0.5'],\n    cos: '\\\\dfrac{\\\\sqrt{3}}{2}',\n    tan: '\\\\dfrac{\\\\sqrt{3}}{3}',\n    radians: '\\\\dfrac{\\\\pi}{6}',\n  }),\n  new Angle({ degres: '0', cos: '1', sin: '0', tan: '0', radians: '0' }),\n]\nexport function moduloDeg(angleEnDegre: string, k: number) {\n  const coef = 360 / parseInt(angleEnDegre)\n  if (angleEnDegre === '0') {\n    return (2 * k * 180).toString()\n  } else return ((coef * k + 1) * parseInt(angleEnDegre)).toString()\n}\n\nexport function moduloRad(angleEnDegre: string, k: number) {\n  const coef = 360 / parseInt(angleEnDegre)\n  if (angleEnDegre === '0') {\n    return `${2 * k}\\\\pi`\n  } else return `\\\\dfrac{${coef * k + 1}\\\\pi}{${coef / 2}}`\n}\n\n/**\n *\n * @param {Angle} angle\n * @param {number} k On part de l'objet angle et on ajoute 2 * k * pi\n * @returns {Angle}\n */\nexport function angleModulo(angle: Angle, k: number) {\n  return new Angle({\n    degres: moduloDeg(angle.degres, k),\n    cos: angle.cos,\n    sin: angle.sin,\n    tan: angle.tan,\n    radians: moduloRad(angle.degres, k),\n  })\n}\n\n/**\n * @param {object} param\n * @param {number[]} [param.modulos] liste des k  utiliser pour ajouter les angles modulo 2k*Pi\n * @returns {{liste1: string[], liste2: string[], liste3: string[]}} liste1, liste2, liste3 les listes (niveau2 contient niveau1 et niveau3 contient niveau2)\n * @author Jean-Claude Lhote\n */\nexport function valeursTrigo({ modulos = [-1, 1] }) {\n  let mesAngles = anglesDeBase.slice()\n  const mesAnglesNiv1 = mesAngles.slice()\n  const nombreAnglesDeBase = mesAngles.length\n\n  // ici on complte la liste avec tous les angles associs en faisant attention de ne pas ajouter deux fois les mmes.\n  for (let i = 0; i < nombreAnglesDeBase; i++) {\n    mesAngles.push(\n      angleOppose(mesAngles[i]),\n      angleComplementaire(mesAngles[i]),\n      angleSupplementaire(mesAngles[i]),\n    )\n  }\n  // On supprime les doublons en comparant la mesure en degrs\n  mesAngles = [\n    ...new Map(mesAngles.map((item) => [item.degres, item])).values(),\n  ]\n  const mesAnglesNiv2 = mesAngles.slice()\n\n  for (let i = 0; i < nombreAnglesDeBase; i++) {\n    for (const k of modulos) {\n      if (k !== 0)\n        mesAngles.push(angleModulo(mesAngles[i % nombreAnglesDeBase], k))\n    }\n  }\n  const mesAnglesNiv3 = mesAngles.slice()\n  return { liste1: mesAnglesNiv1, liste2: mesAnglesNiv2, liste3: mesAnglesNiv3 }\n}\n","import { ObjetMathalea2D } from '../../modules/2dGeneralites'\nimport { arrondi } from '../outils/nombres'\n\nexport class PointAbstrait extends ObjetMathalea2D {\n  nom: string\n  x: number\n  y: number\n\n  constructor(\n    arg1: string | number,\n    arg2: number,\n    arg3?: number | string,\n    positionLabel = 'above',\n  ) {\n    super()\n    this.typeObjet = 'point'\n    this.x = 0\n    this.y = 0\n    this.nom = ' ' // Le nom d'un point est par dfaut un espace. On pourra chercher tous les objets qui ont ce nom pour les nommer automatiquement\n    if (arguments.length === 1) {\n      this.nom = String(arg1)\n    } else if (arguments.length === 2) {\n      if (Number.isNaN(arg1) || Number.isNaN(arg2)) {\n        window.notify('Point : les coordonnes ne sont pas valides', {\n          arg1,\n          arg2,\n        })\n      } else {\n        this.x = Number(arg1)\n        this.y = arg2\n      }\n    } else {\n      if (Number.isNaN(arg1) || Number.isNaN(arg2)) {\n        window.notify('Point : les coordonnes ne sont pas valides', {\n          arg1,\n          arg2,\n        })\n      } else {\n        this.x = Number(arg1)\n        this.y = arg2\n      }\n      this.nom = String(arg3)\n    }\n    // On n'a pas besoin de davantage de dcimales pour les graphiques !\n    this.x = arrondi(this.x, 2)\n    this.y = arrondi(this.y, 2)\n\n    this.positionLabel = positionLabel\n    this.bordures = [this.x, this.y, this.x, this.y]\n  }\n\n  xSVG(coeff: number) {\n    return arrondi(this.x * coeff, 1)\n  }\n\n  ySVG(coeff: number) {\n    return arrondi(-this.y * coeff, 1)\n  }\n}\n\nexport function pointAbstrait(\n  x: number,\n  y: number,\n  A = '',\n  positionLabel = 'above',\n) {\n  return new PointAbstrait(x, y, A, positionLabel)\n}\n\nexport function isPointAbstrait(objet: any): objet is PointAbstrait {\n  return objet instanceof PointAbstrait\n}\nexport function isPointsAbstraits(objets: any[]): objets is PointAbstrait[] {\n  return objets.every(isPointAbstrait)\n}\n","import rough from 'roughjs'\nimport type { RoughSVG } from 'roughjs/bin/svg'\n\nclass MainLevee {\n  private roughSvg!: RoughSVG\n  private div!: HTMLDivElement\n  private svg: SVGSVGElement\n  constructor(rs: RoughSVG, div: HTMLDivElement, svg: SVGSVGElement) {\n    this.roughSvg = rs\n    this.div = div\n    this.svg = svg\n  }\n\n  line(\n    x1: number,\n    y1: number,\n    x2: number,\n    y2: number,\n    { color = '#000', epaisseur = 2, roughness = 1 } = {},\n  ) {\n    return this.roughSvg.line(x1, y1, x2, y2, {\n      roughness,\n      disableMultiStroke: true,\n      strokeWidth: epaisseur,\n      stroke: color,\n    }).outerHTML\n  }\n\n  arc(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    start: number,\n    stop: number,\n    closed: boolean,\n    { color = '#000', epaisseur = 1, roughness = 1, bowing = 0.5 } = {},\n  ) {\n    return this.roughSvg.arc(x, y, width, height, start, stop, closed, {\n      roughness,\n      bowing,\n      disableMultiStroke: true,\n      strokeWidth: epaisseur,\n      stroke: color,\n    }).outerHTML\n  }\n\n  circle(\n    x: number,\n    y: number,\n    rayon: number,\n    { color = '#000', epaisseur = 1, roughness = 1.5, bowing = 2.5 } = {},\n  ) {\n    return this.roughSvg.circle(x, y, rayon * 2, {\n      roughness,\n      bowing,\n      disableMultiStroke: true,\n      strokeWidth: epaisseur,\n      stroke: color,\n    }).outerHTML\n  }\n\n  polygon(\n    points: Array<[x: number, y: number]> = [],\n    { color = '#000', epaisseur = 1, roughness = 1.5, bowing = 2.5 } = {},\n  ) {\n    return this.roughSvg.polygon(points, {\n      roughness,\n      bowing,\n      disableMultiStroke: true,\n      strokeWidth: epaisseur,\n      stroke: color,\n    }).outerHTML\n  }\n\n  linearPath(\n    points: Array<[x: number, y: number]> = [],\n    { color = '#000', epaisseur = 1, roughness = 1.5, bowing = 2.5 } = {},\n  ) {\n    return this.roughSvg.linearPath(points, {\n      roughness,\n      bowing,\n      disableMultiStroke: true,\n      strokeWidth: epaisseur,\n      stroke: color,\n    }).outerHTML\n  }\n\n  ellipse(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    start: number,\n    stop: number,\n    closed: boolean,\n    { color = '#000', epaisseur = 1, roughness = 1, bowing = 0.5 } = {},\n  ) {\n    return this.roughSvg.ellipse(x, y, width, height, {\n      roughness,\n      bowing,\n      disableMultiStroke: true,\n      strokeWidth: epaisseur,\n      stroke: color,\n    }).outerHTML\n  }\n\n  rectangle(\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    start: number,\n    stop: number,\n    closed: boolean,\n    { color = '#000', epaisseur = 1, roughness = 1, bowing = 0.5 } = {},\n  ) {\n    return this.roughSvg.rectangle(x, y, width, height, {\n      roughness,\n      bowing,\n      disableMultiStroke: true,\n      strokeWidth: epaisseur,\n      stroke: color,\n    }).outerHTML\n  }\n\n  curve(\n    points: Array<[x: number, y: number]> = [],\n    { color = '#000', epaisseur = 1, roughness = 1.5, bowing = 2.5 } = {},\n  ) {\n    return this.roughSvg.curve(points, {\n      roughness,\n      bowing,\n      disableMultiStroke: true,\n      strokeWidth: epaisseur,\n      stroke: color,\n    }).outerHTML\n  }\n\n  destroy() {\n    this.div.removeChild(this.svg)\n  }\n\n  static create() {\n    const div: HTMLDivElement | null = document.querySelector('div#appMathalea')\n    if (!div) return null\n    const svg: SVGSVGElement = document.createElementNS(\n      'http://www.w3.org/2000/svg',\n      'svg',\n    )\n    svg.style.width = '1024'\n    svg.style.height = '1024'\n    svg.setAttribute('viewBox', '0 0 0 0')\n    div.appendChild(svg)\n    const roughSvg = rough.svg(svg)\n    return new MainLevee(roughSvg, div, svg)\n  }\n}\n\nexport default MainLevee\n","import {\n  colorToLatexOrHTML,\n  ObjetMathalea2D,\n  Vide2d,\n  type ObjetDivLatex,\n} from '../../modules/2dGeneralites'\nimport { context } from '../../modules/context'\nimport { Point3d } from '../3d/3dProjectionMathalea2d/elements'\nimport { arrondi } from '../outils/nombres'\nimport { stringNombre } from '../outils/texNombre'\nimport { point, Point } from './points'\nimport { PointAbstrait } from './points-abstraits'\nimport { Polygone } from './polygones'\n\nexport type AncrageDeRotationType = 'gauche' | 'milieu' | 'droite'\nexport const tikzAncrages = {\n  gauche: 'west',\n  milieu: 'center',\n  droite: 'east',\n}\nexport const svgAncrages = {\n  gauche: 'start',\n  milieu: 'middle',\n  droite: 'end',\n}\n/**\n * Associe  tous les points passs en paramtre, son label, dfini pralablement en Latex. Par exemple, si besoin de nommer le point A_1.\n * @param {number} [distance=1.5] Taille de l'angle\n * @param {string} [label=''] Si vide, alors affiche la mesure de l'angle sinon affiche ce label.\n * @param {Object} parametres  saisir entre accolades\n * @param {Point|Point[]} [parametres.points = []] Point ou tableau de points\n * @param {string} [parametres.color = 'black'] Couleur du label : du type 'blue' ou du type '#f15929'\n * @param {number} [parametres.taille = 8] Taille du label\n * @param {number} [parametres.largeur = 10] Largeur en pixels du label  des fins de centrage\n * @param {number} [parametres.hauteur = 10] Hauteur en pixels du label  des fins de centrage\n * @param {string} [parametres.couleurDeRemplissage=''] Couleur de fond de ce label : du type 'blue' ou du type '#f15929'\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} color Couleur du label.  associer obligatoirement  colorToLatexOrHTML().\n * @property {number} taille Taille du label\n * @property {number} largeur Largeur en pixels du label  des fins de centrage\n * @property {number} hauteur Hauteur en pixels du label  des fins de centrage\n * @property {string} couleurDeRemplissage Couleur de fond de ce label.  associer obligatoirement  colorToLatexOrHTML().\n * @author Rmi Angot et Jean-Claude Lhote\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport function labelLatexPoint(\n  {\n    points,\n    color,\n    taille,\n    largeur,\n    hauteur,\n    couleurDeRemplissage,\n  }: {\n    points: Point[]\n    color?: string\n    taille: number\n    largeur?: number\n    hauteur?: number\n    couleurDeRemplissage: string\n  } = {\n    points: [],\n    color: 'black',\n    taille: 8,\n    largeur: 10,\n    hauteur: 10,\n    couleurDeRemplissage: '',\n  },\n): ObjetMathalea2D[] {\n  // Jean-Claude Lhote 15/08/2023\n  const offset = 0.25 * Math.log10(taille) // context.pixelsParCm ne correspond pas forcment  la valeur utilise par mathalea2d... cela peut entrainer un trs lger cart\n  let x\n  let y\n  let A\n  const objets = []\n  let listePoints: Array<Point | Point3d>\n  if (Array.isArray(points[0])) {\n    // Si le premier argument est un tableau\n    listePoints = points[0]\n  } else {\n    listePoints = points\n  }\n  for (const unPoint of listePoints) {\n    if (unPoint instanceof Point3d) {\n      A = unPoint.c2d\n    } else {\n      A = unPoint\n    }\n    x = arrondi(A.x)\n    y = arrondi(A.y)\n    switch (A.positionLabel) {\n      case 'left':\n        objets.push(\n          latexParCoordonnees(\n            A.nom,\n            x - offset,\n            y,\n            color,\n            largeur,\n            hauteur,\n            couleurDeRemplissage,\n            taille,\n          ),\n        )\n        break\n      case 'right':\n        objets.push(\n          latexParCoordonnees(\n            A.nom,\n            x + offset,\n            y,\n            color,\n            largeur,\n            hauteur,\n            couleurDeRemplissage,\n            taille,\n          ),\n        )\n        break\n      case 'below':\n        objets.push(\n          latexParCoordonnees(\n            A.nom,\n            x,\n            y - offset,\n            color,\n            largeur,\n            hauteur,\n            couleurDeRemplissage,\n            taille,\n          ),\n        )\n        break\n      case 'above':\n        objets.push(\n          latexParCoordonnees(\n            A.nom,\n            x,\n            y + offset,\n            color,\n            largeur,\n            hauteur,\n            couleurDeRemplissage,\n            taille,\n          ),\n        )\n        break\n      case 'above right':\n        objets.push(\n          latexParCoordonnees(\n            A.nom,\n            x + offset,\n            y + offset,\n            color,\n            largeur,\n            hauteur,\n            couleurDeRemplissage,\n            taille,\n          ),\n        )\n        break\n      case 'below left':\n        objets.push(\n          latexParCoordonnees(\n            A.nom,\n            x - offset,\n            y - offset,\n            color,\n            largeur,\n            hauteur,\n            couleurDeRemplissage,\n            taille,\n          ),\n        )\n        break\n      case 'below right':\n        objets.push(\n          latexParCoordonnees(\n            A.nom,\n            x + offset,\n            y - offset,\n            color,\n            largeur,\n            hauteur,\n            couleurDeRemplissage,\n            taille,\n          ),\n        )\n        break\n      default:\n        objets.push(\n          latexParCoordonnees(\n            A.nom,\n            x - offset,\n            y + offset,\n            color,\n            largeur,\n            hauteur,\n            couleurDeRemplissage,\n            taille,\n          ),\n        )\n        break\n    }\n  }\n  return objets\n}\n\n/**  Nomme les points passs en argument, le nombre d'arguments n'est pas limit.\n * @param  {(Point|string)[]} args Points mis  la suite si une couleur doit tre passe, c'est le dernier argument\n * @property {string} color Couleur des points.  associer obligatoirement  colorToLatexOrHTML().\n * @property {number} taille Taille de la boite contenant le nom des points\n * @property {number} largeur Largeur de la boite contenant le nom des points\n * @property {number[]} bordures Coordonnes de la fentre d'affichage du genre [-2,-2,5,5]\n * @author Rmi Angot\n * @return object[]\n */\n// JSDOC Validee par EE Septembre 2022\nexport function labelPoint(...args: (PointAbstrait | Point | string)[]) {\n  const taille = 1\n  const points = [...args]\n  let color\n  if (typeof points[points.length - 1] === 'string') {\n    color = colorToLatexOrHTML(String(points[points.length - 1]))\n    points.length--\n  } else {\n    color = colorToLatexOrHTML('black')\n  }\n  const objets = []\n  for (const unPoint of points) {\n    let A\n    if (unPoint instanceof Point3d) {\n      A = unPoint.c2d\n    } else {\n      A = unPoint\n    }\n\n    let x, y\n    if (A instanceof Point || A instanceof PointAbstrait) {\n      x = A.x\n      y = A.y\n      // if (this.positionLabel === '' && unPoint.typeObjet === 'point3d') A.positionLabel = this.positionLabel\n      switch (A.positionLabel) {\n        case 'left':\n          objets.push(\n            texteParPosition(\n              A.nom,\n              x - 10 / context.pixelsParCm,\n              y,\n              0,\n              color[0],\n              taille,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n          break\n        case 'right':\n          objets.push(\n            texteParPosition(\n              A.nom,\n              x + 10 / context.pixelsParCm,\n              y,\n              0,\n              color[0],\n              taille,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n          break\n        case 'below':\n          objets.push(\n            texteParPosition(\n              A.nom,\n              x,\n              y - 10 / context.pixelsParCm,\n              0,\n              color[0],\n              taille,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n          break\n        case 'above':\n          objets.push(\n            texteParPosition(\n              A.nom,\n              x,\n              y + 10 / context.pixelsParCm,\n              0,\n              color[0],\n              taille,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n          break\n        case 'above left':\n          objets.push(\n            texteParPosition(\n              A.nom,\n              x - 10 / context.pixelsParCm,\n              y + 10 / context.pixelsParCm,\n              0,\n              color[0],\n              taille,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n          break\n        case 'above right':\n          objets.push(\n            texteParPosition(\n              A.nom,\n              x + 10 / context.pixelsParCm,\n              y + 10 / context.pixelsParCm,\n              0,\n              color[0],\n              taille,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n          break\n        case 'below left':\n          objets.push(\n            texteParPosition(\n              A.nom,\n              x - 10 / context.pixelsParCm,\n              y - 10 / context.pixelsParCm,\n              0,\n              color[0],\n              taille,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n          break\n        case 'below right':\n          objets.push(\n            texteParPosition(\n              A.nom,\n              x + 10 / context.pixelsParCm,\n              y - 10 / context.pixelsParCm,\n              0,\n              color[0],\n              taille,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n          break\n        default:\n          objets.push(\n            texteParPosition(\n              A.nom,\n              x,\n              y,\n              0,\n              color[0],\n              taille,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n          break\n      }\n    }\n  }\n  return objets\n}\n\n/**  Dplace les labels des sommets d'un polygone s'ils sont mal placs nativement\n * @param {Polygone} p Polygone sur lequel les labels de ses sommets sont mal placs\n * @param {string} nom Points mal placs sous la forme, par exemple, 'AB'. Chaque point doit tre reprsent par un SEUL caractre.\n * @param {string} positionLabel Les possibilits sont : 'left', 'right', 'below', 'above', 'above right', 'above left', 'below right', 'below left'. Si on se trompe dans l'orthographe, ce sera 'above left' et si on ne prcise rien, pour un point ce sera 'above'.\n * @example deplaceLabel(p1,'MNP','below') // S'il y a des points nomms 'M', 'N' ou 'P' dans le polygone p1, leur nom sera mis en dessous du point.\n * // Ne fonctionne pas avec les points du type A1 ou A_1.\n * @author Rmi Angot\n */\n// JSDOC Validee par EE Aout 2022\nexport function deplaceLabel(p: Polygone, nom: string, positionLabel: string) {\n  for (let i = 0; i < p.listePoints.length; i++) {\n    for (const lettre of nom) {\n      if (p.listePoints[i].nom === lettre) {\n        p.listePoints[i].positionLabel = positionLabel\n        labelPoint(p.listePoints[i])\n      }\n    }\n  }\n}\n\n/**\n * texteParPoint('mon texte',A) // crit 'mon texte' avec A au centre du texte\n * texteParPoint('mon texte',A,45) // crit 'mon texte' centr sur A avec une rotation de 45\n * texteParPoint('mon texte',A, 0, 'black', 1, 'gauche',true, 0.5) // crit le texte  droite du point A car le point d'ancrage est  gauche\n *  // couleur du texte en noir, avec une taille normale et une police mathmatique et une opacit de 50%\n * oriention est un nombre, c'est l'angle de rotation (0 par dfaut), et il faut positionner le centre de rotation avec ancrageDeRotation (milieu par dfaut)\n * ancrageDeRotation est  prendre parmi ['milieu', 'gauche', 'droite']\n * Si mathOn est true, la chaine est traite par texteParPoint mais avec une police se rapprochant de la police Katex (quelques soucis d'alignement des caractres sur certains navigateurs)\n * Si le texte commence et finit par des $ la chaine est traite par latexParPoint\n * @author Rmi Angot rectifi par Jean-Claude Lhote\n */\nexport class TexteParPoint extends ObjetMathalea2D {\n  texte: string\n  point: PointAbstrait | Vide2d\n  orientation: number\n  color: [string, string]\n  scale: number\n  ancrageDeRotation: AncrageDeRotationType\n  mathOn: boolean\n  opacite: number\n  gras: boolean\n  opaciteDeRemplissage!: number\n  bordures: [number, number, number, number]\n  couleurDeRemplissage: [string, string]\n  contour: boolean\n  taille: number\n\n  constructor(\n    texte: string,\n    A: PointAbstrait | Vide2d,\n    orientation: number = 0,\n    color: string = 'black',\n    scale: number = 1,\n    ancrageDeRotation: AncrageDeRotationType = 'milieu',\n    mathOn: boolean = false,\n    opacite: number = 1,\n  ) {\n    super()\n    if (typeof orientation !== 'number') {\n      if (orientation === 'milieu' || typeof orientation === 'string') {\n        ancrageDeRotation = orientation\n        orientation = 0\n      }\n    }\n    if (!['milieu', 'gauche', 'droite'].includes(ancrageDeRotation))\n      ancrageDeRotation = 'milieu'\n\n    this.ancrageDeRotation = ancrageDeRotation\n    this.orientation = orientation\n    this.color = colorToLatexOrHTML(color)\n    this.scale = scale\n    this.taille = Math.round(14 * scale)\n    this.opacite = opacite\n    this.couleurDeRemplissage = colorToLatexOrHTML(color)\n    this.mathOn = mathOn\n    this.point = A\n    this.gras = false\n    this.contour = false\n    this.opaciteDeRemplissage = opacite\n\n    if (typeof texte !== 'string') {\n      if (!Number.isNaN(texte)) texte = stringNombre(texte, 3)\n    }\n    const angle = (Math.PI * orientation) / 180\n    // constantes utilise pour le calcul des bordures\n    const cx = Math.cos(angle)\n    const sx = Math.sin(angle)\n    const ratioLettreCm = 0.25\n    const epaisseurTexte = 0.3 * scale\n    const longueurTexte = texte.length * ratioLettreCm * scale\n    // dfinition des bordures suivant le point d'ancrage\n    if (ancrageDeRotation === 'milieu') {\n      this.bordures = [\n        A.x - longueurTexte * cx,\n        A.y - longueurTexte * sx - epaisseurTexte,\n        A.x + longueurTexte * cx,\n        A.y + longueurTexte * sx + epaisseurTexte,\n      ]\n    } else if (ancrageDeRotation === 'gauche') {\n      this.bordures = [\n        A.x,\n        A.y - 2 * (longueurTexte * sx) - epaisseurTexte,\n        A.x + 2 * (longueurTexte * cx),\n        A.y + epaisseurTexte,\n      ]\n    } else {\n      this.bordures = [\n        A.x - 2 * longueurTexte * cx,\n        A.y - epaisseurTexte,\n        A.x,\n        A.y + 2 * (longueurTexte * sx) + epaisseurTexte,\n      ]\n    }\n\n    if (typeof texte !== 'string') {\n      texte = String(texte)\n    }\n    texte = texte.replaceAll('$$', '$') // a arrive que des fonctions ajoutent des $ alors qu'il y en a dj...\n    this.texte = texte\n  }\n\n  svg(coeff: number) {\n    if (this.texte.charAt(0) === '$') {\n      if (!this.point.positionLabel) {\n        this.point.positionLabel = 'above'\n      }\n      return latex2d(\n        this.texte.substring(1, this.texte.length - 1),\n        this.point.x,\n        this.point.y,\n        {\n          color: this.color[0],\n          orientation: this.orientation,\n          letterSize: 'normalsize',\n        },\n      ).svg()\n    } else {\n      let code = ''\n      let style = ''\n      if (this.mathOn)\n        style = ' font-family= \"Book Antiqua\"; font-style= \"italic\" '\n      if (this.contour)\n        style += ` style=\"font-size: ${this.taille}px;fill: ${this.couleurDeRemplissage[0]};fill-opacity: ${this.opaciteDeRemplissage};stroke: ${this.color[0]};stroke-width: 0.5px;stroke-linecap: butt;stroke-linejoin:miter;stroke-opacity: ${this.opacite}\" `\n      else\n        style += ` style=\"font-size:${this.taille}px;fill:${this.color[0]};fill-opacity:${this.opacite};${this.gras ? 'font-weight:bolder' : ''}\" `\n      const anchor = svgAncrages[this.ancrageDeRotation]\n      code = `<text ${style} x=\"${this.point.xSVG(coeff)}\" y=\"${this.point.ySVG(\n        coeff,\n      )}\" text-anchor = \"${anchor}\" dominant-baseline = \"central\" fill=\"${\n        this.couleurDeRemplissage[0]\n      }\" transform=\"rotate(${String(this.orientation)} ${this.point.xSVG(coeff)} ${this.point.ySVG(\n        coeff,\n      )})\" id=\"${this.id}\" >${this.texte}</text>\\n `\n      return code\n    }\n  }\n\n  tikz() {\n    if (this.texte.charAt(0) === '$') {\n      if (!this.point.positionLabel) {\n        this.point.positionLabel = 'above'\n      }\n      let code = ''\n      const anchor = tikzAncrages[this.ancrageDeRotation]\n      code = `\\\\draw [color=${this.color[1]}] (${String(arrondi(this.point.x))},${String(\n        arrondi(this.point.y),\n      )}) node[anchor = ${anchor},scale=${String(this.scale)}, rotate = ${String(-this.orientation)}] {${this.texte}};`\n      return code\n    } else {\n      let code = ''\n      const anchor = tikzAncrages[this.ancrageDeRotation]\n      code = `\\\\draw [color=${this.color[1]}] (${arrondi(this.point.x)},${arrondi(\n        this.point.y,\n      )}) node[anchor = ${anchor},scale=${String(this.scale)}, rotate = ${String(-this.orientation)}] {${this.texte}};`\n      return code\n    }\n  }\n}\n/**\n * texteParPoint('mon texte',A) // crit 'mon texte' avec A au centre du texte\n * texteParPoint('mon texte',A,45) // crit 'mon texte' centr sur A avec une rotation de 45\n * texteParPoint('mon texte',A, 0, 'black', 1, 'gauche',true, 0.5) // crit le texte  droite du point A car le point d'ancrage est  gauche\n *  // couleur du texte en noir, avec une taille normale et une police mathmatique et une opacit de 50%\n * oriention est un nombre, c'est l'angle de rotation (0 par dfaut), et il faut positionner le centre de rotation avec ancrageDeRotation (milieu par dfaut)\n * ancrageDeRotation est  prendre parmi ['milieu', 'gauche', 'droite']\n * Si mathOn est true, la chaine est traite par texteParPoint mais avec une police se rapprochant de la police Katex (quelques soucis d'alignement des caractres sur certains navigateurs)\n * Si le texte commence et finit par des $ la chaine est traite par latexParPoint\n * @author Rmi Angot rectifi par Jean-Claude Lhote\n */\nexport function texteParPoint(\n  texte: string,\n  A: PointAbstrait | Vide2d,\n  orientation: number = 0,\n  color: string = 'black',\n  scale: number = 1,\n  ancrageDeRotation: 'milieu' | 'droite' | 'gauche' = 'milieu',\n  mathOn: boolean = false,\n  opacite: number = 1,\n) {\n  return new TexteParPoint(\n    texte,\n    A,\n    orientation,\n    color,\n    scale,\n    ancrageDeRotation,\n    mathOn,\n    opacite,\n  )\n}\n\nexport class TexteParPointEchelle extends ObjetMathalea2D {\n  gras: boolean\n  texte: string\n  point: PointAbstrait\n  orientation: number\n  color: [string, string]\n  scale: number\n  ancrageDeRotation: AncrageDeRotationType\n  mathOn: boolean\n  scaleFigure: number\n  contour: boolean\n  couleurDeRemplissage!: [string, string]\n  opaciteDeRemplissage!: number\n  bordures: [number, number, number, number]\n  taille: number\n  constructor(\n    texte: string,\n    A: PointAbstrait,\n    orientation: number = 0,\n    color: string = 'black',\n    scale: number = 1,\n    ancrageDeRotation: AncrageDeRotationType = 'milieu',\n    mathOn: boolean = false,\n    scaleFigure: number,\n  ) {\n    super()\n    if (typeof orientation !== 'number') {\n      if (orientation === 'milieu' || typeof orientation === 'string') {\n        ancrageDeRotation = orientation\n        orientation = 0\n      }\n    }\n    if (!['milieu', 'gauche', 'droite'].includes(ancrageDeRotation))\n      ancrageDeRotation = 'milieu'\n    this.color = colorToLatexOrHTML(color)\n    this.contour = false\n    this.mathOn = mathOn\n    this.gras = false\n    this.point = A\n    this.scale = scale\n    this.scaleFigure = scaleFigure\n    this.taille = 10 * scale\n    this.opacite = 1\n    this.couleurDeRemplissage = colorToLatexOrHTML(color)\n    this.opaciteDeRemplissage = this.opacite\n    this.bordures = [\n      A.x - texte.length * 0.2,\n      A.y - 0.4,\n      A.x + texte.length * 0.2,\n      A.y + 0.4,\n    ]\n    this.texte = texte\n    this.orientation = orientation\n    this.ancrageDeRotation = ancrageDeRotation\n  }\n\n  svg(coeff: number) {\n    if (this.texte.charAt(0) === '$') {\n      return latexParPoint(\n        this.texte.substring(1, this.texte.length - 2),\n        this.point,\n        this.color[0],\n        this.texte.length * 8,\n        10,\n        '',\n        this.taille * 0.8,\n      ).svg(coeff)\n    } else {\n      let style = ''\n      if (this.mathOn)\n        style = ' font-family= \"Book Antiqua\"; font-style= \"italic\" '\n      if (this.contour)\n        style += ` style=\"font-size: ${this.taille}px;fill: ${this.couleurDeRemplissage[0]};fill-opacity: ${this.opaciteDeRemplissage};stroke: ${this.color[0]};stroke-width: 0.5px;stroke-linecap: butt;stroke-linejoin:miter;stroke-opacity: ${this.opacite}\" `\n      else\n        style += ` style=\"font-size:${this.taille}px;fill:${this.color[0]};fill-opacity:${this.opacite};${this.gras ? 'font-weight:bolder' : ''}\" `\n      return `<text ${style} x=\"${this.point.xSVG(coeff)}\" y=\"${this.point.ySVG(\n        coeff,\n      )}\" text-anchor = \"${svgAncrages[this.ancrageDeRotation]}\" dominant-baseline = \"central\" fill=\"${\n        this.color[0]\n      }\" transform=\"rotate(${String(this.orientation)} ${this.point.xSVG(coeff)} ${this.point.ySVG(\n        coeff,\n      )})\" id=\"${this.id}\" >${this.texte}</text>\\n `\n    }\n  }\n\n  tikz() {\n    let copyThistexte = this.texte\n    if (this.mathOn && copyThistexte[0] !== '$')\n      copyThistexte = '$' + this.texte + '$'\n    return `\\\\draw ${this.color[0] === 'black' ? '' : `[color=${this.color[1]}]`} (${String(arrondi(this.point.x))},${String(\n      arrondi(this.point.y),\n    )}) node[anchor = ${tikzAncrages[this.ancrageDeRotation]}, rotate = ${String(-this.orientation)}, scale=${(this.scale * this.scaleFigure * 1.25).toFixed(2)}] {${copyThistexte}};`\n  }\n}\nexport function texteParPointEchelle(\n  texte: string,\n  A: Point,\n  orientation: number = 0,\n  color: string = 'black',\n  scale: number = 1,\n  ancrageDeRotation: 'milieu' | 'droite' | 'gauche' = 'milieu',\n  mathOn: boolean = false,\n  scaleFigure: number = 1,\n): TexteParPointEchelle {\n  return new TexteParPointEchelle(\n    texte,\n    A,\n    orientation,\n    color,\n    scale,\n    ancrageDeRotation,\n    mathOn,\n    scaleFigure,\n  )\n}\n\nexport function texteParPositionEchelle(\n  texte: string,\n  x: number,\n  y: number,\n  orientation: number = 0,\n  color: string = 'black',\n  scale: number = 1,\n  ancrageDeRotation: 'milieu' | 'droite' | 'gauche' = 'milieu',\n  mathOn: boolean = false,\n  scaleFigure: number = 1,\n) {\n  return texteParPointEchelle(\n    texte,\n    point(arrondi(x, 2), arrondi(y, 2), '', 'center'),\n    orientation,\n    color,\n    scale,\n    ancrageDeRotation,\n    mathOn,\n    scaleFigure,\n  )\n}\n\n/**\n * texteParPosition('mon texte',x,y) // crit 'mon texte' avec (x,y) au centre du texte\n * texteParPoint('mon texte',x,y,45) // crit 'mon texte' centr sur A avec une rotation de 45\n * orientation est l'angle de rotation du texte\n * ancrageDeRotation est  prendre parmi ['milieu', 'gauche', 'droite']\n * Si mathOn est true, la chaine est traite par texteParPoint mais avec une police se rapprochant de la police Katex (quelques soucis d'alignement des caractres sur certains navigateurs)\n * Si le texte commence et finit par des $ la chaine est traite par latex2d en retirant les $ en 1re et dernire position\n * @author Rmi Angot\n * @param {string} texte // Le texte qu'on veut afficher\n * @param {number} x // L'abscisse de la position initiale du texte\n * @param {number} y // L'ordonne de la position initiale du texte\n * @param {number} [orientation=0]\n * @param {string} [color='black'] // Couleur du texte\n * @param {number} [scale=1] // Echelle du texte.\n * @param {AncrageDeRotationType} [ancrageDeRotation='milieu']\n * @param {string} [mathOn=false] // Ecriture dans le style de Latex.\n *\n * @author Rmi Angot\n */\nexport function texteParPosition(\n  texte: string | number,\n  x: number,\n  y: number,\n  orientation: number = 0,\n  color: string = 'black',\n  scale: number = 1,\n  ancrageDeRotation: 'milieu' | 'gauche' | 'droite' = 'milieu',\n  mathOn: boolean = false,\n  opacite?: number,\n) {\n  if (typeof texte === 'number') texte = String(texte)\n  if (typeof orientation !== 'number') {\n    ancrageDeRotation = orientation\n    orientation = 0\n  }\n  // @ts-expect-error TS2367 // normalement ts devrait veiller au grain, sauf que plein d'exo tournant en js ont mal utilis ces paramtres, donc on blinde.\n  if (ancrageDeRotation === 'middle') ancrageDeRotation = 'milieu'\n  if (!['milieu', 'droite', 'gauche'].includes(ancrageDeRotation))\n    ancrageDeRotation = 'milieu'\n  if (texte[0] === '$') {\n    return latex2d(texte.substring(1, texte.length - 1), x, y, {\n      color,\n      backgroundColor: 'white',\n      letterSize: 'normalsize',\n    })\n  } else {\n    return new TexteParPoint(\n      texte,\n      point(x, y, ''),\n      orientation,\n      color,\n      scale,\n      ancrageDeRotation,\n      mathOn,\n      opacite,\n    )\n  }\n}\n\n/**\n * latexParPoint('\\\\dfrac{3}{5}',A,'black',12,20,\"white\") Ecrit la fraction 3/5  l'emplacement du label du point A en noir, avec un fond blanc.\n * 12 est la largeur en pixels 20 la hauteur en pixels (utilis  des fins de centrage). Pour un bon centrage sur A, il faut que A.positionLabel='center'.\n * si colorBackground=\"\", le fond est transparent.\n * tailleCaracteres est  8 par dfaut et correspond  \\footnotesize. tailleCaracteres va de 5 = \\small  20 = \\huge\n * @author Rmi Angot\n */\nexport function latexParPoint(\n  texte: string,\n  A: PointAbstrait | Vide2d,\n  color: string = 'black',\n  largeur: number = 20,\n  hauteur: number = 12,\n  colorBackground: string = 'white',\n  tailleCaracteres: number = 8,\n): LatexParCoordonnees | Vide2d {\n  let x\n  let y\n  const coeff = context.pixelsParCm\n  const offset = 10 * Math.log10(tailleCaracteres)\n  switch (A.positionLabel) {\n    case 'above':\n      x = A.x\n      y = A.y + offset / coeff\n      break\n    case 'below':\n      x = A.x\n      y = A.y - offset / coeff\n      break\n    case 'left':\n      x = A.x - offset / coeff\n      y = A.y\n      break\n    case 'right':\n      x = A.x + offset / coeff\n      y = A.y\n      break\n    case 'above right':\n      x = A.x + offset / coeff\n      y = A.y + offset / coeff\n      break\n    case 'above left':\n      x = A.x - offset / coeff\n      y = A.y + offset / coeff\n      break\n    case 'below right':\n      x = A.x + offset / coeff\n      y = A.y - offset / coeff\n      break\n    case 'below left':\n      x = A.x - offset / coeff\n      y = A.y - offset / coeff\n      break\n    case 'center':\n      x = A.x\n      y = A.y\n      break\n    default:\n      x = A.x\n      y = A.y\n      break\n  }\n  return latexParCoordonnees(\n    texte,\n    x,\n    y,\n    color,\n    largeur,\n    hauteur,\n    colorBackground,\n    tailleCaracteres,\n  )\n}\n\n/**\n * @param {string} texte Le code latex qui sera mis en mode math en ligne. Ex : '\\\\dfrac{4}{5}\\\\text{cm}'\n * @param {number} x abscisse du point de centrage\n * @param {number} y ordonne du point de centrage\n * @param {string} [color] couleur\n * @param {number} [largeur] Dimensions de la 'box' rectangulaire conteneur de la formule en pixels en considrant la taille de caractre 8='\\footnotesize'\n * @param {number} [hauteur] Idem pour la hauteur de la box. Prvoir 20 par exemple pour une fraction. Permet le centrage correct.\n * @param {string} [colorBackground] Couleur du fond de la box. Chaine vide pour un fond transparent.\n * @param {number} [tailleCaracteres] Taille de la police utilise de 5 = \\small  20=\\huge... agit sur la box en en modifiant les paramtres hauteur et largeur\n * @return LatexParCoordonnees\n * @deprecated Utiliser la fonction latex2d() beaucoup plus volue.\n * @class\n */\nexport class LatexParCoordonnees extends ObjetMathalea2D {\n  x: number\n  y: number\n  largeur: number\n  hauteur: number\n  colorBackground: string\n  texte: string\n  bordures: [number, number, number, number]\n  taille: string\n  orientation: number\n  constructor(\n    texte: string,\n    x: number,\n    y: number,\n    color: string,\n    largeur: number,\n    hauteur: number,\n    colorBackground: string = '',\n    tailleCaracteres: number = 8,\n  ) {\n    super()\n    this.x = x\n    this.y = y\n    this.largeur = largeur * Math.log10(2 * tailleCaracteres)\n    this.hauteur = hauteur * Math.log10(tailleCaracteres)\n    this.colorBackground = colorBackground\n    this.color = colorToLatexOrHTML(color)\n    this.texte = texte\n    this.orientation = 0 // dans latexParCoordonnees le latex ne peux pas tourner (on n'a pas d'argument pour a et c'est pour cela qu'il y a latex2d() !)\n    this.bordures = [\n      this.x - (this.texte.length ?? 0) * 0.15,\n      this.y - 0.02 * this.hauteur,\n      this.x + (this.texte.length ?? 0) * 0.15,\n      this.y + 0.02 * this.hauteur,\n    ]\n    if (tailleCaracteres > 19) this.taille = '\\\\huge'\n    else if (tailleCaracteres > 16) this.taille = '\\\\LARGE'\n    else if (tailleCaracteres > 13) this.taille = '\\\\Large'\n    else if (tailleCaracteres > 11) this.taille = '\\\\large'\n    else if (tailleCaracteres < 6) this.taille = '\\\\tiny'\n    else if (tailleCaracteres < 8) this.taille = '\\\\scriptsize'\n    else if (tailleCaracteres < 9) this.taille = '\\\\footnotesize'\n    else if (tailleCaracteres < 10) this.taille = '\\\\small'\n    else this.taille = '\\\\normalsize'\n    if (typeof this.texte !== 'string')\n      throw Error(\n        `Vous n'avez pas passer un string  latexParCoordonnees() : ${this.texte}`,\n      )\n    // texte doit tre de type texte maintenant, sinon, tu revois ton code !\n    //  if (texte === '') return vide2d(x, y) // ton texte est vide ? ben y a rien  afficher !\n    if (this.texte[0] === '$' && this.texte[this.texte.length - 1] === '$') {\n      // tu as mis des $ $ pour dlimiter ton texte.\n      // Or c'est prvu d'en ajouter parce que c'est l'ide qu'on se fait de latexParCoordonnees()\n      // Si c'est pas pour du latex en mode math, on aurait utilis texteParPosition-) !\n      this.texte = this.texte.substring(1, this.texte.length - 2) // donc on les enlve, pour ne pas avoir des $$ !\n    }\n  }\n\n  // Eh oui ! le svg() de latexParCoordonnees est un objet. En fait, cela va produire un div mais plus tard : dans la fonction mathalea2d().\n  svg() {\n    return {\n      latex: this.texte,\n      x: this.x,\n      y: this.y,\n      opacity: this.opacite,\n      orientation: this.orientation,\n      letterSize: this.taille.substring(1),\n      color: this.color[0],\n      backgroundColor: this.colorBackground,\n    }\n  }\n\n  tikz() {\n    let code\n    if (this.colorBackground !== '' && this.colorBackground !== 'none') {\n      code = `\\\\draw (${this.x},${this.y}) node[anchor = center] {\\\\colorbox ${colorToLatexOrHTML(this.colorBackground)[1]}{${this.taille}  \\\\color${this.color[1]}{$${this.texte}$}}};`\n    } else {\n      code = `\\\\draw (${this.x},${this.y}) node[anchor = center] {${this.taille} \\\\color${this.color[1]}{$${this.texte}$}};`\n    }\n    return code\n  }\n}\n\n/**\n * @deprecated utiliser latex2d()  la place (plus rcent et plus facile d'usage)\n * @param texte\n * @param x\n * @param y\n * @param color\n * @param largeur // paramtre inutile\n * @param hauteurLigne // paramtre inutile\n * @param colorBackground\n * @param tailleCaracteres\n */\nexport function latexParCoordonnees(\n  texte: string,\n  x: number,\n  y: number,\n  color: string = 'black',\n  largeur: number = 50,\n  hauteurLigne: number = 20,\n  colorBackground: string = '',\n  tailleCaracteres: number = 8,\n) {\n  if (texte === '') texte = '\\\\phantom{ }'\n  return new LatexParCoordonnees(\n    texte,\n    x,\n    y,\n    color,\n    largeur,\n    hauteurLigne,\n    colorBackground,\n    tailleCaracteres,\n  )\n}\n\n/**\n * @param {String} texte Le code latex qui sera mis en mode math en ligne. Ex : '\\\\dfrac{4}{5}\\\\text{cm}'\n * @param {Number} x abscisse du point de centrage\n * @param {Number} y ordonne du point de centrage\n * @param {String} [color] couleur\n * @param {Number} [largeur] Dimensions de la 'box' rectangulaire conteneur de la formule en pixels en considrant la taille de caractre 8='\\footnotesize'\n * @param {Number} [hauteur] Idem pour la hauteur de la box. Prvoir 20 par exemple pour une fraction. Permet le centrage correct.\n * @param {String} [colorBackground] Couleur du fond de la box. Chaine vide pour un fond transparent.\n * @param {Number} [tailleCaracteres] Taille de la police utilise de 5 = \\small  20=\\huge... agit sur la box en en modifiant les paramtres hauteur et largeur\n * @Param {Struct} {options} options.anchor pour forcer la boite\n */\nexport class LatexParCoordonneesBox extends ObjetMathalea2D {\n  texte: string\n  x: number\n  y: number\n  color: [string, string]\n  largeur: number\n  hauteur: number\n  colorBackground: [string, string]\n  taille: string = 'footnotesize'\n  options?: { anchor: string; dx?: string; dy?: string }\n  bordures: [number, number, number, number]\n  style: string\n  constructor(\n    texte: string,\n    x: number,\n    y: number,\n    color: string,\n    largeur: number,\n    hauteur: number,\n    colorBackground: string,\n    tailleCaracteres: number = 8,\n    options: { anchor: string; dx?: string; dy?: string },\n  ) {\n    super()\n    this.x = x\n    this.y = y\n    this.largeur = largeur // * Math.log10(2 * tailleCaracteres)\n    this.hauteur = hauteur // * Math.log10(tailleCaracteres)\n    this.colorBackground = colorToLatexOrHTML(colorBackground)\n    this.color = colorToLatexOrHTML(color)\n    this.texte = texte\n    this.style = ''\n    this.bordures = [\n      x - this.texte.length * 0.2,\n      y - 0.02 * this.hauteur,\n      x + this.texte.length * 0.2,\n      y + 0.02 * this.hauteur,\n    ]\n    if (tailleCaracteres > 19) this.taille = '\\\\huge'\n    else if (tailleCaracteres > 16) this.taille = '\\\\LARGE'\n    else if (tailleCaracteres > 13) this.taille = '\\\\Large'\n    else if (tailleCaracteres > 11) this.taille = '\\\\large'\n    else if (tailleCaracteres < 6) this.taille = '\\\\tiny'\n    else if (tailleCaracteres < 8) this.taille = '\\\\scriptsize'\n    else if (tailleCaracteres < 9) this.taille = '\\\\footnotesize'\n    else if (tailleCaracteres < 10) this.taille = '\\\\small'\n    else this.taille = '\\\\normalsize'\n\n    if (options.anchor !== undefined && options.anchor !== '') {\n      switch (options.anchor) {\n        case 'center': {\n          let dy = 0\n          if (\n            options.dy === undefined ||\n            options.dy === '' ||\n            options.dy.indexOf('%') < 0\n          ) {\n            dy = 0\n          } else {\n            dy = parseInt(options.dy.substr(0, options.dy.indexOf('%')))\n          }\n          let dx = 0\n          if (\n            options.dx === undefined ||\n            options.dx === '' ||\n            options.dx.indexOf('%') < 0\n          ) {\n            dx = 0\n          } else {\n            dx = parseInt(options.dx.substr(0, options.dx.indexOf('%')))\n          }\n          this.style = `position:fixed;top: 50%;left: 50%;transform: translate(${-50 + dx}%, ${-50 + dy}%);`\n          break\n        }\n        case 'above':\n          this.style = 'position:fixed;bottom:0;'\n          break\n        case 'left':\n          this.style = 'position:fixed;right:0;'\n          break\n        case 'right':\n          this.style = 'position:fixed;left:0;'\n          break\n        case 'below':\n          this.style = 'position:fixed;top:0;'\n          break\n      }\n    }\n    if (colorBackground !== '') {\n      this.style += `background-color: ${this.colorBackground[0]};`\n    }\n  }\n\n  svg(coeff: number) {\n    const demiLargeur = this.largeur / 2\n    const centrage = 0 // 0.4 * context.pixelsParCm * Math.log10(tailleCaracteres)\n    return `<foreignObject style=\" overflow: visible; line-height: 0;\" x=\"${this.x * coeff - demiLargeur}\" y=\"${-this.y * coeff - centrage - this.hauteur / 2}\"  width=\"${this.largeur}\" height=\"${this.hauteur}\" id=\"${this.id}\" ><div style=\"width:${this.largeur}px;height:${this.hauteur}px;position:fixed!important; text-align:center\">\n      <div style='${this.style}'>\n      $${this.taille} \\\\color{${this.color[0]}}{${this.texte}}$\n      </div></div></foreignObject>`\n    // <circle cx=\"${this.x * coeff - demiLargeur}\" cy=\"${-this.y * coeff - centrage - this.hauteur / 2}\" r=\"1\" fill=\"red\" stroke=\"blue\" stroke-width=\"2\"  />\n    // <circle cx=\"${this.x * coeff}\" cy=\"${-this.y * coeff}\" r=\"1\" fill=\"red\" stroke=\"blue\" stroke-width=\"2\"  />`\n  }\n\n  tikz() {\n    let code\n    if (this.colorBackground[1] !== '') {\n      code = `\\\\draw (${this.x},${this.y}) node[anchor = center] {\\\\colorbox ${this.colorBackground[1]}{${this.taille}  \\\\color${this.color[1]}{$${this.texte}$}}};`\n    } else {\n      code = `\\\\draw (${this.x},${this.y}) node[anchor = center] {${this.taille} \\\\color${this.color[1]}{$${this.texte}$}};`\n    }\n    return code\n  }\n}\n\nexport function latexParCoordonneesBox(\n  texte: string,\n  x: number,\n  y: number,\n  color: string = 'black',\n  largeur: number = 50,\n  hauteurLigne: number = 20,\n  colorBackground: string = 'white',\n  tailleCaracteres: number = 8,\n  options: { anchor: string; dx?: string; dy?: string },\n) {\n  if (texte === '') texte = '\\\\phantom{ }' // pour viter les latex vides\n  return new LatexParCoordonneesBox(\n    texte,\n    x,\n    y,\n    color,\n    largeur,\n    hauteurLigne,\n    colorBackground,\n    tailleCaracteres,\n    options,\n  )\n}\n\nexport type LetterSizeType =\n  | 'tiny'\n  | 'small'\n  | 'scriptsize'\n  | 'footnotesize'\n  | 'large'\n  | 'Large'\n  | 'LARGE'\n  | 'huge'\n  | 'normalsize'\n\n/**\n * cre un obiet mathalea2D qui affiche du latex et qui peut tourner contrairement  latexParCoordonnees qui est horizontal\n */\nexport class Latex2d extends ObjetMathalea2D {\n  letterSize: LetterSizeType\n  latex: string\n  x: number\n  y: number\n  opacity: number\n  orientation: number\n  bordures: [number, number, number, number]\n  col: string\n  backgroundCol: string\n\n  /**\n   * Les paramtres obligatoires (ne pas mettre de $ $ dans le latex !\n   * @param latex\n   * @param x\n   * @param y\n   * @param options\n   * @param options.color la couleur du texte\n   * @param options.backgroundColor la couleur de fond\n   * @param options.letterSize la taille des caractres en texte latex sans l'antislash\n   * @param options.orientation l'angle de rotation en degrs\n   * @param options.opacity l'opacit du texte // @fixme non encore implment\n   *\n   */\n  constructor(\n    latex: string,\n    x: number,\n    y: number,\n    {\n      color = 'black',\n      backgroundColor = '',\n      letterSize = 'normalsize',\n      orientation = 0,\n      opacity = 1,\n    }: {\n      color: string\n      backgroundColor: string\n      letterSize: LetterSizeType\n      orientation: number\n      opacity: number\n    },\n  ) {\n    super()\n    this.col = color\n    this.backgroundCol = backgroundColor\n    this.letterSize = letterSize\n    this.orientation = orientation\n    this.opacity = opacity\n    this.latex = latex\n    this.x = x\n    this.y = y\n    const marge = 0.25\n    this.bordures = [x - marge, y - marge, x + marge, y + marge]\n  }\n\n  svg(): ObjetDivLatex {\n    // On prend la couleur Latex, parce que c'est pour Katex !\n    return {\n      latex: this.latex,\n      x: this.x,\n      y: this.y,\n      opacity: this.opacity,\n      orientation: this.orientation,\n      letterSize: this.letterSize,\n      color: this.col.replace('#', ''),\n      backgroundColor: this.backgroundCol.replace('#', ''),\n    }\n  }\n\n  // @todo ajouter opacity, orientation au tikz.\n  tikz() {\n    if (this.backgroundCol.startsWith('#')) {\n      this.backgroundCol = `[HTML]{${this.backgroundCol.substring(1)}}`\n    } else {\n      this.backgroundCol = `${this.backgroundCol}`\n    }\n    if (this.col.startsWith('#')) {\n      this.col = `[HTML]{${this.col.substring(1)}}`\n    } else {\n      this.col =\n        this.col.startsWith('{') && this.col.endsWith('}')\n          ? this.col\n          : `{${this.col}}`\n    }\n    return this.backgroundCol !== '' && this.backgroundCol !== 'none'\n      ? `\\\\draw (${this.x},${this.y}) node[anchor = center, rotate=${this.orientation}] {\\\\colorbox{${this.backgroundCol}} {\\\\${this.letterSize}  \\\\color${this.col}{$${this.latex}$}}};`\n      : `\\\\draw (${this.x},${this.y}) node[anchor = center, rotate=${this.orientation}] {\\\\${this.letterSize} \\\\color${this.col}{$${this.latex}$}};`\n  }\n}\n\n/**\n * cre un obiet mathalea2D qui affiche du latex et qui peut tourner contrairement  latexParCoordonnees qui est horizontal\n * Les paramtres obligatoires (ne pas mettre de $ $ dans le latex !\n * @param latex\n * @param x\n * @param y\n * @param options\n * @param options.color la couleur du texte\n * @param options.backgroundColor la couleur de fond\n * @param options.letterSize la taille des caractres en texte latex sans l'antislash\n * @param options.orientation l'angle de rotation en degrs\n * @param options.opacity l'opacit du texte // @fixme non encore implment\n *\n */\nexport function latex2d(\n  latex: string,\n  x: number,\n  y: number,\n  {\n    color,\n    backgroundColor,\n    letterSize,\n    orientation,\n    opacity,\n  }: {\n    color?: string\n    backgroundColor?: string\n    letterSize?: LetterSizeType\n    orientation?: number\n    opacity?: number\n  },\n) {\n  color = color ?? 'black'\n  backgroundColor =\n    backgroundColor == null ||\n    backgroundColor === '' ||\n    backgroundColor === 'none'\n      ? ''\n      : backgroundColor\n  letterSize = letterSize ?? 'normalsize'\n  orientation = orientation ?? 0\n  opacity = opacity ?? 1\n  return new Latex2d(latex, x, y, {\n    color,\n    backgroundColor,\n    letterSize,\n    orientation,\n    opacity,\n  })\n}\n\nexport function tailleDeNbVersLatex(taille: number): LetterSizeType {\n  if (taille > 1.9) {\n    return 'huge'\n  } else if (taille > 1.6) {\n    return 'LARGE'\n  } else if (taille > 1.3) {\n    return 'Large'\n  } else if (taille > 1.1) {\n    return 'large'\n  } else if (taille < 0.6) {\n    return 'tiny'\n  } else if (taille < 0.8) {\n    return 'scriptsize'\n  } else if (taille < 0.9) {\n    return 'footnotesize'\n  } else if (taille < 1) {\n    return 'small'\n  } else {\n    return 'normalsize'\n  }\n}\n","import {\n  colorToLatexOrHTML,\n  fixeBordures,\n  ObjetMathalea2D,\n} from '../../modules/2dGeneralites'\nimport { egal } from '../../modules/outils'\nimport { degToRad } from '../mathFonctions/trigo'\nimport { arc } from './cercle'\nimport { Droite, droite, Mediatrice } from './droites'\nimport { Point, point } from './points'\nimport { Polygone, polygone } from './polygones'\nimport { Segment, segment, Vecteur, vecteur } from './segmentsVecteurs'\nimport { pointAbstrait, PointAbstrait } from './points-abstraits'\n\n/**\n * M = translation(O,v) //M est l'image de O dans la translation de vecteur v\n * M = translation(O,v,'M') //M est l'image de O dans la translation de vecteur v et se nomme M\n * M = translation(O,v,'M','below') //M est l'image de O dans la translation de vecteur v, se nomme M et le nom est en dessous du point\n * @param {ObjecMathalea2d} O objet  translater (Point, Droite, Segment, Polygone ou Vecteur)\n * @param {Vecteur} v vecteur de translation\n * @param {string} nom nom du translat pour un Point\n * @param {string} positionLabel Position du label pour un Point\n * @param {string} [color='black'] Code couleur HTML accepte\n * @author Rmi Angot\n */\nexport function translation<\n  T extends PointAbstrait | Point | Droite | Segment | Polygone | Vecteur,\n>(O: T, v: Vecteur, nom = '', positionLabel = 'above', color = 'black'): T {\n  if (O instanceof PointAbstrait) {\n    const x = O.x + v.x\n    const y = O.y + v.y\n    if (O instanceof Point) {\n      return point(x, y, nom, positionLabel) as T\n    } else {\n      return pointAbstrait(x, y, nom, positionLabel) as T\n    }\n  }\n  if (O instanceof Polygone) {\n    const p2 = []\n    for (let i = 0; i < O.listePoints.length; i++) {\n      p2[i] = translation(O.listePoints[i], v)\n      p2[i].nom = O.listePoints[i].nom + \"'\"\n    }\n    return polygone(p2, color) as T\n  }\n  if (O instanceof Droite) {\n    const M = translation(point(O.x1, O.y1), v)\n    const N = translation(point(O.x2, O.y2), v)\n    return droite(M, N, color) as T\n  }\n  if (O instanceof Segment) {\n    const M = translation(O.extremite1, v)\n    const N = translation(O.extremite2, v)\n    const s = segment(M, N, color)\n    s.styleExtremites = O.styleExtremites\n    return s as T\n  }\n  return O\n}\n\n/**\n * M = translation2Points(O,A,B) //M est l'image de O dans la translation qui transforme A en B\n * M = translation2Points(O,A,B,'M') //M est l'image de O dans la translation qui transforme A en B et se nomme M\n * M = translation2Points(O,A,B,'M','below') //M est l'image de O dans la translation qui transforme A en B, se nomme M et le nom est en dessous du point\n *\n * @author Rmi Angot\n */\n\nexport function translation2Points<\n  T extends PointAbstrait | Point | Droite | Segment | Polygone | Vecteur,\n>(\n  O: T,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  nom = '',\n  positionLabel = 'above',\n  color = 'black',\n): T {\n  if (O instanceof PointAbstrait) {\n    const x = O.x + B.x - A.x\n    const y = O.y + B.y - A.y\n    if (O instanceof Point) {\n      return point(x, y, nom, positionLabel) as T\n    } else {\n      return pointAbstrait(x, y, nom, positionLabel) as T\n    }\n  }\n  if (O instanceof Polygone) {\n    const p2 = []\n    for (let i = 0; i < O.listePoints.length; i++) {\n      p2[i] = translation2Points(O.listePoints[i], A, B)\n      p2[i].nom = O.listePoints[i].nom + \"'\"\n    }\n    return polygone(p2, color) as T\n  }\n  if (O instanceof Droite) {\n    const M = translation2Points(point(O.x1, O.y1), A, B)\n    const N = translation2Points(point(O.x2, O.y2), A, B)\n    return droite(M, N, color) as T\n  }\n  if (O instanceof Segment) {\n    const M = translation2Points(O.extremite1, A, B)\n    const N = translation2Points(O.extremite2, A, B)\n    const s = segment(M, N, color)\n    s.styleExtremites = O.styleExtremites\n    return s as T\n  }\n  return A as T\n}\n\n/**\n * @param {PointAbstrait|Point|Polygone|Droite|Vecteur|Segment} A Point, Polygone, Droite, Segment ou Vecteur\n * @param {PointAbstrait} O Centre de rotation\n * @param {number} angle Angle de rotation\n * @param {string} [nom=''] Nom de l'image\n * @param {string} [positionLabel='above']\n * @param {string} [color='black'] Code couleur HTML accepte\n * @return L'image de A par la rotation de centre O et d'angle angle\n * @author Rmi Angot et Jean-Claude Lhote\n */\nexport function rotation<\n  T extends PointAbstrait | Point | Droite | Segment | Polygone | Vecteur,\n>(\n  A: T,\n  O: PointAbstrait,\n  angle: number,\n  nom = '',\n  positionLabel = 'above',\n  color = 'black',\n): T {\n  if (A instanceof PointAbstrait) {\n    const x =\n      O.x +\n      (A.x - O.x) * Math.cos((angle * Math.PI) / 180) -\n      (A.y - O.y) * Math.sin((angle * Math.PI) / 180)\n    const y =\n      O.y +\n      (A.x - O.x) * Math.sin((angle * Math.PI) / 180) +\n      (A.y - O.y) * Math.cos((angle * Math.PI) / 180)\n    if (A instanceof Point) {\n      return point(x, y, nom, positionLabel) as T\n    } else {\n      return pointAbstrait(x, y, nom, positionLabel) as T\n    }\n  }\n  if (A instanceof Polygone) {\n    const p2 = []\n    for (let i = 0; i < A.listePoints.length; i++) {\n      p2[i] = rotation(A.listePoints[i], O, angle)\n      p2[i].nom = A.listePoints[i].nom + \"'\"\n    }\n    return polygone(p2, color) as T\n  }\n  if (A instanceof Droite) {\n    const M = rotation(point(A.x1, A.y1), O, angle)\n    const N = rotation(point(A.x2, A.y2), O, angle)\n    return droite(M, N, '', color) as T\n  }\n  if (A instanceof Segment) {\n    const M = rotation(A.extremite1, O, angle)\n    const N = rotation(A.extremite2, O, angle)\n    const s = segment(M, N, color)\n    s.styleExtremites = A.styleExtremites\n    return s as T\n  }\n  const x =\n    A.x * Math.cos((angle * Math.PI) / 180) -\n    A.y * Math.sin((angle * Math.PI) / 180)\n  const y =\n    A.x * Math.sin((angle * Math.PI) / 180) +\n    A.y * Math.cos((angle * Math.PI) / 180)\n  const v = vecteur(x, y)\n  return v as T\n}\n\n/**\n * @author Jean-Claude Lhote\n * A1 Le point de dpart de la flche\n * centre Le centre de la rotation\n * sens Le sens (+1 ou -1) de la rotation. +1=sens trig\n */\nexport class SensDeRotation extends ObjetMathalea2D {\n  constructor(\n    A1: PointAbstrait,\n    centre: PointAbstrait,\n    sens: 1 | -1,\n    color = 'black',\n  ) {\n    super()\n    this.objets = []\n    const arc1 = arc(A1, centre, 20 * sens)\n    arc1.color = colorToLatexOrHTML(color)\n    const A2 = rotation(A1, centre, 20 * sens)\n    const F1 = similitude(A2, centre, -5 * sens, 0.95)\n    const F2 = similitude(A2, centre, -5 * sens, 1.05)\n    const s1 = segment(A2, F1, color)\n    const s2 = segment(A2, F2, color)\n    this.objets.push(arc1, s1, s2)\n    const bordures = fixeBordures(this.objets, {\n      rxmin: 0,\n      rxmax: 0,\n      rymin: 0,\n      rymax: 0,\n    })\n    this.bordures = [bordures.xmin, bordures.ymin, bordures.xmax, bordures.ymax]\n  }\n\n  svg(coeff: number) {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.svg(coeff)\n    }\n    return code\n  }\n\n  tikz() {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.tikz()\n    }\n    return code\n  }\n}\n\nexport function sensDeRotation(\n  A: Point,\n  O: Point,\n  sens: 1 | -1,\n  color = 'black',\n) {\n  return new SensDeRotation(A, O, sens, color)\n}\n\n/** Construit l'image d'un objet par homothtie\n * @param {Point|Segment|Droite|Polygone|Vecteur} Objet Objet MathAlea2d choisi parmi un point, un segment, une droite, un polygone ou un vecteur\n * @param {Point} O Centre de l'homothtie\n * @param {number} k Rapport de l'homothtie\n * @param {string} [nom = ''] Nom du point-image\n * @param {string} [positionLabel = 'above'] Position du point-image. Les possibilits sont : 'left', 'right', 'below', 'above', 'above right', 'above left', 'below right', 'below left'. Si on se trompe dans l'orthographe, ce sera 'above left' et si on ne prcise rien, pour un point ce sera 'above'.\n * @param {string} [color='black']  Couleur de l'image : du type 'blue' ou du type '#f15929' (non valable pour un point et pour un vecteur)\n * @example p2 = homothetie(p1 ,I ,2)\n * // p2 est l'image de p1 par une homothtie de centre I et de rapport 2\n * @example N = homothetie(M, I, 0.5, 'point N', 'right')\n * // N est l'image de M par une homothtie de centre I et de rapport 0.5.  Le point sera affich comme \"point N\" et ce nom sera crit  droite de sa position.\n * @example s = homothetie(segment(A, B), I, -0.5, '', '','blue')\n * // s est l'image du segment [AB] par une homothtie de centre I et de rapport -0.5.  s sera en bleu.\n * @author Rmi Angot\n * @return {Point|Segment|Droite|Polygone|Vecteur}\n */\nexport function homothetie<\n  T extends PointAbstrait | Point | Droite | Segment | Polygone | Vecteur,\n>(\n  Objet: T,\n  O: PointAbstrait,\n  k: number,\n  nom = '',\n  positionLabel = 'above',\n  color = 'black',\n): T {\n  if (Objet instanceof PointAbstrait) {\n    const x = O.x + k * (Objet.x - O.x)\n    const y = O.y + k * (Objet.y - O.y)\n    if (Objet instanceof Point) {\n      return point(x, y, nom, positionLabel) as T\n    } else {\n      return pointAbstrait(x, y, nom, positionLabel) as T\n    }\n  }\n  if (Objet instanceof Polygone) {\n    const p2 = []\n    for (let i = 0; i < Objet.listePoints.length; i++) {\n      p2[i] = homothetie(Objet.listePoints[i], O, k)\n      p2[i].nom = Objet.listePoints[i].nom + \"'\"\n    }\n    return polygone(p2, color) as T\n  }\n  if (Objet instanceof Droite) {\n    const M = homothetie(point(Objet.x1, Objet.y1), O, k)\n    const N = homothetie(point(Objet.x2, Objet.y2), O, k)\n    return droite(M, N, '', color) as T\n  }\n  if (Objet instanceof Segment) {\n    const M = homothetie(Objet.extremite1, O, k)\n    const N = homothetie(Objet.extremite2, O, k)\n    const s = segment(M, N, color)\n    s.styleExtremites = Objet.styleExtremites\n    return s as T\n  }\n  const x = Objet.x\n  const y = Objet.y\n  const v = vecteur(x * k, y * k)\n  return v as T\n}\n\n/**\n * Renvoie le point M symtrique du point A par la droite d.\n * @param {Point|Polygone|Droite|Segment|Vecteur} A Objet de type Point (ses coordonnes x et y renseignes)\n * @param {Droite} d Objet de type Droite (son quation ax+by+c=0 renseigne)\n * @param {string} M Nom de l'image. Facultatif, vide par dfaut.\n * @param {string} positionLabel Facultatif, 'above' par dfaut.\n * @return {Point|Polygone|Droite|Segment|Vecteur} M image de A par la symtrie axiale d'axe d.\n * @param {string} [color='black'] Code couleur HTML accepte\n * @author Jean-Claude Lhote\n */\nexport function symetrieAxiale<\n  T extends PointAbstrait | Point | Droite | Segment | Polygone | Vecteur,\n>(\n  A: T,\n  d: Droite | Mediatrice,\n  nom = '',\n  positionLabel = 'above',\n  color = 'black',\n): T {\n  let x, y\n  const a = d.a\n  const b = d.b\n  const c = d.c\n  const k = 1 / (a * a + b * b)\n  if (A instanceof PointAbstrait) {\n    if (a === 0) {\n      x = A.x\n      y = -(A.y + (2 * c) / b)\n    } else if (b === 0) {\n      y = A.y\n      x = -(A.x + (2 * c) / a)\n    } else {\n      x = k * ((b * b - a * a) * A.x - 2 * a * b * A.y - 2 * a * c)\n      y =\n        k *\n          ((a * a - b * b) * A.y - 2 * a * b * A.x + (a * a * c) / b - b * c) -\n        c / b\n    }\n    if (A instanceof Point) {\n      return point(x, y, nom, positionLabel) as T\n    } else {\n      return pointAbstrait(x, y, nom, positionLabel) as T\n    }\n  }\n  if (A instanceof Polygone) {\n    const p2 = []\n    for (let i = 0; i < A.listePoints.length; i++) {\n      p2[i] = symetrieAxiale(A.listePoints[i], d)\n      p2[i].nom = A.listePoints[i].nom + \"'\"\n    }\n    return polygone(p2, color) as T\n  }\n  if (A instanceof Droite) {\n    const M = symetrieAxiale(point(A.x1, A.y1), d)\n    const N = symetrieAxiale(point(A.x2, A.y2), d)\n    return droite(M, N, color) as T\n  }\n  if (A instanceof Segment) {\n    const M = symetrieAxiale(A.extremite1, d)\n    const N = symetrieAxiale(A.extremite2, d)\n    const s = segment(M, N, color)\n    s.styleExtremites = A.styleExtremites\n    return s as T\n  }\n  let O\n  if (egal(b, 0)) {\n    O = point(-c / a, 0)\n  } else O = point(0, -c / b)\n  const M = translation(O, A)\n  const N = symetrieAxiale(M, d)\n  const v = vecteur(O, N)\n  return v as T\n}\n\n/**\n * N = projectionOrtho(M,d,'N','below left')\n *@author Jean-Claude Lhote\n */\nexport function projectionOrtho<T extends PointAbstrait | Point | Vecteur>(\n  M: T,\n  d: Droite,\n  nom = '',\n  positionLabel = 'above',\n): T {\n  const a = d.a\n  const b = d.b\n  const c = d.c\n  const k = 1 / (a * a + b * b)\n  let x, y\n  if (M instanceof PointAbstrait) {\n    if (a === 0) {\n      x = M.x\n      y = -c / b\n    } else if (b === 0) {\n      y = M.y\n      x = -c / a\n    } else {\n      x = k * (b * b * M.x - a * b * M.y - a * c)\n      y = k * (-a * b * M.x + a * a * M.y + (a * a * c) / b) - c / b\n    }\n    if (M instanceof Point) {\n      return point(x, y, nom, positionLabel) as T\n    } else {\n      return pointAbstrait(x, y, nom, positionLabel) as T\n    }\n  }\n  let O\n  if (egal(b, 0)) O = point(-c / a, 0)\n  else O = point(0, -c / b)\n  const A = translation(O, M)\n  const N = projectionOrtho(A, d)\n  const v = vecteur(O, N)\n  return v as T\n}\n\n/**\n * Construit l'image d'un objet par affinit orthogonale\n * @param {PointAbstrait|Point|Segment|Droite|Polygone|Vecteur} Objet Objet MathAlea2d choisi parmi un point, un segment, une droite, un polygone ou un vecteur\n * @param {Droite} d Direction de l'affinit\n * @param {number} k Rapport de l'affinit\n * @param {string} [nom=''] Nom de l'image (uniquement valable pour un point)\n * @param {string} [positionLabel = 'above'] Position de l'image (uniquement valable pour un point)\n * @param {string} [color='black']  Couleur de la valeur indique : du type 'blue' ou du type '#f15929' (non valable pour un point et pour un vecteur)\n * @author Jean-Claude Lhote\n * @example p2 = affiniteOrtho(p1,droite(B, C),k)\n * // p2 est l'image de p1 par une affinit orthogonale dont la direction est la droite (BC) et de rapport k\n * @example N = affiniteOrtho(M,d,0.5,'point N','right')\n * // N est l'image du point M par une affinit orthogonale de direction d et de rapport 0.5. Le point sera affich comme \"point N\" et ce nom sera crit  droite de sa position.\n * @example s = affiniteOrtho(segment(A, B),d,0.1,'','','red')\n * // s est l'image du segment [AB] par une affinit orthogonale de direction d et de rapport 0.1. s sera rouge.\n * @return {PointAbstrait|Point|Segment|Droite|Polygone|Vecteur} Retourne un objet du mme type que le paramtre objet de la fonction\n */\n// JSDOC Validee par EE Juin 2022\nexport function affiniteOrtho<\n  T extends PointAbstrait | Point | Droite | Segment | Polygone | Vecteur,\n>(\n  A: T,\n  d: Droite,\n  k: number,\n  nom = '',\n  positionLabel = 'above',\n  color = 'black',\n): T {\n  const a = d.a\n  const b = d.b\n  const c = d.c\n  const q = 1 / (a * a + b * b)\n  let x, y\n  if (A instanceof PointAbstrait) {\n    if (a === 0) {\n      x = A.x\n      y = k * A.y + (c * (k - 1)) / b\n    } else if (b === 0) {\n      y = A.y\n      x = k * A.x + (c * (k - 1)) / a\n    } else {\n      x = q * (b * b * A.x - a * b * A.y - a * c) * (1 - k) + k * A.x\n      y =\n        q * (a * a * A.y - a * b * A.x + (a * a * c) / b) * (1 - k) +\n        (k * c) / b +\n        k * A.y -\n        c / b\n    }\n    if (A instanceof Point) {\n      return point(x, y, nom, positionLabel) as T\n    } else {\n      return pointAbstrait(x, y, nom, positionLabel) as T\n    }\n  }\n  if (A instanceof Polygone) {\n    const p2 = []\n    for (let i = 0; i < A.listePoints.length; i++) {\n      p2[i] = affiniteOrtho(A.listePoints[i], d, k)\n      p2[i].nom = A.listePoints[i].nom + \"'\"\n    }\n    return new Polygone(p2, color) as T\n  }\n  if (A instanceof Droite) {\n    const M = affiniteOrtho(point(A.x1, A.y1), d, k)\n    const N = affiniteOrtho(point(A.x2, A.y2), d, k)\n    return new Droite(M, N, color) as T\n  }\n  if (A instanceof Segment) {\n    const M = affiniteOrtho(A.extremite1, d, k)\n    const N = affiniteOrtho(A.extremite2, d, k)\n    return new Segment(M, N, color, A.styleExtremites) as T\n  }\n  let O\n  if (egal(b, 0)) {\n    O = point(-c / a, 0)\n  } else O = point(0, -c / b)\n  const M = translation(O, A)\n  const N = affiniteOrtho(M, d, k)\n  return new Vecteur(O, N) as T\n}\n\n/**\n *\n * @param {PointAbstrait|Point|Polygone|Droite|Vecteur|Segment} A // Le point dont on veut l'image\n * @param {PointAbstrait} O // Le centre de la similitude\n * @param {number} a // L'angle de la rotation\n * @param {number} k // le rapport de l'homothtie\n * @param {string} nom\n * @param {string} positionLabel\n * M = similitude(B,O,30,1.1,'M') // Le point M est l'image de B dans la similitude de centre O d'angle 30 et de rapport 1.1\n * @author Jean-Claude Lhote\n */\nexport function similitude<\n  T extends PointAbstrait | Point | Droite | Segment | Polygone | Vecteur,\n>(\n  A: T,\n  O: PointAbstrait,\n  a: number,\n  k: number,\n  nom = '',\n  positionLabel = 'above',\n  color = 'black',\n): T {\n  if (A instanceof PointAbstrait) {\n    const ra = degToRad(a)\n    const x =\n      O.x + k * (Math.cos(ra) * (A.x - O.x) - Math.sin(ra) * (A.y - O.y))\n    const y =\n      O.y + k * (Math.cos(ra) * (A.y - O.y) + Math.sin(ra) * (A.x - O.x))\n    if (A instanceof Point) {\n      return point(x, y, nom, positionLabel) as T\n    } else {\n      return pointAbstrait(x, y, nom, positionLabel) as T\n    }\n  }\n  if (A instanceof Polygone) {\n    const p2 = []\n    for (let i = 0; i < A.listePoints.length; i++) {\n      p2[i] = similitude(A.listePoints[i], O, a, k)\n      p2[i].nom = A.listePoints[i].nom + \"'\"\n    }\n    return polygone(p2, color) as T\n  }\n  if (A instanceof Droite) {\n    const M = similitude(point(A.x1, A.y1), O, a, k)\n    const N = similitude(point(A.x2, A.y2), O, a, k)\n    return droite(M, N, color) as T\n  }\n  if (A instanceof Segment) {\n    const M = similitude(A.extremite1, O, a, k)\n    const N = similitude(A.extremite2, O, a, k)\n    const s = segment(M, N, color)\n    s.styleExtremites = A.styleExtremites\n    return s as T\n  }\n  /* if (A.constructor==DemiDroite) {\n      let M = similitude(A.extremite1,O,a,k)\n      let N = similitude(A.extremite2,O,a,k)\n      let s = demiDroite(M,N)\n      s.styleExtremites = A.styleExtremites\n      return s\n    } */\n  const V = rotation(A, O, a)\n  const v = homothetie(V, O, k)\n  return v as T\n}\n","import {\n  colorToLatexOrHTML,\n  fixeBordures,\n  ObjetMathalea2D,\n} from '../../modules/2dGeneralites'\nimport { context } from '../../modules/context'\nimport FractionEtendue from '../../modules/FractionEtendue'\nimport { Point3d } from '../3d/3dProjectionMathalea2d/elements'\nimport { arrondi } from '../outils/nombres'\nimport { angleOriente } from './angles'\nimport { Cercle } from './cercle'\nimport { Droite, droite } from './droites'\nimport MainLevee from './MainLevee'\nimport {\n  milieu,\n  Point,\n  point,\n  pointIntersectionDD,\n  pointIntersectionLC,\n  pointSurSegment,\n} from './points'\nimport { pointAbstrait, PointAbstrait } from './points-abstraits'\nimport { latex2d, texteParPosition } from './textes'\nimport { rotation, similitude, translation } from './transformations'\n\n/**\n * v = vecteur('V') // son nom\n * v = vecteur(x,y) // ses composantes\n * v = vecteur(A,B) // son origine et son extrmit (deux Points)\n * v = vecteur(x,y,'v') // son nom et ses composantes.\n * v.representant(E,'blue') // Dessine le vecteur v issu de E, en bleu.\n * Commenter toutes les mthodes possibles\n * @author Jean-Claude Lhote et Rmi Angot\n */\nexport class Vecteur {\n  nom: string\n  x: number\n  y: number\n\n  constructor(\n    arg1: FractionEtendue | number | PointAbstrait | string,\n    arg2: FractionEtendue | number | PointAbstrait,\n    nom = '',\n  ) {\n    if (arguments.length === 1) {\n      this.nom = String(arg1)\n      this.x = 0\n      this.y = 0\n    } else {\n      if (typeof arg1 === 'number' || arg1 instanceof FractionEtendue) {\n        this.x =\n          arg1 instanceof FractionEtendue ? arg1.valeurDecimale : Number(arg1)\n        this.y =\n          arg2 instanceof FractionEtendue ? arg2.valeurDecimale : Number(arg2)\n      } else {\n        if (arg1 instanceof PointAbstrait && arg2 instanceof PointAbstrait) {\n          this.x = arg2.x - arg1.x\n          this.y = arg2.y - arg1.y\n        } else {\n          window.notify(\n            'Vecteur : (attendus : A et B) les arguments de sont pas des points valides',\n            {\n              arg1,\n              arg2,\n            },\n          )\n          this.x = 0\n          this.y = 0\n        }\n      }\n      this.nom = nom\n    }\n  }\n\n  norme() {\n    return Math.sqrt(this.x ** 2 + this.y ** 2)\n  }\n\n  oppose() {\n    this.x = -this.x\n    this.y = -this.y\n  }\n\n  xSVG(coeff: number) {\n    return this.x * coeff\n  }\n\n  ySVG(coeff: number) {\n    return -this.y * coeff\n  }\n\n  representant(A: Point, color = 'black') {\n    const B = point(A.x + this.x, A.y + this.y)\n    const s = segment(A, B, color, '->')\n    s.tailleExtremites = 5\n    return s\n  }\n\n  representantNomme(A: Point, nom: string, taille = 1, color = 'black') {\n    let s\n    let v\n    const B = point(A.x + this.x, A.y + this.y)\n    const M = milieu(A, B)\n    s = segment(A, B, color)\n    const angle = s.angleAvecHorizontale\n    v = similitude(this, A, 90, 0.5 / this.norme())\n    if (Math.abs(angle) > 90) {\n      s = segment(B, A, color)\n      // angle = s.angleAvecHorizontale\n      v = similitude(this, A, -90, 0.5 / this.norme())\n    }\n    const N = translation(M, v)\n    return nomVecteurParPosition(nom, N.x, N.y, taille, 0, color)\n  }\n}\n\n/**\n * @example v = vecteur('V') // son nom\n * @example v = vecteur(x,y) // ses composantes\n * @example v = vecteur(A,B) // son origine et son extrmit (deux Points)\n * @example v = vecteur(x,y,'v') // son nom et ses composantes.\n * @author Jean-Claude Lhote et Rmi Angot\n */\nexport function vecteur(\n  arg1: FractionEtendue | number | PointAbstrait | string,\n  arg2: FractionEtendue | number | PointAbstrait,\n  nom = '',\n) {\n  return new Vecteur(arg1, arg2, nom)\n}\n\n/**\n * @author Jean-Claude Lhote le 31/01/2021\n * cre un nom de vecteur avec sa petite flche\n * l'angle form par avec l'horizontale est  donner comme argument, par dfaut c'est 0\n * la taille impactera le nom et la flche en proportion.\n * (x,y) sont les coordonnes du centre du nom.\n */\nexport class NomVecteurParPosition extends ObjetMathalea2D {\n  nom: string\n  x: number\n  y: number\n  angle: number\n  taille: number\n  constructor(\n    nom: string,\n    x: number,\n    y: number,\n    taille = 1,\n    angle = 0,\n    color = 'black',\n  ) {\n    super()\n    this.nom = nom\n    this.x = x\n    this.y = y\n    this.color = colorToLatexOrHTML(color)\n    this.angle = angle\n    this.taille = taille\n    // @todo crer deux objets : vecteurI et vecteurJ pour a.\n    // if (this.nom === 'i') return latex2d('\\\\vec \\\\imath', this.x, this.y, { color })\n    // if (this.nom === 'j') return latex2d('\\\\vec \\\\jmath', this.x, this.y, { color })\n\n    const t = texteParPosition(\n      this.nom,\n      this.x,\n      this.y,\n      -this.angle,\n      color,\n      this.taille,\n      'milieu',\n      true,\n    )\n    const M = point(this.x, this.y)\n    const P = point(M.x + 0.25 * this.nom.length, M.y)\n    const M0 = similitude(P, M, 90 + this.angle, 1.5)\n    const M1 = rotation(translation(M0, vecteur(P, M)), M0, this.angle)\n    const M2 = similitude(M1, M0, 180, 1.5)\n    const s = segment(M1, M2, color)\n    s.styleExtremites = '->'\n    s.tailleExtremites = 3\n    this.objets = [t, s]\n    const bordures = fixeBordures(this.objets, {\n      rxmin: 0,\n      rxmax: 0,\n      rymin: 0,\n      rymax: 0,\n    })\n    this.bordures = [bordures.xmin, bordures.ymin, bordures.xmax, bordures.ymax]\n  }\n\n  svg(coeff: number) {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.svg(coeff)\n    }\n    return code\n  }\n\n  tikz() {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.tikz()\n    }\n    return code\n  }\n}\n\nexport function nomVecteurParPosition(\n  nom: string,\n  x: number,\n  y: number,\n  taille = 1,\n  angle = 0,\n  color = 'black',\n) {\n  // Katex ne reconnais pas \\\\vec qui est une commande dfinie ailleurs.\n  if (nom === 'i') return latex2d('\\\\vec{\\\\imath}', x, y, { color })\n  if (nom === 'j') return latex2d('\\\\vec{\\\\jmath}', x, y, { color })\n  return new NomVecteurParPosition(nom, x, y, taille, angle, color)\n}\n\n/**\n * s = segment(A, B) //Segment d'extrmits A et B\n * s = segment(A,B,'blue') //Segment d'extrmits A et B et de couleur bleue\n * s = segment(x1,y1,x2,y2) //Segment dfini par les coordonnes des deux extrmits\n * s = segment(x1,y1,x2,y2,'blue') //Segment dfini par les coordonnes des deux extrmits et de couleur bleue\n * @class\n * @author Rmi Angot\n */\nexport class Segment extends ObjetMathalea2D {\n  tailleExtremites: number\n  styleExtremites: string\n  angleAvecHorizontale: number\n  x1: number\n  y1: number\n  x2: number\n  y2: number\n  extremite1: PointAbstrait\n  extremite2: PointAbstrait\n  longueur: number\n  constructor(\n    ...args:\n      | [PointAbstrait | Point3d, PointAbstrait | Point3d, string?, string?]\n      | [number, number, number, number, string?, string?]\n  ) {\n    super()\n    this.bordures = [0, 0, 0, 0]\n    this.typeObjet = 'segment'\n    if (typeof args[0] === 'number') {\n      this.styleExtremites = args[5] || ''\n    } else {\n      this.styleExtremites = String(args[3]) || ''\n    }\n    this.tailleExtremites = 4\n    if (args[0] instanceof PointAbstrait || args[0] instanceof Point3d) {\n      if (args[1] instanceof PointAbstrait || args[1] instanceof Point3d) {\n        this.x1 = args[0].x\n        this.y1 = args[0].y\n        this.x2 = args[1].x\n        this.y2 = args[1].y\n      } else {\n        window.notify(\n          `Segment : (attendus : A et B${arguments.length === 3 ? ' et \"couleur\"' : ''}) les arguments de sont pas des points valides`,\n          { ...args },\n        )\n        this.x1 = 0\n        this.y1 = 0\n        this.x2 = 0\n        this.y2 = 0\n      }\n      this.color = colorToLatexOrHTML(args[2]?.toString() || 'black')\n      this.styleExtremites = args[3]?.toString() || ''\n    } else {\n      if (\n        Number.isNaN(args[0]) ||\n        Number.isNaN(args[1]) ||\n        Number.isNaN(args[2]) ||\n        Number.isNaN(args[3])\n      ) {\n        window.notify(\n          'Segment : (attendus : x1, y1, x2, y2 et \"couleur\") les arguments de sont pas des nombres valides',\n          { ...args },\n        )\n      }\n      this.x1 = Number(args[0])\n      this.y1 = Number(args[1])\n      this.x2 = Number(args[2])\n      this.y2 = Number(args[3])\n      this.color = colorToLatexOrHTML(args[4] || 'black')\n      this.styleExtremites = args[5] || ''\n    }\n\n    this.x1 = arrondi(this.x1, 2)\n    this.y1 = arrondi(this.y1, 2)\n    this.x2 = arrondi(this.x2, 2)\n    this.y2 = arrondi(this.y2, 2)\n\n    this.epaisseur = 1\n    this.opacite = 1\n    this.pointilles = 0\n\n    this.bordures = [\n      Number(Math.min(this.x1, this.x2)),\n      Number(Math.min(this.y1, this.y2)),\n      Number(Math.max(this.x1, this.x2)),\n      Number(Math.max(this.y1, this.y2)),\n    ]\n    this.extremite1 = point(this.x1, this.y1)\n    this.extremite2 = point(this.x2, this.y2)\n    this.longueur = Math.sqrt(\n      (this.x2 - this.x1) ** 2 + (this.y2 - this.y1) ** 2,\n    )\n    // utiliser les fonctions de calcul d'angle avec un segment de longueur nulle est une erreur ! Je blinde en retournant un angle nul\n    this.angleAvecHorizontale =\n      this.longueur < 1e-8\n        ? 0\n        : angleOriente(\n            point(this.x1 + 1, this.y1),\n            this.extremite1,\n            this.extremite2,\n            5,\n          )\n  }\n\n  svg(coeff: number) {\n    if (this.epaisseur !== 1) {\n      this.style += ` stroke-width=\"${this.epaisseur}\" `\n    }\n    switch (this.pointilles) {\n      case 1:\n        this.style += ' stroke-dasharray=\"6 10\" '\n        break\n      case 2:\n        this.style += ' stroke-dasharray=\"6 3\" '\n        break\n      case 3:\n        this.style += ' stroke-dasharray=\"3 2 6 2 \" '\n        break\n      case 4:\n        this.style += ' stroke-dasharray=\"1 2\" '\n        break\n      case 5:\n        this.style += ' stroke-dasharray=\"5 5\" '\n        break\n    }\n\n    if (this.opacite !== 1) {\n      this.style += ` stroke-opacity=\"${this.opacite}\" `\n    }\n    let code = this.codeExtremitesSVG(coeff)\n    const A = point(this.x1, this.y1)\n    const B = point(this.x2, this.y2)\n\n    code += `\\n\\t<line x1=\"${A.xSVG(coeff)}\" y1=\"${A.ySVG(coeff)}\" x2=\"${B.xSVG(\n      coeff,\n    )}\" y2=\"${B.ySVG(coeff)}\" stroke=\"${this.color[0]}\" ${this.style} />`\n\n    if (this.styleExtremites.length > 0) {\n      code = `<g id=\"${this.id}\">${code}</g>`\n    } else {\n      code = code.replace('/>', `id=\"${this.id}\" />`)\n    }\n\n    return code\n  }\n\n  tikz() {\n    let optionsDraw = ''\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color =${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width = ${this.epaisseur}`)\n    }\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity = ${this.opacite}`)\n    }\n    switch (this.pointilles) {\n      case 1:\n        tableauOptions.push(' dash dot ')\n        break\n      case 2:\n        tableauOptions.push(' densely dash dot dot ')\n        break\n      case 3:\n        tableauOptions.push(' dash dot dot ')\n        break\n\n      case 4:\n        tableauOptions.push(' dotted ')\n        break\n      case 5:\n        tableauOptions.push(' dashed ')\n        break\n    }\n    let arrowsOption = ''\n    if (this.styleExtremites.length > 0) {\n      // Map des styles\n      const map: { [key: string]: string } = {\n        '|': 'Bar',\n        '>': 'Stealth',\n        '<': 'Stealth',\n      }\n      // Taille des pointes\n      const width = Math.max(2, Math.round(this.tailleExtremites))\n      const length = Math.max(4, Math.round(this.tailleExtremites * 2))\n      let left = '',\n        right = ''\n      if (this.styleExtremites.length === 3) {\n        left = map[this.styleExtremites[0]] || ''\n        right = map[this.styleExtremites[2]] || ''\n      } else if (this.styleExtremites.length === 2) {\n        if (this.styleExtremites[0] in map) left = map[this.styleExtremites[0]]\n        if (this.styleExtremites[1] in map) right = map[this.styleExtremites[1]]\n      } else if (this.styleExtremites.length === 1) {\n        if (this.styleExtremites[0] in map) right = map[this.styleExtremites[0]]\n      }\n      // Ajout des tailles personnalises\n      const leftTip = left ? `{${left}[width=${width}mm]}` : ''\n      const rightTip = right ? `{${right}[width=${width}mm]}` : ''\n      if (leftTip && rightTip) {\n        arrowsOption = `${leftTip}-${rightTip}`\n      } else if (leftTip) {\n        arrowsOption = `${leftTip}-`\n      } else if (rightTip) {\n        arrowsOption = `-${rightTip}`\n      }\n      if (arrowsOption) {\n        tableauOptions.push(arrowsOption)\n      }\n    }\n    if (tableauOptions.length > 0) {\n      optionsDraw = '[' + tableauOptions.join(',') + ']'\n    }\n    return `\\\\draw${optionsDraw} (${this.x1},${this.y1})--(${this.x2},${this.y2});`\n  }\n\n  svgml(coeff: number, amplitude: number) {\n    const mainLevee = MainLevee.create() // mainLevee permet d'accder aux mthodes pour crer les objets roughjs\n    if (mainLevee != null) {\n      const A = point(this.x1, this.y1)\n      const B = point(this.x2, this.y2)\n      let code = this.codeExtremitesSVG(coeff)\n      code += mainLevee.line(\n        A.xSVG(coeff),\n        A.ySVG(coeff),\n        B.xSVG(coeff),\n        B.ySVG(coeff),\n        {\n          color: this.color[0],\n          epaisseur: this.epaisseur,\n          roughness: amplitude * 2,\n        },\n      )\n      if (this.styleExtremites.length > 0) {\n        code = `<g id=\"${this.id}\">${code}</g>`\n      } else {\n        code = code.replace('/>', `id=\"${this.id}\" />`)\n      }\n      mainLevee.destroy() // ne pas oublier de faire a, sinon, il va trainer un svg qui ne sert  rien dans le DOM\n      return code\n    } else return ''\n  }\n\n  tikzml(amp: number) {\n    const A = point(this.x1, this.y1)\n    const B = point(this.x2, this.y2)\n    let optionsDraw = ''\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color =${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width = ${this.epaisseur}`)\n    }\n\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity = ${this.opacite}`)\n    }\n    if (this.styleExtremites.length > 1) {\n      if (\n        this.styleExtremites.includes('[') ||\n        this.styleExtremites.includes(']')\n      ) {\n        tableauOptions.push('{' + this.styleExtremites + '}')\n      } else {\n        tableauOptions.push(this.styleExtremites)\n      }\n    }\n    tableauOptions.push(\n      `decorate,decoration={random steps , amplitude = ${amp}pt}`,\n    )\n    optionsDraw = '[' + tableauOptions.join(',') + ']'\n\n    const code = `\\\\draw${optionsDraw} (${A.x},${A.y})--(${B.x},${B.y});`\n    return code\n  }\n\n  codeExtremitesSVG(coeff: number) {\n    let code = ''\n    const A = point(this.x1, this.y1)\n    const B = point(this.x2, this.y2)\n    const h = this.tailleExtremites\n    if (this.styleExtremites.length > 1) {\n      const fin = this.styleExtremites.slice(-1)\n      if (fin === '|') {\n        // si a termine par | on le rajoute en B\n        const M = pointSurSegment(B, A, h / context.pixelsParCm)\n        const B1 = rotation(M, B, 90)\n        const B2 = rotation(M, B, -90)\n        code += `<line x1=\"${B1.xSVG(coeff)}\" y1=\"${B1.ySVG(\n          coeff,\n        )}\" x2=\"${B2.xSVG(coeff)}\" y2=\"${B2.ySVG(coeff)}\" stroke=\"${\n          this.color[0]\n        }\" stroke-width=\"${this.epaisseur}\" />`\n      }\n      if (fin === '>') {\n        // si a termine par > on rajoute une flche en B\n        const M = pointSurSegment(B, A, h / context.pixelsParCm)\n        const B1 = similitude(B, M, 90, 0.7)\n        const B2 = similitude(B, M, -90, 0.7)\n        code += `<line x1=\"${B.xSVG(coeff)}\" y1=\"${B.ySVG(\n          coeff,\n        )}\" x2=\"${B1.xSVG(coeff)}\" y2=\"${B1.ySVG(coeff)}\" stroke=\"${\n          this.color[0]\n        }\" stroke-width=\"${this.epaisseur}\" />`\n        code += `\\n\\t<line x1=\"${B.xSVG(coeff)}\" y1=\"${B.ySVG(\n          coeff,\n        )}\" x2=\"${B2.xSVG(coeff)}\" y2=\"${B2.ySVG(coeff)}\" stroke=\"${this.color[0]}\" stroke-width=\"${this.epaisseur}\" />`\n      }\n      if (fin === '<') {\n        // si a termine par < on rajoute une flche inverse en B\n        const M = pointSurSegment(B, A, -h / context.pixelsParCm)\n        const B1 = similitude(B, M, 90, 0.7)\n        const B2 = similitude(B, M, -90, 0.7)\n        code += `<line x1=\"${B.xSVG(coeff)}\" y1=\"${B.ySVG(\n          coeff,\n        )}\" x2=\"${B1.xSVG(coeff)}\" y2=\"${B1.ySVG(coeff)}\" stroke=\"${\n          this.color[0]\n        }\" stroke-width=\"${this.epaisseur}\" />`\n        code += `\\n\\t<line x1=\"${B.xSVG(coeff)}\" y1=\"${B.ySVG(\n          coeff,\n        )}\" x2=\"${B2.xSVG(coeff)}\" y2=\"${B2.ySVG(coeff)}\" stroke=\"${this.color[0]}\" stroke-width=\"${this.epaisseur}\" />`\n      }\n      if (fin === '[') {\n        // si a termine par | on le rajoute en B\n        const M = pointSurSegment(B, A, h / context.pixelsParCm)\n        const B1 = similitude(M, B, 90, 1)\n        const B2 = similitude(M, B, -90, 1)\n        const C1 = similitude(B, B1, -90, 0.3)\n        const C2 = similitude(B, B2, 90, 0.3)\n        code += `<polyline points=\"${C2.xSVG(coeff)},${C2.ySVG(coeff)} ${B2.xSVG(coeff)},${B2.ySVG(coeff)} ${B1.xSVG(coeff)},${B1.ySVG(coeff)} ${C1.xSVG(coeff)},${C1.ySVG(coeff)}\" fill=\"none\" stroke=\"${this.color[0]}\" ${this.style} id=\"${this.id}\" stroke-width=\"${this.epaisseur}\" />`\n      }\n      if (fin === ']') {\n        // si a termine par | on le rajoute en B\n        const M = pointSurSegment(B, A, h / context.pixelsParCm)\n        const B1 = similitude(M, B, 90, 1)\n        const B2 = similitude(M, B, -90, 1)\n        const C1 = similitude(B, B1, 90, 0.3)\n        const C2 = similitude(B, B2, -90, 0.3)\n        code += `<polyline points=\"${C2.xSVG(coeff)},${C2.ySVG(coeff)} ${B2.xSVG(coeff)},${B2.ySVG(coeff)} ${B1.xSVG(coeff)},${B1.ySVG(coeff)} ${C1.xSVG(coeff)},${C1.ySVG(coeff)}\" fill=\"none\" stroke=\"${this.color[0]}\" ${this.style} id=\"${this.id}\" stroke-width=\"${this.epaisseur}\" />`\n      }\n      const debut = this.styleExtremites[0]\n      if (debut === '[') {\n        // si a termine par | on le rajoute en B\n        const M = pointSurSegment(A, B, h / context.pixelsParCm)\n        const B1 = similitude(M, A, 90, 1)\n        const B2 = similitude(M, A, -90, 1)\n        const C1 = similitude(A, B1, 90, 0.3)\n        const C2 = similitude(A, B2, -90, 0.3)\n        code += `<polyline points=\"${C2.xSVG(coeff)},${C2.ySVG(coeff)} ${B2.xSVG(coeff)},${B2.ySVG(coeff)} ${B1.xSVG(coeff)},${B1.ySVG(coeff)} ${C1.xSVG(coeff)},${C1.ySVG(coeff)}\" fill=\"none\" stroke=\"${this.color[0]}\" ${this.style} id=\"${this.id}\" stroke-width=\"${this.epaisseur}\" />`\n      }\n      if (debut === ']') {\n        // si a termine par | on le rajoute en B\n        const M = pointSurSegment(A, B, h / context.pixelsParCm)\n        const B1 = similitude(M, A, 90, 1)\n        const B2 = similitude(M, A, -90, 1)\n        const C1 = similitude(A, B1, -90, 0.3)\n        const C2 = similitude(A, B2, 90, 0.3)\n        code += `<polyline points=\"${C2.xSVG(coeff)},${C2.ySVG(coeff)} ${B2.xSVG(coeff)},${B2.ySVG(coeff)} ${B1.xSVG(coeff)},${B1.ySVG(coeff)} ${C1.xSVG(coeff)},${C1.ySVG(coeff)}\" fill=\"none\" stroke=\"${this.color[0]}\" ${this.style} id=\"${this.id}\" stroke-width=\"${this.epaisseur}\" />`\n      }\n      if (debut === '<') {\n        // si a commence par < on rajoute une flche en A\n        const M = pointSurSegment(A, B, h / context.pixelsParCm)\n        const A1 = similitude(A, M, 90, 0.7)\n        const A2 = similitude(A, M, -90, 0.7)\n        code += `<line x1=\"${A.xSVG(coeff)}\" y1=\"${A.ySVG(\n          coeff,\n        )}\" x2=\"${A1.xSVG(coeff)}\" y2=\"${A1.ySVG(coeff)}\" stroke=\"${\n          this.color[0]\n        }\" stroke-width=\"${this.epaisseur}\" />`\n        code += `\\n\\t<line x1=\"${A.xSVG(coeff)}\" y1=\"${A.ySVG(\n          coeff,\n        )}\" x2=\"${A2.xSVG(coeff)}\" y2=\"${A2.ySVG(coeff)}\" stroke=\"${\n          this.color[0]\n        }\" stroke-width=\"${this.epaisseur}\" />`\n      }\n      if (debut === '>') {\n        // si a commence par > on rajoute une flche inverse en A\n        const M = pointSurSegment(A, B, -h / context.pixelsParCm)\n        const A1 = similitude(A, M, 90, 0.7)\n        const A2 = similitude(A, M, -90, 0.7)\n        code += `<line x1=\"${A.xSVG(coeff)}\" y1=\"${A.ySVG(\n          coeff,\n        )}\" x2=\"${A1.xSVG(coeff)}\" y2=\"${A1.ySVG(coeff)}\" stroke=\"${\n          this.color[0]\n        }\" stroke-width=\"${this.epaisseur}\" />`\n        code += `\\n\\t<line x1=\"${A.xSVG(coeff)}\" y1=\"${A.ySVG(\n          coeff,\n        )}\" x2=\"${A2.xSVG(coeff)}\" y2=\"${A2.ySVG(coeff)}\" stroke=\"${\n          this.color[0]\n        }\" stroke-width=\"${this.epaisseur}\" />`\n      }\n      if (debut === '|') {\n        // si a commence par | on le rajoute en A\n        const N = pointSurSegment(A, B, h / context.pixelsParCm)\n        const A1 = rotation(N, A, 90)\n        const A2 = rotation(N, A, -90)\n        code += `<line x1=\"${A1.xSVG(coeff)}\" y1=\"${A1.ySVG(\n          coeff,\n        )}\" x2=\"${A2.xSVG(coeff)}\" y2=\"${A2.ySVG(coeff)}\" stroke=\"${\n          this.color[0]\n        }\" stroke-width=\"${this.epaisseur}\" />`\n      }\n    }\n    return code\n  }\n\n  /**\n   * Teste si un segment coupe un cercle, une droite, une demi-cercle ou un autre segment\n   * @memberof Segment\n   * @param {Segment | Droite | DemiDroite | Cercle} objet Objet gomtrique dont on veut tester l'intersection avec le segment\n   * @example s1.estSecant(d1) // Renvoie true si s1 est scant avec d1, false sinon\n   * @author Jean-Claude Lhote\n   * @return {boolean}\n   */\n  // JSDOC Validee par EE Aout 2022\n  estSecant(objet: any) {\n    // Si le segment est de longueur nulle, on ne peut dfinir sa direction et a pose problme pour les calculs d'intersection\n    // On regarde si la premire extmit (qui est aussi la deuxime est sur l'objet)\n    if (\n      Math.abs(this.x1 - this.x2) < 0.01 &&\n      Math.abs(this.y1 - this.y2) < 0.01\n    ) {\n      const P1 = point(this.x1, this.y1)\n      return P1.estSur(objet)\n    }\n\n    const ab = droite(this.extremite1, this.extremite2)\n    if (objet instanceof Cercle) {\n      const P1 = pointIntersectionLC(ab, objet, '', 1)\n      const P2 = pointIntersectionLC(ab, objet, '', 2)\n      return (\n        (P1 instanceof Point && P1.estSur(this)) ||\n        (P2 instanceof Point && P2.estSur(this))\n      )\n    }\n    let I: Point | boolean\n    if (objet instanceof Droite) {\n      I = pointIntersectionDD(ab, objet)\n    } else {\n      const cd = droite(objet.extremite1, objet.extremite2)\n      I = pointIntersectionDD(ab, cd)\n      if (typeof I === 'boolean') {\n        I =\n          objet.extremite1.estSur(this) ||\n          objet.extremite2.estSur(this) ||\n          this.extremite1.estSur(segment(objet.extremite1, objet.extremite2)) ||\n          this.extremite2.estSur(segment(objet.extremite1, objet.extremite2))\n      }\n    }\n    if (typeof I === 'boolean') return I\n    return I.estSur(objet) && I.estSur(this)\n  }\n}\n/**\n * @param {...any} args Points ou coordonnes + couleur facultative en dernier\n * @example segment(A,B,'blue') // Segment [AB] de couleur bleu\n * @example segment(x1,y1,x2,y2,'#f15929') // Segment dont les extrmits sont respectivement (x1,y1) et (x2,y2), de couleur orange (#f15929)\n * @author Rmi Angot\n */\n\nexport function segment(\n  ...args:\n    | [PointAbstrait | Point3d, PointAbstrait | Point3d, string?, string?]\n    | [number, number, number, number, string?, string?]\n) {\n  return new Segment(...args)\n}\n\n/**\n * @param {...args} args Points ou coordonnes\n * @param {string} color Facultatif\n * @example segmentAvecExtremites(A,B,'blue')\n * @example segmentAvecExtremites(x1,y1,x2,y2,'#f15929')\n * @author Rmi Angot\n */\nexport function segmentAvecExtremites(\n  ...args:\n    | [PointAbstrait | Point3d, PointAbstrait | Point3d, string?, string?]\n    | [number, number, number, number, string?, string?]\n) {\n  const s = segment(...args)\n  s.styleExtremites = '|-|'\n  return s\n}\n\n/**  Trace la demi-droite d'origine A passant par B\n * @param {PointAbstrait} A Origine de la droite\n * @param {PointAbstrait} B Point de la demi-droite, autre que l'origine\n * @param {string} [color = 'black'] Couleur de la demi-droite : du type 'blue' ou du type '#f15929'\n * @param {boolean} [extremites = false] Trace (ou pas) l'origine de la demi-droite\n * @property {string} color Couleur de la demi-droite.  associer obligatoirement  colorToLatexOrHTML().\n * @property {number} opacite\n * @property {number} pointilles (0 pour pas de pointills)\n * @author Rmi Angot\n * @class\n */\n// JSDOC Validee par EE Aout 2022\nexport class DemiDroite extends Segment {\n  constructor(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    color = 'black',\n    extremites = false,\n  ) {\n    super(A, B)\n    this.opacite = 1\n    this.pointilles = 0\n    this.epaisseur = 1\n    const B1 = pointSurSegment(B, A, -10)\n    this.x2 = B1.x\n    this.y2 = B1.y\n    this.color = colorToLatexOrHTML(color)\n    if (extremites) this.styleExtremites = '|-'\n  }\n}\n\n/**  Trace la demi-droite d'origine A passant par B\n * @param {PointAbstrait} A\n * @param {PointAbstrait} B\n * @param {string} [color='black'] Facultatif, 'black' par dfaut\n * @param {boolean} [extremites = false] Trace (ou pas) l'origine de la demi-droite\n * @example demiDroite(M, N) // Trace la demi-droite d'origine M passant par N et de couleur noire\n * @example demiDroite(M, N, 'blue', true) // Trace la demi-droite d'origine M passant par N et de couleur bleue, en traant le trait signifiant l'origine de la demi-droite\n * @author Rmi Angot\n * @return {DemiDroite}\n */\n// JSDOC Validee par EE Aout 2022\nexport function demiDroite(\n  A: PointAbstrait,\n  B: PointAbstrait,\n  color = 'black',\n  extremites = false,\n) {\n  return new DemiDroite(A, B, color, extremites)\n}\n\n/**\n * Renvoie la distance de A  B\n * @param {PointAbstrait} A\n * @param {PointAbstrait} B\n * @param {number} [precision] Nombre de chiffres aprs la virgule.\n * (ne sert  rien car si le number correspondant  l'arrondi ne tombe pas sur un flottant convertible en bianire sans erreur, il y aura 18 chiffres significatifs dans le number retourn\n * C'est  la fonction d'affichage de limiter le nombre de chiffres\n * @author Rmi Angot\n */\nexport function longueur(\n  A: PointAbstrait | Point3d,\n  B: PointAbstrait | Point3d,\n  precision = 2,\n) {\n  return arrondi(Math.sqrt((B.x - A.x) ** 2 + (B.y - A.y) ** 2), precision ?? 6)\n  // j chiffres aprs la virgule pour l'arrondi sachant que c'est  la fonction d'affichage de limiter le nombre de chiffres.\n}\n\n/**\n * norme(V) renvoie la norme du vecteur\n *\n * @author Rmi Angot\n */\nexport function norme(v: Vecteur) {\n  return Math.sqrt(v.x ** 2 + v.y ** 2)\n}\n\nexport class Cordelette extends ObjetMathalea2D {\n  amplitude: number\n  constructor(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    amplitude = 1,\n    mollesse = 0.5,\n    color = 'black',\n  ) {\n    super()\n    this.typeObjet = 'cordelette'\n    this.A = A\n    this.B = B\n    this.tailleExtremites = 0\n    this.color = colorToLatexOrHTML(color)\n    this.amplitude = amplitude\n    this.bordures = [\n      Math.min(A.x, B.x),\n      Math.min(A.y, B.y),\n      Math.max(A.x, B.x),\n      Math.max(A.y, B.y),\n    ]\n  }\n\n  svg(coeff: number) {\n    const mainLevee = MainLevee.create()\n    if (mainLevee != null) {\n      const A = this.A\n      const B = this.B\n\n      // Calcul de la distance entre A et B\n      const distance = Math.sqrt((B.x - A.x) ** 2 + (B.y - A.y) ** 2)\n\n      // Nombre de points intermdiaires bas sur la distance\n      // Plus la distance est grande, plus on a de points (environ 1 point tous les 0.5 units)\n      const nbPointsIntermediaires = Math.max(2, Math.floor(distance / 0.2))\n\n      // Gnration des points de la cordelette\n      const points = this.genererPointsCordelette(A, B, nbPointsIntermediaires)\n\n      // Conversion en coordonnes SVG\n      const pointsSVG = points.map((point) => [\n        point.x * coeff,\n        -point.y * coeff,\n      ]) as [number, number][]\n\n      const code = mainLevee.curve(pointsSVG, {\n        color: this.color[0],\n        epaisseur: this.epaisseur,\n        roughness: this.amplitude * 0.5, // Rduire la roughness car on a dj le dcalage\n        bowing: 1, // Rduire le bowing aussi\n      })\n\n      mainLevee.destroy()\n      return code\n    } else return ''\n  }\n\n  /**\n   * Gnre des points intermdiaires dcals pour simuler une cordelette\n   */\n  private genererPointsCordelette(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    nbPoints: number,\n  ) {\n    const points = [A] // Commence par le point A\n\n    // Vecteur directeur AB\n    const vecteurAB = { x: B.x - A.x, y: B.y - A.y }\n    // Vecteur perpendiculaire (pour les dcalages)\n    const vecteurPerp = { x: -vecteurAB.y, y: vecteurAB.x }\n    // Normalisation du vecteur perpendiculaire\n    const normePerp = Math.sqrt(vecteurPerp.x ** 2 + vecteurPerp.y ** 2)\n    if (normePerp > 0) {\n      vecteurPerp.x /= normePerp\n      vecteurPerp.y /= normePerp\n    }\n\n    // Distance entre A et B\n    const longueurAB = Math.sqrt(vecteurAB.x ** 2 + vecteurAB.y ** 2)\n\n    // Gnration d'une fonction de dcalage continue base sur plusieurs sinusodes\n    // pour crer un aspect naturel mais lisse\n    const frequence1 = 1 // Oscillation principale\n    const frequence2 = 2.3 // Oscillation secondaire (nombre premier pour viter la priodicit)\n    const frequence3 = 3.7 // Oscillation tertiaire\n\n    // Amplitudes relatives\n    const amp1 = 1\n    const amp2 = 0.6\n    const amp3 = 0.3\n\n    // Seed pour la reproductibilit (bas sur les coordonnes des points)\n    const seed = (A.x + A.y + B.x + B.y) * 1000\n\n    // Fonction de dcalage continue\n    const calculerDecalage = (t: number): number => {\n      // Facteur d'attnuation aux extrmits (forme en cloche)\n      const facteurExtremites = Math.sin(t * Math.PI)\n\n      // Combinaison de plusieurs sinusodes avec phases diffrentes\n      const phase1 = seed * 0.001\n      const phase2 = seed * 0.0013\n      const phase3 = seed * 0.0017\n\n      const decalage =\n        amp1 * Math.sin(t * Math.PI * frequence1 + phase1) +\n        amp2 * Math.sin(t * Math.PI * frequence2 + phase2) +\n        amp3 * Math.sin(t * Math.PI * frequence3 + phase3)\n\n      return decalage * facteurExtremites\n    }\n\n    // Gnration des points intermdiaires\n    for (let i = 1; i < nbPoints; i++) {\n      const t = i / nbPoints // Paramtre entre 0 et 1\n\n      // Point sur le segment AB\n      const pointSurSegment = {\n        x: A.x + t * vecteurAB.x,\n        y: A.y + t * vecteurAB.y,\n      }\n\n      // Amplitude du dcalage base sur la longueur et l'amplitude fournie\n      const amplitudeDecalage = this.amplitude * 0.05 * longueurAB\n\n      // Dcalage continu et lisse\n      const decalage = calculerDecalage(t) * amplitudeDecalage\n\n      // Effet de gravit (la cordelette \"tombe\" naturellement)\n      const decalageGravite =\n        Math.sin(t * Math.PI) * this.amplitude * 0.02 * longueurAB\n\n      // Point final dcal\n      const pointDecale = pointAbstrait(\n        pointSurSegment.x + decalage * vecteurPerp.x,\n        pointSurSegment.y + decalage * vecteurPerp.y - decalageGravite,\n      )\n\n      points.push(pointDecale)\n    }\n\n    points.push(B) // Termine par le point B\n    return points\n  }\n\n  tikz() {\n    const A = this.A\n    const B = this.B\n\n    // Calcul de la distance entre A et B\n    const distance = Math.sqrt((B.x - A.x) ** 2 + (B.y - A.y) ** 2)\n\n    // Nombre de points intermdiaires bas sur la distance\n    const nbPointsIntermediaires = Math.max(2, Math.floor(distance / 0.2))\n\n    // Gnration des points de la cordelette\n    const points = this.genererPointsCordelette(A, B, nbPointsIntermediaires)\n\n    // Construction des options TikZ\n    const tableauOptions = []\n\n    // Gestion de la couleur (utilise this.color[1] qui est le nom de couleur LaTeX)\n    if (this.color[1] !== 'black') {\n      tableauOptions.push(this.color[1])\n    }\n\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width=${this.epaisseur}`)\n    }\n\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity=${this.opacite}`)\n    }\n\n    const optionsDraw =\n      tableauOptions.length > 0 ? `[${tableauOptions.join(', ')}]` : ''\n\n    // Construction du path avec courbes lisses (sans dcorateur conflictuel)\n    const coordonnees = points\n      .map((point) => `(${point.x.toFixed(3)},${point.y.toFixed(3)})`)\n      .join(' ')\n\n    return `\\\\draw${optionsDraw} plot[smooth] coordinates {${coordonnees}};`\n  }\n}\n\nexport function cordelette(\n  A: PointAbstrait,\n  B: PointAbstrait,\n  amplitude = 1,\n  mollesse = 0.5,\n  color = 'black',\n) {\n  return new Cordelette(A, B, amplitude, mollesse, color)\n}\n","import {\n  ObjetMathalea2D,\n  colorToLatexOrHTML,\n  fixeBordures,\n} from '../../../modules/2dGeneralites'\nimport { segment } from '../../2d/segmentsVecteurs'\nimport {\n  Point3d,\n  Vecteur3d,\n  point3d,\n  vecteur3d,\n  Polygone3d,\n  Droite3d,\n  polygone3d,\n  droite3d,\n  arete3d,\n} from './elements'\nimport { cross, dot, matrix, multiply, norm } from 'mathjs'\n\nexport const math = { matrix, multiply, norm, cross, dot }\n/*\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%% TRANSFORMATIONS%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n*/\n/**\n * LA ROTATION VECTORIELLE\n *\n * @author Jean-Claude Lhote\n * Cette rotation se distingue de la rotation d'axe (d) par le fait qu'on tourne autour d'une droite vectorielle\n * Elle sert  faire tourner des vecteurs essentiellement.\n * Si on l'utilise sur un point, alors il tournera autour d'une droite passant par l'origine.\n *\n * @param {*} point3D pour l'instant, cette fonction ne fait tourner qu'un point3d ou un vecteur3d\n * @param {*} vecteur3D vecteur directeur de l'axe de rotation (l'axe passe par l'origine, pour tourner autour d'une droite particulire on utilise rotation3d())\n * @param {*} angle Angle de rotation\n */\n\nexport function rotationV3d<T extends Point3d | Vecteur3d>(\n  point3D: T,\n  vecteur3D: Vecteur3d,\n  angle: number,\n): T {\n  let V, p2\n  const norme = math.norm(vecteur3D.matrice)\n  const unitaire = math.multiply(vecteur3D.matrice, 1 / norme)\n  const u = unitaire._data[0]\n  const v = unitaire._data[1]\n  const w = unitaire._data[2]\n  const c = Math.cos((angle * Math.PI) / 180)\n  const s = Math.sin((angle * Math.PI) / 180)\n  const k = 1 - c\n  const matrice = math.matrix([\n    [u * u * k + c, u * v * k - w * s, u * w * k + v * s],\n    [u * v * k + w * s, v * v * k + c, v * w * k - u * s],\n    [u * w * k - v * s, v * w * k + u * s, w * w * k + c],\n  ])\n  if (point3D instanceof Point3d) {\n    V = math.matrix([point3D.x, point3D.y, point3D.z])\n    p2 = math.multiply(matrice, V)\n    return point3d(p2._data[0], p2._data[1], p2._data[2]) as T\n  } else if (point3D instanceof Vecteur3d) {\n    V = point3D\n    p2 = math.multiply(matrice, V.matrice)\n    return vecteur3d(p2._data[0], p2._data[1], p2._data[2]) as T\n  }\n}\n/**\n * LA ROTATION D'AXE UNE DROITE\n *\n * @author Jean-Claude Lhote\n *\n * @param {Point3d} point3D Pour l'instant on ne fait tourner qu'un point3d\n * Remarque : a n'a aucun sens de faire tourner un vecteur autour d'une droite particulire, on utilise la rotation vectorielle pour a.\n * @param {Droite3d} droite3D Axe de rotation\n * @param {Number} angle Angle de rotation\n * @param {string} color couleur du polygone cr. si non prcis la couleur sera celle du polygone argument\n */\n\nexport function rotation3d<T extends Point3d | Vecteur3d | Polygone3d>(\n  point3D: T,\n  droite3D: Droite3d,\n  angle: number,\n  color?: string,\n): T {\n  const directeur = droite3D.directeur\n  const origine = droite3D.origine\n  if (point3D instanceof Point3d) {\n    const V = vecteur3d(origine, point3d(0, 0, 0))\n    const W = vecteur3d(point3d(0, 0, 0), origine)\n    const M = translation3d(point3D, V)\n    const N = rotationV3d(M, directeur, angle)\n    return translation3d(N, W)\n  }\n  if (point3D instanceof Vecteur3d) {\n    return rotationV3d(point3D, directeur, angle)\n  }\n  if (point3D instanceof Polygone3d) {\n    const rotated = point3D.listePoints.map((p: Point3d) =>\n      rotation3d(p, droite3D, angle),\n    )\n    return polygone3d(rotated, color ?? point3D.color) as T\n  }\n}\n/**\n * @author Jean-Claude Lhote\n * Cre une flche en arc de cercle pour montrer un sens de rotation autour d'un axe 3d\n * cette flche est dessine dans le plan orthogonal  l'axe qui passe par l'origine de l'axe\n * le rayon est ici un vecteur 3d qui permet de fixer le point de dpart de la flche par translation de l'origine de l'axe\n * l'angle dfinit l'arc form par la flche\n * son sens est dfinit par le vecteur directeur de l'axe (changer le signe de chaque composante de ce vecteur pour changer le sens de rotation)\n */\n\nexport class SensDeRotation3d extends ObjetMathalea2D {\n  constructor(\n    axe: Droite3d,\n    rayon: Vecteur3d,\n    angle: number,\n    epaisseur: number,\n    color: string,\n  ) {\n    super()\n    this.epaisseur = epaisseur\n    this.color = colorToLatexOrHTML(color)\n    this.c2d = []\n    let M\n    let N\n    let s\n    M = translation3d(axe.origine, rayon)\n    for (let i = 0; i < angle; i += 5) {\n      N = rotation3d(M, axe, 5)\n      s = segment(M.c2d, N.c2d, color)\n      s.epaisseur = this.epaisseur\n      this.c2d.push(s)\n      M = N\n    }\n    N = rotation3d(M, axe, 5)\n    s = segment(M.c2d, N.c2d, color)\n    s.epaisseur = this.epaisseur\n    this.c2d.push(s)\n    const d = droite3d(N, axe.directeur)\n    const A = rotation3d(M, d, 30)\n    const B = rotation3d(M, d, -30)\n    s = segment(N.c2d, A.c2d, color)\n    s.epaisseur = this.epaisseur\n    this.c2d.push(s)\n    s = segment(N.c2d, B.c2d, color)\n    s.epaisseur = this.epaisseur\n    this.c2d.push(s)\n  }\n}\n\nexport function sensDeRotation3d(\n  axe: Droite3d,\n  rayon: Vecteur3d,\n  angle: number,\n  epaisseur: number,\n  color: string,\n) {\n  return new SensDeRotation3d(axe, rayon, angle, epaisseur, color)\n}\n/**\n * LA TRANSLATION\n *\n * @author Jean-Claude Lhote\n * @param {Point3d | Polygone3d} point3D Pour l'instant on ne translate qu'un point3d ou un polygone3d\n * @param {Vecteur3d} vecteur3D\n */\n\nexport function translation3d<T extends Point3d | Polygone3d>(\n  point3D: T,\n  vecteur3D: Vecteur3d,\n): T {\n  if (point3D instanceof Point3d) {\n    const x = point3D.x + vecteur3D.x\n    const y = point3D.y + vecteur3D.y\n    const z = point3D.z + vecteur3D.z\n    return point3d(x, y, z) as T\n  } else if (point3D instanceof Polygone3d) {\n    const p = []\n    for (let i = 0; i < point3D.listePoints.length; i++) {\n      p.push(translation3d(point3D.listePoints[i], vecteur3D))\n    }\n    return polygone3d(p, point3D.color) as T\n  }\n  window.notify(\n    \"translation3d ne peut tre appliqu qu' un point3d ou un polygone3d\",\n    point3D,\n  )\n  return point3D\n}\n/**\n * L'homothetie\n * @author Jean-Claude Lhote\n * La mme chose qu'ne 2d, mais en 3d...\n * Pour les points3d les polygones ou les vecteurs (multiplication scalaire par rapport)\n */\n\nexport function homothetie3d<T extends Point3d | Vecteur3d | Polygone3d>(\n  point3D: T,\n  centre: Point3d,\n  rapport: number,\n  color?: string,\n): T {\n  let V\n  const p = []\n  if (point3D instanceof Point3d) {\n    V = vecteur3d(centre, point3D)\n    V.x *= rapport\n    V.y *= rapport\n    V.z *= rapport\n    return translation3d(centre, V) as T\n  } else if (point3D instanceof Vecteur3d) {\n    V = vecteur3d(point3D.x, point3D.y, point3D.z)\n    V.x *= rapport\n    V.y *= rapport\n    V.z *= rapport\n    return V as T\n  } else if (point3D instanceof Polygone3d) {\n    for (let i = 0; i < point3D.listePoints.length; i++) {\n      p.push(homothetie3d(point3D.listePoints[i], centre, rapport, color))\n    }\n    return polygone3d(p, color ?? point3D.color) as T\n  }\n  window.notify(\n    \"homothetie3d ne peut tre appliqu qu' un point3d, un vecteur3d ou un polygone3d\",\n    point3D,\n  )\n  return point3D\n}\n\nexport class CodageAngleDroit3D extends ObjetMathalea2D {\n  constructor(A: Point3d, B: Point3d, C: Point3d, color = 'black', taille = 1) {\n    super()\n    const BA = vecteur3d(B, A)\n    const BC = vecteur3d(B, C)\n    const k1 = BA.norme\n    const k2 = BC.norme\n    const M1 = homothetie3d(A, B, (taille * 0.5) / k1)\n    const M3 = homothetie3d(C, B, (taille * 0.5) / k2)\n    const BM1 = vecteur3d(B, M1)\n    const BM3 = vecteur3d(B, M3)\n    const x = B.x + BM1.x + BM3.x\n    const y = B.y + BM1.y + BM3.y\n    const z = B.z + BM1.z + BM3.z\n    const M2 = point3d(x, y, z)\n    const M1M2 = arete3d(M1, M2, color)\n    const M2M3 = arete3d(M2, M3, color)\n    const bordures = fixeBordures([M1M2.c2d, M2M3.c2d])\n    this.bordures = [bordures.xmin, bordures.ymin, bordures.xmax, bordures.ymax]\n    this.svg = function (coeff) {\n      return M1M2.c2d.svg(coeff) + M2M3.c2d.svg(coeff)\n    }\n    this.tikz = function () {\n      return M1M2.c2d.tikz() + M2M3.c2d.tikz()\n    }\n  }\n}\n","import { translation3d, rotation3d } from './tranformations'\nimport { context } from '../../../modules/context'\nimport { Droite, droite } from '../../2d/droites'\nimport { Point, point } from '../../2d/points'\nimport { polyline, Polygone, polygone } from '../../2d/polygones'\nimport { Vecteur, Segment, vecteur, segment } from '../../2d/segmentsVecteurs'\nimport { arrondi } from '../../outils/nombres'\nimport { cross, dot, matrix, multiply, norm } from 'mathjs'\n\nexport const math = { matrix, multiply, norm, cross, dot }\n\n/*\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%% OBJET PARENT %%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n*/\n/*\n * Classe parente de tous les objets de MathALEA2D\n *\n * @author Rmi Angot\n */\n// let numId = 0\n/*\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%% OBJETS DE BASE %%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n*/\n/**\n * LE POINT\n *\n * @author Jean-Claude Lhote\n * Point de l'espace dfini par ses trois coordonnes (Si deux sont donnes seulement, le point est dans le plan XY)\n * le paramtre visible dfinit si ce point est plac devant (par dfaut) ou derrire une surface. Il sera utilis pour dfinir la visibilit des artes qui en partent\n */\n\nexport class Point3d {\n  x: number\n  y: number\n  z: number\n  isVisible: boolean\n  label: string\n  typeObjet: string\n  c2d: Point\n  constructor(\n    x: number,\n    y: number,\n    z: number,\n    isVisible: boolean,\n    label: string,\n    positionLabel: string,\n  ) {\n    const alpha = (context.anglePerspective * Math.PI) / 180 // context.anglePerspective peut tre chang globalement pour modifier la perspective\n    const rapport = context.coeffPerspective // idem pour context.coefficientPerspective qui est la rduction sur l'axe y.\n    const MT = math.matrix([\n      [1, rapport * Math.cos(alpha), 0],\n      [0, rapport * Math.sin(alpha), 1],\n    ]) // La matrice de projection 3d -> 2d\n    this.x = x\n    this.y = y\n    this.z = z\n    this.isVisible = isVisible\n    this.label = label\n    this.typeObjet = 'point3d'\n    const V = math.matrix([this.x, this.y, this.z])\n    const W = math.multiply(MT, V)\n    this.c2d = point(\n      arrondi(W._data[0], 2),\n      arrondi(W._data[1], 2),\n      this.label,\n      positionLabel,\n    )\n  }\n}\n\nexport function point3d(\n  x: number,\n  y: number,\n  z = 0,\n  visible = true,\n  label = '',\n  positionLabel = 'above left',\n) {\n  return new Point3d(x, y, z, visible, label, positionLabel)\n}\n/**\n * LE VECTEUR\n *\n * @author Jean-Claude Lhote\n * le vecteur3d est sans doute l'objet le plus important de cette base d'objets\n * On les utilise dans tous les objets complexes et dans toutes les transformations\n * Ils servent notament  dfinir la direction des plans.\n *\n * 3 usages : vecteur3d(A,B) ou vecteur3d(x,y,z) ou vecteur3d(math.matrix([x,y,z]))\n * A et B sont deux objets de type Point3d\n * x,y et z sont trois nombres\n * la commande math.matrix([x,y,z]) cre une matrice colonne.\n *\n * L'objet cr est de type Vecteur3d\n * sa proprit p2d est un objet Vecteur (2 dimensions : c'est la projection du vecteur)\n * sa proprit this.representant(A) est le dessin du reprsentant d'origine A.\n * exemples :\n * let v = vecteur3d(3,5,1) -> dfinit un vecteur de composantes (3;5;1)\n * let w = vecteur(point3d(0,0,0),point3d(1,1,1)) -> dfinit un vecteur d'origine O et d'extrmit M(1;1;1)\n * let fleche = w.representant(point3d(5,0,0)) -> fleche est un objet 2d qui reprsente le vecteur w au point (5;0;0)\n */\n\nexport class Vecteur3d {\n  x: number = 0\n  y: number = 0\n  z: number = 0\n  matrice: any\n  norme: number\n  c2d: Vecteur\n  representant: (A: Point3d) => Segment\n  constructor(\n    ...args: [Point3d, Point3d] | [number, number, number] | [math.Matrix]\n  ) {\n    const alpha = (context.anglePerspective * Math.PI) / 180\n    const rapport = context.coeffPerspective\n    const MT = math.matrix([\n      [1, rapport * Math.cos(alpha), 0],\n      [0, rapport * Math.sin(alpha), 1],\n    ]) // ceci est la matrice de projection 3d -> 2d\n    if (args.length === 2) {\n      this.x = args[1].x - args[0].x\n      this.y = args[1].y - args[0].y\n      this.z = args[1].z - args[0].z\n    } else if (args.length === 3) {\n      this.x = args[0]\n      this.y = args[1]\n      this.z = args[2]\n    } else if (args.length === 1) {\n      this.x = args[0]._data[0]\n      this.y = args[0]._data[1]\n      this.z = args[0]._data[2]\n    }\n    this.matrice = math.matrix([this.x, this.y, this.z]) // On exporte cette matrice colonne utile pour les calculs vectoriels qui seront effectus par math\n    this.norme = Math.sqrt(this.x ** 2 + this.y ** 2 + this.z ** 2) // la norme du vecteur\n    const W = math.multiply(MT, this.matrice) // voil comment on obtient les composantes du projet 2d du vecteur\n    this.c2d = vecteur(W._data[0], W._data[1]) // this.c2d est l'objet 2d qui reprsente l'objet 3d this\n    this.representant = function (A: Point3d) {\n      const B = translation3d(A, this)\n      return vecteur(A.c2d, B.c2d).representant(A.c2d) // qui retourne un reprsentant de vecteur 2d (objet dessin)\n    }\n  }\n}\n\nexport function vecteur3d(\n  ...args: [Point3d, Point3d] | [number, number, number] | [math.Matrix]\n) {\n  return new Vecteur3d(...args)\n}\n/**\n * L'ARETE\n * @author Jean-Claude lhote\n * Une telle arte est dfinie par deux points\n * Si l'un des deux points n'est pas visible (proprit visible  false) alors l'arte aura aussi visible  false\n * sa proprit p2d est un segment en pointill ou en trait plein suivant sa visibilit.\n */\n\nexport class Arete3d {\n  extremite1: Point3d\n  extremite2: Point3d\n  color: string\n  isVisible: boolean\n  c2d: Segment\n  constructor(\n    point1: Point3d,\n    point2: Point3d,\n    color: string,\n    isVisible: boolean,\n  ) {\n    this.extremite1 = point1\n    this.extremite2 = point2\n    this.color = Array.isArray(color) ? color[0] : color // MGu parfois un tableau de couleurs, pasd compatible avec segment.\n    this.isVisible = isVisible\n    if (!point1.isVisible || !point2.isVisible || !this.isVisible) {\n      this.isVisible = false\n    } else {\n      this.isVisible = true\n    }\n    this.c2d = segment(point1.c2d, point2.c2d, this.color)\n    if (!this.isVisible) {\n      this.c2d.pointilles = 2\n    } else {\n      this.c2d.pointilles = 0\n    }\n  }\n}\n// l'arte est visible par dfaut sauf si p1 ou p2 sont invisibles\n\nexport function arete3d(\n  p1: Point3d,\n  p2: Point3d,\n  color = 'black',\n  visible = true,\n) {\n  return new Arete3d(p1, p2, color, visible)\n}\n/**\n * LA DROITE\n *\n * @author Jean-claude Lhote\n * Droite de l'espace dfinie par point et vecteur directeur droite3d(A,v)\n * Droite de l'espace dfinie par 2 points droite3d(A,B)\n * Les droites servent principalement  dfinir des axes de rotation dans l'espace\n */\nexport class Droite3d {\n  directeur: Vecteur3d = vecteur3d(0, 0, 1) // le vecteur directeur de la droite\n  origine: Point3d\n  point: any\n  c2d: Droite\n  constructor(point3D: Point3d, vecteur3D: Vecteur3d) {\n    if (vecteur3D.constructor === Vecteur3d) {\n      this.directeur = vecteur3D\n    } else if (vecteur3D.constructor === Point3d) {\n      this.directeur = vecteur3d(point3D, vecteur3D)\n    }\n    this.origine = point3D\n    const M = translation3d(this.origine, this.directeur)\n    this.point = M\n    this.c2d = droite(this.origine.c2d, M.c2d) // la droite correspndant  la projection de cette droite dans le plan Mathalea2d\n    this.c2d.isVisible = false\n  }\n}\n\nexport function droite3d(point3D: Point3d, vecteur3D: Vecteur3d) {\n  return new Droite3d(point3D, vecteur3D)\n}\n/**\n * LE DEMI-CERCLE  - ANCIENNE FONCTION\n *\n *@author Jean-Claude Lhote\n * Le nom est trompeur, il s'agit le plus souvent d'une demi-ellipse reprsentant un cercle projet\n * Utilis pour reprsenter un cercle dont une moiti est visible mais pas l'autre.\n *\n * normal et rayon sont deux vecteurs 3d\n * normal est un vecteur normal au plan du cercle\n * rayon est le vecteur qui part du centre et qui joint la 1ere extremit visible.\n * cote est soit 'cach' soit 'visible' et dterminera dans quel sens on cre le demi-cercle.\n * Si cote='cach' alors on tourne dans le sens direct et le trac est en pointills\n * Si cote='visible' alors on tourne dans le sens indirect et le trac est plein.\n *\n */\n/*\nexport function demicercle3d (centre, normal, rayon, cote, color, angledepart = context.anglePerspective) {\n  let signe; const M = []; const listepoints = []\n  if (cote === 'cach') {\n    signe = 1\n  } else {\n    signe = -1\n  }\n  const d = droite3d(centre, normal)\n  M.push(rotation3d(translation3d(centre, rayon), d, angledepart))\n  listepoints.push(M[0].c2d)\n\n  for (let i = 1; i < 19; i++) {\n    M.push(rotation3d(M[i - 1], d, 10 * signe))\n    listepoints.push(M[i].c2d)\n  }\n  const demiCercle = polyline(listepoints, color)\n  if (cote === 'cach') {\n    demiCercle.pointilles = 2\n    demiCercle.opacite = 0.3\n  }\n  return demiCercle\n}\n*/\n/**\n * Cre un demi-cercle\n * @param {Point3d} centre Centre du demi-cercle\n * @param {Vecteur3d} normal Vecteur normal au demi-cercle\n * @param {Vecteur3d} rayon Vecteur correspondant au rayon\n * @param {string} [sens = 'direct'] Sens de rotation pour crer le demi-cercle ('direct' ou 'indirect\")\n * @param {boolean} [estCache = false] Si false, alors le trac est en trait plein, sinon le trac est en pointills\n * @param {string} [color = 'black'] Couleur du demi-cercle : du type 'blue' ou du type '#f15929'\n * @param {number} [angledepart = context.anglePerspective] Angle en degr entre le vecteur rayon depuis le centre et le point de dbut de trac du demi-cercle\n * @example demicercle3d(A,n,v) // Cre un demi-cercle noir en trait plein de centre A, de vecteur normal v, dont le rayon correspond au vecteur v et le sens est direct\n * @example demicercle3d(A,n,v,'indirect',true,'red',0) // Cre un demi-cercle rouge en pointills de centre A, de vecteur normal v, dont le rayon correspond au vecteur v, le sens est direct et l'angle de dpart est 0.\n * @author Eric Elter (d'aprs version prcdente de Jean-Claude Lhote)\n * @return {demiCercle}\n */\n\nexport function demicercle3d(\n  centre: Point3d,\n  normal: Vecteur3d,\n  rayon: Vecteur3d,\n  sens: string = 'direct',\n  estCache: boolean = false,\n  color: string = 'black',\n  angledepart: number = context.anglePerspective,\n) {\n  let signe\n  const M = []\n  const listepoints = []\n  const listePoints3d = []\n  if (sens === 'direct') {\n    signe = 1\n  } else {\n    signe = -1\n  }\n  const d = droite3d(centre, normal)\n  M.push(rotation3d(translation3d(centre, rayon), d, angledepart))\n  listePoints3d.push(M[0])\n  listepoints.push(M[0].c2d)\n\n  for (let i = 1; i < 19; i++) {\n    M.push(rotation3d(M[i - 1], d, 10 * signe))\n    listePoints3d.push(M[i])\n    listepoints.push(M[i].c2d)\n  }\n  const demiCercle = polyline(listepoints, color)\n  if (estCache) {\n    demiCercle.pointilles = 2\n    demiCercle.opacite = 0.9\n  }\n  return demiCercle\n}\n/**\n * L'ARC\n *\n *@author Mickael Guironnet\n * Le nom est trompeur, il s'agit le plus souvent d'un morceau d'ellipse reprsentant un arc projet\n * Utilis pour reprsenter un arc dont une moiti est visible mais pas l'autre.\n *\n * normal et rayon sont deux vecteurs 3d\n * normal est un vecteur normal au plan du cercle\n * rayon est le vecteur qui part du centre et qui joint la 1ere extremit visible.\n * cote est soit 'cach' soit 'visible'\n *\n */\n\nexport function arc3d(\n  centre: Point3d,\n  normal: Vecteur3d,\n  rayon: Vecteur3d,\n  cote: 'visible' | 'cach',\n  color: string,\n  angledepart: number,\n  angledefin: number,\n) {\n  const M = []\n  const listepoints = []\n  const d = droite3d(centre, normal)\n  M.push(rotation3d(translation3d(centre, rayon), d, angledepart))\n  listepoints.push(M[0].c2d)\n\n  const nbr = Math.floor((angledefin - angledepart) / 10)\n  for (let i = 1; i <= nbr; i++) {\n    M.push(rotation3d(M[i - 1], d, 10))\n    listepoints.push(M[i].c2d)\n  }\n  const arc = polyline(listepoints, color)\n  if (cote === 'cach') {\n    arc.pointilles = 2\n    arc.opacite = 0.3\n  }\n  return arc\n}\n/**\n * LE CERCLE\n *\n * @author Jean-Claude Lhote\n *\n * C'est la version entire du cercle : soit totalement visible, soit totalement cach.\n * visible est un boolen\n *\n */\n\nexport function cercle3d(\n  centre: Point3d,\n  normal: Vecteur3d,\n  rayon: Vecteur3d,\n  visible: boolean = true,\n  color: string = 'black',\n  pointilles: boolean = false,\n): [Polygone, Point3d[], Point[]] {\n  const M: Point3d[] = []\n  const listepoints: Point[] = []\n  const listepoints3d: Point3d[] = []\n  const d = droite3d(centre, normal)\n  M.push(rotation3d(translation3d(centre, rayon), d, context.anglePerspective))\n  listepoints3d.push(M[0])\n  listepoints.push(M[0].c2d)\n  for (let i = 1; i < 36; i++) {\n    M.push(rotation3d(M[i - 1], d, 10))\n    listepoints3d.push(M[i])\n    listepoints.push(M[i].c2d)\n  }\n  const C = polygone(listepoints, color)\n  C.isVisible = visible\n  if (pointilles) {\n    C.pointilles = 2\n  }\n  return [C, listepoints3d, listepoints]\n}\n/**\n * LE POLYGONE\n *\n * @author Jean-Claude Lhote\n * usages : polygone3d([A,B,C,...],color) ou polygone3d(A,B,C...) o A,B,C ... sont des point3d. color='black' par dfaut.\n */\nexport class Polygone3d {\n  listePoints: Point3d[]\n  color: string = 'black'\n  listePoints2d: Point[]\n  aretes: Arete3d[]\n  c2d: Segment[]\n  constructor(...args: [Point3d[], string] | Point3d[]) {\n    if (Array.isArray(args[0])) {\n      // Si le premier argument est un tableau\n      this.listePoints = args[0]\n      if (typeof args[1] === 'string' && args[1] !== '') {\n        this.color = args[1]\n      }\n    } else {\n      this.listePoints = args.filter((arg) => arg instanceof Point3d)\n      this.color = 'black'\n    }\n    const segments3d = []\n    let A\n    const segments = []\n    A = this.listePoints[0]\n    this.listePoints2d = [A.c2d]\n    for (let i = 1; i < this.listePoints.length; i++) {\n      segments3d.push(\n        arete3d(\n          A,\n          this.listePoints[i],\n          this.color,\n          A.isVisible && this.listePoints[i].isVisible,\n        ),\n      )\n      segments.push(segments3d[i - 1].c2d)\n      A = this.listePoints[i]\n      this.listePoints2d.push(A.c2d)\n    }\n    segments3d.push(\n      arete3d(\n        A,\n        this.listePoints[0],\n        this.color,\n        A.isVisible && this.listePoints[0].isVisible,\n      ),\n    )\n    segments.push(segments3d[this.listePoints.length - 1].c2d)\n    this.aretes = segments3d\n    this.c2d = segments\n  }\n}\n\nexport function polygone3d(\n  ...args: [Point3d[], string] | Point3d[]\n): Polygone3d {\n  return new Polygone3d(...args)\n}\n","import { floor } from 'mathjs'\nimport {\n  colorToLatexOrHTML,\n  ObjetMathalea2D,\n} from '../../modules/2dGeneralites'\nimport { randint } from '../../modules/outils'\nimport { CodageAngleDroit, codageAngleDroit } from './angles'\nimport { cercle } from './cercle'\nimport { CodageMilieu } from './codages'\nimport { Droite, droite, mediatrice } from './droites'\nimport {\n  milieu,\n  Point,\n  point,\n  pointIntersectionCC,\n  pointIntersectionDD,\n  pointIntersectionLC,\n  pointSurSegment,\n} from './points'\nimport { Polygone, polygone } from './polygones'\nimport { longueur } from './segmentsVecteurs'\nimport { projectionOrtho, rotation, similitude } from './transformations'\nimport type { PointAbstrait } from './points-abstraits'\n\n/**\n * retourne un objet contenant le triangle ABC et le pied de la hauteur H\n * @param {point} A premire extrmit de la base\n * @param {point} B deuxime extrmit de la base\n * @param {number} h hauteur du triangle en cm\n * @param {number} d valeur algbrique de AH o H est le pied de la hauteur\n * @param {*} n = 1 ou 2 permet de choisir le ct pour C.\n * @author Jean-Claude Lhote\n * @return {objet} {triangle, pied}\n */\nexport function triangle2points1hauteur(\n  A: Point,\n  B: Point,\n  h: number,\n  d: number,\n  n = 1,\n  color = 'black',\n) {\n  if (d === undefined) {\n    d = randint(0, floor(longueur(A, B)))\n  }\n  const H = pointSurSegment(A, B, d)\n  const C = similitude(A, H, 90 * (3 - n * 2), h / longueur(A, H))\n  return { triangle: polygone([A, B, C], color), pied: H }\n}\n\n/**\n * @param {Point} A\n * @param {Point} B\n * @param {number} l1\n * @param {number} l2\n * @param {number} [n=1] Si n = 1 (dfaut), C a la plus grande ordonne possible, si n = 2, C a la plus petite ordonne possible\n * @return {Polygone} objet Polygone ABC\n * @example t = triangle2points2longueurs(A,B,4,7,2) // Rcupre t le triangle ABC tel que AC = 4 cm et BC = 7 cm avec C qui a l'ordonne la plus petite possible\n * @example C = t.listePoints[2] // Rcupre le 3e sommet dans la variable C\n * @author Rmi Angot\n */\nexport function triangle2points2longueurs(\n  A: Point,\n  B: Point,\n  l1: number,\n  l2: number,\n  n = 1,\n  color = 'black',\n) {\n  const c1 = cercle(A, l1)\n  const c2 = cercle(B, l2)\n  let C: Point\n  if (n === 1) {\n    C = pointIntersectionCC(c1, c2)\n  } else {\n    C = pointIntersectionCC(c1, c2, '', 2)\n  }\n  return polygone([A, B, C], color)\n}\n\n/**\n * t = triangle2points2angles(A,B,40,60) // Trace le triangle ABC tel que CAB = +40 et CBA = -60\n * C = t.listePoints[2] // Rcupre le 3e sommet dans la variable C\n * t = triangle2points2angles(A,B,40,60,2) // Trace le triangle ABC tel que CAB = -40 et CBA = 60\n * @author Rmi Angot\n */\nexport function triangle2points2angles(\n  A: Point,\n  B: Point,\n  a1: number,\n  a2: number,\n  n = 1,\n  color = 'black',\n) {\n  if (n === 1) {\n    a2 *= -1\n  } else {\n    a1 *= -1\n  }\n  const a = pointSurSegment(A, B, 1)\n  const c1 = rotation(a, A, a1)\n  const b = pointSurSegment(B, A, 1)\n  const c2 = rotation(b, B, a2)\n  const dAc1 = droite(A, c1)\n  const dBc2 = droite(B, c2)\n  const C = pointIntersectionDD(dAc1, dBc2, 'C')\n  return polygone([A, B, C], color)\n}\n\n/**\n *\n * @param {Point} A Le sommet pour l'angle donn = premire extrmit du segment de base du triangle\n * @param {Point} B L'autre extrmit du segment de base\n * @param {number} a l'angle au sommet A (angle compris entre 0 et 180 sinon il y est contraint)\n * @param {number} l la longueur du deuxime ct de l'angle\n * @param {number} n n=1 l'angle a est pris dans le sens direct, n diffrent de 1, l'angle a est pris dans le sens indirect.\n * t = triangle2points1angle1longueur(A,B,40,6) // Trace le triangle ABC tel que CAB = 40 et AC=6\n * @author Jean-Claude Lhote\n */\nexport function triangle2points1angle1longueur(\n  A: Point,\n  B: Point,\n  a: number,\n  l: number,\n  n = 1,\n  color = 'black',\n) {\n  if (n === 1) {\n    a = Math.abs(a) % 180\n  } else {\n    a = -(Math.abs(a) % 180)\n  }\n  const P = pointSurSegment(A, B, l)\n  const Q = rotation(P, A, a)\n  return polygone([A, B, Q], color)\n}\n\n/**\n * @param {Point} A Le sommet pour l'angle donn = premire extrmit du segment de base du triangle\n * @param {Point} B L'autre extrmit du segment de base\n * @param {number} a l'angle au sommet A (angle compris entre 0 et 180 sinon il y est contraint)\n * @param {number} l la longueur du ct oppos  l'angle\n * @param {number} n n=1 l'angle a est pris dans le sens direct et le point est le plus prs de A\n * n=2 l'angle est pris dans le sens indirect et le point est le plus prs de A\n * n=3 l'angle a est pris dans le sens direct et le point est le plus loin de A\n * n=4 l'angle est pris dans le sens indirect et le point est le plus loin de A\n * t = triangle2points1angle1longueurOppose(A,B,40,6) // Trace le triangle ABC tel que CAB = 40 et BC=6 Le point C est celui des deux points possible le plus prs de A\n * @author Jean-Claude Lhote\n */\nexport function triangle2points1angle1longueurOppose(\n  A: Point,\n  B: Point,\n  a: number,\n  l: number,\n  n = 1,\n  color = 'black',\n) {\n  let M: Point\n  if (n % 2 === 1) {\n    a = Math.abs(a) % 180\n  } else {\n    a = -(Math.abs(a) % 180)\n  }\n  const d = droite(A, B)\n  const e = rotation(d, A, a)\n  const c = cercle(B, l)\n  if ((n + 1) >> 1 === 1) M = pointIntersectionLC(e, c, '', 1)\n  else M = pointIntersectionLC(e, c, '', 2)\n  return polygone([A, B, M], color)\n}\n\n/**\n * Retourne l'aire du triangle si p est un triangle, false sinon.\n * @param {Polygone} p Triangle\n * @example aireTriangle(poygone(A,B,C)) // Retourne l'aire du triangle ABC\n * @example aireTriangle(poygone(A,B,C,D)) // Retourne false car le polygone n'est pas un triangle\n * @author Jean-Claude Lhote\n * @return {boolean|number}\n */\n// JSDOC Validee par EE Juin 2022\nexport function aireTriangle(p: Polygone) {\n  if (p.listePoints.length !== 3) return false\n  const A = p.listePoints[0]\n  const B = p.listePoints[1]\n  const C = p.listePoints[2]\n  return (\n    (1 / 2) * Math.abs((B.x - A.x) * (C.y - A.y) - (C.x - A.x) * (B.y - A.y))\n  )\n}\n\n/**\n * Mdiane issue de A relative  [BC]\n * @author Jean-Claude Lhote\n * @param {Point} A\n * @param {Point} B\n * @param {Point} C\n * @param {string} color\n */\nexport function medianeTriangle(A: Point, B: Point, C: Point, color = 'black') {\n  const I = milieu(B, C)\n  return droite(A, I, '', color)\n}\n\n/**\n * Cre le centre de gravit du triangle ABC\n * @param {Point} A Premier sommet du triangle\n * @param {Point} B Deuxime sommet du triangle\n * @param {Point} C Troisime sommet du triangle\n * @param {string} [nom=''] Nom du centre\n * @param {string} [positionLabel = 'above'] Position du nom par rapport au point\n * @example G = centreGraviteTriangle(F,C,N)\n * // Cre G, le centre de gravit du triangle FCN,sans tre nomm.\n * @example G = centreGraviteTriangle(F,C,N,'G','below')\n * // Cre G, le centre de gravit du triangle FCN, en notant G sous le point, s'il est trac et labellis.\n * @return {Point}\n * @author Jean-Claude Lhote\n */\n// JSDOC Validee par EE Juin 2022\nexport function centreGraviteTriangle(\n  A: Point,\n  B: Point,\n  C: Point,\n  nom = '',\n  positionLabel = 'above',\n) {\n  const d = medianeTriangle(B, A, C)\n  const e = medianeTriangle(A, B, C)\n  const p = pointIntersectionDD(d, e)\n  const x = p.x\n  const y = p.y\n  return new Point(x, y, nom, positionLabel)\n}\n\n/**  Trace la hauteur issue de A relative  [BC]\n * @param {Point} A Point dont est issue la hauteur\n * @param {Point} B Premire extrmit du segment dont est relative la hauteur\n * @param {Point} C Seconde extrmit du segment dont est relative la hauteur\n * @param {string} [color = 'black'] Couleur de cette hauteur : du type 'blue' ou du type '#f15929'\n * @example hauteurTriangle (M, N, P) // Trace, en noir, la hauteur issue de M relative  [NP]\n * @example hauteurTriangle (M, N, P, 'red') // Trace, en rouge, la hauteur issue de M relative  [NP]\n * @author Jean-Claude Lhote\n * @return {Droite}\n */\n// JSDOC Validee par EE Aout 2022\nexport function hauteurTriangle(A: Point, B: Point, C: Point, color = 'black') {\n  const d = droite(B, C)\n  const p = projectionOrtho(A, d)\n  return new Droite(p, A, '', color)\n}\n\n/**\n * Code la hauteur d'un triangle\n * @param {Point} A Premier sommet d'un triangle\n * @param {Point} B Deuxime sommet d'un triangle\n * @param {Point} C Troisime sommet d'un triangle\n * @param {string} [color = 'black'] Couleur des codages : du type 'blue' ou du type '#f15929'\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} color Couleur des codages.  associer obligatoirement  colorToLatexOrHTML().\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class CodageHauteurTriangle extends ObjetMathalea2D {\n  traceD: boolean\n  c: CodageAngleDroit\n  d: Droite\n  constructor(A: Point, B: Point, C: Point, color = 'black') {\n    super()\n    this.color = colorToLatexOrHTML(color)\n    this.d = droite(B, C)\n    const p = projectionOrtho(A, this.d)\n    const q = rotation(A, p, -90)\n    this.traceD = false\n    if (B.x < C.x) {\n      if (p.x > C.x || p.x < B.x) {\n        this.d.pointilles = 5\n        this.traceD = true\n      }\n    } else if (C.x < B.x) {\n      if (p.x < C.x || p.x > B.x) {\n        this.traceD = true\n        this.d.pointilles = 5\n      }\n    } else if (B.y < C.y) {\n      if (p.y > C.y || p.y < B.y) {\n        this.traceD = true\n        this.d.pointilles = 5\n      }\n    } else if (C.y < B.y) {\n      if (p.y < C.y || p.y > B.y) {\n        this.traceD = true\n        this.d.pointilles = 5\n      }\n    }\n    this.c = codageAngleDroit(A, p, q, color)\n  }\n\n  svg(coeff: number) {\n    if (this.traceD) {\n      return this.c.svg(coeff) + '\\n\\t' + this.d.svg(coeff)\n    } else {\n      return this.c.svg(coeff)\n    }\n  }\n\n  tikz() {\n    if (this.traceD) {\n      return this.c.tikz() + '\\n\\t' + this.d.tikz()\n    } else {\n      return this.c.tikz()\n    }\n  }\n}\n\n/**\n * Code la hauteur d'un triangle\n * @param {Point} A Premier sommet d'un triangle\n * @param {Point} B Deuxime sommet d'un triangle\n * @param {Point} C Troisime sommet d'un triangle\n * @param {string} [color = 'black'] Couleur des codages : du type 'blue' ou du type '#f15929'\n * @example codageHauteurTriangle(M,N,P) // Code, en noir, la hauteur du triangle MNP.\n * @example codageHauteurTriangle(M,N,P,'red') // Code, en rouge, la hauteur du triangle MNP.\n * @return {CodageHauteurTriangle}\n */\n// JSDOC Validee par EE Juin 2022\nexport function codageHauteurTriangle(\n  A: Point,\n  B: Point,\n  C: Point,\n  color = 'black',\n) {\n  return new CodageHauteurTriangle(A, B, C, color)\n}\n\n/**\n * Code la mdiane d'un triangle\n * @param {Point} B Premire extrmit du segment dont la mdiane est relative\n * @param {Point} C Seconde extrmit du segment dont la mdiane est relative\n * @param {string} [color = 'black'] Couleur des codages : du type 'blue' ou du type '#f15929'\n * @param {string} [mark = '//'] Symbole pos de part et d'autre du milieu du segment\n * @param {boolean} [mil = false] Trace ou nom le point du milieu.\n * @example codageMedianeTriangle(M,N) // Code, en noir, la mdiane d'un triangle relative au ct [MN], avec les symboles //\n * @example codageMedianeTriangle(M,N,P,'red','oo') // Code, en rouge, la mdiane d'un triangle relative au ct [MN], avec les symboles oo\n * @return {CodageSegments}\n */\n// JSDOC Validee par EE Juin 2022\nexport function codageMedianeTriangle(\n  A: Point,\n  B: Point,\n  color = 'black',\n  mark = '',\n  mil = false,\n) {\n  return new CodageMilieu(A, B, color, mark, mil)\n}\n\n/**\n * Orthocentre du triangle ABC\n * @author Jean-Claude Lhote\n * @param {Point} A\n * @param {Point} B\n * @param {Point} C\n * @param {string} nom\n */\nexport function orthoCentre(\n  A: Point,\n  B: Point,\n  C: Point,\n  nom = '',\n  positionLabel = 'above',\n) {\n  const d = hauteurTriangle(B, A, C)\n  const e = hauteurTriangle(A, B, C)\n  const p = pointIntersectionDD(d, e)\n  const x = p.x\n  const y = p.y\n  return point(x, y, nom, positionLabel)\n}\n\n/**\n * Cre le centre du cercle circonscrit au triangle ABC\n * @param {Point} A Premier sommet du triangle\n * @param {Point} B Deuxime sommet du triangle\n * @param {Point} C Troisime sommet du triangle\n * @param {string} [nom=''] Nom du centre\n * @param {string} [positionLabel = 'above'] Position du nom par rapport au point\n * @example G = centreCercleCirconscrit(F,C,N)\n * // Cre G, le centre du cercle circonscrit au triangle FCN,sans tre nomm.\n * @example G = centreCercleCirconscrit(F,C,N,'G','below')\n * // Cre G, le centre du cercle circonscrit au triangle FCN, en notant G sous le point, s'il est trac et labellis.\n * @return {Point}\n * @author Rmi Angot\n */\n// JSDOC Validee par EE Juin 2022\nexport function centreCercleCirconscrit(\n  A: PointAbstrait,\n  B: PointAbstrait,\n  C: PointAbstrait,\n  nom = '',\n  positionLabel = 'above',\n) {\n  const d = mediatrice(A, B)\n  const e = mediatrice(B, C)\n  const p = pointIntersectionDD(d, e)\n  const x = p.x\n  const y = p.y\n  return new Point(x, y, nom, positionLabel)\n}\n","import earcut from 'earcut'\nimport {\n  colorToLatexOrHTML,\n  ObjetMathalea2D,\n  type NestedObjetMathalea2dArray,\n} from '../../modules/2dGeneralites'\nimport { context } from '../../modules/context'\nimport { randint } from '../../modules/outils'\nimport { Point3d } from '../3d/3dProjectionMathalea2d/elements'\nimport { arrondi, rangeMinMax } from '../outils/nombres'\nimport { lettreDepuisChiffre } from '../outils/outilString'\nimport { codageAngleDroit } from './angles'\nimport { codageSegments } from './codages'\nimport { Point, point, pointAdistance, pointSurSegment } from './points'\nimport { isPointsAbstraits, PointAbstrait } from './points-abstraits'\nimport { longueur, segment, Vecteur, vecteur } from './segmentsVecteurs'\nimport {\n  Latex2d,\n  LatexParCoordonnees,\n  latexParCoordonnees,\n  TexteParPoint,\n  texteParPoint,\n  texteParPosition,\n} from './textes'\nimport { homothetie, rotation, translation } from './transformations'\nimport { aireTriangle } from './triangle'\n\ntype BinomeXY = { x: number; y: number }\ntype BinomesXY = BinomeXY[]\n\n/**\n * Cre le barycentre d'un polygone\n * @param {Polygone} p Polygone dont on veut crer le barycentre\n * @param {string} [nom = ''] Nom du barycentre\n * @param {string} [positionLabel = 'above'] Position du nom par rapport au point\n * @example G = barycentre(pol) // Cre G, le barycentre du polygone pol, sans lui donner de nom\n * @example G = barycentre(pol,'G','below') // Cre G, le barycentre du polygone pol, en notant G sous le point, s'il est trac et labellis.\n * @author Jean-Claude Lhote\n * @return {Point}\n */\n// JSDOC Validee par EE Juin 2022\nexport function barycentre(p: Polygone, nom = '', positionLabel = 'above') {\n  let sommex = 0\n  let sommey = 0\n  let nbsommets = 0\n  for (const point of p.listePoints) {\n    sommex += point.x\n    sommey += point.y\n    nbsommets++\n  }\n  const x = sommex / nbsommets\n  const y = sommey / nbsommets\n  return new Point(x, y, nom, positionLabel)\n}\n\n/**\n * polyline(A,B,C,D,E) //Trace la ligne brise ABCDE\n *\n * @author Rmi Angot\n */\nexport class Polyline extends ObjetMathalea2D {\n  listePoints: PointAbstrait[]\n  listePoints3d: Point3d[]\n  nom: string\n  stringColor: string\n  constructor(\n    ...points:\n      | (PointAbstrait | Point3d)[]\n      | [(PointAbstrait | Point3d)[], string]\n  ) {\n    super()\n    this.epaisseur = 1\n    this.pointilles = 0\n    this.opacite = 1\n    if (Array.isArray(points[0])) {\n      // Si le premier argument est un tableau\n      this.listePoints = points[0].filter((el) => el instanceof PointAbstrait)\n      this.listePoints3d = points[0].filter((el) => el instanceof Point3d)\n      this.stringColor = String(points[1]) // alors le deuxime est un string\n      this.color = colorToLatexOrHTML(String(points[1]))\n    } else {\n      // On n'a que des points\n      this.listePoints = points.filter((el) => el instanceof PointAbstrait)\n      this.listePoints3d = points.filter((el) => el instanceof Point3d)\n      this.color = colorToLatexOrHTML('black')\n      this.stringColor = 'black'\n    }\n    let xmin = 1000\n    let xmax = -1000\n    let ymin = 1000\n    let ymax = -1000\n    for (const unPoint of this.listePoints) {\n      if (unPoint.typeObjet !== 'point')\n        window.notify('Polyline : argument invalide', { ...points })\n      xmin = Math.min(xmin, unPoint.x)\n      xmax = Math.max(xmax, unPoint.x)\n      ymin = Math.min(ymin, unPoint.y)\n      ymax = Math.max(ymax, unPoint.y)\n    }\n    this.bordures = [xmin, ymin, xmax, ymax]\n    this.nom = ''\n    if (this.listePoints.length < 15) {\n      // Ne nomme pas les lignes brises trop grandes (pratique pour les courbes de fonction)\n      for (const point of this.listePoints) {\n        this.nom += point.nom\n      }\n      for (const point of this.listePoints3d) {\n        this.nom += point.label\n      }\n    }\n  }\n\n  svg(coeff: number) {\n    if (this.epaisseur !== 1) {\n      this.style += ` stroke-width=\"${this.epaisseur}\" `\n    }\n    switch (this.pointilles) {\n      case 1:\n        this.style += ' stroke-dasharray=\"6 10\" '\n        break\n      case 2:\n        this.style += ' stroke-dasharray=\"6 3\" '\n        break\n      case 3:\n        this.style += ' stroke-dasharray=\"3 2 6 2 \" '\n        break\n      case 4:\n        this.style += ' stroke-dasharray=\"1 2\" '\n        break\n      case 5:\n        this.style += ' stroke-dasharray=\"5 5\" '\n        break\n    }\n\n    if (this.opacite !== 1) {\n      this.style += ` stroke-opacity=\"${this.opacite}\" `\n    }\n    let binomeXY = ''\n    for (const point of this.listePoints) {\n      const X = point.xSVG(coeff)\n      const Y = point.ySVG(coeff)\n      binomeXY += `${X},${Y} `\n    }\n    for (const point of this.listePoints3d) {\n      const X = point.c2d.xSVG(coeff)\n      const Y = point.c2d.ySVG(coeff)\n      binomeXY += `${X},${Y} `\n    }\n    return `<polyline points=\"${binomeXY}\" fill=\"none\" stroke=\"${this.color[0]}\" ${this.style} id=\"${this.id}\" />`\n  }\n\n  tikz() {\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color=${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width = ${this.epaisseur}`)\n    }\n    switch (this.pointilles) {\n      case 1:\n        tableauOptions.push(' dash dot ')\n        break\n      case 2:\n        tableauOptions.push(' densely dash dot dot ')\n        break\n      case 3:\n        tableauOptions.push(' dash dot dot ')\n        break\n      case 4:\n        tableauOptions.push(' dotted ')\n        break\n      case 5:\n        tableauOptions.push(' dashed ')\n        break\n    }\n\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity = ${this.opacite}`)\n    }\n\n    let optionsDraw = ''\n    if (tableauOptions.length > 0) {\n      optionsDraw = '[' + tableauOptions.join(',') + ']'\n    }\n    let binomeXY = ''\n    for (const point of this.listePoints) {\n      binomeXY += `(${arrondi(point.x)},${arrondi(point.y)})--`\n    }\n    binomeXY = binomeXY.substr(0, binomeXY.length - 2)\n    return `\\\\draw${optionsDraw} ${binomeXY};`\n  }\n\n  svgml(coeff: number, amp: number) {\n    let code = ''\n    let s\n    for (let k = 1; k < this.listePoints.length; k++) {\n      s = segment(\n        this.listePoints[k - 1],\n        this.listePoints[k],\n        this.stringColor,\n      )\n      s.epaisseur = this.epaisseur\n      s.opacite = this.opacite\n      code += s.svgml(coeff, amp)\n    }\n    return code\n  }\n\n  tikzml(amp: number) {\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color=${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width = ${this.epaisseur}`)\n    }\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity = ${this.opacite}`)\n    }\n    tableauOptions.push(\n      `decorate,decoration={random steps , segment length=3pt, amplitude = ${amp}pt}`,\n    )\n\n    let optionsDraw = ''\n    if (tableauOptions.length > 0) {\n      optionsDraw = '[' + tableauOptions.join(',') + ']'\n    }\n    let binomeXY = ''\n    for (const point of this.listePoints) {\n      binomeXY += `(${arrondi(point.x)},${arrondi(point.y)})--`\n    }\n    binomeXY = binomeXY.substr(0, binomeXY.length - 2)\n    return `\\\\draw${optionsDraw} ${binomeXY};`\n  }\n}\n\n/**\n * Trace une ligne brise\n * @example polyline(A,B,C,D,E) // Trace la ligne brise ABCDE en noir\n * @example polyline([A,B,C,D,E],'blue') // Trace la ligne brise ABCDE en bleu\n * @example polyline([A,B,C,D,E],'#f15929') // Trace la ligne brise ABCDE en orange (code couleur HTML : #f15929)\n * @returns Polyline\n * @author Rmi Angot\n */\nexport function polyline(\n  ...args: (PointAbstrait | Point3d)[] | [(PointAbstrait | Point3d)[], string]\n) {\n  return new Polyline(...args)\n}\n\n/*\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%% LES POLYGONES %%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n*/\n/**\n * polygone(A,B,C,D,E) //Trace ABCDE\n * polygone([A,B,C,D],\"blue\") // Trace ABCD en bleu\n * polygone([A,B,C,D],\"blue\",\"red\",\"green\") // Trace ABCD en bleu, rempli en rouge et hachur en vert.\n * @property {Point[]} listePoints\n * @property {string[]} color\n * @property {string[]} couleurDeRemplissage\n * @property {string[]} couleurDesHachures\n * @property {number} epaisseurDesHachures\n * @property {number} distanceDesHachures\n * @property {number} opaciteDeRemplissage\n * @property {boolean|string} hachures\n * @property {number[]} bordures\n * @property {string} nom\n * @property {string} id\n * @property {string} style\n * @property {number} opacite\n * @property {number} epaisseur\n * @property {number} pointilles\n *\n * @author Rmi Angot*\n * @class\n */\nexport class Polygone extends ObjetMathalea2D {\n  couleurDeRemplissage: string[]\n  opaciteDeRemplissage: number\n  couleurDesHachures: string[]\n  distanceDesHachures: number\n  epaisseurDesHachures: number\n  hachures: boolean | string\n  listePoints: PointAbstrait[]\n  nom: string\n  pointilles: number\n  _triangulation: [PointAbstrait, PointAbstrait, PointAbstrait][]\n  _flat: number[]\n  _aire: number\n  stringColor: string\n  readonly perimetre: number\n  constructor(...points: PointAbstrait[] | [PointAbstrait[], string?]) {\n    super()\n    this.epaisseurDesHachures = 1\n    this.distanceDesHachures = 10\n    this.couleurDeRemplissage = colorToLatexOrHTML('none')\n    this.opaciteDeRemplissage = 0.5\n    this.epaisseur = 1\n    this.opacite = 1\n    this.pointilles = 0\n    this._triangulation = []\n    this._flat = []\n    this._aire = 0\n    this.stringColor = 'black'\n    if (Array.isArray(points[0])) {\n      // Si le premier argument est un tableau\n      this.listePoints = points[0]\n      if (points[1]) {\n        this.color = colorToLatexOrHTML(String(points[1]))\n        this.stringColor = String(points[1])\n      }\n      if (points[2]) {\n        this.couleurDeRemplissage = colorToLatexOrHTML(String(points[2]))\n      } else {\n        this.couleurDeRemplissage = colorToLatexOrHTML('none')\n      }\n      if (points[3]) {\n        this.couleurDesHachures = colorToLatexOrHTML(String(points[3]))\n        this.hachures = true\n      } else {\n        this.couleurDesHachures = colorToLatexOrHTML('black')\n        this.hachures = false\n      }\n      this.nom = this.listePoints.map((el) => el.nom).join('')\n    } else {\n      if (typeof points[points.length - 1] === 'string') {\n        this.color = colorToLatexOrHTML(String(points[points.length - 1]))\n        this.stringColor = String(points[points.length - 1])\n        points.splice(points.length - 1, 1)\n      }\n      this.listePoints = points.filter((el) => el instanceof PointAbstrait)\n      this.nom = this.listePoints.map((el) => el.nom).join('')\n      this.couleurDeRemplissage = colorToLatexOrHTML('none')\n      this.couleurDesHachures = colorToLatexOrHTML('none') // Rajout EE du 22/02/2024 pour 6N22 cas 3\n      this.hachures = false\n    }\n    let xmin = 1000\n    let xmax = -1000\n    let ymin = 1000\n    let ymax = -1000\n    this.bordures = [xmin, ymin, xmax, ymax]\n    for (const unPoint of this.listePoints) {\n      if (unPoint.typeObjet !== 'point')\n        window.notify('Polygone : argument invalide', { ...points })\n      xmin = Math.min(xmin, unPoint.x)\n      xmax = Math.max(xmax, unPoint.x)\n      ymin = Math.min(ymin, unPoint.y)\n      ymax = Math.max(ymax, unPoint.y)\n    }\n    this.bordures = [xmin, ymin, xmax, ymax]\n    let p = 0\n    for (let i = 0; i < this.listePoints.length; i++) {\n      p += longueur(\n        this.listePoints[i],\n        this.listePoints[(i + 1) % this.listePoints.length],\n      )\n    }\n    this.perimetre = p\n  }\n\n  binomesXY(coeff: number) {\n    let liste = ''\n    for (const point of this.listePoints) {\n      liste += `${point.xSVG(coeff)},${point.ySVG(coeff)} `\n    }\n    return liste\n  }\n\n  get flat() {\n    if (this._flat.length === 0) {\n      this._flat = polygoneToFlatArray(this)\n    }\n    return this._flat\n  }\n\n  get triangulation() {\n    if (this._triangulation.length === 0) {\n      const trianglesIndices = earcut(this.flat)\n      this._triangulation = []\n      for (let i = 0; i < trianglesIndices.length; i += 3) {\n        this._triangulation.push([\n          point(\n            this.flat[trianglesIndices[i] * 2],\n            this.flat[trianglesIndices[i] * 2 + 1],\n          ),\n          point(\n            this.flat[trianglesIndices[i + 1] * 2],\n            this.flat[trianglesIndices[i + 1] * 2 + 1],\n          ),\n          point(\n            this.flat[trianglesIndices[i + 2] * 2],\n            this.flat[trianglesIndices[i + 2] * 2 + 1],\n          ),\n        ])\n      }\n    }\n    return this._triangulation\n  }\n\n  get aire() {\n    if (this._aire === 0) {\n      const triangles = this.triangulation\n      this._aire = 0\n      for (let i = 0; i < triangles.length; i++) {\n        this._aire += Number(aireTriangle(polygone(triangles[i])))\n      }\n    }\n    return this._aire\n  }\n\n  svg(coeff: number) {\n    if (this.epaisseur !== 1) {\n      this.style += ` stroke-width=\"${this.epaisseur}\" `\n    }\n    if (this.opacite !== 1) {\n      this.style += ` stroke-opacity=\"${this.opacite}\" `\n    }\n    switch (this.pointilles) {\n      case 1:\n        this.style += ' stroke-dasharray=\"6 10\" '\n        break\n      case 2:\n        this.style += ' stroke-dasharray=\"6 3\" '\n        break\n      case 3:\n        this.style += ' stroke-dasharray=\"3 2 6 2 \" '\n        break\n      case 4:\n        this.style += ' stroke-dasharray=\"1 2\" '\n        break\n      case 5:\n        this.style += ' stroke-dasharray=\"5 5\" '\n        break\n    }\n\n    if (this.hachures) {\n      if (this.couleurDeRemplissage.length < 1) {\n        this.couleurDeRemplissage = colorToLatexOrHTML('none')\n      }\n      return (\n        pattern({\n          motif: String(this.hachures),\n          id: String(this.id),\n          distanceDesHachures: this.distanceDesHachures,\n          epaisseurDesHachures: this.epaisseurDesHachures,\n          couleurDesHachures: this.couleurDesHachures[0] || 'black',\n          couleurDeRemplissage: this.couleurDeRemplissage[0],\n          opaciteDeRemplissage: this.opaciteDeRemplissage,\n        }) +\n        `<polygon points=\"${this.binomesXY(coeff)}\" stroke=\"${this.color[0]}\" ${this.style} id=\"${this.id}\" fill=\"url(#pattern${this.id})\" />`\n      )\n    } else {\n      if (\n        this.couleurDeRemplissage[0] === '' ||\n        this.couleurDeRemplissage[0] === undefined\n      ) {\n        this.style += ' fill=\"none\" '\n      } else {\n        this.style += ` fill=\"${this.couleurDeRemplissage[0]}\" `\n        this.style += ` fill-opacity=\"${this.opaciteDeRemplissage}\" `\n      }\n      if (this.opacite !== 1) {\n        this.style += ` stroke-opacity=\"${this.opacite}\" `\n      }\n      return `<polygon points=\"${this.binomesXY(coeff)}\" stroke=\"${this.color[0]}\" ${this.style} id=\"${this.id}\" />`\n    }\n  }\n\n  tikz() {\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color=${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width = ${this.epaisseur}`)\n    }\n    switch (this.pointilles) {\n      case 1:\n        tableauOptions.push(' dash dot ')\n        break\n      case 2:\n        tableauOptions.push(' densely dash dot dot ')\n        break\n      case 3:\n        tableauOptions.push(' dash dot dot ')\n        break\n      case 4:\n        tableauOptions.push(' dotted ')\n        break\n      case 5:\n        tableauOptions.push(' dashed ')\n        break\n    }\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity=${this.opacite}`)\n    }\n\n    if (\n      this.couleurDeRemplissage[1] !== '' &&\n      this.couleurDeRemplissage[1] !== 'none'\n    ) {\n      tableauOptions.push(\n        `preaction={fill,color = ${this.couleurDeRemplissage[1]}${this.opaciteDeRemplissage !== 1 ? ', opacity = ' + this.opaciteDeRemplissage : ''}}`,\n      )\n    }\n\n    if (this.hachures) this.hachures = 'dotted'\n    if (this.hachures != null && typeof this.hachures === 'string') {\n      tableauOptions.push(\n        pattern({\n          motif: this.hachures,\n          id: String(this.id),\n          distanceDesHachures: this.distanceDesHachures,\n          couleurDesHachures: this.couleurDesHachures[1],\n          couleurDeRemplissage: this.couleurDeRemplissage[1],\n          opaciteDeRemplissage: this.opaciteDeRemplissage,\n        }),\n      )\n    }\n    let optionsDraw = ''\n    if (tableauOptions.length > 0) {\n      optionsDraw = '[' + tableauOptions.join(',') + ']'\n    }\n\n    let binomeXY = ''\n\n    for (const point of this.listePoints) {\n      binomeXY += `(${arrondi(point.x)},${arrondi(point.y)})--`\n    }\n    const lines = `\\\\draw${optionsDraw} ${binomeXY}cycle;`\n\n    return lines\n  }\n\n  svgml(coeff: number, amp: number) {\n    let code = ''\n    let segmentCourant\n    let A, B\n    for (let k = 1; k <= this.listePoints.length; k++) {\n      B = this.listePoints[k % this.listePoints.length]\n      A = this.listePoints[k - 1]\n      segmentCourant = segment(A, B, this.stringColor)\n      segmentCourant.epaisseur = this.epaisseur\n      segmentCourant.opacite = this.opacite\n      code += segmentCourant.svgml(coeff, amp)\n    }\n    return code\n  }\n\n  tikzml(amp: number) {\n    let code = ''\n    let segmentCourant\n    let A, B\n    for (let k = 1; k <= this.listePoints.length; k++) {\n      B = this.listePoints[k % this.listePoints.length]\n      A = this.listePoints[k - 1]\n      segmentCourant = segment(A, B, this.stringColor)\n      segmentCourant.epaisseur = this.epaisseur\n      segmentCourant.opacite = this.opacite\n      code += '\\t' + segmentCourant.tikzml(amp) + '\\n'\n    }\n    return code\n  }\n}\n\n/**\n * Proprits possibles : .color, .opacite, .epaisseur, .couleurDeRemplissage, .opaciteDeRemplissage, .hachures (un string correspondant  l'un des motifs de pattern), .distanceDesHachures, .epaisseurDesHachures,.couleurDesHachures\n * @return {Polygone} objet Polygone\n * @example polygone(A,B,C,D,E) //Trace ABCDE\n * @example polygone([A,B,C,D],\"blue\") // Trace ABCD en bleu\n * @example polygone([A,B,C,D],\"#f15929\") // Trace ABCD en orange (code couleur HTML : #f15929)\n * @property {PointAbstrait[]} listePoints\n * @property {string[]} color\n * @property {string[]} couleurDeRemplissage\n * @property {string[]} couleurDesHachures\n * @property {number} epaisseurDesHachures\n * @property {number} distanceDesHachures\n * @property {number} opaciteDeRemplissage\n * @property {boolean|string} hachures\n * @property {number[]} bordures\n * @property {string} nom\n * @property {string} id\n * @property {string} style\n * @property {number} opacite\n * @property {number} epaisseur\n * @property {number} pointilles\n *\n * @author Rmi Angot\n */\nexport function polygone(\n  ...args: PointAbstrait[] | [PointAbstrait[], string?]\n) {\n  return new Polygone(...args)\n}\n\n/**\n * Cre un groupe d'objets contenant le polygone et ses sommets\n * @param  {...any} args\n * @return {array} [polygone,sommets]\n * Si le dernier argument est un nombre, celui-ci sera utilis pour fixer la distance entre le sommet et le label (par dfaut 0.5)\n * @exemple [poly, sommets] = polygoneAvecNom(A, B, C, D) // o A, B, C, D sont des objets Point\n */\nexport function polygoneAvecNom(\n  ...args: (PointAbstrait | number)[]\n): [Polygone, NommePolygone] {\n  let k = 0.5\n  if (typeof args[args.length - 1] === 'number') {\n    k = Number(args[args.length - 1])\n    args.splice(args.length - 1, 1)\n  }\n  if (!isPointsAbstraits(args)) {\n    window.notify(\n      'polygoneAvecNom : les arguments doivent tre des objets PointAbstrait',\n      { args },\n    )\n    return [polygone(), nommePolygone(polygone())]\n  }\n  const p = polygone(...args)\n  let nom = ''\n  args.forEach((el: PointAbstrait) => {\n    nom += el.nom + ','\n  })\n  nom = nom.substring(0, nom.length - 1)\n  const sommets = nommePolygone(p, nom, k)\n  sommets.bordures = [0, 0, 0, 0]\n  sommets.bordures[0] = p.bordures[0] - 1 - k\n  sommets.bordures[1] = p.bordures[1] - 1 - k\n  sommets.bordures[2] = p.bordures[2] + 1 + k\n  sommets.bordures[3] = p.bordures[3] + 1 + k\n  return [p, sommets]\n}\n\n/**\n * @description en une fois tous les sommets d'un polygone avec le tableau de string fourni\n * attention si on passe un string comme 'ABCD' a fonctionne aussi...\n * Si on veut des noms de points  plus de 1 caractre, il faut soit les passer en tableau soit les sparer par des virgules au sein du string\n * @example renommePolygone(p, \"A',B',C',D'\") ou renommePolygone(p, [\"A'\",\"B'\",\"C'\",\"D'\"])\n */\nexport function renommePolygone(p: Polygone, noms: string | string[]) {\n  noms =\n    typeof noms === 'string'\n      ? noms.includes(',')\n        ? noms.split(',')\n        : noms\n      : noms\n  for (let i = 0; i < p.listePoints.length; i++) {\n    if (noms[i] !== undefined) {\n      p.listePoints[i].nom = noms[i]\n    }\n  }\n}\n\n/**\n * Trace le polygone rgulier direct  n cts qui a pour ct [AB]\n * Pour tracer le polygone rgulier indirect de ct [AB], on iversera A et B\n * @param {Point} A\n * @param {Point} B\n * @param {number} n Nombre de cts\n * @param {string} [color = 'black'] Couleur de l'arc ou 'none' : du type 'blue' ou du type '#f15929'\n * @return {Polygone}\n * @author Rmi Angot\n **/\nexport function polygoneRegulier(\n  A: Point,\n  B: Point,\n  n: number,\n  color = 'black',\n) {\n  const listePoints = [A, B]\n  for (let i = 1; i < n - 1; i++) {\n    listePoints[i + 1] = rotation(\n      listePoints[i - 1],\n      listePoints[i],\n      -180 + 360 / n,\n    )\n  }\n  return new Polygone(listePoints, color)\n}\n\n/**\n * Trace un carr\n * @param {Point} A Un sommet du carr\n * @param {Point} B Un sommet du carr, conscutif au prcdent\n * @param {string} [color = 'black'] Couleur de l'arc ou 'none' : du type 'blue' ou du type '#f15929'\n * @example carre(M,N)\n *  // Trace le carr noir de sommets conscutifs M et N dans le sens direct\n * @example carre(N,M)\n *  // Trace le carr noir de sommets conscutifs M et N dans le sens indirect\n * @example carre(M,N,'blue')\n *  // Trace le carr bleu de sommets conscutifs M et N dans le sens direct\n * @return {Polygone}\n * @author Rmi Angot\n * JSDOC Validee par EE Juin 2022\n *\n */\nexport function carre(A: Point, B: Point, color = 'black') {\n  return polygoneRegulier(A, B, 4, color)\n}\n\n/**\n * polygoneRegulierParCentreEtRayon(O,r,n) //Trace le polygone rgulier  n cts et de rayon r\n * @returns {Polygone} Objet Mathalea2d\n * @author Rmi Angot\n */\nexport function polygoneRegulierParCentreEtRayon(\n  O: Point,\n  r: number,\n  n: number,\n  color = 'black',\n) {\n  const p = []\n  p[0] = point(O.x + r, O.y)\n  for (let i = 1; i < n; i++) {\n    p[i] = rotation(p[i - 1], O, -360 / n)\n  }\n  return polygone(p, color)\n}\n\n/**\n * Un constructeur de boites rectangulaires.\n * remplace l'objet Mathalea2d Boite()\n * On construit une Boite de base puis on peut\n * Ajouter des couleurs avec la mthode addColor()\n * Ajouter du texte ou du latex dedans avec addTextIn()\n * Enfin, la mthode render() retourne l'objet Mathalea2d ou un array d'objet Mathalea2d pour la fonction mathalea2d()\n * Exemple : const maBoite = new BoiteBuilder({xMin:0, yMin:0, xMax:3, yMax: 2}).addTextIn({textIn: '\\\\dfrac{1}{2}'}).render()\n */\nexport class BoiteBuilder {\n  xMin: number\n  xMax: number\n  yMin: number\n  yMax: number\n  forme: Polygone\n  text!: LatexParCoordonnees | TexteParPoint | Latex2d\n  constructor({\n    xMin,\n    xMax,\n    yMin,\n    yMax,\n  }: {\n    xMin: number\n    xMax: number\n    yMin: number\n    yMax: number\n  }) {\n    this.xMin = xMin\n    this.xMax = xMax\n    this.yMin = yMin\n    this.yMax = yMax\n    this.forme = polygone([\n      point(xMin, yMin),\n      point(xMax, yMin),\n      point(xMax, yMax),\n      point(xMin, yMax),\n    ])\n  }\n\n  /**\n   * l'objet ou l'array d'objet pour la fonction mathalea2d()\n   * @return {[Polygone|Vide2d,LatexParCoordonnees|TexteParPoint)]|Polygone}\n   */\n  render() {\n    return this.text ? [this.forme, this.text] : this.forme\n  }\n\n  /**\n   * La mthode retourne l'objet afin de la rendre chanable\n   * @param {Object} params\n   * @param {string} [params.color]\n   * @param {string} [params.colorBackground]\n   * @param {number} [params.opacity]\n   * @param {number} [params.backgroudOpacity]\n   * @return {BoiteBuilder}\n   */\n  addColor({\n    color,\n    colorBackground,\n    opacity,\n    backgroudOpacity,\n  }: {\n    color?: string\n    colorBackground?: string\n    opacity?: number\n    backgroudOpacity?: number\n  }) {\n    this.forme.color = colorToLatexOrHTML(color ?? 'black')\n    this.forme.opacite = opacity ?? 1\n    this.forme.couleurDeRemplissage = colorToLatexOrHTML(\n      colorBackground ?? 'none',\n    )\n    this.forme.opaciteDeRemplissage = backgroudOpacity ?? 0.7\n    return this\n  }\n\n  /**\n   * La mthode retourne l'objet afin de la rendre chanable\n   * @param {string} textIn si contient '\\\\' alors c'est une commande latex rendue par latexParCoordonnees()\n   * @param {string} color\n   * @param {number} opacity\n   * @param {number} size (facteur d'agrandissement ou de rduction 1 par dfaut)\n   * @return {BoiteBuilder}\n   */\n  addTextIn({\n    textIn,\n    color,\n    opacity,\n    size,\n  }: {\n    textIn: string\n    color?: string\n    opacity?: number\n    size?: number\n  }) {\n    if (typeof textIn !== 'string') {\n      window.notify(\n        'BoiteBuilder.addTextIn() requiert un texteIn de type string ',\n        { textIn },\n      )\n    }\n    if (textIn.length > 0) {\n      this.text = textIn.includes('\\\\')\n        ? latexParCoordonnees(\n            textIn,\n            (this.xMin + this.xMax) / 2,\n            (this.yMin + this.yMax) / 2,\n            color ?? 'black',\n            50,\n            0,\n            '',\n            (size ?? 1) * 10,\n          )\n        : texteParPosition(\n            textIn,\n            (this.xMin + this.xMax) / 2,\n            (this.yMin + this.yMax) / 2,\n            0,\n            color ?? 'black',\n            size,\n          )\n      this.text.opacite = opacity ?? 1\n    }\n    return this\n  }\n}\n\n/**\n * @param {Polygone} p\n * @return {number[]} retourne la liste des coordonnes des sommets de p dans un seul tableau.\n * @author Jean-Claude Lhote\n */\nexport function polygoneToFlatArray(p: Polygone) {\n  const flatArray = []\n  for (let i = 0; i < p.listePoints.length; i++) {\n    flatArray.push(p.listePoints[i].x, p.listePoints[i].y)\n  }\n  return flatArray\n}\n\n/**\n *\n * @param {number[]} [data = []] tableau  une seule dimension (flat array) contenant les coordonnes des sommets (extrieurs et intrieurs) du polygone\n * @param {number[]} [holes = []] tableau  une seule dimension contenant les indices des points qui dmarrent un 'trou' dans le tableau data (exemple : holes = [4, 8] indique que les points 4  7 dfinissent un trou ainsi que 8 et suivants, donc les coordonnes 8  15 et 16  ...(ne pas oublier que 1 point = 2 coordonnes))\n * @param {string} [noms = ''] chaine donnant les noms des sommets\n * @param {string} [color = 'black'] couleur du polygone\n * @param {string} [couleurDeRemplissage = ' blue'] la couleur de remplissage\n * @param {string} [couleurDeFond = 'white'] la couleur des trous\n * @class\n */\nexport class PolygoneATrous extends ObjetMathalea2D {\n  _aire: number\n  _triangulation: Polygone[]\n  contour: Polygone\n  trous: Polygone[]\n  colorString: string\n  triangles: number[]\n  data: number[]\n  holes: number[]\n  stringColor: string\n  stringCouleurDeFond: string\n  stringCouleurDeRemplissage: string\n  constructor({\n    data = [],\n    holes = [],\n    noms = '',\n    color = 'black',\n    couleurDeRemplissage = 'blue',\n    couleurDeFond = 'white',\n  }) {\n    super()\n    this.colorString = color\n    this.data = data\n    this.holes = holes\n    this.triangles = earcut(data, holes) // on cre le pavage de triangles grce  Mapbox/earcut\n\n    this._triangulation = []\n    this._aire = 0\n    this.stringColor = color\n\n    const sommetsContour = [] // on cre le polygone extrieur\n    for (let i = 0; i < 2 * holes[0]; i += 2) {\n      sommetsContour.push(point(data[i], data[i + 1]))\n      if (noms.length >= data.length << 1) {\n        sommetsContour[i >> 1].nom = noms[i << 1]\n      }\n    }\n    // On cherche les bordures\n    for (\n      let i = 0, xmin = 1000, xmax = -1000, ymin = 1000, ymax = -1000;\n      i < data.length;\n      i += 2\n    ) {\n      xmin = Math.min(xmin, data[i])\n      xmax = Math.max(xmax, data[i])\n      ymin = Math.min(ymin, data[i + 1])\n      ymax = Math.max(ymax, data[i + 1])\n      this.bordures = [xmin, ymin, xmax, ymax]\n    }\n    this.contour = polygone(...sommetsContour)\n    this.trous = []\n    this.stringCouleurDeRemplissage = couleurDeRemplissage\n    this.contour.couleurDeRemplissage = colorToLatexOrHTML(couleurDeRemplissage)\n    this.contour.color = colorToLatexOrHTML(this.stringColor)\n    this.stringCouleurDeFond = couleurDeFond\n    const trous: Point[][] = []\n    let trou: Point\n    let trouPol: Polygone\n    for (let i = 0; i < holes.length; i++) {\n      trous[i] = []\n      for (\n        let j = holes[i] * 2;\n        j < (i !== holes.length - 1 ? holes[i + 1] * 2 : data.length);\n        j += 2\n      ) {\n        trou = point(data[j], data[j + 1])\n        if (noms.length >= data.length >> 1) {\n          trou.nom = noms[j >> 1]\n        }\n        trous[i].push(trou)\n      }\n      trouPol = polygone(...trous[i])\n      trouPol.color = colorToLatexOrHTML(this.stringColor)\n      trouPol.couleurDeRemplissage = colorToLatexOrHTML(\n        this.stringCouleurDeFond,\n      )\n      this.trous.push(trouPol)\n    }\n  }\n\n  get triangulation(): Polygone[] {\n    if (this._triangulation === null) {\n      this._triangulation = []\n      for (let i = 0, triangle; i < this.triangles.length; i += 3) {\n        triangle = polygone([\n          point(\n            this.data[this.triangles[i] * 2],\n            this.data[this.triangles[i] * 2 + 1],\n          ),\n          point(\n            this.data[this.triangles[i + 1] * 2],\n            this.data[this.triangles[i + 1] * 2 + 1],\n          ),\n          point(\n            this.data[this.triangles[i + 2] * 2],\n            this.data[this.triangles[i + 2] * 2 + 1],\n          ),\n        ])\n        triangle.color = colorToLatexOrHTML(this.stringColor)\n        triangle.couleurDeRemplissage = colorToLatexOrHTML('none')\n        this._triangulation.push(triangle)\n      }\n    }\n    return this._triangulation\n  }\n\n  get aire(): number {\n    if (this._aire === null) {\n      this._aire = this.contour.aire\n      for (let i = 0; i < this.trous.length; i++) {\n        this._aire -= this.trous[i].aire\n      }\n    }\n    return this._aire\n  }\n\n  svg(coeff: number) {\n    let code = this.contour.svg(coeff)\n    for (let i = 0; i < this.trous.length; i++) {\n      code += this.trous[i].svg(coeff)\n    }\n    return code\n  }\n\n  tikz() {\n    let code = this.contour.tikz()\n    for (let i = 0; i < this.trous.length; i++) {\n      code += '\\n\\t' + this.trous[i].tikz()\n    }\n    return code\n  }\n}\n\n/**\n * Cet objet permet de crer un polygone avec une surface contenant des 'trous' eux-mmes polygonaux\n * cerise sur le gteau, la proprit this.triangulation fournit une liste de triangles pavant le polygone\n * @param {number[]} [data = []] contient la liste des coordonnes des sommets (contour puis trous) 2 coordonnes par point dans l'ordre abscisse, ordonne\n * @param {number[]}  [holes = []] tableau  une seule dimension contenant les indices des points qui dmarrent un 'trou' dans le tableau data (exemple : holes = [4, 8] indique que les points 4  7 dfinissent un trou ainsi que 8 et suivants, donc les coordonnes 8  15 et 16  ...(ne pas oublier que 1 point = 2 coordonnes))\n * @param {string} [noms = ''] contient les noms des sommets\n * @param {string} [color = 'black'] est la couleur des bords\n * @param {string} [couleurDeRemplissage = 'blue'] est la couleur de la surface\n * @param {string} [couleurDeFond = 'white'] est la couleur de remplissage des trous\n * @return {PolygoneaTrou} un polygone  trous (ou pas : il peut ne pas y avoir de trou !)\n */\nexport function polygoneATrous({\n  data = [],\n  holes = [],\n  noms = '',\n  color = 'black',\n  couleurDeRemplissage = 'blue',\n  couleurDeFond = 'white',\n}) {\n  return new PolygoneATrous({\n    data,\n    holes,\n    noms,\n    color,\n    couleurDeRemplissage,\n    couleurDeFond,\n  })\n}\n\n/*********************************************/\n/**\n * fonction qui retourne le paralllogramme ABCD dont on donne les 3 premiers points A, B et C\n *\n * @param {string} nom\n * @param {Point} A\n * @param {Point} B\n * @param {Point} C\n * @return {PolygoneAvecNom}\n */\nexport function parallelogramme3points(\n  nom: string,\n  A: Point,\n  B: Point,\n  C: Point,\n) {\n  const D = translation(A, vecteur(B, C), nom[3])\n  A.nom = nom[0]\n  B.nom = nom[1]\n  C.nom = nom[2]\n  return polygoneAvecNom(A, B, C, D)\n}\n\n/**\n * parallelogramme2points1hauteur(A,B,5) renvoie un paralllogramme ABCD de base [AB] et de hauteur h\n * parallelogramme2points1hauteur(A,7,5) renvoie un paralllogramme ABCD de base 7cm (le point B est choisi sur le cercle de centre A et de rayon 7cm) et de hauteur h\n *\n * @param {String} nom\n * @param {objet} A\n * @param {objet} B\n * @param {number} h\n * @return {PolygoneAvecNom}\n */\nexport function parallelogramme2points1hauteur(\n  nom: string,\n  A: Point,\n  B: Point,\n  h: number,\n) {\n  if (typeof B === 'number') {\n    B = pointAdistance(A, B, randint(-180, 180))\n  }\n  A.nom = nom[0]\n  B.nom = nom[1]\n  let H = rotation(B, A, 90)\n  H = pointSurSegment(A, H, h)\n  const D = translation(\n    H,\n    homothetie(\n      vecteur(A, B),\n      A,\n      randint(-5, 5, rangeMinMax(-2, 2)) / 10,\n    ) as Vecteur,\n    nom[3],\n  )\n  const C = translation(D, vecteur(A, B), nom[2])\n  return polygoneAvecNom(A, B, C, D)\n}\n\n/**\n * Construit un rectangle  partir d'un point A et de deux longueurs\n * @param {Point} A\n * @param {number} longueur\n * @param {number} largeur\n * @param {object} options\n * @param {string} [options.nom] noms des sommets\n * @param {number} [options.angleRotation] angle de rotation du rectangle\n * @return {PolygoneAvecNom}\n * @example rectangle1Point2Longueurs(A, 5, 3)\n * @example rectangle1Point2Longueurs(A, 5, 3, { nom: 'ABCD' })\n * @example rectangle1Point2Longueurs(A, 5, 3, { angleRotation: 45 })\n * @example rectangle1Point2Longueurs(A, 5, 3, { nom: 'ABCD', angleRotation: 45 })\n * @author Guillaume Valmont d'aprs 6M11 d'Eric Elter\n */\nexport function rectangle1Point2Longueurs(\n  A: Point,\n  longueur: number,\n  largeur: number,\n  options: {\n    nom?: string\n    angleRotation?: number\n    avecCodageSegments?: boolean\n    avecCodagesAnglesDroits?: boolean\n  } = { avecCodageSegments: true, avecCodagesAnglesDroits: true },\n) {\n  const objets: ObjetMathalea2D[] = []\n  const angleRotation = options.angleRotation ?? 0\n  const B = pointAdistance(A, longueur, angleRotation)\n  const C = rotation(pointAdistance(B, largeur, 180 + angleRotation), B, -90)\n  const D = rotation(pointAdistance(A, largeur, angleRotation), A, 90)\n  if (options.nom) {\n    A.nom = options.nom[0]\n    B.nom = options.nom[1]\n    C.nom = options.nom[2]\n    D.nom = options.nom[3]\n  } else {\n    const numA = randint(1, 26)\n    const numB = randint(1, 26, [numA])\n    const numC = randint(1, 26, [numA, numB])\n    const numD = randint(1, 26, [numA, numB, numC])\n    A.nom = lettreDepuisChiffre(numA)\n    B.nom = lettreDepuisChiffre(numB)\n    C.nom = lettreDepuisChiffre(numC)\n    D.nom = lettreDepuisChiffre(numD)\n  }\n  objets.push(...polygoneAvecNom(A, B, C, D))\n  if (options.avecCodageSegments || options.avecCodageSegments === undefined) {\n    // Lorsqu'un objet d'options est pass, le avecCodageSegments: true par dfaut est cras donc s'il n'est pas redfini en false, on le considre comme true\n    objets.push(\n      codageSegments('/', 'red', B, C, D, A),\n      codageSegments('||', 'blue', A, B, C, D),\n    )\n  }\n  if (\n    options.avecCodagesAnglesDroits ||\n    options.avecCodagesAnglesDroits === undefined\n  ) {\n    // Lorsqu'un objet d'options est pass, le avecCodagesAnglesDroits: true par dfaut est cras donc s'il n'est pas redfini en false, on le considre comme true\n    objets.push(\n      codageAngleDroit(A, B, C),\n      codageAngleDroit(D, C, B),\n      codageAngleDroit(A, D, C),\n      codageAngleDroit(B, A, D),\n    )\n  }\n  return objets\n}\n\n/**\n * @description Place les labels passs dans le deuxime paramtre aux sommets du polygone en les plaant aligns avec le barycentre du polygone  une distance fixe du point\n * @description Si les noms peuvent avoir plusieurs caractres, il faudra ajouter des virgules entre chaque nom dans le string pass en argument.\n * @example nommePolygone (p, \"A',B',C',D',E'\", 0.5, 'red')\n * @example nommePolygone (p,'ABCDE',0.5,'red') nomme les sommets du polygone A, B, C, D et E. Les labels sont placs  une distance de 0,5 cm des sommets\n * @author Jean-Claude Lhote\n */\nexport class NommePolygone extends ObjetMathalea2D {\n  poly: Polygone\n  dist: number\n  constructor(p: Polygone, nom = '', k = 0.5, color = 'black', size = 1) {\n    super()\n    this.poly = p\n    this.dist = k\n    this.objets = []\n    const noms = nom.includes(',') ? nom.split(',') : nom\n    for (let i = 0; i < p.listePoints.length; i++) {\n      if (noms.length > 0) p.listePoints[i].nom = noms[i]\n    }\n    const G = barycentre(p)\n    let xMin = 1000\n    let xMax = -1000\n    let yMin = 1000\n    let yMax = -1000\n    for (const pt of p.listePoints) {\n      const P = pointSurSegment(\n        G,\n        pt,\n        longueur(G, pt) +\n          (context.isHtml ? (k * 20) / context.pixelsParCm : k / context.scale),\n      )\n      P.positionLabel = 'center'\n      this.objets.push(texteParPoint(pt.nom, P, 0, color, size, 'milieu', true))\n      xMin = Math.min(xMin, P.x - 0.5)\n      xMax = Math.max(xMax, P.x + 0.5)\n      yMin = Math.min(yMin, P.y - 0.5)\n      yMax = Math.max(yMax, P.y + 0.5)\n    }\n    this.bordures = [xMin, yMin, xMax, yMax]\n  }\n\n  svg(coeff: number) {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.svg(coeff)\n    }\n    return code\n  }\n\n  tikz() {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.tikz()\n    }\n    return code\n  }\n}\n\nexport function nommePolygone(\n  p: Polygone,\n  nom = '',\n  k = 0.5,\n  color = 'black',\n  size = 1,\n) {\n  return new NommePolygone(p, nom, k, color, size)\n}\n\n/**\n *\n * @param {number} index Choix du motif\n * le nom du motif sert dans la fonction pattern\n * @author Jean-Claude Lhote\n */\nexport function motifs(index: number) {\n  switch (index) {\n    case 0:\n      return 'north east lines'\n    case 1:\n      return 'horizontal lines'\n    case 2:\n      return 'vertical lines'\n    case 3:\n      return 'dots'\n    case 4:\n      return 'crosshatch dots'\n    case 5:\n      return 'fivepointed stars'\n    case 6:\n      return 'sixpointed stars'\n    case 7:\n      return 'bricks'\n    case 8:\n      return 'checkerboard'\n    case 9:\n      return 'grid'\n    case 10:\n      return 'crosshatch'\n    default:\n      return 'north east lines'\n  }\n}\n\n/**\n * Gnre du code TikZ pour dessiner un motif de hachures personnalis dans un rectangle.\n *\n * @param params - Objet contenant les paramtres de dessin.\n * @param params.x0 - Coordonne x du coin infrieur gauche.\n * @param params.y0 - Coordonne y du coin infrieur gauche.\n * @param params.x1 - Coordonne x du coin suprieur droit.\n * @param params.y1 - Coordonne y du coin suprieur droit.\n * @param params.distanceDesHachures - Espacement entre les lments du motif (hachures, points...).\n * @param params.couleurDesHachures - Couleur utilise pour dessiner le motif.\n * @param params.motif - Type de motif  dessiner. Valeurs possibles :\n *   - \"north east lines\" : lignes diagonales  45\n *   - \"horizontal lines\" : hachures horizontales\n *   - \"vertical lines\" : hachures verticales\n *   - \"dots\" : points rguliers (taille fixe ~0.05cm)\n *   - \"crosshatch\" : superposition de hachures horizontales et verticales\n *   - \"grid\" : identique  \"crosshatch\"\n *   - \"checkerboard\" : damier avec des carrs de ct `distanceDesHachures`\n *   - \"crosshatch dots\" : grille de points superpose  un quadrillage\n *   - \"fivepointed stars\" : toiles  5 branches disposes en grille.\n *        Modifier `minimum size` dans le code pour ajuster la taille des toiles (par dfaut : 5pt)\n *   - \"sixpointed stars\" : toiles  6 branches, mme principe que ci-dessus.\n *        Modifier `minimum size` ou `star point ratio` pour ajuster style/taille\n *   - \"bricks\" : motif de briques horizontales dcales.\n *        La largeur est `2  distanceDesHachures` et la hauteur est `distanceDesHachures`\n *        Pour des briques plus grandes, augmenter `distanceDesHachures`\n *\n * @author Eric Elter\n * @returns Une chane contenant le code TikZ gnr, ou une chane vide si le motif est inconnu.\n *\n * @deprecated Cette fonction n'est pas recommande pour crer des motifs au sein d'une surface quelconque en tikz\n * car elle ne fait qu'une surface rectangulaire et le fait en ajoutant un clip et un code trs long.\n * Le mme rsultat (hachures, points, toiles...) peut tre obtenu la proprit hachures de l'objet Polygone.\n * les hachures sont gres par la fonction pattern() et retourne une option pour la commande draw qui est plus efficace.\n * Il est donc prfrable d'utiliser la proprit hachures des objets Polygone. (Jean-Claude Lhote)\n */\nexport function patternTikZ(params: {\n  x0: number\n  y0: number\n  x1: number\n  y1: number\n  distanceDesHachures: number\n  couleurDesHachures: string\n  motif: string\n}): string {\n  const { x0, y0, x1, y1, distanceDesHachures, couleurDesHachures, motif } =\n    params\n\n  const lignes: string[] = []\n  const hauteur = y1 - y0\n\n  lignes.push('\\\\begin{scope}')\n  lignes.push(`\\\\clip (${x0},${y0}) rectangle (${x1},${y1});`)\n\n  switch (motif) {\n    case 'horizontal lines': {\n      for (let y = y0; y <= y1; y += distanceDesHachures) {\n        lignes.push(\n          `\\\\draw[${couleurDesHachures}] (${x0},${y.toFixed(2)}) -- (${x1},${y.toFixed(2)});`,\n        )\n      }\n      break\n    }\n\n    case 'vertical lines': {\n      for (let x = x0; x <= x1; x += distanceDesHachures) {\n        lignes.push(\n          `\\\\draw[${couleurDesHachures}] (${x.toFixed(2)},${y0}) -- (${x.toFixed(2)},${y1});`,\n        )\n      }\n      break\n    }\n\n    case 'dots': {\n      for (let x = x0; x <= x1; x += distanceDesHachures) {\n        for (let y = y0; y <= y1; y += distanceDesHachures) {\n          lignes.push(\n            `\\\\fill[${couleurDesHachures}] (${x.toFixed(2)},${y.toFixed(2)}) circle (0.05);`,\n          )\n        }\n      }\n      break\n    }\n\n    case 'crosshatch': {\n      // Combine horizontal + vertical\n      for (let y = y0; y <= y1; y += distanceDesHachures) {\n        lignes.push(\n          `\\\\draw[${couleurDesHachures}] (${x0},${y.toFixed(2)}) -- (${x1},${y.toFixed(2)});`,\n        )\n      }\n      for (let x = x0; x <= x1; x += distanceDesHachures) {\n        lignes.push(\n          `\\\\draw[${couleurDesHachures}] (${x.toFixed(2)},${y0}) -- (${x.toFixed(2)},${y1});`,\n        )\n      }\n      break\n    }\n\n    case 'grid': {\n      // Quadrillage = idem crosshatch\n      const side = distanceDesHachures / 5\n      for (let y = y0; y <= y1; y += side) {\n        lignes.push(\n          `\\\\draw[${couleurDesHachures}] (${x0},${y.toFixed(2)}) -- (${x1},${y.toFixed(2)});`,\n        )\n      }\n      for (let x = x0; x <= x1; x += side) {\n        lignes.push(\n          `\\\\draw[${couleurDesHachures}] (${x.toFixed(2)},${y0}) -- (${x.toFixed(2)},${y1});`,\n        )\n      }\n      break\n    }\n\n    case 'checkerboard': {\n      const side = distanceDesHachures / 3\n      let toggle = false\n      for (let y = y0; y < y1; y += side) {\n        toggle = !toggle\n        for (let x = x0 + (toggle ? 0 : side); x < x1; x += 2 * side) {\n          lignes.push(\n            `\\\\fill[${couleurDesHachures}] (${x.toFixed(2)},${y.toFixed(2)}) rectangle (${(x + side).toFixed(2)},${(y + side).toFixed(2)});`,\n          )\n        }\n      }\n      break\n    }\n\n    case 'fivepointed stars': {\n      const side = distanceDesHachures / 3\n      for (let x = x0; x <= x1; x += side) {\n        for (let y = y0; y <= y1; y += side) {\n          lignes.push(\n            `\\\\node[star,star points=5,star point ratio=2.25,fill=${couleurDesHachures},inner sep=0pt,minimum size=5pt] at (${x.toFixed(2)},${y.toFixed(2)}) {};`,\n          )\n        }\n      }\n      break\n    }\n\n    case 'sixpointed stars': {\n      const side = distanceDesHachures / 2\n      for (let x = x0; x <= x1; x += side) {\n        for (let y = y0; y <= y1; y += side) {\n          lignes.push(\n            `\\\\node[star,star points=6,star point ratio=2.25,fill=${couleurDesHachures},inner sep=0pt,minimum size=5pt] at (${x.toFixed(2)},${y.toFixed(2)}) {};`,\n          )\n        }\n      }\n      break\n    }\n\n    case 'crosshatch dots': {\n      // Grille de points\n      const side = distanceDesHachures / 5\n      for (let x = x0; x <= x1; x += side) {\n        for (let y = y0; y <= y1; y += side) {\n          lignes.push(\n            `\\\\fill[${couleurDesHachures}] (${x.toFixed(2)},${y.toFixed(2)}) circle (0.05);`,\n          )\n        }\n      }\n      // Hachures horizontales\n      for (let y = y0; y <= y1; y += distanceDesHachures) {\n        lignes.push(\n          `\\\\draw[${couleurDesHachures}] (${x0},${y.toFixed(2)}) -- (${x1},${y.toFixed(2)});`,\n        )\n      }\n      // Hachures verticales\n      for (let x = x0; x <= x1; x += distanceDesHachures) {\n        lignes.push(\n          `\\\\draw[${couleurDesHachures}] (${x.toFixed(2)},${y0}) -- (${x.toFixed(2)},${y1});`,\n        )\n      }\n      break\n    }\n\n    case 'bricks': {\n      const brickWidth = distanceDesHachures * 2\n      const brickHeight = distanceDesHachures\n      for (let y = y0; y < y1; y += brickHeight) {\n        const isOddRow = Math.floor((y - y0) / brickHeight) % 2 === 1\n        const xStart = isOddRow ? x0 - brickWidth / 2 : x0\n        for (let x = xStart; x < x1; x += brickWidth) {\n          const xLeft = Math.max(x, x0)\n          const xRight = Math.min(x + brickWidth, x1)\n          const yTop = Math.min(y + brickHeight, y1)\n          if (xRight > x0 && xLeft < x1) {\n            lignes.push(\n              `\\\\draw(${xLeft.toFixed(2)},${y.toFixed(2)}) rectangle (${xRight.toFixed(2)},${yTop.toFixed(2)});`,\n            )\n          }\n        }\n      }\n      break\n    }\n\n    case 'north east lines':\n    default: {\n      const xmin = x0 - hauteur\n      const xmax = x1 + hauteur\n      for (let x = xmin; x <= xmax; x += distanceDesHachures) {\n        lignes.push(\n          `\\\\draw[${couleurDesHachures}] (${x.toFixed(2)},${y0}) -- ++(${hauteur},${hauteur});`,\n        )\n      }\n      break\n    }\n  }\n\n  lignes.push('\\\\end{scope};')\n  return lignes.join('\\n')\n}\n\n/**\n *\n * @param {object} param0 paramtres de dfinition du motif de remplissage\n * dfinit un motif de remplissage pour les polygones, les rectangles... ou tout lment SVG qui se remplit.\n * @author Jean-Claude Lhote\n */\nexport function pattern({\n  motif = 'north east lines',\n  id = '0',\n  distanceDesHachures = 10,\n  epaisseurDesHachures = 1,\n  couleurDesHachures = 'black',\n  couleurDeRemplissage = 'none',\n  opaciteDeRemplissage = 0.5,\n}) {\n  let myPattern = ''\n  if (context.isHtml) {\n    if (couleurDeRemplissage.length < 1) {\n      couleurDeRemplissage = 'none'\n    }\n    switch (motif) {\n      case 'north east lines':\n        myPattern += `<pattern id=\"pattern${id}\" width=\"${distanceDesHachures}\" height=\"${distanceDesHachures}\"  patternTransform=\"rotate(45 0 0)\" patternUnits=\"userSpaceOnUse\">\n            <rect x=\"0\" y=\"0\" width=\"${distanceDesHachures}\" height=\"${distanceDesHachures}\" fill=\"${couleurDeRemplissage}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n            <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"${distanceDesHachures}\" style=\"stroke:${couleurDesHachures}; stroke-width:${epaisseurDesHachures}\" />\n            </pattern>`\n        break\n      case 'horizontal lines':\n        myPattern += `<pattern id=\"pattern${id}\" width=\"${distanceDesHachures}\" height=\"${distanceDesHachures}\"  patternUnits=\"userSpaceOnUse\">\n            <rect x=\"0\" y=\"0\" width=\"${distanceDesHachures}\" height=\"${distanceDesHachures}\" fill=\"${couleurDeRemplissage}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n            <line x1=\"0\" y1=\"${distanceDesHachures / 2}\" x2=\"${distanceDesHachures}\" y2=\"${distanceDesHachures / 2}\" style=\"stroke:${couleurDesHachures}; stroke-width:${epaisseurDesHachures}\" />\n            </pattern>`\n        break\n      case 'vertical lines':\n        myPattern += `<pattern id=\"pattern${id}\" width=\"${distanceDesHachures}\" height=\"${distanceDesHachures}\"  patternTransform=\"rotate(0 0 0)\" patternUnits=\"userSpaceOnUse\">\n            <rect x=\"0\" y=\"0\" width=\"${distanceDesHachures}\" height=\"${distanceDesHachures}\" fill=\"${couleurDeRemplissage}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n            <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"${distanceDesHachures}\" style=\"stroke:${couleurDesHachures}; stroke-width:${epaisseurDesHachures}\" />\n            </pattern>`\n        break\n      case 'dots':\n        myPattern += `<pattern id=\"pattern${id}\" width=\"${distanceDesHachures}\" height=\"${distanceDesHachures}\"  patternTransform=\"rotate(0 0 0)\" patternUnits=\"userSpaceOnUse\">\n            <circle cx=\"3\" cy=\"3\" r=\"${epaisseurDesHachures}\" fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n            <circle cx=\"8\" cy=\"3\" r=\"${epaisseurDesHachures}\" fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n            <circle cx=\"3\" cy=\"8\" r=\"${epaisseurDesHachures}\" fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n            <circle cx=\"8\" cy=\"8\" r=\"${epaisseurDesHachures}\" fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n            </pattern>`\n        break\n      case 'crosshatch dots':\n        myPattern += `<pattern id=\"pattern${id}\" width=\"12\" height=\"12\" x=\"12\" y=\"12\" patternTransform=\"rotate(0 0 0)\" patternUnits=\"userSpaceOnUse\">\n          <circle cx=\"2\" cy=\"2\" r=\"${epaisseurDesHachures}\" fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n          <circle cx=\"8\" cy=\"2\" r=\"${epaisseurDesHachures}\" fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n          <circle cx=\"5\" cy=\"5\" r=\"${epaisseurDesHachures}\" fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n          <circle cx=\"2\" cy=\"8\" r=\"${epaisseurDesHachures}\" fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n          <circle cx=\"8\" cy=\"8\" r=\"${epaisseurDesHachures}\" fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n          <circle cx=\"5\" cy=\"11\" r=\"${epaisseurDesHachures}\" fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n          <circle cx=\"11\" cy=\"5\" r=\"${epaisseurDesHachures}\" fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n          <circle cx=\"11\" cy=\"11\" r=\"${epaisseurDesHachures}\" fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n          </pattern>`\n        break\n      case 'fivepointed stars':\n        myPattern += `<pattern id=\"pattern${id}\" width=\"12\" height=\"12\" x=\"10\" y=\"10\" patternTransform=\"rotate(0 0 0)\" patternUnits=\"userSpaceOnUse\">\n          <polygon points=\"10,5 6.2,4.2 6.6,0.2 4.6,3.6 1,2 3.6,5 1,8 4.6,6.4 6.6,9.8 6.2,5.8 \" stroke=\"${couleurDesHachures}\"  fill=\"${couleurDeRemplissage}\" fill-opacity=\"${opaciteDeRemplissage}\" />\n          </pattern>`\n        break\n      case 'sixpointed stars':\n        myPattern += `<pattern id=\"pattern${id}\"  width=\"12\" height=\"12\" x=\"10\" y=\"10\" patternTransform=\"rotate(0 0 0)\" patternUnits=\"userSpaceOnUse\">\n        <polygon points=\"10,5 7.6,3.4 7.6,0.6 5,2 2.6,0.6 2.4,3.4 0,5 2.4,6.4 2.6,9.4 5,8 7.6,9.4 7.6,6.4 \" stroke=\"${couleurDesHachures}\" fill=\"${couleurDeRemplissage}\" fill-opacity=\"${opaciteDeRemplissage}\" />\n        </pattern>`\n        break\n      case 'crosshatch':\n        myPattern += `<pattern id=\"pattern${id}\" width=\"12\" height=\"12\" x=\"10\" y=\"10\" patternTransform=\"rotate(0 0 0)\" patternUnits=\"userSpaceOnUse\">\n          <polygon points=\"2,2 7.6,7.6 7,8.4 9.8,8.4 9.8,5.6 9,6.2 3.4,0.6 \" stroke=\"${couleurDesHachures}\"  fill=\"${couleurDeRemplissage}\" fill-opacity=\"${opaciteDeRemplissage}\" />\n          </pattern>`\n        break\n      case 'bricks':\n        myPattern += `<pattern id=\"pattern${id}\" width=\"18\" height=\"16\" x=\"18\" y=\"16\" patternTransform=\"rotate(0 0 0)\" patternUnits=\"userSpaceOnUse\">\n          <line x1=\"4\" y1=\"2\" x2=\"4\" y2=\"4\" stroke=\"${couleurDesHachures}\" fill=\"${couleurDeRemplissage}\" fill-opacity=\"${opaciteDeRemplissage}\"  />\n          <line x1=\"0\" y1=\"4\" x2=\"16\" y2=\"4\" stroke=\"${couleurDesHachures}\" fill=\"${couleurDeRemplissage}\" fill-opacity=\"${opaciteDeRemplissage}\"   />\n          <line x1=\"14\" y1=\"4\" x2=\"14\" y2=\"12\" stroke=\"${couleurDesHachures}\" fill=\"${couleurDeRemplissage}\" fill-opacity=\"${opaciteDeRemplissage}\"   />\n          <line x1=\"16\" y1=\"12\" x2=\"0\" y2=\"12\" stroke=\"${couleurDesHachures}\" fill=\"${couleurDeRemplissage}\" fill-opacity=\"${opaciteDeRemplissage}\"   />\n          <line x1=\"4\" y1=\"12\" x2=\"4\" y2=\"16\" stroke=\"${couleurDesHachures}\" fill=\"${couleurDeRemplissage}\" fill-opacity=\"${opaciteDeRemplissage}\"   />\n          </pattern>`\n        break\n      case 'grid':\n        myPattern += `<pattern id=\"pattern${id}\" width=\"10\" height=\"10\" x=\"10\" y=\"10\" patternTransform=\"rotate(0 0 0)\" patternUnits=\"userSpaceOnUse\">\n          <polyline points=\"8,8 0,8 0,0 \" fill=\"none\" stroke=\"${couleurDesHachures}\" />\n          </pattern>`\n        break\n      case 'checkerboard':\n        myPattern += `<pattern id=\"pattern${id}\" width=\"8\" height=\"8\" x=\"8\" y=\"8\" patternTransform=\"rotate(0 0 0)\" patternUnits=\"userSpaceOnUse\">\n          <polygon points=\"4,4 8,4 8,0 4,0 \"  fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\" />\n          <polygon points=\"0,4 4,4 4,8 0,8 \"  fill=\"${couleurDesHachures}\" fill-opacity=\"${opaciteDeRemplissage}\" />\n        \n          </pattern>`\n        break\n      default:\n        myPattern += `<pattern id=\"pattern${id}\" width=\"${distanceDesHachures}\" height=\"${distanceDesHachures}\"  patternTransform=\"rotate(45 0 0)\" patternUnits=\"userSpaceOnUse\">\n        <rect x=\"0\" y=\"0\" width=\"${distanceDesHachures}\" height=\"${distanceDesHachures}\" fill=\"${couleurDeRemplissage}\" fill-opacity=\"${opaciteDeRemplissage}\"/>\n        <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"${distanceDesHachures}\" style=\"stroke:${couleurDesHachures}; stroke-width:${epaisseurDesHachures}\" />\n        </pattern>`\n        break\n    }\n    return myPattern\n  } else if (context.issortieNB) {\n    switch (motif) {\n      case 'north east lines':\n        myPattern = `pattern = {Lines[angle=45, distance=${distanceDesHachures}pt, line width=0.3pt]}`\n        break\n      case 'horizontal lines':\n        myPattern = `pattern = {Lines[angle=0, distance=${distanceDesHachures}pt, line width=0.3pt]}`\n        break\n      case 'vertical lines':\n        myPattern = `pattern = {Lines[angle=90, distance=${distanceDesHachures}pt, line width=0.3pt]}`\n        break\n      case 'dots':\n        myPattern = `pattern = ${motif}`\n        break\n      case 'crosshatch dots':\n        myPattern = `pattern = ${motif}`\n        break\n      case 'fivepointed stars':\n        myPattern = `pattern = ${motif}`\n        break\n      case 'sixpointed stars':\n        myPattern = `pattern = ${motif}`\n        break\n      case 'crosshatch':\n        myPattern = `pattern = ${motif}`\n        break\n      case 'bricks':\n        myPattern = `pattern = ${motif}`\n        break\n      case 'grid':\n        myPattern = `pattern = ${motif}`\n        break\n      case 'checkerboard':\n        myPattern = `pattern = ${motif}`\n        break\n      default:\n        myPattern = `pattern = {Lines[angle=45, distance=${distanceDesHachures}pt, line width=0.3pt]}`\n        break\n    }\n    return myPattern\n  } else {\n    // Sortie Latex\n    switch (motif) {\n      case 'north east lines':\n        myPattern = `pattern color = ${couleurDesHachures} , pattern = {Lines[angle=45, distance=${distanceDesHachures}pt, line width=0.3pt]}`\n        break\n      case 'horizontal lines':\n        myPattern = `pattern color = ${couleurDesHachures} , pattern = {Lines[angle=0, distance=${distanceDesHachures}pt, line width=0.3pt]}`\n        break\n      case 'vertical lines':\n        myPattern = `pattern color = ${couleurDesHachures} , pattern = {Lines[angle=90, distance=${distanceDesHachures}pt, line width=0.3pt]}`\n        break\n      case 'dots':\n        myPattern = `pattern color = ${couleurDesHachures} , pattern = ${motif}`\n        break\n      case 'crosshatch dots':\n        myPattern = `pattern color = ${couleurDesHachures} , pattern = ${motif}`\n        break\n      case 'fivepointed stars':\n        myPattern = `pattern color = ${couleurDesHachures} , pattern = ${motif}`\n        break\n      case 'sixpointed stars':\n        myPattern = `pattern color = ${couleurDesHachures} , pattern = ${motif}`\n        break\n      case 'crosshatch':\n        myPattern = `pattern color = ${couleurDesHachures} , pattern = ${motif}`\n        break\n      case 'bricks':\n        myPattern = `pattern color = ${couleurDesHachures} , pattern = ${motif}`\n        break\n      case 'grid':\n        myPattern = `pattern color = ${couleurDesHachures} , pattern = ${motif}`\n        break\n      case 'checkerboard':\n        myPattern = `pattern color = ${couleurDesHachures} , pattern = ${motif}`\n        break\n      default:\n        myPattern = `pattern color = ${couleurDesHachures} , pattern = {Lines[angle=45, distance=${distanceDesHachures}pt, line width=0.3pt]}`\n        break\n    }\n    return `${myPattern}`\n  }\n}\n/**\n * fonction utilitaire pour la classe Tetris\n * Dtermine si deux points sont ceux d'un couple de points (dans l'ordre ou pas)\n * @param {Point} pt1\n * @param {Point} pt2\n * @param {[Point,Point]} couple\n * @returns {boolean}\n * @author Jean-Claude Lhote\n */\nfunction trouveCouple(\n  pt1: { x: number; y: number },\n  pt2: { x: number; y: number },\n  couple: [{ x: number; y: number }, { x: number; y: number }],\n) {\n  return (\n    (pt1.x === couple[0].x &&\n      pt1.y === couple[0].y &&\n      pt2.x === couple[1].x &&\n      pt2.y === couple[1].y) ||\n    (pt1.x === couple[1].x &&\n      pt1.y === couple[1].y &&\n      pt2.x === couple[0].x &&\n      pt2.y === couple[0].y)\n  )\n}\n/**\n * fonction utilitaire pour la classe Tetris\n * @description Dtermine si le point pass en paramtre est l'un des deux points d'un couple de points\n * @description Si c'est le cas, il renvoie le couple de points et la liste des couples restants aprs avoir supprim le couple trouv\n * @param {Point} pt1\n * @param {[Point,Point][]} couplesPoints\n * @returns\n */\nfunction TrouveExtremites(\n  pt1: { x: number; y: number },\n  couplesPoints: [{ x: number; y: number }, { x: number; y: number }][],\n) {\n  const index = couplesPoints.findIndex(\n    (couple: [{ x: number; y: number }, { x: number; y: number }]) =>\n      (couple[0].x === pt1.x && couple[0].y === pt1.y) ||\n      (couple[1].x === pt1.x && couple[1].y === pt1.y),\n  )\n  if (index !== -1) {\n    const couple = couplesPoints[index]\n    couplesPoints.splice(index, 1)\n    if (couple[0].x === pt1.x && couple[0].y === pt1.y) {\n      return {\n        couple: [\n          { x: couple[0].x, y: couple[0].y },\n          { x: couple[1].x, y: couple[1].y },\n        ],\n        couplesPointsRestants: couplesPoints,\n      }\n    } else {\n      return {\n        couple: [\n          { x: couple[1].x, y: couple[1].y },\n          { x: couple[0].x, y: couple[0].y },\n        ],\n        couplesPointsRestants: couplesPoints,\n      }\n    }\n  } else {\n    return { couple: null, couplesPointsRestants: couplesPoints }\n  }\n}\n/**\n * Classe Tetris\n * @description Cette classe permet de crer un pavage de carrs de surface aire\n * On cre une instance de la classe en lui donnant son aire et les coordonnes de l'origine (coin en bas  gauche du rectangle contenant son polygone)\n * Il faut savoir que les carresOccupes et les carresAdjacentDispo sont dfinis  partir du point (0;0), le polygone, lui, est translat en (xOrigine; yOrigine).\n * sa proprit poly donne le polygone de la forme\n * sa mthode render retourne un array contenant toutes les cases carres\n */\nexport class Polyquad {\n  xOrigine: number\n  yOrigine: number\n  poly!: Polygone\n  dots!: { x: number; y: number }[]\n  carresOccupes: { x: number; y: number }[]\n  carresAdjacentsDispo: { x: number; y: number }[]\n  complexity: number\n  rectangle: {\n    xMin: number\n    xMax: number\n    yMin: number\n    yMax: number\n  }\n\n  constructor(aire: number, xOrigine: number, yOrigine: number) {\n    this.xOrigine = xOrigine\n    this.yOrigine = yOrigine\n    const casesAdjacentes = [\n      { x: 0, y: 1 },\n      { x: 1, y: 0 },\n      { x: 0, y: -1 },\n      { x: -1, y: 0 },\n    ]\n    // on cre un polygone  base de carrs de surface aire\n\n    let cpt = 0\n    let aireTotale = 0\n    let aireExt = 0\n    do {\n      this.carresOccupes = [{ x: 0, y: 0 }]\n      cpt++\n      this.carresAdjacentsDispo = casesAdjacentes.map((caseAdj) => ({\n        x: caseAdj.x,\n        y: caseAdj.y,\n      }))\n      while (this.carresOccupes.length < aire) {\n        const index = randint(0, this.carresAdjacentsDispo.length - 1) // On choisit une case adjacente disponible\n        const carreChoisi = this.carresAdjacentsDispo[index] // La voil\n        this.carresAdjacentsDispo.splice(index, 1) // On supprime la case choisie des cases adjacentes disponibles\n        this.carresOccupes.push({ x: carreChoisi.x, y: carreChoisi.y }) // Elle devient une case occupe\n        for (const caseAdj of casesAdjacentes) {\n          const caseAdjDispo = {\n            x: carreChoisi.x + caseAdj.x,\n            y: carreChoisi.y + caseAdj.y,\n          }\n          if (\n            this.carresOccupes.find(\n              (caseOccupe) =>\n                caseAdjDispo.x === caseOccupe.x &&\n                caseAdjDispo.y === caseOccupe.y,\n            ) == null\n          ) {\n            if (\n              this.carresAdjacentsDispo.find(\n                (caseAdjDispoTrouvee) =>\n                  caseAdjDispo.x === caseAdjDispoTrouvee.x &&\n                  caseAdjDispo.y === caseAdjDispoTrouvee.y,\n              ) == null\n            ) {\n              this.carresAdjacentsDispo.push(caseAdjDispo)\n            }\n          }\n        }\n      }\n\n      this.rectangle = this.findRectangle()\n      aireTotale =\n        (this.rectangle.xMax - this.rectangle.xMin) *\n        (this.rectangle.yMax - this.rectangle.yMin)\n      aireExt = this.aireExt()\n\n      this.translate(-this.rectangle.xMin, -this.rectangle.yMin)\n      // permet de renseigner this.dots (la liste des sommets.)\n      this.detoure()\n    } while (aireTotale - aireExt !== aire && cpt < 100)\n    this.complexity = aireExt / aireTotale\n\n    this.poly = translation(\n      polygone(\n        this.dots.map((el: { x: number; y: number }) => point(el.x, el.y)),\n      ),\n      vecteur(xOrigine, yOrigine),\n    )\n    this.poly.color = colorToLatexOrHTML('red')\n    this.poly.couleurDeRemplissage = colorToLatexOrHTML('orange')\n    this.poly.epaisseur = 2\n  }\n\n  ajouteCarres(n: number): Polyquad {\n    let cpt = 0\n    let aireTotale = 0\n    let aireExt = 0\n    const casesAdjacentes = [\n      { x: 0, y: 1 },\n      { x: 1, y: 0 },\n      { x: 0, y: -1 },\n      { x: -1, y: 0 },\n    ]\n    const aire = this.carresOccupes.length + n\n    let carresOccupes\n    let casesAdjacentesDispo\n    const tetris2 = new Polyquad(aire, this.xOrigine, this.yOrigine)\n    do {\n      carresOccupes = JSON.parse(JSON.stringify(this.carresOccupes))\n      casesAdjacentesDispo = JSON.parse(\n        JSON.stringify(this.carresAdjacentsDispo),\n      )\n      cpt++\n      while (carresOccupes.length < aire) {\n        const index = randint(0, casesAdjacentesDispo.length - 1) // On choisit une case adjacente disponible\n        const carreChoisi = casesAdjacentesDispo[index] // La voil\n        casesAdjacentesDispo.splice(index, 1) // On supprime la case choisie des cases adjacentes disponibles\n        carresOccupes.push({ x: carreChoisi.x, y: carreChoisi.y }) // Elle devient une case occupe\n        for (const caseAdj of casesAdjacentes) {\n          const caseAdjDispo = {\n            x: carreChoisi.x + caseAdj.x,\n            y: carreChoisi.y + caseAdj.y,\n          }\n          if (\n            carresOccupes.find(\n              (caseOccupe: { x: number; y: number }) =>\n                caseAdjDispo.x === caseOccupe.x &&\n                caseAdjDispo.y === caseOccupe.y,\n            ) == null\n          ) {\n            if (\n              casesAdjacentesDispo.find(\n                (caseAdjDispoTrouvee: { x: number; y: number }) =>\n                  caseAdjDispo.x === caseAdjDispoTrouvee.x &&\n                  caseAdjDispo.y === caseAdjDispoTrouvee.y,\n              ) == null\n            ) {\n              casesAdjacentesDispo.push(caseAdjDispo)\n            }\n          }\n        }\n      }\n      tetris2.carresOccupes = JSON.parse(JSON.stringify(carresOccupes))\n      tetris2.carresAdjacentsDispo = JSON.parse(\n        JSON.stringify(casesAdjacentesDispo),\n      )\n      tetris2.rectangle = tetris2.findRectangle()\n      aireTotale =\n        (tetris2.rectangle.xMax - tetris2.rectangle.xMin) *\n        (tetris2.rectangle.yMax - tetris2.rectangle.yMin)\n      aireExt = tetris2.aireExt()\n\n      tetris2.translate(-tetris2.rectangle.xMin, -tetris2.rectangle.yMin)\n      // permet de renseigner this.dots (la liste des sommets)\n      tetris2.detoure()\n    } while (aireTotale - aireExt !== aire && cpt < 100)\n    tetris2.carresOccupes = JSON.parse(JSON.stringify(carresOccupes))\n    tetris2.carresAdjacentsDispo = JSON.parse(\n      JSON.stringify(casesAdjacentesDispo),\n    )\n    tetris2.complexity = aireExt / aireTotale\n\n    tetris2.poly = translation(\n      polygone(\n        tetris2.dots.map((el: { x: number; y: number }) => point(el.x, el.y)),\n      ),\n      vecteur(tetris2.xOrigine, tetris2.yOrigine),\n    )\n    tetris2.poly.color = colorToLatexOrHTML('red')\n    tetris2.poly.couleurDeRemplissage = colorToLatexOrHTML('orange')\n    tetris2.poly.epaisseur = 2\n    return tetris2\n  }\n\n  private findRectangle() {\n    let xMin = 1000\n    let xMax = -1000\n    let yMin = 1000\n    let yMax = -1000\n    for (const carre of this.carresOccupes) {\n      xMin = Math.min(xMin, carre.x)\n      xMax = Math.max(xMax, carre.x + 1)\n      yMin = Math.min(yMin, carre.y)\n      yMax = Math.max(yMax, carre.y + 1)\n    }\n    return { xMin, xMax, yMin, yMax }\n  }\n\n  translate(dx: number, dy: number) {\n    for (const carre of this.carresOccupes) {\n      carre.x += dx\n      carre.y += dy\n    }\n    for (const carre of this.carresAdjacentsDispo) {\n      carre.x += dx\n      carre.y += dy\n    }\n    this.rectangle = {\n      xMin: this.rectangle.xMin + dx,\n      xMax: this.rectangle.xMax + dx,\n      yMin: this.rectangle.yMin + dy,\n      yMax: this.rectangle.yMax + dy,\n    }\n  }\n\n  rotate(sens: boolean) {\n    const matriceTransfo = sens\n      ? [\n          [0, -1],\n          [1, 0],\n        ]\n      : [\n          [0, 1],\n          [-1, 0],\n        ]\n    if (matriceTransfo == null)\n      throw Error('La matrice ne peut pas tre cre, ce qui est impossible')\n    for (const carre of this.carresOccupes) {\n      const x = matriceTransfo[0][0] * carre.x + matriceTransfo[0][1] * carre.y\n      const y = matriceTransfo[1][0] * carre.x + matriceTransfo[1][1] * carre.y\n      carre.x = x\n      carre.y = y\n    }\n    for (const carre of this.carresAdjacentsDispo) {\n      const x = matriceTransfo[0][0] * carre.x + matriceTransfo[0][1] * carre.y\n      const y = matriceTransfo[1][0] * carre.x + matriceTransfo[1][1] * carre.y\n      carre.x = x\n      carre.y = y\n    }\n    this.rectangle = this.findRectangle()\n    this.translate(-this.rectangle.xMin, -this.rectangle.yMin)\n    // permet de renseigner this.dots (la liste des sommets.)\n    this.detoure()\n\n    this.poly = translation(\n      polygone(\n        this.dots.map((el: { x: number; y: number }) => point(el.x, el.y)),\n      ),\n      vecteur(this.xOrigine, this.yOrigine),\n    )\n    this.poly.color = colorToLatexOrHTML('red')\n    this.poly.couleurDeRemplissage = colorToLatexOrHTML('orange')\n    this.poly.epaisseur = 2\n  }\n\n  isEmpty(x: number, y: number) {\n    return (\n      this.carresOccupes.find((carre) => carre.x === x && carre.y === y) == null\n    )\n  }\n\n  aireExt() {\n    let aire = 0\n    const xMin = Math.min(...this.carresOccupes.map((carre) => carre.x))\n    const xMax = Math.max(...this.carresOccupes.map((carre) => carre.x))\n    const yMin = Math.min(...this.carresOccupes.map((carre) => carre.y))\n    const yMax = Math.max(...this.carresOccupes.map((carre) => carre.y))\n    for (let y = yMin; y <= yMax; y++) {\n      let xG = xMin\n      let xD = xMax\n      let fini = false\n      do {\n        if (this.isEmpty(xG, y) && this.isEmpty(xD, y)) {\n          aire += 2\n          xG++\n          xD--\n        } else if (this.isEmpty(xG, y)) {\n          aire++\n          xG++\n        } else if (this.isEmpty(xD, y)) {\n          aire++\n          xD--\n        } else {\n          fini = true\n        }\n      } while (!fini)\n    }\n    return aire\n  }\n\n  render() {\n    const objets: NestedObjetMathalea2dArray = []\n    for (const car of this.carresOccupes) {\n      const quad = carre(\n        point(car.x + this.xOrigine, car.y + this.yOrigine),\n        point(car.x + this.xOrigine + 1, car.y + this.yOrigine),\n      )\n      quad.couleurDeRemplissage = colorToLatexOrHTML('orange')\n      quad.color = colorToLatexOrHTML('black')\n      objets.push(quad)\n    }\n    return objets\n  }\n\n  detoure() {\n    const borduresNonNettoyees: [boolean, boolean, boolean, boolean][][] = []\n    for (let x = this.rectangle.xMin; x < this.rectangle.xMax; x++) {\n      borduresNonNettoyees[x] = []\n\n      for (let y = this.rectangle.yMin; y < this.rectangle.yMax; y++) {\n        borduresNonNettoyees[x][y] =\n          this.carresOccupes.find((carre) => carre.x === x && carre.y === y) ==\n          null\n            ? [false, false, false, false]\n            : [true, true, true, true]\n      }\n    }\n    const xor = function (a: boolean, b: boolean) {\n      return (a || b) && !(a && b)\n    }\n    const borduresNettoyees: [boolean, boolean, boolean, boolean][][] = []\n    for (let x = this.rectangle.xMin; x < this.rectangle.xMax; x++) {\n      borduresNettoyees[x] = []\n      for (let y = this.rectangle.yMin; y < this.rectangle.yMax; y++) {\n        borduresNettoyees[x][y] = [false, false, false, false]\n        borduresNettoyees[x][y][0] =\n          y === 0\n            ? borduresNonNettoyees[x][y][0]\n            : xor(\n                borduresNonNettoyees[x][y][0],\n                borduresNonNettoyees[x][y - 1][2],\n              )\n        borduresNettoyees[x][y][1] =\n          x === this.rectangle.xMax - 1\n            ? borduresNonNettoyees[x][y][1]\n            : xor(\n                borduresNonNettoyees[x][y][1],\n                borduresNonNettoyees[x + 1][y][3],\n              )\n        borduresNettoyees[x][y][2] =\n          y === this.rectangle.yMax - 1\n            ? borduresNonNettoyees[x][y][2]\n            : xor(\n                borduresNonNettoyees[x][y][2],\n                borduresNonNettoyees[x][y + 1][0],\n              )\n        borduresNettoyees[x][y][3] =\n          x === 0\n            ? borduresNonNettoyees[x][y][3]\n            : xor(\n                borduresNonNettoyees[x][y][3],\n                borduresNonNettoyees[x - 1][y][1],\n              )\n      }\n    }\n    let couplesCoords: [{ x: number; y: number }, { x: number; y: number }][] =\n      []\n\n    for (let x = this.rectangle.xMin; x < this.rectangle.xMax; x++) {\n      for (let y = this.rectangle.yMin; y < this.rectangle.yMax; y++) {\n        if (borduresNettoyees[x][y][0]) {\n          const pt1 = { x, y }\n          const pt2 = { x: x + 1, y }\n          if (!couplesCoords.some((couple) => trouveCouple(pt1, pt2, couple)))\n            couplesCoords.push([pt1, pt2])\n        }\n        if (borduresNettoyees[x][y][1]) {\n          const pt1 = { x: x + 1, y }\n          const pt2 = { x: x + 1, y: y + 1 }\n          if (!couplesCoords.some((couple) => trouveCouple(pt1, pt2, couple)))\n            couplesCoords.push([pt1, pt2])\n        }\n        if (borduresNettoyees[x][y][2]) {\n          const pt1 = { x: x + 1, y: y + 1 }\n          const pt2 = { x, y: y + 1 }\n          if (!couplesCoords.some((couple) => trouveCouple(pt1, pt2, couple)))\n            couplesCoords.push([pt1, pt2])\n        }\n        if (borduresNettoyees[x][y][3]) {\n          const pt1 = { x, y: y + 1 }\n          const pt2 = { x, y }\n          if (!couplesCoords.some((couple) => trouveCouple(pt1, pt2, couple)))\n            couplesCoords.push([pt1, pt2])\n        }\n      }\n    }\n\n    this.dots = [\n      { x: couplesCoords[0][0].x, y: couplesCoords[0][0].y },\n      { x: couplesCoords[0][1].x, y: couplesCoords[0][1].y },\n    ]\n    couplesCoords.shift()\n    // afin d'viter les boucles infinies, on limite le nombre d'itrations au nombre de couples de points.\n    let cpt = couplesCoords.length\n    while (couplesCoords.length > 0 && cpt > 0) {\n      const { couple, couplesPointsRestants } = TrouveExtremites(\n        this.dots[this.dots.length - 1],\n        couplesCoords,\n      )\n      cpt--\n      const seg = couple\n      couplesCoords = couplesPointsRestants\n      if (seg) {\n        if (seg[1].x !== this.dots[0].x || seg[1].y !== this.dots[0].y) {\n          this.dots.push({ x: seg[1].x, y: seg[1].y })\n        }\n      } else {\n        // window.notifyLocal('Le segment suivant n\\'a pas t trouv !', { pointCourant: this.dots[this.dots.length - 1], couplesPoints })\n      }\n    }\n    // on supprime les points intermdiaires\n    this.dots = elimineBinomesXYIntermediairesAlignes(this.dots)\n  }\n}\n\n/**\n * Vrifie si deux vecteurs sont orients dans la mme direction\n * @param {number} dx1 Composante x du premier vecteur\n * @param {number} dy1 Composante y du premier vecteur\n * @param {number} dx2 Composante x du second vecteur\n * @param {number} dy2 Composante y du second vecteur\n * @returns {boolean} true si les vecteurs sont orients dans la mme direction, false sinon\n */\nfunction sontVecteursAlignes(\n  dx1: number,\n  dy1: number,\n  dx2: number,\n  dy2: number,\n): boolean {\n  if (dx1 === 0) {\n    if (dy1 === 0) {\n      return dx2 === 0 && dy2 === 0\n    } else {\n      return dy2 / dy1 > 0\n    }\n  }\n  if (dy1 === 0) {\n    if (dx1 === 0) {\n      return dx2 === 0 && dy2 === 0\n    } else {\n      return dx2 / dx1 > 0\n    }\n  }\n  return dx2 * dy1 === dx1 * dy2 && dx1 * dx2 > 0 && dy1 * dy2 > 0\n}\n\n/**\n * Supprime de la liste de binomesXY les binomes intermdiaires correspondant  des point aligns avec le prcdent et le suivant afin de limiter le nombre de sommets d'un polygone\n * Elle permet aussi de supprimer les doublons conscutifs puisque forcment, ils sont aligns\n * @param {BinomesXY} binomesXY une liste de binomesXY\n * @returns {BinomesXY} une liste de binomesXY\n * @author Jean-Claude Lhote\n */\nexport function elimineBinomesXYIntermediairesAlignes(binomesXY: BinomesXY) {\n  // on supprime les binomesXY intermdiaires\n  for (let i = 1; i < binomesXY.length - 1; ) {\n    const pt1 = binomesXY[i - 1]\n    const pt2 = binomesXY[i]\n    const pt3 = binomesXY[i + 1]\n    const dx = pt2.x - pt1.x\n    const dy = pt2.y - pt1.y\n    const dx2 = pt3.x - pt2.x\n    const dy2 = pt3.y - pt2.y\n    if (sontVecteursAlignes(dx, dy, dx2, dy2)) {\n      binomesXY.splice(i, 1)\n    } else {\n      i++\n    }\n  }\n  const pt1 = binomesXY[binomesXY.length - 1]\n  const pt2 = binomesXY[0]\n  const pt3 = binomesXY[1]\n  const dx = pt2.x - pt1.x\n  const dy = pt2.x - pt1.y\n  const dx2 = pt3.x - pt2.x\n  const dy2 = pt3.y - pt2.y\n  if (dx2 === dx && dy2 === dy) {\n    binomesXY.splice(0, 1)\n  }\n  return binomesXY\n}\n","import {\n  colorToLatexOrHTML,\n  ObjetMathalea2D,\n} from '../../modules/2dGeneralites'\nimport type { Point3d } from '../3d/3dProjectionMathalea2d/elements'\n\nimport { context } from '../../modules/context'\nimport {\n  egal,\n  inferieurouegal,\n  randint,\n  superieurouegal,\n} from '../../modules/outils'\nimport { degToRad } from '../mathFonctions/trigo'\nimport { arrondi } from '../outils/nombres'\nimport { Cercle, cercle } from './cercle'\nimport {\n  droite,\n  Droite,\n  droiteParPointEtPerpendiculaire,\n  Mediatrice,\n} from './droites'\nimport { PointAbstrait } from './points-abstraits'\nimport { carre, Polygone, polygone } from './polygones'\nimport {\n  DemiDroite,\n  longueur,\n  Segment,\n  segment,\n  vecteur,\n} from './segmentsVecteurs'\nimport { homothetie, rotation, similitude } from './transformations'\n\n/**\n * A = point('A') //son nom\n * A = point(x,y) //ses coordonnes\n * A = point(x,y,'A') //ses coordonnes et son nom\n * A = point(x,y,'A',below') //ses coordonnes,son nom et la position de son label\n * @author Rmi Angot\n * @class\n */\nexport class Point extends PointAbstrait {\n  /**\n   * Teste l'appartenance d'un point  tout type de polygone (non convexe ou convexe). Pour info, la fonction utilise une triangulation du polygone ralise par la librairie earcut Copyright (c) 2016, Mapbox.\n   * @memberof Point\n   * @param {Polygone} p Polygone dont on veut tester l'appartenance avec le point\n   * @example M.estDansPolygone(p1) // Renvoie true si M appartient au polygone p1, false sinon\n   * @author Jean-Claude Lhote\n   * @return {boolean}\n   */\n  // JSDOC Validee par EE Aout 2022\n  estDansPolygone(p: Polygone): boolean {\n    for (const triangle of p.triangulation) {\n      if (this.estDansTriangle(...(triangle as [Point, Point, Point])))\n        return true\n    }\n    return false\n  }\n\n  /**\n   * Teste l'appartenance d'un point dans un triangle\n   * @memberof Point\n   * @param {Point} A Premier sommet du triangle\n   * @param {Point} B Deuxime sommet du triangle\n   * @param {Point} C Troisime sommet du triangle\n   * @example M.estDansTriangle(V, S, T) // Renvoie true si M appartient au triangle VST, false sinon\n   * @author Eric Elter\n   * @return {boolean}\n   */\n  // JSDOC Validee par EE Aout 2022\n  estDansTriangle(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    C: PointAbstrait,\n  ): boolean {\n    const vMA = vecteur(this, A)\n    const vMB = vecteur(this, B)\n    const vMC = vecteur(this, C)\n    const x1 = vMB.x * vMC.y - vMB.y * vMC.x\n    const x2 = vMC.x * vMA.y - vMC.y * vMA.x\n    const x3 = vMA.x * vMB.y - vMA.y * vMB.x\n    return (\n      (superieurouegal(x1, 0) &&\n        superieurouegal(x2, 0) &&\n        superieurouegal(x3, 0)) ||\n      (inferieurouegal(x1, 0) &&\n        inferieurouegal(x2, 0) &&\n        inferieurouegal(x3, 0))\n    )\n  }\n\n  /**\n   * Teste l'appartenance d'un point  un polygone convexe\n   * @memberof Point\n   * @param {Polygone} p Polygone dont on veut tester l'appartenance avec le point\n   * @example M.estDansPolygoneConvexe(p1) // Renvoie true si M appartient au polygone convexe p1, false sinon\n   * @author Jean-Claude Lhote\n   * @return {boolean}\n   */\n  // JSDOC Validee par EE Aout 2022\n  estDansPolygoneConvexe(p: Polygone): boolean {\n    const l = p.listePoints.length\n    if (l === 3) {\n      return this.estDansTriangle(...(p.listePoints as [Point, Point, Point]))\n    } else {\n      const A = p.listePoints[0]\n      const B = p.listePoints[1]\n      const C = p.listePoints[l - 1]\n      const p2 = polygone(...p.listePoints.slice(1))\n      if (this.estDansTriangle(A, B, C)) return true\n      else return this.estDansPolygoneConvexe(p2)\n    }\n  }\n\n  /**\n   * Teste l'appartenance d'un point dans un quadrilatre\n   * @memberof Point\n   * @param {Point} A Premier sommet du quadrilatre\n   * @param {Point} B Deuxime sommet du quadrilatre\n   * @param {Point} C Troisime sommet du quadrilatre\n   * @param {Point} D Quatrime sommet du quadrilatre\n   * @example M.estDansQuadrilatere(F, G, H, I) // Renvoie true si M appartient au quadrilatre FGHI, false sinon\n   * @author Eric Elter\n   * @return {boolean}\n   */\n  // JSDOC Validee par EE Aout 2022\n  estDansQuadrilatere(A: Point, B: Point, C: Point, D: Point) {\n    return this.estDansTriangle(A, B, C) || this.estDansTriangle(A, C, D)\n  }\n\n  /**\n   * Teste l'appartenance d'un point sur un segment, un cercle, une droite ou une demi-droite\n   * @memberof Point\n   * @param {Segment | Cercle | Droite | DemiDroite} objet Objet gomtrique dont on veut tester si le point en fait partie\n   * @example M.estSur(s) // Renvoie true si M appartient au segment s (au pralablement dfini), false sinon\n   * @return {boolean}\n   */\n  // JSDOC Validee par EE Aout 2022\n  estSur(objet: Droite | Segment | DemiDroite | Cercle) {\n    if (objet instanceof Droite)\n      return egal(objet.a * this.x + objet.b * this.y + objet.c, 0, 0.01)\n    if (objet instanceof Segment) {\n      const prodvect =\n        (objet.extremite2.x - objet.extremite1.x) *\n          (this.y - objet.extremite1.y) -\n        (this.x - objet.extremite1.x) *\n          (objet.extremite2.y - objet.extremite1.y)\n      const prodscal =\n        (this.x - objet.extremite1.x) *\n          (objet.extremite2.x - objet.extremite1.x) +\n        (this.y - objet.extremite1.y) *\n          (objet.extremite2.y - objet.extremite1.y)\n      const prodscalABAB =\n        (objet.extremite2.x - objet.extremite1.x) ** 2 +\n        (objet.extremite2.y - objet.extremite1.y) ** 2\n      return (\n        egal(prodvect, 0, 0.01) &&\n        superieurouegal(prodscal, 0) &&\n        inferieurouegal(prodscal, prodscalABAB)\n      )\n    }\n    if (objet instanceof DemiDroite) {\n      const OM = vecteur(objet.extremite1, this)\n      const vd = vecteur(objet.extremite1, objet.extremite2)\n      const prodscal = OM.x * vd.x + OM.y * vd.y\n      const prodvect = OM.x * vd.y - OM.y * vd.x\n      return egal(prodvect, 0, 0.01) && superieurouegal(prodscal, 0, 0.01)\n    }\n    if (objet instanceof Cercle)\n      return egal(longueur(this, objet.centre), objet.rayon, 0.01)\n  }\n}\n\n/**\n * Cre un objet Point ayant les proprits suivantes :\n * @param {number} x abscisse\n * @param {number} y ordonne\n * @param {string} nom son nom qui apparatra\n * @param {string} [positionLabel] Les possibilits sont : 'left', 'right', 'below', 'above', 'above right', 'above left', 'below right', 'below left'. Si on se trompe dans l'orthographe, ce sera 'above left' et si on ne prcise rien, pour un point ce sera 'above'.\n * @return {Point}\n */\nexport function point(x: number, y: number, nom = '', positionLabel = 'above') {\n  return new Point(x, y, nom, positionLabel)\n}\n\nexport function pointDepuisPointAbstrait(point: PointAbstrait) {\n  return new Point(point.x, point.y, point.nom, point.positionLabel)\n}\n\n/**\n * @author Jean-Claude Lhote\n * @param {number} x abscisse\n * @param {number} y ordonne\n * @param {object} param2 permet de dfinir le rayon du 'plot', sa couleur, sa couleur de remplissage\n */\nexport class Plot extends ObjetMathalea2D {\n  couleurDeRemplissage: string[]\n  rayon: number\n  x: number\n  y: number\n  opaciteDeRemplissage: number\n  constructor(\n    x: number,\n    y: number,\n    {\n      rayon = 0.05,\n      couleur = 'black',\n      couleurDeRemplissage = 'black',\n      opacite = 1,\n      opaciteDeRemplissage = 1,\n    } = {},\n  ) {\n    super()\n    if (isNaN(x) || isNaN(y))\n      window.notify('Plot : les coordonnes ne sont pas valides', { x, y })\n    this.color = colorToLatexOrHTML(couleur) // EE : 08/05/2022\n    this.couleurDeRemplissage = colorToLatexOrHTML(couleurDeRemplissage)\n    this.rayon = rayon\n    this.x = x\n    this.y = y\n    this.bordures = [x - rayon, y - rayon, x + rayon, y + rayon]\n    this.opacite = opacite\n    this.opaciteDeRemplissage = opaciteDeRemplissage\n  }\n\n  svg(coeff: number) {\n    if (this.couleurDeRemplissage[0] === '') {\n      return `\\n\\t <circle cx=\"${this.x * coeff}\" cy=\"${-this.y * coeff}\" r=\"${this.rayon * coeff}\" stroke=\"${this.color[0]}\" stroke-opacity=\"${this.opacite || 1}\"/>`\n    } else {\n      return `\\n\\t <circle cx=\"${this.x * coeff}\" cy=\"${-this.y * coeff}\" r=\"${this.rayon * coeff}\" stroke=\"${this.color[0]}\" fill=\"${this.couleurDeRemplissage[0]}\" stroke-opacity=\"${this.opacite || 1}\" fill-opacity=\"${this.opaciteDeRemplissage || 1}\"/>`\n    }\n  }\n\n  tikz() {\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color=${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line-width=${this.epaisseur}`)\n    }\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity=${this.opacite}`)\n    }\n    if (this.opaciteDeRemplissage !== 1) {\n      tableauOptions.push(`fill opacity=${this.opaciteDeRemplissage}`)\n    }\n    if (\n      this.couleurDeRemplissage[1] !== '' &&\n      this.couleurDeRemplissage[1] !== 'none' &&\n      this.couleurDeRemplissage[1] !== ''\n    ) {\n      tableauOptions.push(`fill=${this.couleurDeRemplissage[1]}`)\n    }\n    let optionsDraw = ''\n    if (tableauOptions.length > 0) {\n      optionsDraw = '[' + tableauOptions.join(',') + ']'\n    }\n    return `\\n\\t \\\\filldraw${optionsDraw} (${this.x},${this.y}) circle (${this.rayon});`\n  }\n}\n\nexport function plot(\n  x: number,\n  y: number,\n  {\n    rayon = 0.05,\n    couleur = 'black',\n    couleurDeRemplissage = 'black',\n    opacite = 1,\n    opaciteDeRemplissage = 1,\n  } = {},\n) {\n  return new Plot(arrondi(x), arrondi(y), {\n    rayon,\n    couleur,\n    couleurDeRemplissage,\n    opacite,\n    opaciteDeRemplissage,\n  })\n}\n\n/**\n * tracePoint(A) // Place une croix  l'emplacement du point A\n * tracePoint(A,B,C,D) // Place une croix pour les diffrents points\n * tracePoint(A,B,C,D,'blue') // Place une croix pour les diffrents points\n * Aprs coup, on peut notamment changer l'paissseur, le style et l'opacit du point par :\n * pt = tracePoint(A)\n * pt.epaisseur = 5 (par dfaut : 1)\n * pt.opacite = 0.2 (par dfaut : 0.8 = 80%)\n * pt.style = '#' (choix parmi 'x','o','#','|','+','.' et par dfaut : 'x')\n * @property {string} color\n * @author Rmi Angot et Jean-Claude Lhote\n */\nexport class TracePoint extends ObjetMathalea2D {\n  taille: number\n  tailleTikz: number\n  points: (Point | Point3d)[]\n  couleurDeRemplissage?: string[]\n  constructor(...points: (PointAbstrait | Point | Point3d | string)[]) {\n    super()\n    this.taille = 3\n    this.tailleTikz = this.taille / 15\n    this.epaisseur = 1\n    this.opacite = 0.8\n    this.style = 'x'\n    let xmin = 1000\n    let xmax = -1000\n    let ymin = 1000\n    let ymax = -1000\n    let lePoint\n    if (typeof points[points.length - 1] === 'string') {\n      this.color = colorToLatexOrHTML(String(points[points.length - 1]))\n      points.pop()\n    } else this.color = colorToLatexOrHTML('black')\n    this.points = points as (Point | Point3d)[]\n    for (const unPoint of this.points) {\n      const point = unPoint as Point | Point3d\n      if (point.typeObjet !== 'point3d' && point.typeObjet !== 'point')\n        window.notify('TracePoint : argument invalide', { ...points })\n      lePoint = point.typeObjet === 'point' ? point : (point as Point3d).c2d\n      xmin = Math.min(xmin, lePoint.x - this.taille / context.pixelsParCm)\n      xmax = Math.max(xmax, lePoint.x + this.taille / context.pixelsParCm)\n      ymin = Math.min(ymin, lePoint.y - this.taille / context.pixelsParCm)\n      ymax = Math.max(ymax, lePoint.y + this.taille / context.pixelsParCm)\n    }\n    this.bordures = [xmin, ymin, xmax, ymax]\n  }\n\n  svg(coeff: number) {\n    const objetssvg = []\n    let s1\n    let s2\n    let p1\n    let p2\n    let c, A\n    for (const unPoint of this.points) {\n      if (unPoint.typeObjet === 'point3d') {\n        A = (unPoint as Point3d).c2d\n      } else {\n        A = unPoint\n      }\n      if (A.constructor === Point) {\n        if (this.style === 'x') {\n          s1 = segment(\n            point(A.x - this.taille / coeff, A.y + this.taille / coeff),\n            point(A.x + this.taille / coeff, A.y - this.taille / coeff),\n            this.color[0],\n          )\n          s2 = segment(\n            point(A.x - this.taille / coeff, A.y - this.taille / coeff),\n            point(A.x + this.taille / coeff, A.y + this.taille / coeff),\n            this.color[0],\n          )\n          s1.epaisseur = this.epaisseur\n          s2.epaisseur = this.epaisseur\n          s1.opacite = this.opacite\n          s2.opacite = this.opacite\n          objetssvg.push(s1, s2)\n        } else if (this.style === 'o') {\n          p1 = point(A.x, A.y)\n          c = cercle(p1, this.taille / coeff, this.color[0])\n          c.epaisseur = this.epaisseur\n          c.opacite = this.opacite\n          c.couleurDeRemplissage = this.color\n          c.opaciteDeRemplissage = this.opacite / 2\n          objetssvg.push(c)\n        } else if (this.style === '#') {\n          p1 = point(A.x - this.taille / coeff, A.y - this.taille / coeff)\n          p2 = point(A.x + this.taille / coeff, A.y - this.taille / coeff)\n          c = carre(p1, p2, this.color[0]) as unknown as Polygone\n          c.epaisseur = this.epaisseur\n          c.opacite = this.opacite\n          c.couleurDeRemplissage = [\n            this.color[0] ?? 'black',\n            this.color[1] ?? 'black',\n          ]\n          c.opaciteDeRemplissage = this.opacite / 2\n          objetssvg.push(c)\n        } else if (this.style === '+') {\n          s1 = segment(\n            point(A.x, A.y + this.taille / coeff),\n            point(A.x, A.y - this.taille / coeff),\n            this.color[0],\n          )\n          s2 = segment(\n            point(A.x - this.taille / coeff, A.y),\n            point(A.x + this.taille / coeff, A.y),\n            this.color[0],\n          )\n          s1.epaisseur = this.epaisseur\n          s2.epaisseur = this.epaisseur\n          s1.opacite = this.opacite\n          s2.opacite = this.opacite\n          objetssvg.push(s1, s2)\n        } else if (this.style === '|') {\n          s1 = segment(\n            point(A.x, A.y + this.taille / coeff),\n            point(A.x, A.y - this.taille / coeff),\n            this.color[0],\n          )\n          s1.epaisseur = this.epaisseur\n          s1.opacite = this.opacite\n          objetssvg.push(s1)\n        } else if (this.style === '.') {\n          s1 = plot(A.x, A.y, {\n            couleur: this.color[0],\n            rayon: this.epaisseur * 0.05,\n            couleurDeRemplissage: this.color[0],\n          })\n          objetssvg.push(s1)\n        }\n      }\n    }\n    let code = ''\n    for (const objet of objetssvg) {\n      code += '\\n\\t' + objet.svg(coeff)\n    }\n    code = `<g id=\"${this.id}\">` + code + '</g>'\n    return code\n  }\n\n  tikz() {\n    const objetstikz = []\n    let s1\n    let s2\n    let p1\n    let p2\n    let c, A\n    for (const unPoint of this.points) {\n      if (unPoint.typeObjet === 'point3d') {\n        A = (unPoint as Point3d).c2d\n      } else {\n        A = unPoint\n      }\n      if (A.constructor === Point) {\n        if (this.style === 'x') {\n          this.tailleTikz = this.taille / 16 // EE : Sinon, on ne voit pas la croix.\n          s1 = segment(\n            point(A.x - this.tailleTikz, A.y + this.tailleTikz),\n            point(A.x + this.tailleTikz, A.y - this.tailleTikz),\n            this.color[1],\n          )\n          s2 = segment(\n            point(A.x - this.tailleTikz, A.y - this.tailleTikz),\n            point(A.x + this.tailleTikz, A.y + this.tailleTikz),\n            this.color[1],\n          )\n          s1.epaisseur = this.epaisseur / 1.6\n          s2.epaisseur = this.epaisseur / 1.6\n          s1.opacite = this.opacite\n          s2.opacite = this.opacite\n          objetstikz.push(s1, s2)\n        } else if (this.style === 'o') {\n          p1 = point(A.x, A.y)\n          c = cercle(p1, this.tailleTikz, this.color[1])\n          c.epaisseur = this.epaisseur\n          c.opacite = this.opacite\n          c.couleurDeRemplissage = this.color\n          c.opaciteDeRemplissage = this.opacite / 2\n          objetstikz.push(c)\n        } else if (this.style === '#') {\n          p1 = point(A.x - this.tailleTikz, A.y - this.tailleTikz)\n          p2 = point(A.x + this.tailleTikz, A.y - this.tailleTikz)\n          c = carre(p2, p1, this.color[1]) as unknown as Polygone\n          c.epaisseur = this.epaisseur\n          c.opacite = this.opacite\n          c.couleurDeRemplissage = [\n            this.color[0] ?? 'black',\n            this.color[1] ?? 'black',\n          ]\n          c.opaciteDeRemplissage = this.opacite / 2\n          objetstikz.push(c)\n        } else if (this.style === '+') {\n          s1 = segment(\n            point(A.x, A.y + this.tailleTikz),\n            point(A.x, A.y - this.tailleTikz),\n            this.color[1],\n          )\n          s2 = segment(\n            point(A.x - this.tailleTikz, A.y),\n            point(A.x + this.tailleTikz, A.y),\n            this.color[1],\n          )\n          s1.epaisseur = this.epaisseur\n          s2.epaisseur = this.epaisseur\n          s1.opacite = this.opacite\n          s2.opacite = this.opacite\n          objetstikz.push(s1, s2)\n        } else if (this.style === '|') {\n          s1 = segment(\n            point(A.x, A.y + this.tailleTikz),\n            point(A.x, A.y - this.tailleTikz),\n            this.color[1],\n          )\n          s1.epaisseur = this.epaisseur\n          s1.opacite = this.opacite\n          objetstikz.push(s1)\n        } else if (this.style === '.') {\n          s1 = plot(A.x, A.y, {\n            couleur: this.color[0],\n            rayon: this.epaisseur * 0.05,\n            couleurDeRemplissage: this.color[1], // je mets la couleur html, car elle va tre parse par colorToLatexOrHtml  nouveau\n          })\n          objetstikz.push(s1)\n        }\n      }\n    }\n    let code = ''\n    for (const objet of objetstikz) {\n      code += objet.tikz()\n    }\n    return code\n  }\n}\n\n/**\n * @param  {(Point |PointCliquable| string)[]} args Points prcdemment crs. Si le dernier argument est une chane de caractre, dfinit la couleur des points tracs.\n * @return  {TracePoint}\n * @example tracePoint(A,B,C,'red) // Trace les points A,B,C prcdemment crs en rouge\n * @example tracePoint(A).style = '|' // Le style du point A sera '|' et non 'x' par dfaut.\n * @example tracePoint(A).epaisseur = 5 // L'paisseur du style du point sera 5 et non 1 par dfaut.\n * @example tracePoint(A).opacite = 0.4 // L'opacit du style du point sera 40% et non 80%(0.8) par dfaut.\n */\nexport function tracePoint(\n  ...args: (PointAbstrait | Point | Point3d | string)[]\n) {\n  return new TracePoint(...args)\n}\n\n/**\n * P=tracePointSurDroite(A,d) //Ajoute un trait perpendiculaire  d suppose trace marquant la posiion du point A\n * P=tracePointSurDroite(A,B) //Ajoute un trait perpendiculaire  la droite (AB) suppose trace marquant la posiion du point A\n *\n * @author Rmi Angot et Jean-Claude Lhote\n */\nexport class TracePointSurDroite extends ObjetMathalea2D {\n  lieu: PointAbstrait\n  taille: number\n  x: number\n  y: number\n  direction: PointAbstrait\n  stringColor: string\n\n  constructor(A: PointAbstrait, O: PointAbstrait | Droite, color = 'black') {\n    super()\n    this.stringColor = color\n    this.lieu = A\n    this.taille = 0.2\n    this.x = A.x\n    this.y = A.y\n    let M, d\n    this.bordures = [A.x - 0.2, A.y - 0.2, A.x + 0.2, A.y + 0.2]\n\n    if (O instanceof PointAbstrait) {\n      if (longueur(this.lieu, O) < 0.001) {\n        window.notify(\n          'TracePointSurDroite : points trop rapprochs pour dfinir une droite',\n          {\n            A,\n            O,\n          },\n        )\n      }\n      M = pointSurSegment(this.lieu, O, 1)\n      this.direction = rotation(M, this.lieu, 90)\n    } else {\n      d = droiteParPointEtPerpendiculaire(this.lieu, O as Droite)\n      this.direction = pointSurSegment(point(d.x1, d.y1), point(d.x2, d.y2), 1)\n    }\n  }\n\n  svg(coeff: number) {\n    const A1 = pointSurSegment(\n      this.lieu,\n      this.direction,\n      (this.taille * 20) / coeff,\n    )\n    const A2 = pointSurSegment(\n      this.lieu,\n      this.direction,\n      (-this.taille * 20) / coeff,\n    )\n    const s = segment(A1, A2, this.stringColor)\n    this.id = s.id\n    return s.svg(coeff)\n  }\n\n  tikz() {\n    const A1 = pointSurSegment(\n      this.lieu,\n      this.direction,\n      this.taille / context.scale,\n    )\n    const A2 = pointSurSegment(\n      this.lieu,\n      this.direction,\n      -this.taille / context.scale,\n    )\n    const s = segment(A1, A2, this.stringColor)\n    return s.tikz()\n  }\n}\n\nexport function tracePointSurDroite(\n  A: PointAbstrait,\n  O: PointAbstrait | Droite,\n  color = 'black',\n) {\n  return new TracePointSurDroite(A, O, color)\n}\n\nexport function traceMilieuSegment(A: PointAbstrait, B: PointAbstrait) {\n  return new TracePointSurDroite(milieu(A, B), droite(A, B))\n}\n\n/**\n * M = milieu(A,B) //M est le milieu de [AB]\n * M = milieu(A,B,'M') //M est le milieu [AB] et se nomme M\n * M = milieu(A,B,'M','below') //M est le milieu [AB], se nomme M et le nom est en dessous du point\n * @returns {PointAbstrait} Milieu du segment [AB]\n * @author Rmi Angot\n */\nexport function milieu(\n  A: PointAbstrait,\n  B: PointAbstrait,\n  nom = '',\n  positionLabel = 'above',\n): Point {\n  if (isNaN(longueur(A, B)))\n    window.notify('milieu : Quelque chose ne va pas avec les points', { A, B })\n  const x = (A.x + B.x) / 2\n  const y = (A.y + B.y) / 2\n  return point(x, y, nom, positionLabel)\n}\n\n/**\n * M = pointSurSegment(A,B,l) //M est le point de [AB]  l cm de A\n * M = pointSurSegment(A,B,l,'M') //M est le point de [AB]  l cm de A et se nomme M\n * M = pointSurSegment(A,B,l,'M','below') //M est le point de [AB]  l cm de A, se nomme M et le nom est en dessous du point\n *\n * M = pointSurSegment(A,B,'h','M') // M est un point au hasard sur [AB] (on peut crire n'importe quel texte  la place de 'h')\n * M = pointSurSegment(A,B) // M est un point au hasard sur [AB]\n * Scurit ajoute par Jean-Claude Lhote : si AB=0, alors on retourne A\n * @author Rmi Angot\n */\nexport function pointSurSegment(\n  A: PointAbstrait,\n  B: PointAbstrait,\n  l?: number,\n  nom = '',\n  positionLabel = 'above',\n): Point {\n  if (isNaN(longueur(A, B)))\n    window.notify('pointSurSegment : Quelque chose ne va pas avec les points', {\n      A,\n      B,\n    })\n  if (longueur(A, B) === 0) return pointDepuisPointAbstrait(A)\n  if (l === undefined || typeof l === 'string') {\n    l = (longueur(A, B) * randint(15, 85)) / 100\n  }\n  return pointDepuisPointAbstrait(\n    homothetie(B, A, l / longueur(A, B), nom, positionLabel),\n  )\n}\n\n/**\n *\n * @param {Cercle} c\n * @param {number} angle\n * @param {string} nom\n * @param {string} positionLabel\n * M = pointSurCercle(c,'','M') // M est un point choisi au hasard sur le cercle c et se nomme M.\n * N = pointSurCercle(c,90) // N est le point du cercle c situ  90 par rapport  l'horizontale, donc au dessus du centre de c\n * P = pointSurCercle(c,-90) // P est le point du cercle c situ  l'oppos du point N prcdent.\n * @author Jean-Claude Lhote\n */\nexport function pointSurCercle(\n  c: Cercle,\n  angle: number,\n  nom: string,\n  positionLabel = 'above',\n): Point {\n  if (typeof angle !== 'number') angle = randint(-180, 180)\n  const x = c.centre.x + c.rayon * Math.cos(degToRad(angle))\n  const y = c.centre.y + c.rayon * Math.sin(degToRad(angle))\n  return point(x, y, nom, positionLabel)\n}\n\n/**\n * Retourne un point sur la droite d dont l'abscisse est x. Si c'est impossible (droite verticale) alors ce sera le point dont l'ordonne vaut x.\n * @param {Droite} d\n * @param {number} x Abscisse du point\n * @param {string} [nom] Nom du point\n * @param {string} [positionLabel='above'] Facultatif, 'above' par dfaut.\n * @return {Point} Point de la droite d dont l'abscisse est x\n * @author Jean-Claude Lhote\n */\nexport function pointSurDroite(\n  d: Droite,\n  x: number,\n  nom = '',\n  positionLabel = 'above',\n): Point {\n  // si d est parallle  l'axe des ordonnes, le paramtre x servira pour y.\n  if (d.b === 0) return point(-d.c / d.a, x, nom, positionLabel)\n  else if (d.a === 0) return point(x, -d.c / d.b, nom, positionLabel)\n  else return point(x, (-d.c - d.a * x) / d.b, nom, positionLabel)\n}\n\n/**\n * Renvoie 'M' le point d'intersection des droites d1 et d2\n * @param {Droite} d\n * @param {Droite} f\n * @param {string} nom  le nom du point d'intersection. Facultatif, vide par dfaut.\n * @param {string} [positionLabel='above'] Facultatif, 'above' par dfaut.\n * @return {Point} Point 'M' d'intersection de d1 et de d2\n * @author Jean-Claude Lhote\n */\nexport function pointIntersectionDD(\n  d: Droite | Mediatrice,\n  f: Droite | Mediatrice,\n  nom = '',\n  positionLabel = 'above',\n): Point | false {\n  let x, y\n  if (egal(f.a * d.b - f.b * d.a, 0, 0.000001)) {\n    // Les droites sont parallles ou confondues, pas de point d'intersection ou une infinit\n    return pointIntersectionNonTrouveEntre(d, f, point(0, 0))\n  } else {\n    y = (f.c * d.a - d.c * f.a) / (f.a * d.b - f.b * d.a)\n  }\n  if (egal(d.a, 0, 0.000001)) {\n    // si d est horizontale alors f ne l'est pas donc f.a<>0\n    x = (-f.c - f.b * y) / f.a\n  } else {\n    // d n'est pas horizontale donc ...\n    x = (-d.c - d.b * y) / d.a\n  }\n  return point(x, y, nom, positionLabel)\n}\n\n/**\n * @example pointAdistance(A,d,angle,nom=\"\",positionLabel=\"above\") // Seuls le point A et la distance d sont obligatoires, angle peut tre choisi : il s'agit de l'angle sign avec l'axe [OI) sinon, il est choisi alatoirement.\n * @example p=pointAdistance(A,5,'M') // Place un point alatoirement  5 units de A et lui donne le nom de 'M'.\n * @author Jean-Claude Lhote\n */\nexport function pointAdistance(\n  A: PointAbstrait,\n  d: number = 1,\n  angle: string | number = 0,\n  nom = '',\n  positionLabel = 'above',\n): Point {\n  let leNom = ''\n  let lAngle = 0\n  let lePositionLabel = 'above'\n  if (typeof angle === 'string') {\n    lAngle = randint(0, 360)\n    leNom = angle\n    if (nom != null) lePositionLabel = nom\n  } else {\n    lAngle = angle ?? randint(0, 360)\n    if (nom != null) leNom = nom\n    if (positionLabel != null) lePositionLabel = positionLabel\n  }\n\n  const B = point(A.x + 1, A.y)\n  return similitude(B, A, lAngle, d, leNom, lePositionLabel)\n}\n\n/**\n * @param {Droite} d la droite qui intecepte (ou pas le cercle)\n * @param {Cercle} C le cercle\n * @param {string} nom le nom du point d'intersection\n * @param {entier} n 1 pour le premier point, 2 sinon. Si il n'y a qu'un seul point d'intesection, l'un ou l'autre renvoie ce point.\n * @example I = pointItersectionLC(d,c,'I',1) // I est le premier point d'intersection si il existe de la droite (d) et du cercle (c). On renvoie le centre du cercle sinon.\n * @author Jean-Claude Lhote\n */\nexport function pointIntersectionLC(\n  d: Droite,\n  C: Cercle,\n  nom = '',\n  n = 1,\n): Point | false {\n  const O = C.centre\n  const r = C.rayon\n  const a = d.a\n  const b = d.b\n  const c = d.c\n  const xO = O.x\n  const yO = O.y\n  let Delta, delta, xi, yi, xiPrime, yiPrime\n  if (egal(b, 0, 0.000001)) {\n    // la droite est verticale\n    xi = -c / a\n    xiPrime = xi\n    Delta = 4 * (-xO * xO - (c * c) / (a * a) - (2 * xO * c) / a + r * r)\n    if (Delta < 0) return pointIntersectionNonTrouveEntre(d, C, C.centre)\n    else if (egal(Delta, 0)) {\n      // un seul point d'intersection\n      yi = yO + Math.sqrt(Delta) / 2\n      yiPrime = yi\n    } else {\n      // deux points d'intersection\n      yi = yO - Math.sqrt(Delta) / 2\n      yiPrime = yO + Math.sqrt(Delta) / 2\n    }\n  } else if (egal(a, 0, 0.0000001)) {\n    // la droite est horizontale\n    yi = -c / b\n    yiPrime = yi\n    Delta = 4 * (-yO * yO - (c * c) / (b * b) - (2 * yO * c) / b + r * r)\n    if (Delta < 0) return pointIntersectionNonTrouveEntre(d, C, C.centre)\n    else if (egal(Delta, 0)) {\n      // un seul point d'intersection\n      xi = xO + Math.sqrt(Delta) / 2\n      xiPrime = xi\n    } else {\n      // deux points d'intersection\n      xi = xO - Math.sqrt(Delta) / 2\n      xiPrime = xO + Math.sqrt(Delta) / 2\n    }\n  } else {\n    // cas gnral\n    Delta =\n      (2 * ((a * c) / (b * b) + (yO * a) / b - xO)) ** 2 -\n      4 *\n        (1 + (a / b) ** 2) *\n        (xO * xO + yO * yO + (c / b) ** 2 + (2 * yO * c) / b - r * r)\n    if (Delta < 0) return pointIntersectionNonTrouveEntre(d, C, C.centre)\n    else if (egal(Delta, 0)) {\n      // un seul point d'intersection\n      delta = Math.sqrt(Delta)\n      xi =\n        (-2 * ((a * c) / (b * b) + (yO * a) / b - xO) - delta) /\n        (2 * (1 + (a / b) ** 2))\n      xiPrime = xi\n      yi = (-a * xi - c) / b\n      yiPrime = yi\n    } else {\n      // deux points d'intersection\n      delta = Math.sqrt(Delta)\n      xi =\n        (-2 * ((a * c) / (b * b) + (yO * a) / b - xO) - delta) /\n        (2 * (1 + (a / b) ** 2))\n      xiPrime =\n        (-2 * ((a * c) / (b * b) + (yO * a) / b - xO) + delta) /\n        (2 * (1 + (a / b) ** 2))\n      yi = (-a * xi - c) / b\n      yiPrime = (-a * xiPrime - c) / b\n    }\n  }\n  if (n === 1) {\n    if (yiPrime > yi) {\n      return point(xiPrime, yiPrime, nom)\n    } else {\n      return point(xi, yi, nom)\n    }\n  } else {\n    if (yiPrime > yi) {\n      return point(xi, yi, nom)\n    } else {\n      return point(xiPrime, yiPrime, nom)\n    }\n  }\n}\n\n/**\n * M = pointIntersectionCC(c1,c2,'M') // M est le point d'intersection le plus haut des cercles c1 et c2\n * M = pointIntersectionCC(c1,c2,'M',2) // M est le point d'intersection le plus bas des cercles c1 et c2\n * La fonction ne renvoie rien si les cercles n'ont pas de points d'intersection\n * @author Rmi Angot\n * @see https://stackoverflow.com/questions/12219802/a-javascript-function-that-returns-the-x-y-points-of-intersection-between-two-ci\n */\nexport function pointIntersectionCC(\n  c1: Cercle,\n  c2: Cercle,\n  nom = '',\n  n = 1,\n): Point | false {\n  const O1 = c1.centre\n  const O2 = c2.centre\n  const r0 = c1.rayon\n  const r1 = c2.rayon\n  const x0 = O1.x\n  const x1 = O2.x\n  const y0 = O1.y\n  const y1 = O2.y\n  const dx = x1 - x0\n  const dy = y1 - y0\n  const d = Math.sqrt(dy * dy + dx * dx)\n  if (d > r0 + r1) {\n    return pointIntersectionNonTrouveEntre(c1, c2, c1.centre)\n  }\n  if (d < Math.abs(r0 - r1)) {\n    return pointIntersectionNonTrouveEntre(c1, c2, c1.centre)\n  }\n  const a = (r0 * r0 - r1 * r1 + d * d) / (2.0 * d)\n  const x2 = x0 + (dx * a) / d\n  const y2 = y0 + (dy * a) / d\n  const h = Math.sqrt(r0 * r0 - a * a)\n  const rx = -dy * (h / d)\n  const ry = dx * (h / d)\n  const xi = x2 + rx\n  const xiPrime = x2 - rx\n  const yi = y2 + ry\n  const yiPrime = y2 - ry\n  if (n === 1) {\n    if (yiPrime > yi) {\n      return point(xiPrime, yiPrime, nom)\n    } else {\n      return point(xi, yi, nom)\n    }\n  } else {\n    if (yiPrime > yi) {\n      return point(xi, yi, nom)\n    } else {\n      return point(xiPrime, yiPrime, nom)\n    }\n  }\n}\n\nfunction pointIntersectionNonTrouveEntre(\n  objet1: Cercle | Droite | Mediatrice,\n  objet2: Cercle | Droite | Mediatrice,\n  valeurParDefaut: PointAbstrait,\n): false {\n  // window.notify(`${objet1.nom} et ${objet2.nom} ne se coupent pas. Impossible de trouver leur intersection.`, { objet1, objet2 })\n  // return pointDepuisPointAbstrait(valeurParDefaut)\n  return false\n}\n","import {\n  colorToLatexOrHTML,\n  ObjetMathalea2D,\n  vide2d,\n} from '../../modules/2dGeneralites'\nimport { context } from '../../modules/context'\nimport { egal } from '../../modules/outils'\nimport { arrondi } from '../outils/nombres'\nimport { angleOriente } from './angles'\nimport { traceCompas } from './cercle'\nimport { codageBissectrice, codageMediatrice, codageSegments } from './codages'\nimport { milieu, Point, point, pointSurDroite, pointSurSegment } from './points'\nimport { PointAbstrait } from './points-abstraits'\nimport {\n  DemiDroite,\n  demiDroite,\n  longueur,\n  norme,\n  segment,\n  Vecteur,\n  vecteur,\n} from './segmentsVecteurs'\nimport {\n  Latex2d,\n  latex2d,\n  TexteParPoint,\n  texteParPosition,\n  type LetterSizeType,\n} from './textes'\nimport {\n  homothetie,\n  projectionOrtho,\n  rotation,\n  symetrieAxiale,\n  translation,\n} from './transformations'\n\n/**\n * Ajouter une tiquette sur une droite.\n * @param {*} droite La droite o on va rajouter une tiquette\n * @param {*} nom Le nom de la droite doit tre en latex et sera rendu avec Latex2d (donc en mode math) : Ne pas mettre de $ $ !\n * @param {*} options Les options permettant de personnaliser la position de l'tiquette et la mise en forme\n *  options.preferedPosition La position  privilgier si possible sur le bord de l'image ('left', 'right', 'above', 'below')\n *  options.usedPosition Un tableau des anciennes positions dj alloues pour viter les colisions avec des tiquettes d'autres droites\n *  options.taille La taille de la police de l'tiquette par dfaut 6\n *  options.color La couleur de l'tiquette par dfaut 'red'\n * @returns {Latex2d} L'tiquette\n *\n * Exemple :\n *   context.fenetreMathalea2d = [xmin + 0.2, ymin, xmax, ymax] // important pour la position des labels\n *   const d3nom = labelOnLine(d3, '$' + noms[3] + '$', { color: 'blue', taille: 8, preferedPosition: 'left' })\n *   const d0nom = labelOnLine(d0, '$' + noms[0] + '$', { color: 'red', taille: 8, usedPosition: [d3nom] })\n *\n * @author Mickael Guironnet\n * Modifications par Jean-Claude Lhote : factorisation dans droites.ts, passage en typescript et utilisation de latex2d  la place de LAtexParCoordonneesBox\n */\nexport function labelOnLine(\n  droite: Droite,\n  nom: string,\n  {\n    preferedPosition = 'auto',\n    usedPosition = [],\n    letterSize = 'footnotesize',\n    color = 'red',\n    backgroundColor = 'white',\n  }: {\n    preferedPosition?: 'left' | 'right' | 'above' | 'below' | 'auto'\n    usedPosition?: Latex2d[]\n    letterSize?: LetterSizeType\n    color?: string\n    backgroundColor?: string\n  } = {},\n): Latex2d | ObjetMathalea2D {\n  const debug = false\n  const largeur = 30\n  const hauteur = 20\n  let absNom, ordNom, leNom, anchor\n  let oneUsedPosition\n  const positions: {\n    label: Latex2d\n    position: string\n    anch: string\n    colision: [number, boolean][]\n  }[] = []\n  if (nom !== '') {\n    if (egal(droite.b, 0, 0.05)) {\n      // ax+c=0 x=-c/a est l'quation de la droite\n      // droite quasi verticale\n      absNom =\n        -droite.c / droite.a +\n        (largeur * 0.5) / context.pixelsParCm +\n        2 / context.pixelsParCm\n      ordNom = context.fenetreMathalea2d[1] + 1 // l'ordonne du label est ymin +1\n      anchor = 'right'\n      oneUsedPosition = 'below'\n      leNom = latex2d(nom, absNom, ordNom, {\n        color,\n        backgroundColor: 'white',\n        letterSize,\n      })\n      positions.push({\n        label: leNom,\n        position: oneUsedPosition,\n        anch: anchor,\n        colision: [],\n      })\n    } else if (egal(droite.a, 0, 0.05)) {\n      // by+c=0 y=-c/b est l'quation de la droite\n      // droite quasi horizontale\n      absNom = context.fenetreMathalea2d[0] + 1 // l'abscisse du label est xmin +1\n      ordNom = -droite.c / droite.b + (hauteur * 0.5) / context.pixelsParCm\n      anchor = 'above'\n      oneUsedPosition = 'left'\n      leNom = latex2d(nom, absNom, ordNom, {\n        color,\n        backgroundColor: 'white',\n        letterSize,\n      })\n      positions.push({\n        label: leNom,\n        position: oneUsedPosition,\n        anch: anchor,\n        colision: [],\n      })\n    } else {\n      // a et b sont diffrents de 0 ax+by+c=0 est l'quation\n      // y=(-a.x-c)/b est l'equation cartsienne et x=(-by-c)/a\n      const y0 =\n        (-droite.a * (context.fenetreMathalea2d[0] + 1) - droite.c) / droite.b\n      const y1 =\n        (-droite.a * (context.fenetreMathalea2d[2] - 1) - droite.c) / droite.b\n      const x0 =\n        (-droite.b * (context.fenetreMathalea2d[1] + 1) - droite.c) / droite.a\n      const x1 =\n        (-droite.b * (context.fenetreMathalea2d[3] - 1) - droite.c) / droite.a\n      if (\n        y0 > context.fenetreMathalea2d[1] &&\n        y0 < context.fenetreMathalea2d[3]\n      ) {\n        //  gauche : soit en dessous ou en dessous\n        absNom = context.fenetreMathalea2d[0] + 1\n        ordNom =\n          y0 -\n          droite.pente * ((largeur * 0.5) / context.pixelsParCm) +\n          ((droite.pente > 0 ? -1 : 1) * hauteur * 0.5) / context.pixelsParCm\n        anchor = droite.pente > 0 ? 'below' : 'above'\n        oneUsedPosition = 'left'\n        if (\n          ordNom < context.fenetreMathalea2d[1] + 1 ||\n          ordNom > context.fenetreMathalea2d[3] - 1\n        ) {\n          if (debug)\n            console.info(\n              'probl:nom:' +\n                nom +\n                ':position:' +\n                oneUsedPosition +\n                (context.fenetreMathalea2d[1] + 1) +\n                '<' +\n                ordNom +\n                '<' +\n                (context.fenetreMathalea2d[3] - 1),\n            )\n        } else {\n          leNom = latex2d(nom, absNom, ordNom, {\n            color,\n            backgroundColor: 'white',\n            letterSize,\n          })\n          positions.push({\n            label: leNom,\n            position: oneUsedPosition,\n            anch: anchor,\n            colision: [],\n          })\n        }\n        //  gauche : soit en dessous ou en dessous\n        absNom = context.fenetreMathalea2d[0] + 1\n        ordNom =\n          y0 +\n          droite.pente * ((largeur * 0.5) / context.pixelsParCm) -\n          ((droite.pente > 0 ? -1 : 1) * hauteur * 0.5) / context.pixelsParCm\n        anchor = droite.pente > 0 ? 'above' : 'below'\n        oneUsedPosition = 'left'\n        if (\n          ordNom < context.fenetreMathalea2d[1] + 1 ||\n          ordNom > context.fenetreMathalea2d[3] - 1\n        ) {\n          if (debug)\n            console.info(\n              'probl:nom:' +\n                nom +\n                ':position:' +\n                oneUsedPosition +\n                (context.fenetreMathalea2d[1] + 1) +\n                '<' +\n                ordNom +\n                '<' +\n                (context.fenetreMathalea2d[3] - 1),\n            )\n        } else {\n          leNom = latex2d(nom, absNom, ordNom, {\n            color,\n            backgroundColor: 'white',\n            letterSize,\n          })\n          positions.push({\n            label: leNom,\n            position: oneUsedPosition,\n            anch: anchor,\n            colision: [],\n          })\n        }\n      }\n      if (\n        y1 > context.fenetreMathalea2d[1] &&\n        y1 < context.fenetreMathalea2d[3]\n      ) {\n        //  droite\n        absNom = context.fenetreMathalea2d[2] - 1\n        ordNom =\n          y1 -\n          droite.pente * ((largeur * 0.5) / context.pixelsParCm) +\n          ((droite.pente > 0 ? -1 : 1) * hauteur * 0.5) / context.pixelsParCm\n        anchor = droite.pente > 0 ? 'below' : 'above'\n        oneUsedPosition = 'right'\n        if (\n          ordNom < context.fenetreMathalea2d[1] + 1 ||\n          ordNom > context.fenetreMathalea2d[3] - 1\n        ) {\n          if (debug)\n            console.info(\n              'probl:nom:' +\n                nom +\n                ':position:' +\n                oneUsedPosition +\n                (context.fenetreMathalea2d[1] + 1) +\n                '<' +\n                ordNom +\n                '<' +\n                (context.fenetreMathalea2d[3] - 1),\n            )\n        } else {\n          leNom = latex2d(nom, absNom, ordNom, {\n            color,\n            backgroundColor: 'white',\n            letterSize,\n          })\n          positions.push({\n            label: leNom,\n            position: oneUsedPosition,\n            anch: anchor,\n            colision: [],\n          })\n        }\n      }\n      if (\n        x0 > context.fenetreMathalea2d[0] &&\n        x0 < context.fenetreMathalea2d[2]\n      ) {\n        // en bas : soit  gauche ou  droite\n        absNom =\n          x0 +\n          ((droite.pente > 0 ? -1 : 1) * largeur * 0.5) / context.pixelsParCm -\n          ((droite.pente > 0 ? 1 : 1) *\n            ((hauteur * 0.5) / context.pixelsParCm)) /\n            droite.pente -\n          ((droite.pente > 0 ? 1 : -1) * 2) / context.pixelsParCm\n        ordNom = context.fenetreMathalea2d[1] + 1\n        anchor = droite.pente > 0 ? 'left' : 'right'\n        oneUsedPosition = 'below'\n        if (\n          absNom < context.fenetreMathalea2d[0] + 1 ||\n          absNom > context.fenetreMathalea2d[2] - 1\n        ) {\n          if (debug)\n            console.info(\n              'problme:nom:' +\n                nom +\n                ':position:' +\n                oneUsedPosition +\n                (context.fenetreMathalea2d[0] + 1) +\n                '<' +\n                absNom +\n                '<' +\n                (context.fenetreMathalea2d[2] - 1),\n            )\n        } else {\n          leNom = latex2d(nom, absNom, ordNom, {\n            color,\n            backgroundColor: 'white',\n            letterSize,\n          })\n          positions.push({\n            label: leNom,\n            position: oneUsedPosition,\n            anch: anchor,\n            colision: [],\n          })\n        }\n        // en bas de l'autre ct\n        absNom =\n          x0 -\n          ((droite.pente > 0 ? -1 : 1) * largeur * 0.5) / context.pixelsParCm +\n          ((droite.pente > 0 ? 1 : 1) *\n            ((hauteur * 0.5) / context.pixelsParCm)) /\n            droite.pente +\n          ((droite.pente > 0 ? 1 : -1) * 2) / context.pixelsParCm\n        ordNom = context.fenetreMathalea2d[1] + 1\n        anchor = droite.pente > 0 ? 'right' : 'left'\n        oneUsedPosition = 'below'\n        if (\n          absNom < context.fenetreMathalea2d[0] + 1 ||\n          absNom > context.fenetreMathalea2d[2] - 1\n        ) {\n          if (debug)\n            console.info(\n              'problme:nom:' +\n                nom +\n                ':position:' +\n                oneUsedPosition +\n                (context.fenetreMathalea2d[0] + 1) +\n                '<' +\n                absNom +\n                '<' +\n                (context.fenetreMathalea2d[2] - 1),\n            )\n        } else {\n          leNom = latex2d(nom, absNom, ordNom, {\n            color,\n            backgroundColor: 'white',\n            letterSize,\n          })\n          positions.push({\n            label: leNom,\n            position: oneUsedPosition,\n            anch: anchor,\n            colision: [],\n          })\n        }\n      }\n      if (\n        x1 > context.fenetreMathalea2d[0] &&\n        x1 < context.fenetreMathalea2d[2]\n      ) {\n        // au haut : soit  gauche ou  droite\n        absNom =\n          x1 +\n          ((droite.pente > 0 ? -1 : 1) * largeur * 0.5) / context.pixelsParCm -\n          ((droite.pente > 0 ? 1 : 1) *\n            ((hauteur * 0.5) / context.pixelsParCm)) /\n            droite.pente -\n          ((droite.pente > 0 ? 1 : -1) * 2) / context.pixelsParCm\n        ordNom = context.fenetreMathalea2d[3] - 1\n        anchor = droite.pente > 0 ? 'left' : 'right'\n        oneUsedPosition = 'above'\n        if (\n          absNom < context.fenetreMathalea2d[0] + 1 ||\n          absNom > context.fenetreMathalea2d[2] - 1\n        ) {\n          if (debug)\n            console.info(\n              'problme:nom:' +\n                nom +\n                ':position:' +\n                oneUsedPosition +\n                (context.fenetreMathalea2d[0] + 1) +\n                '<' +\n                absNom +\n                '<' +\n                (context.fenetreMathalea2d[2] - 1),\n            )\n        } else {\n          leNom = latex2d(nom, absNom, ordNom, {\n            color,\n            backgroundColor: 'white',\n            letterSize,\n          })\n          positions.push({\n            label: leNom,\n            position: oneUsedPosition,\n            anch: anchor,\n            colision: [],\n          })\n        }\n        // au haut de l'autre ct\n        absNom =\n          x1 -\n          ((droite.pente > 0 ? -1 : 1) * largeur * 0.5) / context.pixelsParCm +\n          ((droite.pente > 0 ? 1 : 1) *\n            ((hauteur * 0.5) / context.pixelsParCm)) /\n            droite.pente +\n          ((droite.pente > 0 ? 1 : -1) * 2) / context.pixelsParCm\n        ordNom = context.fenetreMathalea2d[3] - 1\n        anchor = droite.pente > 0 ? 'right' : 'left'\n        oneUsedPosition = 'above'\n        if (\n          absNom < context.fenetreMathalea2d[0] + 1 ||\n          absNom > context.fenetreMathalea2d[2] - 1\n        ) {\n          if (debug)\n            console.info(\n              'problme:nom:' +\n                nom +\n                ':position:' +\n                oneUsedPosition +\n                (context.fenetreMathalea2d[0] + 1) +\n                '<' +\n                absNom +\n                '<' +\n                (context.fenetreMathalea2d[2] - 1),\n            )\n        } else {\n          leNom = latex2d(nom, absNom, ordNom, {\n            color,\n            backgroundColor: 'white',\n            letterSize,\n          })\n          positions.push({\n            label: leNom,\n            position: oneUsedPosition,\n            anch: anchor,\n            colision: [],\n          })\n        }\n      }\n      let xgauche, xdroite\n      if (\n        y0 > context.fenetreMathalea2d[1] &&\n        y0 < context.fenetreMathalea2d[3]\n      ) {\n        xgauche = context.fenetreMathalea2d[0]\n      } else {\n        xgauche = Math.min(x0, x1)\n      }\n      if (\n        y1 > context.fenetreMathalea2d[1] &&\n        y1 < context.fenetreMathalea2d[3]\n      ) {\n        xdroite = context.fenetreMathalea2d[2]\n      } else {\n        xdroite = Math.max(x0, x1)\n      }\n      // au milieu\n      absNom = (xgauche + xdroite) / 2\n      ordNom = pointSurDroite(droite, absNom, '').y\n      anchor = droite.pente > 0 ? 'left' : 'right'\n      oneUsedPosition = 'middle'\n      leNom = latex2d(nom, absNom, ordNom, {\n        color,\n        backgroundColor: 'white',\n        letterSize,\n      })\n      positions.push({\n        label: leNom,\n        position: oneUsedPosition,\n        anch: anchor,\n        colision: [],\n      })\n    }\n    leNom = latex2d(nom, absNom, ordNom, {\n      color,\n      backgroundColor: 'white',\n      letterSize,\n    })\n\n    // vrifie s'il y a des colisions entre labels\n    for (let i = 0; i < positions.length; i++) {\n      if (positions[i].position === 'middle') continue\n      const coli: [number, boolean][] = []\n      for (let j = 0; j < usedPosition.length; j++) {\n        const label = usedPosition[j]\n        const dis =\n          segment(\n            point(label.x, label.y),\n            point(positions[i].label.x, positions[i].label.y),\n          ).longueur * context.pixelsParCm\n        // colision deux rectangles\n        const XYlabel = [\n          label.x * context.pixelsParCm - largeur / 2,\n          label.x * context.pixelsParCm + largeur / 2,\n          label.y * context.pixelsParCm - hauteur / 2,\n          label.y * context.pixelsParCm + hauteur / 2,\n        ]\n        const XYlabel2 = [\n          positions[i].label.x * context.pixelsParCm - largeur / 2,\n          positions[i].label.x * context.pixelsParCm + largeur / 2,\n          positions[i].label.y * context.pixelsParCm - hauteur / 2,\n          positions[i].label.y * context.pixelsParCm + hauteur / 2,\n        ]\n        if (debug)\n          console.info(\n            'coli:nom:' +\n              nom +\n              ':position:' +\n              positions[i].position +\n              ':i:' +\n              i +\n              ':j:' +\n              j +\n              ':dis:' +\n              dis.toFixed(2) +\n              ':texte:' +\n              label.latex +\n              ':XYlabel:' +\n              XYlabel[0].toFixed(1) +\n              ',' +\n              XYlabel[1].toFixed(1) +\n              ',' +\n              XYlabel[2].toFixed(1) +\n              ',' +\n              XYlabel[3].toFixed(1) +\n              ':XYlabel2:' +\n              XYlabel2[0].toFixed(1) +\n              ',' +\n              XYlabel2[1].toFixed(1) +\n              ',' +\n              XYlabel2[2].toFixed(1) +\n              ',' +\n              XYlabel2[3].toFixed(1),\n          )\n        const colision =\n          XYlabel[0] < XYlabel2[1] &&\n          XYlabel[1] > XYlabel2[0] &&\n          XYlabel[2] < XYlabel2[3] &&\n          XYlabel[3] > XYlabel2[2]\n        // colision deux cercles\n        const r0 = Math.max(largeur / 2, hauteur / 2)\n        const r1 = Math.max(largeur / 2, hauteur / 2)\n        let colision2 = true\n        if (dis > r0 + r1 || dis < Math.abs(r0 - r1)) colision2 = false\n        coli[j] = [dis, colision]\n        if (debug)\n          console.info(\n            'coli:nom:' +\n              nom +\n              ':position:' +\n              positions[i].position +\n              ':anchor:' +\n              positions[i].anch +\n              ':i:' +\n              i +\n              ':j:' +\n              j +\n              ':dis:' +\n              dis.toFixed(2) +\n              'texte:' +\n              label.latex +\n              ':colision:' +\n              (colision ? '1' : '0') +\n              ':coli_cer:' +\n              (colision2 ? '1' : '0'),\n          )\n      }\n      positions[i].colision = [...coli]\n    }\n    // 1ere stratgie : la prfrence de l'utilisateur\n    // on vrifie seulement s'il y a une colision\n    const found: [boolean, number] = [false, 0]\n    for (let i = 0; i < positions.length && !found[0]; i++) {\n      if (positions[i].position === 'middle') continue\n      if (positions[i].position === preferedPosition) {\n        found[0] = true\n        for (let j = 0; j < usedPosition.length; j++) {\n          if (positions[i].colision[j][1]) found[0] = false\n          if (debug)\n            console.info(\n              '1er:nom:' +\n                nom +\n                ':position:' +\n                positions[i].position +\n                ':i:' +\n                i +\n                ':j:' +\n                j +\n                ':colision:' +\n                positions[i].colision[j][1] +\n                ':preferedPosition:' +\n                preferedPosition,\n            )\n        }\n        found[1] = i\n      }\n    }\n\n    // 2e stratgie : le plus loin en terme de distance!\n    let disMax = [0, 0, 0]\n    for (\n      let i = 0;\n      i < positions.length && !found[0] && usedPosition.length > 0;\n      i++\n    ) {\n      if (positions[i].position === 'middle') continue\n      let dis = [1000, 0, 0]\n      for (let j = 0; j < usedPosition.length; j++) {\n        if (positions[i].colision[j][0] < dis[0]) {\n          dis = [positions[i].colision[j][0], i, j]\n          if (debug)\n            console.info(\n              '2e:nom:' +\n                nom +\n                ':position:' +\n                positions[i].position +\n                ':anchor:' +\n                positions[i].anch +\n                ':i:' +\n                i +\n                ':j:' +\n                j +\n                'dis:' +\n                dis[0].toFixed(2) +\n                ':colision:' +\n                positions[i].colision[j][1],\n            )\n        }\n      }\n      if (dis[0] > disMax[0]) {\n        disMax = dis\n        if (debug)\n          console.info(\n            'Max 2e:nom:' +\n              nom +\n              ':position:' +\n              positions[i].position +\n              ':anchor:' +\n              positions[i].anch +\n              ':i:' +\n              i +\n              'dis:' +\n              dis[0].toFixed(2),\n          )\n      }\n    }\n    let colision = false\n    if (disMax[0] > 0) {\n      colision = positions[disMax[1]].colision[disMax[2]][1]\n      if (debug)\n        console.info(\n          'Max fin : 2e:nom:' +\n            nom +\n            ':position:' +\n            positions[disMax[1]].position +\n            ':anchor:' +\n            positions[disMax[1]].anch +\n            ':i:' +\n            disMax[1] +\n            ':j:' +\n            disMax[2] +\n            'disMax:' +\n            disMax[0] +\n            ':colision:' +\n            positions[disMax[1]].colision[disMax[2]][1],\n        )\n    }\n    // 1er : si prfrence alors Ok sinon distance la plus loin sans chevauchement sinon la premire solution si pas de comparaison sinon la dernire milieu\n    leNom = found[0]\n      ? positions[found[1]].label\n      : disMax[0] > 0 && !colision\n        ? positions[disMax[1]].label\n        : positions[usedPosition.length === 0 ? 0 : positions.length - 1].label\n  } else {\n    leNom = vide2d()\n  }\n  return leNom\n}\n\n/**\n * Afin de rgler le problme des noms de droites en latex qui ne peuvent se fondre dans le svg, cette fonction retourne un Array de deux objets :\n * Le premier est la droite (avec toutes ses proprits et mthodes)\n * Le deuxime est un objet latexParCoordonnees\n * @param {Droite} d\n * @param {string} nom\n * @param {string} color\n * @returns {[Droite, LatexParCoordonnees|Vide2d]}\n */\nexport function droiteAvecNomLatex(d: Droite, nom: string, color = 'black') {\n  // nom est un latexParCoordonnees\n  d.color = colorToLatexOrHTML(color ?? 'black')\n  let absNom, ordNom\n  d.epaisseur = 1\n  d.opacite = 1\n  if (egal(d.b, 0, 0.05)) {\n    // ax+c=0 x=-c/a est l'quation de la droite\n    absNom = -d.c / d.a + 0.8 // l'abscisse du label est dcal de 0.8\n    ordNom = context.fenetreMathalea2d[1] + 1 // l'ordonne du label est ymin +1\n  } else if (egal(d.a, 0, 0.05)) {\n    // by+c=0 y=-c/b est l'quation de la droite\n    absNom = context.fenetreMathalea2d[0] + 0.8 // l'abscisse du label est xmin +1\n    ordNom = -d.c / d.b + 0.8 // l'ordonne du label est dcale de 0.8\n  } else {\n    // a et b sont diffrents de 0 ax+by+c=0 est l'quation\n    // y=(-a.x-c)/b est l'aquation cartsienne et x=(-by-c)/a\n    const y0 = (-d.a * (context.fenetreMathalea2d[0] + 1) - d.c) / d.b\n    const y1 = (-d.a * (context.fenetreMathalea2d[2] - 1) - d.c) / d.b\n    const x0 = (-d.b * (context.fenetreMathalea2d[1] + 1) - d.c) / d.a\n    const x1 = (-d.b * (context.fenetreMathalea2d[3] - 1) - d.c) / d.a\n    if (\n      y0 > context.fenetreMathalea2d[1] &&\n      y0 < context.fenetreMathalea2d[3]\n    ) {\n      absNom = context.fenetreMathalea2d[0] + 1\n      ordNom = y0 + d.pente\n    } else {\n      if (\n        y1 > context.fenetreMathalea2d[1] &&\n        y1 < context.fenetreMathalea2d[3]\n      ) {\n        absNom = context.fenetreMathalea2d[2] - 1\n        ordNom = y1 - d.pente\n      } else {\n        if (\n          x0 > context.fenetreMathalea2d[0] &&\n          x0 < context.fenetreMathalea2d[2]\n        ) {\n          absNom = x0\n          ordNom = context.fenetreMathalea2d[1] + Math.abs(d.pente)\n        } else {\n          if (\n            x1 > context.fenetreMathalea2d[0] &&\n            x1 < context.fenetreMathalea2d[2]\n          ) {\n            absNom = x1\n            ordNom = context.fenetreMathalea2d[3] + d.pente\n          } else {\n            absNom =\n              (context.fenetreMathalea2d[0] + context.fenetreMathalea2d[2]) / 2\n            ordNom = pointSurDroite(d, absNom, '').y\n          }\n        }\n      }\n    }\n  }\n  const leNom = latex2d(nom, absNom, ordNom, {\n    color,\n  })\n  return [d, leNom]\n}\n\n/**  Trace une droite\n * @param {Point | number} arg1 Premier point de la droite OU BIEN coefficient a de l'quation de la droite ax+by+c=0\n * @param {Point | number} arg2 Deuxime point de la droite OU BIEN coefficient b de l'quation de la droite ax+by+c=0\n * @param {string | number} arg3 Nom affich de la droite OU BIEN coefficient c de l'quation de la droite ax+by+c=0\n * @param {string} arg4 Couleur de la droite : du type 'blue' ou du type '#f15929' OU BIEN Nom affich de la droite si arg1 est un nombre\n * @param {string} arg5 Couleur de la droite : du type 'blue' ou du type '#f15929' si arg1 est un nombre\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} svgml Sortie,  main leve, au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} tikzml Sortie,  main leve, au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {number} a Coefficient a de l'quation de la droite ax+by+c=0\n * @property {number} b Coefficient b de l'quation de la droite ax+by+c=0\n * @property {number} c Coefficient c de l'quation de la droite ax+by+c=0\n * @property {number} x1 Abscisse de arg1 (si ce point existe)\n * @property {number} y1 Ordonne de arg1 (si ce point existe)\n * @property {number} x2 Abscisse de arg2 (si ce point existe)\n * @property {number} y2 Ordonne de arg2 (si ce point existe)\n * @property {string} nom Nom affich de la droite\n * @property {string} color Couleur de la droite.  associer obligatoirement  colorToLatexOrHTML().\n * @property {Vecteur} normal Vecteur normal de la droite\n * @property {Vecteur} directeur Vecteur directeur de la droite\n * @property {number} angleAvecHorizontale Valeur de l'angle orient entre la droite et l'horizontale\n * @property {number} epaisseur\n * @property {number} pointilles\n * @property {number} opacite\n * @author Jean-Claude Lhote\n * @class\n */\n// JSDOC Validee par EE Aout 2022\nexport class Droite extends ObjetMathalea2D {\n  x1: number\n  x2: number\n  y1: number\n  y2: number\n  a: number\n  b: number\n  c: number\n  pente: number\n  angleAvecHorizontale: number\n  nom: string\n  normal: Vecteur\n  directeur: Vecteur\n  stringColor: string\n  leNom?: TexteParPoint\n  constructor(\n    arg1: number | PointAbstrait,\n    arg2: number | PointAbstrait,\n    arg3?: number | string,\n    arg4?: number | string,\n    arg5?: string,\n  ) {\n    super()\n    let a, b, c\n    this.stringColor = 'black'\n\n    if (arguments.length === 2) {\n      if (arg1 instanceof PointAbstrait && arg2 instanceof PointAbstrait) {\n        this.x1 = arg1.x\n        this.x2 = arg2.x\n        this.y1 = arg1.y\n        this.y2 = arg2.y\n      } else {\n        window.notify(\n          'Droite : (attendus : A et B) les arguments de sont pas des points valides',\n          {\n            arg1,\n            arg2,\n          },\n        )\n        this.x1 = 0\n        this.x2 = 0\n        this.y1 = 0\n        this.y2 = 0\n      }\n      this.nom = ''\n      this.pointilles = 0\n      this.opacite = 1\n      this.epaisseur = 1\n      this.a = this.y1 - this.y2\n      this.b = this.x2 - this.x1\n      this.c = (this.x1 - this.x2) * this.y1 + (this.y2 - this.y1) * this.x1\n      this.pente = NaN\n    } else if (arguments.length === 3) {\n      if (typeof arg1 === 'number') {\n        if (isNaN(arg1) || Number.isNaN(arg2) || Number.isNaN(arg3)) {\n          window.notify(\n            'Droite : (attendus : a, b et c) les arguments de sont pas des nombres valides',\n            {\n              arg1,\n              arg2,\n              arg3,\n            },\n          )\n        }\n\n        // droite d'quation ax +by +c =0\n        this.nom = ''\n        this.a = Number(arg1)\n        this.b = Number(arg2)\n        this.c = Number(arg3)\n        a = Number(arg1)\n        b = Number(arg2)\n        c = Number(arg3)\n        if (egal(a, 0)) {\n          this.x1 = 0\n          this.x2 = 1\n          this.y1 = -c / b\n          this.y2 = -c / b\n        } else if (egal(b, 0)) {\n          this.y1 = 0\n          this.y2 = 1\n          this.x1 = -c / a\n          this.x2 = -c / a\n        } else {\n          this.x1 = 0\n          this.y1 = -c / b\n          this.x2 = 1\n          this.y2 = (-c - a) / b\n        }\n      } else {\n        if (\n          isNaN(arg1.x) ||\n          isNaN(arg1.y) ||\n          isNaN((arg2 as Point).x) ||\n          isNaN((arg2 as Point).y)\n        ) {\n          window.notify(\n            'Droite : (attendus : A, B et \"nom\") les arguments de sont pas des points valides',\n            {\n              arg1,\n              arg2,\n            },\n          )\n        }\n        this.x1 = arg1.x\n        this.y1 = arg1.y\n        this.x2 = (arg2 as Point).x\n        this.y2 = (arg2 as Point).y\n        this.a = this.y1 - this.y2\n        this.b = this.x2 - this.x1\n        this.c = (this.x1 - this.x2) * this.y1 + (this.y2 - this.y1) * this.x1\n        this.nom = String(arg3)\n      }\n    } else if (arguments.length === 4) {\n      if (typeof arg1 === 'number') {\n        if (isNaN(arg1) || Number.isNaN(arg2) || Number.isNaN(arg3)) {\n          window.notify(\n            'Droite : (attendus : a, b, c et \"nom\") les arguments de sont pas des nombres valides',\n            {\n              arg1,\n              arg2,\n              arg3,\n            },\n          )\n        }\n        this.a = Number(arg1)\n        this.b = Number(arg2)\n        this.c = Number(arg3)\n        a = Number(arg1)\n        b = Number(arg2)\n        c = Number(arg3)\n        this.nom = String(arg4)\n        if (egal(a, 0)) {\n          this.x1 = 0\n          this.x2 = 1\n          this.y1 = -c / b\n          this.y2 = -c / b\n        } else if (egal(b, 0)) {\n          this.y1 = 0\n          this.y2 = 1\n          this.x1 = -c / a\n          this.x2 = -c / a\n        } else {\n          this.x1 = 0\n          this.y1 = -c / b\n          this.x2 = 1\n          this.y2 = (-c - a) / b\n        }\n      } else {\n        if (\n          isNaN(arg1.x) ||\n          isNaN(arg1.y) ||\n          isNaN((arg2 as Point).x) ||\n          isNaN((arg2 as Point).y)\n        ) {\n          window.notify(\n            'Droite : (attendus : A, B, \"nom\" et \"couleur\") les arguments de sont pas des points valides',\n            {\n              arg1,\n              arg2,\n            },\n          )\n        }\n        this.x1 = arg1.x\n        this.y1 = arg1.y\n        this.x2 = (arg2 as Point).x\n        this.y2 = (arg2 as Point).y\n        this.a = this.y1 - this.y2\n        this.b = this.x2 - this.x1\n        this.c = (this.x1 - this.x2) * this.y1 + (this.y2 - this.y1) * this.x1\n        this.nom = String(arg3)\n        this.color = colorToLatexOrHTML(String(arg4))\n        this.stringColor = String(arg4)\n      }\n    } else {\n      // arguments.length === 5\n      if (Number.isNaN(arg1) || Number.isNaN(arg2) || Number.isNaN(arg3)) {\n        window.notify(\n          'Droite : (attendus : a, b, c et \"nom\") les arguments de sont pas des nombres valides',\n          {\n            arg1,\n            arg2,\n            arg3,\n          },\n        )\n      }\n      this.a = Number(arg1)\n      this.b = Number(arg2)\n      this.c = Number(arg3)\n      a = Number(arg1)\n      b = Number(arg2)\n      c = Number(arg3)\n      this.nom = String(arg4)\n      this.color = colorToLatexOrHTML(String(arg5))\n      this.stringColor = String(arg5)\n      if (egal(a, 0)) {\n        this.x1 = 0\n        this.x2 = 1\n        this.y1 = -c / b\n        this.y2 = -c / b\n      } else if (egal(b, 0)) {\n        this.y1 = 0\n        this.y2 = 1\n        this.x1 = -c / a\n        this.x2 = -c / a\n      } else {\n        this.x1 = 0\n        this.y1 = -c / b\n        this.x2 = 1\n        this.y2 = (-c - a) / b\n      }\n    }\n    if (this.b !== 0) this.pente = -this.a / this.b\n    else this.pente = NaN\n    let xsav, ysav\n    if (this.x1 > this.x2) {\n      xsav = this.x1\n      ysav = this.y1\n      this.x1 = this.x2 + 0\n      this.y1 = this.y2 + 0\n      this.x2 = xsav\n      this.y2 = ysav\n    }\n    // Limiter la taille des coordonnes  2 dcimales amplement suffisantes\n    this.x1 = arrondi(this.x1, 2)\n    this.y1 = arrondi(this.y1, 2)\n    this.x2 = arrondi(this.x2, 2)\n    this.y2 = arrondi(this.y2, 2)\n\n    this.normal = vecteur(this.a, this.b)\n    this.directeur = vecteur(this.b, -this.a)\n    this.angleAvecHorizontale = angleOriente(\n      point(1, 0),\n      point(0, 0),\n      point(this.directeur.x, this.directeur.y),\n    )\n    this.bordures = [\n      Math.min(this.x1, this.x2),\n      Math.min(this.y1, this.y2),\n      Math.max(this.x1, this.x2),\n      Math.max(this.y1, this.y2),\n    ]\n    let absNom: number\n    let ordNom: number\n    if (this.nom !== '') {\n      if (egal(this.b, 0, 0.05)) {\n        // ax+c=0 x=-c/a est l'quation de la droite\n        absNom = -this.c / this.a + 0.8 // l'abscisse du label est dcal de 0.8\n        ordNom = context.fenetreMathalea2d[1] + 1 // l'ordonne du label est ymin +1\n      } else if (egal(this.a, 0, 0.05)) {\n        // by+c=0 y=-c/b est l'quation de la droite\n        absNom = context.fenetreMathalea2d[0] + 0.8 // l'abscisse du label est xmin +1\n        ordNom = -this.c / this.b + 0.8 // l'ordonne du label est dcale de 0.8\n      } else {\n        // a et b sont diffrents de 0 ax+by+c=0 est l'quation\n        // y=(-a.x-c)/b est l'aquation cartsienne et x=(-by-c)/a\n        const y0 =\n          (-this.a * (context.fenetreMathalea2d[0] + 1) - this.c) / this.b\n        const y1 =\n          (-this.a * (context.fenetreMathalea2d[2] - 1) - this.c) / this.b\n        const x0 =\n          (-this.b * (context.fenetreMathalea2d[1] + 1) - this.c) / this.a\n        const x1 =\n          (-this.b * (context.fenetreMathalea2d[3] - 1) - this.c) / this.a\n        if (\n          y0 > context.fenetreMathalea2d[1] &&\n          y0 < context.fenetreMathalea2d[3]\n        ) {\n          absNom = context.fenetreMathalea2d[0] + 1\n          ordNom = y0 + this.pente\n        } else {\n          if (\n            y1 > context.fenetreMathalea2d[1] &&\n            y1 < context.fenetreMathalea2d[3]\n          ) {\n            absNom = context.fenetreMathalea2d[2] - 1\n            ordNom = y1 - this.pente\n          } else {\n            if (\n              x0 > context.fenetreMathalea2d[0] &&\n              x0 < context.fenetreMathalea2d[2]\n            ) {\n              absNom = x0\n              ordNom = context.fenetreMathalea2d[1] + Math.abs(this.pente)\n            } else {\n              if (\n                x1 > context.fenetreMathalea2d[0] &&\n                x1 < context.fenetreMathalea2d[2]\n              ) {\n                absNom = x1\n                ordNom = context.fenetreMathalea2d[3] + this.pente\n              } else {\n                absNom =\n                  (context.fenetreMathalea2d[0] +\n                    context.fenetreMathalea2d[2]) /\n                  2\n                ordNom = pointSurDroite(this, absNom, '').y\n              }\n            }\n          }\n        }\n      }\n      // if (this.nom.includes('$')) {\n      //   this.leNom = latex2d(this.nom.replaceAll('$', ''), absNom, ordNom, { color: this.stringColor })\n      // } else {\n      this.leNom = texteParPosition(\n        this.nom,\n        absNom,\n        ordNom,\n        0,\n        this.stringColor,\n        1,\n        'milieu',\n        true,\n      ) as TexteParPoint\n      //  }\n    }\n\n    if (this.nom.includes('$')) {\n      // On a du Latex, donc on ne peut pas utiliser droite() tel quel.\n      window.notify(\n        \"Droite() appel avec un nom contenant du Latex... utiliser droiteAvecNom()  la place !\\nOn va retourner un array contenant la droite et un latexParCoordonnees dans un proche avenir !\\nIl faut donc adapter l'exo qui a provoqu a.\\n Pour l'instant on retourne une droite sans nom.\",\n        { nom: this.nom },\n      )\n      // On retourne une droite sans nom accompagne de son nom Latex\n      // return droiteAvecNomLAtex(new Droite(point(this.x1, this.y1), point(this.x2, this.y2)), leNom)\n      // @fixme la ligne suivante sera  retirer lorsque les exos concerns auront t reprs. Et la prcdente  utiliser.\n      return new Droite(point(this.x1, this.y1), point(this.x2, this.y2)) // On retourne une droite sans nom en attendant que quelqu'un adapte l'exo et utilise droiteAvecNom()  la place de droite.\n    }\n  }\n\n  svg(coeff: number) {\n    if (this.epaisseur !== 1) {\n      this.style += ` stroke-width=\"${this.epaisseur}\" `\n    }\n    switch (this.pointilles) {\n      case 1:\n        this.style += ' stroke-dasharray=\"6 10\" '\n        break\n      case 2:\n        this.style += ' stroke-dasharray=\"6 3\" '\n        break\n      case 3:\n        this.style += ' stroke-dasharray=\"3 2 6 2 \" '\n        break\n      case 4:\n        this.style += ' stroke-dasharray=\"1 2\" '\n        break\n      case 5:\n        this.style += ' stroke-dasharray=\"5 5\" '\n        break\n    }\n    if (this.opacite !== 1) {\n      this.style += ` stroke-opacity=\"${this.opacite}\" `\n    }\n    const A = point(this.x1, this.y1)\n    const B = point(this.x2, this.y2)\n    const A1 = pointSurSegment(A, B, -50)\n    const B1 = pointSurSegment(B, A, -50)\n    if (this.nom === '') {\n      return `<line x1=\"${A1.xSVG(coeff)}\" y1=\"${A1.ySVG(coeff)}\" x2=\"${B1.xSVG(\n        coeff,\n      )}\" y2=\"${B1.ySVG(coeff)}\" stroke=\"${this.color[0]}\" ${this.style} id =\"${this.id}\" />`\n    } else {\n      return (\n        `<line x1=\"${A1.xSVG(coeff)}\" y1=\"${A1.ySVG(coeff)}\" x2=\"${B1.xSVG(\n          coeff,\n        )}\" y2=\"${B1.ySVG(coeff)}\" stroke=\"${this.color[0]}\" ${this.style} id =\"${this.id}\" />` +\n        (this.leNom != null ? (this.leNom?.svg(coeff) ?? '') : '')\n      )\n    }\n  }\n\n  tikz() {\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color=${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width = ${this.epaisseur}`)\n    }\n    switch (this.pointilles) {\n      case 1:\n        tableauOptions.push(' dash dot ')\n        break\n      case 2:\n        tableauOptions.push(' densely dash dot dot ')\n        break\n      case 3:\n        tableauOptions.push(' dash dot dot ')\n        break\n      case 4:\n        tableauOptions.push(' dotted ')\n        break\n      case 5:\n        tableauOptions.push(' dashed ')\n        break\n    }\n\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity = ${this.opacite}`)\n    }\n\n    let optionsDraw = ''\n    if (tableauOptions.length > 0) {\n      optionsDraw = '[' + tableauOptions.join(',') + ']'\n    }\n    const A = point(this.x1, this.y1)\n    const B = point(this.x2, this.y2)\n    const A1 = pointSurSegment(A, B, -50)\n    const B1 = pointSurSegment(B, A, -50)\n\n    if (this.nom !== '') {\n      return (\n        `\\\\draw${optionsDraw} (${A1.x},${A1.y})--(${B1.x},${B1.y});` +\n        (this.leNom != null ? (this.leNom?.tikz() ?? '') : '')\n      )\n    } else {\n      return `\\\\draw${optionsDraw} (${A1.x},${A1.y})--(${B1.x},${B1.y});`\n    }\n  }\n\n  svgml(coeff: number, amp: number) {\n    const A = point(this.x1, this.y1)\n    const B = point(this.x2, this.y2)\n    const A1 = pointSurSegment(A, B, -50)\n    const B1 = pointSurSegment(B, A, -50)\n    const s = segment(A1, B1, this.color[0])\n    return s.svgml(coeff, amp)\n  }\n\n  tikzml(amp: number) {\n    const A = point(this.x1, this.y1)\n    const B = point(this.x2, this.y2)\n    const A1 = pointSurSegment(A, B, -50)\n    const B1 = pointSurSegment(B, A, -50)\n    const s = segment(A1, B1, this.color[1])\n    return s.tikzml(amp)\n  }\n}\n\n/**  Trace une droite dfinie par 2 points OU BIEN par les coefficients de son quation\n * @property {number} epaisseur\n * @param {PointAbstrait | number} arg1 Premier point de la droite OU BIEN coefficient a de l'quation de la droite ax+by+c=0 avec (a,b)!=(0,0)\n * @param {PointAbstrait | number} arg2 Deuxime point de la droite OU BIEN coefficient b de l'quation de la droite ax+by+c=0 avec (a,b)!=(0,0)\n * @param {string | number} arg3 Nom affich de la droite OU BIEN coefficient c de l'quation de la droite ax+by+c=0\n * @param {string} arg4 Couleur de la droite : du type 'blue' ou du type '#f15929' OU BIEN nom affich de la droite si arg1 est un nombre\n * @param {string} arg5 Couleur de la droite : du type 'blue' ou du type '#f15929' si arg1 est un nombre\n * @example droite(M, N, '(d1)') // Trace la droite passant par M et N se nommant (d1) et de couleur noire\n * @example droite(M, N, '(d1)','blue') // Trace la droite passant par M et N se nommant (d1) et de couleur bleue\n * @example droite(m, n, p) // Trace la droite dfinie par les coefficients de mx+ny+p=0 et de couleur noire\n * @example droite(m, n, p, '(d1)', 'red') // Trace la droite dfinie par les coefficients de mx+ny+p=0, se nommant (d1) et de couleur rouge\n * @author Jean-Claude Lhote\n * @return {Droite}\n */\nexport function droite(\n  arg1: number | PointAbstrait,\n  arg2: number | PointAbstrait,\n  arg3?: number | string,\n  arg4?: number | string,\n  arg5?: string,\n) {\n  if (arguments.length === 2) return new Droite(arg1, arg2)\n  if (arguments.length === 3) return new Droite(arg1, arg2, arg3)\n  if (arguments.length === 4) return new Droite(arg1, arg2, arg3, arg4)\n  return new Droite(arg1, arg2, arg3, arg4, arg5)\n}\n\n/**  Donne la position du point A par rapport  la droite d\n * @param {Droite} d\n * @param {Point} A\n * @param {number} [tolerance = 0.0001] Seuil de tolrance pour valuer la proximit entre d et A.\n * @example dessousDessus(d1, M) // Renvoie la position de M par rapport  d1 parmi ces 5 possibilits : 'sur', 'droite', 'gauche', 'dessous', 'dessus'\n * @example dessousDessus(d1, M, 0.005) // Renvoie la position de M par rapport  d1 parmi ces 5 possibilits : 'sur', 'droite', 'gauche', 'dessous', 'dessus' (avec une tolrance de 0,005)\n * @return {'sur' | 'droite' | 'gauche' | 'dessous' | 'dessus'}\n */\n// JSDOC Validee par EE Aout 2022\n\nexport function dessousDessus(d: Droite, A: Point, tolerance = 0.0001) {\n  if (egal(d.a * A.x + d.b * A.y + d.c, 0, tolerance)) return 'sur'\n  if (egal(d.b, 0)) {\n    if (A.x < -d.c / d.a) return 'gauche'\n    else return 'droite'\n  } else {\n    if (d.a * A.x + d.b * A.y + d.c < 0) return 'dessous'\n    else return 'dessus'\n  }\n}\n\n/**\n *\n * @param {Droite} d\n * @param {object} param1 les bordures de la fentre\n * @param {number} param1.xmin\n * @param {number} param1.xmax\n * @param {number} param1.ymin\n * @param {number} param1.ymax\n * @return {Point} le point qui servira  placer le label.\n */\nexport function positionLabelDroite(\n  d: Droite,\n  { xmin = 0, ymin = 0, xmax = 10, ymax = 10 },\n) {\n  let xLab, yLab\n  let fXmax, fYmax, fXmin, fYmin\n  if (d.b === 0) {\n    // Si la droite est verticale son quation est x = -d.c/d.a on choisit un label au Nord.\n    xLab = -d.b / d.c - 0.5\n    yLab = ymax - 0.5\n  } else {\n    // la droite n'tant pas verticale, on peut chercher ses intersections avec les diffrents bords.\n    const f = (x: number) => (-d.c - d.a * x) / d.b\n    fXmax = f(xmax)\n    if (fXmax <= ymax && fXmax >= ymin) {\n      // la droite coupe le bord Est entre ymin+1 et ymax-1\n      xLab = xmax - 0.8\n      yLab = f(xLab)\n    } else {\n      fXmin = f(xmin)\n      if (fXmin <= ymax && fXmin >= ymin) {\n        xLab = xmin + 0.8\n        yLab = f(xLab)\n      } else {\n        // la droite ne coupe ni la bordue Est ni la bordure Ouest elle coupe donc les bordures Nord et Sud\n        const g = (y: number) => (-d.c - d.b * y) / d.a\n        fYmax = g(ymax)\n        if (fYmax <= xmax && fYmax >= xmin) {\n          yLab = ymax - 0.8\n          xLab = g(yLab)\n        } else {\n          fYmin = g(ymin)\n          if (fYmin <= xmax && fYmin >= xmin) {\n            yLab = ymin + 0.8\n            xLab = g(yLab)\n          } else {\n            // La droite ne passe pas dans la fentre on retourne un objet vide\n            return vide2d()\n          }\n        }\n      }\n    }\n  }\n  const position = translation(\n    point(xLab, yLab),\n    homothetie(\n      vecteur(d.a, d.b),\n      point(0, 0),\n      0.5 / norme(vecteur(d.a, d.b)),\n    ) as Vecteur,\n  )\n  return position\n}\n\n/**  Trace la droite passant par le point A et de vecteur directeur v\n * @param {PointAbstrait} A Point de la droite\n * @param {Vecteur} v Vecteur directeur de la droite\n * @param {string} [nom = ''] Nom affich de la droite\n * @param {string} [color = 'black'] Couleur de la droite : du type 'blue' ou du type '#f15929'\n * @example droiteParPointEtVecteur(M, v1) // Trace la droite passant par le point M et de vecteur directeur v1\n * @example droiteParPointEtVecteur(M, v1, 'd1', 'red') // Trace, en rouge, la droite d1 passant par le point M et de vecteur directeur v1\n * @author Jean-Claude Lhote\n * @return {Droite}\n */\n// JSDOC Validee par EE Aout 2022\nexport function droiteParPointEtVecteur(\n  A: PointAbstrait,\n  v: Vecteur,\n  nom = '',\n  color = 'black',\n) {\n  const B = point(A.x + v.x, A.y + v.y)\n  return new Droite(A, B, nom, color)\n}\n\n/**  Trace la droite parallle  d passant par le point A\n * @param {PointAbstrait} A Point de la droite\n * @param {Droite} d Droite\n * @param {string} [nom = ''] Nom affich de la droite\n * @param {string} [color = 'black'] Couleur de la droite : du type 'blue' ou du type '#f15929'\n * @example droiteParPointEtParallele(M, d2) // Trace la droite parallle  d2 passant par le point M\n * @example droiteParPointEtParallele(M, d2, 'd1', 'red') // Trace, en rouge, la droite d1 parallle  d2 passant par le point M\n * @author Jean-Claude Lhote\n * @return {Droite}\n */\n// JSDOC Validee par EE Aout 2022\nexport function droiteParPointEtParallele(\n  A: PointAbstrait,\n  d: Droite,\n  nom = '',\n  color = 'black',\n) {\n  return droiteParPointEtVecteur(A, d.directeur, nom, color)\n}\n\n/**  Trace la droite perpendiculaire  d passant par le point A\n * @param {PointAbstrait} A Point de la droite\n * @param {Droite} d Droite\n * @param {string} [nom = ''] Nom affich de la droite\n * @param {string} [color = 'black'] Couleur de la droite : du type 'blue' ou du type '#f15929'\n * @example droiteParPointEtPerpendiculaire(M, d2) // Trace la droite perpendiculaire  d2 passant par le point M\n * @example droiteParPointEtPerpendiculaire(M, d2, 'd1', 'red') // Trace, en rouge, la droite d1 perpendiculaire  d2 passant par le point M\n * @author Jean-Claude Lhote\n * @return {Droite}\n */\n// JSDOC Validee par EE Aout 2022\nexport function droiteParPointEtPerpendiculaire(\n  A: PointAbstrait,\n  d: Droite,\n  nom = '',\n  color = 'black',\n) {\n  return droiteParPointEtVecteur(A, d.normal, nom, color)\n}\n\n/**  Trace la droite horizontale passant par le point A\n * @param {Point} A Point de la droite\n * @param {string} [nom = ''] Nom affich de la droite\n * @param {string} [color = 'black'] Couleur de la droite : du type 'blue' ou du type '#f15929'\n * @example droiteHorizontaleParPoint(M) // Trace la droite horizontale passant par le point M\n * @example droiteHorizontaleParPoint(M, 'd1', 'red') // Trace, en rouge, la droite horizontale d1 passant par le point M\n * @author Jean-Claude Lhote\n * @return {Droite}\n */\n// JSDOC Validee par EE Aout 2022\nexport function droiteHorizontaleParPoint(A: Point, nom = '', color = 'black') {\n  return droiteParPointEtPente(A, 0, nom, color)\n}\n\n/**  Trace la droite verticale passant par le point A\n * @param {Point} A Point de la droite\n * @param {string} [nom = ''] Nom affich de la droite\n * @param {string} [color = 'black'] Couleur de la droite : du type 'blue' ou du type '#f15929'\n * @example droiteVerticaleParPoint(M) // Trace la droite verticale passant par le point M\n * @example droiteVerticaleParPoint(M, 'd1', 'red') // Trace, en rouge, la droite verticale d1 passant par le point M\n * @author Jean-Claude Lhote\n * @return {Droite}\n */\n// JSDOC Validee par EE Aout 2022\nexport function droiteVerticaleParPoint(A: Point, nom = '', color = 'black') {\n  return droiteParPointEtVecteur(A, vecteur(0, 1), nom, color)\n}\n\n/**  Trace la droite passant par le point A et de pente k\n * @param {Point} A Point de la droite\n * @param {number} k Pente de la droite\n * @param {string} [nom = ''] Nom affich de la droite\n * @param {string} [color = 'black'] Couleur de la droite : du type 'blue' ou du type '#f15929'\n * @example droiteParPointEtPente(M, p) // Trace la droite passant par le point M et de pente p\n * @example droiteParPointEtPente(M, p, 'd1', 'red') // Trace, en rouge, la droite d1 passant par le point M et de pente p\n * @author Jean-Claude Lhote\n * @return {Droite}\n */\n// JSDOC Validee par EE Aout 2022\nexport function droiteParPointEtPente(\n  A: Point,\n  k: number,\n  nom = '',\n  color = 'black',\n) {\n  const B = point(A.x + 1, A.y + k)\n  return new Droite(A, B, nom, color)\n}\n\n/**\n * Trace la mdiatrice d'un segment, en laissant ventuellement apparents les traits de construction au compas\n * @param {PointAbstrait} A Premire extrmit du segment\n * @param {PointAbstrait} B Seconde extrmit du segment\n * @param {string} [nom = ''] Nom affich de la droite\n * @param {string} [couleurMediatrice = 'red'] Couleur de la mdiatrice : du type 'blue' ou du type '#f15929'\n * @param {string} [color='blue'] Couleur du codage : du type 'blue' ou du type '#f15929'.\n * @param {string} [couleurConstruction = 'black'] Couleur des traits de construction : du type 'blue' ou du type '#f15929'.\n * @param {boolean} [construction = false] Si construction est true, alors on affiche le codage et aussi les coups de compas utiles  la construction.\n * @param {boolean} [detail = false] Si detail est true, alors on affiche aussi en pointills les rayons utiles  la construction.\n * @param {string} [markmilieu = 'x'] Symbole pos sur les deux parties du segment\n * @param {string} [markrayons = '||'] Symbole pos sur les quatre rayons (si dtail est true)\n * @param {number} [epaisseurMediatrice = 1] Epaisseur de la mdiatrice\n * @param {number} [opaciteMediatrice = 1] Taux d'opacit de la mdiatrice\n * @param {number} [pointillesMediatrice = 0] Si cette valeur est entre 1 et 5, la mdiatrice est en pointills\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} svgml Sortie,  main leve, au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} tikzml Sortie,  main leve, au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} color Couleur du codage.  associer obligatoirement  colorToLatexOrHTML().\n * @property {string} couleurMediatrice Couleur de la mdiatrice : du type 'blue' ou du type '#f15929'\n * @property {number} epaisseurMediatrice Epaisseur de la mdiatrice\n * @property {number} opaciteMediatrice Taux d'opacit de la mdiatrice\n * @property {number} pointillesMediatrice Si cette valeur est entre 1 et 5, la mdiatrice est en pointills\n * @property {string} couleurConstruction Couleur des traits de construction : du type 'blue' ou du type '#f15929'.\n * @return {Mediatrice|Droite}\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class Mediatrice extends ObjetMathalea2D {\n  couleurMediatrice?: string\n  epaisseurMediatrice?: number\n  opaciteMediatrice?: number\n  pointillesMediatrice?: number\n  couleurConstruction?: string\n\n  constructor(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    nom = '',\n    couleurMediatrice = 'red',\n    color = 'blue',\n    couleurConstruction = 'black',\n    construction = false,\n    detail = false,\n    markmilieu = '',\n    markrayons = '||',\n    epaisseurMediatrice = 1,\n    opaciteMediatrice = 1,\n    pointillesMediatrice = 0,\n  ) {\n    super()\n    const O = milieu(A, B)\n    const m = rotation(A, O, 90)\n    const n = rotation(A, O, -90)\n    const M = pointSurSegment(O, m, longueur(A, B) * 0.785)\n    const N = pointSurSegment(O, n, longueur(A, B) * 0.785)\n    const d = new Droite(M, N, nom, couleurMediatrice)\n    if (arguments.length < 5) {\n      // Si on n'a que 2 arguments, on retourne juste une Droite\n      this.color = colorToLatexOrHTML(couleurMediatrice)\n      this.pointilles = pointillesMediatrice\n      this.opacite = opaciteMediatrice\n      this.epaisseur = epaisseurMediatrice\n      return d // Si il n'y a pas s'objets supplmentaires, il faut crer un objet Droite\n    } else {\n      if (longueur(A, B) < 0.1) {\n        window.notify(\n          'ConstructionMediatrice : Points trop rapprochs pour crer cet objet',\n          {\n            A,\n            B,\n          },\n        )\n      }\n      this.color = colorToLatexOrHTML(color)\n      this.couleurMediatrice = couleurMediatrice\n      this.epaisseurMediatrice = epaisseurMediatrice\n      this.opaciteMediatrice = opaciteMediatrice\n      this.pointillesMediatrice = pointillesMediatrice\n      this.couleurConstruction = couleurConstruction\n      this.epaisseur = 1\n      d.epaisseur = this.epaisseurMediatrice\n      d.opacite = this.opaciteMediatrice\n      d.pointilles = this.pointillesMediatrice\n      if (!construction && !detail) return d // Si il n'y a pas s'objets supplmentaires, il faut crer un objet Droite\n      this.objets = [d]\n      if (construction) {\n        const arcm1 = traceCompas(A, M, 20, this.couleurConstruction)\n        const arcm2 = traceCompas(B, M, 20, this.couleurConstruction)\n        const arcn1 = traceCompas(A, N, 20, this.couleurConstruction)\n        const arcn2 = traceCompas(B, N, 20, this.couleurConstruction)\n        const codage = codageMediatrice(\n          A,\n          B,\n          this.couleurMediatrice,\n          markmilieu,\n        )\n        this.objets.push(arcm1, arcm2, arcn1, arcn2, d, codage)\n      }\n      if (detail) {\n        const sAM = segment(A, M, this.couleurConstruction)\n        sAM.pointilles = 5\n        const sBM = segment(B, M, this.couleurConstruction)\n        sBM.pointilles = 5\n        const sAN = segment(A, N, this.couleurConstruction)\n        sAN.pointilles = 5\n        const sBN = segment(B, N, this.couleurConstruction)\n        sBN.pointilles = 5\n        const codes = codageSegments(\n          markrayons,\n          this.couleurConstruction,\n          A,\n          M,\n          B,\n          M,\n          A,\n          N,\n          B,\n          N,\n        )\n        this.objets.push(sAM, sBM, sAN, sBN, codes)\n      }\n    }\n  }\n\n  svg(coeff: number) {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.svg(coeff)\n    }\n    code = `<g id=\"${this.id}\">${code}</g>`\n    return code\n  }\n\n  tikz() {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.tikz()\n    }\n    return code\n  }\n\n  svgml(coeff: number, amp: number) {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      if (typeof objet.svgml === 'undefined') code += '\\n\\t' + objet.svg(coeff)\n      else code += '\\n\\t' + objet.svgml(coeff, amp)\n    }\n    return code\n  }\n\n  tikzml(amp: number) {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      if (typeof objet.tikzml === 'undefined') code += '\\n\\t' + objet.tikz()\n      else code += '\\n\\t' + objet.tikzml(amp)\n    }\n    return code\n  }\n}\n\n/**\n * Trace la mdiatrice d'un segment, en laissant ventuellement apparents les traits de construction au compas\n * @param {Point} A Premire extrmit du segment\n * @param {Point} B Seconde extrmit du segment\n * @param {string} [nom=''] Nom affich de la droite\n * @param {string} [couleurMediatrice = 'red'] Couleur de la mdiatrice : du type 'blue' ou du type '#f15929'\n * @param {string} [color='blue'] Couleur du codage : du type 'blue' ou du type '#f15929'.\n * @param {string} [couleurConstruction='black'] Couleur des traits de construction : du type 'blue' ou du type '#f15929'.\n * @param {boolean} [construction=false] Si construction est true, alors on affiche le codage et aussi les coups de compas utiles  la construction.\n * @param {boolean} [detail=false] Si detail est true, alors on affiche aussi en pointills les rayons utiles  la construction.\n * @param {string} [markmilieu='x'] Symbole pos sur les deux parties du segment\n * @param {string} [markrayons='||'] Symbole pos sur les quatre rayons (si dtail est true)\n * @param {number} [epaisseurMediatrice = 1] Epaisseur de la mdiatrice\n * @param {number} [opaciteMediatrice = 1] Taux d'opacit de la mdiatrice\n * @param {number} [pointillesMediatrice = 0] Si cette valeur est entre 1 et 5, la mdiatrice est en pointills\n * @example mediatrice(M,N)\n * // Trace, en rouge, la mdiatrice du segment[MN], d'paisseur 1, avec une opacit de 100 % sans autre option\n * @example mediatrice(M,N,'d','blue')\n * // Trace, en bleu, la mdiatrice du segment[MN], d'paisseur 1, avec une opacit de 100 % et qui s'appelle 'd'\n * @example mediatrice(M,N,'','blue','red','green',true,true,'OO','XX',2,0.5,3)\n * // Trace, en bleu, la mdiatrice du segment[MN], d'paisseur 2, avec une opacit de 50 % sans nom\n * // Les traits de construction sont dessins en vert avec la marque 'OO' pour le segment initial et la marque 'XX' pour les rayons, toutes ces marques tant rouge.\n * @author Rmi Angot {amende par Eric Elter en juin 2022}\n * @return {Mediatrice|Droite}\n */\n// JSDOC Validee par EE Juin 2022\nexport function mediatrice(\n  A: PointAbstrait,\n  B: PointAbstrait,\n  nom = '',\n  couleurMediatrice = 'red',\n  color = 'blue',\n  couleurConstruction = 'black',\n  construction = false,\n  detail = false,\n  markmilieu = '',\n  markrayons = '||',\n  epaisseurMediatrice = 1,\n  opaciteMediatrice = 1,\n  pointillesMediatrice = 0,\n) {\n  if (arguments.length < 5) return new Mediatrice(A, B, nom, couleurMediatrice)\n  else\n    return new Mediatrice(\n      A,\n      B,\n      nom,\n      couleurMediatrice,\n      color,\n      couleurConstruction,\n      construction,\n      detail,\n      markmilieu,\n      markrayons,\n      epaisseurMediatrice,\n      opaciteMediatrice,\n      pointillesMediatrice,\n    )\n}\n\n/**\n * Trace la bissectrice d'un angle, en laissant ventuellement apparents les traits de construction au compas\n * @param {Point} A Point sur un ct de l'angle\n * @param {Point} O Sommet de l'angle\n * @param {Point} B Point sur l'autre ct de l'angle\n * @param {string} [couleurBissectrice = 'red'] Couleur de la mdiatrice : du type 'blue' ou du type '#f15929'. Si 'none' ou '', pas de hachures.\n * @param {string} [color='blue'] Couleur du codage : du type 'blue' ou du type '#f15929'.\n * @param {string} [couleurConstruction = 'black'] Couleur de la mdiatrice : du type 'blue' ou du type '#f15929'. Si 'none' ou '', pas de hachures.\n * @param {boolean} [construction=false] Si construction est true, alors on affiche le codage et aussi les coups de compas utiles  la construction.\n * @param {boolean} [detail=false] Si detail est true, alors on affiche aussi en pointills les rayons utiles  la construction.\n * @param {string} [mark=''] Symbole pos sur les arcs\n * @param {number} [tailleLosange = 5] Longueur d'un ct du losange de construction\n * @param {number} [epaisseurBissectrice = 1] Epaisseur de la bissectrice\n * @param {number} [opaciteBissectrice = 1] Taux d'opacit de la bissectrice\n * @param {number} [pointillesBissectrice = 0] Si cette valeur est entre 1 et 5, la bissectrice est en pointills\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} couleurBissectrice Couleur de la mdiatrice : du type 'blue' ou du type '#f15929'. Si 'none' ou '', pas de hachures.\n * @property {string} color Couleur du codage.  associer obligatoirement  colorToLatexOrHTML().\n * @property {string} couleurConstruction Couleur de la mdiatrice.  associer obligatoirement  colorToLatexOrHTML(). Si 'none' ou '', pas de hachures.\n * @property {string} mark Symbole pos sur les arcs\n * @property {number} tailleLosange Longueur d'un ct du losange de construction\n * @property {number} epaisseurBissectrice Epaisseur de la bissectrice\n * @property {number} opaciteBissectrice Taux d'opacit de la bissectrice\n * @property {number} pointillesBissectrice Si cette valeur est entre 1 et 5, la bissectrice est en pointills\n * @author Rmi Angot (amende par Eric Elter en juin 2022)\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class Bissectrice extends DemiDroite {\n  tailleLosange?: number\n  mark?: string\n  couleurBissectrice?: string\n  epaisseurBissectrice?: number\n  opaciteBissectrice?: number\n  pointillesBissectrice?: number\n  couleurConstruction?: string\n\n  constructor(\n    A: PointAbstrait,\n    O: PointAbstrait,\n    B: PointAbstrait,\n    couleurBissectrice = 'red',\n    color = 'blue',\n    couleurConstruction = 'black',\n    construction = false,\n    detail = false,\n    mark = '',\n    tailleLosange = 5,\n    epaisseurBissectrice = 1,\n    opaciteBissectrice = 1,\n    pointillesBissectrice = 0,\n  ) {\n    const demiangle = angleOriente(A, O, B) / 2\n    const m = pointSurSegment(O, A, 3)\n    const X = rotation(m, O, demiangle)\n    super(O, X, couleurBissectrice)\n    this.color = colorToLatexOrHTML(color)\n    this.tailleLosange = tailleLosange\n    this.mark = mark\n    this.couleurBissectrice = couleurBissectrice\n    this.epaisseurBissectrice = epaisseurBissectrice\n    this.couleurConstruction = couleurConstruction\n    this.opaciteBissectrice = opaciteBissectrice\n    this.pointillesBissectrice = pointillesBissectrice\n    if (longueur(A, O) < 0.001 || longueur(O, B) < 0.001)\n      window.notify('Bissectrice : points confondus', { A, O, B })\n    // Construction de la bissectrice\n    const d = demiDroite(O, X, couleurBissectrice)\n    d.epaisseur = epaisseurBissectrice\n    d.opacite = opaciteBissectrice\n    d.pointilles = pointillesBissectrice\n    this.objets = [d]\n    const M = pointSurSegment(O, A, this.tailleLosange)\n    const N = pointSurSegment(O, B, this.tailleLosange)\n    const dMN = droite(M, N)\n    const P = symetrieAxiale(O, dMN) as Point\n    if (construction || detail) {\n      if (!M.estSur(segment(O, A))) {\n        const sOM = segment(O, M, this.couleurConstruction)\n        this.objets.push(sOM)\n      }\n      if (!N.estSur(segment(O, B))) {\n        const sON = segment(O, N, this.couleurConstruction)\n        this.objets.push(sON)\n      }\n      if (construction) {\n        const codage = codageBissectrice(A, O, B, color, mark)\n        const tNP = traceCompas(N, P, 20, this.couleurConstruction)\n        const tMP = traceCompas(M, P, 20, this.couleurConstruction)\n        const tOM = traceCompas(O, M, 20, this.couleurConstruction)\n        const tON = traceCompas(O, N, 20, this.couleurConstruction)\n        this.objets.push(codage, tNP, tMP, tOM, tON)\n      }\n      if (detail) {\n        const sMP = segment(M, P, this.couleurConstruction)\n        const sNP = segment(N, P, this.couleurConstruction)\n        sMP.pointilles = 5\n        sNP.pointilles = 5\n        const codes = codageSegments(this.mark, color, O, M, M, P, O, N, N, P)\n        this.objets.push(sMP, sNP, codes)\n      }\n    }\n  }\n\n  svg(coeff: number) {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.svg(coeff)\n    }\n    return code\n  }\n\n  tikz() {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.tikz()\n    }\n    return code\n  }\n}\n\n/**\n * Trace la bissectrice d'un angle, en laissant ventuellement apparents les traits de construction au compas\n * @param {Point} A Point sur un ct de l'angle\n * @param {Point} O Sommet de l'angle\n * @param {Point} B Point sur l'autre ct de l'angle\n * @param {string} [couleurBissectrice = 'red'] Couleur de la mdiatrice : du type 'blue' ou du type '#f15929' Si 'none' ou '', pas de hachures.\n * @param {string} [color='blue'] Couleur du codage : du type 'blue' ou du type '#f15929'.\n * @param {string} [couleurConstruction = 'black'] Couleur de la mdiatrice : du type 'blue' ou du type '#f15929' Si 'none' ou '', pas de hachures.\n * @param {boolean} [construction=false] Si construction est true, alors on affiche le codage et aussi les coups de compas utiles  la construction.\n * @param {boolean} [detail=false] Si detail est true, alors on affiche aussi en pointills les rayons utiles  la construction.\n * @param {string} [mark=''] Symbole pos sur les arcs\n * @param {number} [tailleLosange = 5] Longueur d'un ct du losange de construction\n * @param {number} [epaisseurBissectrice = 1] Epaisseur de la bissectrice\n * @param {number} [opaciteBissectrice = 1] Taux d'opacit de la bissectrice\n * @param {number} [pointillesBissectrice = 0] Si cette valeur est entre 1 et 5, la bissectrice est en pointills\n * @example bissectrice(N,R,J)\n * // Trace, en rouge, la bissectrice de l'angle NRJ, d'paisseur 1 et d'opacit 100 %, sans autre option\n * @example bissectrice(N,R,J,'blue')\n * // Trace, en bleu, la bissectrice de l'angle NRJ, d'paisseur 1 et d'opacit 100 %, sans autre option\n * @example bissectrice(N,R,J,'blue','red','green',true,true,'||',6,2,0.5,3)\n * // Trace, en rouge, la bissectrice de l'angle NRJ, d'paisseur 1 et d'opacit 100 %. Les traits de construction sont dessins en vert avec les marques '||' en rouge.\n * @author Rmi Angot (amende par Eric Elter en juin 2022)\n * @return {Bissectrice}\n */\n// JSDOC Validee par EE Juin 2022\nexport function bissectrice(\n  A: Point | PointAbstrait,\n  O: Point | PointAbstrait,\n  B: Point | PointAbstrait,\n  couleurBissectrice = 'red',\n  color = 'blue',\n  couleurConstruction = 'black',\n  construction = false,\n  detail = false,\n  mark = '',\n  tailleLosange = 5,\n  epaisseurBissectrice = 1,\n  opaciteBissectrice = 1,\n  pointillesBissectrice = 0,\n) {\n  return new Bissectrice(\n    A,\n    O,\n    B,\n    couleurBissectrice,\n    color,\n    couleurConstruction,\n    construction,\n    detail,\n    mark,\n    tailleLosange,\n    epaisseurBissectrice,\n    opaciteBissectrice,\n    pointillesBissectrice,\n  )\n}\n\n/**  Donne la distance entre le point A et la droite d\n * @param {Point} A\n * @param {Droite} d\n * @example distancePointDroite (M, d1) // Retourne la distance entre le point M et la droite d1\n * @author Jean-Claude Lhote\n * @return {number}\n */\n// JSDOC Validee par EE Aout 2022\nexport function distancePointDroite(A: PointAbstrait, d: Droite) {\n  const M = projectionOrtho(A, d)\n  return longueur(A, M, 9)\n}\n","import {\n  colorToLatexOrHTML,\n  fixeBordures,\n  ObjetMathalea2D,\n  Vide2d,\n} from '../../modules/2dGeneralites'\nimport { context } from '../../modules/context'\nimport { arrondi } from '../outils/nombres'\nimport { stringNombre } from '../outils/texNombre'\nimport { angleOriente, codageAngle, codageAngleDroit } from './angles'\nimport { arc } from './cercle'\nimport { Droite, droite, mediatrice } from './droites'\nimport {\n  milieu,\n  Point,\n  point,\n  pointSurSegment,\n  tracePointSurDroite,\n} from './points'\nimport { PointAbstrait } from './points-abstraits'\nimport type { Polygone } from './polygones'\nimport { longueur, Segment, segment, vecteur } from './segmentsVecteurs'\nimport {\n  Latex2d,\n  latex2d,\n  latexParCoordonnees,\n  tailleDeNbVersLatex,\n  TexteParPoint,\n  texteParPoint,\n  type LetterSizeType,\n} from './textes'\nimport { rotation, similitude, translation } from './transformations'\n\n/**\n * Code le milieu d'un segment\n * @param {Point} A Premire extrmit du segment\n * @param {Point} B Seconde extrmit du segment\n * @param {string} [color='black'] Couleur du codage : du type 'blue' ou du type '#f15929'.\n * @param {string} [mark='x'] Symbole pos sur les deux parties du segment\n * @param {boolean} [mil=true] Trace ou nom le point du milieu.\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} color Couleur du codage.  associer obligatoirement  colorToLatexOrHTML().\n * @author Jean-Claude Lhote\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class CodageMilieu extends ObjetMathalea2D {\n  constructor(A: Point, B: Point, color = 'black', mark = '', mil = true) {\n    super()\n    if (longueur(A, B) < 0.1)\n      window.notify(\n        'CodageMilieu : Points trop rapprochs pour crer ce codage',\n        { A, B },\n      )\n    this.color = colorToLatexOrHTML(color)\n    const O = milieu(A, B)\n    const d = droite(A, B)\n    const M = tracePointSurDroite(O, d, color) // On utilise color, car tracePointSurDroite aura son propore colorToLatexOrHTML\n    const v = codageSegments(mark, color, A, O, O, B) // idem pour codaSegments\n    let code = ''\n    // Pour les bordures, on prends celles de [AB], vu qu'on code le milieu de [AB]\n    this.bordures = [\n      Math.min(A.bordures[0], B.bordures[0]),\n      Math.min(A.bordures[1], B.bordures[1]),\n      Math.max(A.bordures[2], B.bordures[2]),\n      Math.max(A.bordures[3], B.bordures[3]),\n    ]\n    this.svg = function (coeff) {\n      if (mil) code = M.svg(coeff) + '\\n' + v.svg(coeff)\n      else code = v.svg(coeff)\n      code = `<g id=\"${this.id}\">${code}</g>`\n      return code\n    }\n    this.tikz = function () {\n      if (mil) return M.tikz() + '\\n' + v.tikz()\n      else return v.tikz()\n    }\n  }\n}\n/**\n * Code le milieu d'un segment\n * @param {Point} A Premire extrmit du segment\n * @param {Point} B Seconde extrmit du segment\n * @param {string} [color = 'black'] Couleur du codage : du type 'blue' ou du type '#f15929'.\n * @param {string} [mark = 'x'] Symbole pos de part et d'autre du milieu du segment\n * @param {boolean} [mil = true] Trace ou nom le point du milieu.\n * @example codageMilieu(M,N) // Code, en noir, le milieu du segment[MN] avec les marques 'x', en plaant le milieu\n * @example codageMilieu(M,N,'red','oo',false) // Code, en rouge, le milieu du segment[MN] avec les marques 'oo', sans placer le milieu.\n * @author Jean-Claude Lhote\n * @return {CodageMilieu}\n */\n// JSDOC Validee par EE Juin 2022\nexport function codageMilieu(\n  A: Point,\n  B: Point,\n  color = 'black',\n  mark = '',\n  mil = true,\n) {\n  return new CodageMilieu(A, B, color, mark, mil)\n}\n\n/**\n * Code la mdiatrice d'un segment\n * @param {PointAbstrait} A Premire extrmit du segment\n * @param {PointAbstrait} B Seconde extrmit du segment\n * @param {string} [color='black'] Couleur du codage : du type 'blue' ou du type '#f15929'.\n * @param {string} [mark='x'] Symbole pos sur les deux parties du segment\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} svgml Sortie,  main leve, au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} tikzml Sortie,  main leve, au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} color Couleur du codage.  associer obligatoirement  colorToLatexOrHTML().\n * @author  Rmi Angot\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class CodageMediatrice extends ObjetMathalea2D {\n  constructor(A: PointAbstrait, B: PointAbstrait, color = 'black', mark = '') {\n    super()\n    if (longueur(A, B) < 0.1)\n      window.notify(\n        'CodageMediatrice : Points trop rapprochs pour crer ce codage',\n        { A, B },\n      )\n    this.color = colorToLatexOrHTML(color)\n    const O = milieu(A, B)\n    const M = rotation(A, O, 90)\n    const c = codageAngleDroit(M, O, B, color)\n    const v = codageSegments(mark, color, A, O, O, B)\n    const bordures = fixeBordures([A, B, O, c])\n    this.bordures = [bordures.xmin, bordures.ymin, bordures.xmax, bordures.ymax]\n    this.svg = function (coeff) {\n      const code = `<g id=\"${this.id}\">${c.svg(coeff) + '\\n' + v.svg(coeff)}</g>`\n      return code\n    }\n    this.tikz = function () {\n      return c.tikz() + '\\n' + v.tikz()\n    }\n    this.svgml = function (coeff: number, amp: number) {\n      return c.svgml(coeff, amp) + '\\n' + v.svg(coeff)\n    }\n    this.tikzml = function (amp: number) {\n      return c.tikzml(amp) + '\\n' + v.tikz()\n    }\n  }\n}\n\n/**\n * Code la mdiatrice d'un segment\n * @param {PointAbstrait} A Premire extrmit du segment\n * @param {PointAbstrait} B Seconde extrmit du segment\n * @param {string} [color='black'] Couleur du codage : du type 'blue' ou du type '#f15929'.\n * @param {string} [mark='x'] Symbole pos sur les deux parties du segment\n * @example codageMediatrice(M,N) // Code, en noir, la mdiatrice du segment[MN] avec les marques 'x'\n * @example codageMediatrice(M,N,'red','oo') // Code, en rouge, la mdiatrice du segment[MN] avec les marques 'oo'\n * @author  Rmi Angot\n * @return {CodageMediatrice}\n */\n// JSDOC Validee par EE Juin 2022\nexport function codageMediatrice(\n  A: PointAbstrait,\n  B: PointAbstrait,\n  color = 'black',\n  mark = '',\n) {\n  return new CodageMediatrice(A, B, color, mark)\n}\n\n/**\n * Code la bissectrice d'un angle\n * @param {PointAbstrait} A Point sur un ct de l'angle\n * @param {PointAbstrait} O Sommet de l'angle\n * @param {PointAbstrait} B Point sur l'autre ct de l'angle\n * @param {string} [color = 'black'] Couleur de la bissectrice : du type 'blue' ou du type '#f15929'\n * @param {string} [mark = 'x'] Symbole pos sur les arcs\n * @property {string} color Couleur de la bissectrice.  associer obligatoirement  colorToLatexOrHTML().\n * @property {string} mark Symbole pos sur les arcs\n * @property {PointAbstrait} centre Sommet de l'angle\n * @property {PointAbstrait} depart Point sur un ct de l'angle (quivalent au point A)\n * @author Jean-Claude Lhote\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class CodageBissectrice extends ObjetMathalea2D {\n  mark: string\n  centre: PointAbstrait\n  depart: PointAbstrait\n  constructor(\n    A: PointAbstrait,\n    O: PointAbstrait,\n    B: PointAbstrait,\n    color = 'black',\n    mark = 'X',\n  ) {\n    super()\n    this.color = colorToLatexOrHTML(color)\n    this.mark = mark\n    this.centre = O\n    this.depart = pointSurSegment(O, A, 1.5)\n    const demiangle = angleOriente(A, O, B) / 2\n    const lieu = rotation(this.depart, O, demiangle)\n    const a1 = codageAngle(\n      pointSurSegment(this.centre, this.depart),\n      O,\n      demiangle,\n      1,\n      this.mark,\n      color,\n      1,\n      1,\n    )\n    const a2 = codageAngle(\n      pointSurSegment(this.centre, lieu),\n      O,\n      demiangle,\n      1,\n      this.mark,\n      color,\n      1,\n      1,\n    )\n    this.objets = [a1, a2]\n    const bordures = fixeBordures([a1, a2])\n    this.bordures = [bordures.xmin, bordures.ymin, bordures.xmax, bordures.ymax]\n  }\n}\n\n/**\n * Code la bissectrice d'un angle\n * @param {PointAbstrait} A Point sur un ct de l'angle\n * @param {PointAbstrait} O Sommet de l'angle\n * @param {PointAbstrait} B Point sur l'autre ct de l'angle\n * @param {string} [color = 'black'] Couleur de la bissectrice : du type 'blue' ou du type '#f15929'\n * @param {string} [mark='x'] Symbole pos sur les arcs\n * @example codagebissectrice(M,N,P) // Code, en noir, la bissectrice de l'angle MNP avec les marques 'x'\n * @example codagebissectrice(M,N,P,'red','oo') // Code, en rouge, la bissectrice de l'angle MNP avec les marques 'oo'\n * @author Jean-Claude Lhote\n * @return {CodageBissectrice}\n */\n// JSDOC Validee par EE Juin 2022\nexport function codageBissectrice(\n  A: PointAbstrait,\n  O: PointAbstrait,\n  B: PointAbstrait,\n  color = 'black',\n  mark = 'X',\n) {\n  return new CodageBissectrice(A, O, B, color, mark)\n}\n\n/**\n * Code un carr\n * @param {Polygone} c Carr  coder\n * @param {string} [color = 'black'] Couleur des codages : du type 'blue' ou du type '#f15929'\n * @param {string} [mark='x'] Symbole pos sur les cts\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class CodageCarre extends ObjetMathalea2D {\n  constructor(c: Polygone, color = 'black', mark = '') {\n    super()\n    this.objets = []\n    this.objets.push(codageSegments(mark, color, ...c.listePoints))\n    this.objets.push(\n      codageAngleDroit(\n        c.listePoints[0],\n        c.listePoints[1],\n        c.listePoints[2],\n        color,\n      ),\n    )\n    this.objets.push(\n      codageAngleDroit(\n        c.listePoints[1],\n        c.listePoints[2],\n        c.listePoints[3],\n        color,\n      ),\n    )\n    this.objets.push(\n      codageAngleDroit(\n        c.listePoints[2],\n        c.listePoints[3],\n        c.listePoints[0],\n        color,\n      ),\n    )\n    this.objets.push(\n      codageAngleDroit(\n        c.listePoints[3],\n        c.listePoints[0],\n        c.listePoints[1],\n        color,\n      ),\n    )\n  }\n\n  svg(coeff: number) {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.svg(coeff)\n    }\n    return code\n  }\n\n  tikz() {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.tikz()\n    }\n    return code\n  }\n}\n\n/**\n * Met un codage complet sur un carr\n * @param {Polygone} c Carr  coder\n * @param {string} [color = 'black'] Couleur des codages : du type 'blue' ou du type '#f15929'\n * @param {string} [mark='x'] Symbole pos sur les cts\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @example codageCarre(carre) // Code, en noir, le carr carre.\n * @example codageCarre(carre,'red','||') // Code, en rouge, le carr carre avec la marque || sur les cts\n * @return {CodageCarre}\n */\n// JSDOC Validee par EE Juin 2022\nexport function codageCarre(c: Polygone, color = 'black', mark = '') {\n  return new CodageCarre(c, color, mark)\n}\n\n/**\n * Affiche la longueur de [AB] au dessus si A est le point le plus  gauche sinon au dessous.\n * @param  {PointAbstrait} A Premire extrmit du segment\n * @param  {PointAbstrait} B Seconde extrmit du segment\n * @param  {string} [color='black'] Couleur de la longueur affiche : du type 'blue' ou du type '#f15929'.\n * @param  {number} [d=0.5] Distance entre l'affichage de la longueur et le segment.\n * @param  {string} [unite='cm'] Affiche cette unit aprs la valeur numrique de la longueur.\n * @param  {boolean} [horizontal=false] Si true, alors le texte est horizontal, sinon le texte est parallle au segment.\n * @param  {number} [precision=1]\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} color Couleur de la longueur affiche.  associer obligatoirement  colorToLatexOrHTML().\n * @author Rmi Angot\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class AfficheLongueurSegment extends ObjetMathalea2D {\n  stringColor: string\n  angle: number\n  O: PointAbstrait\n  M: PointAbstrait\n  distance: number\n  text: string\n\n  constructor(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    color = 'black',\n    d = 0.5,\n    unite = 'cm',\n    horizontal = false,\n    precision = 1,\n  ) {\n    super()\n    this.stringColor = color\n    this.O = milieu(A, B)\n    this.M = rotation(A, this.O, -90)\n    const s = segment(A, B)\n    const l = stringNombre(s.longueur, precision)\n    this.text = `${l}${unite !== '' ? ' ' + unite : ''}`\n    this.distance = horizontal ? d - 0.1 + this.text.length / 10 : d\n    if (horizontal) {\n      this.angle = 0\n    } else if (B.x > A.x) {\n      this.angle = -s.angleAvecHorizontale\n    } else {\n      this.angle = 180 - s.angleAvecHorizontale\n    }\n    this.bordures = [\n      this.O.x - 0.5,\n      this.O.y - 0.5,\n      this.O.x + 0.5,\n      this.O.y + 0.5,\n    ] // C'est n'importe quoi, mais de toute faon, le segment a ses bordures, lui !\n  }\n\n  svg(coeff: number) {\n    const N = pointSurSegment(this.O, this.M, (this.distance * 20) / coeff)\n    return texteParPoint(\n      this.text,\n      N,\n      this.angle,\n      this.stringColor,\n      1,\n      'milieu',\n      false,\n    ).svg(coeff)\n  }\n\n  tikz() {\n    const N = pointSurSegment(this.O, this.M, this.distance / context.scale)\n    return texteParPoint(\n      this.text,\n      N,\n      this.angle,\n      this.stringColor,\n      1,\n      'milieu',\n      false,\n    ).tikz()\n  }\n}\n\n/**\n * Affiche la longueur de [AB] au dessus si A est le point le plus  gauche sinon au dessous.\n * @param  {PointAbstrait} A Premire extrmit du segment\n * @param  {PointAbstrait} B Seconde extrmit du segment\n * @param  {string} [color='black'] Couleur affiche de la longueur affiche : du type 'blue' ou du type '#f15929'.\n * @param  {number} [d=0.5] Distance entre l'affichage de la longueur et le segment.\n * @param  {string} [unite='cm'] Affiche cette unit aprs la valeur numrique de la longueur.\n * @param  {boolean} [horizontal=false] Si true, alors le texte est horizontal, sinon le texte est parallle au segment.\n * @param  {number} [precision=1]\n * @example  afficheLongueurSegment(A,B)\n * // Affiche la longueur du segment [AB] (en noir,  0,5 \"cm\" du segment, complte par l'unit cm et paralllement au segment).\n * @example  afficheLongueurSegment(A,B,'blue',1,'mm',true)\n * // Affiche la longueur du segment [AB], en bleu,  1 \"cm\" du segment, complte par l'unit mm et horizontalement.\n * @return {AfficheLongueurSegment}\n * @author Rmi Angot\n */\n// JSDOC Validee par EE Juin 2022\nexport function afficheLongueurSegment(\n  A: PointAbstrait,\n  B: PointAbstrait,\n  color = 'black',\n  d = 0.5,\n  unite = 'cm',\n  horizontal = false,\n  precision = 1,\n) {\n  return new AfficheLongueurSegment(\n    A,\n    B,\n    color,\n    d,\n    unite,\n    horizontal,\n    precision,\n  )\n}\n\n/**\n * texteSurSegment('mon texte',A,B) // crit un texte au milieu de [AB] au dessus si A est le point le plus  gauche sinon en dessous, ou alors horizontalement\n *\n * @author Rmi Angot\n */\nexport class TexteSurSegment extends ObjetMathalea2D {\n  stringColor: string\n  extremite1: PointAbstrait\n  extremite2: PointAbstrait\n  distance: number\n  texte: string\n  scale: number\n  mathOn: boolean\n  angle: number\n  O: PointAbstrait\n  M: PointAbstrait\n\n  constructor(\n    texte: string,\n    A: PointAbstrait,\n    B: PointAbstrait,\n    color = 'black',\n    d = 0.5,\n    horizontal = false,\n  ) {\n    super()\n    if (typeof texte === 'number') texte = String(texte)\n    if (longueur(A, B) < 0.1)\n      window.notify(\n        'TexteSurSegment : Points trop proches pour cette fonction',\n        { A, B },\n      )\n    this.color = colorToLatexOrHTML(color)\n    this.stringColor = color\n    this.extremite1 = A\n    this.extremite2 = B\n    this.texte = String(texte)\n    this.scale = 1\n    this.mathOn = true\n    this.distance = horizontal ? d - 0.1 + this.texte.length / 10 : d\n    this.O = milieu(this.extremite1, this.extremite2)\n    this.M = rotation(this.extremite1, this.O, -90)\n    const s = segment(this.extremite1, this.extremite2)\n    const pos = pointSurSegment(this.O, this.M, this.distance)\n    const space = 0.2 * (this.texte.length ?? 2)\n    this.bordures = [pos.x - space, pos.y - space, pos.x + space, pos.y + space]\n    if (horizontal) {\n      this.angle = 0\n    } else if (this.extremite2.x > this.extremite1.x) {\n      this.angle = -s.angleAvecHorizontale\n      this.angle = -s.angleAvecHorizontale\n    } else {\n      this.angle = 180 - s.angleAvecHorizontale\n      this.angle = 180 - s.angleAvecHorizontale\n    }\n  }\n\n  svg(coeff: number) {\n    const N = pointSurSegment(this.O, this.M, (this.distance * 20) / coeff)\n    return texteParPoint(\n      this.texte,\n      N,\n      this.angle,\n      this.stringColor,\n      this.scale,\n      'milieu',\n      this.mathOn,\n    ).svg(coeff)\n  }\n\n  tikz() {\n    const N = pointSurSegment(this.O, this.M, this.distance / context.scale)\n    return texteParPoint(\n      this.texte,\n      N,\n      this.angle,\n      this.stringColor,\n      this.scale,\n      'milieu',\n      this.mathOn,\n    ).tikz()\n  }\n}\n\n/**\n * crit un texte au milieu de [AB] au dessus si A est le point le plus  gauche sinon au dessous ou bien horizontal\n * @param {string} texte\n * @param {PointAbstrait} A\n * @param {PointAbstrait} B\n * @param {string} [color='black'] Code couleur HTML accept\n * @param {number} [distance=0.5] Distance  la droite.\n * @param {boolean} [horizontal=false] Si true, alors le texte est horizontal, sinon le texte est parallle au segment\n * @return {object} LatexParCoordonnees si le premier caractre est '$', TexteParPoint sinon\n * @author Rmi Angot\n */\nexport function texteSurSegment(\n  texte = '',\n  A: PointAbstrait,\n  B: PointAbstrait,\n  color = 'black',\n  distance = 0.5,\n  horizontal = false,\n) {\n  if (texte[0] === '$') {\n    return placeLatexSurSegment(texte.replaceAll('$', ''), A, B, {\n      color,\n      distance,\n      horizontal,\n    })\n  }\n  return new TexteSurSegment(texte, A, B, color, distance, horizontal)\n}\n\n/**\n * texteSurArc(texte, A, B, angle) // crit un texte au milieu de l'arc AB, au dessus si A est le point le plus  gauche sinon au dessous\n *\n * @author Rmi Angot et Frdric Piou\n */\nexport class TexteSurArc extends ObjetMathalea2D {\n  extremite1: Point\n  extremite2: Point\n  distance: number\n  texte: string\n  angle: number\n  centre: Point\n  milieu: Point\n  normale: number\n  stringColor: string\n  horizontal: boolean\n  constructor(\n    texte: string,\n    A: Point,\n    B: Point,\n    angle: number,\n    color = 'black',\n    d = 0.5,\n    horizontal = false,\n  ) {\n    super()\n    this.color = colorToLatexOrHTML(color)\n    this.horizontal = horizontal\n    this.stringColor = color\n    this.extremite1 = A\n    this.extremite2 = B\n    this.distance = texte[0] === '$' ? -3 * d : -d\n    this.texte = texte\n    this.angle = angle\n    let anglerot\n    if (angle < 0) anglerot = (angle + 180) / 2\n    else anglerot = (angle - 180) / 2\n    const d1 = mediatrice(A, B) as Droite\n    const e = droite(A, B)\n    const f = rotation(e, B, anglerot)\n    const determinant = d1.a * f.b - f.a * d1.b\n    const Omegax = (d1.b * f.c - f.b * d1.c) / determinant\n    const Omegay = (f.a * d1.c - d1.a * f.c) / determinant\n    this.centre = point(Omegax, Omegay)\n    const s = segment(this.extremite1, this.extremite2)\n    this.normale = -s.angleAvecHorizontale\n    this.milieu = rotation(A, this.centre, angle / 2)\n    const pos = pointSurSegment(this.milieu, this.centre, this.distance)\n    const space = 0.2 * texte.length\n    this.bordures = [pos.x - space, pos.y - space, pos.x + space, pos.y + space]\n  }\n\n  svg(coeff: number) {\n    const N = pointSurSegment(\n      this.milieu,\n      this.centre,\n      (this.distance * 20) / coeff,\n    )\n    let angle\n    if (this.extremite2.x > this.extremite1.x) {\n      angle = this.normale\n    } else {\n      angle = 180 + this.normale\n    }\n    return texteParPoint(\n      this.texte,\n      N,\n      this.horizontal ? 0 : angle,\n      this.stringColor,\n    ).svg(coeff)\n  }\n\n  tikz() {\n    const N = pointSurSegment(\n      this.milieu,\n      this.centre,\n      this.distance / context.scale,\n    )\n    let angle\n    if (this.extremite2.x > this.extremite1.x) {\n      angle = this.normale\n    } else {\n      angle = 180 + this.normale\n    }\n    return texteParPoint(this.texte, N, angle, this.stringColor).tikz()\n  }\n}\n\n/**\n * crit un texte au \"milieu\" de l'arc AB au dessus si A est le point le plus  gauche sinon en dessous\n * @param {string} texte Texte  afficher (viter les $$ pour les affichages diaporama)\n * @param {Point} A Extrmit de l'arc\n * @param {Point} B Extrmit de l'arc\n * @param {number} angle Angle au centre\n * @param {string} [color='black'] Code couleur HTML accept\n * @param {number} [d=0.5] Distance  la droite.\n * @param {boolean} [horizontal = false] Dcide si le texte est horizontal ou pas, quelle que soit la valeur de angle.\n * @return {object} LatexParCoordonnees si le premier caractre est '$', TexteParPoint sinon\n * @author Rmi Angot et Frdric Piou\n */\nexport function texteSurArc(\n  texte: string,\n  A: Point,\n  B: Point,\n  angle: number,\n  color = 'black',\n  d = 0.5,\n  horizontal = false,\n) {\n  return new TexteSurArc(texte, A, B, angle, color, d, horizontal)\n}\n\n/**\n * Affiche la mesure de l'angle ABC arrondie au degr prs\n * @param {Point} A Point sur un ct de l'angle\n * @param {Point} B Sommet de l'angle\n * @param {Point} C Point sur l'autre ct de l'angle\n * @param {string} [color='black'] Couleur de la mesure de l'angle : du type 'blue' ou du type '#f15929'.\n * @param {number} [distance=1.5] Taille de l'angle\n * @param {string} [label=''] Si vide, alors affiche la mesure de l'angle sinon affiche ce label.\n * @param {Object} parametres  saisir entre accolades\n * @param {number} [parametres.ecart=0.5] Distance entre l'arc et sa mesure\n * @param {boolean} [parametres.saillant=true] True si on veut l'angle saillant, false si on veut l'angle rentrant.\n * @param {string} [parametres.colorArc='black']  Couleur de l'arc  : du type 'blue' ou du type '#f15929'.\n * @param {boolean} [parametres.rayon=false] True pour fermer l'angle, par deux rayons (en vue de colorier l'intrieur).\n * @param {string} [parametres.couleurDeRemplissage='none'] 'none' si on ne veut pas de remplissage, sinon une couleur du type 'blue' ou du type '#f15929'.\n * @param {number} [parametres.opaciteDeRemplissage=0.5] Taux d'opacit du remplissage entre 0 et 1\n * @param {number} [parametres.arcEpaisseur=1] Epaisseur de l'arc\n * @param {boolean} [parametres.mesureEnGras=false] True pour mettre en gras la mesure affiche\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {Point} depart Point sur un ct de l'angle\n * @property {Point} sommet Sommet de l'angle\n * @property {Point} arrivee Point sur l'autre ct de l'angle\n * @property {number} distance Taille de l'angle\n * @property {number} ecart Distance entre l'arc et sa mesure\n * @property {boolean} saillant True si on veut l'angle saillant, false si on veut l'angle rentrant.\n * @property {number} epaisseur Epaisseur de l'arc\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class AfficheMesureAngle extends ObjetMathalea2D {\n  depart: PointAbstrait\n  sommet: PointAbstrait\n  arrivee: PointAbstrait\n  distance: number\n  ecart: number\n  saillant: boolean\n\n  constructor(\n    A: PointAbstrait,\n    B: PointAbstrait,\n    C: PointAbstrait,\n    color = 'black',\n    distance = 1.5,\n    label = '',\n    {\n      ecart = 0.5,\n      mesureEnGras = false,\n      saillant = true,\n      colorArc = 'black',\n      rayon = false,\n      couleurDeRemplissage = 'none',\n      opaciteDeRemplissage = 0.5,\n      arcEpaisseur = 1,\n    } = {},\n  ) {\n    super()\n    this.depart = A\n    this.arrivee = C\n    this.sommet = B\n    this.distance = distance\n    const mesureAngle = saillant\n      ? angleOriente(this.depart, this.sommet, this.arrivee)\n      : angleOriente(this.depart, this.sommet, this.arrivee) > 0\n        ? angleOriente(this.depart, this.sommet, this.arrivee) - 360\n        : 360 + angleOriente(this.depart, this.sommet, this.arrivee)\n    this.ecart = ecart\n    this.saillant = saillant\n    this.epaisseur = arcEpaisseur\n    const M = pointSurSegment(this.sommet, this.depart, this.distance)\n    const N = rotation(\n      pointSurSegment(\n        this.sommet,\n        M,\n        this.distance + (this.ecart * 20) / context.pixelsParCm,\n      ),\n      this.sommet,\n      mesureAngle / 2,\n    )\n    let mesureAngleString\n    if (label !== '') {\n      mesureAngleString = label\n    } else {\n      mesureAngleString =\n        Math.round(Math.abs(mesureAngle)).toString() + '^\\\\circ'\n    }\n    const mesure = latexParCoordonnees(\n      mesureAngleString,\n      N.x,\n      N.y,\n      color,\n      0,\n      0,\n      '',\n      8,\n    )\n    const marque = arc(\n      M,\n      B,\n      mesureAngle,\n      rayon,\n      couleurDeRemplissage,\n      colorArc,\n      opaciteDeRemplissage,\n    )\n    marque.epaisseur = this.epaisseur\n    this.bordures = [\n      Math.min(N.x, M.x) - 0.5,\n      Math.min(N.y, M.y) - 0.5,\n      Math.max(N.x, M.x) + 0.5,\n      Math.max(N.y, M.y) + 0.5,\n    ]\n    this.objets = [mesure, marque]\n  }\n}\n\n/**\n * Affiche la mesure de l'angle ABC arrondie au degr prs\n * @param {Point} A Point sur un ct de l'angle\n * @param {Point} B Sommet de l'angle\n * @param {Point} C Point sur l'autre ct de l'angle\n * @param {string} [color='black'] Couleur de la mesure de l'angle : du type 'blue' ou du type '#f15929'.\n * @param {number} [distance=1.5] Rayon de l'arc de cercle.\n * @param {string} [label=''] Si vide, alors affiche la mesure de l'angle sinon affiche ce label.\n * @param {Object} parametres  saisir entre accolades\n * @param {number} [parametres.ecart=0.5] Distance entre l'arc et sa mesure\n * @param {boolean} [parametres.saillant=true] True si on veut l'angle saillant, false si on veut l'angle rentrant.\n * @param {string} [parametres.colorArc='black']  Couleur de l'arc  : du type 'blue' ou du type '#f15929'.\n * @param {boolean} [parametres.rayon=false] True pour fermer l'angle, par deux rayons (en vue de colorier l'intrieur).\n * @param {string} [parametres.couleurDeRemplissage='none'] 'none' si on ne veut pas de remplissage, sinon une couleur du type 'blue' ou du type '#f15929'.\n * @param {number} [parametres.opaciteDeRemplissage=0.5] Taux d'opacit du remplissage entre 0 et 1\n * @param {number} [parametres.arcEpaisseur=1] Epaisseur de l'arc\n * @param {boolean} [parametres.mesureEnGras=false] True pour mettre en gras la mesure affiche\n * @example afficheMesureAngle(M,N,O)\n * // Affiche la mesure de l'angle MNO (en noir, avec un arc de rayon 1,5 \"cm\").\n * @example afficheMesureAngle(M,N,O,'red',2,'pop',{ecart:1,saillant:false,colorArc:'blue',rayon:true,couleurDeRemplissage:'#f15929',opaciteDeRemplissage:0.8,arcEpaisseur:2,mesureEnGras:true})\n * // Affiche le label pop en gras et rouge, sur l'angle rentrant MNO, avec un arc bleu, epais de 2 et de rayon 2 \"cm\",  1 \"cm\" de l'arc rempli en orange avec une opacit de 80%, cern par ses rayons.\n * @return {AfficheMesureAngle}\n */\n// JSDOC Validee par EE Juin 2022\nexport function afficheMesureAngle(\n  A: PointAbstrait,\n  B: PointAbstrait,\n  C: PointAbstrait,\n  color = 'black',\n  distance = 1.5,\n  label = '',\n  {\n    ecart = 0.5,\n    mesureEnGras = false,\n    saillant = true,\n    colorArc = 'black',\n    rayon = false,\n    couleurDeRemplissage = 'none',\n    opaciteDeRemplissage = 0.5,\n    arcEpaisseur = 1,\n  } = {},\n) {\n  return new AfficheMesureAngle(A, B, C, color, distance, label, {\n    ecart,\n    mesureEnGras,\n    saillant,\n    colorArc,\n    rayon,\n    couleurDeRemplissage,\n    opaciteDeRemplissage,\n    arcEpaisseur,\n  })\n}\n\n/**\n * Affiche la cte d'un segment sous la forme d'une flche  double sens et d'une valeur associe.\n * @param {Segment} s Segment pour lequel on affiche la cte\n * @param {string} [Cote=''] Si '', alors la longueur en cm est affiche, sinon c'est cette valeur qui s'affiche (et cela peut tre une variable).\n * @param {number} [positionCote = 0.5] Position de la flche par rapport au segment. Valeur ngative ou positive selon la position voulue.\n * @param {string} [couleurCote='black'] Couleur de la flche  : du type 'blue' ou du type '#f15929'.\n * @param {number} [epaisseurCote=1] Epaisseur de la flche.\n * @param {number} [positionValeur=0.5] Position de la valeur par rapport  la flche. Valeur ngative ou positive selon la position voulue.\n * @param {string} [couleurValeur='black']  Couleur de la valeur indique : du type 'blue' ou du type '#f15929'.\n * @param {boolean} [horizontal=false]  Si true, alors le texte est horizontal, sinon le texte est parallle au segment.\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @author Jean-Claude Lhote\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class AfficheCoteSegment extends ObjetMathalea2D {\n  constructor(\n    s: Segment,\n    Cote = '',\n    positionCote = 0.5,\n    couleurCote = 'black',\n    epaisseurCote = 1,\n    positionValeur = 0.5,\n    couleurValeur = 'black',\n    horizontal = false,\n  ) {\n    super()\n    let valeur\n    const A = s.extremite1\n    const B = s.extremite2\n\n    const v = similitude(vecteur(A, B), A, 90, positionCote / s.longueur)\n    const cote = segment(translation(A, v), translation(B, v), couleurCote)\n    if (longueur(A, B) > 1) cote.styleExtremites = '<->'\n    else cote.styleExtremites = '>-<'\n    cote.epaisseur = epaisseurCote\n    if (Cote === '') {\n      valeur = afficheLongueurSegment(\n        cote.extremite1,\n        cote.extremite2,\n        couleurValeur,\n        positionValeur,\n        'cm',\n        horizontal,\n      )\n    } else {\n      if (Cote.includes('\\\\')) {\n        valeur = placeLatexSurSegment(Cote, cote.extremite1, cote.extremite2, {\n          distance: positionValeur,\n          horizontal,\n          letterSize: 'normalsize',\n          color: couleurValeur,\n        })\n      } else {\n        valeur = texteSurSegment(\n          Cote,\n          cote.extremite1,\n          cote.extremite2,\n          couleurValeur,\n          positionValeur,\n          horizontal,\n        )\n      }\n    }\n    const { xmin, xmax, ymin, ymax } = fixeBordures([cote, valeur])\n    this.bordures = [xmin, ymin, xmax, ymax]\n    this.objets = [cote, valeur]\n  }\n\n  svg(coeff: number) {\n    let code = ''\n    if (this.objets == null) return code\n    this.objets.forEach((objet) => {\n      objet.opacite = this.opacite\n    })\n    for (const objet of this.objets) code += '\\n\\t' + objet.svg(coeff)\n    return code\n  }\n\n  tikz() {\n    let code = ''\n    if (this.objets == null) return code\n    this.objets.forEach((objet) => {\n      objet.opacite = this.opacite\n    })\n    for (const objet of this.objets) code += '\\n\\t' + objet.tikz()\n    return code\n  }\n}\n\n/**\n * Affiche la cte d'un segment sous la forme d'une flche  double sens et d'une valeur associe.\n * @param {Segment} s Segment pour lequel on affiche la cte\n * @param {string} [Cote=''] Si '', alors la longueur en cm est affiche, sinon c'est cette valeur qui s'affiche (et cela peut tre une variable).\n * @param {number} [positionCote = 0.5] Position de la flche par rapport au segment. Valeur ngative ou positive selon la position voulue.\n * @param {string} [couleurCote='black'] Couleur de la flche  : du type 'blue' ou du type '#f15929'.\n * @param {number} [epaisseurCote=1] Epaisseur de la flche.\n * @param {number} [positionValeur=0.5] Position de la valeur par rapport  la flche. Valeur ngative ou positive selon la position voulue.\n * @param {string} [couleurValeur='black']  Couleur de la valeur indique : du type 'blue' ou du type '#f15929'.\n * @param {boolean} [horizontal=false]  Si true, alors le texte est horizontal, sinon le texte est parallle au segment.\n * @example afficheCoteSegment(s)\n * // Affiche la cte du segment s (avec une flche noire d\\'paisseur 1 \"cm\", place 0.5 \"cm\" sous le segment, avec la longueur du segment, en cm, crite en noir, 0,5 \"cm\" au-dessus, et parallle au segment.\n * @example afficheCoteSegment(s,'x',-1,'red',2,1,'blue',true)\n * // Affiche la cte du segment s, avec une flche rouge d\\'paisseur 2 \"cm\", place 1 \"cm\" sous le segment, avec le texte 'x' crit en bleu, 1 \"cm\" au-dessus, et horizontalement.\n * @return {AfficheCoteSegment|Vide2d}\n * @author Jean-Claude Lhote\n */\n// JSDOC Validee par EE Juin 2022\n\nexport function afficheCoteSegment(\n  s: Segment,\n  Cote = '',\n  positionCote = 0.5,\n  couleurCote = 'black',\n  epaisseurCote = 1,\n  positionValeur = 0.5,\n  couleurValeur = 'black',\n  horizontal = false,\n) {\n  if (s.longueur < 1) {\n    window.notify(\n      'afficheCoteSegment : Segment trop petit pour cette fonction',\n      { s },\n    )\n    return new Vide2d(s.extremite1.x, s.extremite1.y)\n  }\n  return new AfficheCoteSegment(\n    s,\n    Cote,\n    positionCote,\n    couleurCote,\n    epaisseurCote,\n    positionValeur,\n    couleurValeur,\n    horizontal,\n  )\n}\n\n/**\n * Code un segment\n * @param {PointAbstrait} A Premire extrmit du segment\n * @param {PointAbstrait} B Seconde extrmit du segment\n * @param {string} [mark='||'] Symbole pos sur le segment\n * @param {string} [color='black'] Couleur du symbole : du type 'blue' ou du type '#f15929'\n * @param {number} [echelle=1] Taille relative du symbole\n * @example codageSegment(H,K) // Code le segment [HK] avec la marque noire '||'\n * @example codageAngle(H,K,'x','green') // Code le segment [HK] avec la marque verte 'x'\n * @example codageAngle(H,K,'x','green',{echelle : 3}) // Code le segment [HK] avec la marque verte 'x' et de taille 3.\n * @author Rmi Angot\n * @return {TexteParPoint}\n */\n// JSDOC Validee par EE Juin 2022\nexport function codageSegment(\n  A: PointAbstrait,\n  B: PointAbstrait,\n  mark = '||',\n  color = 'black',\n  echelle = 0.5,\n) {\n  const O = milieu(A, B)\n  const s = segment(A, B)\n  let angle\n  if (B.x > A.x) {\n    angle = -parseInt(s.angleAvecHorizontale.toFixed(0))\n  } else {\n    angle = -parseInt(s.angleAvecHorizontale.toFixed(0)) + 180\n  }\n  return new TexteParPoint(mark, O, angle, color, echelle)\n}\n\n/**\n * Code plusieurs segments de la mme faon\n * @param {string} [mark = '||'] Symbole pos sur le segment\n * @param {string} [color = 'black'] Couleur du symbole : : du type 'blue' ou du type '#f15929'\n * @param  {Point[]|Segment|number} args Les segments diffrement cods + Taille relative du codage\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @author Rmi Angot\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class CodageSegments extends ObjetMathalea2D {\n  echelle: number\n  stringColor: string // Pour pouvoir passer une simple couleur aux autres constructeurs.\n  mark: string\n  isEchelle: boolean\n  args: (PointAbstrait | Point | Segment | number)[]\n  constructor(mark = '||', color = 'black', ...args: any[]) {\n    super()\n    this.args = args\n    this.mark = mark\n    this.stringColor = color\n    this.isEchelle = typeof args[args.length - 1] === 'number'\n    this.echelle = this.isEchelle ? (args[args.length - 1] as number) : 1\n    const trouveExtrem = function (\n      xmin: number,\n      ymin: number,\n      xmax: number,\n      ymax: number,\n      ...pointsOuSegment: (Point | Segment)[]\n    ): [number, number, number, number] {\n      if (pointsOuSegment.length === 0) return [xmin, ymin, xmax, ymax]\n      else {\n        const premierElement = pointsOuSegment.shift() as unknown\n        if (premierElement instanceof Segment) {\n          xmin = Math.min(xmin, premierElement.x1, premierElement.x2)\n          xmax = Math.max(xmax, premierElement.x1, premierElement.x2)\n          ymin = Math.min(ymin, premierElement.y1, premierElement.y2)\n          ymax = Math.max(ymax, premierElement.y1, premierElement.y2)\n          return trouveExtrem(xmin, ymin, xmax, ymax, ...pointsOuSegment)\n        } else if (premierElement instanceof Point) {\n          xmin = Math.min(xmin, premierElement.x)\n          xmax = Math.max(xmax, premierElement.x)\n          ymin = Math.min(ymin, premierElement.y)\n          ymax = Math.max(ymax, premierElement.y)\n          return trouveExtrem(xmin, ymin, xmax, ymax, ...pointsOuSegment)\n        } else {\n          return trouveExtrem(xmin, ymin, xmax, ymax, ...pointsOuSegment)\n        }\n      }\n    }\n    this.bordures = trouveExtrem(\n      1000,\n      1000,\n      -1000,\n      -1000,\n      ...(args as (Point | Segment)[]),\n    ) as unknown as [number, number, number, number]\n  }\n\n  svg(coeff: number) {\n    let code = ''\n    if (Array.isArray(this.args[0])) {\n      // Si on donne un tableau de points\n      for (let i = 0; i < this.args[0].length - 1; i++) {\n        const codage = codageSegment(\n          this.args[0][i],\n          this.args[0][i + 1],\n          this.mark,\n          this.stringColor,\n          this.echelle,\n        )\n        code += codage.svg(coeff)\n        code += '\\n'\n      }\n      const codage = codageSegment(\n        this.args[0][this.args[0].length - 1],\n        this.args[0][0],\n        this.mark,\n        this.stringColor,\n        this.echelle,\n      )\n      code += codage.svg(coeff)\n      code += '\\n'\n    } else if (this.args[0].constructor === Segment) {\n      for (\n        let i = 0;\n        i < (this.isEchelle ? this.args.length - 1 : this.args.length);\n        i++\n      ) {\n        const codage = codageSegment(\n          (this.args[i] as Segment).extremite1,\n          (this.args[i] as Segment).extremite2,\n          this.mark,\n          this.stringColor,\n          this.echelle,\n        )\n        code += codage.svg(coeff)\n        code += '\\n'\n      }\n    } else {\n      for (\n        let i = 0;\n        i < (this.isEchelle ? this.args.length - 1 : this.args.length);\n        i += 2\n      ) {\n        if (\n          [this.args[i], this.args[i + 1]].every(\n            (p) => p instanceof Point || p instanceof PointAbstrait,\n          )\n        ) {\n          const codage = codageSegment(\n            this.args[i] as PointAbstrait,\n            this.args[i + 1] as Point,\n            this.mark,\n            this.stringColor,\n            this.echelle,\n          )\n          code += codage.svg(coeff)\n          code += '\\n'\n        }\n      }\n    }\n    code = `<g id=\"${this.id}\">${code}</g>`\n    return code\n  }\n\n  tikz() {\n    let code = ''\n    if (Array.isArray(this.args[0])) {\n      // Si on donne une liste de points\n      for (let i = 0; i < this.args[0].length - 1; i++) {\n        code += codageSegment(\n          this.args[0][i],\n          this.args[0][i + 1],\n          this.mark,\n          this.stringColor,\n          this.echelle,\n        ).tikz()\n        code += '\\n'\n      }\n      code += codageSegment(\n        this.args[0][this.args[0].length - 1],\n        this.args[0][0],\n        this.mark,\n        this.stringColor,\n      ).tikz()\n      code += '\\n'\n    } else if (this.args[0].constructor === Segment) {\n      const condition = this.isEchelle ? this.args.length - 1 : this.args.length\n      for (let i = 0; i < condition; i++) {\n        code += codageSegment(\n          (this.args[i] as Segment).extremite1,\n          (this.args[i] as Segment).extremite2,\n          this.mark,\n          this.stringColor,\n        ).tikz()\n        code += '\\n'\n      }\n    } else {\n      const condition = this.isEchelle ? this.args.length - 1 : this.args.length\n      for (let i = 0; i < condition; i += 2) {\n        if (\n          [this.args[i], this.args[i + 1]].every(\n            (p) => p instanceof Point || p instanceof PointAbstrait,\n          )\n        ) {\n          code += codageSegment(\n            this.args[i] as PointAbstrait,\n            this.args[i + 1] as PointAbstrait,\n            this.mark,\n            this.stringColor,\n            this.echelle,\n          ).tikz()\n          code += '\\n'\n        }\n      }\n    }\n    return code\n  }\n}\n\n/**\n * Code plusieurs segments de la mme faon\n * @param {string} [mark = '||'] Symbole pos sur le segment\n * @param {string} [color = 'black'] Couleur du symbole : : du type 'blue' ou du type '#f15929'\n * @param {Points|Point[]|Segments|number} args Les segments diffrement cods + Taille relative du codage. Voir exemples.\n * @example codageSegments('','blue',A,B, B,C, C,D) // Code les segments [AB], [BC] et [CD] avec une croix bleue\n * @example codageSegments('','blue',A,B, B,C, C,D, 1.2) // Code les segments [AB], [BC] et [CD] avec une croix bleue et une taille de 1.2\n * @example codageSegments('','blue',[A,B,C,D]) // Code les segments [AB], [BC], [CD] et [DA] (attention, chemin ferm, pratique pour des polygones pas pour des lignes brises)\n * @example codageSegments('','blue',[A,B,C,D],1.5) // Code les segments [AB], [BC], [CD] et [DA] (attention, chemin ferm, pratique pour des polygones pas pour des lignes brises) et une taille de la marque de 1.5\n * @example codageSegments('','blue',s1,s2,s3) // Code les segments s1, s2 et s3 avec une croix bleue\n * @example codageSegments('','blue',p.listePoints) // Code tous les segments du polygone avec une croix bleue\n * @author Rmi Angot\n * @return {CodageSegments}\n */\n// JSDOC Validee par EE Juin 2022\nexport function codageSegments(mark = '||', color = 'black', ...args: any[]) {\n  return new CodageSegments(mark, color, ...args)\n}\n\n/**\n * Code un angle\n * @param {Point} debut Point sur un ct de l'angle\n * @param {Point} centre Sommet de l'angle\n * @param {number|Point} angle Mesure de l'angle ou nom d'un point sur l'autre ct de l'angle\n * @param {number} [taille=0.8] Taille de l'angle\n * @param {string} [mark=''] Marque sur l'angle\n * @param {string} [color='black'] Couleur de l'angle : du type 'blue' ou du type '#f15929'\n * @param {number} [epaisseur=1] Epaisseur du trac de l'angle\n * @param {number} [opacite=1] Opacit de la couleur du trac de l'angle\n * @param {string} [couleurDeRemplissage='none'] 'none' si on ne veut pas de remplissage, sinon une couleur du type 'blue' ou du type '#f15929'\n * @param {number} [opaciteDeRemplissage=0.2] Opacit de la couleur de remplissage de l'angle\n * @param {boolean} [mesureOn=false] Affichage de la mesure de l'angle\n * @param {boolean} [noAngleDroit=false] Pour choisir si on veut que l'angle droit soit marqu par un carr ou pas\n * @param {string} [texteACote=''] Pour mettre un texte  ct de l'angle  la place de la mesure de l'angle\n * @param {number} [tailleTexte=1] Pour choisir la taille du texte  ct de l'angle\n * @param {number} [echelleMark=1] Pour choisir la taille relative de la marque\n * @property {Point} debut Point sur un ct de l'angle\n * @property {Point} centre Sommet de l'angle\n * @property {number|Point} angle Mesure de l'angle ou nom d'un point sur l'autre ct de l'angle\n * @property {number} taille Taille de l'angle\n * @property {string} mark Marque sur l'angle\n * @property {string} color Couleur de l'angle.  associer obligatoirement  colorToLatexOrHTML().\n * @property {number} epaisseur Epaisseur du trac de l'angle\n * @property {number} opacite Opacit de la couleur du trac de l'angle\n * @property {string} couleurDeRemplissage  associer obligatoirement  colorToLatexOrHTML(). 'none' si on ne veut pas de remplissage.\n * @property {number} opaciteDeRemplissage Opacit de la couleur de remplissage de l'angle\n * @property {number} tailleTexte Pour choisir la taille du texte  ct de l'angle\n * @property {number} echelleMark Pour choisir la taille relative de la marque\n * @author Jean-Claude Lhote\n * @return {array} Liste d'objets MathAlea2D\n */\n// JSDOC Validee par EE Juin 2022\nexport class CodageAngle extends ObjetMathalea2D {\n  debut: PointAbstrait\n  centre: PointAbstrait\n  angle: number\n  taille: number\n  mark: string\n  echelleMark: number\n  tailleTexte: number\n  angleArrondi: number\n  couleurDeRemplissage: string[]\n  opaciteDeRemplissage: number\n\n  constructor(\n    debut: PointAbstrait,\n    centre: PointAbstrait,\n    angle: PointAbstrait | number,\n    taille = 0.8,\n    mark = '',\n    color = 'black',\n    epaisseur = 1,\n    opacite = 1,\n    couleurDeRemplissage = 'none',\n    opaciteDeRemplissage = 0.2,\n    mesureOn = false,\n    texteACote = '',\n    tailleTexte = 1,\n    { echelleMark = 1, angleArrondi = 0 } = {},\n  ) {\n    super()\n    this.color = colorToLatexOrHTML(color)\n    this.debut = debut\n    this.centre = centre\n    this.taille = taille\n    this.mark = mark\n    this.echelleMark = echelleMark\n    this.epaisseur = epaisseur\n    this.opacite = opacite\n    this.couleurDeRemplissage = colorToLatexOrHTML(couleurDeRemplissage)\n    this.opaciteDeRemplissage = opaciteDeRemplissage\n    this.angle =\n      angle instanceof PointAbstrait\n        ? angleOriente(debut, centre, angle)\n        : angle\n    this.tailleTexte = tailleTexte\n    this.angleArrondi = angleArrondi\n    this.objets = []\n    const depart = pointSurSegment(\n      this.centre,\n      this.debut,\n      (this.taille * 20) / context.pixelsParCm,\n    )\n    const P = rotation(depart, this.centre, this.angle / 2)\n    const M = pointSurSegment(\n      this.centre,\n      P,\n      this.taille + (0.6 * 20) / context.pixelsParCm,\n    )\n    const d = droite(this.centre, P)\n    const mesure = arrondi(Math.abs(this.angle), this.angleArrondi) + '^\\\\circ'\n    const arcangle = arc(\n      depart,\n      this.centre,\n      this.angle,\n      couleurDeRemplissage !== 'none',\n      couleurDeRemplissage,\n      color,\n    )\n    arcangle.opacite = this.opacite\n    arcangle.epaisseur = this.epaisseur\n    arcangle.opaciteDeRemplissage = this.opaciteDeRemplissage\n    this.objets.push(arcangle)\n    if (this.mark !== '') {\n      const t = texteParPoint(\n        mark,\n        P,\n        90 - d.angleAvecHorizontale,\n        color,\n        this.echelleMark,\n      )\n      this.objets.push(t)\n    }\n    if (mesureOn && texteACote === '') {\n      const t = latex2d(mesure, M.x + 0.2, M.y, {\n        color,\n        letterSize: tailleDeNbVersLatex(this.taille),\n      })\n      this.objets.push(t)\n    } else if (texteACote !== '') {\n      if (texteACote.includes('$')) {\n        M.positionLabel = 'center'\n        const label = latex2d(\n          texteACote.substring(1, texteACote.length - 1),\n          M.x,\n          M.y,\n          { color, backgroundColor: 'none' },\n        )\n        this.objets.push(label)\n      } else\n        this.objets.push(\n          texteParPoint(texteACote, M, 0, color, this.tailleTexte),\n        )\n    }\n    const bordures = fixeBordures(this.objets, {\n      rxmin: 0,\n      rxmax: 0,\n      rymin: 0,\n      rymax: 0,\n    })\n    this.bordures = [bordures.xmin, bordures.ymin, bordures.xmax, bordures.ymax]\n  }\n}\n\n/**\n * affiche du Latex 'sur' un segment orient\n * @param {Point} A Premire extrmit du segment\n * @param {Point} B Seconde extrmit du segment\n * @param {number} [distance = 0.5] Couleur du codage : du type 'blue' ou du type '#f15929'.\n * @author Olivier Mimeau\n * @return {Latex2d}\n */\n\nfunction directionLatex2d(A: PointAbstrait, B: PointAbstrait): number {\n  // pour du texte dans le bon sens de lecture\n  const sAB = segment(A, B)\n  let directionAB = sAB.angleAvecHorizontale\n  directionAB =\n    directionAB > 90\n      ? directionAB - 180\n      : directionAB < -90\n        ? directionAB + 180\n        : directionAB\n  return directionAB\n}\nfunction placeLatex2d(\n  A: PointAbstrait,\n  B: PointAbstrait,\n  distance: number = 0.5,\n): Point {\n  // le point d'affichage du texte  0.5 sous le milieu du segment orient\n  const M = milieu(A, B)\n  const N = rotation(A, M, -90)\n  const P = pointSurSegment(M, N, distance)\n  return P\n}\n/**\n *\n * @param t Place du latex sur un segment orient une belle alternative  texteSurSegment\n * @param A\n * @param B\n * @param options\n * @returns {Latex2d}\n */\nexport function placeLatexSurSegment(\n  t: string,\n  A: PointAbstrait,\n  B: PointAbstrait,\n  {\n    distance = 0.5,\n    color = 'black',\n    backgroundColor = 'none',\n    letterSize = 'normalsize',\n    horizontal = false,\n  }: {\n    distance?: number\n    color?: string\n    backgroundColor?: string\n    letterSize?: LetterSizeType\n    horizontal?: boolean\n  } = {},\n): Latex2d {\n  const Q = latex2d(\n    t,\n    placeLatex2d(A, B, distance).x,\n    placeLatex2d(A, B, distance).y,\n    {\n      orientation: horizontal ? 0 : directionLatex2d(A, B),\n      color,\n      backgroundColor,\n      letterSize,\n    },\n  )\n  return Q\n}\n","import {\n  colorToLatexOrHTML,\n  fixeBordures,\n  mathalea2d,\n  ObjetMathalea2D,\n  vide2d,\n} from '../../modules/2dGeneralites'\nimport { context } from '../../modules/context'\nimport { egal } from '../../modules/outils'\nimport type { Angle } from '../mathFonctions/trigo'\nimport { arrondi, unSiPositifMoinsUnSinon } from '../outils/nombres'\nimport { arc, cercle, cercleCentrePoint } from './cercle'\nimport { CodageAngle } from './codages'\nimport { point, pointSurCercle, pointSurSegment } from './points'\nimport { polygone, polyline } from './polygones'\nimport { longueur, segment, vecteur } from './segmentsVecteurs'\nimport { latexParPoint, texteParPoint, texteParPosition } from './textes'\nimport { homothetie, rotation } from './transformations'\nimport type { PointAbstrait } from './points-abstraits'\n\nexport type MarkType =\n  | 'simple'\n  | 'double'\n  | 'triple'\n  | 'gras'\n  | 'double-gras'\n  | 'gras-simple-gras'\n  | 'simple-gras-simple'\n  | 'pointilles'\n  | 'double-pointilles'\n  | 'mixte-simple-pointilles'\n  | 'mixte-gras-pointilles'\nexport const markTypeArray: MarkType[] = [\n  'simple',\n  'double',\n  'triple',\n  'gras',\n  'double-gras',\n  'gras-simple-gras',\n  'simple-gras-simple',\n  'pointilles',\n  'double-pointilles',\n  'mixte-simple-pointilles',\n  'mixte-gras-pointilles',\n]\nexport class MarqueAngle extends ObjetMathalea2D {\n  constructor(\n    start: PointAbstrait,\n    sommet: PointAbstrait,\n    end: PointAbstrait,\n    {\n      mark = 'simple',\n      color = 'black',\n      rayon = 1,\n    }: {\n      mark: MarkType\n      color?: string\n      rayon?: number\n    },\n  ) {\n    super()\n    this.objets = []\n    const a = pointSurSegment(sommet, start, rayon)\n    const angle = angleOriente(start, sommet, end)\n    switch (mark) {\n      case 'double':\n        {\n          const aPrime = homothetie(a, sommet, 0.9)\n          const aSeconde = homothetie(a, sommet, 1.1)\n          this.objets.push(\n            arc(aPrime, sommet, angle, false, 'none', color),\n            arc(aSeconde, sommet, angle, false, 'none', color),\n          )\n        }\n        break\n      case 'triple':\n        {\n          const aPrime = homothetie(a, sommet, 0.9)\n          const aSeconde = homothetie(a, sommet, 1.1)\n          this.objets.push(\n            arc(aPrime, sommet, angle, false, 'none', color),\n            arc(a, sommet, angle, false, 'none', color),\n            arc(aSeconde, sommet, angle, false, 'none', color),\n          )\n        }\n        break\n      case 'gras':\n        {\n          const marqueGrasse = arc(a, sommet, angle, false, 'none', color)\n          marqueGrasse.epaisseur = 4\n          this.objets.push(marqueGrasse)\n        }\n        break\n      case 'double-gras':\n        {\n          const aPrime = homothetie(a, sommet, 0.9)\n          const aSeconde = homothetie(a, sommet, 1.1)\n          const marqueGrasse1 = arc(aPrime, sommet, angle, false, 'none', color)\n          const marqueGrasse2 = arc(\n            aSeconde,\n            sommet,\n            angle,\n            false,\n            'none',\n            color,\n          )\n          marqueGrasse1.epaisseur = 2\n          marqueGrasse2.epaisseur = 2\n          this.objets.push(marqueGrasse1, marqueGrasse2)\n        }\n        break\n      case 'gras-simple-gras':\n        {\n          const aPrime = homothetie(a, sommet, 0.85)\n          const aSeconde = homothetie(a, sommet, 1.15)\n          const marqueGrasse1 = arc(aPrime, sommet, angle, false, 'none', color)\n          const marqueGrasse2 = arc(\n            aSeconde,\n            sommet,\n            angle,\n            false,\n            'none',\n            color,\n          )\n          marqueGrasse1.epaisseur = 2\n          marqueGrasse2.epaisseur = 2\n          this.objets.push(\n            marqueGrasse1,\n            arc(a, sommet, angle, false, 'none', color),\n            marqueGrasse2,\n          )\n        }\n        break\n      case 'simple-gras-simple':\n        {\n          const aPrime = homothetie(a, sommet, 0.85)\n          const aSeconde = homothetie(a, sommet, 1.15)\n          const marqueGrasse = arc(a, sommet, angle, false, 'none', color)\n          const marqueSimple1 = arc(aPrime, sommet, angle, false, 'none', color)\n          const marqueSimple2 = arc(\n            aSeconde,\n            sommet,\n            angle,\n            false,\n            'none',\n            color,\n          )\n          marqueGrasse.epaisseur = 2\n          this.objets.push(marqueSimple1, marqueGrasse, marqueSimple2)\n        }\n        break\n      case 'pointilles':\n        {\n          const marque = arc(a, sommet, angle, false, 'none', color)\n          marque.pointilles = 3\n          marque.epaisseur = 2\n          this.objets.push(marque)\n        }\n        break\n      case 'double-pointilles':\n        {\n          const aPrime = homothetie(a, sommet, 1)\n          const aSeconde = homothetie(a, sommet, 1.1)\n          const marque1 = arc(aPrime, sommet, angle, false, 'none', color)\n          const marque2 = arc(aSeconde, sommet, angle, false, 'none', color)\n          marque1.pointilles = 5\n          marque2.pointilles = 5\n          this.objets.push(marque1, marque2)\n        }\n        break\n      case 'mixte-simple-pointilles':\n        {\n          const aPrime = homothetie(a, sommet, 0.9)\n          const aSeconde = homothetie(a, sommet, 1.1)\n          const marque = arc(aSeconde, sommet, angle, false, 'none', color)\n          const marque1 = arc(aPrime, sommet, angle, false, 'none', color)\n          marque1.pointilles = 3\n          marque1.epaisseur = 2\n          marque.epaisseur = 2\n          this.objets.push(marque, marque1)\n        }\n        break\n      case 'mixte-gras-pointilles':\n        {\n          const aPrime = homothetie(a, sommet, 0.9)\n          const aSeconde = homothetie(a, sommet, 1.1)\n          const marque1 = arc(aSeconde, sommet, angle, false, 'none', color)\n          const marque = arc(aPrime, sommet, angle, false, 'none', color)\n          marque1.pointilles = 3\n          marque.epaisseur = 2\n          this.objets.push(marque, marque1)\n        }\n        break\n      case 'simple':\n      default:\n        {\n          const marque = arc(a, sommet, angle, false, 'none', color)\n          marque.epaisseur = 2\n          this.objets.push(marque)\n        }\n        break\n    }\n    const bordures = fixeBordures(this.objets, {\n      rxmin: 0,\n      rxmax: 0,\n      rymin: 0,\n      rymax: 0,\n    })\n    this.bordures = [bordures.xmin, bordures.ymin, bordures.xmax, bordures.ymax]\n  }\n\n  svg(coeff: number) {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.svg(coeff)\n    }\n    return code\n  }\n\n  tikz() {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.tikz()\n    }\n    return code\n  }\n}\n\nexport function marqueAngle(\n  start: PointAbstrait,\n  sommet: PointAbstrait,\n  end: PointAbstrait,\n  {\n    mark = 'simple',\n    color = 'black',\n    rayon = 1,\n  }: {\n    mark: MarkType\n    color?: string\n    rayon?: number\n  },\n) {\n  return new MarqueAngle(start, sommet, end, { mark, color, rayon })\n}\n\nexport class Rapporteur extends ObjetMathalea2D {\n  x: number\n  y: number\n  taille: number\n\n  constructor({\n    x = 0,\n    y = 0,\n    taille = 7,\n    depart = 0,\n    semi = false,\n    avecNombre = 'deuxSens',\n    precisionAuDegre = 1,\n    stepGraduation = 10,\n    rayonsVisibles = true,\n    color = 'gray',\n  }) {\n    super()\n    this.x = x\n    this.y = y\n    this.taille = taille\n    this.opacite = 0.7\n    this.color = colorToLatexOrHTML(color)\n    this.objets = []\n    let numero\n    let azimut\n    let rayon\n    let nbDivisions\n    let arcPlein\n    if (semi) {\n      arcPlein = 180\n      nbDivisions = 18\n    } else {\n      arcPlein = 360\n      nbDivisions = 36\n    }\n\n    const centre = point(this.x, this.y)\n    azimut = rotation(point(this.x + 1, this.y), centre, depart)\n    let azimut2 = pointSurSegment(centre, azimut, this.taille)\n    const arc1 = arc(azimut, centre, arcPlein - 0.1, false, 'none', color)\n    const arc2 = arc(azimut2, centre, arcPlein - 0.1, false, 'none', color)\n    this.objets.push(segment(azimut2, rotation(azimut2, centre, 180), color))\n    rayon = segment(azimut, azimut2, color)\n    if (rayonsVisibles) this.objets.push(arc1)\n    // this.objets.push(arc2, rayon)\n    this.objets.push(arc2)\n    for (let i = 0; i < nbDivisions; i++) {\n      if (avecNombre !== '') {\n        if (avecNombre === 'deuxSens') {\n          if (i === 0) {\n            numero = texteParPoint(\n              String(arcPlein),\n              rotation(homothetie(azimut2, centre, 0.8), centre, 2),\n              -depart,\n              color,\n              0.65,\n            )\n            numero.contour = true\n            this.objets.push(numero)\n          }\n          if (i === nbDivisions - 1) {\n            numero = texteParPoint(\n              String(arcPlein - (1 + i) * 10),\n              rotation(\n                homothetie(azimut2, centre, 0.8),\n                centre,\n                arcPlein / nbDivisions - 2,\n              ),\n              -depart,\n              color,\n              0.65,\n            )\n            numero.contour = true\n            this.objets.push(numero)\n          } else if ((arcPlein - (1 + i) * 10) % stepGraduation === 0) {\n            numero = texteParPoint(\n              String(arcPlein - (1 + i) * 10),\n              rotation(\n                homothetie(azimut2, centre, 0.8),\n                centre,\n                arcPlein / nbDivisions,\n              ),\n              90 - (1 + i) * 10 - depart,\n              color,\n              0.78,\n            )\n            numero.contour = true\n            this.objets.push(numero)\n          }\n        }\n        if (i === 0) {\n          numero = texteParPoint(\n            '0',\n            rotation(homothetie(azimut2, centre, 0.9), centre, 2),\n            -depart,\n            color,\n            0.65,\n          )\n          numero.contour = true\n          this.objets.push(numero)\n        }\n        if (i === nbDivisions - 1) {\n          numero = texteParPoint(\n            String((1 + i) * 10),\n            rotation(\n              homothetie(azimut2, centre, 0.9),\n              centre,\n              arcPlein / nbDivisions - 2,\n            ),\n            -depart,\n            color,\n            0.65,\n          )\n          numero.contour = true\n          this.objets.push(numero)\n        } else if (((i + 1) * 10) % stepGraduation === 0) {\n          numero = texteParPoint(\n            String((1 + i) * 10),\n            rotation(\n              homothetie(azimut2, centre, 0.9),\n              centre,\n              arcPlein / nbDivisions,\n            ),\n            90 - (1 + i) * 10 - depart,\n            color,\n            0.65,\n          )\n          numero.contour = true\n          this.objets.push(numero)\n        }\n      }\n      for (let s = 1, r; s < 10; s++) {\n        if (s === 5 && precisionAuDegre < 10) {\n          r = segment(\n            homothetie(rotation(azimut2, centre, s), centre, 0.92),\n            homothetie(rotation(azimut2, centre, s), centre, 0.99),\n            color,\n          )\n          r.opacite = 0.6\n          r.tailleExtremites = 0.65\n          this.objets.push(r)\n        } else if (precisionAuDegre === 1) {\n          r = segment(\n            homothetie(rotation(azimut2, centre, s), centre, 0.96),\n            homothetie(rotation(azimut2, centre, s), centre, 0.99),\n            color,\n          )\n          r.opacite = 0.6\n          r.tailleExtremites = 0.65\n          this.objets.push(r)\n        }\n      }\n      if (i !== 0 && i !== 36 && i !== 18) this.objets.push(rayon)\n      azimut = rotation(azimut, centre, arcPlein / nbDivisions)\n      azimut2 = rotation(azimut2, centre, arcPlein / nbDivisions)\n      if (rayonsVisibles) rayon = segment(azimut, azimut2, color)\n      else rayon = segment(homothetie(azimut2, centre, 0.9), azimut2, color)\n      rayon.opacite = this.opacite\n    }\n    if (!semi) {\n      rayon = segment(\n        homothetie(rotation(azimut, centre, -90), centre, -0.2),\n        homothetie(rotation(azimut, centre, -90), centre, 0.2),\n        color,\n      )\n      this.objets.push(rayon)\n      rayon = segment(\n        homothetie(azimut, centre, -0.2),\n        homothetie(azimut, centre, 0.2),\n        color,\n      )\n    } else {\n      rayon = segment(\n        centre,\n        homothetie(rotation(azimut, centre, -90), centre, 0.2),\n        color,\n      )\n    }\n    this.objets.push(rayon)\n    const bordures = fixeBordures(this.objets, {\n      rxmin: 0,\n      rxmax: 0,\n      rymin: 0,\n      rymax: 0,\n    })\n    this.bordures = [bordures.xmin, bordures.ymin, bordures.xmax, bordures.ymax]\n  }\n\n  svg(coeff: number) {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.svg(coeff)\n    }\n    return code\n  }\n\n  tikz() {\n    let code = ''\n    if (this.objets == null) return code\n    for (const objet of this.objets) {\n      code += '\\n\\t' + objet.tikz()\n    }\n    return code\n  }\n}\n\n/**\n * place un rapporteur centr en (x,y) avec le zro orient  depart degrs.\n * @param {object} parametres\n * @param {number} [parametres.x] abscisse du centre du rapporteur\n * @param {number} [parametres.y] ordonne du centre du rapporteur\n * @param {number} [parametres.taille] taille du rapporteur\n * @param {number} [parametres.depart] orientation du zro du rapporteur en degrs\n * @param {boolean} [parametres.semi] si semi === false alors les graduations vont de 0  180 sinon de 0  360\n * @param {string} [parametres.avecNombre] === \"\", il n'y a pas de graduations, si avecNombre === \"deuxSens\" il est gradu dans les deux directions\n * si avecNombre === \"unSens\" il est gradu dans le sens trigo.\n * @param {number}[parametres. precisionAuDegre] === 10 alors il n'y aura pas de graduations entre les multiples de 10, les autres valeurs sont 5 et 1.\n * @param {number} [parametres.stepGraduation] est un multiple de 10 qui divise 180 (c'est mieux) donc 10 (par dfaut), ou 20, ou 30, ou 60 ou 90.\n * @param {boolean} [parametres.rayonsVisibles] = false permet de supprimer les rayons et le cercle central\n * @param {object} param0 = {x: 'number', y: 'number', taille: 'number', semi: boolean, avecNombre: string}\n * @return {Rapporteur} // cre un instance de l'objet 2d Rapporteur\n */\nexport function rapporteur({\n  x = 0,\n  y = 0,\n  taille = 7,\n  depart = 0,\n  semi = false,\n  avecNombre = 'deuxSens',\n  precisionAuDegre = 1,\n  stepGraduation = 10,\n  rayonsVisibles = true,\n  color = 'gray',\n}) {\n  return new Rapporteur({\n    x,\n    y,\n    taille,\n    depart,\n    semi,\n    avecNombre,\n    precisionAuDegre,\n    stepGraduation,\n    rayonsVisibles,\n    color,\n  })\n}\n\n/**\n * Renvoie la mesure d'angle en degr\n * @param {PointAbstrait} A Point sur un ct de l'angle\n * @param {PointAbstrait} O Sommet de l'angle\n * @param {PointAbstrait} B Point sur l'autre ct de l'angle\n * @param {number} [precision = 2] Nombre maximal de dcimales de la valeur arrondie de la mesure de l'angle\n * @example x = angle(H,E,T)\n * // x contient la mesure en degr de l'angle HET, arrondi au centime\n * @example x = angle(H,E,T,0)\n * // x contient la mesure en degr de l'angle HET, arrondi  l'unit\n * @return {number}\n * @author Rmi Angot\n */\n// JSDOC Validee par EE Juin 2022\nexport function angle(\n  A: PointAbstrait,\n  O: PointAbstrait,\n  B: PointAbstrait,\n  precision = 2,\n) {\n  const OA = longueur(O, A, precision)\n  const OB = longueur(O, B, precision)\n  const AB = longueur(A, B, precision)\n  if (OA > 0 && OB > 0) {\n    const v = vecteur(O, A)\n    const w = vecteur(O, B)\n    if (egal(v.x * w.y - v.y * w.x, 0)) {\n      // vecteurs colinaires  epsilon prs pour viter les effets de bords dus aux flottants.\n      if (v.x * w.x > 0) return 0\n      else if (v.x * w.x < 0) return 180\n      else if (v.y * w.y > 0) return 0\n      else return 180\n    } else {\n      let cos = (AB ** 2 - OA ** 2 - OB ** 2) / (-2 * OA * OB)\n      if (cos < -1) cos = -1\n      if (cos > 1) cos = 1\n      const alpha = Math.acos(cos)\n      return arrondi((alpha * 180) / Math.PI, precision)\n    }\n  } else {\n    // Ce n'est pas normal de demander la mesure d'un angle dont un ct a une longueur nulle.\n    return 0\n  }\n}\n\n/**\n * Convertit un nombre de degrs quelconque en une mesure comprise entre -180 et 180\n * @param {number} a Valeur en degrs dont on cherche la valeur entre -180 et 180\n * @example x = angleModulo(170)\n * // x contient 170\n * @example x = angleModulo(190)\n * // x contient -170\n * @example x = angleModulo(3690)\n * // x contient 90\n * @example x = angleModulo(180)\n * // x contient 180\n * @example x = angleModulo(-180)\n * // x contient 180\n * @return {number}\n */\n// JSDOC Validee par EE Juin 2022\nexport function angleModulo(a: number) {\n  while (a <= -180) a = a + 360\n  while (a > 180) a = a - 360\n  return a\n}\n\n/**\n * Retourne la valeur signe de la mesure d'un angle en degr\n * @param {PointAbstrait} A Point sur un ct de l'angle\n * @param {PointAbstrait} O Sommet de l'angle\n * @param {PointAbstrait} B Point sur l'autre ct de l'angle\n * @param {number} [precision = 2] Nombre maximal de dcimales de la valeur arrondie de la mesure de l'angle orient\n * @example x = angleOriente(H,E,T)\n * // x contient la valeur de la mesure de l'angle orient HET, arrondie au centime\n * @example x = angleOriente(H,E,T,0)\n * // x contient la valeur de la mesure de l'angle orient HET, arrondie  l'unit\n * @return {number}\n * @author Jean-Claude Lhote\n */\n// JSDOC Validee par EE Juin 2022\nexport function angleOriente(\n  A: PointAbstrait,\n  O: PointAbstrait,\n  B: PointAbstrait,\n  precision = 2,\n) {\n  const OA = longueur(O, A, precision)\n  const OB = longueur(O, B, precision)\n  if (OA < 1e-12 || OB < 1e-12) {\n    // On considre qu'un ct de l'angle a une longueur nulle, et ce n'est pas normal !\n    // window.notify('angleOriente() a reu des points confondus pour dterminer l\\'angle !', { OA, OB })\n    return 0\n  }\n  const A2 = rotation(A, O, 90)\n  const v = vecteur(O, B)\n  const u = vecteur(O, A2)\n\n  return arrondi(\n    unSiPositifMoinsUnSinon(arrondi(v.x * u.x + v.y * u.y, 10)) *\n      angle(A, O, B, 10),\n    precision,\n  )\n}\n\n/**\n * Retourne la valeur la mesure d'un angle en radian\n * @param {PointAbstrait} A Point sur un ct de l'angle\n * @param {PointAbstrait} O Sommet de l'angle\n * @param {PointAbstrait} B Point sur l'autre ct de l'angle\n * @param {number} [precision = 2] Nombre maximal de dcimales de la valeur arrondie de la mesure de l'angle orient\n * @example x = angleradian(H,E,T)\n * // x contient la valeur de la mesure de l'angle HET en radians, arrondie au centime\n * @example x = angleradian(H,E,T,0)\n * // x contient la valeur de la mesure de l'angle HET en radians, arrondie  l'unit\n * @return {number}\n * @author Rmi Angot\n */\n// JSDOC Validee par EE Juin 2022\nexport function angleradian(\n  A: PointAbstrait,\n  O: PointAbstrait,\n  B: PointAbstrait,\n  precision = 2,\n) {\n  const OA = longueur(O, A, precision)\n  const OB = longueur(O, B, precision)\n  const AB = longueur(A, B, precision)\n  return arrondi(\n    Math.acos((AB ** 2 - OA ** 2 - OB ** 2) / (-2 * OA * OB)),\n    precision,\n  )\n}\n\n/**\n * Code un angle droit\n * @param {PointAbstrait} A Point sur un ct de l'angle droit\n * @param {PointAbstrait} O Sommet de l'angle droit\n * @param {PointAbstrait} B Point sur l'autre ct de l'angle droit\n * @param {string} [color='black'] Couleur du codage : du type 'blue' ou du type '#f15929'\n * @param {number} [d=0.4] Taille du codage de l'angle droit\n * @param {number} [epaisseur=0.5] Epaisseur du trait\n * @param {number} [opacite=1] Opacit du trait\n * @param {string} [couleurDeRemplissage='none'] 'none' si on ne veut pas de remplissage, sinon une couleur du type 'blue' ou du type '#f15929'\n * @param {number} [opaciteDeRemplissage=1] Taux d'opacit du remplissage entre 0 et 1\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} svgml Sortie,  main leve, au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} tikzml Sortie,  main leve, au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {PointAbstrait} depart Point sur un ct de l'angle droit\n * @property {PointAbstrait} sommet Sommet de l'angle droit\n * @property {PointAbstrait} arrivee Point sur l'autre ct de l'angle droit\n * @property {string} color Couleur du codage.  associer obligatoirement  colorToLatexOrHTML().\n * @property {number} taille Taille du codage de l'angle droit\n * @property {string} couleurDeRemplissage 'none' si on ne veut pas de remplissage.  associer obligatoirement  colorToLatexOrHTML().\n * @property {number} opaciteDeRemplissage Taux d'opacit du remplissage entre 0 et 1\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class CodageAngleDroit extends ObjetMathalea2D {\n  sommet: PointAbstrait\n  depart: PointAbstrait\n  arrivee: PointAbstrait\n  taille: number\n  color: [string, string]\n  couleurDeRemplissage: [string, string]\n  opaciteDeRemplissage: number\n\n  constructor(\n    A: PointAbstrait,\n    O: PointAbstrait,\n    B: PointAbstrait,\n    color = 'black',\n    d = 0.4,\n    epaisseur = 0.5,\n    opacite = 1,\n    couleurDeRemplissage = 'none',\n    opaciteDeRemplissage = 1,\n  ) {\n    super()\n    this.sommet = O\n    this.depart = A\n    this.arrivee = B\n    this.taille = d\n    this.color = colorToLatexOrHTML(color)\n    this.couleurDeRemplissage = colorToLatexOrHTML(couleurDeRemplissage)\n    this.opaciteDeRemplissage = opaciteDeRemplissage\n    const a = pointSurSegment(\n      this.sommet,\n      this.depart,\n      (this.taille * 20) / context.pixelsParCm,\n    )\n    const b = pointSurSegment(\n      this.sommet,\n      this.arrivee,\n      (this.taille * 20) / context.pixelsParCm,\n    )\n    let o\n    if (angleOriente(this.depart, this.sommet, this.arrivee) > 0) {\n      o = rotation(this.sommet, a, -90)\n    } else {\n      o = rotation(this.sommet, a, 90)\n    }\n    const bordures = fixeBordures([a, b, o], {\n      rxmin: 0,\n      rxmax: 0,\n      rymin: 0,\n      rymax: 0,\n    })\n    this.bordures = [bordures.xmin, bordures.ymin, bordures.xmax, bordures.ymax]\n    this.epaisseur = epaisseur\n    this.opacite = opacite\n  }\n\n  svg(coeff: number) {\n    const a = pointSurSegment(\n      this.sommet,\n      this.depart,\n      (this.taille * 20) / coeff,\n    )\n    const b = pointSurSegment(\n      this.sommet,\n      this.arrivee,\n      (this.taille * 20) / coeff,\n    )\n    let o: PointAbstrait\n    if (angleOriente(this.depart, this.sommet, this.arrivee) > 0) {\n      o = rotation(this.sommet, a, -90)\n    } else {\n      o = rotation(this.sommet, a, 90)\n    }\n    const result = polygone([this.sommet, a, o, b], this.color[0])\n    if (this.couleurDeRemplissage[0] !== 'none') {\n      result.couleurDeRemplissage = [\n        this.couleurDeRemplissage[0],\n        this.couleurDeRemplissage[1],\n      ]\n      result.opaciteDeRemplissage = this.opaciteDeRemplissage\n    }\n    result.epaisseur = this.epaisseur\n    result.opacite = this.opacite\n    this.id = result.id\n    return result.svg(coeff)\n  }\n\n  tikz() {\n    const a = pointSurSegment(\n      this.sommet,\n      this.depart,\n      this.taille / context.scale,\n    )\n    const b = pointSurSegment(\n      this.sommet,\n      this.arrivee,\n      this.taille / context.scale,\n    )\n    let o: PointAbstrait\n    if (angleOriente(this.depart, this.sommet, this.arrivee) > 0) {\n      o = rotation(this.sommet, a, -90)\n    } else {\n      o = rotation(this.sommet, a, 90)\n    }\n    const result = polygone([this.sommet, a, o, b], this.color[1])\n    if (this.couleurDeRemplissage[1] === '') {\n      result.couleurDeRemplissage = [\n        this.couleurDeRemplissage[0],\n        this.couleurDeRemplissage[1],\n      ]\n      result.opaciteDeRemplissage = this.opaciteDeRemplissage\n      result.epaisseur = this.epaisseur\n      result.opacite = this.opacite\n    }\n    return result.tikz()\n  }\n\n  svgml(coeff: number, amp: number) {\n    const a = pointSurSegment(\n      this.sommet,\n      this.depart,\n      (this.taille * 20) / coeff,\n    )\n    const b = pointSurSegment(\n      this.sommet,\n      this.arrivee,\n      (this.taille * 20) / coeff,\n    )\n    let o: PointAbstrait\n    if (angleOriente(this.depart, this.sommet, this.arrivee) > 0) {\n      o = rotation(this.sommet, a, -90)\n    } else {\n      o = rotation(this.sommet, a, 90)\n    }\n    return polyline([a, o, b], this.color[0]).svgml(coeff, amp)\n  }\n\n  tikzml(amp: number) {\n    const a = pointSurSegment(\n      this.sommet,\n      this.depart,\n      this.taille / context.scale,\n    )\n    const b = pointSurSegment(\n      this.sommet,\n      this.arrivee,\n      this.taille / context.scale,\n    )\n    let o: PointAbstrait\n    if (angleOriente(this.depart, this.sommet, this.arrivee) > 0) {\n      o = rotation(this.sommet, a, -90)\n    } else {\n      o = rotation(this.sommet, a, 90)\n    }\n    return polyline([a, o, b], this.color[1]).tikzml(amp)\n  }\n}\n\n/**\n * Code un angle droit\n * @param {PointAbstrait} A Point sur un ct de l'angle droit\n * @param {PointAbstrait} O Sommet de l'angle droit\n * @param {PointAbstrait} B Point sur l'autre ct de l'angle droit\n * @param {string} [color='black'] Couleur du codage : du type 'blue' ou du type '#f15929'\n * @param {number} [d=0.4] Taille du codage de l'angle droit\n * @param {number} [epaisseur=0.5] Epaisseur du trait\n * @param {number} [opacite=1] Opacit du trait\n * @param {string} [couleurDeRemplissage='none'] 'none' si on ne veut pas de remplissage, sinon une couleur du type 'blue' ou du type '#f15929'\n * @param {number} [opaciteDeRemplissage=1] Taux d'opacit du remplissage\n * @example codageAngleDroit(A,J,T)\n * // Trace un codage d'angle droit pour l'angle direct AJT, de couleur noire, de taille 0,4, d'paisseur 0,5 avec une opacit de 100 %, sans remplissage\n * @example codageAngleDroit(A,J,T,'pink',1,0.2,0.6,'blue',0.2)\n * // Trace un codage d'angle droit pour l'angle direct AJT, de couleur rose, de taille 1, d'paisseur 0,2 avec une opacit de 60 %, rempli en bleu avec une opacit de 20%.\n * @return {CodageAngleDroit}\n * @author Rmi Angot\n */\n// JSDOC Validee par EE Juin 2022\nexport function codageAngleDroit(\n  A: PointAbstrait,\n  O: PointAbstrait,\n  B: PointAbstrait,\n  color = 'black',\n  d = 0.4,\n  epaisseur = 0.5,\n  opacite = 1,\n  couleurDeRemplissage = 'none',\n  opaciteDeRemplissage = 1,\n) {\n  return new CodageAngleDroit(\n    A,\n    O,\n    B,\n    color,\n    d,\n    epaisseur,\n    opacite,\n    couleurDeRemplissage,\n    opaciteDeRemplissage,\n  )\n}\n\n/**\n * Code un angle\n * @param {PointAbstrait} A Point sur un ct de l'angle\n * @param {PointAbstrait} O Sommet de l'angle\n * @param {number|PointAbstrait} angle Mesure de l'angle ou nom d'un point sur l'autre ct de l'angle\n * @param {number} [taille=0.8] Taille de l'angle\n * @param {string} [mark=''] Marque sur l'angle\n * @param {string} [color='black'] Couleur de l'angle : du type 'blue' ou du type '#f15929'\n * @param {number} [epaisseur=1] Epaisseur du trac de l'angle\n * @param {number} [opacite=1] Opacit de la couleur du trac de l'angle\n * @param {string} [couleurDeRemplissage='none'] 'none' si on ne veut pas de remplissage, sinon une couleur du type 'blue' ou du type '#f15929'\n * @param {number} [opaciteDeRemplissage=0.2] Opacit de la couleur de remplissage de l'angle\n * @param {boolean} [mesureOn=false] Affichage de la mesure de l'angle\n * @param {boolean} [noAngleDroit=false] Pour choisir si on veut que l'angle droit soit marqu par un carr ou pas\n * @param {string} [texteACote=''] Pour mettre un texte  ct de l'angle  la place de la mesure de l'angle\n * @param {number} [tailleTexte=1] Pour choisir la taille du texte  ct de l'angle\n * @param {object} [options={}]\n * @param {number} [options.echelleMark=1] Taille relative de la marque de l'angle\n * @param {number} [options.angleArrondi=0] Arrondi de l'angle\n * @example codageAngle(H,K,30)\n * // Code l'angle de centre K, avec H sur un ct de l'angle et avec 30 comme mesure d'angle orient,\n * // en noir, avec une paisseur de 1, une opacit de 100 %, un rayon d'arc de 0,8, sans autre option.\n * @example codageAngle(H,K,G)\n * // Code l'angle HKG, en noir, avec une paisseur de 1, une opacit de 100 %, un rayon d'arc de 0,8, sans autre option.\n * @example codageAngle(H,K,G,2,'x','red',0.5,0.2,'blue',0.8,true,true)\n * // Code l'angle HKG, en rouge, avec une paisseur de 0.5 et une opacit de 20 %, rempli en bleu avec une opacit de 80 %\n * // avec un arc de cercle de rayon 2, avec une marque 'x' sur l'angle, en affichant la mesure de l'angle et sans faire apparatre d'angle droit le cas chant.\n * @example codageAngle(H,K,G,2,'x','red',0.5,0.2,'blue',0.8,true,true,'?',2)\n * // Code l'angle HKG, en rouge, avec une paisseur de 0.5 et une opacit de 20 %, rempli en bleu avec une opacit de 80 %\n * // avec un arc de cercle de rayon 2, avec une marque 'x' sur l'angle, en affichant le texte '?' d'une taille de 2 et sans faire apparatre d'angle droit le cas chant.\n * @author Jean-Claude Lhote\n * @return {CodageAngle|CodageAngleDroit}\n */\n// JSDOC Validee par EE Juin 2022\nexport function codageAngle(\n  A: PointAbstrait,\n  O: PointAbstrait,\n  angle: PointAbstrait | number,\n  taille = 0.8,\n  mark = '',\n  color = 'black',\n  epaisseur = 1,\n  opacite = 1,\n  couleurDeRemplissage = 'none',\n  opaciteDeRemplissage = 0.2,\n  mesureOn = false,\n  noAngleDroit = false,\n  texteACote = '',\n  tailleTexte = 1,\n  { echelleMark = 1, angleArrondi = 0 } = {},\n) {\n  let angleNumerique: number\n  if (typeof angle !== 'number') {\n    angleNumerique = angleOriente(A, O, angle)\n  } else {\n    angleNumerique = angle\n  }\n  if ((angleNumerique === 90 || angleNumerique === -90) && !noAngleDroit) {\n    return new CodageAngleDroit(\n      A,\n      O,\n      rotation(A, O, angleNumerique),\n      color,\n      taille,\n      epaisseur,\n      opacite,\n      couleurDeRemplissage,\n      opaciteDeRemplissage,\n    )\n  } else\n    return new CodageAngle(\n      A,\n      O,\n      angleNumerique,\n      taille,\n      mark,\n      color,\n      epaisseur,\n      opacite,\n      couleurDeRemplissage,\n      opaciteDeRemplissage,\n      mesureOn,\n      texteACote,\n      tailleTexte,\n      { echelleMark, angleArrondi },\n    )\n}\n\nexport class NomAngleParPosition extends ObjetMathalea2D {\n  constructor(nom: string, x: number, y: number, color: string, s: number) {\n    super()\n    this.objets = []\n    this.objets.push(texteParPosition(nom, x, y, 0, color, 1, 'milieu', true))\n    const s1 = segment(\n      x - 0.6,\n      y + 0.4 - s / 10,\n      x + 0.1,\n      y + 0.4 + s / 10,\n      color,\n    )\n    const s2 = segment(\n      x + 0.1,\n      y + 0.4 + s / 10,\n      x + 0.8,\n      y + 0.4 - s / 10,\n      color,\n    )\n    this.objets.push(s1, s2)\n  }\n\n  svg(coeff: number) {\n    let code = ''\n    if (this.objets != null) {\n      for (const objet of this.objets) {\n        code += '\\n\\t' + (objet as ObjetMathalea2D).svg(coeff)\n      }\n      return code\n    } else return ''\n  }\n\n  tikz() {\n    let code = ''\n    if (this.objets != null) {\n      for (const objet of this.objets) {\n        code += '\\n\\t' + objet.tikz()\n      }\n      return code\n    } else return ''\n  }\n}\n\nexport function nomAngleSaillantParPosition(\n  nom: string,\n  x: number,\n  y: number,\n  color: string,\n) {\n  return new NomAngleParPosition(nom, x, y, color, 1)\n}\n\nexport function nomAngleRentrantParPosition(\n  nom: string,\n  x: number,\n  y: number,\n  color: string,\n) {\n  return new NomAngleParPosition(nom, x, y, color, -1)\n}\n\n/**\n *\n * @param {Angle} angle\n * @param {string} cosOrSin\n * @returns string\n */\nexport function cercleTrigo(angle: Angle, cosOrSin = 'cos') {\n  const monAngle = parseInt(angle.degres ?? '0')\n  const r = 5\n  const tAngle = angle.radians\n  const tCos = Array.isArray(angle.cos) ? angle.cos[0] : angle.cos\n  const tSin = Array.isArray(angle.sin) ? angle.sin[0] : angle.sin\n  const O = point(0, 0)\n  const I = point(r, 0)\n  const J = point(0, r)\n  const I2 = point(-r, 0)\n  const J2 = point(0, -r)\n  const s1 = segment(I, I2)\n  const s2 = segment(J, J2)\n  const c = cercleCentrePoint(O, I)\n  const c2 = cercle(O, 5.7)\n  const M = pointSurCercle(c, monAngle, '')\n  const M2 = pointSurCercle(c2, monAngle, '')\n  const sOM = segment(O, M, 'blue')\n  const sOI = segment(O, I, 'blue')\n  sOM.epaisseur = 3\n  sOI.epaisseur = 3\n  const x = point(M.x, 0)\n  const y = point(0, M.y)\n  const sMx = !egal(M.y, 0) ? segment(M, x) : vide2d()\n  sMx.pointilles = 5\n  const sMy = !egal(M.x, 0) ? segment(M, y) : vide2d()\n  sMy.pointilles = 5\n  const texteAngle = latexParPoint(tAngle ?? '0', M2)\n  const Rx = point(M.x, M.y < 0 ? 1.5 : -1.5)\n  const Ry = point(M.x < 0 ? 0.65 : -1.5, M.y)\n  const texteCosinus = latexParPoint(tCos ?? '0', Rx)\n  const texteSinus = latexParPoint(tSin ?? '0', Ry)\n  const sCos = segment(O, point(M.x, 0))\n  const sSin = segment(O, point(0, M.y))\n  sCos.epaisseur = 3\n  sSin.epaisseur = 3\n  const marqueAngle = codageAngle(I, O, M)\n  marqueAngle.color = colorToLatexOrHTML('blue')\n  marqueAngle.epaisseur = 3\n  const objetsTrigo = []\n  if (cosOrSin === 'cos') {\n    objetsTrigo.push(texteCosinus, sCos, sMx)\n  } else {\n    objetsTrigo.push(texteSinus, sSin, sMy)\n  }\n  return mathalea2d(\n    {\n      xmin: -r - 3,\n      xmax: r + 3,\n      ymin: -r - 1.8,\n      ymax: r + 1.8,\n      scale: 0.5,\n    },\n    c,\n    texteAngle,\n    marqueAngle,\n    s1,\n    s2,\n    ...objetsTrigo,\n    sOM,\n    sOI,\n  )\n}\n","import {\n  colorToLatexOrHTML,\n  ObjetMathalea2D,\n} from '../../modules/2dGeneralites'\nimport { degToRad } from '../mathFonctions/trigo'\nimport { arrondi } from '../outils/nombres'\nimport { angleModulo, angleOriente } from './angles'\nimport { Droite, droite, mediatrice } from './droites'\nimport MainLevee from './MainLevee'\nimport { Point, point } from './points'\nimport { PointAbstrait } from './points-abstraits'\nimport { pattern } from './polygones'\nimport { longueur } from './segmentsVecteurs'\nimport { rotation } from './transformations'\n\n/**\n * Construit le cercle (ou le disque) de centre O, de rayon r\n * @param {Point} O Centre du cercle\n * @param {number} r Rayon du cercle\n * @param {string} [color = 'black'] Couleur du cercle ou 'none' : du type 'blue' ou du type '#f15929'\n * @param {string} [couleurDeRemplissage = 'none'] Couleur de remplissage ou 'none' : du type 'blue' ou du type '#f15929'\n * @param {string} [couleurDesHachures = 'none'] Couleur des hachures ou 'none' : du type 'blue' ou du type '#f15929' Si 'none' ou '', pas de hachures.\n * @param {number} [epaisseur = 1] Epaisseur du cercle\n * @param {number} [pointilles = 0] Style des pointills du cercle (entier entre 1 et 5). Si autre chose, pas de pointills.\n * @param {number} [opacite = 1] Opacit du cercle\n * @param {number} [opaciteDeRemplissage = 1.1] Opacit du disque si couleur de remplissage choisie.\n * @param {number} [epaisseurDesHachures = 1] Epaisseur des hachures si couleur de hachures choisie.\n * @param {number} [distanceDesHachures = 10] Distance des hachures si couleur de remplissage choisie.\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} svgml Sortie,  main leve, au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} tikzml Sortie,  main leve, au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {Point} centre Centre du cercle\n * @property {number} rayon Rayon du cercle\n * @property {string} color Couleur du cercle ou 'none'.  associer obligatoirement  colorToLatexOrHTML().\n * @property {string} couleurDeRemplissage Couleur de remplissage ou 'none'.  associer obligatoirement  colorToLatexOrHTML().\n * @property {number} epaisseur Epaisseur du cercle\n * @property {number} pointilles Style des pointills du cercle (entier entre 1 et 5). Si autre chose, pas de pointills.\n * @property {number} opacite Opacit du cercle\n * @property {number} opaciteDeRemplissage Opacit du disque si couleur de remplissage choisie.\n * @property {string} hachures Hachures ou pas ?\n * @property {string} couleurDesHachures Couleur des hachures ou 'none'.  associer obligatoirement  colorToLatexOrHTML(). Si 'none' ou '', pas de hachures.\n * @property {number} epaisseurDesHachures Epaisseur des hachures si couleur de hachures choisie.\n * @property {number} distanceDesHachures Distance des hachures si couleur de remplissage choisie.\n * @property {number[]} bordures Coordonnes de la fentre d'affichage du genre [-2,-2,5,5]\n * @author Rmi Angot\n * @class\n */\n// JSDOC Validee par EE Juin 2022\nexport class Cercle extends ObjetMathalea2D {\n  centre: PointAbstrait\n  rayon: number\n  couleurDeRemplissage: string[]\n  opaciteDeRemplissage: number\n  hachures?: string\n  couleurDesHachures: string[]\n  epaisseurDesHachures: number\n  distanceDesHachures: number\n\n  constructor(\n    O: PointAbstrait,\n    r: number,\n    color = 'black',\n    couleurDeRemplissage = 'none',\n    couleurDesHachures = 'none',\n    epaisseur = 1,\n    pointilles = 0,\n    opacite = 1,\n    opaciteDeRemplissage = 1.1,\n    epaisseurDesHachures = 1,\n    distanceDesHachures = 10,\n  ) {\n    super()\n    this.color = colorToLatexOrHTML(color)\n    this.centre = O\n    this.rayon = r\n    this.couleurDeRemplissage = colorToLatexOrHTML(couleurDeRemplissage)\n    this.opaciteDeRemplissage = opaciteDeRemplissage\n    this.couleurDesHachures = colorToLatexOrHTML(couleurDesHachures)\n    this.epaisseurDesHachures = epaisseurDesHachures\n    this.distanceDesHachures = distanceDesHachures\n    this.bordures = [O.x - r, O.y - r, O.x + r, O.y + r]\n    this.epaisseur = epaisseur\n    this.pointilles = pointilles\n    this.opacite = opacite\n  }\n\n  svg(coeff: number) {\n    if (this.epaisseur !== 1) {\n      this.style += ` stroke-width=\"${this.epaisseur}\" `\n    }\n    switch (this.pointilles) {\n      case 1:\n        this.style += ' stroke-dasharray=\"6 10\" '\n        break\n      case 2:\n        this.style += ' stroke-dasharray=\"6 3\" '\n        break\n      case 3:\n        this.style += ' stroke-dasharray=\"3 2 6 2 \" '\n        break\n      case 4:\n        this.style += ' stroke-dasharray=\"1 2\" '\n        break\n      case 5:\n        this.style += ' stroke-dasharray=\"5 5\" '\n        break\n    }\n\n    if (this.hachures) {\n      if (this.couleurDeRemplissage.length < 1) {\n        this.couleurDeRemplissage = colorToLatexOrHTML('none')\n      }\n      return (\n        pattern({\n          motif: this.hachures,\n          id: String(this.id),\n          distanceDesHachures: this.distanceDesHachures,\n          epaisseurDesHachures: this.epaisseurDesHachures,\n          couleurDesHachures: this.couleurDesHachures[0],\n          couleurDeRemplissage: this.couleurDeRemplissage[0],\n          opaciteDeRemplissage: this.opaciteDeRemplissage,\n        }) +\n        `<circle cx=\"${this.centre.xSVG(coeff)}\" cy=\"${this.centre.ySVG(coeff)}\" r=\"${this.rayon * coeff}\" stroke=\"${this.color[0]}\" ${this.style} id=\"${this.id}\" fill=\"url(#pattern${this.id})\" />`\n      )\n    } else {\n      if (this.opacite !== 1) {\n        this.style += ` stroke-opacity=\"${this.opacite}\" `\n      }\n      if (this.couleurDeRemplissage[0] === '') {\n        this.style += ' fill=\"none\" '\n      } else {\n        this.style += ` fill=\"${this.couleurDeRemplissage[0]}\" `\n        this.style += ` fill-opacity=\"${this.opaciteDeRemplissage}\" `\n      }\n\n      return `<circle cx=\"${this.centre.xSVG(coeff)}\" cy=\"${this.centre.ySVG(coeff)}\" r=\"${\n        this.rayon * coeff\n      }\" stroke=\"${this.color[0]}\" ${this.style} id=\"${this.id}\" />`\n    }\n  }\n\n  tikz() {\n    let optionsDraw: string = ''\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color=${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width = ${this.epaisseur}`)\n    }\n    switch (this.pointilles) {\n      case 1:\n        tableauOptions.push(' dash dot ')\n        break\n      case 2:\n        tableauOptions.push(' densely dash dot dot ')\n        break\n      case 3:\n        tableauOptions.push(' dash dot dot ')\n        break\n      case 4:\n        tableauOptions.push(' dotted ')\n        break\n      case 5:\n        tableauOptions.push(' dashed ')\n        break\n    }\n\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity = ${this.opacite}`)\n    }\n    if (this.opaciteDeRemplissage !== 1) {\n      tableauOptions.push(`fill opacity = ${this.opaciteDeRemplissage}`)\n    }\n    if (\n      this.couleurDeRemplissage[1] !== '' &&\n      this.couleurDeRemplissage[1] !== 'none' &&\n      this.couleurDeRemplissage[1] !== ''\n    ) {\n      tableauOptions.push(\n        `preaction={fill,color = ${this.couleurDeRemplissage[1]}}`,\n      )\n    }\n\n    if (this.hachures) {\n      tableauOptions.push(\n        pattern({\n          motif: this.hachures,\n          id: String(this.id),\n          distanceDesHachures: this.distanceDesHachures,\n          epaisseurDesHachures: this.epaisseurDesHachures,\n          couleurDesHachures: this.couleurDesHachures[1],\n          couleurDeRemplissage: this.couleurDeRemplissage[1],\n          opaciteDeRemplissage: this.opaciteDeRemplissage,\n        }),\n      )\n    }\n\n    if (tableauOptions.length > 0) {\n      optionsDraw = '[' + tableauOptions.join(',') + ']'\n    }\n    return `\\\\draw${optionsDraw} (${this.centre.x},${this.centre.y}) circle (${this.rayon});`\n  }\n\n  svgml(coeff: number) {\n    const mainLevee = MainLevee.create()\n    if (mainLevee != null) {\n      const code = mainLevee.circle(\n        this.centre.x,\n        this.centre.y,\n        this.rayon * coeff,\n      )\n      mainLevee.destroy()\n      return code\n    } else return ''\n  }\n\n  tikzml(amp: number) {\n    let optionsDraw = ''\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color=${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width = ${this.epaisseur}`)\n    }\n\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity = ${this.opacite}`)\n    }\n    tableauOptions.push(\n      `decorate,decoration={random steps , amplitude = ${amp}pt}`,\n    )\n    optionsDraw = '[' + tableauOptions.join(',') + ']'\n\n    const code = `\\\\draw${optionsDraw} (${this.centre.x},${this.centre.y}) circle (${this.rayon});`\n    return code\n  }\n}\n\n/**\n * Construit le cercle (ou le disque) de centre O, de rayon r\n * @param {Point} O Centre du cercle\n * @param {number} r Rayon du cercle\n * @param {string} [color = 'black'] Couleur du cercle ou 'none' : du type 'blue' ou du type '#f15929'\n * @param {string} [couleurDeRemplissage = 'none'] Couleur de remplissage ou 'none' : du type 'blue' ou du type '#f15929'\n * @param {string} [couleurDesHachures = 'none'] Couleur des hachures ou 'none' : du type 'blue' ou du type '#f15929' Si 'none' ou '', pas de hachures.\n * @param {number} [epaisseur = 1] Epaisseur du cercle\n * @param {number} [pointilles = 0] Style des pointills du cercle (entier entre 1 et 5). Si autre chose, pas de pointills.\n * @param {number} [opacite = 1] Opacit du cercle\n * @param {number} [opaciteDeRemplissage = 1.1] Opacit du disque si couleur de remplissage choisie.\n * @param {number} [epaisseurDesHachures = 1] Epaisseur des hachures si couleur de hachures choisie.\n * @param {number} [distanceDesHachures = 10] Distance des hachures si couleur de remplissage choisie.\n * @example cercle (A,5)\n * // Construit un cercle c1 noir de centre A et de rayon 5\n * @example cercle (A,5,'red','blue','#f15929',3,2,0.3,0.8)\n * // Construit un disque de centre A et de rayon 5, de bord rouge  30 % d'opacit et en pointills, rempli en bleu  80 % d'opacit, et avec des hachures orange de 1 d'paisseur et avec 10 d'cart entre deux hachures\n * @example cercle (A,5,'red','blue','#f15929',3,2,0.3,0.8,2,12)\n * // Construit un disque de centre A et de rayon 5, de bord rouge  30 % d'opacit et en pointills, rempli en bleu  80 % d'opacit, et avec des hachures orange de 2 d'paisseur et avec 12 d'cart entre deux hachures\n * @return {Cercle}\n * @author Rmi Angot\n */\n// JSDOC Validee par EE Juin 2022\nexport function cercle(\n  O: PointAbstrait,\n  r: number,\n  color = 'black',\n  couleurDeRemplissage = 'none',\n  couleurDesHachures = 'none',\n  epaisseur = 1,\n  pointilles = 0,\n  opacite = 1,\n  opaciteDeRemplissage = 1.1,\n  epaisseurDesHachures = 1,\n  distanceDesHachures = 10,\n) {\n  return new Cercle(\n    O,\n    r,\n    color,\n    couleurDeRemplissage,\n    couleurDesHachures,\n    epaisseur,\n    pointilles,\n    opacite,\n    opaciteDeRemplissage,\n    epaisseurDesHachures,\n    distanceDesHachures,\n  )\n}\n\n/**\n * Construit le cercle (ou le disque) de centre O, passant par M\n * @param {Point} O Centre du cercle\n * @param {Point} M Point du cercle\n * @param {string} [color = 'black'] Couleur du cercle ou 'none' : du type 'blue' ou du type '#f15929'\n * @param {string} [couleurDeRemplissage = 'none'] Couleur de remplissage ou 'none' : du type 'blue' ou du type '#f15929'\n * @param {string} [couleurDesHachures = 'none'] Couleur des hachures ou 'none' : du type 'blue' ou du type '#f15929' Si 'none' ou '', pas de hachures.\n * @param {number} [epaisseur = 1] Epaisseur du cercle\n * @param {number} [pointilles = 0] Style des pointills du cercle (entier entre 1 et 5). Si autre chose, pas de pointills.\n * @param {number} [opacite = 1] Opacit du cercle\n * @param {number} [opaciteDeRemplissage = 1.1] Opacit du disque si couleur de remplissage choisie.\n * @param {number} [epaisseurDesHachures = 1] Epaisseur des hachures si couleur de hachures choisie.\n * @param {number} [distanceDesHachures = 10] Distance des hachures si couleur de remplissage choisie.\n * @example cercleCentrePoint (A,B)\n * // Construit un cercle c1 noir de centre A, passant par B\n * @example cercleCentrePoint (A,B,'red','blue','#f15929',3,2,0.3,0.8)\n * // Construit un disque de centre A, passant par B, de bord rouge  30 % d'opacit et en pointills, rempli en bleu  80 % d'opacit, et avec des hachures orange de 1 d'paisseur et avec 10 d'cart entre deux hachures\n * @example cercleCentrePoint (A,B,'red','blue','#f15929',3,2,0.3,0.8,2,12)\n * // Construit un disque de centre A, passant par B, de bord rouge  30 % d'opacit et en pointills, rempli en bleu  80 % d'opacit, et avec des hachures orange de 2 d'paisseur et avec 12 d'cart entre deux hachures\n * @return {Cercle}\n * @author Rmi Angot\n */\n// JSDOC Validee par EE Juin 2022\nexport function cercleCentrePoint(\n  O: Point,\n  M: Point,\n  color = 'black',\n  couleurDeRemplissage = 'none',\n  couleurDesHachures = 'none',\n  epaisseur = 1,\n  pointilles = 0,\n  opacite = 1,\n  opaciteDeRemplissage = 1.1,\n  epaisseurDesHachures = 1,\n  distanceDesHachures = 10,\n) {\n  return new Cercle(\n    O,\n    longueur(O, M, 2),\n    color,\n    couleurDeRemplissage,\n    couleurDesHachures,\n    epaisseur,\n    pointilles,\n    opacite,\n    opaciteDeRemplissage,\n    epaisseurDesHachures,\n    distanceDesHachures,\n  )\n}\n\n/** Trace un arc de cercle, connaissant une extrmit, son centre et la mesure de l'angle\n * @param {Point} M Extrmit de dpart de l'arc\n * @param {Point} Omega Centre de l'arc\n * @param {number|Point} angle Mesure de l'angle compris entre -360 et 360 (valeur ngative = sens indirect) ou bien point formant un angle avec M et Omega.\n * @param {boolean} [rayon = false] Si true, les rayons dlimitant l'arc sont ajouts.\n * @param {string} [couleurDeRemplissage = 'none'] Couleur ou 'none' : du type 'blue' ou du type '#f15929'\n * @param {string} [color = 'black'] Couleur de l'arc ou 'none' : du type 'blue' ou du type '#f15929'\n * @param {number} [opaciteDeRemplissage = 0.2] Opacit de remplissage de 0  1.\n * @param {string} [couleurDesHachures = 'none'] Couleur des hachures ou 'none' : du type 'blue' ou du type '#f15929' Si 'none', pas de hachures.\n * @property {string} svg Sortie au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} svgml Sortie,  main leve, au format vectoriel (SVG) que lon peut afficher dans un navigateur\n * @property {string} tikz Sortie au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} tikzml Sortie,  main leve, au format TikZ que lon peut utiliser dans un fichier LaTeX\n * @property {string} color Couleur de l'arc ou 'none'.  associer obligatoirement  colorToLatexOrHTML().\n * @property {string} couleurDeRemplissage Couleur ou 'none'.  associer obligatoirement  colorToLatexOrHTML().\n * @property {number} opaciteDeRemplissage Opacit de remplissage de 0  1.\n * @property {string} hachures Hachures ou pas ?\n * @property {string} couleurDesHachures Couleur des hachures ou 'none'.  associer obligatoirement  colorToLatexOrHTML(). Si 'none' ou '', pas de hachures.\n * @property {number} [opacite = 1] Opacit du cercle de 0  1.\n * @property {number} [epaisseurDesHachures = 1] Epaisseur des hachures si couleur de hachures choisie.\n * @property {number} [distanceDesHachures = 10] Distance des hachures si couleur de remplissage choisie.\n * @property {number} [pointilles = 0] Type de pointills choisis (entre 1 et 5). Si autre nombre, pas de pointills.\n * @property {number[]} bordures Coordonnes de la fentre d'affichage du genre [-2,-2,5,5]\n * @author Jean-Claude Lhote\n * @class\n **/\n// JSDOC Validee par EE Juin 2022\nexport class Arc extends ObjetMathalea2D {\n  rayons: boolean\n  couleurDeRemplissage: string[]\n  opaciteDeRemplissage: number\n  hachures?: string\n  couleurDesHachures: string[]\n  epaisseurDesHachures?: number\n  distanceDesHachures?: number\n  angle: number\n  rayon: number\n  angleFin: number\n  azimut: number\n  pointDepart: PointAbstrait\n  centre: PointAbstrait\n  pointFinal: PointAbstrait\n  constructor(\n    M: PointAbstrait,\n    omega: PointAbstrait,\n    angle: PointAbstrait | number,\n    rayons = false,\n    couleurDeRemplissage = 'none',\n    color = 'black',\n    opaciteDeRemplissage = 0.2,\n    couleurDesHachures = 'none',\n    opacite = 1,\n    epaisseurDesHachures = 1,\n    distanceDesHachures = 10,\n  ) {\n    super()\n    this.pointDepart = M\n    this.centre = omega\n    this.rayons = rayons\n    this.typeObjet = 'arc'\n    this.color = colorToLatexOrHTML(color)\n    this.couleurDeRemplissage = colorToLatexOrHTML(couleurDeRemplissage)\n    this.opaciteDeRemplissage = opaciteDeRemplissage\n    this.opacite = opacite ?? 1\n    this.epaisseurDesHachures = epaisseurDesHachures ?? 1\n    this.distanceDesHachures = distanceDesHachures ?? 10\n    this.pointilles = 0\n    this.epaisseur = 1\n    this.couleurDesHachures = colorToLatexOrHTML(couleurDesHachures)\n    this.angle =\n      angle instanceof PointAbstrait ? angleOriente(M, omega, angle) : angle\n    const medX: number[] = []\n    const medY: number[] = []\n    for (let ee = 1; ee < 9; ee++) {\n      medX.push(rotation(M, omega, (ee * this.angle) / 10).x)\n      medY.push(rotation(M, omega, (ee * this.angle) / 10).y)\n    }\n    this.rayon = longueur(omega, M, 2)\n    const A = point(omega.x + 1, omega.y)\n    this.azimut = angleOriente(A, omega, M)\n    this.angleFin = this.azimut + this.angle\n    const angleSVG = angleModulo(this.angle)\n\n    this.pointFinal = rotation(M, omega, angleSVG)\n    this.bordures = [\n      Math.min(M.x, this.pointFinal.x, ...medX) - 0.1,\n      Math.min(M.y, this.pointFinal.y, ...medY) - 0.1,\n      Math.max(M.x, this.pointFinal.x, ...medX) + 0.1,\n      Math.max(M.y, this.pointFinal.y, ...medY) + 0.1,\n    ]\n  }\n\n  svg(coeff: number) {\n    let sweep: number\n    let large: number\n    if (this.angle > 180) {\n      sweep = 0 // option pour path : permet de savoir quel morceau de cercle trac parmi les 2 possibles. Voir https://developer.mozilla.org/fr/docs/Web/SVG/Tutorial/Paths pour plus de dtails\n      large = 1 // option pour path : permet de savoir sur un morceau de cercle choisi, quel parcours prendre.\n    } else if (this.angle < -180) {\n      large = 1\n      sweep = 1\n    } else {\n      large = 0\n      sweep = 1 - (this.angle > 0 ? 1 : 0)\n    }\n    if (this.rayons) {\n      this.style = ''\n      if (this.opacite !== 1) {\n        this.style += ` stroke-opacity=\"${this.opacite}\" `\n      }\n      if (this.epaisseur !== 1) {\n        this.style += ` stroke-width=\"${this.epaisseur}\" `\n      }\n      switch (this.pointilles) {\n        case 1:\n          this.style += ' stroke-dasharray=\"6 10\" '\n          break\n        case 2:\n          this.style += ' stroke-dasharray=\"6 3\" '\n          break\n        case 3:\n          this.style += ' stroke-dasharray=\"3 2 6 2 \" '\n          break\n        case 4:\n          this.style += ' stroke-dasharray=\"1 2\" '\n          break\n        case 5:\n          this.style += ' stroke-dasharray=\"5 5\" '\n          break\n      }\n      if (\n        this.hachures != null &&\n        typeof this.hachures === 'string' &&\n        this.hachures !== ''\n      ) {\n        if (this.couleurDeRemplissage.length < 1) {\n          this.couleurDeRemplissage = colorToLatexOrHTML('none')\n        }\n        return (\n          pattern({\n            motif: this.hachures,\n            id: String(this.id),\n            distanceDesHachures: this.distanceDesHachures,\n            epaisseurDesHachures: this.epaisseurDesHachures,\n            couleurDesHachures: this.couleurDesHachures[0] ?? 'black',\n            couleurDeRemplissage: this.couleurDeRemplissage[0],\n            opaciteDeRemplissage: this.opaciteDeRemplissage,\n          }) +\n          `<path d=\"M${this.pointDepart.xSVG(coeff)} ${this.pointDepart.ySVG(coeff)} A ${this.rayon * coeff} ${this.rayon * coeff} 0 ${large} ${sweep} ${this.pointFinal.xSVG(coeff)} ${this.pointFinal.ySVG(coeff)} L ${this.centre.xSVG(coeff)} ${this.centre.ySVG(coeff)} Z\" stroke=\"${this.color[0]}\" ${this.style} id=\"${this.id}\" fill=\"url(#pattern${this.id})\"/>`\n        )\n      } else {\n        if (\n          this.couleurDeRemplissage[0] === '' ||\n          this.couleurDeRemplissage[0] === undefined ||\n          this.couleurDeRemplissage[0] === 'none'\n        ) {\n          this.style += ' fill=\"none\" '\n        } else {\n          this.style += ` fill=\"${this.couleurDeRemplissage[0]}\" `\n          this.style += ` fill-opacity=\"${this.opaciteDeRemplissage}\" `\n        }\n        return `<path d=\"M${this.pointDepart.xSVG(coeff)} ${this.pointDepart.ySVG(coeff)} A ${this.rayon * coeff} ${this.rayon * coeff} 0 ${large} ${sweep} ${this.pointFinal.xSVG(coeff)} ${this.pointFinal.ySVG(coeff)} L ${this.centre.xSVG(coeff)} ${this.centre.ySVG(coeff)} Z\" stroke=\"${this.color[0]}\" ${this.style}/>`\n      }\n    } else {\n      this.style = ''\n      if (this.epaisseur !== 1) {\n        this.style += ` stroke-width=\"${this.epaisseur}\" `\n      }\n      switch (this.pointilles) {\n        case 1:\n          this.style += ' stroke-dasharray=\"6 10\" '\n          break\n        case 2:\n          this.style += ' stroke-dasharray=\"6 3\" '\n          break\n        case 3:\n          this.style += ' stroke-dasharray=\"3 2 6 2 \" '\n          break\n        case 4:\n          this.style += ' stroke-dasharray=\"1 2\" '\n          break\n        case 5:\n          this.style += ' stroke-dasharray=\"5 5\" '\n          break\n      }\n      if (this.opacite !== 1) {\n        this.style += ` stroke-opacity=\"${this.opacite}\" `\n      }\n      if (\n        this.couleurDeRemplissage[0] === '' ||\n        this.couleurDeRemplissage[0] === undefined ||\n        this.couleurDeRemplissage[0] === 'none'\n      ) {\n        this.style += ' fill=\"none\" '\n      } else {\n        this.style += ` fill=\"${this.couleurDeRemplissage[0]}\" `\n        this.style += ` fill-opacity=\"${this.opaciteDeRemplissage}\" `\n      }\n      return `<path d=\"M${this.pointDepart.xSVG(coeff)} ${this.pointDepart.ySVG(coeff)} A ${this.rayon * coeff} ${this.rayon * coeff} 0 ${large} ${sweep} ${this.pointFinal.xSVG(coeff)} ${this.pointFinal.ySVG(coeff)}\" stroke=\"${this.color[0]}\" ${this.style} id=\"${this.id}\" />`\n    }\n  }\n\n  tikz() {\n    let optionsDraw: string = ''\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color=${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width = ${this.epaisseur}`)\n    }\n    switch (this.pointilles) {\n      case 1:\n        tableauOptions.push(' dash dot ')\n        break\n      case 2:\n        tableauOptions.push(' densely dash dot dot ')\n        break\n      case 3:\n        tableauOptions.push(' dash dot dot ')\n        break\n      case 4:\n        tableauOptions.push(' dotted ')\n        break\n      case 5:\n        tableauOptions.push(' dashed ')\n        break\n    }\n\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity = ${this.opacite}`)\n    }\n    if (\n      // this.rayons && (EE (14/05/2025) : ai comment cette ligne car je ne comprends pas pourquoi le remplissage dpendrait de this.rayons. Si prsent, cela fait dysfonctionner la sortie LaTeX des cas 3-4-5-6 de 6M21.)\n      this.couleurDeRemplissage[1] !== 'none' &&\n      this.couleurDeRemplissage[1] !== ''\n    ) {\n      tableauOptions.push(\n        `preaction={fill,color = ${this.couleurDeRemplissage[1]},opacity = ${this.opaciteDeRemplissage}}`,\n      )\n    }\n\n    if (\n      this.hachures != null &&\n      typeof this.hachures === 'string' &&\n      this.hachures !== ''\n    ) {\n      tableauOptions.push(\n        pattern({\n          motif: this.hachures,\n          id: String(this.id),\n          distanceDesHachures: this.distanceDesHachures,\n          couleurDesHachures: this.couleurDesHachures[1],\n          couleurDeRemplissage: this.couleurDeRemplissage[1],\n          opaciteDeRemplissage: this.opaciteDeRemplissage,\n        }),\n      )\n    }\n    if (tableauOptions.length > 0) {\n      optionsDraw = '[' + tableauOptions.join(',') + ']'\n    }\n    const lng = longueur(this.centre, this.pointDepart, 2)\n    if (this.rayons) {\n      return `\\\\draw  ${optionsDraw} (${this.pointFinal.x},${this.pointFinal.y}) -- (${this.centre.x},${this.centre.y}) -- (${this.pointDepart.x},${this.pointDepart.y}) arc (${this.azimut}:${this.angleFin}:${lng}) ;`\n    } else {\n      return `\\\\draw${optionsDraw} (${this.pointDepart.x},${this.pointDepart.y}) arc (${this.azimut}:${this.angleFin}:${lng}) ;`\n    }\n  }\n\n  svgml(coeff: number) {\n    const width = longueur(this.pointDepart, this.centre, 2) * coeff * 2\n    const height = width\n    const closed = this.rayons\n    const A = point(this.centre.x + 1, this.centre.y)\n    const end = degToRad(angleOriente(this.pointDepart, this.centre, A))\n    const start = end - degToRad(this.angle)\n    const mainLevee = MainLevee.create()\n    if (mainLevee != null) {\n      const code = mainLevee.arc(\n        this.centre.xSVG(coeff),\n        this.centre.ySVG(coeff),\n        width,\n        height,\n        start > end ? end : start,\n        start > end ? start : end,\n        closed,\n      )\n      mainLevee.destroy()\n      return code\n    } else return ''\n  }\n\n  tikzml(amp: number) {\n    let optionsDraw: string = ''\n    const tableauOptions = []\n    if (this.color[1].length > 1 && this.color[1] !== 'black') {\n      tableauOptions.push(`color=${this.color[1]}`)\n    }\n    if (this.epaisseur !== 1) {\n      tableauOptions.push(`line width = ${this.epaisseur}`)\n    }\n    if (this.opacite !== 1) {\n      tableauOptions.push(`opacity = ${this.opacite}`)\n    }\n    tableauOptions.push(\n      `decorate,decoration={random steps , amplitude = ${amp}pt}`,\n    )\n\n    optionsDraw = '[' + tableauOptions.join(',') + ']'\n\n    return `\\\\draw${optionsDraw} (${this.pointDepart.x},${this.pointDepart.y}) arc (${this.azimut}:${this.angleFin}:${arrondi(longueur(this.centre, this.pointDepart, 2), 2)}) ;`\n  }\n}\n\n/** Trace un arc de cercle, connaissant une extrmit, son centre et la mesure de l'angle\n * @param {Point} M Extrmit de dpart de l'arc\n * @param {Point} Omega Centre de l'arc\n * @param {number} angle Mesure de l'angle compris entre -360 et 360 (valeur ngative = sens indirect)\n * @param {boolean} [rayon = false] Boolen. Si true, les rayons dlimitant l'arc sont ajouts.\n * @param {string} [couleurDeRemplissage = 'none'] Couleur ou 'none' : du type 'blue' ou du type '#f15929'\n * @param {string} [color = 'black'] Couleur de l'arc ou 'none' : du type 'blue' ou du type '#f15929'\n * @param {number} [opaciteDeRemplissage = 0.2] Opacit de remplissage de 0  1.\n * @param {string} [couleurDesHachures = 'none'] Couleur des hachures ou 'none' : du type 'blue' ou du type '#f15929' Si 'none', pas de hachures.\n * @example arc(M,O,35)\n // Trace l'arc en noir de centre O, d'extrmit M et d'angle orient 35 (sans remplissage et sans hachures)\n * @example arc(M,O,true,-40,'red','green',0.8,'white')\n // Trace l'arc en vert de centre O, d'extrmit M et d'angle orient -40, rempli en rouge  80 %, avec des hachures blanches\n * @return {Arc}\n * @author Jean-Claude Lhote\n */\n// JSDOC Validee par EE Juin 2022\nexport function arc(\n  M: PointAbstrait,\n  Omega: PointAbstrait,\n  angle: PointAbstrait | number,\n  rayon = false,\n  couleurDeRemplissage = 'none',\n  color = 'black',\n  opaciteDeRemplissage = 0.2,\n  couleurDesHachures = 'none',\n) {\n  return new Arc(\n    M,\n    Omega,\n    angle,\n    rayon,\n    couleurDeRemplissage,\n    color,\n    opaciteDeRemplissage,\n    couleurDesHachures,\n  )\n}\n\n/** Trace un arc de cercle, connaissant deux extrmits et la mesure de l'angle\n * @param {Point} M Premire extrmit de l'arc\n * @param {Point} N Deuxime extrmit de l'arc\n * @param {number} angle Mesure de l'angle compris entre -360 et 360 (valeur ngative = sens indirect)\n * @param {boolean} [rayon = false] Boolen. Si true, les rayons dlimitant l'arc sont ajouts.\n * @param {boolean|'none'} [couleurDeRemplissage = 'none'] Couleur ou 'none' : du type 'blue' ou du type '#f15929'\n * @param {string} [color = 'black'] Couleur de l'arc ou 'none' : du type 'blue' ou du type '#f15929'\n * @param {number} [opaciteDeRemplissage = 0.2] Opacit de remplissage de 0  1.\n * @param {string} [couleurDesHachures = 'none'] Couleur des hachures ou 'none' : du type 'blue' ou du type '#f15929' Si 'none', pas de hachures.\n * @example arcPointPointAngle(A,B,35)\n // Trace l'arc en noir d'extrmits A et B (dans cet ordre) et d'angle orient 35 (sans remplissage et sans hachures)\n * @example arcPointPointAngle(A,B,true,-40,'red','green',0.8,'white')\n // Trace l'arc en vert d'extrmits A et B (dans cet ordre) et d'angle orient -40, rempli en rouge  80 %, avec des hachures blanches\n * @return {Arc}\n * @author Jean-Claude Lhote\n */\n// JSDOC Validee par EE Juin 2022\nexport function arcPointPointAngle(\n  M: PointAbstrait,\n  N: PointAbstrait,\n  angle: number,\n  rayon = false,\n  couleurDeRemplissage = 'none',\n  color = 'black',\n  opaciteDeRemplissage = 0.2,\n  couleurDesHachures = 'none',\n): Arc {\n  let anglerot\n  if (angle < 0) anglerot = (angle + 180) / 2\n  else anglerot = (angle - 180) / 2\n  const d = mediatrice(M, N) as Droite\n  const e = droite(N, M)\n  const f = rotation(e, N, anglerot)\n  const determinant = d.a * f.b - f.a * d.b\n  const Omegax = (d.b * f.c - f.b * d.c) / determinant\n  const Omegay = (f.a * d.c - d.a * f.c) / determinant\n  const Omega = point(Omegax, Omegay)\n  return new Arc(\n    M,\n    Omega,\n    angle,\n    rayon,\n    couleurDeRemplissage,\n    color,\n    opaciteDeRemplissage,\n    couleurDesHachures,\n  )\n}\n\n/**\n * m = traceCompas(O, A, 20) trace un arc de cercle de centre O qui commence 10 avant A et finit 10 aprs.\n *@author Jean-Claude Lhote\n */\nexport function traceCompas(\n  O: PointAbstrait,\n  A: PointAbstrait,\n  angle = 20,\n  color = 'gray',\n  opacite = 1.1,\n  epaisseur = 1,\n  pointilles = 0,\n) {\n  const B = rotation(A, O, -angle / 2)\n  const a = arc(B, O, angle, false)\n  a.epaisseur = epaisseur\n  a.opacite = opacite\n  a.color = colorToLatexOrHTML(color)\n  a.pointilles = pointilles\n  return a\n}\n","import Decimal from 'decimal.js'\nimport { abs, gcd, lcm, max, min, multiply, round } from 'mathjs'\nimport { arc, cercle } from '../lib/2d/cercle'\nimport { Point, point } from '../lib/2d/points'\nimport { carre } from '../lib/2d/polygones'\nimport { segment, vecteur } from '../lib/2d/segmentsVecteurs'\nimport { texteParPosition } from '../lib/2d/textes'\nimport { rotation, translation } from '../lib/2d/transformations'\nimport { extraireRacineCarree } from '../lib/outils/calculs'\nimport {\n  ecritureAlgebrique,\n  ecritureParentheseSiNegatif,\n  signeMoinsEnEvidence,\n} from '../lib/outils/ecritures'\nimport { miseEnEvidence } from '../lib/outils/embellissements'\nimport {\n  arrondi,\n  nombreDeChiffresDansLaPartieDecimale,\n} from '../lib/outils/nombres'\nimport {\n  decompositionFacteursPremiers,\n  listeDesDiviseurs,\n  obtenirListeFacteursPremiers,\n  pgcd,\n  ppcm,\n} from '../lib/outils/primalite'\nimport { stringNombre, texNombre } from '../lib/outils/texNombre'\nimport { colorToLatexOrHTML } from './2dGeneralites'\nimport { egal, quotientier } from './outils'\n\ntype FractionRepresentationType = 'gateau' | 'barre' | 'segment'\n\n// Fonction crite par Daniel Caillibaud pour crer ajouter les proprits  la premire utilisation de celles-ci.\nconst definePropRo = (\n  obj: FractionEtendue,\n  prop: string,\n  get: (args?: unknown) => unknown,\n) => {\n  Object.defineProperty(obj, prop, {\n    enumerable: true,\n    get,\n    set: () => {\n      throw Error(`${prop} est en lecture seule`)\n    },\n  })\n}\n\n/**\n * Une fonction pour transformer en FractionEtendue\n * @param x\n * @return {FractionEtendue}\n */\nexport function rationnalise(x: number | FractionEtendue | Decimal | null) {\n  if (x == null) {\n    window.notify(\n      'rationnalise est appel avec une valeur undefined ou nulle',\n      { x },\n    )\n    return new FractionEtendue(0, 1)\n  }\n  if (x instanceof FractionEtendue) return x\n  if (x instanceof Decimal) {\n    const numDen = x.toFraction(10000) // On limite le dnominateur  10000\n    return new FractionEtendue(numDen[0].toNumber(), numDen[1].toNumber())\n  }\n  if (typeof x === 'number') {\n    // MGU  : C'est dangereux ce truc mais bon...\n    // Dj a gre au del des centimes...\n    const numDen = new Decimal(x.toFixed(5)).toFraction(10000)\n    return new FractionEtendue(numDen[0].toNumber(), numDen[1].toNumber())\n  }\n  // c'est pas un number, c'est pas une FractionEtendue... a doit tre une Fraction de mathjs\n  window.notify(\n    'rationnalise est appel avec un nombre dont le format est inconnu :',\n    { x },\n  )\n  return x\n}\n\n/**\n * transforme si besoin les numrateurs et dnominateurs en number\n * @param n\n * @param d\n */\nfunction normalizeFraction(n: number | Decimal, d: number): [number, number] {\n  let num: number\n  let den: number\n  if (d == null) {\n    // un seul argument qui peut tre un nombre (dcimal ou pas)\n    if (n instanceof Decimal) {\n      // Decimal.toFraction() retourne '7, 4' pour 1.75... On rcupre ainsi le numrateur et le dnominateur.\n      const dec = n as Decimal\n      ;[num, den] = dec.toFraction(10000).map((el) => el.toNumber())\n    } else {\n      const f = rationnalise(n)\n      num = f.num // a c'est pas terrible... et a peut conduire  des fractions monumentales alors on se limite  4 dcimales\n      den = f.den\n    }\n  } else {\n    num = Number(n)\n    den = Number(d)\n  }\n  if (!isNaN(num) && !isNaN(den)) {\n    // Si ce sont des nombres, on les rend entiers si besoin.\n    //  num = Number(num) // Je ne vois pas bien  quoi a sert a ! ce sont dj des numbers !\n    //  den = Number(den) // Je le vire le 27/09/2023 (J-C)\n\n    // Mthode code par Eric Elter pour tenter de rendre rationnel un nombre qui ne l'est pas forcment.\n    let maxDecimalesNumDen: number = Math.max(\n      nombreDeChiffresDansLaPartieDecimale(num),\n      nombreDeChiffresDansLaPartieDecimale(den),\n    )\n    if (maxDecimalesNumDen > 9) {\n      // On peut estimer que num et/ou den ne sont pas dcimaux. Essayons de les diviser car peut-tre que leur quotient est mieux.\n      const quotientNumDen = arrondi(num / den, 12)\n      if (nombreDeChiffresDansLaPartieDecimale(quotientNumDen) < 9) {\n        // On peut estimer que le quotient aboutit  un dcimal. Ex. dans fraction(7/3,14/3)\n        num = quotientNumDen\n        den = 1\n        maxDecimalesNumDen = max(\n          nombreDeChiffresDansLaPartieDecimale(num),\n          nombreDeChiffresDansLaPartieDecimale(den),\n        )\n      } else {\n        // On peut estimer que le quotient n'aboutit pas  un dcimal. Essayons par l'inverse du quotient.\n        const quotientDenNum = arrondi(den / num, 12)\n        if (nombreDeChiffresDansLaPartieDecimale(quotientDenNum) < 9) {\n          // On peut estimer que l'inverse du quotient aboutit  un dcimal. Ex. dans fraction(7/3,7/9)\n          den = quotientDenNum\n          num = 1\n          maxDecimalesNumDen = max(\n            nombreDeChiffresDansLaPartieDecimale(num),\n            nombreDeChiffresDansLaPartieDecimale(den),\n          )\n        } else {\n          // num et/ou den non dcimaux et leurs quotients n'aboutissent pas  un dcimal. Essayons par l'inverse de chaque nombre.\n          const inverseNum = arrondi(1 / num, 12)\n          const inverseDen = arrondi(1 / den, 12)\n          maxDecimalesNumDen = max(\n            nombreDeChiffresDansLaPartieDecimale(inverseNum),\n            nombreDeChiffresDansLaPartieDecimale(inverseDen),\n          )\n          if (maxDecimalesNumDen < 13) {\n            // Ex. dans fraction(1/3,1/7)\n            den = inverseNum\n            num = inverseDen\n          } else {\n            // Mthode plus bourrin\n            const testMAX = 2000 // Voir explications ci-dessous\n            // Ici, JCL, cela veut dire qu'on traite toutes les fractions de fractions o chaque numrateur ou dnominateur est infrieur  1000.\n            // Si tu veux davantage que 1000, il faut augmenter ce nombre et dimininuer alors le nb de dcimales de test fix ici  9.\n            let iDen = 1\n            let denTest = den\n            let inverseDenTest = inverseDen\n            while (\n              min(\n                nombreDeChiffresDansLaPartieDecimale(denTest),\n                nombreDeChiffresDansLaPartieDecimale(inverseDenTest),\n              ) > 9 &&\n              iDen < testMAX\n            ) {\n              iDen += iDen % 5 === 3 ? 4 : 2\n              denTest = arrondi(den * iDen, 10)\n              inverseDenTest = arrondi(inverseDen * iDen, 10)\n            }\n            let iNum = 1\n            let numTest = num\n            let inverseNumTest = inverseNum\n            while (\n              min(\n                nombreDeChiffresDansLaPartieDecimale(numTest),\n                nombreDeChiffresDansLaPartieDecimale(inverseNumTest),\n              ) > 9 &&\n              iNum < testMAX\n            ) {\n              iNum += iNum % 5 === 3 ? 4 : 2\n              numTest = arrondi(num * iNum, 10)\n              inverseNumTest = arrondi(inverseNum * iNum, 10)\n            }\n            if (nombreDeChiffresDansLaPartieDecimale(numTest) < 10) {\n              if (nombreDeChiffresDansLaPartieDecimale(denTest) < 10) {\n                num = arrondi(numTest * iDen, 10)\n                den = arrondi(denTest * iNum, 10)\n              } else {\n                num = arrondi(numTest * inverseDenTest, 10)\n                den = iDen * iNum\n              }\n            } else {\n              if (nombreDeChiffresDansLaPartieDecimale(denTest) < 10) {\n                den = arrondi(denTest * inverseNumTest, 10)\n                num = iDen * iNum\n              } else {\n                den = arrondi(inverseNumTest * iDen, 10)\n                num = arrondi(inverseDenTest * iNum, 10)\n              }\n            }\n            maxDecimalesNumDen = max(\n              nombreDeChiffresDansLaPartieDecimale(num),\n              nombreDeChiffresDansLaPartieDecimale(den),\n            )\n          }\n        }\n      }\n    }\n    den = round(den * Math.pow(10, maxDecimalesNumDen))\n    num = round(num * Math.pow(10, maxDecimalesNumDen))\n    return [num, den]\n  } else {\n    window.notify(\n      \"Fraction Etendue : le constructeur a reu des valeurs impossibles  mettre sous la forme d'une fraction\",\n      { n, d },\n    )\n    return [NaN, NaN]\n  }\n}\n\n/**\n * La classe FractionEtendue est une extension de la classe  FractionMathjs  de mathjs\n * @author Jean-Claude Lhote\n * Merci  Daniel Caillibaud pour son aide.\n * Pour crer une instance de la classe FractionEtendue on peut utiliser la fonction fraction() qui se trouve dans le fichier modules/fractions\n * Ou utiliser la syntaxe f = new FractionEtendue () qui cre une  FractionMathjs  nulle.\n * On peut utiliser tous les arguments utilisables par  FractionMathjs  :\n * @example\n * // cre la  FractionMathjs  $\\frac{1}{3}$\n * f = new FractionEtendue ('0.(3)')\n * @example\n * // cre la  FractionMathjs  $\\frac{12}{15}$ (Remarque : new FractionEtendue(12,15) cre $\\frac{4}{5}$)\n * f = fraction(12,15)\n * @example\n * // cre la  FractionMathjs  $\\frac{2}{5}$\n * f = fraction(0.4)\n */\nclass FractionEtendue {\n  num: number\n  den: number\n  /**\n   * Numrateur rduit // Le numrateur rduit peut tre ngatif\n   */\n  numIrred: number\n  /**\n   * Dnominateur rduit // le dnominateur rduit est toujours positif.\n   */\n  denIrred: number\n  n: number\n  d: number\n  s: -1 | 1 | 0\n  type: 'FractionEtendue'\n  signe!: -1 | 1 | 0\n  sign!: -1 | 1 | 0\n  signeString!: '+' | '-' | ''\n  /**\n   * Valeur de la  FractionMathjs   100 arrondi au centime\n   */\n  pourcentage!: number\n  /**\n   * num/den mais sans traitement des signes des numrateur et dnominateur\n   */\n  texFraction!: string\n  /**\n   * le code LaTeX de la  FractionMathjs  simplifie\n   */\n  texFractionSimplifiee!: string\n  /**\n   * num/den mais avec simplification des signes (numrateur et dnominateur positifs, signe - eventuellement devant.)\n   * littralement texFractionSigneDevant (si c'est un moins sinon rien... pour avoir le + devant, utiliser texFractionSignee)\n   */\n  texFSD!: string\n  /**\n   * retourne la  Fraction avec signe devant  mis entre parenthses notamment pour l'exponentiation.\n   */\n  texParentheses!: string\n  /**\n   * num/den avec mise en vidence des signes - s'il y en a au numrateur et au dnominateur\n   */\n  texFractionSR!: string\n  /**\n   * + n/d si positif, - n/d si ngatif\n   * proprit qui n'est pas trs utile puisque ecritureAlgebrique gre les fractions maintenant (dfini pour compatibilit avec les exos qui l'utilisent)\n   */\n  texFractionSignee!: string\n  /**\n   * -1 => '-'\n   * 1 => ''\n   * inchang sinon\n   * permet d'crire le coefficient devant une lettre ou une parenthse\n   */\n  texFractionSaufUn!: string\n  /**\n   * Valeur dcimale de la  FractionMathjs  (arrondie  la sixime dcimale)\n   */\n  valeurDecimale!: number\n  /**\n   * -1 => '-'\n   * 1 => '+'\n   * texFractionSignee sinon\n   * permet d'crire le coefficient devant une lettre ou une parenthse\n   */\n  texFractionSaufUnSignee!: string\n  /**\n   * num/den si positif, (- num/den) sinon\n   * @property texFSP littralement texFractionSigneParentheses\n   * @type {string}\n   */\n  texFSP!: string\n  /**\n   * le code LaTeX de l'criture algbrique de la fraction\n   * Pour compatibilit avec les anciens exos... la fonction de outils ecritureAlgebrique() est compatible avec les fractions\n   */\n  ecritureAlgebrique!: string\n  /**\n   * le code LaTeX de l'criture avec parenthse si ngatif\n   */\n  ecritureParentheseSiNegatif!: string\n  /**\n   * true si la  FractionMathjs  est un entier false sinon\n   */\n  estEntiere!: boolean\n  /**\n   * true si la FractionEtendue est le carr d'une FractionEtendue\n   */\n  estParfaite!: boolean\n  /**\n   * @return true si la FractionEtendue est irrductible\n   */\n  estIrreductible!: boolean\n  /**\n   * le code LaTeX de l'criture avec parenthse si ngatif\n   */\n\n  constructor(n: number, d: number) {\n    const [num, den] = normalizeFraction(n, d)\n    if (isNaN(num) || isNaN(den))\n      throw Error(\n        `Fraction Etendue les donnes ne permettent pas de dfinir une fraction : n=${n}, d=${d}`,\n      )\n    const pgcd =\n      Math.abs(num) === 1 && Math.abs(den) === 1\n        ? 1\n        : gcd(Math.abs(num), Math.abs(den))\n    const prodNumDen = num * den\n    this.s = prodNumDen === 0 ? 0 : prodNumDen < 0 ? -1 : 1\n    const numIrred = this.s * Math.abs(num / pgcd)\n    const denIrred = Math.abs(den / pgcd)\n    this.num = num\n    this.den = den\n    this.n = Math.abs(num / pgcd)\n    this.d = Math.abs(den / pgcd)\n    /**\n     * le signe de la  FractionMathjs  : -1 pour ngatif , 0 ou 1 pour positif\n     * Au cas o quelqu'un oublie le e de this.signe\n     * @type {number}\n     */\n    /**\n     * le signe de la fraction : -1 pour ngatif , 0 ou 1 pour positif\n     * @type {number}\n     */\n    let sign: 0 | 1 | -1 // Au cas o quelqu'un le demande en anglais\n    definePropRo(this, 'sign', () => {\n      if (!sign) sign = this.s\n      return sign\n    })\n    let signe: 0 | 1 | -1\n    definePropRo(this, 'signe', () => {\n      if (!signe) signe = this.s\n      return signe\n    })\n    this.type = 'FractionEtendue'\n    this.numIrred = numIrred\n    this.denIrred = denIrred\n\n    // this.pourcentage = arrondi(num * 100 / den, 2)\n    // pour ne pas faire ces calculs  chaque instanciation de Fraction, on passe par defineProperty\n    // (qui permet de ne faire le calcul qu' la premire lecture de la proprit)\n    /**\n     * Valeur de la fraction  100\n     * @property pourcentage\n     * @type {number}\n     */\n    let pourcentage: number\n    definePropRo(this, 'pourcentage', () => {\n      if (!pourcentage)\n        pourcentage = arrondi((this.s * this.n * 100) / this.d, 2)\n      return pourcentage\n    })\n    // Le signe en string\n    let signeString: string\n    definePropRo(this, 'signeString', () => {\n      if (!signeString) signeString = this.s === -1 ? '-' : '+'\n      return signeString\n    })\n\n    /**\n     * num/den\n     * @property texFraction\n     * @type {string}\n     */\n    let texFraction: string // num/den mais sans traitement des signes des numrateur et dnominateur\n    definePropRo(this, 'texFraction', () => {\n      if (!texFraction)\n        texFraction =\n          this.s === 0\n            ? '0'\n            : den === 1\n              ? `${texNombre(num, 0)}`\n              : `\\\\dfrac{${texNombre(num, 0)}}{${texNombre(den, 0)}}`\n      return texFraction\n    })\n\n    /**\n     * num/den\n     * @property texFractionSR\n     * @type {string}\n     */\n    let texFractionSR: string // num/den mais sans traitement des signes des numrateur et dnominateur\n    definePropRo(this, 'texFractionSR', () => {\n      if (!texFractionSR)\n        texFractionSR = `\\\\dfrac{${signeMoinsEnEvidence(this.num)}}{${signeMoinsEnEvidence(this.den)}}`\n      return texFractionSR\n    })\n\n    /**\n     * num/den mais avec simplification des signes (numrateur et dnominateur positifs, signe - eventuellement devant.)\n     * @property texFSD littralement texFractionSigneDevant (si c'est un moins sinon rien... pour avoir le + devant, utiliser ecritureAlgebrique)\n     * @type {string}\n     */\n    let texFSD: string\n    definePropRo(this, 'texFSD', () => {\n      if (!texFSD) {\n        texFSD =\n          this.s === 0\n            ? '0'\n            : this.s === -1\n              ? Math.abs(den) === 1\n                ? '-' + texNombre(Math.abs(num), 0)\n                : `-\\\\dfrac{${texNombre(Math.abs(num), 0)}}{${texNombre(Math.abs(den), 0)}}`\n              : Math.abs(den) === 1\n                ? texNombre(Math.abs(num), 0)\n                : `\\\\dfrac{${texNombre(Math.abs(num), 0)}}{${texNombre(Math.abs(den), 0)}}`\n      }\n      return texFSD\n    })\n\n    /**\n     * + n/d si positif, - n/d si ngatif\n     * proprit qui n'est pas trs utile puisque ecritureAlgebrique gre les fractions maintenant (dfini pour compatibilit avec les exos qui l'utilisent)\n     * @property texFractionSignee\n     * @type {string}\n     */\n    let texFractionSignee: string\n    definePropRo(this, 'texFractionSignee', () => {\n      if (!texFractionSignee)\n        texFractionSignee = this.s === -1 ? this.texFSD : '+' + this.texFSD\n      return texFractionSignee\n    })\n\n    /**\n     * Valeur dcimale de la fraction (arrondie  la sixime dcimale)\n     * @property valeurDecimale\n     * @type {number}\n     */\n    let valeurDecimale: number\n    definePropRo(this, 'valeurDecimale', () => {\n      if (!valeurDecimale)\n        valeurDecimale = Number((this.num / this.den).toFixed(6))\n      return valeurDecimale\n    })\n\n    /**\n     * -1 => '-'\n     * 1 => ''\n     * inchang sinon\n     * permet d'crire le coefficient devant une lettre ou une parenthse\n     * @property texFractionSaufUn\n     * @type {string}\n     */\n    let texFractionSaufUn: string\n    definePropRo(this, 'texFractionSaufUn', () => {\n      if (!texFractionSaufUn)\n        texFractionSaufUn =\n          this.valeurDecimale === -1\n            ? '-'\n            : this.valeurDecimale === 1\n              ? ''\n              : this.texFSD\n      return texFractionSaufUn\n    })\n\n    /**\n     * -1 => '-'\n     * 1 => '+'\n     * texFractionSignee sinon\n     * permet d'crire le coefficient devant une lettre ou une parenthse\n     * @property texFractionSaufUnSignee\n     * @type {string}\n     */\n    let texFractionSaufUnSignee: string\n    definePropRo(this, 'texFractionSaufUnSignee', () => {\n      if (!texFractionSaufUnSignee)\n        texFractionSaufUnSignee =\n          this.valeurDecimale === -1\n            ? '-'\n            : this.valeurDecimale === 1\n              ? '+'\n              : this.texFractionSignee\n      return texFractionSaufUnSignee\n    })\n\n    /**\n     * num/den si positif, (- num/den) sinon\n     * @property texFSP littralement texFractionSigneParentheses\n     * @type {string}\n     */\n    let texFSP: string\n    definePropRo(this, 'texFSP', () => {\n      if (!texFSP)\n        texFSP =\n          this.s === 0\n            ? '0'\n            : this.s > 0\n              ? this.texFSD\n              : '\\\\left(' + this.texFSD + '\\\\right)'\n      return texFSP\n    })\n\n    /**\n     * retourne la fraction mis entre parenthses notamment pour l'exponentiation.\n     */\n    let texParentheses: string\n    definePropRo(this, 'texParentheses', () => {\n      if (!texParentheses)\n        texParentheses =\n          this.s === 0\n            ? '0'\n            : den === 1 && this.s === 1\n              ? this.texFSD\n              : '\\\\left(' + this.texFSD + '\\\\right)'\n      return texParentheses\n    })\n\n    /**\n     * le code LaTeX de la fraction simplifie\n     * @property texFractionSimplifiee\n     * @type {string}\n     */\n    let texFractionSimplifiee: string\n    definePropRo(this, 'texFractionSimplifiee', () => {\n      if (!texFractionSimplifiee) {\n        texFractionSimplifiee =\n          this.s === 0\n            ? '0'\n            : this.denIrred === 1\n              ? `${this.s === -1 ? '-' : ''}${texNombre(Math.abs(numIrred), 0)}`\n              : `${this.s === -1 ? '-' : ''}\\\\dfrac{${texNombre(Math.abs(numIrred), 0)}}{${texNombre(Math.abs(denIrred), 0)}}`\n      }\n      return texFractionSimplifiee\n    })\n\n    /**\n     * le code LaTeX de l'criture algbrique de la fraction\n     * Pour compatibilit avec les anciens exos... la fonction de outils ecritureAlgebrique() est compatible avec les fractions\n     * @property ecritureAlgebrique\n     * @type {string}\n     */\n    let ecritureAlgebrique: string\n    definePropRo(this, 'ecritureAlgebrique', () => {\n      if (!ecritureAlgebrique)\n        ecritureAlgebrique =\n          this.s === 0 ? '' : this.s === 1 ? '+' + this.texFSD : this.texFSD\n      return ecritureAlgebrique\n    })\n\n    /**\n     * le code LaTeX de l'criture avec parenthse si ngatif\n     * @property ecritureParentheseSiNegatif\n     * @type {string}\n     */\n    let ecritureParentheseSiNegatif: string\n    definePropRo(this, 'ecritureParentheseSiNegatif', () => {\n      if (!ecritureParentheseSiNegatif)\n        ecritureParentheseSiNegatif =\n          this.s === 0\n            ? '0'\n            : this.s === 1\n              ? this.texFSD\n              : '\\\\left(' + this.texFSD + '\\\\right)'\n      return ecritureParentheseSiNegatif\n    })\n\n    /**\n     * true si la fraction est un entier false sinon\n     */\n    let estEntiere: boolean\n    definePropRo(this, 'estEntiere', () => {\n      if (!estEntiere) estEntiere = this.d === 1\n      return estEntiere\n    })\n\n    /**\n     * @returns true si la FractionX est le carr d'une fractionX\n     */\n    let estParfaite: boolean\n    definePropRo(this, 'estParfaite', () => {\n      if (!estParfaite)\n        estParfaite =\n          Number.isInteger(Math.sqrt(this.n)) &&\n          Number.isInteger(Math.sqrt(this.d))\n      return estParfaite\n    })\n\n    /**\n     * @returns true si la FractionX est irrductible\n     */\n    let estIrreductible: boolean\n    definePropRo(this, 'estIrreductible', () => {\n      if (!estIrreductible)\n        estIrreductible =\n          gcd(Math.abs(this.num), Math.abs(this.den)) === 1 && this.den !== 1\n      return estIrreductible\n    })\n  }\n\n  /**\n   * bas sur la mthode toLatex() de mathjs, on remplace \\frac par \\dfrac plus joli.\n   * @return {string} la chaine Latex pour crire la  FractionMathjs  (signe devant)\n   */\n  toLatex(): string {\n    const text = this.texFSD\n    return text.replace('\\\\frac', '\\\\dfrac')\n  }\n\n  /**\n   * retourne un flottant pour compatibilit de FractionEtendue() avec Number().\n   * @return {number}\n   */\n  toNumber(): number {\n    return this.num / this.den\n  }\n\n  /**\n   *\n   */\n  toString() {\n    // Cette fonction n'a pas vocation  tre utilise ! si on veut du latex, il faut utiliser texFraction.\n    // Cette mthode vient se substituer  la mthode toString() de Object.prototype qui renvoie '[object object]' elle est utilise si la FractionEtendue a t utilise par erreur  la place de sa proprit texFraction\n    window.notify(\n      'Pour obtenir du Latex avec une FractionEtendue, il faut utiliser sa proprit texFraction !',\n      { numerateur: this.num, denominateur: this.den },\n    )\n    return this.texFraction\n  }\n\n  /**\n   * Pour la conversion automatique en number\n   * @returns {number}\n   */\n  valueOf(): number {\n    return this.toNumber()\n  }\n\n  /**\n   *\n   * @param {FractionEtendue[]} fractions\n   * @return {FractionEtendue}\n   */\n  sommeFractions(...fractions: FractionEtendue[]) {\n    // retourne un rsultat simplifi\n    let s = new FractionEtendue(this.num, this.den)\n    if (s != null) {\n      for (const f of fractions) {\n        s = s.sommeFraction(f)\n      }\n    }\n    if (s == null) {\n      window.notify(\n        'il se passe quelque chose de travers dans sommeFractions() avec les fractions passes',\n        { fractions },\n      )\n      return this\n    }\n    return s.simplifie()\n  }\n\n  /**\n   * @return {FractionEtendue} la FractionEtendue irreductible\n   */\n  simplifie() {\n    return new FractionEtendue(\n      (abs(this.num) * this.signe) / gcd(abs(this.num), abs(this.den)),\n      abs(this.den) / gcd(abs(this.num), abs(this.den)),\n    )\n  }\n\n  /**\n   * Convertit la FractionEtendue en Fraction\n   * @return {FractionEtendue} un objet  FractionMathjs  (mathjs)\n   */\n  valeurAbsolue(): FractionEtendue {\n    return new FractionEtendue(abs(this.num), abs(this.den))\n  }\n\n  /**\n   * @return {FractionEtendue} oppos de la FractionEtendue\n   */\n  oppose() {\n    return new FractionEtendue(-1 * this.num, this.den)\n  }\n\n  /**\n   * On pourra utiliser k = 0.5 pour simplifier par 2 la  FractionMathjs  par exemple.\n   * @param {number} k\n   * @return {FractionEtendue} La FractionEtendue dont le numrateur et le dnominateur ont t multiplis par k.\n   */\n  reduire(k: number) {\n    const num = multiply(this.num, k)\n    const den = multiply(this.den, k)\n    return new FractionEtendue(num, den)\n  }\n\n  /**\n   * @param {FractionEtendue  | number} f2\n   * @return true si la FractionEtendue est gale  la  FractionMathjs  passe en argument.\n   */\n  isEqual(f2: FractionEtendue | number) {\n    if (f2 instanceof FractionEtendue) {\n      return f2.differenceFraction(this).simplifie().num === 0\n    } else {\n      const f2bis = new FractionEtendue(f2, 1)\n      return f2bis.differenceFraction(this).simplifie().num === 0\n    }\n  }\n\n  /**\n   * @param {FractionEtendue  | number} f\n   * @return {FractionEtendue} la FractionEtendue - f rsultat non simplifi\n   */\n  differenceFraction(f: FractionEtendue | number) {\n    if (!(f instanceof FractionEtendue)) {\n      f = new FractionEtendue(f, 1)\n    }\n    return this.sommeFraction(f.oppose())\n  }\n\n  /**\n   * @param {number} n\n   * @return {FractionEtendue}La FractionEtendue multiplie par n (numrateur n fois plus grand)\n   */\n  multiplieEntier(n: number) {\n    if (Number.isInteger(n)) return new FractionEtendue(this.num * n, this.den)\n    else {\n      window.notify(\n        `multiplieEntier() : l'argument n'est pas entier : n=${n}... j'arrondis !`,\n        { n: Math.round(n) },\n      )\n      return new FractionEtendue(this.num * Math.round(n), this.den)\n    }\n  }\n\n  /**\n   * @param {number} n\n   * @return {FractionEtendue} La FractionEtendue divise par n (denominateur n fois plus grand)\n   */\n  entierDivise(n: number): FractionEtendue {\n    if (Number.isInteger(n)) return new FractionEtendue(this.num, n * this.den)\n    else {\n      window.notify(\n        `entierDivise() : l'argument n'est pas entier : n=${n}... j'arrondis !`,\n        { n: Math.round(n) },\n      )\n      return new FractionEtendue(this.num, this.den * Math.round(n))\n    }\n  }\n\n  /**\n   *\n   * @param {number} n\n   * @return {FractionEtendue} n + la FractionEtendue\n   */\n  ajouteEntier(n: number) {\n    if (Number.isInteger(n))\n      return new FractionEtendue(this.num + n * this.den, this.den)\n    else {\n      window.notify(\n        `ajouteEntier() : l'argument n'est pas entier : n=${n}... j'arrondis !`,\n        { n: Math.round(n) },\n      )\n      return new FractionEtendue(this.num + Math.round(n) * this.den, this.den)\n    }\n  }\n\n  /**\n   * @param {number} n\n   * @return {FractionEtendue} n - la FractionEtendue\n   */\n  entierMoinsFraction(n: number): FractionEtendue {\n    if (Number.isInteger(n))\n      return new FractionEtendue(n * this.den - this.num, this.den)\n    else {\n      window.notify(\n        `entierMoinsFraction() : l'argument n'est pas entier : n=${n}... j'arrondis !`,\n        { n: Math.round(n) },\n      )\n      return new FractionEtendue(Math.round(n) * this.den - this.num, this.den)\n    }\n  }\n\n  /**\n   *\n   * @param {FractionEtendue   | nombre} f2\n   * @return {boolean} true si FractionEtendue >= f\n   */\n  superieurLarge(f2: FractionEtendue | number) {\n    if (!(f2 instanceof FractionEtendue)) {\n      f2 = new FractionEtendue(f2, 1)\n    }\n    return this.num * f2.den >= f2.num * this.den\n  }\n\n  /**\n   * fonctions de comparaison avec une autre fraction.\n   * @param {FractionEtendue   | nombre} f2\n   * @return {boolean} true si\n   */\n  superieurstrict(f2: FractionEtendue | number): boolean {\n    if (!(f2 instanceof FractionEtendue)) {\n      f2 = new FractionEtendue(f2, 1)\n    }\n    return this.num * f2.den > f2.num * this.den\n  }\n\n  /**\n   * Retourne true si la  FractionMathjs  courante est strictement infrieure  f2\n   * @param {FractionEtendue   | nombre} f2\n   * @return {boolean}\n   */\n  inferieurstrict(f2: FractionEtendue | number): boolean {\n    if (!(f2 instanceof FractionEtendue)) {\n      f2 = new FractionEtendue(f2, 1)\n    }\n    return this.differenceFraction(f2).valeurDecimale < 0\n  }\n\n  /**\n   * Retourne true si la  FractionMathjs  courante est infrieure ou gale  f2\n   * @param {FractionEtendue   | nombre} f2\n   * @return {boolean}\n   */\n  inferieurlarge(f2: FractionEtendue | number) {\n    if (!(f2 instanceof FractionEtendue)) {\n      f2 = new FractionEtendue(f2, 1)\n    }\n    return this.num * f2.den <= f2.num * this.den\n  }\n\n  /**\n   *\n   * @param {FractionEtendue} f2\n   * @return {boolean} true si f2 = f et  f2 est plus rduite que f\n   */\n  estUneSimplification(f2: FractionEtendue): boolean {\n    if (f2.num == null || f2.den == null)\n      throw Error(\n        `estUneSimplification(f2) : f2 n'est pas une FractionEtendue ! f2=${JSON.stringify(f2)}`,\n      )\n    return this.isEqual(f2) && abs(this.num) < abs(f2.num)\n  }\n\n  /**\n   *\n   * @param {FractionEtendue   | nombre} f2\n   * @return {FractionEtendue} f + FractionEtendue\n   */\n  sommeFraction(f2: FractionEtendue) {\n    if (f2 instanceof FractionEtendue) {\n      if (this.den === f2.den) {\n        // on ajoute 2 fractions de mme dnominateur\n        return new FractionEtendue(this.num + f2.num, f2.den)\n      } else if ([this.den, f2.den].indexOf(lcm(this.den, f2.den)) !== -1) {\n        // un dnominateur est multiple de l'autre\n        if (this.den === lcm(this.den, f2.den)) {\n          // c'est this qui a le dnominateur commun.\n          return new FractionEtendue(\n            this.num + f2.num * round(this.den / f2.den),\n            this.den,\n          ) // on transforme f2\n        } else {\n          // c'est f2 qui a le dnominateur commun\n          return new FractionEtendue(\n            f2.num + this.num * round(f2.den / this.den),\n            f2.den,\n          ) // on transforme this\n        }\n      } else {\n        // besoin d'tablir le dnominateur commun.\n        return new FractionEtendue(\n          this.num * round(lcm(this.den, f2.den) / this.den) +\n            f2.num * round(lcm(this.den, f2.den) / f2.den),\n          lcm(this.den, f2.den),\n        )\n      }\n    } else {\n      window.notify(\n        `FractionEtendue.sommeFraction(fractionAAjouter) a t appele avec autre chose qu'une  FractionMathjs  tendue, alors que c'est obligatoire !\\nVoilci l'argument pass : ${f2}... je retourne la fraction de dpart`,\n        { argument: f2 },\n      )\n      return this\n    }\n  }\n\n  /**\n   * Effectue la somme de this et de f2 et retourne la string latex du calcul avec simplification si simplify est true (true par dfaut)\n   * @param {FractionEtendue} f2Arg\n   * @param {boolean} simplify\n   * @returns {string}\n   */\n  texSommeFraction(f2Arg: FractionEtendue, simplify = true): string {\n    if (f2Arg instanceof FractionEtendue) {\n      // on cre une fraction indpendante pour ne pas modifier f2 (c'est un objet et si on le bricole, il sera modifi pour le code appelant.\n      const f2 = new FractionEtendue(f2Arg.num, f2Arg.den)\n      if (f2.den < 0) {\n        // il arrive qu'un dnominateur soit ngatif, alors on change le signe du numrateur et du dnominateur\n        f2.den = -f2.den\n        f2.num = -f2.num\n      }\n      // on fait de mme avec this\n      const f1 = new FractionEtendue(this.num, this.den)\n      if (this.den < 0) {\n        f1.den = -f1.den\n        f1.num = -f1.num\n      }\n      let calcul = `${f1.texFraction}+${f2.texFraction}=`\n      const commonDenominator = ppcm(f1.den, f2.den)\n      const coeffMultiplicatorA = commonDenominator / f1.den\n      const coeffMultiplicatorB = commonDenominator / f2.den\n      if (coeffMultiplicatorA !== 1 || coeffMultiplicatorB !== 1) {\n        if (coeffMultiplicatorA !== 1) {\n          // on modifie la fraction1\n          calcul += `\\\\dfrac{${f1.num}\\\\times ${coeffMultiplicatorA}}{${f1.den}\\\\times ${coeffMultiplicatorA}}+`\n          calcul +=\n            coeffMultiplicatorB === 1\n              ? `${f2.texFraction}=`\n              : `\\\\dfrac{${String(f2.num)}\\\\times ${String(coeffMultiplicatorB)}}{${String(f2.den)}\\\\times ${String(coeffMultiplicatorB)}}=`\n        } else {\n          // si c'est pas la 1 c'est forcment la 2\n          calcul += `${f1.texFraction}+\\\\dfrac{${String(f2.num)}\\\\times ${String(coeffMultiplicatorB)}}{${String(f2.den)}\\\\times ${String(coeffMultiplicatorB)}}=`\n        }\n        // on a crit les multiplication des numrateur et des dnominateurs par les coeff respectifs\n        // on crit le rsultat\n        if (coeffMultiplicatorA !== 1) {\n          // on modifie la fraction1\n          calcul += `\\\\dfrac{${String(f1.num * coeffMultiplicatorA)}}{${String(f1.den * coeffMultiplicatorA)}}+`\n          calcul +=\n            coeffMultiplicatorB === 1\n              ? `${f2.texFraction}=`\n              : `\\\\dfrac{${String(f2.num * coeffMultiplicatorB)}}{${String(f2.den * coeffMultiplicatorB)}}=`\n        } else {\n          // sinon, il y a forcment modification de la fraction2\n          calcul += `${f1.texFraction}+\\\\dfrac{${String(f2.num * coeffMultiplicatorB)}}{${String(f2.den * coeffMultiplicatorB)}}=`\n        }\n      }\n      // les fractions ont le mme dnominateur, on les ajoute\n      calcul += `\\\\dfrac{${String(f1.num * coeffMultiplicatorA)}${ecritureAlgebrique(f2.num * coeffMultiplicatorB)}}{${String(commonDenominator)}}=`\n      calcul += `\\\\dfrac{${String(f1.num * coeffMultiplicatorA + f2.num * coeffMultiplicatorB)}}{${String(commonDenominator)}}`\n      if (!simplify) return calcul\n      const fResult = new FractionEtendue(\n        f1.num * coeffMultiplicatorA + f2.num * coeffMultiplicatorB,\n        commonDenominator,\n      )\n      if (fResult.estIrreductible) return calcul\n      calcul += `=${fResult.texFractionSimplifiee}`\n      return calcul\n    } else {\n      window.notify(\n        \"texSommeFraction : pour l'instant on n'ajoute que une fractionEtendue et rien d'autre\",\n        { fraction: JSON.stringify(f2Arg) },\n      )\n      return ''\n    }\n  }\n\n  /**\n   * @param {FractionEtendue   | nombre} f2\n   * @return {FractionEtendue} f * FractionEtendue  // retourne un non rsultat simplifi\n   */\n  produitFraction(f2: FractionEtendue | number) {\n    if (!(f2 instanceof FractionEtendue)) {\n      f2 = new FractionEtendue(f2, 1)\n    }\n    if (this.signe * f2.signe === 1) {\n      return new FractionEtendue(\n        Math.abs(this.num * f2.num),\n        Math.abs(this.den * f2.den),\n      )\n    } else {\n      return new FractionEtendue(\n        -Math.abs(this.num * f2.num),\n        Math.abs(this.den * f2.den),\n      )\n    }\n  }\n\n  /**\n   * @param  {Array<FractionEtendue>} fractions\n   * @return {FractionEtendue} produit de FractionEtendue par toutes les fractions passes en argument.\n   */\n  produitFractions(...fractions: FractionEtendue[]) {\n    // retourne un rsultat simplifi\n    let s = new FractionEtendue(this.num, this.den)\n    for (const f of fractions) {\n      s = s.produitFraction(f)\n    }\n    return s.simplifie()\n  }\n\n  /**\n   * @param {FractionEtendue} f2 la  FractionMathjs  qui multiplie.\n   *  @param {'none'|true|false} simplification true si on veut afficher la simplification par dcomposition false si on veut celle par le pgcd et 'none' si on ne veut pas simplifier\n   * @return {string} Le calcul du produit de deux fractions avec tape intermdiaire\n   */\n  texProduitFraction(\n    f2: FractionEtendue,\n    simplification: boolean | 'none' = 'none',\n  ): string {\n    if (this.estEntiere) {\n      return `${this.texFraction}\\\\times ${f2.texFraction}=\\\\dfrac{${`${this.simplifie().num}\\\\times ${ecritureParentheseSiNegatif(f2.num)}`}}{${ecritureParentheseSiNegatif(f2.den)}}${\n        simplification === 'none' || this.produitFraction(f2).estIrreductible\n          ? '=\\\\dfrac{' + this.num * f2.num + '}{' + this.den * f2.den + '}'\n          : this.produitFraction(f2).texSimplificationAvecEtapes(simplification)\n      }`\n    } else {\n      return `${this.texFraction}\\\\times ${f2.texFraction}=\\\\dfrac{${this.num}\\\\times ${ecritureParentheseSiNegatif(f2.num)}}{${this.den} \\\\times' ${ecritureParentheseSiNegatif(f2.den)}}${\n        simplification === 'none' || this.produitFraction(f2).estIrreductible\n          ? '=\\\\dfrac{' + this.num * f2.num + '}{' + this.den * f2.den + '}'\n          : `${\n              this.den !== f2.num && f2.den !== this.num\n                ? '=\\\\dfrac{' +\n                  (decompositionFacteursPremiers(this.num) || '1') +\n                  '\\\\times ' +\n                  (decompositionFacteursPremiers(f2.num) || '1') +\n                  '}{' +\n                  (decompositionFacteursPremiers(this.den) || '1') +\n                  '\\\\times ' +\n                  (decompositionFacteursPremiers(f2.den) || '1') +\n                  '}' +\n                  this.produitFraction(f2).texSimplificationAvecEtapes(\n                    simplification,\n                  )\n                : `${\n                    this.den === f2.num\n                      ? '=\\\\dfrac{' +\n                        this.num +\n                        '}{' +\n                        f2.den +\n                        '}' +\n                        new FractionEtendue(\n                          this.num,\n                          f2.den,\n                        ).texSimplificationAvecEtapes(simplification)\n                      : '=\\\\dfrac{' +\n                        f2.num +\n                        '}{' +\n                        this.den +\n                        '}' +\n                        new FractionEtendue(\n                          f2.num,\n                          this.den,\n                        ).texSimplificationAvecEtapes(simplification)\n                  }`\n            }`\n      }`\n    }\n  }\n\n  /**\n   * @param {FractionEtendue} f2 la  FractionMathjs  qui multiplie.\n   * @param {string} simplification true si on veut afficher la simplification par dcomposition false si on veut celle par le pgcd et 'none' si on ne veut pas simplifier\n   *  @param {string} symbole '/' pour la forme fractionnaire de la division, ':' ou autre chose pour l'oble\n   * @return {string} Le calcul du produit de deux fractions avec tape intermdiaire\n   */\n  texDiviseFraction(\n    f2: FractionEtendue,\n    simplification: boolean | 'none' = 'none',\n    symbole = '/',\n  ) {\n    const space = '\\\\phantom{\\\\dfrac{(_(^(}{(_(^(}}' // Utilis pour mettre de l'espace dans une  FractionMathjs  de fraction\n    const space2 = '\\\\phantom{(_(^(}' // Utilis pour mettre de l'espace dans une  FractionMathjs  de  FractionMathjs  lorsque le numrateur ou le dnominateur est entier\n    if (this.estEntiere) {\n      if (f2.inverse().estEntiere && f2.num === 1) {\n        if (symbole === '/') {\n          return `\\\\dfrac{${space2 + this.texFraction + space2}}{${(f2.estEntiere ? space2 : space) + f2.texFraction + (f2.estEntiere ? space2 : space)}}=${this.simplifie().texFSD}\\\\times ${f2.inverse().simplifie().texFSP}=${this.simplifie().num * f2.inverse().simplifie().num}`\n          // pas de simplification : on multiplie deux entiers !\n        } else {\n          return `${this.simplifie().texFraction}\\\\div${f2.texFraction}=${this.simplifie().texFSD}\\\\times ${f2.inverse().simplifie().texFSP}=${this.simplifie().num * f2.inverse().simplifie().num}`\n          // pas de simplification : on multiplie deux entiers !\n        }\n      } else {\n        if (symbole === '/') {\n          return `\\\\dfrac{${space2 + this.texFraction + space2}}{${(f2.estEntiere ? space2 : space) + f2.texFraction + (f2.estEntiere ? space2 : space)}}=${this.texFractionSimplifiee}\\\\times ${f2.inverse().texFraction}=\\\\dfrac{${this.texFractionSimplifiee} \\\\times ${ecritureParentheseSiNegatif(f2.den)}}{${ecritureParentheseSiNegatif(f2.num)}}${\n            simplification === 'none' || this.diviseFraction(f2).estIrreductible\n              ? `=\\\\dfrac{${this.simplifie().num * f2.den}}{${f2.num}}`\n              : `=\\\\dfrac{${decompositionFacteursPremiers(this.num)}\\\\times ${decompositionFacteursPremiers(f2.den)}}{${decompositionFacteursPremiers(this.den)}\\\\times ${decompositionFacteursPremiers(f2.num)}}${this.diviseFraction(\n                  f2,\n                ).texSimplificationAvecEtapes(simplification)}`\n          }`\n        } else {\n          return `${this.texFraction}\\\\div${f2.texFraction}=${this.texFractionSimplifiee}\\\\times ${f2.inverse().texFraction}=\\\\dfrac{${this.texFractionSimplifiee + '\\\\times ' + ecritureParentheseSiNegatif(f2.den)}}{${ecritureParentheseSiNegatif(f2.num)}}${\n            simplification === 'none' || this.diviseFraction(f2).estIrreductible\n              ? `=\\\\dfrac{${this.simplifie().num * f2.den}}{${f2.num}}`\n              : `=\\\\dfrac{${decompositionFacteursPremiers(this.num)} \\\\times ${decompositionFacteursPremiers(f2.den)}}{${decompositionFacteursPremiers(this.den)} \\\\times ${decompositionFacteursPremiers(f2.num)}}${this.diviseFraction(f2).texSimplificationAvecEtapes(simplification)}`\n          }`\n        }\n      }\n    } else {\n      if (f2.inverse().estEntiere && f2.num === 1) {\n        if (symbole === '/') {\n          return `\\\\dfrac{${space + this.texFraction + space}}{${(f2.estEntiere ? space2 : space) + f2.texFraction + (f2.estEntiere ? space2 : space)}}=${this.texFraction}\\\\times ${f2.inverse().simplifie().texFSP}=\\\\dfrac{${this.num + '\\\\times ' + f2.inverse().simplifie().texFSP}}{${this.den}}\n      ${\n        simplification === 'none' || this.diviseFraction(f2).estIrreductible\n          ? '=\\\\dfrac{' + this.num * f2.den + '}{' + this.den * f2.num + '}'\n          : '=\\\\dfrac{' +\n            decompositionFacteursPremiers(this.num) +\n            '\\\\times ' +\n            decompositionFacteursPremiers(f2.den) +\n            '}{' +\n            decompositionFacteursPremiers(this.den) +\n            '}' +\n            this.diviseFraction(f2).texSimplificationAvecEtapes(simplification)\n      }`\n        } else {\n          return `${this.texFraction}\\\\div${f2.texFraction}=${this.texFraction}\\\\times ${f2.inverse().texFractionSimplifiee}=\\\\dfrac{${this.num + '\\\\times ' + f2.inverse().texFractionSimplifiee}}{${this.den}}${\n            simplification === 'none' || this.diviseFraction(f2).estIrreductible\n              ? `=\\\\dfrac{${this.num * f2.den}}{${this.den * f2.num}}`\n              : `=\\\\dfrac{${decompositionFacteursPremiers(this.num)}\\\\times ${decompositionFacteursPremiers(f2.den)}}{${decompositionFacteursPremiers(this.den)}}${this.diviseFraction(f2).texSimplificationAvecEtapes(simplification)}`\n          }`\n        }\n      } else {\n        if (symbole === '/') {\n          return `\\\\dfrac{${space + this.texFraction + space}}{${(f2.estEntiere ? space2 : space) + f2.texFraction + (f2.estEntiere ? space2 : space)}}=${this.texFraction}\\\\times ${f2.inverse().texFraction}=\\\\dfrac{${this.num + '\\\\times ' + ecritureParentheseSiNegatif(f2.den)}}{${this.den + '\\\\times ' + ecritureParentheseSiNegatif(f2.num)}}${\n            simplification === 'none' || this.diviseFraction(f2).estIrreductible\n              ? `=\\\\dfrac{${this.num * f2.den}}{${this.den * f2.num}}`\n              : `=\\\\dfrac{${decompositionFacteursPremiers(this.num)}\\\\times ${decompositionFacteursPremiers(f2.den)}}{${decompositionFacteursPremiers(this.den)}\\\\times ${decompositionFacteursPremiers(f2.num)}}${this.diviseFraction(f2).texSimplificationAvecEtapes(simplification)}`\n          }`\n        } else {\n          return `${this.texFraction}\\\\div${f2.texFraction}=${this.texFraction}\\\\times ${f2.inverse().texFraction}=\\\\dfrac{${this.num + '\\\\times ' + f2.den}}{${this.den + '\\\\times ' + f2.num}}${\n            simplification === 'none' || this.diviseFraction(f2).estIrreductible\n              ? `=\\\\dfrac{${this.num * f2.den}}{${this.den * f2.num}}`\n              : `=\\\\dfrac{${decompositionFacteursPremiers(this.num)}\\\\times ${decompositionFacteursPremiers(f2.den)}}{${decompositionFacteursPremiers(this.den)}\\\\times ${decompositionFacteursPremiers(f2.num)}}${this.diviseFraction(f2).texSimplificationAvecEtapes(simplification)}`\n          }`\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {number} n l'exposant de la fraction\n   * @return {FractionEtendue} La puissance n de la fraction\n   */\n  puissanceFraction(n: number): FractionEtendue {\n    if (Number.isInteger(n))\n      return new FractionEtendue(this.num ** n, this.den ** n)\n    else {\n      window.notify(\n        \"puissanceFraction() l'argument n'est pas un entier j'arrondis !\",\n        { argument: n },\n      )\n      return new FractionEtendue(\n        this.num ** Math.round(n),\n        this.den ** Math.round(n),\n      )\n    }\n  }\n\n  /**\n   * @return {FractionEtendue} inverse de la fraction\n   */\n  inverse(): FractionEtendue {\n    if (this.num === 0)\n      throw Error(`Division par 0 dans inverse() : ${JSON.stringify(this)}`)\n    return new FractionEtendue(this.den, this.num)\n  }\n\n  /**\n   *\n   * @param {FractionEtendue} f2\n   * @return {FractionEtendue} f/f2\n   */\n  diviseFraction(f2: FractionEtendue | number): FractionEtendue {\n    if (!(f2 instanceof FractionEtendue)) {\n      window.notify(\n        \"FractionEtendue.diviseFraction() : l'argument n'est pas une fraction\",\n        { f2 },\n      )\n      if (typeof f2 === 'number') return this.multiplieEntier(1 / f2)\n      else {\n        window.notify(\n          \"FractionEtendue.diviseFraction() : l'argument n'est pas un nombre, je retourne la fraction de dpart.\",\n          { f2 },\n        )\n        return this\n      }\n    } else return this.produitFraction(f2.inverse())\n  }\n\n  /**\n   * @param {number} n entier divis par la fraction\n   * @return {FractionEtendue} n divis par fraction\n   */\n  diviseEntier(n: number): FractionEtendue {\n    if (Number.isInteger(n))\n      return new FractionEtendue(n * this.den, this.num).simplifie()\n    else {\n      window.notify(\n        \"diviseEntier() : l'argument n'est pas un entier, j'arrondis\",\n        { n },\n      )\n      return new FractionEtendue(Math.round(n) * this.den, this.num).simplifie()\n    }\n  }\n\n  /**\n   *\n   * @param {FractionEtendue} f2\n   * @return {string} Calcul f/f2 avec les tapes mais sans simplification\n   */\n  texQuotientFraction(f2: FractionEtendue): string {\n    if (!(f2 instanceof FractionEtendue)) {\n      window.notify(\n        \"texQuotientFraction() : l'argument n'est pas une fraction\",\n        { f2 },\n      )\n      if (typeof f2 === 'number') f2 = new FractionEtendue(f2, 1)\n      else {\n        window.notify(\n          \"texQuotientFraction() : l'argument n'est pas un nombre, je retourne la fraction de dpart.\",\n          { f2 },\n        )\n        return this.texFraction\n      }\n    }\n    return `${this.texFraction}\\\\div ${f2.texFraction}=${this.texFraction}\\\\times ${f2.inverse().texFraction}=\\\\dfrac{${this.num + '\\\\times' + f2.den}}{${this.den + '\\\\times' + f2.num}}=\\\\dfrac{${this.num * f2.den}}{${this.den * f2.num}}`\n  }\n\n  /**\n   * Si la  FractionMathjs  est rductible, retourne une suite d'galits permettant d'obtenir la  FractionMathjs  irrductible\n   * @param {true|false|'none'} factorisation\n   * @param {string} couleurFinale\n   * @return {string}\n   */\n  texSimplificationAvecEtapes(\n    factorisation: boolean | 'none' = false,\n    couleurFinale: string = '',\n  ): string {\n    if (this.isEqual(0)) return ''\n    if (this.estIrreductible && this.num > 0 && this.den > 0)\n      return '' // irreductible et positifs\n    else if (this.estIrreductible && this.num * this.den < 0) {\n      // irrductible mais ngatifs\n      return couleurFinale === ''\n        ? `=${this.texFSD}`\n        : `=${miseEnEvidence(this.texFSD, couleurFinale)}`\n    } else {\n      if (factorisation) {\n        const signe = this.sign === -1 ? '-' : ''\n        const num = Math.abs(this.num)\n        const den = Math.abs(this.den)\n        const listenum = obtenirListeFacteursPremiers(num)\n        const listeden = obtenirListeFacteursPremiers(den)\n        let result = '='\n        const listeNumvf = []\n        const listeDenvf = []\n        listenum.forEach(function aAjouterDansListeAvf(element) {\n          listeNumvf.push([element, true])\n        })\n        listeden.forEach(function aAjouterDansListeBvf(element) {\n          listeDenvf.push([element, true])\n        })\n\n        for (let index = 0; index < listeden.length; ) {\n          for (let j = 0; j <= listenum.length; ) {\n            if (listeden[index] === listenum[j]) {\n              listeDenvf[index] = [listeden[index], false]\n              listeNumvf[j] = [listenum[j], false]\n              listenum[j] = 1\n              listeden[index] = 1\n              break\n            }\n            j++\n          }\n          index++\n        }\n\n        let a = 1\n        let b = 1\n        for (const k of listenum) {\n          a = a * k\n        }\n        for (const k of listeden) {\n          b = b * k\n        }\n\n        let numerateur = ''\n        let denominateur = ''\n\n        for (const j in listeNumvf) {\n          if (listeNumvf[j][1] === true) {\n            numerateur += listeNumvf[j][0] + '\\\\times'\n          } else {\n            numerateur += '\\\\cancel{' + listeNumvf[j][0] + '}\\\\times'\n          }\n        }\n        numerateur = numerateur.substring(0, numerateur.length - 6)\n\n        for (const j in listeDenvf) {\n          if (listeDenvf[j][1] === true) {\n            denominateur += listeDenvf[j][0] + '\\\\times'\n          } else {\n            denominateur += '\\\\cancel{' + listeDenvf[j][0] + '}\\\\times'\n          }\n        }\n        denominateur = denominateur.substring(0, denominateur.length - 6)\n\n        result += `${signe}\\\\dfrac{${numerateur}}{${denominateur}}`\n        result +=\n          couleurFinale !== ''\n            ? `=${miseEnEvidence(`${signe}${new FractionEtendue(a, b).simplifie().texFraction}`, couleurFinale)}`\n            : `=${signe}${new FractionEtendue(a, b).simplifie().texFraction}`\n        return result\n      } else {\n        const signe = this.sign === -1 ? '-' : ''\n        const num = Math.abs(this.num)\n        const den = Math.abs(this.den)\n        const pgcd = gcd(num, den)\n        if (pgcd !== 1) {\n          const redaction = `=${signe}\\\\dfrac{${num / pgcd}${miseEnEvidence('\\\\times' + ecritureParentheseSiNegatif(pgcd), '#2563a5')} }{${den / pgcd}${miseEnEvidence('\\\\times' + ecritureParentheseSiNegatif(pgcd), '#2563a5')}}=`\n          let redactionFinale\n          if (Math.abs(den / pgcd) !== 1)\n            redactionFinale = `${signe}\\\\dfrac{${Math.abs(num / pgcd)}}{${Math.abs(den / pgcd)}}`\n          else redactionFinale = `${signe}${Math.abs(num / pgcd)}`\n          if (couleurFinale !== '')\n            redactionFinale = miseEnEvidence(redactionFinale, couleurFinale)\n          return redaction + redactionFinale\n        } else {\n          let redactionFinale\n          if (!egal(Math.abs(den / pgcd), 1))\n            redactionFinale = `=${signe}\\\\dfrac{${Math.abs(num / pgcd)}}{${Math.abs(den / pgcd)}}`\n          else redactionFinale = `=${signe}${Math.abs(num / pgcd)}`\n          if (couleurFinale !== '')\n            redactionFinale = miseEnEvidence(redactionFinale, couleurFinale)\n          return redactionFinale\n        }\n      }\n    }\n  }\n\n  /**\n   * @return {FractionEtendue|number} NaN si la FractionEtendue n'est pas un nombre dcimal sinon retourne une FractionEtendue avec la bonne puissance de 10 au dnominateur\n   */\n  fractionDecimale(): FractionEtendue {\n    const den = Math.abs(this.simplifie().den)\n    const num = Math.abs(this.simplifie().num)\n    const signe = this.simplifie().signe\n    const liste = obtenirListeFacteursPremiers(den)\n    let n2 = 0\n    let n5 = 0\n    for (const n of liste) {\n      if (n === 2) {\n        n2++\n      } else if (n === 5) {\n        n5++\n      } else {\n        window.notify(\n          'FractionEtendue.valeurDecimale :  FractionMathjs  non dcimale',\n          { fraction: this },\n        )\n        return this\n      }\n    }\n    if (n5 === n2) {\n      return new FractionEtendue(num * signe, den)\n    } else if (n5 > n2) {\n      return new FractionEtendue(\n        signe * num * 2 ** (n5 - n2),\n        den * 2 ** (n5 - n2),\n      )\n    } else {\n      return new FractionEtendue(\n        signe * num * 5 ** (n2 - n5),\n        den * 5 ** (n2 - n5),\n      )\n    }\n  }\n\n  /**\n   * Retourne la chaine latex contenant la racine carre de la fraction\n   * @param {boolean} detaillee Si detaillee est true, une tape de calcul se place avant le rsultat.\n   * @return {string}\n   */\n  texRacineCarree(detaillee: boolean = false): string {\n    if (this.num === 0) {\n      return '0'\n    } else {\n      if (this.estParfaite) {\n        const rac = this.racineCarree()\n        if (rac) return rac.texFraction\n        else return `\\\\sqrt{${this.texFraction}}`\n      }\n      if (this.signe === -1) return 'Not a real number !'\n      let factoDen: [number, number] = extraireRacineCarree(Math.abs(this.den))\n      let factoNum\n      let etape\n      if (!this.estEntiere) {\n        etape = detaillee ? `\\\\sqrt{\\\\dfrac{${this.num}}{${this.den}}}=` : ''\n      } else {\n        factoNum = extraireRacineCarree(Math.abs(this.num))\n        if (factoNum[0] !== 1) {\n          etape = detaillee ? `\\\\sqrt{${Math.abs(this.num)}}=` : ''\n        } else {\n          etape = ''\n        }\n      }\n      if (factoDen[1] !== 1) {\n        if (!this.estEntiere) {\n          etape += detaillee\n            ? `\\\\sqrt{\\\\dfrac{${Math.abs(this.num)}\\\\times ${factoDen[1]}}{${Math.abs(this.den)}\\\\times ${factoDen[1]}}}=`\n            : ''\n          etape += detaillee\n            ? `\\\\sqrt{\\\\dfrac{${Math.abs(this.num * factoDen[1])}}{${Math.abs(this.den * factoDen[1])}}}=`\n            : ''\n        }\n        factoNum = extraireRacineCarree(Math.abs(this.num * factoDen[1]))\n        factoDen = extraireRacineCarree(Math.abs(this.den * factoDen[1]))\n      } else {\n        factoNum = extraireRacineCarree(Math.abs(this.num))\n      }\n      const k = new FractionEtendue(factoNum[0], factoDen[0]).simplifie()\n      const r = new FractionEtendue(factoNum[1], factoDen[1]).simplifie()\n\n      if (detaillee) {\n        if (k.valeurDecimale !== 1) {\n          if (k.denIrred === 1) {\n            etape += detaillee\n              ? `\\\\sqrt{${factoNum[0]}^2\\\\times${factoNum[1]}}=`\n              : ''\n            etape += detaillee\n              ? `${factoNum[0]}${factoNum[1] !== 1 ? '\\\\sqrt{' + factoNum[1] + '}' : '}'}`\n              : ''\n          } else {\n            if (factoNum[0] !== 1) {\n              etape += detaillee\n                ? `\\\\sqrt{\\\\dfrac{${factoNum[0]}^2${factoNum[1] !== 1 ? '\\\\times ' + factoNum[1] : ''}}{${factoDen[0]}^2${factoDen[1] !== 1 ? '\\\\times' + factoDen[1] : ''}}}=`\n                : ''\n              etape += detaillee\n                ? `\\\\dfrac{${factoNum[0]}${factoNum[1] !== 1 ? '\\\\times\\\\sqrt{' + factoNum[1] + '}' : ''}}{${factoDen[0]}${factoDen[1] !== 1 ? '\\\\times\\\\sqrt{' + factoDen[1] + '}' : ''}}=`\n                : ''\n            } else {\n              if (factoDen[1] !== 1) {\n                etape += detaillee\n                  ? `\\\\sqrt{\\\\dfrac{${factoNum[1]}}{${factoDen[0]}^2\\\\times ${factoDen[1]}}}=`\n                  : ''\n              } else {\n                etape += detaillee\n                  ? `\\\\sqrt{\\\\dfrac{${factoNum[1]}}{${factoDen[0]}^2}}=`\n                  : ''\n              }\n            }\n          }\n        }\n      }\n\n      if (arrondi(factoNum[1] / factoDen[1], 6) === 1) {\n        return etape + k.texFraction\n      } else {\n        if (k.numIrred === 1 && k.denIrred !== 1) {\n          if (r.denIrred === 1) {\n            return k.valeurDecimale === 1\n              ? etape\n              : etape + `\\\\dfrac{\\\\sqrt{${r.numIrred}}}{${k.denIrred}}`\n          } else {\n            return (\n              (k.valeurDecimale === 1 ? etape : etape + k.texFraction) +\n              `\\\\sqrt{${r.toLatex()}}`\n            )\n          }\n        } else {\n          return (\n            (k.valeurDecimale === 1 ? etape : etape + k.texFraction) +\n            `\\\\sqrt{${r.toLatex()}}`\n          )\n        }\n      }\n    }\n  }\n\n  /**\n   * Retourne la racine carre de la  FractionMathjs  si c'est une  FractionMathjs  et false sinon\n   * @return {FractionEtendue|boolean}\n   */\n  racineCarree(): FractionEtendue | false {\n    if (this.isEqual(0)) {\n      return new FractionEtendue(0, 1)\n    } // sqrt(0)=0\n    const factoNum = extraireRacineCarree(Math.abs(this.num))\n    const factoDen = extraireRacineCarree(Math.abs(this.den))\n    const k = new FractionEtendue(factoNum[0], factoDen[0]).simplifie()\n    const r = new FractionEtendue(factoNum[1], factoDen[1]).simplifie()\n    if (r.valeurDecimale !== 1 || this.signe === -1) {\n      return false\n    } else {\n      return k\n    }\n  }\n\n  /**\n   *\n   * @param {number} x position du dessin\n   * @param {number} y\n   * @param {number} rayon rayon du disque\n   * @param {number} depart numro du secteur o commence le coloriage\n   * @param {string} type type parmis : 'gateau', 'segment' et 'barre'\n   * @param {string} couleur\n   * @param {number} unite0 Nombre marquant le dpart du segment\n   * @param {number} unite1 Nombre marquant le point unit du segment\n   * @param {number} scale chelle\n   * @param {string} label ce qu'il faut crire sous le segment ... x ?\n   * @return {object[]} objets mathalea2d\n   */\n  representationIrred(\n    x: number,\n    y: number,\n    rayon: number,\n    depart: number = 0,\n    type: FractionRepresentationType = 'gateau',\n    couleur: string = 'gray',\n    unite0: number | string = 0,\n    unite1: number | string = 1,\n    scale: number = 1,\n    label: string = '',\n  ) {\n    let num: number\n    let k: number\n    const objets = []\n    const n = quotientier(this.numIrred, this.denIrred)\n    num = this.numIrred\n    const unegraduation = function (\n      x: number,\n      y: number,\n      couleur: string = 'black',\n      epaisseur: number = 1,\n    ) {\n      const A = point(x, y + 0.2, '')\n      const B = point(x, y - 0.2, '')\n      const g = segment(A, B, couleur)\n      g.epaisseur = epaisseur\n      return g\n    }\n    if (type === 'gateau') {\n      for (k = 0; k < n; k++) {\n        const O = point(x + k * 2 * (rayon + 0.5), y)\n        const C = cercle(O, rayon)\n        objets.push(C)\n        for (let i = 0; i < this.denIrred; i++) {\n          const s = segment(\n            O,\n            rotation(\n              point(x + rayon + k * 2 * (rayon + 0.5), y),\n              O,\n              90 - (i * 360) / this.denIrred,\n            ),\n          )\n          objets.push(s)\n        }\n        let dep = rotation(\n          point(x + rayon + k * 2 * (rayon + 0.5), y),\n          O,\n          90 - (depart * 360) / this.denIrred,\n        )\n        for (let j = 0; j < Math.min(this.denIrred, num); j++) {\n          const a = arc(dep, O, -360 / this.denIrred, true, couleur)\n          a.opacite = 0.3\n          dep = rotation(dep, O, -360 / this.denIrred)\n          objets.push(a)\n        }\n        num -= this.denIrred\n      }\n      if (Math.abs(this.numIrred) % Math.abs(this.denIrred) !== 0) {\n        const O = point(x + k * 2 * (rayon + 0.5), y)\n        const C = cercle(O, rayon)\n        objets.push(C)\n        for (let i = 0; i < this.denIrred; i++) {\n          const s = segment(\n            O,\n            rotation(\n              point(x + rayon + k * 2 * (rayon + 0.5), y),\n              O,\n              90 - (i * 360) / this.denIrred,\n            ),\n          )\n          objets.push(s)\n        }\n        let dep = rotation(\n          point(x + rayon + k * 2 * (rayon + 0.5), y),\n          O,\n          90 - (depart * 360) / this.denIrred,\n        )\n        for (let j = 0; j < Math.min(this.denIrred, num); j++) {\n          const a = arc(dep, O, -360 / this.denIrred, true, couleur)\n          a.opacite = 0.3\n          dep = rotation(dep, O, -360 / this.denIrred)\n          objets.push(a)\n        }\n      }\n    } else if (type === 'segment') {\n      for (k = 0; k < n; k++) {\n        const O = point(x + k * rayon, y)\n        const C = translation(O, vecteur(rayon, 0))\n        const s = segment(O, C)\n        s.styleExtremites = '-|'\n        objets.push(s)\n        for (let i = 0; i < this.denIrred; i++) {\n          const s = segment(\n            translation(O, vecteur((i * rayon) / this.denIrred, 0)),\n            translation(O, vecteur(((i + 1) * rayon) / this.denIrred, 0)),\n          )\n          s.styleExtremites = '|-'\n          objets.push(s)\n        }\n        const a = segment(\n          O,\n          point(\n            O.x + (Math.min(num, this.denIrred) * rayon) / this.denIrred,\n            O.y,\n          ),\n          couleur,\n        )\n        a.opacite = 0.4\n        a.epaisseur = 6\n        objets.push(a)\n        num -= this.denIrred\n      }\n      const O = point(x + k * rayon, y)\n      const C = translation(O, vecteur(rayon, 0))\n      const s = segment(O, C)\n      s.styleExtremites = '-|'\n      objets.push(s)\n      for (let i = 0; i < this.denIrred; i++) {\n        const s = segment(\n          translation(O, vecteur((i * rayon) / this.denIrred, 0)),\n          translation(O, vecteur(((i + 1) * rayon) / this.denIrred, 0)),\n        )\n        s.styleExtremites = '|-'\n        objets.push(s)\n      }\n      if (num > 0) {\n        const a = segment(\n          O,\n          point(\n            O.x +\n              (Math.min(this.numIrred, this.denIrred) * rayon) / this.denIrred,\n            O.y,\n          ),\n          couleur,\n        )\n        a.opacite = 0.4\n        a.epaisseur = 6\n        objets.push(a)\n      }\n      objets.push(unegraduation(x, y))\n      if (typeof unite0 === 'number' && typeof unite1 === 'number') {\n        for (k = 0; k <= n + 1; k++) {\n          objets.push(\n            texteParPosition(\n              stringNombre(unite0 + k * (unite1 - unite0), 0),\n              x + rayon * k,\n              y - 0.6,\n              0,\n              'black',\n              scale,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n        }\n      } else {\n        if (unite0 != null) {\n          objets.push(\n            texteParPosition(\n              String(unite0),\n              x,\n              y - 0.6,\n              0,\n              'black',\n              scale,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n        }\n        if (unite1 != null) {\n          objets.push(\n            texteParPosition(\n              String(unite1),\n              x + rayon,\n              y - 0.6,\n              0,\n              'black',\n              scale,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n        }\n        if (label != null) {\n          objets.push(\n            texteParPosition(\n              label,\n              x + (rayon * this.numIrred) / this.denIrred,\n              y - 0.6,\n              0,\n              'black',\n              scale,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n        }\n      }\n    } else {\n      let diviseur\n      if (this.denIrred % 6 === 0) {\n        diviseur = 6\n      } else if (this.denIrred % 5 === 0) {\n        diviseur = 5\n      } else if (this.denIrred % 4 === 0) {\n        diviseur = 4\n      } else if (this.denIrred % 3 === 0) {\n        diviseur = 3\n      } else if (this.denIrred % 2 === 0) {\n        diviseur = 2\n      } else {\n        diviseur = 1\n      }\n      const tailleCarres = Math.max(rayon / diviseur, 1)\n      for (k = 0; k < n; k++) {\n        for (let j = 0; j < diviseur; j++) {\n          for (let h = 0; h < this.denIrred / diviseur; h++) {\n            const O = point(\n              x + k * (diviseur * tailleCarres + 1) + j * tailleCarres,\n              y + h * tailleCarres,\n            )\n            const C: Point = translation(O, vecteur(tailleCarres, 0))\n            const dep = carre(O, C, 'black')\n            dep.couleurDeRemplissage = colorToLatexOrHTML(couleur)\n            dep.opaciteDeRemplissage = 0.4\n            objets.push(dep)\n          }\n        }\n        num -= this.denIrred\n      }\n      if (num > 0) {\n        for (let j = 0; j < diviseur; j++) {\n          for (let h = 0; h < this.denIrred / diviseur; h++) {\n            const O = point(\n              x + n * (diviseur * tailleCarres + 1) + j * tailleCarres,\n              y + h * tailleCarres,\n            )\n            const C = translation(O, vecteur(tailleCarres, 0))\n            const dep = carre(O, C, 'black')\n            objets.push(dep)\n          }\n        }\n        for (let i = 0; i < num; i++) {\n          const O = point(\n            x +\n              n * (diviseur * tailleCarres + 1) +\n              (i % diviseur) * tailleCarres,\n            y + quotientier(i, diviseur) * tailleCarres,\n          )\n          const C = translation(O, vecteur(tailleCarres, 0))\n          const dep = carre(O, C, 'black')\n          dep.couleurDeRemplissage = colorToLatexOrHTML(couleur)\n          dep.opaciteDeRemplissage = 0.4\n          objets.push(dep)\n        }\n      }\n    }\n    return objets\n  }\n\n  /**\n   *\n   * @param {number} x position du dessin\n   * @param {number} y\n   * @param {number} rayon rayon du disque\n   * @param {number} depart numro du secteur o commence le coloriage\n   * @param {string} type type parmis : 'gateau', 'segment' et 'barre'\n   * @param {string} couleur\n   * @param {number} unite0 Nombre marquant le dpart du segment\n   * @param {number} unite1 Nombre marquant le point unit du segment\n   * @param {number} scale chelle\n   * @param {string} label ce qu'il faut crire sous le segment ... x ?\n   * @return {object[]}objets mathalea2d\n   */\n  representation(\n    x: number,\n    y: number,\n    rayon: number,\n    depart: number = 0,\n    type: FractionRepresentationType = 'gateau',\n    couleur = 'gray',\n    unite0: String | number = 0,\n    unite1: string | number = 1,\n    scale = 1,\n    label = '',\n  ) {\n    const objets = []\n    let num: number\n    let k: number\n    const n = quotientier(Math.abs(this.num), Math.abs(this.den))\n    num = Math.abs(this.num)\n    const unegraduation = function (\n      x: number,\n      y: number,\n      couleur: string = 'black',\n      epaisseur: number = 1,\n    ) {\n      const A = point(x, y + 0.2)\n      const B = point(x, y - 0.2)\n      const g = segment(A, B, couleur)\n      g.epaisseur = epaisseur\n      return g\n    }\n    if (type === 'gateau') {\n      for (k = 0; k < n; k++) {\n        const O = point(x + k * 2 * (rayon + 0.5), y)\n        const C = cercle(O, rayon)\n        objets.push(C)\n        for (let i = 0; i < this.den; i++) {\n          const s = segment(\n            O,\n            rotation(\n              point(x + rayon + k * 2 * (rayon + 0.5), y),\n              O,\n              90 - (i * 360) / this.den,\n            ),\n          )\n          objets.push(s)\n        }\n        let dep = rotation(\n          point(x + rayon + k * 2 * (rayon + 0.5), y),\n          O,\n          90 - (depart * 360) / this.den,\n        )\n        for (let j = 0; j < Math.min(this.den, num); j++) {\n          const a = arc(dep, O, -360 / this.den, true, couleur)\n          a.opacite = 0.3\n          dep = rotation(dep, O, -360 / this.den)\n          objets.push(a)\n        }\n        num -= this.den\n      }\n      if (this.num % this.den !== 0) {\n        const O = point(x + k * 2 * (rayon + 0.5), y)\n        const C = cercle(O, rayon)\n        objets.push(C)\n        for (let i = 0; i < this.den; i++) {\n          const s = segment(\n            O,\n            rotation(\n              point(x + rayon + k * 2 * (rayon + 0.5), y),\n              O,\n              90 - (i * 360) / this.den,\n            ),\n          )\n          objets.push(s)\n        }\n\n        let dep = rotation(\n          point(x + rayon + k * 2 * (rayon + 0.5), y),\n          O,\n          90 - (depart * 360) / this.den,\n        )\n        if (this.num % this.den !== 0) {\n          for (let j = 0; j < Math.min(this.den, num); j++) {\n            const a = arc(dep, O, -360 / this.den, true, couleur)\n            a.opacite = 0.3\n            dep = rotation(dep, O, -360 / this.den)\n            objets.push(a)\n          }\n        }\n      }\n    } else if (type === 'segment') {\n      for (k = 0; k < n; k++) {\n        const O = point(x + k * rayon, y)\n        const C = translation(O, vecteur(rayon, 0))\n        const s = segment(O, C)\n        s.styleExtremites = '-|'\n        objets.push(s)\n        for (let i = 0; i < this.den; i++) {\n          const s = segment(\n            translation(O, vecteur((i * rayon) / this.den, 0)),\n            translation(O, vecteur(((i + 1) * rayon) / this.den, 0)),\n          )\n          s.styleExtremites = '|-'\n          objets.push(s)\n        }\n        const a = segment(\n          O,\n          point(O.x + (Math.min(num, this.den) * rayon) / this.den, O.y),\n          couleur,\n        )\n        a.opacite = 0.4\n        a.epaisseur = 6\n        objets.push(a)\n        num -= this.den\n      }\n      const O = point(x + k * rayon, y)\n      const C = translation(O, vecteur(rayon, 0))\n      const s = segment(O, C)\n      s.styleExtremites = '-|'\n      objets.push(s)\n      for (let i = 0; i < this.den; i++) {\n        const s = segment(\n          translation(O, vecteur((i * rayon) / this.den, 0)),\n          translation(O, vecteur(((i + 1) * rayon) / this.den, 0)),\n        )\n        s.styleExtremites = '|-'\n        objets.push(s)\n      }\n      if (num > 0) {\n        const a = segment(\n          O,\n          point(O.x + (Math.min(num, this.den) * rayon) / this.den, O.y),\n          couleur,\n        )\n        a.opacite = 0.4\n        a.epaisseur = 6\n        objets.push(a)\n      }\n      objets.push(unegraduation(x, y))\n      if (typeof unite0 === 'number' && typeof unite1 === 'number') {\n        for (k = 0; k <= n + 1; k++) {\n          objets.push(\n            texteParPosition(\n              String(unite0 + k * (unite1 - unite0)),\n              x + rayon * k,\n              y - 0.6,\n              0,\n              'black',\n              scale,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n        }\n      } else {\n        if (String(unite0) !== '') {\n          objets.push(\n            texteParPosition(\n              String(unite0),\n              x,\n              y - 0.6,\n              0,\n              'black',\n              scale,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n        }\n        if (String(unite1) !== '') {\n          objets.push(\n            texteParPosition(\n              String(unite1),\n              x + rayon,\n              y - 0.6,\n              0,\n              'black',\n              scale,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n        }\n        if (label !== '') {\n          objets.push(\n            texteParPosition(\n              label,\n              x + (rayon * this.num) / this.den,\n              y - 0.6,\n              0,\n              'black',\n              scale,\n              'milieu',\n              true,\n              1,\n            ),\n          )\n        }\n      }\n    } else {\n      // Type barre\n      let diviseur\n      if (this.den % 6 === 0) {\n        diviseur = 6\n      } else if (this.den % 5 === 0) {\n        diviseur = 5\n      } else if (this.den % 4 === 0) {\n        diviseur = 4\n      } else if (this.den % 3 === 0) {\n        diviseur = 3\n      } else if (this.den % 2 === 0) {\n        diviseur = 2\n      } else {\n        diviseur = 1\n      }\n      const tailleCarres = Math.max(rayon / diviseur, 1)\n      for (k = 0; k < n; k++) {\n        // on fait autant de plaques que d'units entires\n        for (let j = 0; j < diviseur; j++) {\n          // on fait this.den carrs rpartis sur this.den/diviseur lignes de diviseur de long\n          for (let h = 0; h < this.den / diviseur; h++) {\n            const O = point(\n              x + k * (diviseur * tailleCarres + 1) + j * tailleCarres,\n              y + h * tailleCarres,\n            )\n            const C = translation(O, vecteur(tailleCarres, 0))\n            const dep = carre(O, C, 'black')\n            dep.couleurDeRemplissage = colorToLatexOrHTML(couleur)\n            dep.opaciteDeRemplissage = 0.4\n            objets.push(dep)\n          }\n        }\n        num -= this.den\n      }\n      if (num > 0) {\n        // il reste une portion d'unit  faire aprs n units.\n        for (let j = 0; j < diviseur; j++) {\n          for (let h = 0; h < this.den / diviseur; h++) {\n            const O = point(\n              x + n * (diviseur * tailleCarres + 1) + j * tailleCarres,\n              y + h * tailleCarres,\n            )\n            const C = translation(O, vecteur(tailleCarres, 0))\n            const dep = carre(O, C, 'black')\n            objets.push(dep)\n          }\n        }\n        for (let i = 0; i < num; i++) {\n          const O = point(\n            x +\n              n * (diviseur * tailleCarres + 1) +\n              (i % diviseur) * tailleCarres,\n            y + quotientier(i, diviseur) * tailleCarres,\n          )\n          const C = translation(O, vecteur(tailleCarres, 0))\n          const dep = carre(O, C, 'black')\n          dep.couleurDeRemplissage = colorToLatexOrHTML(couleur)\n          dep.opaciteDeRemplissage = 0.4\n          objets.push(dep)\n        }\n      }\n    }\n    return objets\n  }\n\n  /**\n   * Renvoie un array avec l'ensemble de rponses possibles correspondant  un couple de fractions et de leurs diffrentes simplifications afin de pouvoir les placer dans un setReponse\n   * Exemple ['-\\\\frac{a}{b};\\\\frac{c}{d}', '\\\\frac{-a}{b};\\\\frac{c}{d}', '\\\\frac{a}{-b};\\\\frac{c}{d}', '\\\\frac{c}{d};-\\\\frac{a}{b}', '\\\\frac{c}{d};\\\\frac{-a}{b}', '\\\\frac{c}{d};\\\\frac{a}{-b}' ...\n   * @author Guillaume Valmont\n   * @param {number} n1 numrateur de la 1e fraction\n   * @param {number} d1 dnominateur de la 1e fraction\n   * @param {number} n2 numrateur de la 2e fraction\n   * @param {number} d2 dnominateur de la 2e fraction\n   * @return array avec la liste des couples de fractions gales et simplifies sous la forme '\\\\frac{n1}{d1};\\\\frac{n2}{d2}'\n   */\n  static texArrayReponsesCoupleDeFractionsEgalesEtSimplifiees(\n    n1: number,\n    d1: number,\n    n2: number,\n    d2: number,\n  ) {\n    return this.texArrayReponsesCoupleDeFractions(n1, d1, n2, d2, true)\n  }\n\n  /**\n   * Fonction destine  tre utilise conjointement avec setReponse\n   * Exemple [\\\\frac{18}{6}, \\\\frac{-18}{-6}, -\\\\frac{-18}{6}, -\\\\frac{18}{-6}, \\\\frac{9}{3}, \\\\frac{-9}{-3}, -\\\\frac{-9}{3}, -\\\\frac{9}{-3}, 3]\n   * @author Guillaume Valmont\n   * @param {number} n numrateur\n   * @param {number} d dnominateur\n   * @return array avec la liste des fractions gales et simplifies sous la forme '\\\\frac{n}{d}'\n   */\n  static texArrayReponsesFractionsEgalesEtSimplifiees(n: number, d: number) {\n    const fractionsSimplifiees = this.listerFractionsSimplifiees(n, d)\n    const liste = []\n    for (const fractionSimplifiee of fractionsSimplifiees) {\n      const reponses = this.texArrayReponsesFraction(\n        fractionSimplifiee[0],\n        fractionSimplifiee[1],\n      )\n      for (const reponse of reponses) {\n        liste.push(reponse)\n      }\n    }\n    return liste\n  }\n\n  /**\n   * Renvoie un array avec l'ensemble de rponses possibles correspondant  un couple de fractions afin de pouvoir les placer dans un setReponse\n   * Exemple ['-\\\\frac{a}{b};\\\\frac{c}{d}', '\\\\frac{-a}{b};\\\\frac{c}{d}', '\\\\frac{a}{-b};\\\\frac{c}{d}', '\\\\frac{c}{d};-\\\\frac{a}{b}', '\\\\frac{c}{d};\\\\frac{-a}{b}', '\\\\frac{c}{d};\\\\frac{a}{-b}' ...\n   * @author Guillaume Valmont\n   * @param {number} n1 numrateur 1\n   * @param {number} d1 dnominateur 1\n   * @param {number} n2 numrateur 1\n   * @param {number} d2 dnominateur 1\n   * @param {boolean} egalesEtSimplifiees true si on veut inclure l'ensemble des fractions gales et simplifies\n   * @return array avec la liste des couples de fractions sous la forme '\\\\frac{n1}{d1};\\\\frac{n2}{d2}'\n   */\n  static texArrayReponsesCoupleDeFractions(\n    n1: number,\n    d1: number,\n    n2: number,\n    d2: number,\n    egalesEtSimplifiees: boolean = false,\n  ) {\n    let listeFraction1, listeFraction2\n    if (egalesEtSimplifiees) {\n      listeFraction1 = this.texArrayReponsesFractionsEgalesEtSimplifiees(n1, d1)\n      listeFraction2 = this.texArrayReponsesFractionsEgalesEtSimplifiees(n2, d2)\n    } else {\n      listeFraction1 = this.texArrayReponsesFraction(n1, d1)\n      listeFraction2 = this.texArrayReponsesFraction(n2, d2)\n    }\n    const listeCouples = []\n    for (const ecriture1 of listeFraction1) {\n      for (const ecriture2 of listeFraction2) {\n        listeCouples.push(\n          ecriture1 + ';' + ecriture2,\n          ecriture2 + ';' + ecriture1,\n        )\n      }\n    }\n    return listeCouples\n  }\n\n  /**\n   * Fonction destine  lister l'ensemble des possibilits d'criture d'une mme  FractionMathjs  pour tre compares dans un setReponse\n   * @author Guillaume Valmont\n   * @param {number} numerateur\n   * @param {number} denominateur\n   * @return array avec l'ensemble des possibilits d'criture d'une mme  FractionMathjs  au format LateX\n   */\n  static texArrayReponsesFraction(numerateur: number, denominateur: number) {\n    const n = Math.abs(numerateur)\n    const d = Math.abs(denominateur)\n    if (d === 1) {\n      return [(numerateur * denominateur).toString()]\n    } else {\n      if (numerateur * denominateur > 0) {\n        return [\n          `\\\\frac{${n}}{${d}}`,\n          `\\\\frac{${-n}}{${-d}}`,\n          `-\\\\frac{${-n}}{${d}}`,\n          `-\\\\frac{${n}}{${-d}}`,\n        ]\n      } else if (numerateur * denominateur < 0) {\n        return [\n          `-\\\\frac{${n}}{${d}}`,\n          `-\\\\frac{${-n}}{${-d}}`,\n          `\\\\frac{${-n}}{${d}}`,\n          `\\\\frac{${n}}{${-d}}`,\n        ]\n      } else {\n        return ['0']\n      }\n    }\n  }\n\n  /**\n   * Renvoie l'ensemble des fractions gales et simplifies\n   * Ne change pas et ne dplace pas les signes (s'il y a un \"-\" au dnominateur, il restera au dnominateur)\n   * @author Guillaume Valmont\n   * @param {number} n\n   * @param {number} d\n   * @return array de couples [numerateur, denominateur] de l'ensemble des fractions gales et simplifies\n   */\n  static listerFractionsSimplifiees(n: number, d: number) {\n    if (pgcd(n, d) === 1) {\n      return [[n, d]]\n    } else {\n      const liste = []\n      for (const diviseur of listeDesDiviseurs(pgcd(n, d))) {\n        liste.push([n / diviseur, d / diviseur])\n      }\n      return liste\n    }\n  }\n}\n\nexport default FractionEtendue\n","import Figure from 'apigeom/src/Figure'\nimport CryptoJS from 'crypto-js'\nimport type Decimal from 'decimal.js'\nimport seedrandom from 'seedrandom'\nimport FractionEtendue from '../modules/FractionEtendue'\nimport type Exercice from './Exercice'\ntype EventListener = (evt: Event) => void\n\nexport function exportedNouvelleVersionWrapper(\n  this: Exercice,\n  numeroExercice?: number,\n  numeroQuestion?: number,\n): void {\n  const signature = [\n    this.seed,\n    this.sup,\n    this.sup2,\n    this.sup3,\n    this.sup4,\n    this.sup5,\n    this.correctionDetaillee,\n    this.interactif,\n    this.nbQuestions,\n    numeroExercice,\n    numeroQuestion,\n  ]\n    .map(String)\n    .join('')\n  if (this.lastCallback === signature) {\n    // identique\n    // pas de recalcul  faire\n    return\n  }\n  this.lastCallback = signature\n  this.reinit()\n  seedrandom(this.seed, { global: true })\n  this.nouvelleVersion(numeroExercice, numeroQuestion)\n}\n\nexport function exportedReinit(this: Exercice) {\n  this.listeQuestions = []\n  this.listeCorrections = []\n  this.listeCanEnonces = []\n  this.listeCanReponsesACompleter = []\n  this.listeCanLiees = []\n  this.listeCanNumerosLies = []\n  this.listeArguments = []\n  this.autoCorrection = []\n  this.distracteurs = []\n  if (this.figures) {\n    // figure APIGEOM\n    this.figures.forEach((fig) => {\n      if (fig instanceof Figure) {\n        fig.clearHtml()\n        fig.container = document.createElement('div')\n      }\n    })\n  }\n  this.figures = []\n  if (this.dragAndDrops && this.dragAndDrops.length > 0) {\n    for (const leDragAndDrop of this.dragAndDrops) {\n      for (const [element, type, listener] of leDragAndDrop.listeners) {\n        element.removeEventListener(type, listener as EventListener)\n      }\n    }\n    this.dragAndDrops = []\n  }\n}\n\nexport function exportedApplyNewSeed(this: Exercice) {\n  const seed = generateSeed({\n    includeUpperCase: true,\n    includeNumbers: true,\n    length: 4,\n    startsWithLowerCase: false,\n  })\n  this.seed = seed\n}\n\nfunction empreinteTexte(str: string): string {\n  // Utiliser CryptoJS pour calculer une empreinte SHA256 de la chane de caractres\n  const hash = CryptoJS.SHA256(str)\n  // Convertir l'empreinte en chane de caractres hexadcimale\n  const empreinteTexte = hash.toString(CryptoJS.enc.Hex)\n  return empreinteTexte.length > str.length ? str : empreinteTexte\n}\n\n/**\n * Compare chaque nouvelle version d'un exercice aux prcdentes pour s'assurer de ne pas avoir deux exercices identiques\n * @param {int} i indice de la question\n * @param  {...any} args toutes les variables pertinentes qui \"rsumeraient\" la question\n * @returns {boolean} true si la question n'a jamais t pose\n */\nexport function exportedQuestionJamaisPosee(\n  this: Exercice,\n  i: number,\n  ...args: (string | number | FractionEtendue | Decimal)[]\n) {\n  if (i === 0) this.listeArguments = []\n  let argsConcatenes = ''\n  for (const arg of args) {\n    if (arg !== undefined)\n      argsConcatenes +=\n        arg instanceof FractionEtendue ? arg.texFraction : arg.toString()\n  }\n  const empreinte = empreinteTexte(argsConcatenes)\n  if (\n    this.listeArguments != null &&\n    this.listeArguments.indexOf(empreinte) > -1\n  ) {\n    return false\n  } else if (this.listeArguments != null) {\n    this.listeArguments.push(empreinte)\n    return true\n  }\n}\n\nfunction generateSeed({\n  includeUpperCase = true,\n  includeNumbers = true,\n  length = 4,\n  startsWithLowerCase = false,\n}: {\n  includeUpperCase?: boolean\n  includeNumbers?: boolean\n  length?: number\n  startsWithLowerCase?: boolean\n} = {}) {\n  let a = 10\n  const b = 'abcdefghijklmnopqrstuvwxyz'\n  let c = ''\n  let d = 0\n  let e = '' + b\n  if (startsWithLowerCase) {\n    c = b[Math.floor(Math.random() * b.length)]\n    d = 1\n  }\n  if (length) {\n    a = length\n  }\n  if (includeUpperCase) {\n    e += b.toUpperCase()\n  }\n  if (includeNumbers) {\n    e += '1234567890'\n  }\n\n  for (; d < a; d++) {\n    c += e[Math.floor(Math.random() * e.length)]\n  }\n  return c\n}\n","import type Figure from 'apigeom/src/Figure'\nimport {\n  KeyboardType,\n  type PartialKbType,\n} from '../lib/interactif/claviers/keyboard'\nimport type { OptionsComparaisonType } from '../lib/interactif/comparisonFunctions'\nimport type DragAndDrop from '../lib/interactif/DragAndDrop'\nimport type {\n  AutoCorrection,\n  clickFigures,\n  ReponseComplexe,\n} from '../lib/interactif/gestionInteractif'\nimport type { InteractivityType } from '../lib/types'\nimport type Grandeur from '../modules/Grandeur'\nimport {\n  exportedApplyNewSeed,\n  exportedNouvelleVersionWrapper,\n  exportedQuestionJamaisPosee,\n  exportedReinit,\n} from './exerciseMethods'\n// Pour retro compatibilit avec setReponse\nexport type OldFormatInteractifType =\n  | 'calcul'\n  | 'texte'\n  | 'tableauMathlive'\n  | 'Num'\n  | 'Den'\n  | 'fractionEgale'\n  | 'unites'\n  | 'intervalleStrict'\n  | 'intervalle'\n  | 'puissance'\n  | 'canonicalAdd'\n  | 'ignorerCasse'\n\n/**\n *\n *  Classe parente de tous les exercices.\n *\n * @author Rmi Angot\n */\nexport default class Exercice {\n  titre: string\n  id?: string\n  uuid!: string\n  sup: any\n  sup2: any\n  sup3: any\n  sup4: any\n  sup5: any\n  exoCustomResultat?: boolean // Lorsqu'il est  true, correctionInteractive renvoie un tableau de string ce qui permet  une question de rapporter plusieurs points\n  duree?: number\n  seed?: string\n  numeroExercice?: number\n  typeExercice?: string\n  duration?: number\n  // boutonAide: boolean | HTMLButtonElement\n  consigne: string\n  consigneCorrection: string\n  introduction: string\n  listeQuestions: string[] = []\n  listeCorrections: string[] = []\n  listeCanReponsesACompleter: string[] = []\n  listeCanEnonces: string[] = []\n  listeCanLiees: number[][] = []\n  listeCanNumerosLies: number[] = []\n  question?: string // Seulement pour les exercices de type simple\n  reponse?: ReponseComplexe // Seulement pour les exercices de type simple\n  correction?: string // Seulement pour les exercices de type simple\n  canOfficielle?: boolean = false\n  canEnonce?: string // Seulement pour les exercices de type simple ??? NON ! NOTE de Jena-claude Lhote du 2/02/2025 : et pourquoi a ???\n  // On peut tre amen  utiliser un Exercice non simple  une seule question dans une can, parce qu'il a 3 champs et une correction custom.\n  // Et vouloir un this.canEnonce sur cet exercice, pour le document CAN !\n  canReponseACompleter: string = '' // Seulement pour les exercices de type simple\n  canNumeroLie: number = 0 //  Pour la sortie LaTeX des CAN dont les noncs sont lies, cette variable contient le numro de la question actuelle.\n  canLiee: number[] = [] //  Pour la sortie LaTeX des CAN dont les noncs sont lies, cette variable contient, dans un tableau, les numros des CAN lies  l'actuelle.\n  formatChampTexte: string | undefined | PartialKbType =\n    KeyboardType.clavierDeBase // Seulement pour les exercices de type simple\n\n  optionsChampTexte?: object // Seulement pour les exercices de type simple\n  // tailleDiaporama?: number // Pour fixer un zoom de base en mode diaporama\n  compare?:\n    | ((\n        input: string,\n        goodAnswer: string,\n      ) => { isOk: boolean; feedback?: string })\n    | ((\n        input: string,\n        goodAnswer: Grandeur,\n      ) => { isOk: boolean; feedback?: string }) // Seulement pour les exercices de type simple\n\n  // optionsDeComparaison?: { [key in keyof OptionsComparaisonType]?: boolean }\n  optionsDeComparaison?: Partial<OptionsComparaisonType>\n  formatInteractif?: InteractivityType | OldFormatInteractifType // Options par dfaut pour les champs Mathlive (trs utile dans les exercices simples)\n  contenu?: string\n  contenuCorrection?: string\n  autoCorrection: AutoCorrection[]\n  figures?: Figure[] | clickFigures[]\n  amcReady?: boolean\n  amcType?: string\n  tableauSolutionsDuQcm?: object[]\n  spacing: number\n  spacingCorr: number\n  pasDeVersionLatex: boolean\n  listePackages?: string[]\n  consigneModifiable: boolean\n  nbQuestionsModifiable: boolean\n  nbCols: number // Nombre de colonnes pour la sortie LaTeX\n  nbColsCorr: number\n  nbColsModifiable: boolean\n  nbColsCorrModifiable: boolean\n  spacingModifiable: boolean\n  spacingCorrModifiable: boolean\n  listeAvecNumerotation?: boolean\n  beamer: boolean\n  nbQuestions: number\n  pointsParQuestions: number\n  correctionDetailleeDisponible: boolean\n  correctionDetaillee: boolean\n  correctionIsCachee: boolean\n  video: string\n  interactif: boolean // l'exercice est affich en mode interactif si `true`\n  interactifObligatoire: boolean\n  interactifReady: boolean // flag pour indiquer si l'exercice est dispo en interactif ou pas\n  interactifType?: string\n  besoinFormulaireNumerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n\n  besoinFormulaireTexte: boolean | [string, string]\n  besoinFormulaireCaseACocher: boolean | [string] | [string, boolean]\n  besoinFormulaire2Numerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n\n  besoinFormulaire2Texte: boolean | [string, string]\n  besoinFormulaire2CaseACocher: boolean | [string] | [string, boolean]\n  besoinFormulaire3Numerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n\n  besoinFormulaire3Texte: boolean | [string, string]\n  besoinFormulaire3CaseACocher: boolean | [string] | [string, boolean]\n  besoinFormulaire4Numerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n\n  besoinFormulaire4Texte: boolean | [string, string]\n  besoinFormulaire4CaseACocher: boolean | [string] | [string, boolean]\n  besoinFormulaire5Numerique:\n    | boolean\n    | [titre: string, max: number, tooltip: string]\n    | [titre: string, max: number]\n\n  besoinFormulaire5Texte: boolean | [string, string]\n  besoinFormulaire5CaseACocher: boolean | [string] | [string, boolean]\n  listeArguments: string[] // Variable servant  comparer les exercices pour ne pas avoir deux exercices identiques\n  lastCallback: string // La dernire signature de listeArguments afin de comparaison : permet d'viter un nouvelleVersionWrapper inutile\n  examen?: string // Pour les exercices statiques\n  mois?: string // Pour les exercices statiques\n  annee?: string // Pour les exercices statiques\n  lieu?: string // Pour les exercices statiques\n  content?: string // Pour les exercices statiques\n  contentCorr?: string // Pour les exercices statiques\n  comment?: string // Commentaire facultatif de l'auteur de l'exercice\n  answers?: { [key: string]: string } // Rponses de l'lve\n  dragAndDrops?: DragAndDrop[]\n  isDone?: boolean\n  private _html: HTMLElement = document.createElement('div')\n  score?: number\n  vspace?: number // Ajoute un \\vspace{[number]cm} avant l'nonc ce qui peut tre pratique pour des exercices avec des figures.\n\n  constructor() {\n    // ////////////////////////////////////////////////\n    // Autour de l'exercice\n    // ////////////////////////////////////////////////\n    this.titre = '' // Chane de caractre sans point  la fin. C'est le titre de l'exercice qui sera affich avec la rfrence dans le gnrateur d'exercices.\n\n    // ///////////////////////////////////////////////\n    // Construction de l'exercice\n    // ///////////////////////////////////////////////\n    this.consigne = '' // Chane de caractre qui apparat en gras au-dessus des questions de prfrence  l'infinitif et AVEC point  la fin.\n    this.consigneCorrection = '' // Chane de caractre en gnral vide qui apparat au-dessus des corrections.\n    this.introduction = '' // Texte qui n'est pas forcment en gras et qui apparat entre la consigne et les questions.\n\n    this.listeQuestions = []\n    this.listeCorrections = [] // Idem avec la correction.\n    this.contenu = '' // Chane de caractres avec tout l'nonc de l'exercice construit  partir de `this.listeQuestions` suivant le `context`\n    this.contenuCorrection = '' // Idem avec la correction\n    this.autoCorrection = [] // Liste des objets par question pour correction interactive || export AMC.\n    this.tableauSolutionsDuQcm = [] // Pour sauvegarder les solutions des QCM.\n\n    // ///////////////////////////////////////////////\n    // Mise en forme de l'exercice\n    // ///////////////////////////////////////////////\n    this.spacing = 1 // Interligne des questions\n    this.spacingCorr = 1 // Interligne des rponses\n\n    // ////////////////////////////////////////////\n    // Gestion de la sortie LateX\n    // ////////////////////////////////////////////\n    this.pasDeVersionLatex = false // boolen qui indique qu'une sortie LateX est impossible.\n    this.consigneModifiable = true // boolen pour dterminer si la consigne est modifiable en ligne dans la sortie LaTeX.\n    this.nbQuestionsModifiable = true // boolen pour dterminer si le nombre de questions est modifiable en ligne.\n    this.nbCols = 1 // Nombre de colonnes pour la sortie LaTeX des questions (environnement multicols).\n    this.nbColsCorr = 1 // Nombre de colonnes pour la sortie LaTeX des rponses (environnement multicols).\n    this.nbColsModifiable = true // boolen pour dterminer si le nombre de colonnes est modifiable en ligne dans la sortie LaTeX.\n    this.nbColsCorrModifiable = true // boolen pour dterminer si le nombre de colonnes de la correction est modifiable en ligne dans la sortie LaTeX.\n    this.spacingModifiable = true // boolen pour dterminer si l'espacement est modifiable en ligne dans la sortie LaTeX.\n    this.spacingCorrModifiable = true // boolen pour dterminer si l'espacement est modifiable en ligne dans la sortie LaTeX.\n\n    // ////////////////////////////////////////////\n    // Gestion de la sortie autre que LateX\n    // ////////////////////////////////////////////\n    this.beamer = false // boolen pour savoir si la sortie devra tre un diaporama beamer\n\n    // ////////////////////////////////////////////\n    // Paramtres\n    // ////////////////////////////////////////////\n    this.nbQuestions = 10 // Nombre de questions par dfaut (rcupr dans l'url avec le paramtre `,n=`)\n    this.pointsParQuestions = 1 // Pour dfinir la note par dfaut d'un exercice dans sa sortie Moodle\n    this.correctionDetailleeDisponible = false // boolen qui indique si une correction dtaille est disponible.\n    this.correctionDetaillee = true // boolen indiquant si la correction dtaille doit tre affich par dfaut (rcupr dans l'url avec le paramtre `,cd=`).\n    this.correctionIsCachee = false // pour cacher une correction\n    this.video = '' // Chaine de caractre pour un complment numrique (id Youtube, url, code iframe...).\n    // Interactivit\n    this.interactif = false // Exercice sans saisie utilisateur par dfaut.\n    this.interactifReady = false // Exercice sans saisie utilisateur par dfaut.\n    this.interactifObligatoire = false // Certains exercices sont uniquement des QCM et n'ont pas de version non interactive.\n    // Ajoute un formulaire de paramtrage par l'utilisateur rcupr via this.sup ou dans le paramtre d'url ',s='\n    this.besoinFormulaireNumerique = false // Sinon this.besoinFormulaireNumerique = [texte, max, tooltip facultatif]\n    this.besoinFormulaireTexte = false // Sinon this.besoinFormulaireTexte = [texte, tooltip]\n    this.besoinFormulaireCaseACocher = false // Sinon this.besoinFormulaireCaseACocher = [texte]\n    // Ajoute un formulaire de paramtrage par l'utilisateur rcupr via this.sup2 ou dans le paramtre d'url ',s2='\n    this.besoinFormulaire2Numerique = false // Sinon this.besoinFormulaire2Numerique = [texte, max, tooltip facultatif]\n    this.besoinFormulaire2Texte = false // Sinon this.besoinFormulaire2Texte = [texte, tooltip]\n    this.besoinFormulaire2CaseACocher = false // Sinon this.besoinFormulaire2CaseACocher = [texte]\n    // Ajoute un formulaire de paramtrage par l'utilisateur rcupr via this.sup3 ou dans le paramtre d'url ',s3='\n    this.besoinFormulaire3Numerique = false // Sinon this.besoinFormulaire3Numerique = [texte, max, tooltip facultatif]\n    this.besoinFormulaire3Texte = false // Sinon this.besoinFormulaire3Texte = [texte, tooltip]\n    this.besoinFormulaire3CaseACocher = false // Sinon this.besoinFormulaire3CaseACocher = [texte]\n    // Ajoute un formulaire de paramtrage par l'utilisateur rcupr via this.sup4 ou dans le paramtre d'url ',s4='\n    this.besoinFormulaire4Numerique = false // Sinon this.besoinFormulaire4Numerique = [texte, max, tooltip facultatif]\n    this.besoinFormulaire4Texte = false // Sinon this.besoinFormulaire4Texte = [texte, tooltip]\n    this.besoinFormulaire4CaseACocher = false // Sinon this.besoinFormulaire4CaseACocher = [texte]\n    // Ajoute un formulaire de paramtrage par l'utilisateur rcupr via this.sup4 ou dans le paramtre d'url ',s5='\n    this.besoinFormulaire5Numerique = false // Sinon this.besoinFormulaire5Numerique = [texte, max, tooltip facultatif]\n    this.besoinFormulaire5Texte = false // Sinon this.besoinFormulaire5Texte = [texte, tooltip]\n    this.besoinFormulaire5CaseACocher = false // Sinon this.besoinFormulaire5CaseACocher = [texte]\n\n    // ///////////////////////////////////////////////\n    // Exercice avec des dpendances particulires\n    // ///////////////////////////////////////////////\n    // this.typeExercice = 'Scratch' // Pour charger Scratchblocks.\n    // this.typeExercice = 'dnb' // Ce n'est pas un exercice alatoire il est trait diffremment. Les exercices DNB sont des images pour la sortie Html et du code LaTeX statique pour la sortie latex.\n    // this.typeExercice = 'simple' // Pour les exercices plus simples destins aux courses aux nombres\n\n    this.listeArguments = [] // Variable servant  comparer les exercices pour ne pas avoir deux exercices identiques\n    this.lastCallback = ''\n    this.answers = {}\n    this.listeAvecNumerotation = true\n  }\n\n  get html(): HTMLElement {\n    return this._html\n  }\n\n  set html(value: HTMLElement) {\n    this._html = value\n  }\n\n  destroy(): void {\n    // Ncessaire pour viter les fuites de mmoire des exercices HTML\n  }\n\n  nouvelleVersionWrapper = exportedNouvelleVersionWrapper.bind(this as Exercice)\n\n  correctionInteractive?(i: number): string | string[]\n\n  nouvelleVersion(numeroExercice?: number, numeroQuestion?: number): void {\n    console.info(numeroExercice)\n  }\n\n  reinit = exportedReinit.bind(this as Exercice)\n\n  applyNewSeed = exportedApplyNewSeed.bind(this as Exercice)\n\n  questionJamaisPosee = exportedQuestionJamaisPosee.bind(this as Exercice)\n}\n","import Exercice from './Exercice'\n\nexport default class ExerciceSimple extends Exercice {\n  distracteurs: (string | number)[]\n  typeExercice: 'simple'\n  versionQcmDisponible?: boolean // Pour les exercices de type simple, si des distracteurs sont dfinis, on peut proposer une version QCM\n  versionQcm?: boolean // Seulement pour les exercices de type simple, version QCM active si 'true'\n  constructor() {\n    super()\n    this.distracteurs = []\n    this.typeExercice = 'simple'\n  }\n}\n","/* global HTMLElement SVGElement Element fetch */\n/**\n * Fonctions de gestion du dom\n * @module\n */\n\n/**\n * Retourne true si l'objet  la proprit\n * @param {Object} object\n * @param {string} prop\n * @return {boolean}\n */\nconst hasProp = (object: object, prop: string) =>\n  typeof object === 'object' &&\n  Object.prototype.hasOwnProperty.call(object, prop)\n\n/**\n * Affecte des styles  un lment html (on peut pas affecter elt.style directement car read only, faut faire du elt.style.foo = bar)\n * sans planter en cas de pb (on le signale juste en console)\n * Les styles doivent tre crits en camelCase dans le version JS et non CSS\n * @param {HTMLElement} elt\n * @param {string|object} styles\n */\nexport function setStyles(\n  elt: HTMLElement,\n  styles: string | { [key: string]: string },\n) {\n  try {\n    if (elt && elt.style) {\n      if (typeof styles === 'string') {\n        const stylesArr = styles.split(';')\n        stylesArr.forEach(function (paire: string) {\n          const paireArr = /([\\w]+):(.+)/.exec(paire)\n          if (paireArr) {\n            const [, key, value] = paireArr as unknown as [\n              string,\n              keyof CSSStyleDeclaration,\n              string,\n            ]\n            try {\n              if (!elt.style[key]) elt.style[key] = value\n            } catch (error) {\n              console.warn(\n                `Cannot assign value to style property ${String(key)}: ${error}`,\n              )\n            }\n          }\n        })\n      } else if (typeof styles === 'object') {\n        for (const prop in styles) {\n          if (hasProp(styles, prop)) {\n            try {\n              Object.assign(elt.style, { [prop]: styles[prop] })\n            } catch (error) {\n              console.warn(\n                `Cannot assign value to style property ${prop}: ${error}`,\n              )\n            }\n          }\n        }\n      }\n    }\n  } catch (error) {\n    console.error(error)\n  }\n}\n\n/**\n * Ajoute du texte dans un lment\n * @param {HTMLElement} elt\n * @param {string} text\n */\nexport function addText(elt: HTMLElement, text: string) {\n  elt.appendChild(window.document.createTextNode(text))\n}\n\n/**\n * Retourne l'lment du dom\n * @param {string} id\n * @param {boolean} [strict=true] Passer false pour retourner null plutt que throw une erreur si id n'existe pas\n * @return {HTMLElement}\n * @throws {TypeError} Si id n'est pas une string\n * @throws {Error} Si l'lment id n'existe pas\n */\nexport function get(id: string, strict = true) {\n  if (typeof id !== 'string') throw TypeError('argument invalide')\n  const elt = document.getElementById(id)\n  if (!elt && strict) throw Error(`Llment html ${id} nexiste pas`)\n  return elt\n}\n\n/**\n * Retourne un lment html de type tag (non insr dans le dom)\n * @param {string} tag\n * @param {Object} [attrs] Les attributs\n * @param {string} [txtContent] Contenu textuel ventuel\n */\nexport function create(\n  tag: keyof HTMLElementTagNameMap,\n  attrs: { [key: string]: any },\n  txtContent?: string,\n) {\n  const elt = window.document.createElement(tag)\n  let attr\n  try {\n    if (attrs) {\n      for (attr in attrs) {\n        if (hasProp(attrs, attr)) {\n          if (attr === 'class') elt.className = attrs.class\n          else if (attr === 'className') elt.className = attrs.className\n          else if (attr === 'style') setStyles(elt, attrs.style)\n          else elt.setAttribute(attr, attrs[attr])\n        }\n      }\n    }\n  } catch (error) {\n    console.error(error)\n  }\n\n  if (txtContent) addText(elt, txtContent)\n\n  return elt\n}\n\n/**\n * Ajoute un lment html de type tag  parent\n * @param {HTMLElement} parent\n * @param {string} tag\n * @param {Object=} attrs Les attributs\n * @param {string=} content\n * @returns {HTMLElement} L'lment ajout\n */\nexport function addElement(\n  parent: HTMLElement,\n  tag: keyof HTMLElementTagNameMap,\n  attrs: { [key: string]: any },\n  content: string,\n) {\n  const elt = create(tag, attrs, content)\n  parent.appendChild(elt)\n  return elt\n}\n\n/**\n * S'assure que elt est bien un lment du DOM et le retourne (throw sinon)\n * @param {string|HTMLElement|SVGElement|Element} elt Si c'est une string on ira chercher l'lment avec getElementById\n * @param {string} [type] pour restreindre  un type d'lment, html|svg\n * @return {HTMLElement|SVGElement|Element}\n * @throws {TypeError} Si elt n'tait pas un lment du type voulu\n */\nexport function enforceElt(elt: HTMLElement | string, type: string) {\n  let newElt: HTMLElement | SVGElement | Element | null\n  if (typeof elt === 'string') {\n    newElt = document.getElementById(elt) ?? null\n    if (!newElt) throw Error(`Aucun lment did ${elt}`)\n  } else {\n    newElt = elt\n  }\n  switch (type) {\n    case 'html':\n      if (newElt instanceof HTMLElement) return newElt\n      throw TypeError('HTMLElement indispensable manquant')\n    case 'svg':\n      if (newElt instanceof SVGElement) return newElt\n      throw TypeError('SVGElement indispensable manquant')\n    default:\n      if (newElt instanceof Element) return newElt\n  }\n  throw TypeError('Element indispensable manquant')\n}\n\n/**\n *\n * @param {string} url du fichier HTML\n * @param {HTMLElement} element dont le innerHTML va tre remplac par le contenu du fichier\n */\nexport async function fetchHtmlToElement(url: string, element: HTMLElement) {\n  const response = await fetch(url)\n  element.innerHTML = await response.text()\n}\n\n/**\n *\n * @param {string} url du fichier HTML\n * @param {element} parent dans lequel l'lment va tre ajout en dernier enfant\n * @param {string=} tag 'div' par dfaut\n * @param {Object=} attrs Les attributs\n * @returns {HTMLElement} L'lment ajout\n */\nexport async function addFetchHtmlToParent(\n  url: string,\n  parent: HTMLElement,\n  tag = 'div',\n  attrs: { [key: string]: any },\n) {\n  const child = addElement(\n    parent,\n    tag as keyof HTMLElementTagNameMap,\n    attrs,\n    '',\n  )\n  return fetchHtmlToElement(url, child)\n}\n","import {\n  ComputeEngine,\n  type BoxedExpression,\n  type LatexDictionaryEntry,\n  type ParseLatexOptions,\n  type Parser,\n} from '@cortex-js/compute-engine'\nimport { number } from 'mathjs'\nimport type { Expression } from 'mathlive'\n/* import type {\n  LatexDictionaryEntry,\n  ParseLatexOptions,\n  Parser\n} from 'node_modules/@cortex-js/compute-engine/dist/types/compute-engine/latex-syntax/public.d.ts'\n */\nimport Grandeur from '../../modules/Grandeur'\nimport Hms from '../../modules/Hms'\nimport { areSameArray } from '../outils/arrayOutils'\nimport { texNombre } from '../outils/texNombre'\n\nconst engine = new ComputeEngine()\nexport default engine\n\nexport type ResultType = { isOk: boolean; feedback?: string }\nexport type OptionsComparaisonType = {\n  noFeedback?: boolean\n  expressionsForcementReduites?: boolean\n  avecSigneMultiplier?: boolean\n  avecFractions?: boolean\n  sansTrigo?: boolean\n  fractionIrreductible?: boolean\n  fractionSimplifiee?: boolean\n  fractionReduite?: boolean\n  fractionDecimale?: boolean\n  fractionEgale?: boolean\n  fractionIdentique?: boolean\n  nombreDecimalSeulement?: boolean\n  expressionNumerique?: boolean\n  additionSeulementEtNonResultat?: boolean\n  soustractionSeulementEtNonResultat?: boolean\n  multiplicationSeulementEtNonResultat?: boolean\n  divisionSeulementEtNonResultat?: boolean\n  ensembleDeNombres?: boolean\n  fonction?: boolean\n  kUplet?: boolean\n  seulementCertainesPuissances?: boolean\n  sansExposantUn?: boolean\n  suiteDeNombres?: boolean\n  suiteRangeeDeNombres?: boolean\n  factorisation?: boolean\n  exclusifFactorisation?: boolean\n  nbFacteursIdentiquesFactorisation?: boolean\n  unSeulFacteurLitteral?: boolean\n  HMS?: boolean\n  intervalle?: boolean\n  estDansIntervalle?: boolean\n  ecritureScientifique?: boolean\n  unite?: boolean\n  precisionUnite?: number\n  puissance?: boolean\n  texteAvecCasse?: boolean\n  texteSansCasse?: boolean\n  nombreAvecEspace?: boolean\n  developpementEgal?: boolean\n  egaliteExpression?: boolean\n  calculFormel?: boolean\n  noUselessParen?: boolean\n  nonReponseAcceptee?: boolean\n  pluriels?: boolean\n  multi?: boolean // options pour le drag and drop\n  ordered?: boolean // options pour le drag and drop\n  tolerance?: number\n  variable?: string\n  entier?: boolean\n  domaine?: [number, number]\n}\nexport type CompareFunction = (\n  input: string,\n  goodAnswer: string,\n  options: OptionsComparaisonType,\n) => ResultType\n\ntype CleaningOperation =\n  | 'fractions'\n  | 'fractionsMemesNegatives'\n  | 'virgules'\n  | 'espaces'\n  | 'parentheses'\n  | 'puissances'\n  | 'divisions'\n  | 'latex'\n  | 'foisUn'\n  | 'unites'\n  | 'doubleEspaces'\n  | 'espaceNormal'\n  | 'mathrm'\n\n/**\n * Nettoie la saisie des \\\\dfrac en les remplaant par des \\frac comprises par ComputeEngine\n * @param {string} str\n */\nfunction cleanFractions(str: string): string {\n  return str.replaceAll(/dfrac/g, 'frac')\n}\n\n/**\n * Nettoie la saisie des \\\\frac pour mieux grer les fractions ngatives et que le moins soit toujours au dnominateur\n * Rajout des regex de MD pour grer les fractions ngatives (30/08/2024 : pas de solution directement par ComputeEngine mais ArnoG est sur le coup)\n * Cette fraction est amen  remplacer cleanFractions mais dans le doute (laissons-lui du temps pour vrifier qu'elle ne buggue pas), et pour vexer personne, je la mets en doublon.\n * @param {string} str\n * @author Eric Elter\n */\nfunction cleanFractionsMemesNegatives(str: string): string {\n  // EE :\n  let modif: string\n  modif = str.replaceAll(/dfrac/g, 'frac')\n\n  // regex made by Mathieu Degrange\n  modif = modif.replace(\n    /^-\\\\frac(?:(\\d)(\\d)|{(-?\\d+)}{(-?\\d+)})$/i,\n    (match, p1, p2, p3, p4) =>\n      `\\\\frac{${(p1 || p3) * (p2 || p4) > 0 ? '-' : ''}${Math.abs(p1 || p3)}}{${Math.abs(p2 || p4)}}`,\n  ) // Permet de transformer -\\frac{13}{15} en \\frac{-13}{15} et -\\frac{-13}{15} en \\frac{13}{15}\n\n  modif = modif.replace(\n    /^\\\\frac(?:(\\d)(\\d)|{(-?\\d+)}{(-?\\d+)})$/i,\n    (match, p1, p2, p3, p4) =>\n      `\\\\frac{${(p1 || p3) * (p2 || p4) < 0 ? '-' : ''}${Math.abs(p1 || p3)}}{${Math.abs(p2 || p4)}}`,\n  ) // Permet de transformer \\frac{-13}{-15} en \\frac{13}{15}\n\n  return modif\n}\n\n/**\n * Nettoie la saisie des \\\\div en les remplaant par des / compris par ComputeEngine\n * @param {string} str\n */\nfunction cleanDivisions(str: string): string {\n  return str.replaceAll(/\\\\div/g, '/')\n}\n\n/**\n * Remplace les virgules non chappes par des points.\n * @param {string} str\n * @returns {string}\n */\nfunction replaceUnescapedCommas(str: string): string {\n  return str.replace(/,/g, (match, offset, string) => {\n    // Vrifie si la virgule est prcde d'un antislash\n    if (offset > 0 && string[offset - 1] === '\\\\') {\n      return match // Ne remplace pas la virgule chappe\n    }\n    return '.'\n  })\n} /**\n * Remplace les espaces fins `\\,` par une chane vide.\n * @param {string} str\n * @returns {string}\n */\nfunction replaceThinSpaces(str: string): string {\n  return str.replaceAll(/\\\\,/g, '')\n}\n/**\n *\n * Nettoie la saisie des virgules dcimales en les remplaant par des points.\n * @warning Attention ne fonctionne avec Safari que depuis 2023\n * @param {string} str\n */\nfunction cleanComas(str: string): string {\n  return replaceThinSpaces(replaceUnescapedCommas(str.replaceAll(/\\{,}/g, '.')))\n}\n\n/** Ancien cleanSpaces\n * Nettoie la saisie des espaces\n * @param {string} str\n \nfunction cleanSpaces(str: string): string {\n  return str.replaceAll(/\\s/g, '').replaceAll(/\\\\,/g, '')\n}\n*/\n\n/**\n * Supprime tous les espaces \"classiques\" et les espaces LaTeX d'une chane.\n *\n * Espaces supprims :\n * - Espaces standards (espace, tab, retour ligne, etc.)\n * - `~` (espace inscable LaTeX)\n * - `\\,` (petit espace LaTeX)\n * - `\\:` (espace moyen LaTeX)\n * - `\\;` (espace large LaTeX)\n * - `\\!` (espace ngatif LaTeX)\n * - `\\quad` (espace quad LaTeX)\n * - `\\qquad` (espace double quad LaTeX)\n *\n * @param {string} str - La chane  nettoyer.\n * @returns {string} La chane sans aucun espace ni commande d'espacement LaTeX.\n *\n * @example\n * removeLatexSpaces(\"Hello ~ world\\\\, test \\\\: math \\\\quad fini\");\n * //  \"Helloworldtestmathfini\"\n *\n * @author Eric Elter\n */\nfunction cleanSpaces(str: string): string {\n  const patterns = [\n    /\\s/g, // espaces normaux (tab, retour ligne)\n    /~/g, // espace inscable (~)\n    /\\\\,/g, // petit espace \\,\n    /\\\\:/g, // espace moyen \\:\n    /\\\\;/g, // espace large \\;\n    /\\\\!/g, // espace ngatif \\!\n    /\\\\quad/g, // espace quad\n    /\\\\qquad/g, // espace double quad\n  ]\n\n  for (const regex of patterns) {\n    str = str.replace(regex, '')\n  }\n  return str\n}\n\n/**\n * Rduit les espaces doubles ou triples  de simples espaces mais ne supprime pas les simples espaces\n * supprime aussi les espaces simples en dbut et fin de saisie\n */\nfunction cleanDoubleSpaces(str: string): string {\n  let s = str\n  while (s.includes('  ')) {\n    s = s.replace('  ', ' ')\n  }\n  if (s[0] === ' ') s = s.substring(1, s.length)\n  if (s[s.length - 1] === ' ') s = s.substring(0, s.length - 1)\n  return s\n}\n\n/**\n * Remplace les espaces Latex par des espaces normaux\n * @param {string} str\n */\nfunction cleanEspaceNormal(str: string): string {\n  return str.replaceAll(/\\\\,/g, ' ')\n}\n\n/**\n * Nettoie les parenthses en remplaant par celles supportes par le ComputeEngine\n * @param {string} str\n */\nfunction cleanParentheses(str: string): string {\n  return str\n    .replaceAll(/\\\\lparen(\\+?-?\\d+,?\\.?\\d*)\\\\rparen/g, '($1)')\n    .replaceAll(/\\\\left\\((\\+?-?\\d+)\\\\right\\)/g, '($1)')\n    .replaceAll(/\\\\lparen(\\+?-?\\d+)\\\\rparen/g, '($1)')\n    .replaceAll(/\\\\left\\\\{(.*?)\\\\right\\\\}/g, '\\\\{$1\\\\}')\n    .replaceAll('\\\\lparen', '(')\n    .replaceAll('\\\\rparen', ')')\n    .replaceAll('\\\\left\\\\lbrack', '[')\n    .replaceAll('\\\\right\\\\rbrack', ']')\n    .replaceAll('\\\\right\\\\lbrack', '[')\n    .replaceAll('\\\\left\\\\rbrack', ']')\n    .replaceAll('\\\\left[', '[')\n    .replaceAll('\\\\right]', ']')\n    .replaceAll('\\\\right[', '[')\n    .replaceAll('\\\\left]', ']')\n    .replace(/\\{\\}/g, (match, offset, string) => {\n      // Vrifie si les accolades sont prcdes de ^ ou si elles sont seules dans la chane\n      if (offset > 0 && string[offset - 1] === '^') {\n        return match // Conserve les ^{}\n      }\n      if (string === '{}') {\n        return match // Conserve les chanes uniquement contenant {}\n      }\n      return '' // Remplace les autres occurrences de {}\n    }) // Cela permet de supprimer les doubles accolades vierges sauf :\n  // quand elles sont prcdes de ^ (cette gestion est propre aux puissances)\n  // et que la chaine ne contient que {} (qui serait le cas d'un ensemble vide)\n}\n\nfunction cleanMathRm(str: string): string {\n  return str.replace(/\\\\mathrm\\{(\\w+)}/g, '$1')\n}\n\n/**\n * Nettoie le latex \\text{} mis pour sparer le nombre de l'unit en mode texte\n * @param {string} str\n */\nfunction cleanUnity(str: string): string {\n  return str\n    .replaceAll('}}', '')\n    .replaceAll('{\\\\text{', '')\n    .replaceAll('{\\\\:\\\\text{', '')\n    .replaceAll('}\\\\:}', '')\n}\n\n/**\n * Nettoie tout ce qui peut arriver  l'utilisation des puissances\n * @param {string} str\n */\nfunction cleanPower(str: string): string {\n  return str\n    .replaceAll('', '^2') // '' c'est pas correct en latex !\n    .replaceAll('', '^3') // '' non plus\n    .replaceAll('^{}', '') // les exposants vides, il n'aime pas a non plus\n    .replaceAll('^{^', '^{') // EE : Pour supprimer les puissances de puissances malencontreuses\n}\n\n/**\n * transforme \\text{truc} en truc utiliser cleanUnity si le \\text{} est au milieu de la chaine.\n * @param str\n */\nfunction cleanLatex(str: string): string {\n  const text = str.match(/(\\\\text\\{)(.*)}/)\n  if (text && text?.length > 2) return text[2]\n  return str\n}\n\nfunction cleanMultipliyByOne(str: string): string {\n  if (!str.match(/\\D*1([a-z])/)) return str //  priori, rien  nettoyer ici\n  return str.replace(/(\\D*)1([a-z])/g, '$1$2')\n}\n\nexport function generateCleaner(\n  operations: CleaningOperation[],\n): (str: string) => string {\n  const cleaningFunctions = operations.map((operation) => {\n    switch (operation) {\n      case 'fractions':\n        return cleanFractions\n      case 'fractionsMemesNegatives':\n        return cleanFractionsMemesNegatives\n      case 'virgules':\n        return cleanComas\n      case 'espaces':\n        return cleanSpaces\n      case 'parentheses':\n        return cleanParentheses\n      case 'puissances':\n        return cleanPower\n      case 'mathrm':\n        return cleanMathRm\n      case 'divisions':\n        return cleanDivisions\n      case 'latex':\n        return cleanLatex\n      case 'foisUn':\n        return cleanMultipliyByOne\n      case 'unites':\n        return cleanUnity\n      case 'doubleEspaces':\n        return cleanDoubleSpaces\n      case 'espaceNormal':\n        return cleanEspaceNormal\n      default:\n        throw new Error(`Unsupported cleaning operation: ${operation}`)\n    }\n  })\n\n  return (str: string) => {\n    let cleaned = String(str)\n\n    // Supprimer tous les '_{}' et tous les '^{}'\n    cleaned = cleaned.replaceAll('_{}', '').replaceAll('^{}', '')\n\n    // Appliquer les fonctions de nettoyage\n    return cleaningFunctions.reduce(\n      (result, cleaningFn) => cleaningFn(result),\n      cleaned,\n    )\n  }\n}\n\n/**\n * fonction initialement dans mathlive.js, j'en ai besoin ici, et plus dans mathlive.js\n * @param {string} input la chaine qui contient le nombre avec son unit\n * @return {Grandeur|false} l'objet de type Grandeur qui contient la valeur et l'unit... ou false si c'est pas une grandeur.\n */\nfunction inputToGrandeur(input: string): Grandeur | false {\n  if (input.indexOf('C') > 0) {\n    const split = input.split('C')\n    return new Grandeur(Number.parseFloat(split[0].replace(',', '.')), 'C')\n  }\n  if (input.indexOf('') > 0) {\n    const split = input.split('')\n    return new Grandeur(Number.parseFloat(split[0].replace(',', '.')), '')\n  }\n  if (input.split('operatorname').length !== 2) return false\n  const split = input.split('\\\\operatorname{')\n  const mesure = Number.parseFloat(split[0].replace(',', '.'))\n  if (split[1]) {\n    const split2 = split[1].split('}')\n    const unite = split2[0] + split2[1]\n    return new Grandeur(mesure, unite)\n  }\n  return false\n}\n\n/**\n * Transformation de toute sorte d'expressions factorises (multiply, power, square) en une expression factorise qu'avec multiply o les puissances et les carrs sont rcrits comme des produits explicites.\n * Cette fonction sert pour la fonction de comparaison d'expressions factorises.\n * @param {BoxedExpression} expr\n * @return BoxedExpression\n */\nexport function flatten(expr: BoxedExpression): BoxedExpression {\n  if (expr.operator === 'Multiply') {\n    if (expr.ops == null) {\n      window.notify(\n        'flatten a rencontr un problme avec une multiplication sans oprandes',\n        { expr },\n      )\n      return engine.parse(expr.latex) as BoxedExpression\n    }\n    return engine.box([\n      'Multiply',\n      ...(expr.ops as BoxedExpression[]).map((op) => flatten(op)),\n    ]) as BoxedExpression\n  }\n  const base = ['Power', 'Square'].includes(expr.op1.operator)\n    ? flatten(expr.op1)\n    : expr.op1\n  if (expr.operator === 'Square') {\n    return engine.box(['Multiply', base, base], { canonical: true })\n  }\n  if (expr.operator === 'Power' && expr.op2.operator === 'Number') {\n    const expo = Number(expr.op2.value)\n    const exprs = []\n    for (let i = 0; i < expo; i++) {\n      exprs.push(base)\n    }\n    return engine.box(['Multiply', ...exprs], { canonical: true })\n  }\n  return expr\n}\n\n/**\n * Ici, on considre que les expressions ops1 et ops2 sont factorises et leurs valeurs absolues sont quivalentes mathmatiquement .\n * Cette fonction est un outil de vrification pour sassurer que chaque facteur dans ops1 est bien dans ops2, avec prise en compte du bon signe.\n * Cette fonction sert pour la fonction de comparaison d'expressions factorises.\n * @param {BoxedExpression[]} ops1\n * @param {BoxedExpression[]} ops2\n * @param {boolean} signe // Si true, alors les expresssions sont quivalentes mathmatiquement. Si false, alors les expressions sont opposes.\n * @param {boolean} exclusifFactorisation // Si true, seuls les facteurs identiques (modulo l'ordre) sont considrs gaux.\n * @return ResultType\n */\nfunction allFactorsMatch(\n  ops1: readonly BoxedExpression[],\n  ops2: readonly BoxedExpression[],\n  signe: boolean,\n  exclusifFactorisation = false,\n): ResultType {\n  let signeCurrent = signe\n  let nbMatchOK = 0\n  let nbNonAttendu = 0\n  let allMatch = true\n  for (const op of ops2) {\n    // Les facteurs du second paramtre\n    let match = false\n    for (const op2 of ops1) {\n      // Les facteurs du premier paramtre\n      if (\n        (exclusifFactorisation && op2.isSame(op)) ||\n        (!exclusifFactorisation && op2.isEqual(op))\n      ) {\n        match = true\n        nbMatchOK++\n        break\n      } else if (exclusifFactorisation && !op2.isSame(op) && op2.isEqual(op)) {\n        nbNonAttendu++\n        break\n      }\n      const newOp2 = engine.box(['Subtract', '0', op2.json], {\n        canonical: true,\n      }) // Pour tester avec l'oppos du facteur.\n      if (\n        (exclusifFactorisation && op.isSame(newOp2)) ||\n        (!exclusifFactorisation && op.isEqual(newOp2))\n      ) {\n        signeCurrent = !signeCurrent\n        match = true\n        nbMatchOK++\n        break\n      } else if (\n        exclusifFactorisation &&\n        !op.isSame(newOp2) &&\n        op.isEqual(newOp2)\n      ) {\n        nbNonAttendu++\n        break\n      }\n    }\n    allMatch &&= match\n  }\n\n  if (!allMatch) {\n    if (nbMatchOK > 0)\n      return {\n        isOk: false,\n        feedback:\n          nbMatchOK > 1\n            ? `Seulement $${nbMatchOK}$ facteurs sont corrects.`\n            : `Seulement $${nbMatchOK}$ facteur est correct.`,\n      }\n    if (nbNonAttendu > 0)\n      return {\n        isOk: false,\n        feedback:\n          nbNonAttendu > 1\n            ? `$${nbMatchOK}$ facteurs ne sont pas sous la forme attendue.`\n            : `$${nbMatchOK}$ facteur n'est pas  sous la forme attendue..`,\n      }\n    return { isOk: false, feedback: \"Aucun facteur n'est correct.\" }\n  }\n  return {\n    isOk: signeCurrent,\n    feedback: signeCurrent\n      ? ''\n      : \"L'expression saisie est l'oppos de l'expression attendue.\",\n  }\n}\n\n/**\n * comparaison d'expressions factorises'\n * @param {string} input\n * @param {string} goodAnswer\n * @param {Object} [options={}] - Options pour la comparaison.\n * @param {boolean} [options.exclusifFactorisation=false] // si true, seuls les facteurs (modulo l'ordre) gaux  ceux de goodAnswer seront considrs corrects.\n * @param {boolean} [options.nbFacteursIdentiquesFactorisation=false] // si true, input et goodAnswer sont considrs gaux que s'ils contiennent le mme nombre de facteurs.\n * @param {boolean} [options.unSeulFacteurLitteral=false] // si true, input peut tre factoris et ne contenir qu'un seul facteur littral (les autres sont des nombres)\n * @return ResultType\n * @author Jean-Claude Lhote\n */\nfunction factorisationCompare(\n  input: string,\n  goodAnswer: string,\n  {\n    exclusifFactorisation = false,\n    nbFacteursIdentiquesFactorisation = false,\n    unSeulFacteurLitteral = false,\n  } = {},\n): ResultType {\n  const clean = generateCleaner([\n    'puissances',\n    'virgules',\n    'fractions',\n    'parentheses',\n  ])\n\n  let signe = true\n  const aCleaned = clean(input)\n  if (\n    input.includes('\\\\times1\\\\') ||\n    input.endsWith('\\\\times1') ||\n    input.startsWith('1\\\\times')\n  ) {\n    return { isOk: false, feedback: \"Une factorisation par 1 a peu d'intrt.\" }\n  }\n  const bCleaned = clean(goodAnswer)\n  const saisieParsedInit = engine.parse(aCleaned, { canonical: true })\n  const reponseParsedInit = engine.parse(bCleaned, { canonical: true })\n\n  if (saisieParsedInit == null || reponseParsedInit == null) {\n    window.notify(\n      'factorisationCompare a rencontr un problme en analysant la rponse ou la saisie ',\n      { saisie: input, reponse: goodAnswer },\n    )\n    return { isOk: false }\n  }\n  let saisieHead = saisieParsedInit.operator\n  let answerHead = reponseParsedInit.operator\n  let saisieParsed = saisieParsedInit\n  let reponseParsed = reponseParsedInit\n  if (saisieHead === 'Negate') {\n    // on gre le cas o la saisie commence par le signe moins\n    saisieParsed = saisieParsedInit.op1\n    saisieHead = saisieParsed.operator\n    signe = !signe\n  }\n  if (answerHead === 'Negate') {\n    // on gre le cas o la rponse commence par le signe moins\n    reponseParsed = reponseParsedInit.op1\n    answerHead = reponseParsed.operator\n    signe = !signe\n  }\n\n  // isOk1 atteste que le dveloppement de la saisie et de la reponse attendue sont gales\n  const saisieDev = engine\n    .box(['ExpandAll', saisieParsed])\n    .evaluate()\n    .simplify().canonical\n  const reponseDev = engine\n    .box(['ExpandAll', reponseParsed])\n    .evaluate()\n    .simplify().canonical\n  const isOk1 = saisieDev.isEqual(reponseDev)\n  // const isOk1 = saisieParsedInit.isEqual(reponseParsedInit) // EE : Depuis la version 0.26 de cortexEngine, ce qui prcde devrait tre inutile sauf que (x+5)^2 diffrent de (x+5)(x+5)\n\n  if (!['Multiply', 'Power', 'Square'].includes(saisieHead)) {\n    let feedback = \"L'expression saisie n'est pas factorise\"\n    feedback += isOk1\n      ? \" bien qu'elle soit gale  l'expression attendue.\"\n      : '.'\n    return { isOk: false, feedback }\n  }\n  const reponseFactors = flatten(reponseParsed).ops\n  const saisieFactors = flatten(saisieParsed).ops\n  if (reponseFactors == null) {\n    // EE : Y a aucune raison que ce soit null si l'exercice est bien cod et la rponse fournie dans handleAnswers est correct.\n    window.notify(\n      'factorisationCompare a rencontr un problme en analysant la rponse. ',\n      { reponse: goodAnswer },\n    )\n    return {\n      isOk: false,\n      feedback: 'Un problme a eu lieu lors de la comparaison.',\n    } // EE : Eviter ce genre de feedback car cela ne doit se produire.\n  }\n  if (saisieFactors == null) {\n    // EE : Je ne vois pas quand saisieFactors peut-tre null. Un exemple ?\n    return {\n      isOk: false,\n      feedback: \"L'expression saisie n'a pas le format attendu.\",\n    }\n  }\n  if (nbFacteursIdentiquesFactorisation) {\n    if (saisieFactors.length > reponseFactors.length) {\n      if (isOk1)\n        return {\n          isOk: false,\n          feedback: \"L'expression saisie est trop factorise.\",\n        }\n      return {\n        isOk: false,\n        feedback: \"L'expression saisie a trop de facteurs.\",\n      }\n    } else if (saisieFactors.length < reponseFactors.length) {\n      if (isOk1)\n        return {\n          isOk: false,\n          feedback: \"L'expression saisie peut tre davantage factorise.\",\n        }\n      return {\n        isOk: false,\n        feedback: \"Il manque des facteurs  l'expression saisie.\",\n      }\n    }\n    const result = allFactorsMatch(\n      saisieFactors,\n      reponseFactors,\n      signe,\n      exclusifFactorisation,\n    )\n    if (!result.isOk) return { isOk: false, feedback: `${result.feedback}` }\n\n    const result2 = allFactorsMatch(\n      reponseFactors,\n      saisieFactors,\n      signe,\n      exclusifFactorisation,\n    )\n    return { isOk: result2.isOk, feedback: `${result2.feedback ?? ''}` }\n  }\n\n  if (!isOk1 || exclusifFactorisation) {\n    const result = allFactorsMatch(\n      saisieFactors,\n      reponseFactors,\n      signe,\n      exclusifFactorisation,\n    )\n    if (!result.isOk) return { isOk: false, feedback: `${result.feedback}` }\n\n    const result2 = allFactorsMatch(\n      reponseFactors,\n      saisieFactors,\n      signe,\n      exclusifFactorisation,\n    )\n    return { isOk: result2.isOk, feedback: `${result2.feedback ?? ''}` }\n  }\n  if (isOk1 && unSeulFacteurLitteral) {\n    let nbNumber = 0\n    for (const op of saisieFactors) {\n      if (!isNaN(Number(op.json))) nbNumber++\n    }\n    if (nbNumber === saisieFactors.length - 1)\n      return {\n        isOk: false,\n        feedback: \"L'expression saisie peut tre davantage factorise.\",\n      }\n  }\n  return { isOk: true }\n}\n\n/**\n * comparaison de dures\n * @param {string} input\n * @param {string} goodAnswer\n * @return ResultType\n * @author Jean-Claude Lhote\n */\nfunction hmsCompare(input: string, goodAnswer: string): ResultType {\n  const clean = generateCleaner(['unites'])\n  const cleanInput = clean(input)\n  const inputHms = Hms.fromString(cleanInput)\n  const goodAnswerHms = Hms.fromString(goodAnswer)\n  return { isOk: goodAnswerHms.isTheSame(inputHms) }\n}\n\nengine.latexDictionary = [\n  ...engine.latexDictionary.filter((x) => x.name !== 'Subtract'),\n  {\n    ...(engine.latexDictionary.find(\n      (x) => x.name === 'Subtract',\n    ) as unknown as LatexDictionaryEntry),\n    parse: (parser: Parser, lhs: Expression, terminator: ParseLatexOptions) => {\n      // Reculer d'un jeton : nous allons analyser le '-' comme faisant partie du rhs afin de\n      // pouvoir conserver l'expression en tant que 'Add'.\n      parser.index -= 1\n      const rhs = parser.parseExpression({ ...terminator, minPrec: 275 + 3 })\n      return ['Add', lhs, rhs]\n    },\n  } as unknown as LatexDictionaryEntry, // Conversion en 'unknown' puis en 'LatexDictionaryEntry'\n]\n\n// Pour viter que G en Latex soit pris pour CatalanConstant\nengine.latexDictionary = [\n  ...engine.latexDictionary,\n  { identifierTrigger: 'G', name: 'G' } as LatexDictionaryEntry,\n]\n\n/****************************************************************************************************\n *\n *                  C'est la fonction, ci-dessous, la future fonction couteauSuisse\n *                            qu'il faudra nommer fonctionComparaison ?\n *\n ****************************************************************************************************/\n/**\n * comparaison gnrique : notre couteau suisse\n * @param {string} input\n * @param {string} goodAnswer\n /**\n * @param {{\n *   expressionsForcementReduites: boolean,\n *   avecSigneMultiplier: boolean,\n *   avecFractions: boolean,\n *   sansTrigo;boolean,\n *   fractionIrreductible: boolean,\n *   fractionSimplifiee: boolean,\n *   fractionReduite: boolean,\n *   fractionDecimale: boolean,\n *   fractionEgale: boolean,\n *   fractionIdentique : boolean,\n *   nombreDecimalSeulement: boolean,\n *   expressionNumerique: boolean,\n *   additionSeulementEtNonResultat: boolean,\n *   soustractionSeulementEtNonResultat:boolean,\n *   multiplicationSeulementEtNonResultat:boolean,\n *   divisionSeulementEtNonResultat:boolean,\n *   HMS: boolean,\n *   intervalle: boolean,\n *   estDansIntervalle: boolean,\n *   ecritureScientifique: boolean,\n *   unite: boolean,\n *   precisionUnite: number,\n *   ensembleDeNombres: boolean,\n *   kUplet: boolean,\n *   suiteDeNombres,\n *   suiteRangeeDeNombres,\n *   puissance: boolean,\n *   seulementCertainesPuissances: boolean,\n *   sansExposantUn: boolean,\n *   factorisation: boolean,\n *   exclusifFactorisation: boolean,\n *   nbFacteursIdentiquesFactorisation: boolean,\n *   unSeulFacteurLitteral,\n *   developpementEgal,\n *   puissance: boolean,\n *   texteAvecCasse: boolean,\n *   texteSansCasse: boolean\n * }} [options]\n * @author Eric Elter\n * @return ResultType\n */\nexport function fonctionComparaison(\n  input: string,\n  goodAnswer: string,\n  {\n    expressionsForcementReduites,\n    avecSigneMultiplier,\n    avecFractions,\n    sansTrigo,\n    fractionIrreductible, // Document\n    fractionSimplifiee, // Document\n    fractionReduite, // Document\n    fractionDecimale, // Document\n    fractionEgale, // Document\n    fractionIdentique, // Document\n    nombreDecimalSeulement, // Document\n    expressionNumerique, // Non Document\n    additionSeulementEtNonResultat, // Document\n    soustractionSeulementEtNonResultat, // Document\n    multiplicationSeulementEtNonResultat, // Document\n    divisionSeulementEtNonResultat, // Document\n    ensembleDeNombres, // Document\n    fonction,\n    kUplet, // Document\n    suiteDeNombres, // Document\n    suiteRangeeDeNombres, // Document\n    puissance, // Document\n    seulementCertainesPuissances, // Document\n    sansExposantUn, // Document\n    factorisation, // Document\n    exclusifFactorisation, // Document\n    nbFacteursIdentiquesFactorisation, // Document\n    unSeulFacteurLitteral, // Document\n    HMS, // Document\n    developpementEgal,\n    intervalle,\n    estDansIntervalle,\n    ecritureScientifique, // Document\n    unite,\n    precisionUnite,\n    texteAvecCasse,\n    texteSansCasse,\n    nombreAvecEspace,\n    egaliteExpression,\n    calculFormel, // Document\n    nonReponseAcceptee,\n    variable,\n    entier,\n    domaine,\n  }: OptionsComparaisonType = {\n    expressionsForcementReduites: true,\n    avecSigneMultiplier: true,\n    avecFractions: true,\n    sansTrigo: false,\n    fractionIrreductible: false,\n    fractionSimplifiee: false,\n    fractionReduite: false,\n    fractionDecimale: false,\n    fractionEgale: false,\n    fractionIdentique: false,\n    nombreDecimalSeulement: false,\n    expressionNumerique: false,\n    additionSeulementEtNonResultat: false,\n    soustractionSeulementEtNonResultat: false,\n    multiplicationSeulementEtNonResultat: false,\n    divisionSeulementEtNonResultat: false,\n    ensembleDeNombres: false,\n    fonction: false,\n    kUplet: false,\n    seulementCertainesPuissances: false,\n    sansExposantUn: false,\n    suiteDeNombres: false,\n    suiteRangeeDeNombres: false,\n    factorisation: false,\n    exclusifFactorisation: false,\n    nbFacteursIdentiquesFactorisation: false,\n    unSeulFacteurLitteral: false,\n    HMS: false,\n    developpementEgal: false,\n    intervalle: false,\n    estDansIntervalle: false,\n    ecritureScientifique: false,\n    unite: false,\n    precisionUnite: 0,\n    puissance: false,\n    texteAvecCasse: false,\n    texteSansCasse: false,\n    nombreAvecEspace: false,\n    egaliteExpression: false,\n    calculFormel: false,\n    nonReponseAcceptee: false,\n    variable: 'x',\n    entier: false,\n    domaine: [-100, 100],\n  },\n): ResultType {\n  // nonReponseAcceptee = true permet d'avoir des champs vides (on pense aux fillInTheBlank qui peuvent tre facultatifs, comme par exemple un facteur 1)\n  // si false (valeur par dfaut ou si non prcise) alors une rponse vide entrane isOk = false et un feedback pour notifier l'absence de rponse\n  if (nonReponseAcceptee) {\n    if (input === '' && goodAnswer === '') return { isOk: true }\n    return { isOk: false, feedback: 'Une rponse doit tre saisie' }\n  }\n  if (input === '') {\n    return { isOk: false, feedback: 'Une rponse doit tre saisie' }\n  }\n  // ici, on met tous les tests particuliers (HMS, intervalle)\n  // if (HMS) return comparaisonExpressions(input, goodAnswer)\n  if (HMS) return hmsCompare(input, goodAnswer)\n  if (fonction)\n    return functionCompare(input, goodAnswer, {\n      variable: variable ?? 'x',\n      domaine: domaine ?? [-100, 100],\n      entier: entier ?? false,\n    })\n  if (intervalle) return intervalsCompare(input, goodAnswer)\n  if (estDansIntervalle) return intervalCompare(input, goodAnswer)\n  if (ecritureScientifique) return scientifiqueCompare(input, goodAnswer)\n  if (unite) {\n    return unitsCompare(input, goodAnswer, { precision: precisionUnite })\n  }\n  if (\n    factorisation ||\n    exclusifFactorisation ||\n    nbFacteursIdentiquesFactorisation ||\n    unSeulFacteurLitteral\n  )\n    return factorisationCompare(input, goodAnswer, {\n      exclusifFactorisation,\n      nbFacteursIdentiquesFactorisation,\n      unSeulFacteurLitteral,\n    })\n  if (puissance || seulementCertainesPuissances || sansExposantUn)\n    return comparaisonPuissances(input, goodAnswer, {\n      seulementCertainesPuissances,\n      sansExposantUn,\n    })\n  if (texteAvecCasse) return texteAvecCasseCompare(input, goodAnswer)\n  if (texteSansCasse) return texteSansCasseCompare(input, goodAnswer)\n  if (egaliteExpression) return egaliteCompare(input, goodAnswer)\n  if (nombreAvecEspace) return numberWithSpaceCompare(input, goodAnswer)\n  if (expressionNumerique) return expressionNumeriqueCompare(input, goodAnswer)\n  if (ensembleDeNombres || kUplet)\n    return ensembleNombres(input, goodAnswer, { kUplet }) // ensembleDeNombres est non tri alors que kUplet ncessite le tri\n  if (suiteDeNombres || suiteRangeeDeNombres)\n    return ensembleNombres(input, goodAnswer, {\n      kUplet: suiteRangeeDeNombres,\n      avecAccolades: false,\n    })\n  if (\n    fractionSimplifiee ||\n    fractionReduite ||\n    fractionIrreductible ||\n    fractionDecimale ||\n    fractionEgale ||\n    fractionIdentique\n  )\n    return comparaisonFraction(input, goodAnswer, {\n      fractionReduite,\n      fractionIrreductible,\n      fractionDecimale,\n      fractionEgale,\n      fractionIdentique,\n      nombreDecimalSeulement,\n    }) // feedback OK\n  if (developpementEgal) return ontDeveloppementsEgaux(input, goodAnswer)\n\n  // Ici, c'est la comparaison par dfaut qui fonctionne dans la trs grande majorit des cas\n  return expressionDeveloppeeEtReduiteCompare(input, goodAnswer, {\n    expressionsForcementReduites,\n    avecSigneMultiplier,\n    avecFractions,\n    sansTrigo,\n    fractionIrreductible,\n    additionSeulementEtNonResultat,\n    soustractionSeulementEtNonResultat,\n    multiplicationSeulementEtNonResultat,\n    divisionSeulementEtNonResultat,\n    nombreDecimalSeulement,\n    calculFormel,\n  })\n}\n\n/**\n * Cette fonction permet que ComputeEngine fasse un super job avec la rduction d'expression et avec des options supplmentaires\n * @param {BoxedExpression} expr\n * @param {{\n *   expressionsForcementReduites: boolean,\n *   fractionIrreducibleSeulement: boolean,\n *   nombreDecimalSeulement: boolean,\n * }} [options]\n * @author Eric Elter (aid par ArnoG)\n * @return BoxedExpression\n */\nfunction customCanonical(\n  expr: BoxedExpression,\n  {\n    expressionsForcementReduites = true,\n    fractionIrreductible = false, // SANS DOUTE INUTILE MAINTENANT. A VERIFIER\n    nombreDecimalSeulement = false,\n  } = {},\n): BoxedExpression {\n  let expression = expr\n  if (nombreDecimalSeulement) {\n    // Fonctionnement : On retourne le calcul\n    return expression\n  }\n  // Fonctionnement par dfaut : Tout est accept si l'expression est un nombre\n  // Ci-dessous, on accepte le rsultat d'un calcul mais pas un autre enchanement Ici, si 4+2 est attendu, alors 4+2=6 mais 4+2!=5+1. C'est la valeur par dfaut\n  if (typeof expression.value === 'number') {\n    // L'expression est une expression numrique, les expressions littrales ne sont pas traites ici\n    if (fractionIrreductible) {\n      if (\n        (expression.operator === 'Divide' ||\n          expression.operator === 'Rational') && // L'expression contient une division ou une fraction fractionIrreductible\n        (expression.engine.box(['GCD', expression.op1, expression.op2])\n          .value !== 1 ||\n          expression.op2.value === 1)\n      )\n        return expression\n\n      if (expression.operator === 'Number') {\n        // Ce cas est si un lve note 1.4 pour une fraction de 7/5 par exemple.\n        return engine.parse(`\\\\frac{${expression.value}}{1}`, {\n          canonical: false,\n        })\n      }\n    }\n    return expression.engine.number(expression.value)\n  }\n  /* Supprim depuis la cration de expressionNumerique\n  if (expressionsForcementReduites) {\n    // Ici, le traitement n'est fait que pour des expressions forcment rduites\n    // Ci-dessous, on accepte que l'enchanement propos et pas le rsultat. Ici, si 4+2 est attendu, alors4+2!=6 et 4+2!=5+1\n    if (\n      (expression.operator === 'Divide' ||\n        expression.operator === 'Rational') &&\n      typeof expression.value === 'number'\n    ) {\n      if (fractionIrreductible) {\n        if (\n          expression.engine.box(['GCD', expression.op1, expression.op2])\n            .value !== 1 ||\n          expression.op2.value === 1\n        ) {\n          return expression\n        }\n      }\n      return expression.engine.number(expression.value)\n    }\n  }\n  */\n  if (expression.operator === 'Divide' || expression.operator === 'Rational') {\n    // Pour enlever les divisions ventuelles par 1\n    if (expression.op2.value === 1) expression = expression.op1\n  }\n\n  // Ne pas prendre en compte les indices comme c_{n} // Sans doute plus du tout utile depuis l'introduction de l'option calculFormel\n  if (expression.operator !== 'Subscript')\n    if (expression.ops) {\n      // Pour ne pas accepter les +0, les \\\\times1, pour ne pas se soucier de l'ordre\n      return expression.engine.box(\n        [\n          expression.operator,\n          ...expression.ops.map((x) =>\n            customCanonical(x, {\n              expressionsForcementReduites,\n              fractionIrreductible,\n              nombreDecimalSeulement,\n            }),\n          ),\n        ],\n        { canonical: ['InvisibleOperator', 'Order', 'Flatten'] },\n      )\n    }\n  return expression.canonical\n}\n\n/**\n * @param {string} input\n * @param {string} goodAnswer\n * @author Eric Elter\n * @return ResultType\n */\n\nfunction comparaisonFraction(\n  input: string,\n  goodAnswer: string,\n  {\n    fractionReduite = false,\n    fractionIrreductible = false,\n    fractionDecimale = false,\n    fractionEgale = false,\n    fractionIdentique = false,\n    nombreDecimalSeulement = false,\n  } = {},\n): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    // 'fractions'\n    'fractionsMemesNegatives',\n  ])\n\n  const cleanIput = clean(input)\n  const cleanGoodAnswer = clean(goodAnswer)\n  const saisieNativeParsed = engine.parse(cleanIput, { canonical: false })\n  const reponseNativeParsed = engine.parse(cleanGoodAnswer, {\n    canonical: false,\n  })\n  // if (nombreDecimalSeulement) { console.log(reponseNativeParsed.toLatex(), reponseNativeParsed.N().toString()) }\n  if (nombreDecimalSeulement) {\n    if (\n      expressionDeveloppeeEtReduiteCompare(\n        cleanIput,\n        reponseNativeParsed.N().toString(),\n        { nombreDecimalSeulement: true },\n      ).isOk\n    ) {\n      return { isOk: true, feedback: '' }\n    }\n    // if (!(reponseNativeParsed.operator === 'Number' || (reponseNativeParsed.operator === 'Negate' && reponseNativeParsed.ops !== null && reponseNativeParsed.ops.length === 1))) return { isOk: false, feedback: 'Rsultat incorrect car une valeur dcimale (ou entire) est attendue.' }\n  }\n\n  const reponseParsed = reponseNativeParsed.engine.number(\n    Number(reponseNativeParsed.value),\n  ) // Ici, c'est la valeur numrique (mme approche) de cleanGoodAnswer.\n  if (saisieNativeParsed.isEqual(reponseNativeParsed)) {\n    if (fractionIdentique) {\n      if (saisieNativeParsed.isSame(reponseNativeParsed))\n        return { isOk: true, feedback: '' }\n      return {\n        isOk: false,\n        feedback: 'Le rsultat ne correspond pas  la fraction attendue.',\n      }\n    }\n    if (saisieNativeParsed.operator === 'Number' && reponseParsed.isInteger) {\n      // rponse est gale  un entier et saisie est un nombre entier (2) ou dcimal (2.0).\n      return { isOk: true }\n    }\n    if (fractionEgale) {\n      if (\n        saisieNativeParsed.operator === 'Divide' ||\n        saisieNativeParsed.operator === 'Rational' ||\n        (saisieNativeParsed.operator === 'Negate' &&\n          (saisieNativeParsed.op1.operator === 'Divide' ||\n            saisieNativeParsed.op1.operator === 'Rational'))\n      ) {\n        // saisie doit tre une fraction (ou une division)\n        // reponse doit avoir des numrateur/dnominateur multiples de ceux de saisie ou bien fractionReduite est true\n        let num, den\n        if (saisieNativeParsed.operator !== 'Negate') {\n          // Traitement des cas si la fraction est ngative ou pas.\n          num = saisieNativeParsed.op1.evaluate().numericValue\n          den = saisieNativeParsed.op2.evaluate().numericValue\n        } else {\n          num = saisieNativeParsed.op1.op1.evaluate().numericValue\n          den = saisieNativeParsed.op1.op2.evaluate().numericValue\n        }\n        if (Number.isInteger(num) && Number.isInteger(den)) {\n          return { isOk: true }\n        }\n        return {\n          isOk: false,\n          feedback:\n            'Rsultat incorrect car dnominateur et numrateur doivent tre entiers.',\n        }\n      }\n      return {\n        isOk: false,\n        feedback: 'Rsultat incorrect car une fraction est attendue.',\n      }\n    }\n    if (fractionDecimale) {\n      if (\n        (saisieNativeParsed.operator === 'Divide' ||\n          saisieNativeParsed.operator === 'Rational') &&\n        Number.isInteger(Math.log10(Number(saisieNativeParsed.op2.value))) &&\n        Math.log10(Number(saisieNativeParsed.op2.value)) >= 0\n      ) {\n        if (!saisieNativeParsed.op1.isInteger)\n          return {\n            isOk: false,\n            feedback: \"Rsultat incorrect car le numrateur n'est pas entier.\",\n          }\n        return { isOk: true }\n      }\n      return {\n        isOk: false,\n        feedback: 'Rsultat incorrect car une fraction dcimale est attendue.',\n      } // Sous-entendu : Et pas une autre fraction qu'irrductible\n    }\n    if (fractionIrreductible) {\n      if (\n        ((saisieNativeParsed.operator === 'Divide' ||\n          saisieNativeParsed.operator === 'Rational') &&\n          saisieNativeParsed.engine.box([\n            'GCD',\n            saisieNativeParsed.op1,\n            saisieNativeParsed.op2,\n          ]).value === 1) ||\n        saisieNativeParsed.canonical.isInteger\n      ) {\n        return { isOk: true }\n      }\n      return {\n        isOk: false,\n        feedback:\n          'Rsultat incorrect car une fraction irrductible est attendue.',\n      } // Sous-entendu : Et pas une autre fraction qu'irrductible\n    }\n    if (\n      (saisieNativeParsed.operator === 'Divide' ||\n        saisieNativeParsed.operator === 'Rational') && // saisie doit tre une fraction (ou une division)\n      Math.abs(Number(saisieNativeParsed.op1.value)) <\n        Math.abs(Number(reponseNativeParsed.op1.value)) && // saisie doit avoir des numrateur/dnominateur plus petits que reponse. Les valeurs absolues grent le cas des fractions ngatives.\n      saisieNativeParsed.op1.isInteger &&\n      saisieNativeParsed.op2.isInteger && // saisie doit avoir des numrateur/dnominateur entiers\n      (fractionReduite ||\n        Number(reponseNativeParsed.op1.value) %\n          Number(saisieNativeParsed.op1.value) ===\n          0)\n    ) {\n      // reponse doit avoir des numrateur/dnominateur multiples de ceux de saisie ou bien fractionReduite est true\n      return { isOk: true }\n      /// Ci-dessous : le traitement des feedback : les saisies sont gales aux rponses mais la saisie ne convient tout de mme pas.\n    }\n    if (!saisieNativeParsed.op1.value && !reponseParsed.isInteger) {\n      // Si pas de op1.value, c'est que saisie est un nombre alors que reponse n'est pas entier.\n      return {\n        isOk: false,\n        feedback: 'Rsultat incorrect car une fraction est attendue.',\n      } // Sous-entendu : Et pas un nombre\n    }\n    if (\n      saisieNativeParsed.operator === 'Divide' ||\n      saisieNativeParsed.operator === 'Rational'\n    ) {\n      if (\n        Math.abs(Number(saisieNativeParsed.op1.value)) >=\n        Math.abs(Number(reponseNativeParsed.op1.value))\n      ) {\n        return {\n          isOk: false,\n          feedback:\n            'Rsultat incorrect car une fraction simplifie est attendue.',\n        } // Sous-entendu : Et pas numrateur/dnominateur plus grands ou gaux que reponse.  Les valeurs absolues grent le cas des fractions ngatives.\n      }\n      if (\n        !saisieNativeParsed.op1.isInteger ||\n        !saisieNativeParsed.op2.isInteger\n      ) {\n        return {\n          isOk: false,\n          feedback:\n            'Rsultat incorrect car dnominateur et numrateur doivent tre entiers.',\n        } // Sous-entendu : Et pas numrateur/dnominateur dcimaux pour au moins l'un d'entre eux\n      }\n      // if (reponseNativeParsed.op1.value % saisieNativeParsed.op1.value !== 0) {\n      return {\n        isOk: false,\n        feedback: 'Rsultat incorrect car une fraction rduite est attendue.',\n      } // Sous-entendu : Et pas numrateur/dnominateur de reponse non multiples de ceux de saisie\n    }\n    return {\n      isOk: false,\n      feedback: 'Rsultat incorrect car une fraction est attendue.',\n    } // Sous-entendu : Et pas une opration autre qu'une division\n  }\n  return { isOk: false, feedback: 'Rsultat incorrect.' }\n}\n\n// Dfinir le type pour les substitutions\ntype Substitutions = { [variable: string]: number }\n\n/**\n * Comparaison d'expressions developpes ET REDUITES (multiplications acceptes, fractions acceptes... PAS ENCORE AVEC DES RACINES CARREES mais cela arrive.)\n * Comparaison aussi de tous les nombres (puisque c'est une expression rduite particulire)\n * On peut paramtrer si :\n * - on accepte ou pas les signes multiplier dans ces expressions,\n * - on accepte ou pas les fractions,\n * - on accepte ou pas les fractions irrductibles seulement (ou les entiers si den = 1),\n * - on n'accepte que l'enchanement de calculs fourni en goodAnswer et non le rsultat de cet enchanement de calculs\n * @param {string} input\n * @param {string} goodAnswer\n * @param {{expressionsForcementReduites:boolean, avecSigneMultiplier:boolean, avecFractions:boolean, sansTrigo:boolean, fractionIrreducibleSeulement:boolean, nombreDecimalSeulement:boolean}} [options]\n * @author Eric Elter\n * @return ResultType\n */\n\nfunction expressionDeveloppeeEtReduiteCompare(\n  input: string,\n  goodAnswer: string,\n  {\n    expressionsForcementReduites = true,\n    avecSigneMultiplier = true,\n    avecFractions = true,\n    sansTrigo = false,\n    fractionIrreductible = false,\n    nombreDecimalSeulement = false,\n    additionSeulementEtNonResultat = false,\n    soustractionSeulementEtNonResultat = false,\n    multiplicationSeulementEtNonResultat = false,\n    divisionSeulementEtNonResultat = false,\n    calculFormel = false,\n  } = {},\n): ResultType {\n  let feedback = ''\n  // Ces 2 lignes sont  amliorer... EE : Faut que je teste un truc... et rajouter les racines carres aussi\n  if (!avecSigneMultiplier && input.includes('times'))\n    return { isOk: false, feedback: \"Aucun signe $\\\\times$ n'est autoris.\" }\n  if (!avecFractions && input.includes('frac'))\n    return { isOk: false, feedback: \"Aucune fraction n'est autorise.\" }\n  if (\n    sansTrigo &&\n    (input.includes('cos') || input.includes('sin') || input.includes('tan'))\n  )\n    return {\n      isOk: false,\n      feedback: \"Aucune fonction trigonomtrique n'est autorise.\",\n    }\n\n  const clean = generateCleaner([\n    'puissances',\n    'virgules',\n    // 'fractions',\n    'fractionsMemesNegatives',\n    'parentheses',\n    'foisUn',\n  ])\n  let localInput = clean(input)\n  const localGoodAnswer = clean(goodAnswer)\n  if (calculFormel)\n    if (\n      engine\n        .parse(localInput, { canonical: false })\n        .isEqual(engine.parse(localGoodAnswer, { canonical: false }))\n    )\n      return { isOk: true, feedback: '' }\n    else\n      return {\n        isOk: false,\n        feedback: \"L'expresssion fournie est incorrecte.\",\n      }\n\n  if (nombreDecimalSeulement) {\n    localInput = localInput\n      .replace('(', '')\n      .replace(')', '')\n      .replace('\\\\lparen', '')\n      .replace('\\\\rparen', '') // Utile pour 5R20\n    const saisieParsed = engine.parse(localInput, { canonical: false })\n    if (\n      !(\n        saisieParsed.operator === 'Number' ||\n        (saisieParsed.operator === 'Negate' &&\n          saisieParsed.ops !== null &&\n          saisieParsed.ops.length === 1)\n      )\n    )\n      return {\n        isOk: false,\n        feedback:\n          'Rsultat incorrect car une valeur dcimale (ou entire) est attendue.',\n      }\n  }\n  const saisieParsed = customCanonical(\n    engine.parse(localInput, { canonical: false }),\n    {},\n  )\n\n  const reponseParsed = customCanonical(\n    engine.parse(localGoodAnswer, { canonical: false }),\n    {},\n  )\n\n  /* console.info(\n    JSON.stringify(engine.parse(localInput, { canonical: false }).json),\n  )\n  console.info(\n    JSON.stringify(engine.parse(localGoodAnswer, { canonical: false }).json),\n  )\n*/\n  /// Code JCL\n  // Ci-dessous, si on a une comparaison fausse mais que l'expression donne est mathmatiquement correcte, on fait un feedback.\n  const substitutions: Substitutions = { a: 2, b: 2, c: 2, x: 2, y: 2, z: 2 } // On peut ajouter d'autres variables si ncessaire\n\n  if (\n    additionSeulementEtNonResultat ||\n    soustractionSeulementEtNonResultat ||\n    multiplicationSeulementEtNonResultat ||\n    divisionSeulementEtNonResultat\n  ) {\n    const parsedExpression = engine.parse(localInput, { canonical: false })\n    if (\n      parsedExpression.operator === 'Add' &&\n      (parsedExpression.op1.is(0) || parsedExpression.op2.is(0))\n    ) {\n      feedback = 'Rsultat incorrect car la somme par 0 est inutile.' // Sous-entendu : Pas de '+0'\n      return { isOk: false, feedback }\n    }\n    if (input.includes('-0')) {\n      feedback = 'Rsultat incorrect car la diffrence par 0 est inutile.' // Sous-entendu : Pas de '-0'\n      return { isOk: false, feedback }\n    }\n    if (\n      parsedExpression.operator === 'Multiply' &&\n      (parsedExpression.op1.is(1) || parsedExpression.op2.is(1))\n    ) {\n      feedback = 'Rsultat incorrect car le produit par 1 est inutile.' // Sous-entendu : Pas de 'fois 1'\n      return { isOk: false, feedback }\n    }\n    if (\n      (parsedExpression.operator === 'Divide' ||\n        parsedExpression.operator === 'Rational') &&\n      parsedExpression.op2.is(0)\n    ) {\n      feedback = 'Rsultat incorrect car la division par 1 est inutile.' // Sous-entendu : Pas de 'divis par 1'\n      return { isOk: false, feedback }\n    }\n  }\n\n  if (\n    saisieParsed.isEqual(reponseParsed) &&\n    !saisieParsed.isSame(reponseParsed)\n  ) {\n    if (\n      additionSeulementEtNonResultat ||\n      soustractionSeulementEtNonResultat ||\n      multiplicationSeulementEtNonResultat ||\n      divisionSeulementEtNonResultat\n    ) {\n      const saisieCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible,\n          nombreDecimalSeulement,\n        },\n      )\n      const reponseCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible,\n        },\n      )\n      if (saisieCalculeeParsed.isSame(reponseCalculeeParsed)) {\n        if (additionSeulementEtNonResultat && saisieParsed.operator === 'Add')\n          // Todo : On a, ici, un pb. Si on attend 3+2, alors 6-1 sera accept. Et on ne peut pas exclure le '-' car 6+(-1) serait correct\n          // 26/08/2025 : Pb dans les mains de @ArnoG qui ne sait pas encore commment le rgler.\n          return { isOk: true, feedback: '' }\n        if (\n          multiplicationSeulementEtNonResultat &&\n          (saisieParsed.operator === 'Multiply' ||\n            saisieParsed.operator === 'Power')\n        )\n          return { isOk: true, feedback: '' }\n        if (\n          divisionSeulementEtNonResultat &&\n          (saisieParsed.operator === 'Divide' ||\n            saisieParsed.operator === 'Power')\n        )\n          return { isOk: true, feedback: '' }\n\n        // Ce code ci-dessous dans l'absolu devrait fonctionner sauf que parse transforme une soustraction en une addition : 6-3=6+(-3)\n        // if (soustractionSeulementEtNonResultat && saisieParsed.operator === 'Substract') return { isOk: true, feedback: '' }\n\n        // Donc par rapport  ce qui est au-dessus, il faut chercher l'absence d'un dlimiter devant le -.\n        // console.info(JSON.stringify(ce.parse('12+(-2)', { canonical: false }).json));\n        // -> [\"Add\",12,[\"Delimiter\",[\"Negate\",2]]]\n        // console.info(JSON.stringify(ce.parse('12-2', { canonical: false }).json));\n        // -> [\"Add\",12,[\"Negate\",2]]\n\n        // Il faut en plus que le negate soit devant le Delimiter sinon 3+(-2) serait accept comme soustraction pour 3-2.\n        const saisieJSON = JSON.stringify(\n          engine.parse(localInput, { canonical: false }).json,\n        )\n        function negateBeforeDelimiter(node: string): boolean {\n          const iNeg = node.indexOf('Negate')\n          const iDel = node.indexOf('Delimiter')\n          return iNeg !== -1 && (iDel === -1 || iNeg < iDel)\n        }\n\n        // Todo : On a, ici, encore un pb. Si on attend 3-2, alors 3+-2 et 3-+2 seront accepts.\n        // 26/08/2025 : Pb dans les mains de @ArnoG qui ne sait pas encore commment le rgler.\n\n        if (\n          soustractionSeulementEtNonResultat &&\n          negateBeforeDelimiter(saisieJSON)\n        ) {\n          return { isOk: true, feedback: '' }\n        }\n      }\n    }\n  }\n  if (!saisieParsed.isSame(reponseParsed)) {\n    // On va essayer de traiter ici tous les feedbacks de faon exhaustive\n    if (nombreDecimalSeulement) {\n      // On veut un rsultat numrique et pas un enchanement de calculs\n      const saisieCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible,\n          nombreDecimalSeulement: false,\n        },\n      )\n\n      if (saisieCalculeeParsed.isSame(reponseParsed))\n        feedback = 'Rsultat incorrect car une valeur numrique est attendue.' // Sous-entendu : Et pas une opration\n      else feedback = 'Rsultat incorrect.'\n    } else if (\n      additionSeulementEtNonResultat ||\n      soustractionSeulementEtNonResultat ||\n      multiplicationSeulementEtNonResultat ||\n      divisionSeulementEtNonResultat\n    ) {\n      // On veut un enchanement de calculs et pas un rsultat numrique\n      const saisieCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible,\n          nombreDecimalSeulement,\n        },\n      )\n      const reponseCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible,\n        },\n      )\n      if (saisieCalculeeParsed.isSame(reponseCalculeeParsed)) {\n        if (saisieParsed.operator === 'Number') {\n          feedback = 'Rsultat incorrect car un calcul est attendu.' // Sous-entendu : Et pas une valeur numrique\n        } else {\n          feedback = 'Rsultat incorrect car '\n          feedback += additionSeulementEtNonResultat\n            ? \"c'est une somme qui est attendue.\"\n            : soustractionSeulementEtNonResultat\n              ? \"c'est une diffrence qui est attendue.\"\n              : multiplicationSeulementEtNonResultat\n                ? \"c'est un produit qui est attendu.\"\n                : divisionSeulementEtNonResultat\n                  ? \"c'est un quotient qui est attendu.\"\n                  : \"ce n'est pas ce calcul qui est attendu.\" // Sous-entendu : La bonne opration */\n        }\n      } else feedback = 'Rsultat incorrect.'\n    } else if (fractionIrreductible) {\n      // On veut une fraction irrductible\n      const saisieCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible: false,\n        },\n      )\n      const reponseCalculeeParsed = customCanonical(\n        engine.parse(localInput, { canonical: false }),\n        {\n          expressionsForcementReduites,\n          fractionIrreductible: false,\n        },\n      )\n      if (saisieCalculeeParsed.isSame(reponseCalculeeParsed)) {\n        // Ci-dessous, ce n'est pas saisieParsed car saisieParsed n'est jamais un nombre  cause de customCanonical et fractionIrreductible.\n        if (\n          engine.parse(localInput, { canonical: false }).operator === 'Number'\n        )\n          feedback = 'Rsultat incorrect car une fraction est attendue.' // Sous-entendu : Et pas une valeur numrique\n        else\n          feedback =\n            'Rsultat incorrect car une fraction irrductible est attendue.' // Sous-entendu : La bonne opration\n      } else feedback = 'Rsultat incorrect.'\n    } else if (\n      // Code JCL. ---> EE : Ce code renvoie un feebback incorrect si input = (-5)^n \\\\times (-8) et goodAnswer = -8 \\\\times (-5)^n. Dommage ! Je laisse ce code car s'il est l, c'est qu'il doit tre utile  un moment. Pas encore compris lequel.\n      !saisieParsed.isSame(reponseParsed) &&\n      evaluateExpression(localGoodAnswer, substitutions) ===\n        evaluateExpression(localInput, substitutions)\n    ) {\n      feedback = 'Incorrect'\n      /* Ce feedback ne devrait fonctionner que si on a des expressions littrales mais actuellement, ce n'est pas le cas donc on l'enlve provisoirement\n      // Ajout d'un test sur goodAnswer pour vrifier la prsence de lettres (aprs avoir retir les div, times, frac...)\n  const adjectif =\n    localGoodAnswer\n      .replaceAll('div', '')\n      .replaceAll('times', '')\n      .replaceAll('frac', '')\n      .replaceAll('log', '')\n      .replaceAll('ln', '')\n      .replaceAll('sin', '')\n      .replaceAll('cos', '')\n      .replaceAll('tan', '')\n      .match(/[a-z]/) == null\n      ? 'numrique'\n      : 'littrale'\nfeedback = expressionsForcementReduites\n        ? `L'expression ${adjectif} attendue devrait tre dveloppe et rduite or ce n'est pas le cas.`\n        : `L'expression ${adjectif} attendue devrait tre simplement dveloppe or ce n'est pas le cas.`\n      */\n    }\n  }\n  return { isOk: saisieParsed.isSame(reponseParsed), feedback }\n}\n\n/**\n * Fonction pour valuer une expression avec des substitutions dynamiques (quelle que soit la lettre utilise dans substitutions)\n * @param {string} input\n * @param {string} goodAnswer\n * @author Eric Elter\n * @return {boolean}\n */\n\nexport function ontDeveloppementsEgaux(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  const clean = generateCleaner([\n    'puissances',\n    'virgules',\n    'parentheses',\n    'foisUn',\n  ])\n  const localInput = clean(input)\n  const localGoodAnswer = clean(goodAnswer)\n  const expr1 = engine.parse(localInput, { canonical: true })\n  const expr2 = engine.parse(localGoodAnswer, { canonical: true })\n\n  if (!expr1.ops || !expr2.ops)\n    return { isOk: false, feedback: \"Cette expression n'est pas dveloppe.\" }\n  if (expr1.operator !== expr2.operator)\n    return { isOk: false, feedback: \"Cette expression n'est pas dveloppe.\" }\n\n  // On va tenter de rduire expr1\n  let expr1Reduite = engine.parse('0')\n  for (const item1 of expr1.ops) {\n    expr1Reduite = expr1Reduite.add(item1)\n  }\n\n  // On va tenter de rduire expr2\n  let expr2Reduite = engine.parse('0')\n  for (const item2 of expr2.ops) {\n    expr2Reduite = expr2Reduite.add(item2)\n  }\n\n  return {\n    isOk: expr1Reduite.isSame(expr2Reduite),\n    feedback: expr1Reduite.isSame(expr2Reduite)\n      ? ''\n      : expr1Reduite.isEqual(expr2Reduite)\n        ? \"Cette expression n'est pas assez dveloppe.\"\n        : 'Incorrect',\n  }\n}\n\n/**\n * Fonction pour valuer une expression avec des substitutions dynamiques (quelle que soit la lettre utilise dans substitutions)\n * @param {BoxedExpression} expr\n * @param {Substitutions} substitutions\n * @example evaluateExpression('3x+5', { x: 2}) -> 11\n * @example evaluateExpression('3x+5', { y: 2}) -> NAN\n * @example evaluateExpression('3x+5', { c: 2, x: 2, y: 2}) -> 5\n * @author Eric Elter\n * @return {integer||string}\n */\nfunction evaluateExpression(\n  expr: string,\n  substitutions: Substitutions,\n): number | string {\n  // Dfinir l'expression\n  const expression = engine.parse(expr)\n\n  // Faire les substitutions\n  let substituted = expression\n  for (const [variable, value] of Object.entries(substitutions)) {\n    substituted = substituted.subs({ [variable]: value })\n  }\n\n  // valuer l'expression substitue\n  const result = substituted.evaluate().value\n\n  // Convertir le rsultat en nombre ou 'NAN' si ce n'est pas un nombre\n  if (typeof result === 'number') {\n    return result\n  }\n  return 'NAN'\n}\n/**\n * comparaison d'expressions developpes NON REDUITES\n * @param {string} input\n * @param {string} goodAnswer\n * @author Eric Elter\n * @return ResultType\n */\nexport function expressionDeveloppeeEtNonReduiteCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  return expressionDeveloppeeEtReduiteCompare(input, goodAnswer, {\n    expressionsForcementReduites: false,\n  })\n}\n\n/**\n * Vrifie si une chane est en notation scientifique LaTeX valide.\n * Gre les formes \"a\\\\times10^{b}\" et \"10^{b}\\\\timesa\".\n * Retourne un objet avec isOk et feedback.\n * @author Eric Elter\n */\n/**\n * Vrifie si une chane est en notation scientifique LaTeX valide.\n * Gre les formes \"a\\\\times10^b\" et \"10^b\\\\timesa\" avec ou sans accolades.\n * Retourne un objet avec isOk et feedback.\n * @author Eric Elter\n */\nfunction isScientific(str: string): { isOk: boolean; feedback: string } {\n  // Regex 1 : a\\times10^b ou a\\times10^{b}\n  const regex1 = /^(-?\\d+(?:\\.\\d+)?)\\\\times10\\^{?(-?\\d+)}?$/\n  // Regex 2 : 10^b\\timesa ou 10^{b}\\timesa\n  const regex2 = /^10\\^{?(-?\\d+)}?\\\\times(-?\\d+(?:\\.\\d+)?)$/\n\n  let base: number | null = null\n  let exponent: number | null = null\n\n  if (regex1.test(str)) {\n    const match = str.match(regex1)!\n    base = Number(match[1])\n    exponent = Number(match[2])\n  } else if (regex2.test(str)) {\n    const match = str.match(regex2)!\n    exponent = Number(match[1])\n    base = Number(match[2])\n  } else {\n    return {\n      isOk: false,\n      feedback: 'Format incorrect : utilisez a\\\\times10^b ou 10^b\\\\timesa.',\n    }\n  }\n\n  if (isNaN(base) || isNaN(exponent)) {\n    return {\n      isOk: false,\n      feedback: \"La mantisse ou l'exposant n'est pas un nombre valide.\",\n    }\n  }\n\n  if (Math.abs(base) < 1) {\n    return { isOk: false, feedback: 'La mantisse doit tre  1.' }\n  }\n\n  if (Math.abs(base) >= 10) {\n    return { isOk: false, feedback: 'La mantisse doit tre < 10.' }\n  }\n\n  return { isOk: true, feedback: 'La notation est correcte.' }\n}\n\n/**\n * Comparaison de nombres en notation scientifique\n * @param {string} input\n * @param {string} goodAnswer\n * @return ResultType\n * @author Eric Elter\n */\nfunction scientifiqueCompare(input: string, goodAnswer: string): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    'espaces',\n    'parentheses',\n    'puissances',\n  ])\n  const saisieClean = clean(input)\n  const reponseClean = clean(goodAnswer)\n\n  let saisieCleanFormattee = saisieClean\n    .replace(/\\s+/g, '') // Supprimer tous les espaces\n    .replace(/\\\\times/g, '\\\\cdot') // Remplacer \\times par \\cdot\n    .replace(/\\^(\\d+)/g, '^{$1}') // Ajouter des accolades autour des exposants\n    .replace(/\\{\\+(\\d+)\\}/g, '{$1}') // Remplacer {+a} par {a}\n\n  // Si la puissance est 0, on accepte mais computeEngine ne met pas en notation scientitique et donc la comparaison entre notation scientifique n'est pas possible.\n  // Donc il faut ces trois lignes pour comparer les nombres dcimaux, dans ce cas prcis.\n  const match = saisieCleanFormattee.match(/\\^{(-?\\d+)}$/) // Recherche des nombres entre accolades\n  const puissance = match ? number(match[match.length - 1]) : null\n  if (puissance === 0)\n    saisieCleanFormattee = engine\n      .parse(saisieClean)\n      .toLatex({ notation: 'scientific', avoidExponentsInRange: [0, 0] })\n\n  // Ce code ci-dessous sera  supprimer aprs correction de l'issue 223 de computeEngine 0.27.0\n  const regex = /(?:\\{(-?\\d+(?:\\.\\d+)?)\\}|(-?\\d+(?:\\.\\d+)?))\\\\cdot(.+)/ // Expression rgulire pour capturer le nombre avant et ce qui suit \\cdot\n  const decoupageSaisie = saisieCleanFormattee.match(regex)\n\n  let mantisseSaisie: string | null = null\n  if (decoupageSaisie) {\n    mantisseSaisie = decoupageSaisie[1] || decoupageSaisie[2] || null\n    if (mantisseSaisie === '1' && decoupageSaisie[3])\n      saisieCleanFormattee = decoupageSaisie[3].trim()\n  }\n  // Ce code ci-dessus sera  supprimer aprs correction de l'issue 223 de computeEngine 0.27.0\n\n  const reponseCleanFormattee = engine\n    .parse(reponseClean)\n    .toLatex({ notation: 'scientific', avoidExponentsInRange: [0, 0] })\n\n  saisieCleanFormattee = saisieCleanFormattee.replace(\n    /(\\d+\\.?\\d*?)0*(?=\\\\cdot)/,\n    '$1',\n  ) // Pour corriger 9.040\\\\cdot10^{4} en 9.04\\\\cdot10^{4}\n\n  if (saisieCleanFormattee === reponseCleanFormattee) return { isOk: true }\n  if (engine.parse(saisieClean).isEqual(engine.parse(reponseClean)))\n    return {\n      isOk: false,\n      feedback:\n        \"La rponse fournie est bien gale  celle attendue mais la rponse fournie n'est pas en notation scientifique.\",\n    }\n  if (isScientific(saisieClean).isOk)\n    return {\n      isOk: false,\n      feedback:\n        \"La rponse fournie est bien en notation scientifique mais la rponse fournie n'est pas gale  celle attendue.\",\n    }\n  return {\n    isOk: false,\n    feedback: \"La rponse fournie n'est pas gale  celle attendue.\",\n  }\n}\n\n/**\n * comparaison de textes... ben parce qu'il en faut une\n * @param {string} input\n * @param {string} goodAnswer\n * @author Jean-Claude Lhote\n * @return ResultType\n */\nfunction texteAvecCasseCompare(input: string, goodAnswer: string): ResultType {\n  const cleaner = generateCleaner([\n    'parentheses',\n    'mathrm',\n    'fractions',\n    'virgules',\n  ])\n\n  // Ligne ci-dessous utile si la rponse est (B,F) comme dans 2S30-5\n  input = input.replace(\n    /\\\\lparen\\s*([^{}]+)\\s*\\{,\\}\\s*([^{}]+)\\s*\\\\rparen/g,\n    '($1,$2)',\n  )\n\n  // Ligne ci-dessous utile si la rponse est P(A\\cap B) comme dans 1P10-1\n  input = input.replace(/\\\\lparen\\s*/g, '(').replace(/\\\\rparen/g, ')')\n\n  goodAnswer = goodAnswer.replace(/\\\\lparen\\s*/g, '(').replace(/\\\\rparen/g, ')')\n\n  let localInput = cleaner(input)\n  const localGoodAnswer = cleaner(goodAnswer)\n  const clean = generateCleaner(['espaceNormal', 'doubleEspaces'])\n  localInput = clean(localInput)\n\n  // Cette commande ci-dessous est mauvaise Je la laisse pour expliquer pourquoi elle est mauvaise.\n  // Autant, elle serait utile pour comparer 'aucun' et 'Aucun'\n  // mais elle ne le serait plus pour comparer [AB] et [ab] ce qui serait dommage.\n  // return { isOk: input.toLowerCase() === goodAnswer.toLowerCase() }\n  return { isOk: localGoodAnswer === localInput }\n}\n\n/**\n * comparaison de textes avec espaces comme son nom l'indique : avec un nettoyage adapt  la situation\n * Utilise String.localeCompare() pour les spcificits du langage local utilis.\n * @param {string} input\n * @param {string} goodAnswer\n * @return ResultType\n * @author Jean-Claude Lhote\n */\nexport function textWithSpacesCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    'parentheses',\n    'latex',\n    'doubleEspaces',\n  ])\n  const localGoodAnswer = clean(goodAnswer)\n  const localInput = clean(input)\n  const result = localInput.localeCompare(localGoodAnswer)\n  return { isOk: result === 0 }\n}\n/* Cette fonction n'a pas lieu d'exister car elle ne fait pas ce pour quoi elle est prvue.\nUne autre fonction fait ce qu'il faut en dessous.\n/**\n * comparaison de textes sans s'occuper de la casse.\n * @param {string} input\n * @param {string} goodAnswer\n * @author Jean-Claude Lhote\n * @return ResultType\n\n////////////  -> Mettre etoile /\nexport function upperCaseCompare (input: string, goodAnswer: string): ResultType {\n\n  // @ToDo supprimer toutes les traces de LaTeX (gestion du - typographique...)\n  input = input.replaceAll('\\\\lparen', '(').replaceAll('\\\\rparen', ')')\n  return { isOk: input.toUpperCase() === goodAnswer.toUpperCase() }\n}\n*/\n\n/**\n * comparaison de textes sans s'occuper de la casse.\n * @param {string} input\n * @param {string} goodAnswer\n * @author Eric Elter\n * @return ResultType\n */\nexport function texteSansCasseCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  const localInput = input.toLowerCase()\n  const localGoodAnswer = goodAnswer.toLowerCase()\n  return texteAvecCasseCompare(localInput, localGoodAnswer)\n}\n\nexport function expressionNumeriqueCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  const cleaner = generateCleaner(['fractions'])\n  const localGoodAnswer = cleaner(goodAnswer)\n  const goodAnswerParsed = engine.parse(localGoodAnswer, { canonical: true }) // Important ce canonical  true\n  const inputParsed = engine.parse(input, { canonical: true })\n  if (goodAnswerParsed.isSame(inputParsed)) return { isOk: true }\n  if (goodAnswerParsed.isEqual(inputParsed))\n    if (inputParsed.isNumber) {\n      return {\n        isOk: false,\n        feedback:\n          'Ce rsultat pourrait tre correct mais un calcul est attendu',\n      }\n    } else\n      return {\n        isOk: false,\n        feedback:\n          \"Ce rsultat pourrait tre correct mais ce n'est pas ce calcul qui est attendu\",\n      }\n  return {\n    isOk: false,\n    feedback:\n      \"Ce rsultat pourrait tre correct mais ce n'est pas ce calcul qui est attendu\",\n  }\n}\n\n/**\n * comparaison de fraction simplifie\n * @param {string} input\n * @param {string} goodAnswer\n * @return ResultType\n * @author Jean-Claude Lhote\n */\nexport function simplerFractionCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  const cleaner = generateCleaner(['fractions', 'espaces'])\n  const localGoodAnswer = cleaner(goodAnswer)\n  const goodAnswerParsed = engine.parse(localGoodAnswer, { canonical: false })\n  const inputParsed = engine.parse(input, { canonical: false })\n  if (\n    inputParsed.operator === 'Divide' &&\n    goodAnswerParsed.operator === 'Divide'\n  ) {\n    const num = (inputParsed.json as [string, number, number])[1] as number\n    const numGoodAnswer = (\n      goodAnswerParsed.json as [string, number, number]\n    )[1] as number\n    if (numGoodAnswer == null) {\n      throw Error(\n        `problme avec ${localGoodAnswer} dans simplerFractionCompare : fReponse.op1.numericValue est nul`,\n      )\n    }\n    if (\n      inputParsed.isEqual(goodAnswerParsed) &&\n      num &&\n      num < numGoodAnswer &&\n      Number.isInteger(num)\n    ) {\n      return { isOk: true }\n    }\n  }\n  return { isOk: false }\n}\n\n/**\n * Comparaison de fraction en acceptant toute valeur (y compris la valeur dcimale) mais n'acceptant de racine carre au dnominateur\n * @param {string} input\n * @param {string} goodAnswer\n * @author Eric Elter\n * @return ResultType\n */\nexport function equalFractionCompareSansRadical(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  const cleaner = generateCleaner(['fractions'])\n  const localInput = cleaner(input)\n  const localGoodAnswer = cleaner(goodAnswer)\n\n  // Utilisation d'une expression rgulire pour extraire le contenu de la deuxime accolade\n  const contenuDeuxiemeAccolade: string | null =\n    localInput.match(/\\\\frac{[^}]*}{(\\\\sqrt[^}]*)/)?.[1] || null\n\n  // if (contenuDeuxiemeAccolade === null) return { isOk: equalFractionCompare(input, goodAnswer).isOk }\n  // else if (!contenuDeuxiemeAccolade.includes('sqrt')) return { isOk: equalFractionCompare(input, goodAnswer).isOk }\n  if (contenuDeuxiemeAccolade === null) {\n    return { isOk: fonctionComparaison(localInput, localGoodAnswer).isOk }\n  }\n  if (!contenuDeuxiemeAccolade.includes('sqrt')) {\n    return { isOk: fonctionComparaison(localInput, localGoodAnswer).isOk }\n  }\n  return { isOk: false }\n}\n\n/**\n * Comparaison de puissances\n * @param {string} input\n * @param {string} goodAnswer\n * @param {Object} [options={}] - Options pour la comparaison.\n * @param {boolean} [options.seulementCertainesPuissances=false] - Si false, toutes les formes de puissances seront acceptes.\n * @param {boolean} [options.sansExposantUn=false] - Si false, l'exposant 1 sera accept comme valide.\n * @return ResultType\n * @author Eric Elter\n */\nfunction comparaisonPuissances(\n  input: string,\n  goodAnswer: string,\n  { seulementCertainesPuissances = false, sansExposantUn = false } = {},\n): ResultType {\n  const clean = generateCleaner(['virgules', 'puissances'])\n  const nombreSaisi = clean(input).split('^')\n  const goodAnswerSplit = clean(goodAnswer).split('^')\n\n  // input n'est pas une puissance (mais cas possiblement correct si exposant de goodAnswer est 1 ou 0)\n  if (nombreSaisi.length === 1) {\n    const exposantGoodAnswer = isNaN(Number(goodAnswerSplit[1]))\n      ? 1\n      : goodAnswerSplit[1]\n    if (\n      (Number(exposantGoodAnswer) === 1 || Number(exposantGoodAnswer) === 0) &&\n      engine.parse(clean(input)).isEqual(engine.parse(clean(goodAnswer)))\n    )\n      return { isOk: true }\n    return { isOk: false, feedback: 'Une puissance est attendue.' }\n  }\n  // input n'est pas une puissance de puissance\n  if (seulementCertainesPuissances && nombreSaisi.length > 2)\n    return { isOk: false, feedback: 'Un seul exposant est attendu.' }\n\n  let mantisseSaisie = nombreSaisi[0]\n  mantisseSaisie = mantisseSaisie.replace(/\\\\lparen|\\\\rparen|\\(|\\)/g, '') // Pour enlever les parenthses afin que (-4)^2 soit accepte\n  mantisseSaisie = mantisseSaisie.replace(/--/g, '') // Pour accepter les deux - conscutifs.\n\n  // La mantisse saisie est-elle un nombre ?\n  if (Number.isNaN(mantisseSaisie))\n    return {\n      isOk: false,\n      feedback: \"Avant l'exposant, on attend un nombre unique.\",\n    } // Pour viter 1\\times4^2\n\n  let exposantSaisi = nombreSaisi[1]\n  exposantSaisi = exposantSaisi.replace(/\\\\lparen|\\\\rparen|\\(|\\)/g, '') // Pour enlever les parenthses\n  exposantSaisi = exposantSaisi.replace(/--/g, '') // Pour accepter les deux - conscutifs.\n  exposantSaisi = exposantSaisi.replace(/[{}]/g, '') // Pour enlever les accolades (possible si exposant dcimal ou ngatif)\n  const exposantSaisiNumber = Number(exposantSaisi)\n  // L'exposnat saisi est-il un nombre ?\n  if (Number.isNaN(exposantSaisiNumber))\n    return {\n      isOk: false,\n      feedback: 'On attend un nombre unique comme exposant.',\n    } // Pour viter 4^{1+1}\n\n  // goodAnswer n'est pas une puissance donc toute puissance gale  goodAnswer est correcte (modulo sansExposantUn)\n  if (goodAnswerSplit.length === 1) {\n    if (sansExposantUn && exposantSaisiNumber === 1)\n      return { isOk: false, feedback: 'On attend un exposant diffrent de 1.' }\n    const isOk = engine\n      .parse(clean(input))\n      .isEqual(engine.parse(clean(goodAnswer)))\n    return {\n      isOk: !!isOk,\n      feedback: isOk ? '' : \"La puissance n'est pas gale au rsultat attendu.\",\n    }\n  }\n\n  // goodAnswer et input sont des puissances alors deux cas se prsentent.\n  if (sansExposantUn) {\n    // On accepte un input avec un exposant de 1 que si goodAnswer en a un aussi.\n    let exposantGoodAnswer = goodAnswerSplit[1]\n    exposantGoodAnswer = exposantGoodAnswer.replace(\n      /\\\\lparen|\\\\rparen|\\(|\\)/g,\n      '',\n    ) // Pour enlever les parenthses\n    exposantGoodAnswer = exposantGoodAnswer.replace(/--/g, '') // Pour accepter les deux - conscutifs.\n    const exposantGoodAnswerNumber = Number(exposantGoodAnswer)\n    if (exposantSaisiNumber === 1) {\n      if (exposantGoodAnswerNumber !== 1)\n        return {\n          isOk: false,\n          feedback: 'On attend un exposant diffrent de 1.',\n        } // Trs important car parfois, par le calcul, on attend 4^1\n    }\n  }\n  // Ou bien on n'accepte que si goodAnswer et input sont parfaitement identiques : seulementCertainesPuissances = true\n  // Ou bien on n'accepte toute galit entre goodAnswer et input : seulementCertainesPuissances = false\n  const isOk = !seulementCertainesPuissances\n    ? engine.parse(clean(input)).isEqual(engine.parse(clean(goodAnswer)))\n    : engine.parse(clean(input)).isSame(engine.parse(clean(goodAnswer)))\n  if (!isOk) {\n    if (engine.parse(clean(input)).isEqual(engine.parse(clean(goodAnswer))))\n      return {\n        isOk: false,\n        feedback:\n          \"La puissance est gale au rsultat attendu mais ne correspond pas  l'nonc.\",\n      }\n    return {\n      isOk: false,\n      feedback: \"La puissance n'est pas gale au rsultat attendu.\",\n    }\n  }\n  return { isOk: true }\n}\n\n/**\n * Comparaison d'ensembles de solutions spars par des ; dans des {} comme {-5;4;10}\n * Si kUplet = true, alors les nombres de l'usager devront tre rangs par ordre croissant. Sinon non importance de l'ordre des nombres\n * Mise en place de feedback\n * @param {string} input\n * @param {string} goodAnswer\n * @return ResultType\n * @author Eric Elter\n */\nexport function ensembleNombres(\n  input: string,\n  goodAnswer: string,\n  { kUplet = false, avecAccolades = true } = {},\n): ResultType {\n  const clean = generateCleaner(['virgules', 'fractions', 'parentheses'])\n  const cleanInput = clean(input)\n  goodAnswer = clean(goodAnswer)\n  if (goodAnswer === '\\\\emptyset' && cleanInput === goodAnswer)\n    return { isOk: true }\n  if (goodAnswer === '\\\\emptyset' && cleanInput.includes('\\\\emptyset'))\n    return {\n      isOk: false,\n      feedback: 'Rsultat incorrect car $\\\\emptyset doit tre crit seul.',\n    }\n  let splitInput: string[]\n  let splitGoodAnswer: string[]\n  if (avecAccolades) {\n    if (cleanInput[1] !== '{')\n      return {\n        isOk: false,\n        feedback:\n          \"Rsultat incorrect car cet ensemble doit commencer par une accolade ou bien tre l'ensemble vide.\",\n      }\n    if (cleanInput[cleanInput.length - 1] !== '}')\n      return {\n        isOk: false,\n        feedback:\n          \"Rsultat incorrect car cet ensemble doit se terminer par une accolade ou bien tre l'ensemble vide.\",\n      }\n    splitInput = cleanInput\n      .replaceAll('\\\\{', '')\n      .replaceAll('\\\\}', '')\n      .split(';')\n    splitGoodAnswer = clean(goodAnswer)\n      .replaceAll('\\\\{', '')\n      .replaceAll('\\\\}', '')\n      .split(';')\n  } else {\n    splitInput = cleanInput.split(';')\n    splitGoodAnswer = clean(goodAnswer).split(';')\n  }\n\n  // Pour vrifier la prsence de doublons\n  if (new Set(splitInput).size !== splitInput.length)\n    return {\n      isOk: false,\n      feedback:\n        'Rsultat incorrect car cet ensemble contient des valeurs redondantes.',\n    }\n\n  // Pour vrifier si les tableaux sont de la mme taille\n  if (splitInput.length > splitGoodAnswer.length) {\n    return {\n      isOk: false,\n      feedback: 'Rsultat incorrect car cet ensemble contient trop de nombres.',\n    }\n  }\n  if (splitInput.length < splitGoodAnswer.length) {\n    return {\n      isOk: false,\n      feedback:\n        'Rsultat incorrect car cet ensemble ne contient pas assez de nombres.',\n    }\n  }\n\n  const inputSorted = splitInput\n  const goodAnswerSorted = splitGoodAnswer\n\n  const AllExist = inputSorted.every((value) => {\n    for (let index = 0; index < goodAnswerSorted.length; index++) {\n      if (engine.parse(value).isEqual(engine.parse(goodAnswerSorted[index]))) {\n        // Laisser isEqual car avec certaines fractions, on a des misres\n        return true // L'lment est trouv\n      }\n    }\n    return false // L'lment n'est pas trouv\n  })\n\n  if (!AllExist) {\n    if (splitGoodAnswer.length === 1)\n      return {\n        isOk: false,\n        feedback:\n          \"Rsultat incorrect car cet ensemble n'a pas la valeur attendue.\",\n      }\n    else\n      return {\n        isOk: false,\n        feedback:\n          \"Rsultat incorrect car cet ensemble n'a pas toutes les valeurs attendues.\",\n      }\n  }\n  if (\n    kUplet &&\n    !splitInput.every((value, index) =>\n      engine.parse(value).isSame(engine.parse(goodAnswerSorted[index])),\n    )\n  ) {\n    return {\n      isOk: false,\n      feedback:\n        'Rsultat incorrect car les nombres ne sont pas rangs dans le bon ordre.',\n    }\n  }\n  return { isOk: true }\n}\n\n/**\n * La fonction de comparaison des intervalles pour l'interactif\n * @param {string} input\n * @param {string} goodAnswer\n * @author Jean-Claude Lhote\n */\nfunction intervalsCompare(input: string, goodAnswer: string) {\n  const clean = generateCleaner(['virgules', 'parentheses', 'espaces'])\n  const localInput = clean(input)\n  const localGoodAnswer = clean(goodAnswer)\n  if (localGoodAnswer === '\\\\emptyset') {\n    if (localInput === '\\\\emptyset' || localInput === '\\\\{\\\\}')\n      return { isOk: true, feedback: '' }\n    return {\n      isOk: false,\n      feedback: \"la bonne rponse tait l'ensemble vide : $\\\\emptyset$\",\n    }\n  }\n  let isOk1 = true\n  let isOk2 = true\n  let feedback = ''\n  const extractBornesAndOp = /[^[\\];]+/g\n  const extractCrochets = /[[\\]]/g\n  const borneAndOpSaisie = localInput.match(extractBornesAndOp)\n  const borneAndOpReponse = localGoodAnswer.match(extractBornesAndOp)\n  const crochetsSaisie = localInput.match(extractCrochets)\n  const crochetsReponse = localGoodAnswer.match(extractCrochets)\n  // console.log(localInput, localGoodAnswer, borneAndOpSaisie, borneAndOpReponse)\n  if (\n    borneAndOpSaisie != null &&\n    borneAndOpReponse != null &&\n    crochetsSaisie != null &&\n    crochetsReponse != null\n  ) {\n    if (borneAndOpSaisie.length !== borneAndOpReponse.length) {\n      return { isOk: false }\n    }\n    // On teste les bornes et les oprateurs\n    let i: number\n    isOk1 = true\n    for (i = 0; i < borneAndOpSaisie.length; i++) {\n      isOk1 &&= fonctionComparaison(\n        borneAndOpSaisie[i],\n        borneAndOpReponse[i],\n      ).isOk\n      if (!isOk1) {\n        feedback += ['\\\\cup', '\\\\cap'].includes(borneAndOpSaisie[i])\n          ? `Il y a une erreur avec l'oprateur : $${borneAndOpSaisie[i]}$.<br>`\n          : `Il y a une erreur avec la valeur : $${borneAndOpSaisie[i]}$.<br>`\n      }\n    }\n    // on teste maintenant les crochets\n    isOk2 = crochetsSaisie.length === crochetsReponse.length\n    if (!isOk2) {\n      feedback += 'Il y a une erreur avec les crochets.'\n    }\n    if (isOk2) {\n      for (i = 0; i < crochetsSaisie.length; i++) {\n        isOk2 = crochetsSaisie[i] === crochetsReponse[i] && isOk2\n        if (crochetsSaisie[i] !== crochetsReponse[i]) {\n          feedback += `Le crochet plac en position ${i + 1} est mal orient.<br>`\n        }\n      }\n    }\n    return { isOk: isOk1 && isOk2, feedback }\n  }\n  return {\n    isOk: false,\n    feedback: \"Il faut donner un intervalle ou une runion d'intervalles\",\n  }\n}\n\n/**\n * Comparaison de chanes (principalement des noms de classes\n * @param {string} input ce que saisit l'lve\n * @param {{pluriels: boolean}} [options]\n * @param {{value: string, nombre:boolean}} goodAnswer value est ce qui est attendu, si nombre est true, on compte faux l'absence de s quand il en faut un et la prsence de s quand il n'y en a pas besoin\n * si pluriels est false, on compte juste une rponse au pluriel ou au singulier quelque soit la rponse attendue, mais on met un feedback si le pluriel ou le singulier n'est pas respect\n * @author Jean-Claude Lhote\n */\nexport function numerationCompare(\n  input: string,\n  goodAnswer: string,\n  { pluriels = true } = {},\n): ResultType {\n  // normalement, il n'y a rien  nettoyer au niveau de l'input ou de goodAnswer\n  const clean = generateCleaner(['latex'])\n  const saisie: string[] = clean(input).toLowerCase().split(' ')\n  const answer: string[] = goodAnswer.toLowerCase().split(' ')\n  let result: boolean\n  let feedback = ''\n  if (pluriels) {\n    result = true\n    for (let i = 0; i < answer.length; i++) {\n      result = result && saisie[i] === answer[i]\n      if (!result) {\n        if (saisie[i].endsWith('s') && !answer[i].endsWith('s')) {\n          if (saisie[i].substring(0, saisie[i].length - 1) === answer[i]) {\n            feedback = `${saisie[i]} est au pluriel alors qu'il faut le mettre au singulier.<br>`\n          }\n        } else if (!saisie[i].endsWith('s') && answer[i].endsWith('s')) {\n          if (saisie[i] === answer[i].substring(0, answer[i].length - 1)) {\n            feedback = `${saisie[i]} est au singulier alors qu'il faut le mettre au pluriel.<br>`\n          }\n        }\n      }\n      if (!result) break\n    }\n  } else {\n    // ici on tolre singulier ou pluriel\n    // On regarde quand mme si le singulier/pluriel est respect pour le feedback\n    result = true\n    for (let i = 0; i < answer.length; i++) {\n      if (saisie[i].endsWith('s') && !answer[i].endsWith('s')) {\n        if (saisie[i].substring(0, saisie[i].length - 1) === answer[i]) {\n          feedback = `${saisie[i]} est au pluriel alors qu'il faut le mettre au singulier.<br>`\n        }\n      } else if (!saisie[i].endsWith('s') && answer[i].endsWith('s')) {\n        if (saisie[i] === answer[i].substring(0, answer[i].length - 1)) {\n          feedback = `${saisie[i]} est au singulier alors qu'il faut le mettre au pluriel.<br>`\n        }\n      }\n      // on vire le 's' final ventuel\n      if (saisie[i].endsWith('s')) {\n        saisie[i] = saisie[i].substring(0, saisie[i].length - 1)\n      }\n      if (answer[i].endsWith('s')) {\n        answer[i] = answer[i].substring(0, answer[i].length - 1)\n      }\n      result = result && saisie[i] === answer[i]\n    }\n    if (!result) feedback = '' // c'est pas bon, on se fout du feedback\n  }\n  return { isOk: result, feedback }\n}\n\n/**\n * comparaison de grandeurs avec une unit\n * @param {string} input\n * @param {string} goodAnswer\n * @param {{precision: number }} [options]\n * @return ResultType\n * @author Jean-Claude Lhote\n */\nfunction unitsCompare(\n  input: string,\n  goodAnswer: string,\n  { precision = 1 } = {},\n): {\n  isOk: boolean\n  feedback?: string\n} {\n  const localInput = input.replace('^\\\\circ', '').replace('\\\\degree', '')\n  const cleaner = generateCleaner([\n    'virgules',\n    'espaces',\n    'fractions',\n    'parentheses',\n    'mathrm',\n  ])\n  const inputGrandeur = inputToGrandeur(cleaner(localInput))\n  const goodAnswerGrandeur = Grandeur.fromString(\n    cleaner(goodAnswer).replace('^\\\\circ', '').replace('\\\\degree', ''),\n  )\n  if (inputGrandeur) {\n    if (\n      inputGrandeur.uniteDeReference !== goodAnswerGrandeur.uniteDeReference\n    ) {\n      return {\n        isOk: false,\n        feedback: `Il faut donner la rponse en $${goodAnswerGrandeur.latexUnit}$.`,\n      }\n    }\n    if (precision !== undefined) {\n      const okPrecision1: boolean = inputGrandeur.estUneApproximation(\n        goodAnswerGrandeur,\n        precision,\n      )\n      const okPrecision2: boolean = goodAnswerGrandeur.estUneApproximation(\n        inputGrandeur,\n        precision / 10,\n      )\n      if (okPrecision1 && okPrecision2) {\n        return { isOk: true }\n      } else {\n        if (okPrecision1) {\n          return {\n            isOk: false,\n            feedback: `La rponse n'est pas arrondie  $${texNombre(10 ** -precision, precision)}$ prs.`,\n          }\n        }\n      }\n      return { isOk: false }\n    }\n    if (inputGrandeur.estEgal(goodAnswerGrandeur)) {\n      return { isOk: true }\n    }\n    return { isOk: false }\n  }\n  // Oubli de l'unit ?\n  const inputNumber = Number(engine.parse(cleaner(input)))\n  const inputWithAddedUnit = new Grandeur(inputNumber, goodAnswerGrandeur.unite)\n  if (inputWithAddedUnit.estEgal(goodAnswerGrandeur)) {\n    return {\n      isOk: false,\n      feedback: \"La rponse est correcte mais l'unit n'a pas t prcise.\",\n    }\n  }\n  if (inputNumber !== 0) {\n    return {\n      isOk: false,\n      feedback: \"La rponse est fausse et il faut saisir l'unit.\",\n    }\n  }\n  return { isOk: false }\n}\n\n/**\n * vrifie qu'une valeur saisie est dans un intervalle strict\n * @param {string} input\n * @param {string} goodAnswer Un intervalle par exemple ]-5.5;2]\n * @return ResultType\n * @author Jean-Claude Lhote\n */\nfunction intervalCompare(\n  input: string,\n  goodAnswer: string,\n): {\n  isOk: boolean\n  feedback?: string\n} {\n  let strictGauche = true\n  let strictDroit = true\n  if (goodAnswer.startsWith('[')) strictGauche = false\n  if (goodAnswer.endsWith(']')) strictDroit = false\n  const bornes = goodAnswer.match(/[[\\]](.+);(.+)[[\\]]/)\n  if (bornes == null) {\n    window.notify(\"Il faut revoir la dfinition de l'intervalle \", {\n      goodAnswer,\n    })\n    return { isOk: false, feedback: 'Un problme avec goodAnswer !' }\n  }\n  const clean = generateCleaner(['virgules', 'fractions', 'espaces'])\n  const borneInf = Number(engine.parse(clean(bornes[1])).N())\n  const borneSup = Number(engine.parse(clean(bornes[2])).N())\n  const inputNumber = Number(engine.parse(clean(input)).N())\n  // @todo vrifier que l'lve a bien saisi un nombre\n  if (Number.isNaN(inputNumber)) return { isOk: false }\n  const okGauche = strictGauche\n    ? inputNumber > borneInf\n    : inputNumber >= borneInf\n  const okDroit = strictDroit ? inputNumber < borneSup : inputNumber <= borneSup\n  return { isOk: okGauche && okDroit }\n}\n\n/**\n * comparaison de nombres entiers conscutifs\n * Cette fonction sert essentiellement pour le feedback dans des exercices de comparaison car elle prend pour l'instant un encadrement sous la forme a<b<c ou a>b>c\n * Exercices d'exemple : 6N20-1 et 6N20-3\n * Peut-tre en faire une variation pour vrifier des ingalits ?\n * @param {string} input\n * @param {string} goodAnswer\n * @author Jean-Claude Lhote\n * @return ResultType\n */\nexport function consecutiveCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  let feedback = ''\n  const [entierInf, valeurInter, entierSup] = input.includes('<')\n    ? input.split('<').map((el) => Number(engine.parse(el).numericValue))\n    : input\n        .split('>')\n        .map((el) => Number(engine.parse(el).numericValue))\n        .sort((a: number, b: number) => a - b)\n  if (\n    !(\n      Number.isInteger(Number(entierSup)) && Number.isInteger(Number(entierInf))\n    )\n  ) {\n    feedback = 'On attend comme rponse deux nombres entiers.'\n    return { isOk: false, feedback }\n  }\n  const [goodAnswerEntierInf, , goodAnswerEntierSup] = goodAnswer.includes('<')\n    ? goodAnswer.split('<').map((el) => Number(engine.parse(el).numericValue))\n    : goodAnswer\n        .split('>')\n        .map((el) => Number(engine.parse(el).numericValue))\n        .sort((a: number, b: number) => a - b)\n  const diff = Number(\n    engine.box(['Subtract', String(entierSup), String(entierInf)]).N()\n      .numericValue,\n  )\n  if (diff === -1) {\n    feedback =\n      \"Les nombres sont bien deux entiers conscutifs, mais ils sont donns dans l'ordre inverse.\"\n    return { isOk: false, feedback }\n  }\n  if (diff !== 1) {\n    return {\n      isOk: false,\n      feedback: 'Les deux nombres entiers donns ne sont pas conscutifs.',\n    }\n  }\n  if (valeurInter != null) {\n    const diff1 = Number(\n      engine.box(['Subtract', String(entierSup), String(valeurInter)]).N()\n        .numericValue,\n    )\n    const diff2 = Number(\n      engine.box(['Subtract', String(valeurInter), String(entierInf)]).N()\n        .numericValue,\n    )\n    if (\n      !(\n        diff1 != null &&\n        diff2 != null &&\n        diff1 < 1 &&\n        diff1 >= 0 &&\n        diff2 < 1 &&\n        diff2 >= 0\n      )\n    ) {\n      return {\n        isOk: false,\n        feedback: `Les deux nombres entiers sont biens conscutifs mais n'encadrent pas la valeur ${valeurInter}`,\n      }\n    }\n  }\n  const isOk1 = true\n  const isOk2 =\n    expressionDeveloppeeEtReduiteCompare(\n      String(entierInf),\n      String(goodAnswerEntierInf),\n    ).isOk &&\n    expressionDeveloppeeEtReduiteCompare(\n      String(entierSup),\n      String(goodAnswerEntierSup),\n    ).isOk\n  return { isOk: isOk1 && isOk2, feedback: '' }\n}\n\n/**\n * Compare deux nombres avec une certaine tolrance\n * Exercice exemple : 5N11-4\n * @param {string} input\n * @param { string} goodAnswer\n * @param {{tolerance: number}} [options]\n * @author Jean-Claude Lhote\n */\nexport function approximatelyCompare(\n  input: string,\n  goodAnswer: string,\n  { tolerance = 0.1 } = {},\n) {\n  const cleaner = generateCleaner([\n    'virgules',\n    'fractions',\n    'espaces',\n    'parentheses',\n    'puissances',\n  ])\n  const saisieClean = Number(engine.parse(cleaner(input)).numericValue)\n  const answerClean = Number(engine.parse(cleaner(goodAnswer)).numericValue)\n  return { isOk: Math.abs(saisieClean - answerClean) <= tolerance }\n}\n\n/**\n * Comparaison de fonction f(x)\n * @param {string} input\n * @param {{ variable: string, domaine: [number, number]}} [options]\n * @param {string} goodAnswer\n * @author Jean-Claude Lhote\n */\nexport function functionCompare(\n  input: string,\n  goodAnswer: string,\n  { variable = 'x', domaine = [-100, 100], entier = false } = {},\n): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    'parentheses',\n    'fractions',\n    'divisions',\n  ])\n  const cleanInput = clean(input)\n  const inputParsed = engine.parse(cleanInput)\n  const inputFn = inputParsed.compile()\n  const cleanAnswer = clean(goodAnswer)\n  const goodAnswerFn = engine.parse(cleanAnswer).compile()\n  const min = domaine[0]\n  const max = domaine[1]\n  const range = max - min\n  const valAlea = () => min + range * Math.random()\n  if (inputFn == null || goodAnswerFn == null) {\n    throw Error(\n      `functionCompare : La saisie ou la bonne rponse ne sont pas des fonctions (saisie : ${input} et rponse attendue : ${goodAnswer}`,\n    )\n  }\n  let a: number\n  let b: number\n  let c: number\n  let variablea: Record<string, number>\n  let variableb: Record<string, number>\n  let variablec: Record<string, number>\n  let cpt = 0\n  do {\n    ;[a, b, c] = entier\n      ? [valAlea(), valAlea(), valAlea()].map(Math.round)\n      : [valAlea(), valAlea(), valAlea()]\n    variablea = Object.fromEntries([[variable ?? 'x', a]])\n    variableb = Object.fromEntries([[variable ?? 'x', b]])\n    variablec = Object.fromEntries([[variable ?? 'x', c]])\n    cpt++\n  } while (\n    cpt < 1000 &&\n    (Number.isNaN(goodAnswerFn(variablea) as number) ||\n      Number.isNaN(goodAnswerFn(variableb) as number) ||\n      Number.isNaN(goodAnswerFn(variablec) as number))\n  )\n  if (cpt === 1000) {\n    window.notify(\n      \"functionCompare n'a pas russi  trouver 3 valeurs dans le domaine qui donnent une image par la fonction goodAnswer !\",\n      { fonction: goodAnswer, domaine },\n    )\n    return { isOk: false, feedback: 'erreur dans le programme' }\n  }\n  let isOk = true\n  for (const x of [a, b, c]) {\n    const vars = Object.fromEntries([[variable ?? 'x', x]])\n    const y1 = Number(inputFn(vars))\n    const y2 = Number(goodAnswerFn(vars))\n    isOk = isOk && Math.abs(y1 - y2) < 1e-10\n  }\n  return { isOk }\n}\n\n/*\n * Comparaison de fonction f(x,y) (ou tout autre variable) x et y tant les lettres par dfaut\n * @param {string} input\n * @param {string} goodAnswer\n * @param {{variables: string[]}} [options]\n * @author Jean-Claude Lhote\n *\nexport function functionXyCompare (input: string, goodAnswer: string, { variables = ['x', 'y'] } = { }): ResultType {\n  const clean = generateCleaner(['espaces', 'virgules', 'parentheses', 'fractions', 'divisions'])\n  // Pour l'instant les fonctions trigo saisies au clavier ne sont pas les fonction trigo latex.\n  const cleanInput = clean(input)\n  const inputParsed = engine.parse(cleanInput)\n\n  const inputFn = inputParsed.compile()\n  const cleanAnswer = clean(goodAnswer)\n  const goodAnswerFn = engine.parse(cleanAnswer).compile()\n\n  let isOk = true\n  if (inputFn == null || goodAnswerFn == null) throw Error(`functionCompare : La saisie ou la bonne rponse ne sont pas des fonctions (saisie : ${input} et rponse attendue : ${goodAnswer}`)\n  const [a, b, c] = [Math.random(), Math.random(), Math.random()]\n  const [A, B, C] = [Math.random(), Math.random(), Math.random()]\n  for (const x of [a, b, c]) {\n    for (const y of [A, B, C]) {\n      const vars = Object.fromEntries([[variables[0], x], [variables[1], y]])\n      isOk = isOk && Math.abs(inputFn(vars) - goodAnswerFn(vars)) < 1e-10\n    }\n  }\n  return { isOk }\n} */\n\n/*\n * Comparaison d'galits (pour l'instant strictement gal, il est prvu d'implmenter l'quivalence d'galits)\n * @param {string} input\n * @param {string} goodAnswer\n * @param {{membre1Variable?: string, membre2Variable?: string, strict?: boolean, domaine: [number, number]}} [options]\n * @author Jean-Claude Lhote\n *\nexport function equalityCompare (input: string, goodAnswer: string, { membre1Variable = 'x', membre2Variable = 'x', strict = true, domaine = [-100, 100] } = {}):ResultType {\n  const [m1, m2] = input.split('=')\n  const [goodAnswerMb1, goodAnswerMb2] = goodAnswer.split('=')\n  if (m1 == null || m2 == null) return { isOk: false, feedback: 'Une galit est attendue' }\n  if (strict) {\n    const { isOk: isOk1 } = functionCompare(m1, goodAnswerMb1, { variable: membre1Variable ?? 'x', domaine })\n    const { isOk: isOk2 } = functionCompare(m2, goodAnswerMb2, { variable: membre2Variable ?? 'x', domaine })\n    return { isOk: isOk1 && isOk2 }\n  } else {\n    // @todo  implmenter : permettre de saisir une galit et de vrifier l'quivalence avec celle propose comme bonne rponse.\n    // En attendant, je recopie le code de strict = true\n    const { isOk: isOk1 } = functionCompare(m1, goodAnswerMb1, { variable: membre1Variable ?? 'x', domaine })\n    const { isOk: isOk2 } = functionCompare(m2, goodAnswerMb2, { variable: membre2Variable ?? 'x', domaine })\n    return {\n      isOk: isOk1 && isOk2,\n      feedback: ''\n    }\n  }\n} */\n\n/**\n * Comparaison d'galits (pour les quations de droites ou d'autres galits comme dans can2L11 ou can1a-2024-Q14)\n * @param {string} input\n * @param {string} goodAnswer\n * @author Eric Elter\n */\nexport function egaliteCompare(input: string, goodAnswer: string): ResultType {\n  const [m1, m2] = input.split('=')\n  const [goodAnswerMb1, goodAnswerMb2] = goodAnswer.split('=')\n  if (m1 == null || m2 == null) {\n    return { isOk: false, feedback: 'Une galit est attendue' }\n  }\n\n  const { isOk: isOk1 } = fonctionComparaison(m2, goodAnswerMb1)\n  const { isOk: isOk2 } = fonctionComparaison(m1, goodAnswerMb1)\n  const { isOk: isOk3 } = fonctionComparaison(m2, goodAnswerMb2)\n  const { isOk: isOk4 } = fonctionComparaison(m1, goodAnswerMb2)\n  return { isOk: (isOk1 && isOk4) || (isOk3 && isOk2) }\n}\n\n/**\n * Format des nombres avec les espaces adquats\n * @param {string} nombre // Un nombre sans espace sous forme d'une chane de caractres\n * @author Eric Elter (aide par ChatGPT)\n * @example formatNumberWithSpaces('1234567') renvoie '1 234 567'\n * @example formatNumberWithSpaces('1239,4567') renvoie '1 239,456 7'\n * @returns {string}\n */\nfunction formatNumberWithSpaces(nombre: string): string {\n  return nombre.replace(/\\b\\d+(?:[.,]\\d+)?\\b/g, (match) => {\n    // Dtection du sparateur utilis\n    const separator = match.includes(',') ? ',' : '.'\n\n    // Sparer la partie entire et la partie dcimale\n    const [entier, decimal] = match.split(separator)\n\n    // Formater la partie entire : espace tous les 3 chiffres de gauche  droite\n    const entierFormate = entier.replace(/(\\d)(?=(\\d{3})+$)/g, '$1 ')\n\n    if (decimal) {\n      // Formater la partie dcimale : espace tous les 3 chiffres de droite  gauche\n      const decimalFormate = decimal.replace(/(\\d{3})(?=\\d)/g, '$1 ')\n      return `${entierFormate}${separator}${decimalFormate.trim()}`\n    }\n\n    return entierFormate // Retourne uniquement la partie entire si pas de dcimale\n  })\n}\n\n/**\n * Comparaison de nombres avec les espaces exigs\n * @param {string} input\n * @param {string} goodAnswer\n * @author Rmi Angot\n */\nexport function numberWithSpaceCompare(\n  input: string,\n  goodAnswer: string,\n): ResultType {\n  let inputCleanFirst = input.replaceAll(/(\\s{2,})(?=\\d{3})/g, ' ').trim() // EE : l'lve peut avoir un saisi un espace avant ou aprs le nombre et avoir saisi des doubles espaces sans qu'on lui en tienne rigueur tant qu'ils sparent bien les classes, videmment.\n  inputCleanFirst = inputCleanFirst.replaceAll(/\\\\,/g, ' ') // EE : Permet  input que les espaces ressemblent uniquement  ' ' et non  '\\,'.\n  const clean = generateCleaner(['espaces'])\n  const inputClean = clean(input)\n  const goodAnswerClean = clean(goodAnswer)\n  let goodAnswerNew = goodAnswerClean.replace(/\\s+/g, '') // EE : On enlve tous les espaces s'il y en a.\n\n  // Gestion pnible de la virgule ci-dessous dans le cas de plus de 3 chiffres dans la partie dcimale.\n  goodAnswerNew = goodAnswerNew.replace('{,}', ',') // EE : On enlve toutes les virgules sous la forme {,} s'il y en a.\n  goodAnswerNew = formatNumberWithSpaces(goodAnswerNew) // EE : On rajoute tous les espaces adquats.\n  goodAnswerNew = goodAnswerNew.replace(',', '{,}') // EE : On rajoute toutes les virgules sous la forme {,} s'il y en a.\n\n  let feedback = ''\n  if (inputCleanFirst !== goodAnswerNew && inputClean === goodAnswerClean) {\n    feedback = 'Le nombre est mal crit, il faut faire attention aux espaces. '\n  }\n  return { isOk: inputCleanFirst === goodAnswerNew, feedback }\n}\n\nexport function exprCompare(\n  input: string,\n  goodAnswer: string,\n  { noUselessParen = false },\n): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    'parentheses',\n    'divisions',\n    'fractions',\n    'puissances',\n    'fractions',\n    'mathrm',\n  ])\n  const inputClean = clean(input) ?? ''\n  const answerClean = clean(goodAnswer) ?? ''\n  let feedback = ''\n  let isOk = true\n  const nbParenInput = inputClean.match(/([[()\\]])/g)?.length\n  const nbParenAnswer = answerClean.match(/([[()\\]])/g)?.length\n  const numbersInput = inputClean\n    .match(/\\d+/g)\n    ?.sort((a, b) => Number(a) - Number(b))\n  const numbersAnswer = answerClean\n    .match(/\\d+/g)\n    ?.sort((a, b) => Number(a) - Number(b))\n  const opsInput = inputClean\n    .match(/[+\\-/*]|(times)|(div)|(frac)/g)\n    ?.sort((a, b) => a.charCodeAt(0) - b.charCodeAt(0))\n  const opsAnswer = answerClean\n    .match(/[+\\-/*]|(times)|(div)|(frac)/g)\n    ?.sort((a, b) => a.charCodeAt(0) - b.charCodeAt(0))\n  const isOk1 = nbParenAnswer === nbParenInput // doit tre true si noUselessParen est true\n  const isOk2 =\n    numbersInput != null &&\n    numbersAnswer != null &&\n    areSameArray(numbersInput, numbersAnswer) // doit tre obligatoirement true\n  const isOk3 =\n    opsInput != null && opsAnswer != null && areSameArray(opsInput, opsAnswer) // doit obligatoirement tre true\n  const isOk4 = engine\n    .parse(inputClean)\n    .isEqual(engine.parse(clean(goodAnswer))) // doit obligatoirement tre true\n  if (noUselessParen && inputClean != null && answerClean !== null) {\n    isOk = (isOk1 && isOk2 && isOk3 && isOk4) ?? false\n    if (!isOk1 && isOk4) {\n      feedback =\n        \"L'expression donne le bon rsultat mais n'a pas la forme attendue.\"\n    }\n  } else {\n    isOk = (isOk2 && isOk3 && isOk4) ?? false\n    if (!isOk) {\n      if (!isOk4) {\n        feedback = \"L'expression ne donne pas le bon rsultat.\"\n      } else if (!isOk3) {\n        feedback = \"L'expression ne contient pas les bonnes oprations.\"\n      } else {\n        feedback = \"L'expression ne contient pas les bons nombres.\"\n      }\n    }\n  }\n  return { isOk, feedback }\n}\n\nexport function checkLeCompteEstBon( // Ne fonctionne que si numbers est un tableau de nombres POSITIFS.\n  input: string,\n  numbers: number[],\n  target: number,\n  quatreOperationsObligatoires: boolean,\n): ResultType {\n  const clean = generateCleaner([\n    'virgules',\n    'parentheses',\n    'fractions',\n    'divisions',\n  ])\n  const inputClean = clean(input)\n\n  // At first, check that the value of the expression is correct\n  const answer = engine.parse(inputClean, {\n    canonical: false,\n  }) as BoxedExpression\n  const value = answer.value\n  if (value !== target) {\n    return {\n      isOk: false,\n      feedback: `L'expression vaut ${value} et non ${target}.`,\n    }\n  }\n\n  // Count each operator\n  let addCount = 0\n  let multiplyCount = 0\n  let divideCount = 0\n  let subtractCount = 0\n\n  let tropDeNombres = false\n  let nombresEnDoublon = false\n  let mauvaisNombre = false\n  let symboleNonAutorise = false\n  let operationNonAutorisee = false\n\n  const listeNombresEnonce = [...numbers]\n  const visit: (node: BoxedExpression) => void = (node) => {\n    if (node.numericValue !== null) {\n      if (listeNombresEnonce.length === 0) {\n        if (numbers.includes(Math.abs(Number(node.value)))) {\n          // abs obligatoire car sinon, pour 5-3, il tente de chercher -3.\n          nombresEnDoublon = true\n          return 'Au moins un nombre en doublon'\n        }\n        tropDeNombres = true\n        return 'Au moins un nombre en trop'\n      }\n      if (listeNombresEnonce.includes(Math.abs(Number(node.value)))) {\n        // J'enlve cet lment de la liste\n        listeNombresEnonce.splice(\n          listeNombresEnonce.indexOf(Math.abs(Number(node.value))),\n          1,\n        )\n      } else {\n        mauvaisNombre = true\n        return 'Au moins un mauvais nombre parmi ceux proposs'\n      }\n    }\n\n    if (node.symbol) {\n      symboleNonAutorise = true\n      return \"L'expression contient un symbole non autoris.\"\n    }\n    if (node.operator) {\n      if (node.operator !== 'Number' && node.operator !== 'Delimiter') {\n        switch (node.operator) {\n          case 'Add':\n            addCount++\n            break\n          case 'Multiply':\n            multiplyCount++\n            break\n          case 'Divide':\n            divideCount++\n            break\n          case 'Subtract':\n          case 'Negate':\n            subtractCount++\n            break\n          default:\n            operationNonAutorisee = true\n        }\n      }\n      if (node.ops !== null) {\n        for (const op of node.ops) {\n          visit(op)\n        }\n      } else return 'OK'\n    }\n  }\n\n  visit(answer)\n  if (tropDeNombres)\n    return {\n      isOk: false,\n      feedback: \"L'expression utilise plus de nombres que demands.\",\n    }\n  if (nombresEnDoublon)\n    return {\n      isOk: false,\n      feedback:\n        \"L'expression utilise plusieurs fois un mme nombre parmi ceux proposs.\",\n    }\n  if (mauvaisNombre)\n    return {\n      isOk: false,\n      feedback: \"L'expression utilise au moins un nombre non autoris.\",\n    }\n  if (symboleNonAutorise)\n    return {\n      isOk: false,\n      feedback: \"L'expression contient un symbole non autoris.\",\n    }\n  if (operationNonAutorisee)\n    return {\n      isOk: false,\n      feedback:\n        \"L'expression doit contenir que des additions, des soustractions, des multiplications, des divisions ou des parenthses.\",\n    }\n  if (\n    quatreOperationsObligatoires &&\n    !(\n      addCount === 1 &&\n      divideCount === 1 &&\n      subtractCount === 1 &&\n      multiplyCount === 1\n    )\n  )\n    return {\n      isOk: false,\n      feedback:\n        \"L'expression doit contenir une addition, une soustraction, une multiplication et une division.\",\n    }\n\n  return { isOk: true, feedback: '' } // L'expression est correcte.\n}\n","import type { MathfieldElement } from 'mathlive'\nimport type Exercice from '../../exercices/Exercice'\nimport { sp } from '../outils/outilString'\nimport { fonctionComparaison } from './comparisonFunctions'\n\n// Un barme qui ne met qu'un point si tout est juste\nexport function toutPourUnPoint(listePoints: number[]): [number, number] {\n  return [Math.min(...listePoints), 1]\n}\n// le barme par dfaut un point pour chaque rponse\nexport function toutAUnPoint(listePoints: number[]) {\n  return [\n    listePoints.reduce((prev, current) => prev + current),\n    listePoints.length,\n  ] as [number, number]\n}\n\n/**\n * fonction gnrale de vrification qui utilise le contenu de exercice.autoCorrection pour comparer la saisie utilisateur avec la rponse attendue\n * @param {Exercice} exercice\n * @param {number} i\n * @param {boolean} writeResult // inutilis ! toujours true ! @fixme  quoi sert cette variable ??? JCL le 5/03/2024\n * @returns {{feedback: string, score: {nbBonnesReponses: (number|number), nbReponses: (number|number)}, isOk: string}|{feedback: string, score: {nbBonnesReponses: number, nbReponses: number}, resultat: string}|{feedback: string, score: {nbBonnesReponses: number, nbReponses: number}, isOk: string}|*|{feedback: string, score: {nbBonnesReponses: (number), nbReponses: number}, resultat: string}}\n */\nexport function verifQuestionMathLive(\n  exercice: Exercice,\n  i: number,\n  writeResult = true,\n) {\n  let noFeedback = false\n  let champTexte: HTMLInputElement | MathfieldElement | null = null\n  const getCustomFeedback =\n    exercice.autoCorrection[i]?.reponse?.valeur?.feedback\n  if (exercice.autoCorrection[i]?.reponse == null) {\n    throw Error(\n      `verifQuestionMathlive appel sur une question sans rponse: ${JSON.stringify(\n        {\n          exercice,\n          question: i,\n          autoCorrection: exercice.autoCorrection[i],\n        },\n      )}`,\n    )\n  }\n  if (exercice.autoCorrection[i].reponse.param == null) {\n    throw Error(\n      `verifQuestionMathlive appel sur une question sans param : ${JSON.stringify(\n        {\n          exercice,\n          question: i,\n          param: exercice.autoCorrection[i].reponse,\n        },\n      )}`,\n    )\n  }\n  const formatInteractif =\n    exercice.autoCorrection[i].reponse.param.formatInteractif ?? 'mathlive'\n  const spanReponseLigne = document.querySelector(\n    `#resultatCheckEx${exercice.numeroExercice}Q${i}`,\n  ) as HTMLSpanElement\n  // On compare le texte avec la rponse attendue en supprimant les espaces pour les deux\n  const reponses = exercice.autoCorrection[i].reponse.valeur\n  if (reponses == null) {\n    window.notify(\n      `verifQuestionMathlive: reponses est null pour la question ${i} de l'exercice ${exercice.id}`,\n      { exercice, i },\n    )\n    return {\n      isOk: false,\n      feedback: 'erreur dans le programme',\n      score: { nbBonnesReponses: 0, nbReponses: 1 },\n    }\n  }\n  const bareme: (arg: number[]) => [number, number] =\n    reponses.bareme ?? toutPourUnPoint\n  const callback = reponses.callback\n  try {\n    const variables = Object.entries(reponses).filter(\n      ([key]) => key !== 'callback' && key !== 'bareme' && key !== 'feedback',\n    )\n    if (callback != null && typeof callback === 'function') {\n      // L c'est une correction custom ! Celui qui passe une callback doit savoir ce qu'il fait !\n      // La fonction de callback gre le score et le feedback\n      // Ici, on sauvegarde les rponses dans l'objet exercice.answers\n      const mfe = document.querySelector(\n        `#champTexteEx${exercice.numeroExercice}Q${i}`,\n      ) as MathfieldElement\n      if (mfe != null) {\n        if (mfe.getValue().length > 0 && typeof exercice.answers === 'object') {\n          exercice.answers[`Ex${exercice.numeroExercice}Q${i}`] = mfe.getValue()\n        }\n        if (mfe.value.length > 0 && typeof exercice.answers === 'object') {\n          exercice.answers[`Ex${exercice.numeroExercice}Q${i}`] = mfe.value\n        }\n      }\n      return callback(exercice, i, variables, bareme)\n    }\n    if (variables.length > 1 || variables[0][0] !== 'reponse') {\n      if (variables[0][0].match(/L\\dC\\d/)) {\n        // un tableau avec Lignes (L) et Colonnes (L)\n        // Je trate le cas des tableaux  part : une question pour de multiples inputs mathlive !\n        // on pourra faire d'autres formats interactifs sur le mme modle\n        const points = []\n        let resultat = 'OK'\n        const table = document.querySelector(\n          `table#tabMathliveEx${exercice.numeroExercice}Q${i}`,\n        )\n        if (table == null) {\n          throw Error(\n            `verifQuestionMathlive: type tableauMathlive ne trouve pas le tableau dans le dom${JSON.stringify({ selecteur: `table#tabMathliveEx${exercice.numeroExercice}Q${i}` })}`,\n          )\n        }\n        const cellules = Object.entries(reponses).filter(\n          ([key]) => key.match(/L\\dC\\d/) != null,\n        )\n        for (let k = 0; k < cellules.length; k++) {\n          const [key, reponse] = cellules[k]\n          const options = reponse.options\n          noFeedback = noFeedback || Boolean(options?.noFeedback)\n          const compareFunction = reponse.compare ?? fonctionComparaison\n          const inputs = Array.from(table.querySelectorAll('math-field'))\n          const input = inputs.find(\n            (el) =>\n              el.id === `champTexteEx${exercice.numeroExercice}Q${i}${key}`,\n          ) as MathfieldElement\n          let result\n          const spanFedback = table.querySelector(\n            `span#resultatCheckEx${exercice.numeroExercice}Q${i}${key}`,\n          )\n          if (input == null || input.value === '') {\n            result = {\n              isOk: false,\n              feedback: noFeedback\n                ? ''\n                : `Vous devez saisir une rponse dans la cellule ${key}.<br>`,\n            }\n          } else {\n            if (Array.isArray(reponse.value)) {\n              let ii = 0\n              while (!result?.isOk && ii < reponse.value.length) {\n                result = compareFunction(\n                  input.value,\n                  reponse.value[ii],\n                  options,\n                )\n                ii++\n              }\n            } else {\n              result = compareFunction(input.value, reponse.value, options)\n            }\n          }\n          // On ne nettoie plus les input et les rponses, c'est la fonction de comparaison qui doit s'en charger !\n          if (result.isOk) {\n            points.push(1)\n            if (spanFedback != null) spanFedback.innerHTML = ''\n          } else {\n            points.push(0)\n            resultat = 'KO'\n            if (spanFedback != null) spanFedback.innerHTML = ''\n          }\n          if (input.value.length > 0 && typeof exercice.answers === 'object') {\n            exercice.answers[`Ex${exercice.numeroExercice}Q${i}${key}`] =\n              input.value\n          }\n        }\n        const [nbBonnesReponses, nbReponses] = bareme(points)\n        return {\n          isOk: resultat,\n          feedback: '',\n          score: { nbBonnesReponses, nbReponses },\n        }\n      }\n      if (\n        variables[0][0].match(/champ\\d/) ||\n        formatInteractif === 'fillInTheBlank'\n      ) {\n        // on n'aurait plus besoin de formatInteractif si on respecte la convention de nommage champ1, champ2...\n        // Le format fillInTheBlank requiert un \"objetReponse\" avec le format objet.\n        // cet objet contient des proprits (autant que de blancs, et ont le mme nom que les blancs crs avec la fonction remplisLesBlanc())\n        // chaque proprit a une valeur : de la forme {value: string, compare: ComparaisonFonction} c'est la valeur attendue et sa mthode de comparaison facultatitve\n        // La reponse pourrait contenir aussi une proprit callback facultative (non implment pour l'instant car pas de besoin)\n        // c'est une fonction qui serait utilise  la place de la procdure normale de traitement ci-dessous\n        // en fait ce serait la fonction de correctionInteractive 'custom' qui se trouverait avant dans l'exo et qui permet, par exemple, de raliser des traitements spciaux\n        const mfe = document.querySelector(\n          `#champTexteEx${exercice.numeroExercice}Q${i}`,\n        ) as MathfieldElement\n        if (mfe == null) {\n          throw Error(\n            `verifQuestionMathlive: type fillInTheBlank ne trouve pas le mathfieldElement dans le dom : ${JSON.stringify({ selecteur: `math-field#champTexteEx${exercice.numeroExercice}Q${i}` })}`,\n          )\n        }\n        const points = []\n        const saisies: Record<string, string> = {}\n        let feedback = ''\n        let compteurSaisiesVides = 0\n        let compteurBonnesReponses = 0\n        let noFeedback = false\n        for (let k = 0; k < variables.length; k++) {\n          const [key, reponse] = variables[k]\n          if (key === 'feedback' || key === 'bareme') continue\n          const saisie = mfe.getPromptValue(key)\n          saisies[key] = saisie\n          const compareFunction = reponse.compare ?? fonctionComparaison\n          const options = reponse.options\n          noFeedback = noFeedback || Boolean(options?.noFeedback)\n          let result\n          // On ne nettoie plus les input et les rponses, c'est la fonction de comparaison qui doit s'en charger !\n          if (saisie == null || saisie === '') {\n            compteurSaisiesVides++\n            result = { isOk: false, feedback: 'saisieVide' }\n            // result = { isOk: false, feedback: ` Pas de rponse dans la zone de saisie${variables.length > 1 ? ` N${key.charAt(key.length - 1)}` : ''}.<br>` }\n          } else {\n            if (Array.isArray(reponse.value)) {\n              let ii = 0\n              while (!result?.isOk && ii < reponse.value.length) {\n                result = compareFunction(saisie, reponse.value[ii], options)\n                ii++\n              }\n            } else {\n              result = compareFunction(saisie, reponse.value, options)\n            }\n          }\n          if (result.isOk) {\n            compteurBonnesReponses++\n            points.push(1)\n            mfe.setPromptState(key, 'correct', true)\n          } else {\n            points.push(0)\n            mfe.setPromptState(key, 'incorrect', true)\n            if (result.feedback === 'saisieVide') result.feedback = null\n            else {\n              result = {\n                isOk: false,\n                feedback:\n                  ` Le rsultat dans la zone de saisie${variables.length > 1 ? ` N${key.charAt(key.length - 1)}` : ''}  est incorrect.<br>` +\n                  sp(7),\n              }\n            }\n          }\n          mfe.classList.add('corrected')\n          if (result.feedback != null) feedback += result.feedback\n        }\n        if (compteurBonnesReponses === variables.length) feedback = ''\n        else if (compteurBonnesReponses === 0 && compteurSaisiesVides === 0) {\n          feedback =\n            variables.length === 1\n              ? \" Le rsultat n'est pas correct.\"\n              : \" Aucun rsultat n'est correct.\"\n        }\n\n        if (compteurSaisiesVides === 1) {\n          feedback += ` Il manque une rponse dans ${variables.length === 1 ? 'la' : 'une'} zone de saisie.<br>`\n        } else if (compteurSaisiesVides > 1) {\n          feedback += ` Il manque une rponse dans ${compteurSaisiesVides} zones de saisie.<br>`\n        }\n\n        if (typeof reponses.feedback === 'function') {\n          feedback += reponses.feedback(saisies)\n          const spanFeedback = document.querySelector(\n            `#feedbackEx${exercice.numeroExercice}Q${i}`,\n          )\n          if (feedback != null && spanFeedback != null && feedback.length > 0) {\n            spanFeedback.innerHTML = ` ${feedback}`\n            spanFeedback.classList.add(\n              'py-2',\n              'italic',\n              'text-coopmaths-warn-darkest',\n              'dark:text-coopmathsdark-warn-darkest',\n            )\n          }\n        }\n        const [nbBonnesReponses, nbReponses] = bareme(points)\n        if (mfe.getValue().length > 0 && typeof exercice.answers === 'object') {\n          /*    const prompts = mfe.getPrompts()\n            const answers = []\n            for (const prompt of prompts) {\n              answers.push([prompt, mfe.getPromptValue(prompt)])\n            }\n            exercice.answers[`Ex${exercice.numeroExercice}Q${i}`] = Object.assign({}, Object.fromEntries(answers))\n         */\n          exercice.answers[`Ex${exercice.numeroExercice}Q${i}`] = mfe.getValue()\n        }\n        if (spanReponseLigne != null) {\n          spanReponseLigne.innerHTML =\n            nbBonnesReponses === nbReponses ? '' : ''\n        }\n        // le feedback est dj assur par la fonction feedback(), donc on le met  ''\n        return {\n          isOk: nbBonnesReponses === nbReponses,\n          feedback: noFeedback ? '' : feedback,\n          score: { nbBonnesReponses, nbReponses },\n        }\n      }\n    }\n    // ici, il n'y a qu'un seul input une seule saisie (mme si la rponse peut contenir des variantes qui seront toutes compares  la saisie\n    champTexte = document.getElementById(\n      `champTexteEx${exercice.numeroExercice}Q${i}`,\n    ) as MathfieldElement | HTMLInputElement\n    if (champTexte == null) {\n      throw Error(\n        `verifQuestionMathlive: type ${formatInteractif} ne trouve pas le champ de saisie dans le dom ${JSON.stringify({ selecteur: `champTexteEx${String(exercice.numeroExercice)}Q${String(i)}` })}`,\n      )\n    }\n    if (champTexte.value.length > 0 && typeof exercice.answers === 'object') {\n      exercice.answers[`Ex${exercice.numeroExercice}Q${i}`] = champTexte.value\n    }\n    const saisie = champTexte.value\n    let customFeedback = ''\n    if (getCustomFeedback != null) {\n      customFeedback = getCustomFeedback({ saisie })\n    }\n    const objetReponse = reponses.reponse\n    if (objetReponse == null) {\n      window.notify(\n        `verifQuestionMathlive: objetReponse est null pour la question ${i} de l'exercice ${exercice.id}`,\n        { exercice, i },\n      )\n      return {\n        isOk: false,\n        feedback: 'erreur dans le programme',\n        score: { nbBonnesReponses: 0, nbReponses: 1 },\n      }\n    }\n\n    const options = objetReponse.options ?? {}\n    noFeedback = options.noFeedback ?? false\n    if (saisie == null || saisie === '') {\n      return {\n        isOk: false,\n        feedback: noFeedback ? '' : 'Vous devez saisir une rponse.',\n        score: { nbBonnesReponses: 0, nbReponses: 1 },\n      }\n    }\n    let isOk = false\n    let ii = 0\n    let reponse\n    let feedback = ''\n    const compareFunction = objetReponse.compare ?? fonctionComparaison\n\n    if (Array.isArray(objetReponse.value)) {\n      while (!isOk && ii < objetReponse.value.length) {\n        reponse = objetReponse.value[ii]\n        const check = compareFunction(saisie, reponse, options)\n        if (check.isOk) {\n          isOk = true\n          feedback = ''\n          break\n        }\n        if (check.feedback) {\n          feedback = check.feedback\n        }\n        ii++\n      }\n    } else {\n      reponse = objetReponse.value\n      const check = compareFunction(saisie, reponse, options)\n      if (check.isOk) {\n        isOk = true\n        feedback = check.feedback ?? ''\n      } else if (check.feedback) {\n        feedback = check.feedback ?? ''\n      }\n    }\n\n    if (spanReponseLigne != null) {\n      spanReponseLigne.innerHTML = ''\n      if (customFeedback.length > 0) {\n        feedback = `${feedback} ${feedback.length > 0 ? '<br>' : ''} ${customFeedback}`\n      }\n      if (isOk) {\n        spanReponseLigne.innerHTML = ''\n        spanReponseLigne.style.fontSize = 'large'\n        champTexte.readOnly = true\n        return {\n          isOk,\n          feedback: noFeedback ? '' : feedback,\n          score: { nbBonnesReponses: 1, nbReponses: 1 },\n        }\n      }\n      if (writeResult) {\n        spanReponseLigne.innerHTML = ''\n        spanReponseLigne.style.fontSize = 'large'\n        champTexte.readOnly = true\n        return {\n          isOk,\n          feedback: noFeedback ? '' : feedback,\n          score: { nbBonnesReponses: 0, nbReponses: 1 },\n        }\n      }\n      return {\n        isOk,\n        feedback: noFeedback ? '' : feedback,\n        score: { nbBonnesReponses: isOk ? 1 : 0, nbReponses: 1 },\n      } // ce code n'est jamais excut vu que writeResult est toujours true\n    }\n  } catch (error) {\n    window.notify(\n      `Erreur dans verif QuestionMathLive : ${error}\\n Avec les mtadonnes : `,\n      {\n        champTexteValue: champTexte?.value ?? null,\n        exercice: exercice?.id,\n        i,\n        autoCorrection: exercice?.autoCorrection[i],\n        formatInteractif,\n        spanReponseLigne,\n      },\n    )\n    return {\n      isOk: false,\n      feedback: 'erreur dans le programme',\n      score: { nbBonnesReponses: 0, nbReponses: 1 },\n    }\n  }\n}\n\n// # sourceMappingURL=mathLive.js.map\n","import { addElement, addText, get } from '../lib/html/dom'\n/**\n * Fonctions pour grer les messages utilisateur (feedback erreur|warning ou messages positifs)\n * @module\n */\n\n/**\n * Les types possibles\n * @type {string[]}\n */\nconst types = ['info', 'warning', 'error', 'positive']\n\n/**\n * Ajoute le feedback dans container\n * @param {HTMLElement} container\n * @param {Object} feedback\n * @param {string} feedback.message\n * @param {string} [feedback.type=error]\n * @param {string} [feedback.titre]\n * @return {HTMLElement} L'lment du feedback (dj ajout dans le container)\n */\nexport function addFeedback(\n  container,\n  { message, type = 'error', titre } = {},\n) {\n  if (!types.includes(type)) {\n    console.error(Error(`type de message inconnu : ${type}`))\n    type = 'error'\n  }\n  if (!message) throw Error('Message obligatoire pour tout retour utilisateur')\n  const cssDiv = type === 'info' ? '' : type\n  const div = addElement(container, 'div', {\n    className: `ui message ${cssDiv}`,\n  })\n  const cssIcon =\n    type === 'error'\n      ? 'frown outline'\n      : type === 'warning'\n        ? 'bullhorn'\n        : 'bell outline' // info\n  const iconClose = addElement(div, 'i', { className: 'close icon' })\n  iconClose.addEventListener('click', () => div.remove())\n  if (titre) {\n    const divTitre = addElement(div, 'div', { className: 'header' })\n    addElement(divTitre, 'i', { className: `${cssIcon} icon` })\n    addText(divTitre, titre)\n  }\n  if (/<[a-zA-Z0-9_ \"']+/.test(message)) div.innerHTML += message\n  else addText(div, message)\n  return div\n}\n\n/**\n * Ajoute un feedback (erreur ou encouragement)\n * @param {Object} feedback\n * @param {string} feedback.id id du div conteneur  utiliser\n * @param {string} feedback.message Le message  afficher\n * @param {string} feedback.type error|positive\n * @author Rmi ANGOT\n */\nexport function messageFeedback({ id, message = '', type = 'error' } = {}) {\n  if (!id || !message) return console.error(TypeError('arguments manquants'))\n  const container = get(id)\n  const div = addFeedback(container, { message, type })\n  div.style.width = '400px'\n  div.classList.add('my-2', 'p-1')\n  if (type === 'error') {\n    div.classList.add('bg-coopmaths-action-200', 'rounded-lg', 'p-3')\n  } else if (type === 'positive') {\n    div.classList.add('bg-coopmaths-warn-100', 'rounded-lg', 'p-3')\n  } else {\n    div.style.color = 'rgb(33,109,54)'\n  }\n  return div\n}\n\nexport class UserFriendlyError extends Error {\n  /**\n   * Erreur destine  tre affiche  l'utilisateur\n   * @param {string} [message] Si non fourni ce sera le texte gnrique 'Une erreur est survenue\n   * @param {Object} [options]\n   * @param {string} [options.titre=Erreur interne]\n   * @param {string} [options.type=error]\n   */\n  constructor(message, { titre, type } = {}) {\n    if (!message)\n      message =\n        'Une erreur est survenue.<br>Essayez de rafraichir la page.<br>Si l\\'erreur persiste merci de contacter : <a href=\"mailto:contact@coopmaths.fr\">contact@coopmaths.fr</a>'\n    super(message)\n    this.isUserFriendly = true // pour indiquer que le message peut tre affich tel quel  l'utilisateur\n\n    this.type = (types.includes(type) && type) || 'error'\n  }\n}\n\nexport const getInvalidModuleError = (path) =>\n  new UserFriendlyError(\n    `${path} existe mais ne fournit pas les donnes attendues, impossible de charger cet exercice`,\n  )\nexport const getNoLatexError = (id) =>\n  new UserFriendlyError(\n    `L'exercice ${id} n'a, pour l'instant, pas de version Latex`,\n    { titre: 'Pas de contenu Latex pour cet exercice', type: 'warning' },\n  )\nexport const getUnknownError = (id) =>\n  new UserFriendlyError(\n    `L'identifiant ${id} ne correspond  aucun exercice MathALEA.<br>Ceci est peut-tre d  un lien incomplet ou obsolte.`,\n    { titre: 'Le code de lexercice nest pas valide' },\n  )\n\n/**\n * Gestionnaire d'erreur gnrique ( mettre dans un catch). Il affichera l'erreur  l'utilisateur en cas de UserFriendlyError, ou le message d'erreur par dfaut\n * @param {Error} error\n */\nexport function errorHandler(error) {\n  // on sort toujours l'erreur d'origine en console\n  console.error(error)\n  // et on gre un retour utilisateur\n  const container = get('containerErreur')\n  if (!error.isUserFriendly) error = new UserFriendlyError() // le message d'erreur par dfaut\n  addFeedback(container, error)\n}\n","import type Exercice from '../../exercices/Exercice'\nimport { lettreDepuisChiffre } from '../outils/outilString'\n\nexport function shuffleJusquaWithIndexes(array: unknown[], lastChoice: number) {\n  // Crer une copie du tableau d'entre\n  const newArray = array.map((item) => JSON.parse(JSON.stringify(item)))\n  const indexes = Array.from({ length: array.length }, (_, i) => i)\n\n  // Mlanger les lments jusqu' l'index lastChoice\n  for (let i = lastChoice; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1))\n    ;[newArray[i], newArray[j]] = [newArray[j], newArray[i]]\n    ;[indexes[i], indexes[j]] = [indexes[j], indexes[i]]\n  }\n\n  // Retourner le tableau mlang et les index\n  return { shuffledArray: newArray, indexes }\n}\n\nexport function qcmCamExport(\n  exercice: Exercice,\n): { question: string; reponse: string }[] {\n  const questions: { question: string; reponse: string }[] = []\n  if (exercice.autoCorrection.length !== exercice.listeQuestions.length)\n    return []\n  for (let j = 0; j < exercice.autoCorrection.length; j++) {\n    const propositions = exercice.autoCorrection[j].propositions\n    if (propositions == null) continue\n    if (propositions.length > 4) continue\n    const laConsigne =\n      exercice.consigne.replaceAll(\n        /\\$([^$]*)\\$/g,\n        '<span class=\"math-tex\">$1</span>',\n      ) ?? ''\n    const introduction =\n      exercice.introduction.replaceAll(\n        /\\$([^$]*)\\$/g,\n        '<span class=\"math-tex\">$1</span>',\n      ) ?? ''\n    const laQuestion = exercice.listeQuestions[j]\n    const enonceBis = laQuestion\n      .split('<div class=\"my-3\">')[0]\n      .replaceAll(/\\$([^$]*)\\$/g, '<span class=\"math-tex\">$1</span>')\n    let enonce: string\n    if (\n      exercice.autoCorrection[j].enonce != null &&\n      exercice.autoCorrection[j].enonce !== ''\n    ) {\n      enonce = `${j === 0 || !laConsigne.startsWith('Parmi les') ? laConsigne : ''}${\n        j === 0 && laConsigne !== '' ? '<br>' : ''\n      }\n        ${introduction != null ? introduction : ''}\n          ${introduction != null && introduction !== '' ? '<br>' : ''}\n            ${\n              exercice.autoCorrection[j].enonce != null\n                ? exercice.autoCorrection[j].enonce\n                    ?.replaceAll(/&nbsp;/g, ' ')\n                    .replaceAll(\n                      /\\$([^$]*)\\$/g,\n                      '<span class=\"math-tex\">$1</span>',\n                    )\n                : ''\n            }`\n    } else {\n      enonce = `${j === 0 ? laConsigne : ''}${\n        j === 0 && laConsigne !== '' ? '<br>' : ''\n      }\n       ${introduction != null ? introduction : ''}\n         ${introduction != null && introduction !== '' ? '<br>' : ''}\n           ${enonceBis.replaceAll(/&nbsp;/g, ' ')}`\n    }\n\n    const props = propositions.map((prop) => prop.texte)\n    const statuts = propositions.map((prop) => prop.statut)\n    let question = `<h3 data-translate=\"{&quot;html&quot;:&quot;questions.defaultquestion&quot;}\">${enonce?.replaceAll(/\\$([^$]*)\\$/g, '<span class=\"math-tex\">$1</span>')}</h3><ol>`\n    let reponse = ''\n    for (let i = 0; i < props.length; i++) {\n      const prop = props[i].replaceAll(\n        /\\$([^$]*)\\$/g,\n        '<span class=\"math-tex\">$1</span>',\n      )\n      const bonneReponse = statuts[i]\n      question += `<li${bonneReponse ? ' class=\"rondvert\"' : ''}>${prop}</li>`\n      if (bonneReponse) reponse = lettreDepuisChiffre(i + 1)\n    }\n    question += '</ol>'\n    questions.push({ question, reponse })\n  }\n  return questions\n}\n\nexport function qcmCamExportAll(exercices: Exercice[]): string {\n  const questionnaire = []\n  const listExercices = exercices.slice() // exercices.filter(exo => exo.interactifType === 'qcm')\n  let index = 0\n  for (const exo of listExercices) {\n    const materiel = qcmCamExport(exo)\n    for (const { question, reponse } of materiel) {\n      questionnaire.push([String(index++), { question, reponse }])\n    }\n  }\n  const questions = questionnaire.map(\n    ([index, exo]) => `\"${index}\":${JSON.stringify(exo)}`,\n  )\n  const leJson = `{${questions.join(',')}}`\n  return leJson\n}\n","import type Exercice from '../../exercices/Exercice'\n\nexport type ResultOfExerciceInteractif = {\n  numberOfPoints: number\n  numberOfQuestions: number\n}\n\nexport function afficheScore(\n  exercice: Exercice,\n  nbBonnesReponses: number,\n  nbMauvaisesReponses: number,\n  divScore?: HTMLDivElement,\n  divButton?: HTMLButtonElement,\n): ResultOfExerciceInteractif {\n  if (divButton != null) {\n    divButton.classList.add(\n      'cursor-not-allowed',\n      'opacity-50',\n      'pointer-events-none',\n    )\n  }\n  if (divScore != null) {\n    divScore.innerHTML = `${nbBonnesReponses} / ${nbBonnesReponses + nbMauvaisesReponses}`\n    divScore.style.color = '#f15929'\n    divScore.style.fontWeight = 'bold'\n    divScore.style.fontSize = 'x-large'\n    divScore.style.display = 'inline'\n  }\n  return {\n    numberOfPoints: nbBonnesReponses,\n    numberOfQuestions: nbBonnesReponses + nbMauvaisesReponses,\n  }\n}\n","import type Exercice from '../../exercices/Exercice'\nimport { context } from '../../modules/context'\nimport { messageFeedback } from '../../modules/messages'\nimport { shuffleJusquaWithIndexes } from '../amc/qcmCam'\nimport { get } from '../html/dom'\nimport {\n  barreTexte,\n  miseEnEvidence,\n  texteEnCouleurEtGras,\n  texteGras,\n} from '../outils/embellissements'\nimport { lettreDepuisChiffre } from '../outils/outilString'\nimport { afficheScore } from './afficheScore'\nimport type { ButtonWithMathaleaListener } from './gestionCan'\nimport type { UneProposition } from './gestionInteractif'\n\nexport function verifQuestionQcm(exercice: Exercice, i: number) {\n  let resultat\n  // i est l'indice de la question\n  let nbBonnesReponses = 0\n  let nbMauvaisesReponses = 0\n  let nbBonnesReponsesAttendues = 0\n  if (exercice.answers == null) {\n    exercice.answers = {}\n  }\n  // Compte le nombre de rponses justes attendues\n  const nbReps = exercice.autoCorrection[i].propositions?.length ?? 0\n  for (let k = 0; k < nbReps; k++) {\n    if (exercice.autoCorrection[i]!.propositions![k].statut) {\n      nbBonnesReponsesAttendues++\n    }\n  }\n  const divReponseLigne = document.querySelector(\n    `#resultatCheckEx${exercice.numeroExercice}Q${i}`,\n  ) as HTMLDivElement\n  exercice.autoCorrection[i]!.propositions!.forEach((proposition, indice) => {\n    // La liste de question peut tre plus courte que autoCorrection si on n'a pas russi  gnrer suffisamment de questions diffrentes\n    // if (exercice.listeQuestions[i] !== undefined) {\n    // On a des exercices comme 6S10-1 o il y a 2 questions... mais 6 qcm !\n    const label = document.querySelector(\n      `#labelEx${exercice.numeroExercice}Q${i}R${indice}`,\n    ) as HTMLLabelElement\n    const check = document.querySelector(\n      `#checkEx${exercice.numeroExercice}Q${i}R${indice}`,\n    ) as HTMLInputElement\n    if (check != null) {\n      if (check.checked) {\n        // Sauvegarde pour les exports Moodle, Capytale...\n        exercice.answers![`Ex${exercice.numeroExercice}Q${i}R${indice}`] = '1'\n        // Gestion du feedback de toutes les cases coches\n        if (exercice.autoCorrection[i].propositions![indice].feedback) {\n          messageFeedback({\n            id: `feedbackEx${exercice.numeroExercice}Q${i}R${indice}`,\n            message: exercice.autoCorrection[i].propositions![indice].feedback,\n            type: proposition.statut ? 'positive' : 'error',\n          })\n        }\n      } else {\n        exercice.answers![`Ex${exercice.numeroExercice}Q${i}R${indice}`] = '0'\n      }\n      if (proposition.statut) {\n        if (check.checked === true) {\n          nbBonnesReponses++\n          label.classList.add('bg-coopmaths-warn-100', 'rounded-lg', 'p-1')\n        } else {\n          // Bonnes rponses non coches\n          label.classList.add('bg-coopmaths-warn-100', 'rounded-lg', 'p-1')\n        }\n      } else if (check.checked === true) {\n        label.classList.add('bg-coopmaths-action-200', 'rounded-lg', 'p-1')\n        nbMauvaisesReponses++\n      }\n      check.disabled = true\n    }\n  })\n  let typeFeedback = 'positive'\n  if (\n    nbMauvaisesReponses === 0 &&\n    nbBonnesReponses === nbBonnesReponsesAttendues\n  ) {\n    if (divReponseLigne) divReponseLigne.innerHTML = ''\n    resultat = 'OK'\n  } else {\n    if (divReponseLigne) divReponseLigne.innerHTML = ''\n    typeFeedback = 'error'\n    resultat = 'KO'\n  }\n  // Gestion du feedback global de la question\n  if (divReponseLigne) divReponseLigne.style.fontSize = 'large'\n  const eltFeedback = get(`feedbackEx${exercice.numeroExercice}Q${i}`, false)\n  let message = ''\n  if (eltFeedback) {\n    eltFeedback.innerHTML = ''\n  }\n  if (resultat === 'KO') {\n    // Juste mais incomplet\n    if (\n      nbBonnesReponses > 0 &&\n      nbMauvaisesReponses === 0 &&\n      nbBonnesReponses < nbBonnesReponsesAttendues\n    ) {\n      message = `${nbBonnesReponses} bonne${nbBonnesReponses > 1 ? 's' : ''} rponse${nbBonnesReponses > 1 ? 's' : ''}`\n    } else if (nbBonnesReponses > 0 && nbMauvaisesReponses > 0) {\n      // Du juste et du faux\n      message = `${nbMauvaisesReponses} erreur${nbMauvaisesReponses > 1 ? 's' : ''}`\n    } else if (nbBonnesReponses === 0 && nbMauvaisesReponses > 0) {\n      // Que du faux\n      message = `${nbMauvaisesReponses} erreur${nbMauvaisesReponses > 1 ? 's' : ''}`\n    }\n  } else {\n    message = ''\n  }\n  if (nbBonnesReponsesAttendues > nbBonnesReponses) {\n    message += ` ${nbBonnesReponsesAttendues - nbBonnesReponses} bonne${nbBonnesReponsesAttendues - nbBonnesReponses > 1 ? 's' : ''} rponse${nbBonnesReponsesAttendues - nbBonnesReponses > 1 ? 's' : ''} manquante${nbBonnesReponsesAttendues - nbBonnesReponses > 1 ? 's' : ''}`\n  }\n  if (message !== '') {\n    messageFeedback({\n      id: `resultatCheckEx${exercice.numeroExercice}Q${i}`,\n      message,\n      type: typeFeedback,\n    })\n  }\n  return resultat\n}\n\n/**\n * @param {exercice}\n * @param {number} i indice de la question\n * @param {{style: string, format: string}} [options]\n * @returns {{texte: string, texteCorr: string}} {texte, texteCorr} le texte  ajouter pour la question traite\n */\nexport function propositionsQcm(\n  exercice: Exercice,\n  i: number,\n  options: { style: string; format: string } = { style: '', format: 'case' },\n) {\n  /**\n   * Mlange les lments d'un tableau jusqu' un certain index et laisse les suivants inchangs.\n   * @param {Array} array - Le tableau  mlanger.\n   * @param {number} lastChoice - L'index jusqu'auquel mlanger les lments.\n   * @returns {{shuffledArray: Array, indexes: Array}} - Le tableau mlang et les index des anciens lments dans le nouvel ordre.\n   */\n  const indexes = []\n  let texte = ''\n  let texteCorr = ''\n  let espace = ''\n  let nbCols = 1\n  let vertical = false\n  const classCss =\n    options?.style != null && options.style !== ''\n      ? `class=\"ml-2\" style=\"${options.style};\" `\n      : 'class=\"ml-2\"'\n  if (context.isAmc) return { texte: '', texteCorr: '' }\n  if (exercice?.autoCorrection[i]?.propositions === undefined) {\n    window.notify(\n      'propositionsQcm a reu une liste de propositions undefined',\n      {\n        autoCrorrection: exercice?.autoCorrection[i],\n        propositions: exercice?.autoCorrection[i].propositions,\n      },\n    )\n    return { texte: '', texteCorr: '' }\n  } else if (exercice.autoCorrection[i].propositions.length === 0) {\n    window.notify('propositionsQcm a reu une liste de propositions vide', {\n      autoCrorrection: exercice.autoCorrection[i],\n      propositions: exercice.autoCorrection[i].propositions,\n    })\n    return { texte: '', texteCorr: '' }\n  } else if (exercice.autoCorrection[i].propositions.length === 1) {\n    window.notify(\n      'propositionsQcm a reu une liste de propositions de taille 1',\n      {\n        autoCrorrection: exercice.autoCorrection[i],\n        propositions: exercice.autoCorrection[i].propositions,\n      },\n    )\n    return { texte: '', texteCorr: '' }\n  }\n\n  // On regarde si il n'y a pas de doublons dans les propositions de rponse. Si c'est le cas, on enlve les mauvaises rponses en double.\n  elimineDoublons(exercice.autoCorrection[i].propositions)\n  if (context.isHtml) {\n    espace = '&emsp;'\n    if (exercice?.autoCorrection[i].reponse == null) {\n      exercice.autoCorrection[i].reponse = {}\n    }\n    if (exercice.autoCorrection[i].reponse.param == null) {\n      exercice.autoCorrection[i].reponse.param = {}\n    }\n    exercice.autoCorrection[i].reponse.param.formatInteractif = 'qcm'\n  } else {\n    espace = '\\\\qquad '\n  }\n  // Mlange les propositions du QCM sauf celles  partir de lastchoice (inclus)\n  const lastChoice = Math.min(\n    exercice.autoCorrection[i].options?.lastChoice ??\n      exercice.autoCorrection[i].propositions.length,\n    exercice.autoCorrection[i].propositions.length - 1,\n  )\n  vertical = exercice.autoCorrection[i].options?.vertical ?? false // est-ce qu'on veut une prsentation en colonnes ?\n  nbCols = Math.min(exercice.autoCorrection[i].options?.nbCols ?? 1, 1)\n  const isTrueFalse =\n    exercice.autoCorrection[i].propositions.some(\n      (prop) => prop.texte === 'Vrai',\n    ) &&\n    exercice.autoCorrection[i].propositions.some(\n      (prop) => prop.texte === 'Faux',\n    )\n  if (isTrueFalse) {\n    // Si on a les rponses Vrai et Faux, on les met en premier\n    const vrai = exercice.autoCorrection[i].propositions.findIndex(\n      (prop) => prop.texte === 'Vrai',\n    )\n    const faux = exercice.autoCorrection[i].propositions.findIndex(\n      (prop) => prop.texte === 'Faux',\n    )\n    if (vrai !== -1 && faux !== -1) {\n      // On les met en premier\n      const vraiProp = exercice.autoCorrection[i].propositions[vrai]\n      const fauxProp = exercice.autoCorrection[i].propositions[faux]\n      exercice.autoCorrection[i].propositions.splice(vrai, 1)\n      exercice.autoCorrection[i].propositions.splice(faux - 1, 1)\n      exercice.autoCorrection[i].propositions.unshift(fauxProp)\n      exercice.autoCorrection[i].propositions.unshift(vraiProp)\n    }\n  }\n  if (!exercice.autoCorrection[i].options?.ordered && !isTrueFalse) {\n    const melange = shuffleJusquaWithIndexes(\n      exercice.autoCorrection[i].propositions,\n      lastChoice,\n    )\n    exercice.autoCorrection[i].propositions = melange.shuffledArray\n    indexes.push(...melange.indexes)\n  }\n  if (!context.isHtml) {\n    const formateQ = (format: string, rep: number) => {\n      if (format == null || format === 'case') return '$\\\\square\\\\;$'\n      if (format === 'lettre') {\n        return `${texteGras(lettreDepuisChiffre(rep + 1))}.`\n      }\n      return `${texteGras(lettreDepuisChiffre(rep + 1))}$\\\\square\\\\;$`\n    }\n    const formateRV = (format: string, rep: number) => {\n      if (format == null || format === 'case') return '$\\\\blacksquare\\\\;$'\n      if (format === 'lettre') {\n        return `${texteEnCouleurEtGras(lettreDepuisChiffre(rep + 1))}.`\n      }\n      return `${texteEnCouleurEtGras(lettreDepuisChiffre(rep + 1))}$\\\\blacksquare\\\\;$`\n    }\n    const formateRF = (format: string, rep: number) => {\n      if (format == null || format === 'case') return '$\\\\square\\\\;$'\n      if (format === 'lettre') {\n        return `$${miseEnEvidence(`\\\\cancel{\\\\text{${lettreDepuisChiffre(rep + 1)}}}`, 'black')}$.`\n      }\n      return `$${miseEnEvidence(`\\\\cancel{\\\\text{${lettreDepuisChiffre(rep + 1)}}}`, 'black')}\\\\square\\\\;$`\n    }\n    texte += nbCols === 1 ? '\\t' : `\\n\\n\\\\begin{multicols}{${nbCols}}\\n\\t`\n    texteCorr += nbCols === 1 ? '\\t' : `\\n\\n\\\\begin{multicols}{${nbCols}}\\n\\t`\n    for (\n      let rep = 0;\n      rep < exercice.autoCorrection[i].propositions.length;\n      rep++\n    ) {\n      texte += `${formateQ(options?.format, rep)} ${exercice.autoCorrection[i].propositions[rep].texte}`\n      if (exercice.autoCorrection[i].propositions[rep].statut) {\n        texteCorr += `${formateRV(options?.format, rep)} ${exercice.autoCorrection[i].propositions[rep].texte}`\n      } else {\n        texteCorr += `${formateRF(options?.format, rep)} ${exercice.autoCorrection[i].propositions[rep].texte}`\n      }\n      if (vertical) {\n        texte += '\\\\\\\\\\n\\t'\n        texteCorr += '\\\\\\\\\\n\\t'\n      } else {\n        texte += '\\\\qquad '\n        texteCorr += '\\\\qquad '\n      }\n    }\n    texte += nbCols === 1 ? '' : '\\\\end{multicols}'\n    texteCorr += nbCols === 1 ? '' : '\\\\end{multicols}'\n  }\n  if (context.isHtml) {\n    const isRadio = exercice.autoCorrection[i].options?.radio ?? false\n    const formateQ = (format: string, rep: number) => {\n      if (format == null || format === 'case') { return `<input type=\"${isRadio ? 'radio' : 'checkbox'}\" name=\"checkEx${exercice.numeroExercice}Q${i}\" ${exercice.interactif ? '' : 'disabled'} tabindex=\"0\" style=\"height: 1rem; width: 1rem;\" class=\"disabled:cursor-default\" id=\"checkEx${exercice.numeroExercice}Q${i}R${rep}\">` }\n      if (format === 'lettre') {\n        return `<label ${classCss} >${texteGras(lettreDepuisChiffre(rep + 1))}.</label>`\n      }\n      return `<input type=\"${isRadio ? 'radio' : 'checkbox'}\" name=\"checkEx${exercice.numeroExercice}Q${i}\" ${exercice.interactif ? '' : 'disabled'} tabindex=\"0\" style=\"height: 1rem; width: 1rem;\" class=\"disabled:cursor-default\" id=\"checkEx${exercice.numeroExercice}Q${i}R${rep}\"><label ${classCss} >${lettreDepuisChiffre(rep + 1)}.</label>`\n    }\n    const formateRV = (format: string, rep: number) => {\n      if (format == null || format === 'case') { return `<input type=\"${isRadio ? 'radio' : 'checkbox'}\" name=\"checkEx${exercice.numeroExercice}Q${i}\" tabindex=\"0\" style=\"height: 1rem; width: 1rem;\" class=\"disabled:cursor-default\" checked>` }\n      if (format === 'lettre') {\n        return `<label ${classCss} >${texteEnCouleurEtGras(lettreDepuisChiffre(rep + 1))}.</label>`\n      }\n      return `<input type=\"${isRadio ? 'radio' : 'checkbox'}\" name=\"checkEx${exercice.numeroExercice}Q${i}\" ${exercice.interactif ? '' : 'disabled'} tabindex=\"0\" style=\"height: 1rem; width: 1rem;\" class=\"disabled:cursor-default\" checked><label ${classCss} >${texteEnCouleurEtGras(lettreDepuisChiffre(rep + 1))}.</label>`\n    }\n    const formateRF = (format: string, rep: number) => {\n      if (format == null || format === 'case') { return `<input type=\"${isRadio ? 'radio' : 'checkbox'}\" name=\"checkEx${exercice.numeroExercice}Q${i}\" tabindex=\"0\" style=\"height: 1rem; width: 1rem;\" class=\"disabled:cursor-default\">` }\n      if (format === 'lettre') {\n        return `<label ${classCss} >${texteGras(`${barreTexte(lettreDepuisChiffre(rep + 1))}`)}.</label>`\n      }\n      return `<input type=\"${isRadio ? 'radio' : 'checkbox'}\" name=\"checkEx${exercice.numeroExercice}Q${i}\" ${exercice.interactif ? '' : 'disabled'} tabindex=\"0\" style=\"height: 1rem; width: 1rem;\" class=\"disabled:cursor-default\"><label ${classCss} >$${miseEnEvidence(`\\\\cancel{${lettreDepuisChiffre(rep + 1)}}`, 'black')}$.</label>`\n    }\n\n    texte = '<div class=\"my-3\">'\n    texteCorr = '<div class=\"my-3\">'\n    for (\n      let rep = 0;\n      rep < exercice.autoCorrection[i].propositions.length;\n      rep++\n    ) {\n      if (nbCols > 1 && rep % nbCols === 0) texte += '<br>'\n      texte += `<div class=\"ex${exercice.numeroExercice} ${vertical ? '' : 'inline-block'} my-2 align-center\">\n      ${formateQ(options?.format, rep)}\n      <label id=\"labelEx${exercice.numeroExercice}Q${i}R${rep}\" ${classCss} >${exercice.autoCorrection[i].propositions[rep].texte + espace}</label>\n      <div id=\"feedbackEx${exercice.numeroExercice}Q${i}R${rep}\" ${vertical ? '' : 'class=\"inline\"'}></div></div>`\n      texteCorr += `<div class=\"${vertical ? '' : 'inline-block'}\">\n    ${\n      exercice.autoCorrection[i].propositions[rep].statut\n        ? formateRV(options?.format, rep)\n        : formateRF(options?.format, rep)\n    }\n      <label id=\"labelEx${exercice.numeroExercice}Q${i}R${rep}\" ${classCss} >${exercice.autoCorrection[i].propositions[rep].texte + espace}</label>\n      </div>`\n    }\n    texte += `</div><div class=\"m-2\" id=\"resultatCheckEx${exercice.numeroExercice}Q${i}\"></div>`\n    texteCorr += '</div><div class=\"m-2\"></div>'\n  }\n  if (!context.isHtml) {\n    texte =\n      ` \n    \n    ` + texte\n    texteCorr =\n      ` \n    \n    ` + texteCorr\n  }\n  return { texte, texteCorr, indexes }\n}\n\n/**\n * Lorsque l'vnement 'exercicesAffiches' est lanc par mathalea.js\n * on vrifie la prsence du bouton de validation d'id btnValidationEx{i} cr par listeQuestionsToContenu\n * et on y ajoute un listenner pour vrifier les rponses coches\n * @param {object} exercice\n */\nexport function exerciceQcm(exercice: Exercice) {\n  document.addEventListener('exercicesAffiches', () => {\n    // On vrifie le type si jamais il a t chang aprs la cration du listenner (voir 5R20)\n    if (exercice.interactifType === 'qcm') {\n      const button = document.querySelector(\n        `#btnValidationEx${exercice.numeroExercice}-${exercice.id}`,\n      ) as ButtonWithMathaleaListener\n      if (button) {\n        if (!button.hasMathaleaListener) {\n          button.addEventListener('click', () => {\n            let nbQuestionsValidees = 0\n            let nbQuestionsNonValidees = 0\n            for (let i = 0; i < exercice.autoCorrection.length; i++) {\n              const resultat = verifQuestionQcm(exercice, i)\n              resultat === 'OK'\n                ? nbQuestionsValidees++\n                : nbQuestionsNonValidees++\n            }\n            const uichecks = document.querySelectorAll(\n              `.ui.checkbox.ex${exercice.numeroExercice}`,\n            )\n            for (const uicheck of uichecks) {\n              uicheck.classList.add('read-only')\n            }\n            button.classList.add('disabled')\n            afficheScore(exercice, nbQuestionsValidees, nbQuestionsNonValidees)\n          })\n          button.hasMathaleaListener = true\n        }\n      }\n    }\n  })\n}\n\n/**\n * prend un tableau de propositions [{texte: 'prop1', statut: true, feedback: 'Correct !'}, {texte: 'prop2', statut: false, ....}\n * limine en cas de doublon la proposition fausse ou la deuxime proposition si elle sont toutes les deux fausses.\n * @author Jean-Claude Lhote\n */\nexport function elimineDoublons(propositions: UneProposition[]) {\n  // fonction qui va liminer les doublons si il y en a\n  let doublonsTrouves = false\n  for (let i = 0; i < propositions.length - 1; i++) {\n    for (let j = i + 1; j < propositions.length; ) {\n      if (propositions[i].texte === propositions[j].texte) {\n        // les rponses i et j sont les mmes\n        doublonsTrouves = true\n        if (propositions[i].statut) {\n          // si la rponse i est bonne, on vire la j\n          propositions.splice(j, 1)\n        } else if (propositions[j].statut) {\n          // si la rponse i est mauvaise et la rponse j bonne,\n          // comme ce sont les mmes rponses, on vire la j mais on met la i bonne\n          propositions.splice(j, 1)\n          propositions[i].statut = true\n        } else {\n          // Les deux rponses sont mauvaises\n          propositions.splice(j, 1)\n        }\n      } else {\n        j++\n      }\n    }\n  }\n  return doublonsTrouves\n}\n","import { renderMathInElement } from 'mathlive'\n\ntype EventListener = (event?: Event) => void\ntype KeyboardEventListener = (event: KeyboardEvent) => void\n\ninterface CHoiceValue {\n  latex?: string\n  image?: string\n  label?: string\n  value: string\n  svg?: string\n}\n\n/**\n * Vide chaque Element (html ou svg) pass en paramtre de tout son contenu.\n * On peut passer autant de paramtres que l'on veut, les null|undefined seront ignors silencieusement\n * @param {...Element} elts\n */\nfunction empty(...elts: Element[]): void {\n  for (const elt of elts) {\n    if (elt == null) continue\n    while (elt?.lastChild != null) elt.removeChild(elt.lastChild)\n  }\n}\n\n// Trois types de choix : simple string, {label: string, value: string} ou {latex?: string, image?: string, text?: string, value: string}\n// C'est redondant : pour le type string, label et value prennent la valeur de la string, pour le type {label, value} c'est directement les valeurs utilises (parfois le label affich peut tre un peu long et on peut avoir envie de rsumer   un mot la value), pour le troisime latex permet de fournir du latex en math-inline sans dlimiteurs, image, c'est l'url d'une image (absolue ? ou relative au dossier courant donc src/lib/outils/listeDeroulante), text, c'est pareil que label, donc en fait, n'a pas beaucoup d'intrt, on peut fondre le deuxime dans le troisime...\n// On peut mixer les diffrentes formes :\n// choices: AllChoicesType = [{image: 'src/section/datasExemple/firefox.png', value: 'firefox'},\n//            {latex: '\\\\frac{\\\\sqrt{3}}{2}',value: 'sinusPiSur3'},\n//            {label: \"n'est pas dfinie en zro\", value: 'noF0'}\n//            'Je ne sais pas']\nexport type AllChoiceType = CHoiceValue\nexport type AllChoicesType = AllChoiceType[]\n\n// @todo faire voluer cette fonction vers un renderToString() directement dans le li lorsque mathlive sera en version 1.0 ou plus.\nfunction renderLatexToHTMLFragment(\n  li: HTMLLIElement | HTMLSpanElement,\n  latex: string,\n): void {\n  li.innerHTML = `$$${latex}$$`\n  renderMathInElement(li)\n  const spanToInvisible = li.querySelectorAll('span')\n  if (spanToInvisible.length > 2) {\n    spanToInvisible[2].style.display = 'none'\n  }\n}\n\n// Usage :\n\n/**\n * La fonction qui affiche l'un des choix, que ce soit du texte, du latex ou une image.\n * @param {HTMLLIElement} li l'lment de liste qui doit contenir le choix\n * @param {AllChoiceType} choice le choix en question\n */\nfunction afficheChoice(\n  li: HTMLLIElement | HTMLSpanElement,\n  choice: AllChoiceType | undefined,\n) {\n  // Les textes sont naturellement aligns avec li.textAlign, mais pas les images ou les math-field\n  if (choice == null) return\n  if (typeof choice === 'object') {\n    if ('latex' in choice) {\n      renderLatexToHTMLFragment(li, choice.latex ?? '')\n    } else if ('image' in choice) {\n      const image = document.createElement('img')\n      image.src = choice.image ?? choice.value\n      image.style.width = '30px'\n      image.style.height = '30px'\n      li.appendChild(image)\n    } else if ('label' in choice) {\n      const span = document.createElement('span')\n      span.innerHTML = choice.label ?? choice.value\n      li.appendChild(span)\n    } else if ('svg' in choice) {\n      const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n      svg.setAttribute('viewBox', '-10 -10 20 20') // Valeur par dfaut, peut tre ajuste\n      svg.classList.add('svgChoice')\n      svg.style.display = 'block'\n      svg.style.width = '20px'\n      svg.style.height = '20px'\n      svg.style.verticalAlign = 'middle'\n      svg.innerHTML = choice.svg ?? ''\n      li.appendChild(svg)\n    }\n  } else {\n    throw Error(`Type de choix inconnu : ${choice}`)\n  }\n}\n\n/**\n * L'outil listeDeroulante cr un \"select\" like o on peut mettre dans chaque item du LaTex, une image, etc.\n * Il faut passer par ListeDeroulante.create() et pas new ListeDeroulante()\n * @class\n */\nclass ListeDeroulante {\n  disabled: boolean = false\n  choices: AllChoicesType // La liste des choix\n  givenChoices?: AllChoicesType // Je ne vois pas pourquoi on aurait a...\n  private _kbIndex: number = -1 // L'index du choix slectionn au clavier\n  changed: boolean = false // Passe  true ds qu'on a fait une slection (ou ds le dpart si le choix initial est slectionnable)\n  readonly _offset: number = 0 // Dcalage ventuel d'index entre le tableau de choix fourni et celui qu'on manipule (0 ou 1 suivant que le premier choix est slectionnable ou pas)\n  reponse: string = ''\n\n  private _elts: HTMLLIElement[] = [] // Liste des elts contenant les choix (les &lt;li&gt;)\n  private _clickListener?: EventListener\n  private _keydownListener?: KeyboardEventListener\n\n  container?: HTMLElement\n  spanSelected?: HTMLSpanElement\n  ulContainer?: HTMLUListElement\n  initialChoice?: AllChoiceType\n  width?: number\n\n  /**\n   * @constructor\n   * @param options\n   * @param choices\n   * @param options.choix0\n   */\n  constructor(\n    choices: AllChoicesType,\n    {\n      choix0,\n    }: {\n      choix0?: boolean\n    } = { choix0: false },\n  ) {\n    if (arguments.length > 2) throw Error('nombre darguments invalides')\n    if (!Array.isArray(choices))\n      throw Error('Il faut passer une liste de choix')\n    this.disabled = false // mettre  true pour dsactiver la liste\n    this.choices = [...choices] // La liste des choix\n    this.givenChoices = [...choices] // idem, mais celle-l restera complte avec l'entte de liste si le choix0 retire cet lment de choices lors de l'init.\n\n    this._kbIndex = -1 // L'index du choix slectionn au clavier\n    this.changed = false // Passe  true ds qu'on a fait une slection (ou ds le dpart si le choix initial est slectionnable)\n    this._offset = choix0 ? 0 : 1 // permet d'atteindre le 1er lment slectionnable de la liste\n    this.reponse = '' // Le choix courant\n    this._elts = [] // Liste des elts contenant les choix (les <li>)\n  }\n\n  /**\n   * Cre les lments dans le DOM (appel par create) et ajoute les listeners\n   * @private\n   */\n  _init(\n    {\n      conteneur,\n      sansFleche,\n      select,\n    }: { conteneur?: HTMLElement; sansFleche?: boolean; select?: number } = {\n      sansFleche: false,\n      select: 0,\n    },\n  ) {\n    /**\n     * Le span qui va contenir la liste (tous les lments que l'on cre, enfant de conteneur)\n     * @type {HTMLSpanElement}\n     */\n    if (!conteneur)\n      throw Error('Le conteneur est obligatoire pour la liste droulante !')\n    this.container = conteneur\n    this.container.classList.add('listeDeroulante')\n    const char = ''\n    this.spanSelected = document.createElement('span') // Le span de l'lment slectionn\n    this.container.appendChild(this.spanSelected)\n    this.spanSelected.className = 'currentChoice'\n    this.spanSelected.role = 'listbox'\n    this.spanSelected.tabIndex = 0\n\n    // les listeners sur container, faut les mettre en proprit pour pouvoir les retirer dans disable()\n    // click\n    this._clickListener = (event) => {\n      event?.stopPropagation()\n      this.toggle()\n    }\n    this.container.onclick = this._clickListener\n\n    /**\n     * listener de keydown sur spanSelected, pour slection au clavier\n     * @param {KeyboardEvent} event\n     */\n    this._keydownListener = (event: KeyboardEvent): void => {\n      const { code, key } = event\n      if (code === 'Tab' || key === 'Tab') {\n        // on sort du menu au clavier, faut le refermer\n        this.hide()\n      } else if (code === 'ArrowDown' || key === 'ArrowDown') {\n        event.preventDefault()\n        if (this._kbIndex < this.choices.length - 1) {\n          this._kbIndex++\n          if (!this.isVisible()) this.show()\n          this._kbSelect()\n        }\n      } else if (code === 'ArrowUp' || key === 'ArrowUp') {\n        event.preventDefault()\n        if (this._kbIndex === -1) this._kbIndex = this.choices.length // 1er clic sur arrowUp, on part de la fin\n        if (this._kbIndex > 0) {\n          this._kbIndex--\n          if (!this.isVisible()) this.show()\n          this._kbSelect()\n        }\n      } else if (\n        code === 'Space' ||\n        key === 'Space' ||\n        code === 'Enter' ||\n        key === 'Enter'\n      ) {\n        if (this.isVisible()) {\n          this.select(this._kbIndex, { withoutOffset: true })\n        } else {\n          this.show()\n        }\n      }\n    }\n    if (!sansFleche) {\n      const fleche = document.createElement('span')\n      fleche.className = 'trigger'\n      fleche.textContent = char\n      if (this._clickListener) fleche.onclick = this._clickListener\n      this.container.appendChild(fleche)\n    }\n    // la liste qui peut tre masque (il doit passer au-dessus du reste, les boutons sont  50, les modales  90)\n    this.ulContainer = document.createElement('ul')\n    this.container.appendChild(this.ulContainer)\n\n    // si le premier lment de la liste n'est pas slectionnable, on le sort de la liste\n    this.initialChoice = this._offset ? this.choices.shift() : this.choices[0]\n    // les choix\n    for (const [index, choice] of this.choices.entries()) {\n      const li = document.createElement('li')\n      li.role = 'option'\n      this.ulContainer?.appendChild(li)\n      afficheChoice(li, choice)\n      li.addEventListener('click', (event) => {\n        event.stopPropagation() // faut pas propager  container sinon il va rouvrir la liste aprs select()\n        this.select(index, { withoutOffset: true })\n      })\n      this._elts.push(li)\n    }\n    // Il faut faire a pour rcuprer this.width  l'init ce qui permet de fixer la largeur minimum du spanSelected et d'aligner la liste  droite du spanSelected\n    this.show() // fixe le this.width car il est undefined.\n    this.hide()\n\n    this.spanSelected.addEventListener('keydown', this._keydownListener)\n    // pour refermer le menu si on sort au clavier,\n    // on a essay de refermer le menu au focusout sur container (avec un timeout sinon a ferme avant de dclencher\n    // le clic sur un li et on se retrouve  cliquer dessous), mais a pose plus de pb que a n'en rsoud\n    // (le clic sur la flche referme parfois le menu aussitt)\n    // => on gre le tab sortant dans _keydownListener\n\n    // et un listener pour refermer la liste si on clique ailleurs\n    document.body.addEventListener('click', ({ target }) => {\n      // si on trouve un .listeDeroulante dans un parent on ne fait rien\n      /** @type {null|HTMLElement} */\n      let parent: EventTarget | null = target\n      while (parent && parent instanceof HTMLElement) {\n        if (parent.classList.contains('listeDeroulante')) return\n        parent = parent.parentElement\n      }\n      // sinon on cache\n      this.hide()\n    })\n    // et le choix initial, on passe par select/reset pour viter de dupliquer du code, mais ils ne doivent pas appeler le listener  l'init\n    // (y'a des sections qui nous filent en listener  un truc qui n'est pas encore prt, faut pas l'appeler tout de suite)\n    if (select) this.select(select)\n    // si choix0, on considre a comme une rponse dj mise\n    else if (this._offset === 0) this.select(0)\n    // sinon reset\n    else this.reset()\n    this._replace()\n  }\n\n  /**\n   * met le focus sur l'lment slectionn\n   */\n  focus() {\n    if (this.spanSelected) this.spanSelected.focus()\n  }\n\n  /**\n   * positionne le ul par rapport au spanSelected\n   * @private\n   */\n  _replace() {\n    if (this.container) {\n      const height = this.container.offsetHeight\n      const widthSpan = this.spanSelected?.offsetWidth ?? 0\n      if (this.ulContainer) {\n        this.ulContainer.style.top = `${height}px`\n        this.ulContainer.style.left = `${widthSpan - (this.width ?? 0)}px`\n      }\n    }\n  }\n\n  /**\n   * Remet la liste dans son tat initial\n   */\n  reset() {\n    this.hide()\n    if (this.spanSelected) {\n      empty(this.spanSelected)\n      afficheChoice(this.spanSelected, this.initialChoice)\n      this.spanSelected.style.fontStyle = 'italic'\n      this.spanSelected.style.color = 'Grey'\n      this._kbIndex = -1\n      this.reponse = ''\n      this.changed = false\n      this._replace() // au cas o la hauteur de spanSelected aurait chang\n    }\n  }\n\n  /**\n   * Slectionne le choix index (dans le tableau fourni initialement)\n   * @param {number} index index dans choices\n   * @param {Object} [options]\n   * @param {boolean} [options.withoutOffset] Passer true si l'index est celui du tableau aprs avoir ventuellement retir son 1er lment ( priori usage interne seulement)\n   */\n  select(\n    index: number,\n    {\n      withoutOffset,\n    }: {\n      withoutOffset?: boolean\n    } = {},\n  ) {\n    if (this.spanSelected != null) {\n      if (this.disabled) return\n      this.spanSelected.style.fontStyle = ''\n      this.spanSelected.style.color = ''\n      if (!Number.isInteger(index)) return Error(`index non entier : ${index}`)\n      // faut dcaler l'index si on a vir le 1er elt  l'init\n      const realIndex = withoutOffset ? index : index - this._offset\n      if (realIndex < 0 || realIndex >= this.choices.length) {\n        if (withoutOffset)\n          return console.error(\n            `index invalide : ${index} non compris entre 0 et ${this.choices.length - 1}`,\n          )\n        return console.error(\n          `index invalide : ${index} non compris entre ${this._offset} et ${this.choices.length - 1 + this._offset}`,\n        )\n      }\n      empty(this.spanSelected)\n      const choix = this.choices[realIndex]\n      afficheChoice(this.spanSelected, choix)\n      this.reponse = String(\n        typeof choix === 'string'\n          ? choix\n          : typeof choix === 'object'\n            ? choix?.value\n            : 'undefined',\n      )\n      if (this.reponse === 'undefined')\n        throw Error(`Un problme avec la valeur de ce choix : ${choix}`)\n      this.changed = true\n      this._kbIndex = index\n      for (const [i, li] of this._elts.entries()) {\n        if (i === index) li.classList.add('selected')\n        else li.classList.remove('selected')\n      }\n      this._replace() // la hauteur de spanSelected peut changer\n      this.focus()\n      this.hide()\n    }\n  }\n\n  /**\n   * Marque un lment comme tant slectionn au clavier (sera ensuite vraiment slectionn si on appuie ensuite sur entre)\n   */\n  _kbSelect() {\n    for (const [i, li] of this._elts.entries()) {\n      if (this._kbIndex === i) li.classList.add('selected')\n      else li.classList.remove('selected')\n    }\n  }\n\n  hide() {\n    if (this.ulContainer) this.ulContainer.classList.remove('visible')\n  }\n\n  show() {\n    if (this.disabled) return\n    // il faut d'abord masquer toutes les autres listes qui pourraient tre ouverte (pour viter des chevauchements)\n    for (const ul of document.querySelectorAll('.listeDeroulante ul.visible')) {\n      ul.classList.remove('visible')\n    }\n    if (this.ulContainer) this.ulContainer.classList.add('visible')\n    // Si this.width n'est pas dfini (a veut dire que c'est l'init qui l'appelle) on le renseigne et on replace la liste  droite et en dessous du spanSelected.\n    if (!this.width) {\n      this.width = this.ulContainer?.offsetWidth\n      this._replace()\n    }\n    this.focus() // pour usage au clavier\n  }\n\n  /**\n   * Pour changer l'tat 'visible' de la liste\n   */\n  toggle() {\n    if (this.disabled) return\n    if (this.isVisible()) this.hide()\n    else this.show()\n  }\n\n  /**\n   * Comme son nom l'indique, dit si la liste est visible\n   */\n  isVisible() {\n    if (this.ulContainer) return this.ulContainer.classList.contains('visible')\n    else return false\n  }\n\n  getSelectedIndex() {\n    return this._kbIndex\n  }\n\n  /**\n   * Ajoute la liste dans le dom et retourne l'objet ListeDeroulante qu'elle a cr\n   * @name ListeDeroulante\n   * @param {HTMLElement|string} conteneur\n   * @param {CHoiceValue[]} choices la liste des choix\n   * @param {Object} [parametres]  Les paramtres de cette liste\n   * @param {boolean} [parametres.sansFleche=false] passer true pour ne pas mettre la flche permettant le droulement\n   * @param {number} [parametres.select=0] index de choices  slectionner ds le dpart (ignor si choix est prcis)\n   * @return {ListeDeroulante}\n   */\n  static create(\n    conteneur: HTMLElement,\n    choices: AllChoicesType,\n    {\n      choix0,\n      sansFleche,\n      select,\n    }: {\n      choix0?: boolean\n      sansFleche?: boolean\n      select?: number\n    } = {\n      choix0: false,\n      sansFleche: false,\n      select: 0,\n    },\n  ): ListeDeroulante {\n    const ld = new ListeDeroulante(choices, {\n      choix0,\n    })\n    if (!conteneur)\n      throw Error('Impossible de crer la liste droulante, pas de conteneur')\n    ld._init({ conteneur, sansFleche, select })\n    return ld\n  }\n}\n\nexport default ListeDeroulante\n","import ListeDeroulante, { type AllChoicesType } from './ListeDeroulante'\n\nclass ListeDeroulanteElement extends HTMLElement {\n  private _listeDeroulante?: ListeDeroulante\n\n  constructor() {\n    super()\n    this.attachShadow({ mode: 'open' })\n  }\n\n  static get observedAttributes() {\n    return ['choices']\n  }\n\n  attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n    if (name === 'choices' && oldValue !== newValue) {\n      this.render()\n    }\n  }\n\n  connectedCallback() {\n    this.render()\n  }\n\n  set choices(val: AllChoicesType) {\n    this._choices = val\n    this.render()\n  }\n\n  get choices(): AllChoicesType {\n    return this._choices\n  }\n\n  private _choices: AllChoicesType = []\n\n  render() {\n    if (this.shadowRoot) this.shadowRoot.innerHTML = ''\n\n    // Ajoute le CSS compil directement ici (copie-colle le contenu du .css gnr)\n    const style = document.createElement('style')\n    style.textContent = `\nspan.listeDeroulante {\n  position: relative;\n  display: inline-flex;\n  align-items: center;\n  background: #fff;\n  color: #333;\n  border: 1px solid #d1d5db; /* gris clair moderne */\n  border-radius: 0.5rem;\n  font-size: 0.95rem;\n  line-height: 1.5;\n  transition: all 0.2s ease;\n  cursor: pointer;\n  padding: 2px 6px;\n}\n\nspan.listeDeroulante:hover {\n  border-color: #3b82f6; /* bleu Tailwind */\n  box-shadow: 0 2px 6px rgba(0,0,0,0.08);\n}\n\nspan.listeDeroulante span.currentChoice {\n  display: flex;\n  align-items: center;\n  padding: 6px 10px;\n  outline: none;\n}\n\nspan.listeDeroulante .trigger {\n  margin-left: auto;\n  padding: 6px 8px;\n  font-weight: bold;\n  font-size: 0.9em;\n  color: #6b7280; /* gris neutre */\n  border-left: 1px solid #e5e7eb;\n  transition: color 0.2s ease;\n}\n\nspan.listeDeroulante .trigger:hover {\n  color: #111827; /* noir doux */\n}\n\nspan.listeDeroulante .ok {\n  color: #10b981; /* vert moderne */\n}\n\nspan.listeDeroulante .ko {\n  color: #ef4444; /* rouge moderne */\n}\n\n/* Liste droulante */\nspan.listeDeroulante ul {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  width: max-content;\n  min-width: 100%;\n  background: #fff;\n  border: 1px solid #d1d5db;\n  border-radius: 0.5rem;\n  margin: 4px 0 0 0;\n  padding: 4px 0;\n  display: none;\n  z-index: 100;\n  box-shadow: 0 6px 16px rgba(0,0,0,0.12);\n  animation: fadeIn 0.15s ease-out;\n}\n\nspan.listeDeroulante ul.visible {\n  display: block;\n}\n\nspan.listeDeroulante ul li {\n  display: flex;\n  align-items: center;\n  list-style-type: none;\n  padding: 8px 12px;\n  cursor: pointer;\n  font-size: 0.95rem;\n  color: #111827;\n  background: #fff;\n  transition: background 0.2s ease, color 0.2s ease;\n  border: none;\n}\n\nspan.listeDeroulante ul li:hover {\n  background: #f3f4f6;\n  color: #1d4ed8; /* bleu accent */\n}\n\nspan.listeDeroulante ul li.selected {\n  background: #e0f2fe;\n  color: #0284c7;\n  font-weight: 500;\n}\n\nspan.listeDeroulante.disabled {\n  cursor: not-allowed;\n  background: #f9fafb;\n  border-color: #e5e7eb;\n  color: #9ca3af;\n}\n\nspan.listeDeroulante.disabled .trigger {\n  color: #d1d5db;\n}\n\nspan.listeDeroulante.disabled span.currentChoice {\n  pointer-events: none;\n}\n\nspan.listeDeroulante math-field {\n  pointer-events: none;\n  background: transparent !important;\n  border: none !important;\n  box-shadow: none !important;\n  outline: none !important;\n  padding: 0 !important;\n}\n\nspan.listeDeroulante ul li svg.svgChoice {\n  width: 1.2em;\n  height: 1.2em;\n  margin-right: 6px;\n  flex-shrink: 0;\n  fill: currentColor;\n}\n\n/* Animation d'apparition */\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(-5px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n`\n    this.shadowRoot!.appendChild(style)\n\n    // Cration du conteneur\n    const container = document.createElement('span')\n    this.shadowRoot!.appendChild(container)\n\n    // Rcupre les choix depuis l'attribut ou la proprit\n    let choices: AllChoicesType = this.choices\n    if (!choices.length && this.hasAttribute('choices')) {\n      try {\n        const attr = decodeURIComponent(this.getAttribute('choices')!)\n        choices = JSON.parse(attr)\n      } catch (e) {\n        choices = []\n      }\n    }\n    const choix0 = this.hasAttribute('choix0')\n      ? this.getAttribute('choix0') !== 'false'\n      : false\n\n    // Cration de la liste droulante\n    this._listeDeroulante = new ListeDeroulante(choices, { choix0 })\n    this._listeDeroulante._init({ conteneur: container })\n  }\n\n  // API JS pour rcuprer la valeur slectionne\n  get value() {\n    return this._listeDeroulante?.reponse ?? ''\n  }\n\n  set value(val) {\n    if (this._listeDeroulante) {\n      this._listeDeroulante.select(\n        this._listeDeroulante.choices.findIndex((el) => el.value === val) +\n          this._listeDeroulante._offset,\n      )\n    }\n  }\n}\n\ncustomElements.define('liste-deroulante', ListeDeroulanteElement)\nexport default ListeDeroulanteElement\n","// import { addElement, get, setStyles } from '../html/dom'\nimport type Exercice from '../../exercices/Exercice'\nimport { context } from '../../modules/context'\nimport type { AllChoicesType } from './listeDeroulante/ListeDeroulante'\nimport './listeDeroulante/ListeDeroulanteElement'\n\n/**\n * Vrifie la rponse  une question  liste droulante\n * @param {object} exercice l'exercice appelant pour pouvoir atteindre ses proprits.\n * @param {number} i le numro de la question\n * @returns {string} 'OK' si la rponse est correcte, 'KO' sinon\n */\nexport function verifQuestionListeDeroulante(exercice: Exercice, i: number) {\n  /* // Le get est non strict car on sait que l'lment n'existe pas  la premire itration de l'exercice\n  const eltFeedback = document.querySelector(`resultatCheckEx${exercice.numeroExercice}Q${i}`)\n  // On ajoute le div pour le feedback\n  setStyles(eltFeedback, 'marginBottom: 20px')\n  if (eltFeedback) eltFeedback.innerHTML = ''\n   */\n  const spanReponseLigne = document.querySelector(\n    `#resultatCheckEx${exercice.numeroExercice}Q${i}`,\n  )\n  if (spanReponseLigne == null) {\n    window.notify(\n      \"l'exercice ayant appel verifQuestionListeDeroulante() n'a pas correctement dfini le span pour le smiley\",\n      { exercice: JSON.stringify(exercice) },\n    )\n  }\n  const liste = document.querySelector(`#ex${exercice.numeroExercice}Q${i}`)\n  let value\n\n  if (liste) {\n    value = (liste as any).value\n  }\n  const reponse = exercice.autoCorrection[i]?.reponse?.valeur?.reponse?.value\n  // Sauvegarde pour les exports Moodle, Capytale...\n  if (exercice.answers === undefined) {\n    exercice.answers = {}\n  }\n  if (liste) {\n    exercice.answers[liste.id] = value\n  }\n  const resultat = value === reponse ? 'OK' : 'KO'\n  if (resultat === 'OK') {\n    if (spanReponseLigne) {\n      spanReponseLigne.innerHTML = ''\n    }\n  } else {\n    if (spanReponseLigne) {\n      spanReponseLigne.innerHTML = ''\n    }\n  }\n  if (spanReponseLigne)\n    (spanReponseLigne as HTMLElement).style.fontSize = 'large'\n  return resultat\n}\n\n/**\n *\n * Fonction pour crer une liste droulante dans un exercice interactif.\n * @param {Exercice} exercice l'exercice appelant pour pouvoir atteindre ses proprits.\n * @param {number} i le numro de la question\n * @param {AllChoicesType} choix les choix possibles dans la liste droulante\n * @param {boolean} [choix0] true si on veut un choix slectionnable en premier (pas d'entte) par dfaut false\n * @param {string} [style] le style  appliquer  la liste droulante (en plus ou en remplacement de celui par dfaut))\n * @returns {string} le code HTML de la liste droulante\n */\nexport function choixDeroulant(\n  exercice: Exercice,\n  i: number,\n  choix: AllChoicesType,\n  choix0?: boolean,\n  style?: string,\n) {\n  if (!exercice.interactif || !context.isHtml) return ''\n\n  choix0 = choix0 !== undefined ? Boolean(choix0) : false\n  style = style ? ` style=\"${style}\"` : ''\n  if (\n    context.isHtml &&\n    exercice?.autoCorrection[i]?.reponse?.param?.formatInteractif !==\n      'listeDeroulante'\n  ) {\n    if (exercice?.autoCorrection == null) exercice.autoCorrection = []\n    if (exercice?.autoCorrection[i] == null) exercice.autoCorrection[i] = {}\n    if (exercice?.autoCorrection[i].reponse == null)\n      exercice.autoCorrection[i].reponse = {}\n    if (exercice.autoCorrection[i].reponse.param == null)\n      exercice.autoCorrection[i].reponse.param = {}\n    exercice.autoCorrection[i].reponse.param.formatInteractif =\n      'listeDeroulante'\n  }\n  let result =\n    `<liste-deroulante class=\"mx-2 listeDeroulante\" id=\"ex${exercice.numeroExercice}Q${i}\"${style} choices=\"` +\n    encodeURIComponent(JSON.stringify(choix)) +\n    `\" choix0=\"${choix0}\"></liste-deroulante>`\n  /* let result = `<select class=\"mx-2 listeDeroulante\" id=\"Ex${exercice.numeroExercice}Q${i}\" ${style}>\n      <option> Choisir ${type === 'nombre' ? 'un nombre' : type} </option>`\n\n  for (const a of choix) {\n    result += `<option>${a}</option>`\n  }\n    */\n  result += `<span id=\"resultatCheckEx${exercice.numeroExercice}Q${i}\"></span>`\n  return result\n}\n\n/**\n * Fonction pour transformer une liste droulante en QCM (pour AMC, la version interactive n'a que peu d'intrt)\n * @param {Exercice} exercice\n * @param {number} question\n * @param {string[]} choix\n * @param {string} reponse\n * @param {object} options // options.vertical pour prsenter les rponses, options.ordered pour modifier l'ordre\n * passer toutes les options possibles pour AMC (lastChoice par exemple utile si pas ordonn pour dire o s'arrte le mlange voir le wiki concernant AMC).\n */\nexport function listeDeroulanteToQcm(\n  exercice: Exercice,\n  question: number,\n  choix: AllChoicesType,\n  reponse: string,\n  options: any,\n) {\n  if (exercice == null || choix == null || reponse == null) {\n    window.notify(\n      'Il manque des paramtres pour transformer la liste droulante en qcm',\n      { exercice, question, choix, reponse },\n    )\n    return\n  }\n  if (!choix.some((el) => el.value === reponse)) {\n    window.notify('La rponse doit faire partie de la liste !', {\n      choix,\n      reponse,\n    })\n    return\n  }\n  const vertical = options?.vertical ?? true // Par dfaut c'est vertical comme une liste droulante mais on peut passer vertical = false\n  const ordered = options?.ordered ?? true // Par dfaut ce sera le mme ordre que la liste droulante\n  if (\n    exercice.autoCorrection == null ||\n    !Array.isArray(exercice.autoCorrection)\n  ) {\n    exercice.autoCorrection = []\n  }\n  if (exercice.autoCorrection[question] == null)\n    exercice.autoCorrection[question] = {}\n  exercice.autoCorrection[question] = {}\n  exercice.autoCorrection[question].options = { vertical, ordered, ...options }\n  exercice.autoCorrection[question].propositions = []\n  for (let j = 0; j < choix.length; j++) {\n    if (choix[j].value === '') continue\n    if (choix[j].label != null) {\n      exercice.autoCorrection[question].propositions.push({\n        texte: choix[j].label,\n        statut: choix[j].value === reponse, // il n'y a qu'une bonne rponse, et elle doit correspondre  l'un des choix.\n      })\n    } else if (choix[j].latex != null) {\n      exercice.autoCorrection[question].propositions.push({\n        texte: `$${choix[j].latex}$`,\n        statut: choix[j].value === reponse, // il n'y a qu'une bonne rponse, et elle doit correspondre  l'un des choix.\n      })\n    } else if (choix[j].svg != null) {\n      const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n      svg.setAttribute('viewBox', '-10 -10 20 20') // Valeur par dfaut, peut tre ajuste\n      svg.classList.add('svgChoice')\n      svg.style.display = 'inline-block'\n      svg.style.width = '20px'\n      svg.style.height = '20px'\n      svg.style.verticalAlign = 'middle'\n      svg.innerHTML = choix[j].svg ?? ''\n      exercice.autoCorrection[question].propositions.push({\n        texte: svg.outerHTML,\n        statut: choix[j].value === reponse,\n      })\n      setTimeout(() => {\n        document.removeChild(svg)\n      }, 0)\n    } else if (choix[j].image != null) {\n      const image = document.createElement('img')\n      image.src = choix[j].image ?? choix[j].value\n      image.style.width = '30px'\n      image.style.height = '30px'\n      exercice.autoCorrection[question].propositions.push({\n        texte: image.outerHTML,\n        statut: choix[j].value === reponse,\n      })\n    } else {\n      console.warn(\n        'La liste droulante  convertir en qcm contient un choix de type inconnu',\n        JSON.stringify(choix[j]),\n      )\n    }\n  }\n}\n","import Decimal from 'decimal.js'\nimport { fonctionComparaison } from '../lib/interactif/comparisonFunctions'\nimport { handleAnswers } from '../lib/interactif/gestionInteractif'\nimport { propositionsQcm } from '../lib/interactif/qcm'\nimport {\n  ajouteChampTexteMathLive,\n  remplisLesBlancs,\n} from '../lib/interactif/questionMathLive'\nimport { combinaisonListes, shuffle } from '../lib/outils/arrayOutils'\nimport { range1 } from '../lib/outils/nombres'\nimport FractionEtendue from '../modules/FractionEtendue'\nimport Grandeur from '../modules/Grandeur'\nimport { gestionnaireFormulaireTexte } from '../modules/outils'\nimport Exercice from './Exercice'\n\nexport const interactifType = 'mathLive'\nexport const interactifReady = true\n\nexport default class MetaExercice extends Exercice {\n  Exercices: (typeof Exercice)[]\n  correctionInteractives: ((i: number) => string | string[])[]\n  constructor(ExercicesCAN: (typeof Exercice)[]) {\n    super()\n    this.Exercices = ExercicesCAN\n    this.correctionInteractives = []\n    this.besoinFormulaireCaseACocher = ['Sujet officiel']\n    this.nbQuestions = this.Exercices.length\n    this.sup = false\n    this.sup2 = Array.from({ length: this.nbQuestions }, (_, i) => i + 1).join(\n      '-',\n    ) // Toutes les questions de 1  30 (ou 20 pour les CE)\n    this.sup3 = false\n  }\n\n  nouvelleVersion(): void {\n    this.correctionInteractives = []\n    this.listeCanEnonces = []\n    this.listeCanReponsesACompleter = []\n    this.listeCanLiees = []\n    this.listeCanNumerosLies = []\n    this.answers = {}\n    this.nbQuestionsModifiable = this.sup3\n    this.besoinFormulaire2Texte = false\n    let listeTypeDeQuestions: (string | number)[]\n    const listeDeQuestions = this.sup2\n    let exercicesRef = this.Exercices\n    const nbTotalQuestions = exercicesRef.length\n    if (this.sup3) {\n      this.sup2 = false\n    } else {\n      exercicesRef = this.Exercices\n      this.nbQuestions = String(this.sup2).includes('-')\n        ? this.sup2.split('-').length\n        : 1\n    }\n\n    if (this.sup2) {\n      listeTypeDeQuestions = gestionnaireFormulaireTexte({\n        saisie: listeDeQuestions,\n        min: 1,\n        max: 30,\n        defaut: 1,\n        melange: 31,\n        shuffle: false,\n        nbQuestions: String(this.sup2).includes('-')\n          ? this.sup2.split('-').length\n          : 1,\n      })\n    } else {\n      listeTypeDeQuestions = range1(this.nbQuestions)\n      exercicesRef = this.Exercices\n\n      const base = Math.floor(this.nbQuestions / 3)\n      const reste = this.nbQuestions % 3\n      let repartition = [base, base, base]\n      for (let i = 0; i < reste; i++) {\n        repartition[i]++\n      }\n      repartition = combinaisonListes(repartition, 3)\n\n      let exercices1 = exercicesRef.slice(\n        0,\n        Math.floor(Math.max(nbTotalQuestions / 3, repartition[0])),\n      )\n      exercices1 = shuffle(exercices1)\n      exercices1 = exercices1.slice(0, repartition[0])\n\n      let exercices2 = exercicesRef.slice(\n        Math.max(nbTotalQuestions / 3, repartition[0]),\n        Math.max((2 * nbTotalQuestions) / 3, repartition[0] + repartition[1]),\n      )\n      exercices2 = shuffle(exercices2)\n      exercices2 = exercices2.slice(0, repartition[1])\n\n      let exercices3 = exercicesRef.slice(\n        Math.max((2 * nbTotalQuestions) / 3, repartition[0] + repartition[1]),\n        nbTotalQuestions,\n      )\n      exercices3 = shuffle(exercices3)\n      exercices3 = exercices3.slice(0, repartition[2])\n\n      exercicesRef = [...exercices1, ...exercices2, ...exercices3]\n    }\n    let indexQuestion = 0\n    this.reinit() // On rinitialise les listes de questions parce qu'on a eu des soucis (est-ce que MetaExercice passe par le nouvelleVersionWrapper ?)\n\n    for (const item of listeTypeDeQuestions) {\n      // Pour les questions soient dans l'ordre choisi par l'utilisateur\n      let numExo = 1\n      for (const UnExercice of exercicesRef) {\n        if (item === numExo) {\n          // Permet de ne choisir que certaines questions\n          const Question = new UnExercice()\n          Question.numeroExercice = this.numeroExercice\n          Question.canOfficielle = !!this.sup\n          Question.interactif = this.interactif\n          Question.seed = this.seed\n          Question.nouvelleVersionWrapper()\n          //* ************ Question Exo simple *************//\n          if (Question.listeQuestions.length === 0) {\n            // On est en prsence d'un exo simple\n            const consigne =\n              Question.consigne === '' ? '' : `${Question.consigne}<br>`\n            this.listeCorrections[indexQuestion] = Question.correction ?? ''\n            const formatChampTexte = Question.formatChampTexte ?? ''\n            const optionsChampTexte = Question.optionsChampTexte ?? {}\n            if (Question.canEnonce != null)\n              this.listeCanEnonces[indexQuestion] = Question.canEnonce\n            if (Question.canReponseACompleter != null)\n              this.listeCanReponsesACompleter[indexQuestion] =\n                Question.canReponseACompleter\n            this.listeCanLiees[indexQuestion] = Question.canLiee\n            this.listeCanNumerosLies[indexQuestion] = Question.canNumeroLie\n\n            if (\n              Question.formatInteractif === 'fillInTheBlank' ||\n              (typeof Question.reponse === 'object' &&\n                'champ1' in Question.reponse)\n            ) {\n              this.listeQuestions[indexQuestion] =\n                consigne +\n                remplisLesBlancs(\n                  this,\n                  indexQuestion,\n                  Question.question,\n                  formatChampTexte,\n                  '\\\\ldots',\n                )\n              if (typeof Question.reponse === 'string') {\n                handleAnswers(this, indexQuestion, {\n                  champ1: {\n                    value: Question.reponse,\n                    compare: Question.compare ?? fonctionComparaison,\n                    options: optionsChampTexte,\n                  },\n                })\n              } else if (typeof Question.reponse === 'object') {\n                handleAnswers(this, indexQuestion, Question.reponse)\n              } else {\n                window.notify(\n                  'Erreur avec cette question de type fillInTheBlank qui contient une reponse au format inconnu',\n                  { reponse: Question.reponse },\n                )\n              }\n            } else if (Question.formatInteractif === 'qcm') {\n              Question?.question?.replaceAll(\n                'labelEx0Q0',\n                `labelEx0Q${indexQuestion}`,\n              )\n              Question?.question?.replaceAll(\n                'resultatCheckEx0',\n                `resultatCheckEx${indexQuestion}`,\n              )\n              this.listeQuestions[indexQuestion] = consigne + Question.question\n              this.autoCorrection[indexQuestion] = Question.autoCorrection[0]\n            } else {\n              if (Question.compare == null) {\n                const options =\n                  Question.optionsDeComparaison == null\n                    ? {}\n                    : Question.optionsDeComparaison\n                if (\n                  Question.reponse.reponse instanceof Object &&\n                  Question.reponse.reponse.value != null &&\n                  typeof Question.reponse.reponse.value === 'string'\n                )\n                  handleAnswers(this, indexQuestion, Question.reponse, options)\n                else\n                  handleAnswers(this, indexQuestion, {\n                    reponse: { value: Question.reponse, options },\n                  })\n              } else {\n                const compare = Question.compare\n                const options =\n                  Question.optionsDeComparaison == null\n                    ? {}\n                    : Question.optionsDeComparaison\n                if (\n                  typeof Question.reponse === 'string' ||\n                  typeof Question.reponse === 'number'\n                ) {\n                  const reponse = String(Question.reponse)\n                  handleAnswers(this, indexQuestion, {\n                    reponse: {\n                      value: reponse,\n                      compare,\n                      options,\n                    },\n                  })\n                } else if (typeof Question.reponse === 'object') {\n                  const reponse = Question.reponse\n                  if (reponse instanceof FractionEtendue) {\n                    handleAnswers(this, indexQuestion, {\n                      reponse: {\n                        value: reponse.texFraction,\n                        compare,\n                        options,\n                      },\n                    })\n                  } else if (reponse instanceof Decimal) {\n                    handleAnswers(this, indexQuestion, {\n                      reponse: {\n                        value: reponse.toString(),\n                        compare,\n                        options,\n                      },\n                    })\n                  } else if (reponse instanceof Grandeur) {\n                    handleAnswers(this, indexQuestion, {\n                      reponse: { value: reponse.toString(), compare, options },\n                    })\n                  } else if (Array.isArray(reponse)) {\n                    handleAnswers(this, indexQuestion, {\n                      reponse: { value: reponse, compare, options },\n                    })\n                  } else {\n                    handleAnswers(this, indexQuestion, reponse) // EE : Pourquoi ce handleAnswers n'est pas au mme format que les autres ?\n                  }\n                } else {\n                  window.notify(\n                    'Erreur avec cette question qui contient une reponse au format inconnu',\n                    { reponse: Question.reponse },\n                  )\n                }\n              }\n              this.listeQuestions[indexQuestion] =\n                consigne +\n                Question.question +\n                ajouteChampTexteMathLive(\n                  this,\n                  indexQuestion,\n                  formatChampTexte,\n                  optionsChampTexte,\n                )\n            }\n          } else {\n            //* ***************** Question Exo classique *****************//\n            this.listeQuestions[indexQuestion] = Question.listeQuestions[0]\n            this.listeCorrections[indexQuestion] = Question.listeCorrections[0]\n            this.autoCorrection[indexQuestion] = Question.autoCorrection[0]\n\n            this.listeQuestions[indexQuestion] = this.listeQuestions[\n              indexQuestion\n            ].replaceAll('champTexteEx0Q0', `champTexteEx0Q${indexQuestion}`)\n            this.listeQuestions[indexQuestion] = this.listeQuestions[\n              indexQuestion\n            ].replaceAll(\n              'resultatCheckEx0Q0',\n              `resultatCheckEx0Q${indexQuestion}`,\n            )\n            this.listeQuestions[indexQuestion] = this.listeQuestions[\n              indexQuestion\n            ].replaceAll('clockEx0Q0', `clockEx0Q${indexQuestion}`)\n\n            // fin d'alimentation des listes de question et de correction pour cette question\n            const formatInteractif =\n              Question.autoCorrection[0]?.reponse?.param?.formatInteractif\n            if (formatInteractif === 'custom') {\n              Question.reinit()\n              Question.nouvelleVersionWrapper(\n                this.numeroExercice,\n                indexQuestion,\n              )\n              const that = this\n              this.correctionInteractives[indexQuestion] = function (\n                i: number,\n              ) {\n                const result = Question.correctionInteractive!(i)\n                if (Question.answers) {\n                  that.answers = { ...that.answers, ...Question.answers }\n                }\n                return result\n              }\n              this.autoCorrection[indexQuestion] =\n                Question.autoCorrection[indexQuestion]\n              this.listeQuestions[indexQuestion] =\n                Question.listeQuestions[indexQuestion]\n              this.listeCorrections[indexQuestion] =\n                Question.listeCorrections[indexQuestion]\n            } else if (formatInteractif === 'qcm') {\n              this.autoCorrection[indexQuestion] = Question.autoCorrection[0]\n            } else {\n              handleAnswers(\n                this,\n                indexQuestion,\n                Question.autoCorrection[0].reponse.valeur,\n              )\n            }\n          }\n          if (Question?.autoCorrection[0]?.propositions != null) {\n            // qcm\n            const monQcm = propositionsQcm(this, indexQuestion) // update les rfrences HTML\n            this.listeCanReponsesACompleter[indexQuestion] =\n              Question.canReponseACompleter != null\n                ? Question.canReponseACompleter\n                : monQcm.texte\n            const consigne =\n              Question.consigne === null || Question.consigne === ''\n                ? ''\n                : `${Question.consigne}<br>`\n            const objetReponse = this.autoCorrection[indexQuestion]\n            const enonce = 'enonce' in objetReponse ? objetReponse.enonce : ''\n            this.listeQuestions[indexQuestion] =\n              consigne + enonce + monQcm.texte\n            if (this.listeCorrections[indexQuestion] == null)\n              this.listeCorrections[indexQuestion] = monQcm.texteCorr\n          }\n\n          indexQuestion++\n          break\n        }\n        numExo++\n      }\n    }\n    // Une deuxime scurit pour virer les questions en trop\n    if (indexQuestion > 30) {\n      indexQuestion = 30\n      window.notify(\n        'malgr des prcautions prises, on a fabriqu plus de 30 questions dans MetaExercice',\n        { nbQuestions: indexQuestion },\n      )\n      this.listeQuestions = this.listeQuestions.slice(0, indexQuestion)\n      this.listeCorrections = this.listeCorrections.slice(0, indexQuestion)\n      this.autoCorrection = this.autoCorrection.slice(0, indexQuestion)\n    }\n\n    this.besoinFormulaire2Texte = this.sup3\n      ? false\n      : ['Choix des questions', 'Nombres spars par des tirets :']\n    this.besoinFormulaire3CaseACocher = ['Choix du nombre de questions']\n    this.comment = `Cet exercice fait partie des annales des Courses Aux Nombres (CAN).<br>\n  Il est plus souvent compos de 30 questions (parfois 20 pour les CE1/CE2) rparties de la faon suivante. \n  Les 10 premires questions, parfois communes  plusieurs niveaux, font appel  des questions lmentaires et les 20 suivantes (qui ne sont pas ranges dans un ordre de difficult) sont un peu plus  coteuses  cognitivement.<br>\n  Par dfaut, les questions sont ranges dans le mme ordre que le sujet officiel avec des donnes alatoires. Ainsi, en cliquant sur  Nouvelles donnes , on obtient une nouvelle Course Aux Nombres avec des donnes diffrentes.<br>\n  Dans les CAN depuis 2024, le choix des questions permet de choisir certaines questions parmi les 30. <br>\n  Dans les CAN d'avant 2024, on pouvait seulement choisir le nombre de questions comme dcrit ci-aprs. <br>\n  En choisissant un nombre de questions infrieur  30, on fabrique une  mini  Course Aux Nombres qui respecte la proportion de nombre de questions lmentaires par rapport aux autres.\n  Par exemple, en choisissant 20 questions, la course aux nombres sera compose de 7 ou 8 questions lmentaires choisies alatoirement dans les 10 premires questions du sujet officiel puis de 12 ou 13 autres questions choisies alatoirement parmi les 20 autres questions du sujet officiel.`\n  }\n}\n","import type Exercice from '../../exercices/Exercice'\nimport { context } from '../../modules/context'\nimport { shuffle } from '../outils/arrayOutils'\nimport { get } from '../html/dom'\nimport { messageFeedback } from '../../modules/messages'\nimport { toutPourUnPoint } from './mathLive'\n\nexport type Etiquette = {\n  id: string // Un numro unique par tiquette ! (valeur rserve : 0 pour signaler l'absence d'tiquette !)\n  contenu: string // Ce que contient l'tiquette (aussi bien du texte, que du latex, qu'une image...)\n  duplicable?: boolean\n  callback?: (e: Event) => void // @todo  implmenter.\n}\n\n/*\nL'utilisation de l'interactif faon drag&drop ncessite la dclaration des bonnes rponses avec handleHanswers() :\nUn exemple :\nhandleHanswers(this, i, {\nrectangle1: {value: etiquetteId, callback?: ()=>void},\nrectangle2: {value: etiquetteId, callback?: ()=>void},\n....,\n{formatInteractif: 'dnd'})\n\nLa fonction de callback est excute sur le rectangle (div) correspondant.\nPar exemple, on peut imaginer un fonction qui regarde le textContent de l'lment prcdent et qui,\nsi c'est un nombre suprieur  1, ajoute un 's' au contenu de l'tiquette 'droppe' dans le rectangle.\nCe n'est qu'une ide, je ne sais mme pas si c'est ralisable, ni mme souhaitable  l'heure o je mets au point ces fonctions !\nEn fait, c'tait pour viter de doubler le nombre d'tiquettes avec des singuliers et des pluriels...\nPour l'instant, l'utilisation de cette callback n'est pas implmente.\n*/\ntype DragHandler = (e: DragEvent) => void\ntype TouchHandler = (e: TouchEvent) => void\n\n/**\n * On stocke l'lment en dplacement\n * @param e\n */\nfunction dragStartHandler(e: DragEvent) {\n  // console.log('dragStartHandler', e)\n  if (e.target instanceof HTMLDivElement) {\n    e.dataTransfer?.setData('text/plain', e.target.id)\n  }\n}\n\nfunction dragOverHandler(e: DragEvent) {\n  e.preventDefault() // Ncessaire pour autoriser le drop\n  const target = e.target as HTMLElement\n  if (target.classList.contains('trashDND')) {\n    const icone = target.firstChild\n    if (icone && icone instanceof HTMLElement) {\n      icone.classList.add('hovered')\n    }\n  }\n}\n/**\n * glisser  la souris termin on relche...\n * @param e\n */\nfunction dragEndHandler(e: DragEvent) {\n  // console.log('dragEndHandler', e)\n  e.preventDefault()\n  // Rinitialise la position de l'tiquette originale aprs le drop\n  // if (e.target instanceof HTMLElement) {\n  //  e.target.style.position = 'relative'\n  // }\n}\n/**\n * gre le dpot  la souris\n * @param e\n */\nfunction dropHandler(e: DragEvent) {\n  // console.log('dropHandler', e)\n  e.preventDefault()\n  const dropTarget = e.target as HTMLDivElement\n  const etiquetteId = e.dataTransfer?.getData('text/plain')\n  if (etiquetteId) {\n    const etiquette = document.getElementById(etiquetteId)\n    if (etiquette && dropTarget) {\n      if (\n        (!dropTarget.id || !dropTarget.id.includes('rectangle')) &&\n        etiquette.id.includes('clone')\n      ) {\n        etiquette.parentElement?.removeChild(etiquette)\n        return\n      }\n      // Expression rgulire pour capturer les 3 groupes de chiffres\n      const regex = /Ex(\\d+)Q(\\d+)I(\\d+)/\n      const matches = etiquette.id.match(regex)\n      let numeroExQuest = ''\n      if (matches) {\n        const numeroEx = matches[1]\n        const numeroQuest = matches[2]\n        numeroExQuest = `Ex${numeroEx}Q${numeroQuest}`\n      }\n      if (\n        etiquette.classList.contains('duplicable') &&\n        dropTarget.classList.contains('rectangleDND') &&\n        dropTarget.id.includes(numeroExQuest)\n      ) {\n        const clonedEtiquette = etiquette.cloneNode(true) as HTMLDivElement\n        clonedEtiquette.id = `${etiquette.id}-clone-${Date.now()}`\n        addDeleteButton(clonedEtiquette)\n        dropTarget.appendChild(clonedEtiquette)\n      } else if (\n        dropTarget.classList.contains('rectangleDND') &&\n        dropTarget.id.includes(numeroExQuest)\n      ) {\n        addDeleteButton(etiquette, etiquette.parentElement)\n        dropTarget.appendChild(etiquette)\n      } else if (\n        dropTarget.parentElement?.classList.contains('rectangleDND') &&\n        dropTarget.parentElement?.id.includes(numeroExQuest)\n      ) {\n        // on est sur une tiquette dj depose\n        const clonedEtiquette = etiquette.cloneNode(true) as HTMLDivElement\n        clonedEtiquette.id = `${etiquette.id}-clone-${Date.now()}`\n        addDeleteButton(clonedEtiquette)\n        dropTarget.after(clonedEtiquette)\n      }\n      dropTarget.classList.remove('hovered') // Enlve l'effet aprs le drop\n    }\n  }\n}\n/**\n *  dmarre le dplacement de l'tiquette sur interface tactile et s'assure que toute l'tiquette est dplace\n */\nfunction touchStartHandler(e: TouchEvent) {\n  // console.log('touchStartHandler', e)\n  let target = e.target as HTMLElement\n  // Si le touch a t dclench sur un lment interne (comme un <span>), on remonte jusqu'au div parent\n  while (target && target.tagName !== 'DIV') {\n    target = target.parentElement as HTMLElement\n  }\n\n  if (\n    target?.classList.contains('etiquette') &&\n    target?.classList.contains('dragOk')\n  ) {\n    // Stocker l'lment HTML complet (pour clonage)\n    const ele = target.cloneNode(true) as HTMLElement\n    ele.style.display = 'none'\n    target.before(ele)\n  }\n}\n\n// gre le dplacement de l'tiquette sur interface tactile\nfunction touchMoveHandler(e: TouchEvent) {\n  // console.log('touchMoveHandler', e)\n  e.preventDefault()\n  const touch = e.changedTouches[0]\n  let etiquette = touch.target as HTMLElement\n  while (etiquette && etiquette.tagName !== 'DIV') {\n    etiquette = etiquette.parentElement as HTMLElement\n  }\n\n  if (\n    etiquette &&\n    etiquette.classList.contains('etiquette') &&\n    etiquette.classList.contains('dragOk')\n  ) {\n    if (etiquette.parentElement) {\n      const top = etiquette.parentElement.offsetTop\n      const left = etiquette.parentElement.offsetLeft\n      const rectangleBounds = etiquette.parentElement.getBoundingClientRect()\n      if (rectangleBounds) {\n        const touchX = touch.clientX\n        const touchY = touch.clientY\n        ;(etiquette.previousElementSibling as HTMLDivElement).style.display =\n          'block'\n        ;(etiquette as HTMLDivElement).style.position = 'absolute'\n        ;(etiquette as HTMLDivElement).style.left =\n          `${touchX - rectangleBounds.left + left - etiquette.clientWidth / 2}px`\n        ;(etiquette as HTMLDivElement).style.top =\n          `${touchY - rectangleBounds.top + top - etiquette.clientHeight / 2}px`\n      }\n    }\n    // Expression rgulire pour capturer les 3 groupes de chiffres\n    const regex = /Ex(\\d+)Q(\\d+)I(\\d+)/\n    const matches = etiquette.id.match(regex)\n    let numeroExQuest = ''\n    if (matches) {\n      const numeroEx = matches[1]\n      const numeroQuest = matches[2]\n      numeroExQuest = `Ex${numeroEx}Q${numeroQuest}`\n    }\n\n    // rectangleEx0Q0R1 : on s'intresse qu'au rectangle de la question et NON toute la page\n    const rectangles = document.querySelectorAll(\n      `div.rectangleDND[id^=\"rectangle${numeroExQuest}\"`,\n    )\n    for (const rectangle of rectangles) {\n      const rectangleBounds = rectangle.getBoundingClientRect()\n      const isHovered =\n        touch.clientX > rectangleBounds.left &&\n        touch.clientX < rectangleBounds.right &&\n        touch.clientY > rectangleBounds.top &&\n        touch.clientY < rectangleBounds.bottom\n      if (isHovered) {\n        rectangle.classList.add('hovered')\n      } else {\n        rectangle.classList.remove('hovered')\n      }\n    }\n  }\n}\n/**\n * gre le dpot de l'tiquette sur interface tactile\n * @param e\n * @returns\n */\nfunction touchEndHandler(e: TouchEvent) {\n  // console.log('touchEndHandler', e)\n  const touch = e.changedTouches[0]\n  let etiquette = touch.target as HTMLElement\n  /* on a fait un TOUCH sur le bouton SUPPRIMER */\n  if (\n    etiquette &&\n    etiquette.tagName === 'BUTTON' &&\n    etiquette.classList.contains('delete-btn')\n  ) {\n    etiquette.click()\n    return\n  }\n  // On cherche l'tiquette\n  while (etiquette && etiquette.tagName !== 'DIV') {\n    etiquette = etiquette.parentElement as HTMLElement\n  }\n  if (\n    etiquette &&\n    etiquette.classList.contains('etiquette') &&\n    etiquette.classList.contains('dragOk')\n  ) {\n    const centerX = touch.clientX\n    const centerY = touch.clientY\n    // Expression rgulire pour capturer les 3 groupes de chiffres\n    const regex = /Ex(\\d+)Q(\\d+)I(\\d+)/\n    const matches = etiquette.id.match(regex)\n    let numeroExQuest = ''\n    if (matches) {\n      const numeroEx = matches[1]\n      const numeroQuest = matches[2]\n      numeroExQuest = `Ex${numeroEx}Q${numeroQuest}`\n    }\n\n    // rectangleEx0Q0R1 : on s'intresse qu'au rectangle de la question et NON toute la page.\n    const rectangles = document.querySelectorAll(\n      `div.rectangleDND[id^=\"rectangle${numeroExQuest}\"`,\n    )\n    let dropTarget: HTMLDivElement | null = null\n    for (const rectangle of rectangles) {\n      const rectangleBounds = rectangle.getBoundingClientRect()\n      if (\n        centerX > rectangleBounds.left &&\n        centerX < rectangleBounds.right &&\n        centerY > rectangleBounds.top &&\n        centerY < rectangleBounds.bottom\n      ) {\n        // on a trouch un rectangle qui peut rceptionner l'tiquette\n        dropTarget = rectangle as HTMLDivElement\n        break\n      }\n    }\n\n    if (dropTarget?.children?.length) {\n      for (let i = 0; i < dropTarget?.children?.length; i++) {\n        const rectangleBounds = dropTarget.children[i].getBoundingClientRect()\n        if (\n          centerX > rectangleBounds.left &&\n          centerX < rectangleBounds.right &&\n          centerY > rectangleBounds.top &&\n          centerY < rectangleBounds.bottom\n        ) {\n          // on a trouv une tiquette dans le rectangle qui peut rceptionner l'tiquette\n          dropTarget = dropTarget.children[i] as HTMLDivElement\n          break\n        }\n      }\n    }\n    if (\n      dropTarget?.classList.contains('rectangleDND') ||\n      dropTarget?.parentElement?.classList.contains('rectangleDND')\n    ) {\n      if (\n        etiquette.classList.contains('duplicable') &&\n        dropTarget.classList.contains('rectangleDND')\n      ) {\n        // console.log('cloneEtiquette', etiquette)\n        const clonedEtiquette = etiquette.cloneNode(true) as HTMLDivElement\n        clonedEtiquette.id = `${etiquette.id}-clone-${Date.now()}`\n        addDeleteButton(clonedEtiquette)\n        clonedEtiquette.style.position = 'relative'\n        clonedEtiquette.style.top = '0px'\n        clonedEtiquette.classList.remove('dragOk')\n        ;(clonedEtiquette as HTMLDivElement).style.left = '0px'\n        ;(clonedEtiquette as HTMLDivElement).style.zIndex = '1'\n        dropTarget.appendChild(clonedEtiquette)\n      } else if (dropTarget.classList.contains('rectangleDND')) {\n        // console.log('cloneEtiquette', etiquette)\n        addDeleteButton(etiquette, etiquette.parentElement)\n        // etiquette.style.position = 'relative'\n        // etiquette.style.top = '0px'\n        // etiquette.classList.remove('dragOk')\n        // etiquette.style.left = '0px'\n        // etiquette.style.zIndex = '1'\n        etiquette.previousElementSibling?.remove()\n        dropTarget.appendChild(etiquette)\n      } else {\n        // console.log('cloneEtiquette2', etiquette)\n        const clonedEtiquette = etiquette.cloneNode(true) as HTMLDivElement\n        clonedEtiquette.id = `${etiquette.id}-clone-${Date.now()}`\n        addDeleteButton(clonedEtiquette)\n        clonedEtiquette.style.position = 'relative'\n        clonedEtiquette.style.top = '0px'\n        clonedEtiquette.classList.remove('dragOk')\n        ;(clonedEtiquette as HTMLDivElement).style.left = '0px'\n        ;(clonedEtiquette as HTMLDivElement).style.zIndex = '1'\n        dropTarget.after(clonedEtiquette)\n      }\n      dropTarget.classList.remove('hovered')\n    }\n    // on remet l'tiquette  sa place\n    ;(etiquette as HTMLDivElement).style.position = 'relative'\n    ;(etiquette as HTMLDivElement).style.top = '0px'\n    ;(etiquette as HTMLDivElement).style.left = '0px'\n    if (etiquette.classList.contains('duplicable'))\n      etiquette.previousElementSibling?.remove()\n  }\n}\n// met le rectangle en effet 'green glowing'\nfunction dragEnterHandler(e: DragEvent) {\n  if (\n    e.target instanceof HTMLElement &&\n    e.target.classList.contains('rectangleDND')\n  ) {\n    e.target.classList.add('hovered')\n  }\n}\n// retire l'effet 'green glowing'\nfunction dragLeaveHandler(e: DragEvent) {\n  const target = e.target\n  if (\n    target instanceof HTMLElement &&\n    (target.classList.contains('rectangleDND') ||\n      target.classList.contains('trashDND'))\n  ) {\n    target.classList.remove('hovered')\n  }\n}\n\nfunction addDeleteButton(\n  etiquette: HTMLElement,\n  parent: HTMLElement | null = null,\n) {\n  const deleteBtn = document.createElement('button')\n  deleteBtn.textContent = 'x'\n  deleteBtn.classList.add('delete-btn')\n  deleteBtn.addEventListener('click', () => {\n    if (etiquette.classList.contains('duplicable')) {\n      etiquette.remove() // Supprime l'tiquette du DOM\n    } else {\n      parent?.appendChild(etiquette)\n      // delete le bouton\n      etiquette.removeChild(deleteBtn)\n    }\n  })\n  etiquette.appendChild(deleteBtn)\n}\n\n/**\n * C'est la fonction utilise par exerciceInteractif pour vrifier ce type de question\n * @param exercice\n * @param question\n * @returns\n */\nexport function verifDragAndDrop(\n  exercice: Exercice,\n  question: number,\n): {\n  isOk: boolean\n  feedback: string\n  score: { nbBonnesReponses: number; nbReponses: number }\n} {\n  // tout d'abord on va supprimer les listeners !\n  const exoDragAndDrops = exercice.dragAndDrops\n  if (exoDragAndDrops == null) {\n    window.notify(\n      \"Problme survenu dans verifDragAndDrop : il n'y a pas d'array dragAndDrops dans exercice\",\n      {},\n    )\n    return {\n      isOk: false,\n      feedback: 'Un problme est survenu',\n      score: { nbBonnesReponses: 0, nbReponses: 0 },\n    }\n  }\n  const leDragAndDrop = exoDragAndDrops[question]\n  for (const [element, type, listener] of leDragAndDrop.listeners) {\n    element.removeEventListener(type, listener as EventListener)\n  }\n  // fin de suppression des listeners\n  const numeroExercice = exercice.numeroExercice\n  const objetReponses = exercice.autoCorrection[question].reponse?.valeur\n  let nbBonnesReponses = 0\n  let etiquettesAbsentes = 0\n  let etiquettesMalPlacees = 0\n  let etiquettesBienPlacees = 0\n  if (objetReponses) {\n    const bareme = objetReponses.bareme ?? toutPourUnPoint\n\n    const variables = Object.entries(objetReponses).filter(\n      ([key]) => key !== 'callback' && key !== 'bareme' && key !== 'feedback',\n    )\n\n    let nbReponses = objetReponses != null ? variables.length : 0\n    const rectangles = get(\n      `rectanglesEx${exercice.numeroExercice}Q${question}`,\n      false,\n    )\n    if (!rectangles) {\n      window.notify(\n        'Un problme avec verifDragAndDrop, je ne trouve pas la zone de drop !',\n        {},\n      )\n      return {\n        isOk: false,\n        feedback: 'Un problme est survenu',\n        score: { nbBonnesReponses, nbReponses },\n      }\n    }\n    if (objetReponses == null) {\n      window.notify(\n        \"Un problme avec verifDragAndDrop, il n'y a pas de rponses de dfinies !\",\n        {},\n      )\n      return {\n        isOk: false,\n        feedback: 'Un problme est survenu',\n        score: { nbBonnesReponses, nbReponses },\n      }\n    }\n    const reponses = Object.entries(objetReponses)\n    const points: number[] = []\n\n    if (!exercice.answers) exercice.answers = {}\n    for (let k = 1; k <= nbReponses; k++) {\n      const rectangle = get(\n        `rectangleEx${numeroExercice}Q${question}R${k}`,\n        false,\n      )\n      if (rectangle) {\n        const goodAnswer = reponses.find(([key]) => key === `rectangle${k}`)\n        const etiquettesDedans =\n          rectangle.querySelectorAll<HTMLElement>('.etiquette')\n        if (goodAnswer && !goodAnswer[1]?.options?.multi) {\n          // Ici, il ne doit y avoir qu'une seule tiquette dans le rectangle\n          etiquettesMalPlacees += etiquettesDedans.length - 1\n          const etiquetteDedans = etiquettesDedans[0]\n          const id =\n            etiquetteDedans?.id ?? `etiquetteEx${numeroExercice}Q${question}I0`\n          const etiquetteId = id.split('-')[0].split('I')[1] // on dbarasse du nom du clone et de ce qui est avant I pour rcuprer juste l'Id\n          exercice.answers = Object.assign(\n            exercice.answers,\n            Object.fromEntries([\n              [`rectangleDNDEx${numeroExercice}Q${question}R${k}`, id],\n            ]),\n          )\n          if (!etiquetteDedans) {\n            // Faut peut-tre pas compter faux si l'absence d'tiquette est normal, mais faut voir comment on fait\n            // si le rectangle peut rester vide, il faut que goodAnswer[1].value soit ''\n            if (\n              goodAnswer &&\n              goodAnswer[1] != null &&\n              goodAnswer[1].value.length === 0\n            ) {\n              nbBonnesReponses++\n              points.push(1)\n            } else {\n              rectangle.classList.add('bg-coopmaths-action-200')\n              points.push(0)\n              etiquettesAbsentes++\n            }\n          } else if (\n            goodAnswer &&\n            goodAnswer[1] != null &&\n            etiquetteId === goodAnswer[1].value &&\n            etiquettesMalPlacees === 0\n          ) {\n            etiquetteDedans?.classList.remove('bg-gray-200')\n            etiquetteDedans.classList.add('bg-coopmaths-warn-100')\n            nbBonnesReponses++\n            points.push(1)\n          } else {\n            if (\n              goodAnswer &&\n              goodAnswer[1] != null &&\n              etiquetteId === goodAnswer[1].value\n            ) {\n              etiquetteDedans?.classList.remove('bg-gray-200')\n              etiquetteDedans.classList.add('bg-coopmaths-warn-100')\n              for (let z = 1; z < etiquettesDedans.length; z++) {\n                etiquettesDedans[z].classList.remove('bg-gray-200')\n                etiquettesDedans[z].classList.add('bg-coopmaths-action-200')\n              }\n            } else {\n              etiquetteDedans?.classList.remove('bg-gray-200')\n              etiquetteDedans.classList.add('bg-coopmaths-action-200')\n            }\n            points.push(0)\n          }\n        } else {\n          // Ici, il y a plus d'une tiquette dans le rectangle ! l'option multi est true\n          const etiquettesIds = []\n          const etiquettesTxts = []\n          for (const etiquette of etiquettesDedans) {\n            const id = etiquette.id\n            // const etiquetteId = id.split('-')[0].split('I')[1] // on dbarasse du nom du clone et de ce qui est avant I pour rcuprer juste l'Id\n            etiquettesIds.push(id) // On doit mettre l'id complte pour mathaleaWriteStudentPreviousAnswers()... qui devra grer le clonage  son tour\n            etiquettesTxts.push(etiquette.innerText.replace('\\nx', ''))\n          }\n          exercice.answers = Object.assign(\n            exercice.answers,\n            Object.fromEntries([\n              [\n                `rectangleDNDEx${numeroExercice}Q${question}R${k}`,\n                etiquettesIds.join(';'),\n              ],\n              [\n                `texteDNDEx${numeroExercice}Q${question}R${k}`,\n                etiquettesTxts.join(' '),\n              ],\n            ]),\n          )\n          const goodAnswer = reponses.find(([key]) => key === `rectangle${k}`)\n          if (etiquettesDedans.length === 0) {\n            // Faut peut-tre pas compter faux si l'absence d'tiquette est normal, mais faut voir comment on fait\n            // si le rectangle peut rester vide, il faut que goodAnswer[1].value soit ''\n            if (\n              goodAnswer &&\n              goodAnswer[1] != null &&\n              goodAnswer[1].value.length === 0\n            ) {\n              nbBonnesReponses++\n              points.push(1)\n            } else {\n              rectangle.classList.add('bg-coopmaths-action-200')\n              points.push(0)\n              etiquettesAbsentes++\n            }\n          } else {\n            if (goodAnswer && goodAnswer[1] != null) {\n              let isOk: boolean = true\n              const value = Array.isArray(goodAnswer[1].value)\n                ? goodAnswer[1].value\n                : [goodAnswer[1].value]\n              for (const val of value) {\n                isOk = true\n                etiquettesBienPlacees = 0 // on reinitialise car plusieurs rponses possibles, malheureusement on garde la dernire\n                etiquettesMalPlacees = 0 // on reinitialise car plusieurs rponses possibles, malheureusement on garde la dernire\n                const listeOfIds: string[] = val.split('|')\n                const ordered = goodAnswer[1].options.ordered ?? false\n                if (listeOfIds.length !== etiquettesDedans.length) {\n                  isOk = false\n                }\n                if (ordered) {\n                  for (\n                    let j = 0;\n                    j < listeOfIds.length && j < etiquettesDedans.length;\n                    j++\n                  ) {\n                    // compare mme si pas mme longueur\n                    const etiquette = etiquettesDedans[j]\n                    const id = listeOfIds[j]\n                    if (id === etiquette.id.split('I').pop()?.split('-')[0]) {\n                      etiquette.classList.add('bg-coopmaths-warn-100')\n                      etiquettesBienPlacees++\n                    } else {\n                      etiquette.classList.add('bg-coopmaths-action-200')\n                      etiquettesMalPlacees++\n                      isOk = false\n                    }\n                  }\n                  etiquettesAbsentes =\n                    listeOfIds.length -\n                    listeOfIds.filter((el: string) =>\n                      Array.from(etiquettesDedans).find(\n                        (etiquette) =>\n                          el === etiquette.id.split('I').pop()?.split('-')[0],\n                      ),\n                    ).length\n                  if (etiquettesAbsentes < 0) etiquettesAbsentes = 0\n                  if (isOk === true) break\n                } else {\n                  // @todo non ordered\n                  for (const etiquette of etiquettesDedans) {\n                    const id = etiquette.id.split('I')[1].split('-')[0]\n                    if (listeOfIds.includes(id)) {\n                      etiquette.classList.add('bg-coopmaths-warn-100')\n                    } else {\n                      etiquette.classList.add('bg-coopmaths-action-200')\n                      isOk = false\n                    }\n                  }\n                  etiquettesAbsentes =\n                    listeOfIds.length -\n                    listeOfIds.filter((el: string) =>\n                      Array.from(etiquettesDedans).find(\n                        (etiquette) =>\n                          el === etiquette.id.split('I').pop()?.split('-')[0],\n                      ),\n                    ).length\n                  if (isOk === true && etiquettesAbsentes === 0) break\n                }\n              }\n              if (isOk) {\n                nbBonnesReponses++\n                points.push(1)\n              } else {\n                points.push(0)\n              }\n            }\n          }\n        }\n      }\n    }\n    // gestion du feedback\n    const spanReponseLigne = document.querySelector(\n      `#resultatCheckEx${numeroExercice}Q${question}`,\n    )\n\n    let typeFeedback = 'positive'\n    let resultat: string\n    if (nbBonnesReponses === nbReponses) {\n      if (spanReponseLigne) {\n        spanReponseLigne.innerHTML = ''\n      }\n      resultat = 'OK'\n    } else {\n      if (spanReponseLigne) spanReponseLigne.innerHTML = ''\n      typeFeedback = 'error'\n      resultat = 'KO'\n    }\n    // Gestion du feedback global de la question\n    if (spanReponseLigne) {\n      ;(spanReponseLigne as HTMLSpanElement).style.fontSize = 'large'\n    }\n    const eltFeedback = get(`feedbackEx${numeroExercice}Q${question}`, false)\n    let message = ''\n    if (eltFeedback) {\n      eltFeedback.innerHTML = ''\n    }\n    if (resultat === 'KO') {\n      // Juste mais incomplet\n      if (nbBonnesReponses > 0) {\n        message = `${nbBonnesReponses} bonne${nbBonnesReponses > 1 ? 's' : ''} rponse${nbBonnesReponses > 1 ? 's' : ''}`\n      }\n      if (etiquettesBienPlacees > 0) {\n        message += ` ${etiquettesBienPlacees} rponse${etiquettesBienPlacees > 1 ? 's' : ''} bien place${etiquettesBienPlacees > 1 ? 's' : ''}`\n      }\n      if (etiquettesAbsentes > 0) {\n        message += ` ${etiquettesAbsentes} rponse${etiquettesAbsentes > 1 ? 's' : ''} manquante${etiquettesAbsentes > 1 ? 's' : ''}`\n      }\n      if (etiquettesMalPlacees > 0) {\n        message += ` ${etiquettesMalPlacees} rponse${etiquettesMalPlacees > 1 ? 's' : ''} mal place${etiquettesMalPlacees > 1 ? 's' : ''}`\n      }\n      messageFeedback({\n        id: `feedbackEx${numeroExercice}Q${question}`,\n        message,\n        type: typeFeedback,\n      })\n    } else {\n      message = ''\n    }\n\n    ;[nbBonnesReponses, nbReponses] = bareme(points)\n\n    return {\n      isOk: nbBonnesReponses === nbReponses,\n      feedback: '',\n      score: { nbBonnesReponses, nbReponses },\n    }\n  }\n  window.notify(\n    \"VerifDragAndDrop a un problme : il n'y a pas d'objet rponse fourni\",\n    {},\n  )\n  return {\n    isOk: false,\n    feedback: 'Un problme est survenu',\n    score: { nbBonnesReponses: 0, nbReponses: 0 },\n  }\n}\n\nclass DragAndDrop {\n  exercice: Exercice\n  question: number\n  consigne: string\n  etiquettes: Etiquette[][]\n  enonceATrous: string\n  listeners: [Element, string, DragHandler | TouchHandler][]\n  constructor({\n    exercice,\n    question,\n    consigne,\n    etiquettes,\n    enonceATrous,\n  }: {\n    exercice: Exercice\n    question: number\n    consigne: string\n    etiquettes: Etiquette[][]\n    enonceATrous: string\n  }) {\n    this.exercice = exercice\n    this.question = question\n    this.consigne = consigne\n    this.etiquettes = etiquettes\n    this.enonceATrous = enonceATrous\n    this.listeners = []\n  }\n\n  /** Une mthode pour ajouter un contenu interactif de type Drag and drop\n   *  enonceATrous est une chaine de caractres avec le format suivant: 'blabla..%{rectangle1}blabla%{rectangle2}blibli...'\n   *  Les diffrents % { rectanglen } sont remplacs par des div rectangulaires pouvant accueillir les tiquettes.\n   * @param param0\n   * @returns\n   */\n  ajouteDragAndDrop({\n    melange = false,\n    duplicable = false,\n  }: {\n    melange: boolean\n    duplicable: boolean\n  }) {\n    const numeroExercice = this.exercice.numeroExercice\n    if (context.isHtml) {\n      let html = ''\n      const rule = '<hr width=\"100%\" height=\"0px\" />'\n      html += `<div class=\"questionDND\" id=\"divDragAndDropEx${numeroExercice}Q${this.question}\">\\n\\t`\n      html += `<div class=\"consigneDND\">${this.consigne}</div>\\n\\t`\n      html += `<div  class=\"etiquettes\" id=\"etiquettesEx${numeroExercice}Q${this.question}\">\\n\\t` // voir si on laisse la bordure : ${this.exercice.interactif ? 'style=\"border: 1px dashed #AAA\" ' : ''}\n      for (const etiquetteRaw of this.etiquettes) {\n        const etiquettesEnDesordreOuPas = melange\n          ? shuffle(etiquetteRaw.slice())\n          : etiquetteRaw.slice()\n        for (const etiquette of etiquettesEnDesordreOuPas) {\n          html += `<div class=\"etiquette${this.exercice.interactif ? ' dragOk' : ' noDrag'}${duplicable ? ' duplicable' : ''}${this.exercice.interactif ? ' bg-gray-200' : ''}\" draggable=\"${this.exercice.interactif ? 'true' : 'false'}\" id=\"etiquetteEx${numeroExercice}Q${this.question}I${etiquette.id}\">${etiquette.contenu}</div>\\n\\t`\n        }\n\n        html += rule\n      }\n      html = html.substring(0, html.length - rule.length)\n      html += '</div>'\n\n      html += `<div class=\"rectangles\" id=\"rectanglesEx${numeroExercice}Q${this.question}\" >\\n\\t`\n      let resteEnonce = this.enonceATrous\n      let htmlEnonce = ''\n      while (resteEnonce) {\n        const chunks = /^(.*?)%\\{([^}]+)}(.*?)$/.exec(resteEnonce)\n        if (chunks) {\n          const [, start, n, end] = chunks\n          const name = n\n          if (name == null) throw Error(`Dfinition de ${name} manquante`)\n          htmlEnonce += `<span>${start}</span>`\n          if (this.exercice.interactif) {\n            htmlEnonce += `<div class=\"rectangleDND\" id=\"rectangleEx${numeroExercice}Q${this.question}R${name.substring(9)}\"></div>`\n          } else {\n            htmlEnonce +=\n              '<hr style=\"height: 30px; width: 60px; border: 1px dashed #555;\">'\n          }\n          resteEnonce = end ?? ''\n        } else {\n          htmlEnonce += resteEnonce\n          resteEnonce = ''\n        }\n      }\n      html += htmlEnonce\n      html += `<span id=\"resultatCheckEx${numeroExercice}Q${this.question}\"></span></div>`\n      if (this.exercice.interactif) {\n        // ajoutons le div#feedback\n        html += `<div class=\"ml-2 py-2 italic text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest\" id=\"feedbackEx${numeroExercice}Q${this.question}\"></div>`\n        // Il faut mettre en place les listeners !\n        document.addEventListener('exercicesAffiches', () => {\n          const divEtiquettes = get(\n            `etiquettesEx${numeroExercice}Q${this.question}`,\n            false,\n          )\n          if (divEtiquettes) {\n            divEtiquettes.addEventListener('drop', dropHandler)\n            divEtiquettes.addEventListener('dragover', dragOverHandler)\n            divEtiquettes.addEventListener('touchmove', touchMoveHandler, {\n              capture: true,\n            })\n            divEtiquettes.addEventListener('touchend', touchEndHandler)\n            this.listeners.push(\n              [divEtiquettes, 'drop', dropHandler],\n              [divEtiquettes, 'dragover', dragOverHandler],\n              [divEtiquettes, 'touchmove', touchMoveHandler],\n              [divEtiquettes, 'touchend', touchEndHandler],\n            )\n            for (const etiquette of divEtiquettes.querySelectorAll(\n              '.etiquette',\n            )) {\n              ;(etiquette as HTMLDivElement).addEventListener(\n                'dragstart',\n                dragStartHandler,\n              )\n              ;(etiquette as HTMLDivElement).addEventListener(\n                'dragend',\n                dragEndHandler,\n              )\n              ;(etiquette as HTMLDivElement).addEventListener(\n                'touchstart',\n                touchStartHandler,\n                { capture: false },\n              )\n              this.listeners.push(\n                [etiquette, 'dragstart', dragStartHandler],\n                [etiquette, 'touchstart', touchStartHandler],\n                [etiquette, 'dragend', dragEndHandler],\n              )\n            }\n          }\n\n          const rectangles = get(\n            `rectanglesEx${numeroExercice}Q${this.question}`,\n            false,\n          )\n          if (rectangles) {\n            for (const rectangle of rectangles.querySelectorAll(\n              '.rectangleDND',\n            )) {\n              ;(rectangle as HTMLDivElement).addEventListener(\n                'dragover',\n                dragOverHandler,\n              )\n              ;(rectangle as HTMLDivElement).addEventListener(\n                'drop',\n                dropHandler,\n              )\n              ;(rectangle as HTMLDivElement).addEventListener(\n                'touchmove',\n                touchMoveHandler,\n              )\n              ;(rectangle as HTMLDivElement).addEventListener(\n                'touchend',\n                touchEndHandler,\n              )\n              ;(rectangle as HTMLDivElement).addEventListener(\n                'dragenter',\n                dragEnterHandler,\n              )\n              ;(rectangle as HTMLDivElement).addEventListener(\n                'dragleave',\n                dragLeaveHandler,\n              )\n              this.listeners.push(\n                [rectangle, 'dragover', dragOverHandler],\n                [rectangle, 'drop', dropHandler],\n                [rectangle, 'touchmove', touchMoveHandler],\n                [rectangle, 'touchend', touchEndHandler],\n                [rectangle, 'dragenter', dragEnterHandler],\n                [rectangle, 'dragleave', dragLeaveHandler],\n              )\n            }\n          }\n        })\n      } else {\n        const divEtiquettes = get(\n          `etiquettesEx${numeroExercice}Q${this.question}`,\n          false,\n        )\n        if (divEtiquettes) {\n          for (const etiquette of divEtiquettes.querySelectorAll(\n            '.etiquette',\n          )) {\n            etiquette.classList.add('noDrag')\n          }\n        }\n      }\n      return html\n    }\n    const latex = ''\n    return latex\n  }\n}\n\nexport default DragAndDrop\n","import Decimal from 'decimal.js'\nimport FractionEtendue from '../../modules/FractionEtendue'\nimport Grandeur from '../../modules/Grandeur'\nimport { addElement, get, setStyles } from '../html/dom'\nimport {\n  fonctionComparaison,\n  // fractionCompare,\n  // equalFractionCompare,\n  // simplerFractionCompare,\n  // hmsCompare,\n  // intervalCompare,\n  // numberCompare,\n  // powerCompare,\n  // scientificCompare,\n  // unitsCompare,\n  // texteAvecCasseCompare,\n  // texteSansCasseCompare,\n  // expressionDeveloppeeEtNonReduiteCompare,\n  // expressionDeveloppeeEtReduiteCompare,\n  type CompareFunction,\n  type OptionsComparaisonType,\n} from './comparisonFunctions'\nimport { verifQuestionMathLive } from './mathLive'\nimport { verifQuestionQcm } from './qcm'\nimport { verifQuestionListeDeroulante } from './questionListeDeroulante'\n// import Hms from '../../modules/Hms'\nimport type Figure from 'apigeom/src/Figure'\nimport type Exercice from '../../exercices/Exercice'\nimport type { OldFormatInteractifType } from '../../exercices/Exercice'\nimport MetaExercice from '../../exercices/MetaExerciceCan'\nimport { context } from '../../modules/context'\nimport Hms from '../../modules/Hms'\nimport type { InteractivityType } from '../types'\nimport { afficheScore, type ResultOfExerciceInteractif } from './afficheScore'\nimport { verifDragAndDrop } from './DragAndDrop'\nexport interface ReponseParams {\n  digits?: number\n  decimals?: number\n  signe?: boolean\n  exposantNbChiffres?: number\n  exposantSigne?: boolean\n  approx?: number | 'intervalleStrict'\n  aussiCorrect?: number | FractionEtendue\n  digitsNum?: number\n  digitsDen?: number\n  basePuissance?: number\n  exposantPuissance?: number\n  baseNbChiffres?: number\n  milieuIntervalle?: number\n  formatInteractif?: InteractivityType | OldFormatInteractifType\n  precision?: number\n  scoreapprox?: number\n  vertical?: boolean\n  strict?: boolean\n  vhead?: boolean\n  tpoint?: string\n}\n\n/** les figures cliquables pour une question donne */\nexport type clickFigures = { id: string; solution: boolean }[]\n\nexport type AnswerType = {\n  value: AnswerValueType\n  compare?: CompareFunction\n  options?: OptionsComparaisonType\n}\n\nexport type AnswerNormalizedType = {\n  value: string | string[]\n  compare?: CompareFunction\n  options?: OptionsComparaisonType\n}\n\nexport interface Valeur {\n  bareme?: (listePoints: number[]) => [number, number]\n  feedback?: (saisies: Record<string, string>) => string\n  reponse?: AnswerType\n  champ1?: AnswerType\n  champ2?: AnswerType\n  champ3?: AnswerType\n  champ4?: AnswerType\n  champ5?: AnswerType\n  champ6?: AnswerType\n  rectangle1?: AnswerType\n  rectangle2?: AnswerType\n  rectangle3?: AnswerType\n  rectangle4?: AnswerType\n  rectangle5?: AnswerType\n  rectangle6?: AnswerType\n  rectangle7?: AnswerType\n  rectangle8?: AnswerType\n\n  // on va aller jusque 8 pour l'instant, si besoin on en ajoutera\n  L1C1?: AnswerType\n  L1C2?: AnswerType\n  L1C3?: AnswerType\n  L2C1?: AnswerType\n  L2C2?: AnswerType\n  L2C3?: AnswerType\n  L3C1?: AnswerType\n  L3C2?: AnswerType\n  L3C3?: AnswerType\n\n  // idem on en ajoutera si besoin\n  callback?: (\n    exercice: Exercice,\n    question: number,\n    variables: [string, AnswerType][],\n    bareme: (listePoints: number[]) => [number, number],\n  ) => {\n    isOk: boolean\n    feedback: string\n    score: { nbBonnesReponses: number; nbReponses: number }\n  }\n}\n/**\n * Puisque tous les attributs de Valeur sont facultatifs, on vrifie juste si c'est un objet (et ce type est assez inutile du coup car quasiment identique  un unknown)\n */\nexport function isValeur(value: unknown): value is Valeur {\n  return typeof value === 'object'\n}\n\nexport interface ValeurNormalized {\n  bareme?: (listePoints: number[]) => [number, number]\n  feedback?: (saisies: object) => string\n  reponse?: AnswerNormalizedType\n  champ1?: AnswerNormalizedType\n  champ2?: AnswerNormalizedType\n  champ3?: AnswerNormalizedType\n  champ4?: AnswerNormalizedType\n  champ5?: AnswerNormalizedType\n  champ6?: AnswerNormalizedType\n  rectangle1?: AnswerNormalizedType\n  rectangle2?: AnswerNormalizedType\n  rectangle3?: AnswerNormalizedType\n  rectangle4?: AnswerNormalizedType\n  rectangle5?: AnswerNormalizedType\n  rectangle6?: AnswerNormalizedType\n  rectangle7?: AnswerNormalizedType\n  rectangle8?: AnswerNormalizedType\n\n  // on va aller jusque 6 pour l'instant, si besoin on en ajoutera\n  L1C1?: AnswerNormalizedType\n  L1C2?: AnswerNormalizedType\n  L2C1?: AnswerNormalizedType\n  L2C2?: AnswerNormalizedType // idem on en ajoutera si besoin\n  callback?: (\n    exercice: Exercice,\n    question: number,\n    variables: [string, AnswerNormalizedType][],\n    bareme: (listePoints: number[]) => [number, number],\n  ) => {\n    isOk: boolean\n    feedback: string\n    score: { nbBonnesReponses: number; nbReponses: number }\n  }\n}\n\nexport type AnswerValueType =\n  | string\n  | string[]\n  | number\n  | number[]\n  | FractionEtendue\n  | Decimal\n  | Grandeur\n  | Hms\n  | Grandeur[]\n  | Hms[]\n  | Decimal[]\n  | FractionEtendue[]\nexport function isAnswerValueType(value: unknown): value is AnswerValueType {\n  return (\n    typeof value === 'string' ||\n    (Array.isArray(value) &&\n      value.every((value) => typeof value === 'string')) ||\n    typeof value === 'number' ||\n    (Array.isArray(value) &&\n      value.every((value) => typeof value === 'number')) ||\n    value instanceof FractionEtendue ||\n    (Array.isArray(value) &&\n      value.every((value) => value instanceof FractionEtendue)) ||\n    value instanceof Decimal ||\n    (Array.isArray(value) &&\n      value.every((value) => value instanceof Decimal)) ||\n    value instanceof Grandeur ||\n    (Array.isArray(value) &&\n      value.every((value) => value instanceof Grandeur)) ||\n    value instanceof Hms ||\n    (Array.isArray(value) && value.every((value) => value instanceof Hms))\n  )\n}\n\nexport type ReponseComplexe = AnswerValueType | Valeur\nexport function isReponseComplexe(value: unknown): value is ReponseComplexe {\n  return isAnswerValueType(value) || isValeur(value)\n}\n\nexport type UneProposition = {\n  texte?: string\n  statut?: number | boolean | string\n  sanscadre?: boolean | number\n  multicolsBegin?: boolean\n  multicolsEnd?: boolean\n  numQuestionVisible?: boolean\n  type?: string\n  feedback?: string\n  pointilles?: boolean | number\n  enonce?: string\n  propositions?: UneProposition[]\n  options?: {\n    ordered?: boolean\n    vertical?: boolean\n    lastChoice?: number\n    barreseparation?: boolean\n    multicols?: boolean\n    nbCols?: number\n    digits?: number\n    decimals?: number\n    signe?: boolean\n    exposantNbChiffres?: number\n    exposantSigne?: boolean\n    approx?: number\n    multicolsAll?: boolean\n    numerotationEnonce?: boolean\n    avecSymboleMult?: boolean\n  }\n  reponse?: {\n    valeur?:\n      | ValeurNormalized\n      | ValeurNormalized[]\n      | number\n      | number[]\n      | FractionEtendue\n      | Decimal\n      | FractionEtendue[]\n      | Decimal[]\n      | string\n      | string[]\n    param?: ReponseParams\n    textePosition?: string\n    texte?: string\n    alignement?: string\n  }\n}\n\nexport type LegacyReponse = string | FractionEtendue | Decimal | number\nexport type LegacyReponses = LegacyReponse[] | LegacyReponse\nexport interface AutoCorrection {\n  enonce?: string\n  enonceAvant?: boolean\n  melange?: boolean\n  enonceAGauche?: boolean\n  enonceAvantUneFois?: boolean\n  enonceCentre?: boolean\n  enonceApresNumQuestion?: boolean\n  propositions?: UneProposition[]\n  reponse?: {\n    valeur?: ValeurNormalized\n    param?: ReponseParams\n    textePosition?: string\n    texte?: string\n  }\n  options?: {\n    radio?: boolean\n    ordered?: boolean\n    vertical?: boolean\n    lastChoice?: number\n    barreseparation?: boolean\n    multicols?: boolean\n    nbCols?: number\n    digits?: number\n    decimals?: number\n    signe?: boolean\n    exposantNbChiffres?: number\n    exposantSigne?: boolean\n    approx?: number\n    multicolsAll?: boolean\n    numerotationEnonce?: boolean\n    avecSymboleMult?: boolean\n  }\n}\n\nexport interface MathaleaSVG extends SVGSVGElement {\n  etat: boolean\n  hasMathaleaListener: boolean\n}\n\nexport function isClickFiguresArray(\n  figures: Figure[] | clickFigures[],\n): figures is clickFigures[] {\n  return figures.length > 0 && Array.isArray(figures[0])\n}\n\n/**\n * Pour positionner le formatInteractif d'une question sur 'cliqueFigure'\n * On passe this.autoCorrection[i] c'est  dire l'objet rponse de la question.\n *  appeler aprs avoir rempli l'objet rponse qvec enonce et propositions\n * @param objetReponse\n */\nexport function setCliqueFigure(objetReponse: AutoCorrection) {\n  objetReponse.reponse = {\n    ...objetReponse.reponse,\n    param: { formatInteractif: 'cliqueFigure' },\n  }\n}\n/**\n * Pour positionner le formatInteractif d'une question sur 'qcm'\n * On passe this.autoCorrection[i] c'est  dire l'objet rponse de la question.\n *  appeler aprs avoir rempli l'objet rponse qvec enonce et propositions\n * @param objetReponse\n */\nexport function setQcm(objetReponse: AutoCorrection) {\n  objetReponse.reponse = {\n    ...objetReponse.reponse,\n    param: { formatInteractif: 'qcm' },\n  }\n}\n/**\n * Pour positionner le formatInteractif d'une question sur 'listeDeroulante'\n * On passe this.autoCorrection[i] c'est  dire l'objet rponse de la question.\n *  appeler aprs avoir rempli l'objet rponse qvec enonce et propositions\n * @param objetReponse\n */\nexport function setListeDeroulante(objetReponse: AutoCorrection) {\n  objetReponse.reponse = {\n    ...objetReponse.reponse,\n    param: { formatInteractif: 'listeDeroulante' },\n  }\n}\n\n/**\n * Cette fonction vrifie les rponses de chaque question en appelant la fonction associe  son formatInteractif ('mathlive', 'listeDeroulante', 'cliqueFigure', 'qcm')\n * @param {Exercice} exercice\n * @param {HTMLDivElement} divScore\n * @param {HTMLButtonElement} buttonScore\n * @returns {{numberOfPoints: number, numberOfQuestions: number}}\n */\nexport function exerciceInteractif(\n  exercice: Exercice,\n  divScore: HTMLDivElement,\n  buttonScore: HTMLButtonElement,\n): ResultOfExerciceInteractif {\n  let nbQuestionsValidees = 0\n  let nbQuestionsNonValidees = 0\n  exercice.answers = {}\n  if (exercice.interactifType === 'custom') {\n    return verifExerciceCustom(exercice, divScore, buttonScore)\n  }\n  for (let i = 0; i < exercice.autoCorrection.length; i++) {\n    const format = exercice.autoCorrection[i]?.reponse?.param?.formatInteractif\n    let resultat: string\n    switch (format) {\n      case 'custom': {\n        if (exercice instanceof MetaExercice) {\n          const result = exercice.correctionInteractives[i](i)\n          result === 'OK' ? nbQuestionsValidees++ : nbQuestionsNonValidees++\n        }\n        break\n      }\n      case 'dnd': {\n        const result = verifDragAndDrop(exercice, i)\n        nbQuestionsValidees += result.score.nbBonnesReponses\n        nbQuestionsNonValidees +=\n          result.score.nbReponses - result.score.nbBonnesReponses\n        if (result.feedback !== '') {\n          const spanFeedback = document.querySelector(\n            `#feedbackEx${exercice.numeroExercice}Q${i}`,\n          )\n          if (spanFeedback != null) {\n            spanFeedback.innerHTML = ` ${result.feedback}`\n            spanFeedback.classList.add(\n              'py-2',\n              'italic',\n              'text-coopmaths-warn-darkest',\n              'dark:text-coopmathsdark-warn-darkest',\n            )\n          }\n        }\n        break\n      }\n      case 'qcm':\n        resultat = verifQuestionQcm(exercice, i)\n        resultat === 'OK' ? nbQuestionsValidees++ : nbQuestionsNonValidees++\n        break\n      case 'listeDeroulante': {\n        resultat = verifQuestionListeDeroulante(exercice, i)\n        resultat === 'OK' ? nbQuestionsValidees++ : nbQuestionsNonValidees++\n        break\n      }\n      case 'cliqueFigure':\n        if ('callback' in exercice && typeof exercice.callback === 'function') {\n          resultat = verifQuestionCliqueFigure(\n            exercice,\n            i,\n            exercice.callback as (exercice: Exercice, i: number) => void,\n          )\n        } else {\n          resultat = verifQuestionCliqueFigure(exercice, i)\n        }\n        resultat === 'OK' ? nbQuestionsValidees++ : nbQuestionsNonValidees++\n        break\n      default:\n        {\n          const result = verifQuestionMathLive(exercice, i)\n          if (result == null) {\n            window.notify('erreur dans la correction de la question', {\n              exercice,\n              i,\n            })\n          } else {\n            nbQuestionsValidees += result.score.nbBonnesReponses\n            nbQuestionsNonValidees +=\n              result.score.nbReponses - result.score.nbBonnesReponses\n            if (result.feedback && result.feedback !== '') {\n              const divFeedback = document.querySelector(\n                `#feedbackEx${exercice.numeroExercice}Q${i}`,\n              )\n              if (divFeedback != null) {\n                divFeedback.innerHTML = ` ${result.feedback}`\n                divFeedback.classList.add(\n                  'py-2',\n                  'italic',\n                  'text-coopmaths-warn-darkest',\n                  'dark:text-coopmathsdark-warn-darkest',\n                )\n                ;(divFeedback as HTMLDivElement).style.display = 'block'\n              }\n            }\n          }\n        }\n        break\n    }\n  }\n  return afficheScore(\n    exercice,\n    nbQuestionsValidees,\n    nbQuestionsNonValidees,\n    divScore,\n    buttonScore,\n  )\n}\n\n/**\n * Le cas  part : un exercice custom fournit une fonction correctionInteractive qui doit corriger toutes les questions et s'occuper du feedback\n * @param exercice\n * @param divScore\n * @param buttonScore\n * @return {{numberOfPoints, numberOfQuestions: *}}\n */\nfunction verifExerciceCustom(\n  exercice: Exercice,\n  divScore: HTMLDivElement,\n  buttonScore: HTMLButtonElement,\n) {\n  let nbBonnesReponses = 0\n  let nbMauvaisesReponses = 0\n  // Le get est non strict car on sait que l'lment n'existe pas  la premire itration de l'exercice\n  let eltFeedback = get(`feedbackEx${exercice.numeroExercice}`, false)\n  // On ajoute le div pour le feedback\n  if (!eltFeedback) {\n    const eltExercice = get(\n      `exercice${exercice.numeroExercice}`,\n    ) as HTMLDivElement\n    eltFeedback = addElement(\n      eltExercice,\n      'div',\n      {\n        id: `feedbackEx${exercice.numeroExercice}`,\n      },\n      '',\n    )\n  }\n  setStyles(eltFeedback, 'marginBottom: 20px')\n  if (eltFeedback) eltFeedback.innerHTML = ''\n  // On utilise la correction dfinie dans l'exercice\n  if (exercice.exoCustomResultat) {\n    for (let i = 0; i < exercice.nbQuestions; i++) {\n      if (exercice.correctionInteractive != null) {\n        const correction = exercice.correctionInteractive(i)\n        if (Array.isArray(correction)) {\n          for (const result of correction) {\n            if (result === 'OK') nbBonnesReponses++\n            else nbMauvaisesReponses++\n          }\n        } else {\n          correction === 'OK' ? nbBonnesReponses++ : nbMauvaisesReponses++\n        }\n      }\n    }\n  } else {\n    for (let i = 0; i < exercice.nbQuestions; i++) {\n      if (exercice.correctionInteractive != null) {\n        exercice.correctionInteractive(i) === 'OK'\n          ? nbBonnesReponses++\n          : nbMauvaisesReponses++\n      }\n    }\n  }\n  return afficheScore(\n    exercice,\n    nbBonnesReponses,\n    nbMauvaisesReponses,\n    divScore,\n    buttonScore,\n  )\n}\n\nexport function prepareExerciceCliqueFigure(exercice: Exercice) {\n  // Ds que l'exercice est affich, on rajoute des listenners sur chaque lments de this.figures.\n  for (let i = 0; i < exercice.nbQuestions; i++) {\n    if (\n      exercice.figures != null &&\n      exercice.figures[i] != null &&\n      isClickFiguresArray(exercice.figures)\n    ) {\n      const figures = exercice.figures[i]\n      for (const objetFigure of figures) {\n        const figSvg: unknown = document.getElementById(objetFigure.id)\n        if (figSvg != null) {\n          const fig = figSvg as MathaleaSVG\n          if (!fig.hasMathaleaListener) {\n            fig.addEventListener('mouseover', mouseOverSvgEffect)\n            fig.addEventListener('mouseout', mouseOutSvgEffect)\n            fig.addEventListener('click', mouseSvgClick)\n            if (fig.etat === true) {\n              // MGu : si l'tat est true, c'est que ca a t coch par capytale\n              // il faudrait revoir le systme de figure cliquable avec un customelement\n            } else {\n              fig.etat = false\n            }\n            fig.style.margin = '10px'\n            fig.style.border = '3px solid transparent'\n            fig.hasMathaleaListener = true\n            // On enregistre que l'lment a dj un listenner pour ne pas lui remettre le mme  l'appui sur \"Nouvelles Donnes\"\n          }\n        }\n      }\n    }\n  }\n}\n\n// callback est une fonction facultative qui sera appele avant de vrifier la question\n// elle permet de faire des actions avant la vrification, comme par exemple mettre  jour la correction affiche (voir 6G45)\nfunction verifQuestionCliqueFigure(\n  exercice: Exercice,\n  i: number,\n  callback?: (exercice: Exercice, i: number) => void,\n): string {\n  // si il y a une callback, on l'appelle\n  if (callback != null) {\n    callback(exercice, i)\n  }\n  // suite du code habituel de verifQuestionCliqueFigure\n  // Le get est non strict car on sait que l'lment n'existe pas  la premire itration de l'exercice\n  let eltFeedback = get(`resultatCheckEx${exercice.numeroExercice}Q${i}`, false)\n  // On ajoute le div pour le feedback\n  if (!eltFeedback) {\n    const eltExercice = get(\n      `exercice${exercice.numeroExercice}`,\n    ) as HTMLDivElement\n    eltFeedback = addElement(\n      eltExercice,\n      'div',\n      {\n        id: `resultatCheckEx${exercice.numeroExercice}Q${i}`,\n      },\n      '',\n    )\n  }\n  setStyles(eltFeedback, 'marginBottom: 20px')\n  if (eltFeedback) eltFeedback.innerHTML = ''\n  const figures = []\n  let erreur = false // Aucune erreur dtecte\n  let nbFiguresCliquees = 0\n  if (\n    exercice.figures != null &&\n    exercice.figures[i] != null &&\n    Array.isArray(exercice.figures[i])\n  ) {\n    for (const objetFigure of exercice.figures[i]) {\n      const eltFigure: unknown = document.getElementById(objetFigure.id)\n      if (eltFigure != null) {\n        figures.push(eltFigure)\n        const fig = eltFigure as MathaleaSVG\n        fig.removeEventListener('mouseover', mouseOverSvgEffect)\n        fig.removeEventListener('mouseout', mouseOutSvgEffect)\n        fig.removeEventListener('click', mouseSvgClick)\n        fig.hasMathaleaListener = false\n        if (fig.etat) {\n          nbFiguresCliquees++\n          // Sauvegarde des reponses\n          if (exercice.answers) exercice.answers[objetFigure.id] = '1'\n        }\n        if (fig.etat !== objetFigure.solution) erreur = true\n      }\n    }\n  }\n\n  if (nbFiguresCliquees > 0 && !erreur) {\n    eltFeedback.innerHTML = ''\n    return 'OK'\n  }\n  eltFeedback.innerHTML = ''\n  return 'KO'\n}\n\nfunction mouseOverSvgEffect(event: MouseEvent) {\n  const elt = event.target as MathaleaSVG\n  elt.style.border = '3px solid #1DA962'\n}\n\nfunction mouseOutSvgEffect(event: MouseEvent) {\n  const elt = event.target as MathaleaSVG\n  elt.style.border = '3px solid transparent'\n}\n\nfunction mouseSvgClick(event: MouseEvent) {\n  const elt = event.target as MathaleaSVG\n  if (elt.etat) {\n    // Dja choisi, donc on le rinitialise\n    elt.style.border = '3px solid transparent'\n    elt.addEventListener('mouseover', mouseOverSvgEffect)\n    elt.addEventListener('mouseout', mouseOutSvgEffect)\n    elt.addEventListener('click', mouseSvgClick)\n    elt.etat = false\n  } else {\n    // Passe  l'tat choisi donc on dsactive les listenners pour over et pour out\n    elt.removeEventListener('mouseover', mouseOverSvgEffect)\n    elt.removeEventListener('mouseout', mouseOutSvgEffect)\n    elt.style.border = '3px solid #f15929'\n    elt.etat = true\n  }\n}\n\n/**\n * Prcise la rponse attendue\n * Cette fonction est dprcie : elle est remplace par la fonction handleAnswers qu'elle appelle pour les anciens exercices\n * C'est donc maintenant un wrapper de handleAnswers.\n * @param {Exercice} exercice = this\n * @param {number} i numro de la question\n * @param {any} valeurs Attention  ce que vous mettez ici : a doit tre en accord avec le formatInteractif ! pas de texNombre ou de stringNombre !\n * @param {ReponseParams} params\n * @deprecated Dans la mesure du possible, utiliser handleAnswers aprs avoir consulter la doc\n * @see https://forge.apps.education.fr/coopmaths/mathalea/-/wikis/Rendre-un-exercice-interactif\n */\nexport function setReponse(\n  exercice: Exercice,\n  i: number,\n  valeurs: LegacyReponses,\n  params: ReponseParams = {},\n) {\n  const url = new URL(window.location.href)\n  // if (Array.isArray(valeurs) && !url.searchParams.has('testCI')) window.notifyLocal('setReponse a reu un Array de reponses, il faut en finir avec a', { valeurs })\n  if (exercice.formatInteractif === 'qcm') return\n  let formatInteractif = params?.formatInteractif\n  let precision = params?.precision\n  let signe = params?.signe\n  if (formatInteractif === undefined) formatInteractif = 'calcul'\n  let reponses: Array<LegacyReponse>\n  if (url.hostname === 'localhost' && url.searchParams.has('triche')) {\n    console.info(\n      `Rponses de l'exercice ${(exercice.numeroExercice ?? 0) + 1} - question ${i + 1} : `,\n      valeurs,\n    )\n  }\n  if (\n    typeof valeurs === 'object' &&\n    (formatInteractif === 'tableauMathlive' ||\n      formatInteractif === 'fillInTheBlank')\n  ) {\n    throw Error(\n      'setReponse ne doit pas tre utilis pour tableauMathlive ni fillInTheBlank, il faut utiliser handleAnswers',\n    )\n  }\n  if (Array.isArray(valeurs)) {\n    // il peut y avoir une liste de valeurs de rponses  tester, on transfert dans reponses\n    reponses = [...valeurs] // reponses contient donc directement le tableau valeurs\n    // si valeur est un tableau on prend le signe de la premire valeur\n    if (valeurs[0] instanceof FractionEtendue) {\n      signe = (valeurs[0] as FractionEtendue).signe === -1 // si c'est une fraction, alors on regarde son signe (valeur -1, 0 ou 1)\n    } else {\n      if (typeof valeurs[0] === 'number') {\n        signe = valeurs[0] < 0 // on teste si elle est ngative, si oui, on force la case signe pour AMC\n      } else {\n        signe = Number(valeurs[0]) < 0\n      }\n    }\n  } else {\n    // Il n'y a qu'une valeur, on uniformise le format : reponses est une liste de une seule valeur\n    reponses = [valeurs] // ici, valeurs n'est pas un tableau mais on le met dans reponses sous forme de tableau\n    if (valeurs instanceof FractionEtendue) {\n      signe = valeurs.signe === -1 ? true : Boolean(signe) // si c'est une fraction, alors on regarde son signe (valeur -1, 0 ou 1)\n    } else {\n      signe = Number(valeurs) < 0 ? true : Boolean(signe) // on teste si elle est ngative, si oui, on force la case signe pour AMC\n    }\n  }\n  params.signe = signe\n\n  // @fixme reponses est un array ! toujours. Normalement, il ne devrait y avoir qu'une seule goodAnswer dedans, mais avant, on n'avait pas d'autres moyens pour verifier les saisies diverses\n  const reponse: LegacyReponse = (\n    reponses as Array<LegacyReponse>\n  )[0] as LegacyReponse // reponse est la premire d'entre elles (ou la seule)\n\n  // en contexte d'export AMC, on ne touche pas  l'existant\n  if (context.isAmc) {\n    let laReponseDemandee: LegacyReponse\n    switch (formatInteractif) {\n      case 'tableauMathlive':\n        //   if (reponses.filter((cellule) => Object.keys(cellule)[0].match(/L\\dC\\d/).length === 0).length !== 0) {\n        //    window.notify('setReponse : type \"tableauMathlive\" les objets proposs n\\'ont pas tous une cl de la forme L$C$', { reponses, exercice: exercice.uuid })\n        //  }\n        break\n      case 'fillInTheBlank':\n        break\n      case 'Num':\n        if (!(reponse instanceof FractionEtendue)) {\n          window.notify('setReponse : type \"Num\" une fraction est attendue !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        } else if (Number.isNaN(reponse.num) || Number.isNaN(reponse.den)) {\n          window.notify('setReponse : La fraction ne convient pas !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        }\n        break\n      case 'Den':\n        if (!(reponse instanceof FractionEtendue)) {\n          window.notify('setReponse : type \"Den\" une fraction est attendue !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        }\n        break\n      case 'calcul':\n        laReponseDemandee = reponse\n        if (typeof laReponseDemandee === 'string') {\n          laReponseDemandee = laReponseDemandee.replaceAll('dfrac', 'frac')\n        }\n        if (\n          typeof laReponseDemandee === 'number' ||\n          typeof laReponseDemandee === 'string'\n        ) {\n          laReponseDemandee = laReponseDemandee\n            .toString()\n            .replace(/\\s/g, '')\n            .replace(',', '.')\n        }\n        break\n      /* case 'nombreDecimal':\n        if (!(reponse instanceof Decimal)) {\n          window.notify(\n            'setReponse : type \"nombreDecimal\" un nombre est attendu !',\n            { reponses, exercice: exercice.uuid }\n          )\n        }\n        break */\n      /* case 'ecritureScientifique':\n        if (!(typeof reponse === 'string')) {\n          window.notify(\n            'setReponse : type \"ecritureScientifique\" la rponse n\\'est pas un string !',\n            { reponses, exercice: exercice.uuid }\n          )\n        }\n        // ToFix : vrifier que la chaine est au bon format\n        break */\n\n      case 'texte':\n        if (!(typeof reponse === 'string')) {\n          window.notify(\n            'setReponse : type \"texte\" la rponse n\\'est pas un string !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        break\n\n      case 'ignorerCasse':\n        if (!(typeof reponse === 'string')) {\n          window.notify(\n            'setReponse : type \"ignorerCasse\" la rponse n\\'est pas un string !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        break\n\n      case 'fractionEgale':\n        if (!(reponse instanceof FractionEtendue))\n          window.notify(\n            'setReponse : type \"fractionEgale\" une fraction est attendue !',\n            { reponses, exercice: exercice.uuid },\n          )\n        else if (isNaN(reponse.num) || isNaN(reponse.den))\n          window.notify('setReponse : La fraction ne convient pas !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        break\n\n      case 'unites': // Pour les exercices o l'on attend une mesure avec une unit au choix\n        if (!(reponse instanceof Grandeur)) {\n          window.notify(\n            'setReponse : type \"longueur\" la rponse n\\'est pas une instance de Grandeur !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        break\n      case 'intervalleStrict': // Pour les exercice o la saisie doit tre dans un intervalle\n        // ToFix : vrifier que la rponse est bien un intervalle valide\n        break\n      case 'intervalle':\n        // ToFix : vrifier que la rponse est bien un intervalle valide\n        break\n      case 'puissance':\n        // ToFix : vrifier que la rponse est bien l'criture d'une puissance ou en tout cas une rponse acceptable pour ce format\n        break\n      case 'canonicalAdd':\n        //  priori ce format ne concerne pas AMC\n        break\n    }\n\n    if (exercice.autoCorrection[i] === undefined) {\n      exercice.autoCorrection[i] = {}\n    }\n    if (exercice.autoCorrection[i].reponse === undefined) {\n      exercice.autoCorrection[i].reponse = {}\n    }\n    const rep = exercice.autoCorrection[i].reponse\n    if (rep != null) {\n      rep.param = params\n      // @ts-expect-error Pour AMC on ne change pas le format de rponse\n      rep.valeur = reponses // On n'a rien chang pour AMC, on continue de passer un array dont seule la premire valeur est utile\n    }\n    return // La rponse est prte pour AMC\n  }\n  // Ici on est en context non Amc, donc s'il y a un setReponse, c'est pour html interactif.\n  // On va transformer le l'objetReponse pour handleAnswers(), il n'y\n  let laReponseDemandee: LegacyReponse\n  if (exercice != null) {\n    params.formatInteractif = 'mathlive'\n    switch (formatInteractif) {\n      case 'listeDeroulante': {\n        if (exercice.autoCorrection == null) exercice.autoCorrection = []\n        if (exercice.autoCorrection[i] == null) exercice.autoCorrection[i] = {}\n        if (exercice.autoCorrection[i].reponse == null) {\n          exercice.autoCorrection[i].reponse = {}\n        }\n        const rep = exercice.autoCorrection[i].reponse\n        if (rep != null) {\n          if (rep.valeur == null) rep.valeur = {}\n          if (rep.valeur.reponse == null) rep.valeur.reponse = { value: '' }\n          if (rep.param == null) rep.param = {}\n          rep.param.formatInteractif = 'listeDeroulante'\n          Object.assign(rep.valeur.reponse.value, reponses)\n        }\n        return\n      }\n      case 'Num':\n        if (!(reponse instanceof FractionEtendue)) {\n          window.notify('setReponse : type \"Num\" une fraction est attendue !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        } else if (Number.isNaN(reponse.num) || Number.isNaN(reponse.den)) {\n          window.notify('setReponse : La fraction ne convient pas !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: String((reponse as FractionEtendue).num),\n              //  compare: numberCompare\n              compare: fonctionComparaison,\n            },\n          },\n          params,\n        )\n\n      case 'Den':\n        if (!(reponse instanceof FractionEtendue)) {\n          window.notify('setReponse : type \"Den\" une fraction est attendue !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: String((reponse as FractionEtendue).den),\n              //  compare: numberCompare\n              compare: fonctionComparaison,\n            },\n          },\n          params,\n        )\n\n      case 'calcul': {\n        if (reponses.length === 1) {\n          laReponseDemandee = reponse\n          if (typeof laReponseDemandee === 'string') {\n            laReponseDemandee = laReponseDemandee\n              .replaceAll('dfrac', 'frac')\n              .replace(/\\s/g, '')\n              .replace(',', '.')\n          }\n          // Ceci n'est plus ncessaire avec le wrapper de hanfleAnswer\n          /* else if (typeof laReponseDemandee === 'number') {\n            laReponseDemandee = String(laReponseDemandee)\n          } else if (laReponseDemandee instanceof FractionEtendue) {\n            laReponseDemandee = laReponseDemandee.texFraction.replaceAll(\n              'dfrac',\n              'frac'\n            )\n          } else if (laReponseDemandee instanceof Decimal) {\n            laReponseDemandee = laReponseDemandee.toString()\n          } */\n          return handleAnswers(\n            exercice,\n            i,\n            {\n              reponse: {\n                value: laReponseDemandee,\n                compare: fonctionComparaison,\n              },\n            },\n            params,\n          )\n        }\n        const value = []\n        for (let i = 0; i < reponses.length; i++) {\n          laReponseDemandee = reponses[i]\n          if (typeof laReponseDemandee === 'string') {\n            laReponseDemandee = laReponseDemandee\n              .replaceAll('dfrac', 'frac')\n              .replace(/\\s/g, '')\n              .replace(',', '.')\n          } else if (typeof laReponseDemandee === 'number') {\n            laReponseDemandee = String(laReponseDemandee)\n          } else if (laReponseDemandee instanceof FractionEtendue) {\n            laReponseDemandee = laReponseDemandee.texFraction.replaceAll(\n              'dfrac',\n              'frac',\n            )\n          } else if (laReponseDemandee instanceof Decimal) {\n            laReponseDemandee = laReponseDemandee.toString()\n          }\n          value.push(laReponseDemandee)\n        }\n\n        return handleAnswers(\n          exercice,\n          i,\n          { reponse: { value, compare: fonctionComparaison } },\n          params,\n        )\n      }\n\n      case 'texte':\n        if (typeof reponse !== 'string') {\n          window.notify(\n            'setReponse : type \"texte\" la rponse n\\'est pas un string !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: Array.isArray(reponses)\n                ? reponses.map(String)\n                : String(reponses),\n              compare: fonctionComparaison,\n              options: { texteAvecCasse: true },\n            },\n          },\n          params,\n        )\n\n      case 'ignorerCasse':\n        if (typeof reponse !== 'string') {\n          window.notify(\n            'setReponse : type \"ignorerCasse\" la rponse n\\'est pas un string !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: Array.isArray(reponses)\n                ? reponses.map((el) => String(el).toLowerCase())\n                : String(reponses).toLowerCase(),\n              // compare: texteSansCasseCompare\n              compare: fonctionComparaison,\n              options: { texteSansCasse: true },\n            },\n          },\n          params,\n        )\n\n      case 'fractionEgale':\n        if (!(reponse instanceof FractionEtendue)) {\n          window.notify(\n            'setReponse : type \"fractionEgale\" une fraction est attendue !',\n            { reponses, exercice: exercice.uuid },\n          )\n        } else if (Number.isNaN(reponse.num) || Number.isNaN(reponse.den)) {\n          window.notify('setReponse : La fraction ne convient pas !', {\n            reponses,\n            exercice: exercice.uuid,\n          })\n        }\n        if (Array.isArray(reponse)) {\n          window.notify(\n            \"setReponse a reu une liste de rponse pour le format fractionEgale, c'est incohrent !\",\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        if (reponse instanceof FractionEtendue) {\n          return handleAnswers(\n            exercice,\n            i,\n            {\n              reponse: {\n                value: reponse, // reponse.texFraction.replace('dfrac', 'frac') plus ncessaire : le wrapper de handleAnswers s'en occupe\n                compare: fonctionComparaison,\n              },\n            },\n            params,\n          )\n        }\n        break\n\n      case 'unites': // Pour les exercices o l'on attend une mesure avec une unit au choix\n        if (precision == null) precision = 0 // Des exercices utilisent le format 'unites' mais ne dfinissent pas la prcision\n        if (!(reponse instanceof Grandeur)) {\n          window.notify(\n            'setReponse : type \"longueur\" la rponse n\\'est pas une instance de Grandeur !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        if (reponse instanceof Grandeur) {\n          return handleAnswers(\n            exercice,\n            i,\n            {\n              reponse: {\n                value: reponse, // .toString().replace('\\u202f', '') plus ncessaire grce au wrapper de handleAnswers\n                compare: fonctionComparaison,\n                options: {\n                  unite: true,\n                  precisionUnite:\n                    10 ** precision *\n                    10 ** (reponse.puissanceUnite * reponse.puissancePrefixe),\n                },\n              },\n            },\n            params,\n          )\n        }\n        break\n      case 'intervalleStrict': // Pour les exercice o la saisie doit tre dans un intervalle\n        if (\n          reponses.length !== 2 ||\n          reponses.filter((el) => typeof el !== 'number').length !== 0\n        ) {\n          window.notify(\n            'setReponse : type \"intervalle\" la rponse n\\'est pas un tupple [number,number] !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: `]${reponses[0]};${reponses[1]}[`,\n              compare: fonctionComparaison,\n              options: { estDansIntervalle: true },\n            },\n          },\n          params,\n        )\n      case 'intervalle':\n        if (\n          !Array.isArray(reponses) ||\n          reponses.length !== 2 ||\n          reponses.filter((el) => typeof el !== 'number').length !== 0\n        ) {\n          window.notify(\n            'setReponse : type \"intervalle\" la rponse n\\'est pas un tupple [number,number] !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: `[${reponses[0]};${reponses[1]}]`,\n              compare: fonctionComparaison,\n              options: { estDansIntervalle: true },\n            },\n          },\n          params,\n        )\n      case 'puissance':\n        if (typeof reponse !== 'string') {\n          window.notify(\n            'setReponse : type \"puissance\" la rponse n\\'est pas un string !',\n            { reponses, exercice: exercice.uuid },\n          )\n        }\n        return handleAnswers(\n          exercice,\n          i,\n          {\n            reponse: {\n              value: String(reponse),\n              // compare: powerCompare\n              compare: fonctionComparaison,\n              options: { puissance: true },\n            },\n          },\n          params,\n        )\n    }\n  }\n\n  if (exercice.autoCorrection[i] === undefined) {\n    exercice.autoCorrection[i] = {}\n  }\n  if (exercice.autoCorrection[i].reponse === undefined) {\n    exercice.autoCorrection[i].reponse = {}\n  }\n  const rep = exercice.autoCorrection[i].reponse\n  if (rep != null) {\n    rep.param = params\n    rep.valeur = reponses as ValeurNormalized\n  }\n}\n\n// La solution est-elle un nombre ? Si oui, on force l'option nombreDecimalSeulement.\nfunction isValidNumber(value: any): boolean {\n  // Convertir la valeur en chane et remplacer les sparateurs de milliers (par exemple, '{,}')\n  const cleanedValue = String(value)\n    .replace(/{,}/g, '') // Enlve les caractres '{,}' (sparateurs de milliers comme dans \"1{,}5\")\n    .replace(',', '.') // Remplace la virgule par un point pour les dcimales\n  // Vrifier que la chane ne contient que des chiffres et un seul sparateur dcimal (point ou virgule)\n  // Ou un nombre javascript crit dans tous les formats supports\n  // const validNumberPattern = /^[+-]?(\\d*(\\.\\d*)?([eE][+-]?\\d*)?|0[xX][0-9a-fA-F]*|0[bB][01]*)$/\n  const validNumberPattern = /^[+-]?\\d+(.\\d+)?$/\n\n  // Vrifier si la chane nettoye correspond  un nombre valide\n  return validNumberPattern.test(cleanedValue)\n}\n\nfunction handleDefaultValeur(reponse: Valeur): ValeurNormalized {\n  for (const [, val] of Object.entries(reponse)) {\n    if (val !== undefined) {\n      if (val?.value !== undefined) {\n        if (Array.isArray(val.value)) {\n          for (let i = 0; i < val.value.length; i++) {\n            if (typeof val.value[i] === 'string') continue\n            if (\n              val.value[i] instanceof Decimal ||\n              val.value[i] instanceof Grandeur ||\n              val.value[i] instanceof Hms ||\n              typeof val.value[i] === 'number'\n            ) {\n              val.value[i] = val.value[i].toString()\n            }\n            if (val.value[i] instanceof FractionEtendue)\n              val.value[i] = val.value[i].texFraction\n          }\n        } else {\n          if (typeof val.value === 'string') continue\n          if (\n            val.value instanceof Decimal ||\n            val.value instanceof Grandeur ||\n            val.value instanceof Hms ||\n            typeof val.value === 'number'\n          ) {\n            val.value = val.value.toString()\n          }\n          if (val.value instanceof FractionEtendue)\n            val.value = val.value.texFraction\n        }\n      }\n\n      if (val.compare === undefined) val.compare = fonctionComparaison\n      if (val.options === undefined || Object.keys(val.options).length === 0) {\n        let reponseAttendueEstUnNombre: boolean\n        if (Array.isArray(val.value)) {\n          reponseAttendueEstUnNombre = true\n          for (let ee = 0; ee < val.value.length; ee++) {\n            reponseAttendueEstUnNombre &&= isValidNumber(val.value[ee])\n          }\n        } else {\n          reponseAttendueEstUnNombre = isValidNumber(val.value)\n        }\n        const options = reponseAttendueEstUnNombre\n          ? { nombreDecimalSeulement: true }\n          : {}\n        val.options = options\n      }\n    }\n  }\n  return reponse as ValeurNormalized // La normalisation consiste  transformer toute value en string et c'est fait maintenant par cette fonction\n}\n\n/**\n * La fonction  privilgier  partir de maintenant.\n * @param {Exercice} exercice\n * @param {number} question\n * @param {AnswerType} reponses\n * @param {ReponseParams} params\n */\nexport function handleAnswers(\n  exercice: Exercice,\n  question: number,\n  reponses: Valeur,\n  params: ReponseParams | undefined = {},\n) {\n  if (context.isAmc) {\n    // handleAnswer ne s'occupe pas de l'export AMC\n    return\n  }\n  let formatInteractif =\n    params?.formatInteractif ??\n    exercice.autoCorrection[question]?.reponse?.param?.formatInteractif ??\n    'mathlive'\n  if (exercice.autoCorrection == null) exercice.autoCorrection = []\n  if (!(reponses instanceof Object)) {\n    window.notify(`handleAnswer() reponses doit tre un objet : ${reponses}`, {\n      reponses,\n      exercice: exercice.uuid,\n    })\n  }\n\n  if (exercice.autoCorrection[question] === undefined) {\n    exercice.autoCorrection[question] = {}\n  }\n  if (exercice.autoCorrection[question].reponse === undefined) {\n    exercice.autoCorrection[question].reponse = {}\n  }\n  const rep = exercice.autoCorrection[question].reponse\n  if (rep != null) {\n    rep.param = params ?? { formatInteractif }\n    if (formatInteractif === undefined) formatInteractif = 'mathlive'\n    rep.param.formatInteractif = formatInteractif\n    rep.valeur = handleDefaultValeur(reponses)\n  }\n  const url = new URL(window.location.href)\n\n  if (url.hostname === 'localhost' && url.searchParams.has('triche')) {\n    console.info(\n      `Rponses de l'exercice ${(exercice.numeroExercice ?? 0) + 1} - question ${question + 1} : `,\n      rep.valeur,\n    )\n  }\n}\n","/**\n * Afficher un cran (lment <dialog>) pendant un nombre de millisecondes\n * @param {string} dialogId id de l'lment <dialog>  activer\n * @param {number} nbOfMilliseconds dure de l'affichage en ms\n */\nexport async function showDialogForLimitedTime(\n  dialogId: string,\n  nbOfMilliseconds: number,\n  innerHTML = '',\n) {\n  const dialog = document.getElementById(dialogId) as HTMLDialogElement\n  if (dialog) {\n    if (innerHTML !== '') dialog.innerHTML = innerHTML\n    dialog.showModal()\n    await sleep(nbOfMilliseconds)\n    dialog.close()\n  }\n}\n\n/**\n * Faire une pause pendant l'excution d'un programme\n * {@link https://stackoverflow.com/questions/951021/what-is-the-javascript-version-of-sleep?page=1&tab=scoredesc#tab-top | Source}\n * @param {number} ms nb de millisecondes de la pause\n * @author sylvain\n */\nconst sleep = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms))\n\n/**\n * popup pour demander  l'utilisateur de rafrachir la page\n * car le serveur a t mis  jour.\n */\nexport function showPopupAndWait(): Promise<void> {\n  return new Promise((resolve) => {\n    const popup = document.createElement('div')\n    popup.style.position = 'fixed'\n    popup.style.top = '50%'\n    popup.style.left = '50%'\n    popup.style.transform = 'translate(-50%, -50%)'\n    popup.style.padding = '20px'\n    popup.style.backgroundColor = 'white'\n    popup.style.border = '1px solid black'\n    popup.style.zIndex = '10000'\n\n    const message = document.createElement('p')\n    message.textContent =\n      'Le serveur a t mis  jour. Veuillez actualiser la page.'\n    popup.appendChild(message)\n\n    const refreshButton = document.createElement('button')\n    refreshButton.textContent = 'Actualiser'\n    refreshButton.style.marginRight = '10px'\n    refreshButton.style.padding = '10px 20px'\n    refreshButton.style.backgroundColor = '#f0f0f0'\n    refreshButton.style.border = '1px solid #ccc'\n    refreshButton.style.borderRadius = '5px'\n    refreshButton.style.cursor = 'pointer'\n    refreshButton.onclick = () => {\n      window.location.reload()\n    }\n    popup.appendChild(refreshButton)\n\n    const closeButton = document.createElement('button')\n    closeButton.textContent = 'Fermer'\n    closeButton.style.marginRight = '10px'\n    closeButton.style.padding = '10px 20px'\n    closeButton.style.backgroundColor = '#f0f0f0'\n    closeButton.style.border = '1px solid #ccc'\n    closeButton.style.borderRadius = '5px'\n    closeButton.style.cursor = 'pointer'\n    closeButton.onclick = () => {\n      document.body.removeChild(popup)\n      resolve()\n    }\n    popup.appendChild(closeButton)\n    document.body.appendChild(popup)\n  })\n}\n","import type TypeExercice from '../exercices/Exercice'\n\nwindow.logDebug = window.logDebug || 0\n\nconst url = new URL(window.location.href)\nconst debug =\n  url.searchParams.get('log') === '3' || window.logDebug !== 0 ? 1 : 0\n\nexport function log(message?: any, ...optionalParams: any[]) {\n  if (debug) {\n    console.info(message, ...optionalParams)\n  }\n}\n\nexport function logDebug(message?: any, ...optionalParams: any[]) {\n  if (debug > 1 || window.logDebug > 1)\n    log('DEBUG:', message, ...optionalParams)\n}\n\nexport function statsTracker(\n  exercise: TypeExercice,\n  recorder: string,\n  vue: string,\n) {\n  logDebug('Tracking stats...')\n  if (window._paq) {\n    window._paq.push([\n      'trackEvent',\n      'CheckExo',\n      vue + '-' + exercise.uuid + (recorder ? '-' + recorder : ''),\n    ])\n  }\n  log(vue + '-' + exercise.uuid, 'CheckExo', recorder ? '-' + recorder : '')\n}\n\nlet oldUrl = ''\n\nexport function statsPageTracker() {\n  logDebug('Tracking pages...')\n  // Informer Matomo\n  if (window.location.href !== oldUrl) {\n    if (window._paq)\n      window._paq.push([\n        'trackEvent',\n        'PageTracking',\n        'VisitedURL',\n        window.location.href,\n      ])\n    oldUrl = window.location.href\n    log('statsPageTracker called with URL:', window.location.href)\n  }\n}\n\n/*\n// Exemple\nconst list1 = ['A', 'B', 'B', 'C', 'C', 'D']\nconst list2 = ['A', 'A', 'D', 'C', 'D', 'D', 'B']\n\nconsole.log(getIntrus(list1, list2))\n Rsultat :\njs\nCopier\nModifier\n[\n  { value: 'A', difference: -1 }, // 1 de trop dans list2\n  { value: 'B', difference: 0 },  // OK\n  { value: 'C', difference: 1 },  // 1 de trop dans list1\n  { value: 'D', difference: -2 }  // 2 de trop dans list2\n]\n  */\n\nexport function getIntrus(list1: string[], list2: string[]) {\n  interface CountMap {\n    [key: string]: number\n  }\n\n  const count = (arr: string[]): CountMap =>\n    arr.reduce((acc: CountMap, val: string) => {\n      acc[val] = (acc[val] || 0) + 1\n      return acc\n    }, {})\n\n  const count1 = count(list1)\n  const count2 = count(list2)\n\n  const allKeys = new Set([...Object.keys(count1), ...Object.keys(count2)])\n  const intrus = []\n\n  for (const key of allKeys) {\n    const diff = (count1[key] || 0) - (count2[key] || 0)\n    if (diff !== 0) {\n      intrus.push({ value: key, difference: diff })\n    }\n  }\n\n  return intrus\n}\n","import type { CanOptions, CanSolutionsMode } from './types/can'\nimport type { Language } from './types/languages'\n\n/*\nCode inspir de Sylvain, merci!\nhttps://stackoverflow.com/questions/55020193/is-it-possible-to-create-a-typescript-type-from-an-array\n*/\nconst VueTypeArray = <const>[\n  'alacarte',\n  'diaporama',\n  'can',\n  'eleve',\n  'latex',\n  'pdf',\n  'confeleve',\n  'amc',\n  'anki',\n  'moodle',\n  'evaluation',\n  'correction',\n  'l',\n  'l2',\n  'overview',\n  'myriade',\n  'indices',\n  '',\n]\ntype VueTypeArrayType = typeof VueTypeArray\nexport type VueType = VueTypeArrayType[number] // equiv to diaporama' | 'can' | 'eleve' | 'latex' | 'confeleve' | 'amc' | 'anki' | 'moodle' | 'l' | 'l2' | 'overview'\n\n// export type VueType = 'diaporama' | 'can' | 'eleve' | 'latex' | 'confeleve' | 'amc' | 'anki' | 'moodle' | 'l' | 'l2' | 'overview'\n\nexport const convertVueType = (type: string): VueType | undefined => {\n  return VueTypeArray.indexOf(type as VueType) < 0\n    ? undefined\n    : VueTypeArray[VueTypeArray.indexOf(type as VueType)]\n}\n\n/**\n * setInteractive  0 on enlve tout,  1 on les met tous en interactif,  2 on ne change rien\n * iframe est un identifiant de l'iframe utilis par des recorders comme Moodle\n */\nexport interface InterfaceGlobalOptions {\n  v?: VueType\n  z?: string\n  durationGlobal?: number\n  ds?: string\n  nbVues?: 1 | 2 | 3 | 4\n  flow?: 0 | 1 | 2 // 0: Q->Q, 1: Q->R->Q, 2: Q->(Q+R)->Q\n  screenBetweenSlides?: boolean\n  pauseAfterEachQuestion?: boolean\n  sound?: 0 | 1 | 2 | 3 | 4\n  isImagesOnSides?: boolean\n  shuffle?: boolean\n  select?: number[]\n  order?: number[]\n  manualMode?: boolean\n  es?: string\n  title?: string\n  presMode?:\n    | 'liste_exos'\n    | 'un_exo_par_page'\n    | 'une_question_par_page'\n    | 'recto'\n    | 'verso'\n  // | 'cartes'\n  setInteractive?: string\n  isSolutionAccessible?: boolean\n  isTitleDisplayed?: boolean\n  isInteractiveFree?: boolean\n  oneShot?: boolean\n  recorder?: 'capytale' | 'labomep' | 'moodle' | 'anki'\n  done?: '1'\n  answers?: string\n  iframe?: string\n  twoColumns?: boolean\n  beta?: boolean\n  isDataRandom?: boolean\n  canD?: string\n  canT?: string\n  canSA?: boolean\n  canSM?: CanSolutionsMode\n  canI?: boolean\n  lang?: Language\n}\n\nexport interface InterfaceParams\n  extends Partial<Record<string, string | number>> {\n  uuid: string\n  id?: string\n  alea?: string\n  interactif?: '0' | '1'\n  cd?: '0' | '1'\n  sup?: string\n  sup2?: string\n  sup3?: string\n  sup4?: string\n  sup5?: string\n  versionQcm?: '0' | '1' // pour la version QCM des exercices de type simple\n  nbQuestions?: number\n  duration?: number\n  cols?: number\n  type?: 'mathalea' | 'static' | 'app'\n  bestScore?: number\n}\n\nexport interface InterfaceReferentiel {\n  uuid: string\n  id: string\n  url: string\n  titre: string\n  tags: { interactif: boolean; interactifType: string; amc: boolean }\n  datePublication?: string\n  dateModification?: string\n  annee?: string\n}\n\nexport interface InterfaceResultExercice {\n  numberOfPoints: number\n  numberOfQuestions: number\n  uuid?: string\n  title?: string\n  alea?: string\n  answers?: { [key: string]: string }\n  indice?: number\n  state?: 'done'\n  type?: 'mathalea' | 'static' | 'app'\n  bestScore?: number\n  duration?: number\n  resultsByQuestion?: boolean[]\n}\n\n// Pour Capytale\nexport interface Activity {\n  globalOptions: InterfaceGlobalOptions\n  exercicesParams: InterfaceParams[]\n  canOptions: CanOptions\n}\n\nexport interface StudentAssignment {\n  resultsByExercice: InterfaceResultExercice[]\n}\n\n// Pour les listes d'entres de rfrentiel dans le side menu\n// * `title` : titre affich dans le menu\n// * `content` : le rfrentiel lui-mme\n// * `type` : type du rfrentiel pour grer l'affichage (exploration rcursive ou pas par exemple)\n// * `activated`: flag pour afficher ou pas le rfrentiel\nexport type ReferentielTypes =\n  | 'outils'\n  | 'exercices'\n  | 'ressources'\n  | 'bibliotheque'\n  | 'apps'\n  | 'examens'\nexport type ReferentielNames =\n  | 'outils'\n  | 'aleatoires'\n  | 'statiques'\n  | 'ressources'\n  | 'bibliotheque'\n  | 'apps'\n  | 'examens'\n  | 'geometrieDynamique'\nexport type ReferentielForList = {\n  name: ReferentielNames\n  title: string\n  content: InterfaceReferentiel[]\n  type: ReferentielTypes\n  activated: boolean\n}\n\n// Pour les exercices statiques de la bibliotheque\nexport interface bibliothequeExercise {\n  uuid: string\n  url: string\n  png: string\n  pngCor: string\n}\n\n// Pour les couleurs utilises dans le site\n// chanes de caractres possible  ajouter aprs <text|fill|bg|border|...>-coopmaths- ou <text|fill|bg|border|...>-coopmathsdark-\nexport type CoopmathsColor =\n  | 'canvas'\n  | 'canvas-light'\n  | 'canvas`lightest'\n  | 'canvas-dark'\n  | 'canvas-darkest'\n  | 'warn'\n  | 'warn-light'\n  | 'warn-lightest'\n  | 'warn-dark'\n  | 'warn-darkest'\n  | 'corpus'\n  | 'corpus-light'\n  | 'corpus-lightest'\n  | 'corpus-dark'\n  | 'corpus-darkest'\n  | 'struct'\n  | 'struct-ligh'\n  | 'struct-lightest'\n  | 'struct-dark'\n  | 'struct-darkest'\n\n// type pour une fonction qui n'admet pas d'argument et de retourne rien\nexport type Action = () => void\n\n// type pour un intervalle de nombres\n// usage : const myNumber: NumericRange<0, 100> = 3 (par de valeur possible infrieure  0 et suprieure  100)\n// source: https://github.com/microsoft/TypeScript/issues/43505#issuecomment-1686128430\nexport type NumericRange<\n  start extends number,\n  end extends number,\n  arr extends unknown[] = [],\n  acc extends number = never,\n> = arr['length'] extends end\n  ? acc | start | end\n  : NumericRange<\n      start,\n      end,\n      [...arr, 1],\n      arr[start] extends undefined ? acc : acc | arr['length']\n    >\n// autre type pour intervalle de nombre\n// source : https://github.com/type-challenges/type-challenges/issues/9230\nexport type NumberRange<\n  L extends number,\n  H extends number,\n  Out extends number[] = [],\n  Flag extends boolean = false,\n> = Out['length'] extends L\n  ? NumberRange<L, H, [...Out, L], true>\n  : Flag extends true\n    ? Out['length'] extends H\n      ? [...Out, Out['length']][number]\n      : NumberRange<L, H, [...Out, Out['length']], Flag>\n    : NumberRange<L, H, [...Out, never], Flag>\n// type pour les chips des exercices\nexport type ChipContentType = { ref: string; title: string; key: string }\n\n// type pour les filtres affichs\nexport type DisplayedFilterContent<T> = {\n  title: string\n  values: T[]\n  isSelected: boolean\n  clicked: number\n}\nexport type DisplayedFilter<T> = Record<string, DisplayedFilterContent<T>>\nexport type FilterType = 'levels' | 'specs' | 'types'\nexport type FilterObject<T> = {\n  type: FilterType\n  key: string\n  content: DisplayedFilterContent<T>\n}\n\nexport type FilterSectionNameType = { [key in FilterType]: string }\nexport const FILTER_SECTIONS_TITLES: FilterSectionNameType = {\n  levels: 'Niveaux',\n  specs: 'Fonctionnalits',\n  types: 'Types',\n}\n\nexport type InteractivityType =\n  | 'qcm'\n  | 'mathlive'\n  | 'fillInTheBlank'\n  | 'tableauMathlive'\n  | 'texte'\n  | 'cliqueFigure'\n  | 'dnd'\n  | 'listeDeroulante'\n  | 'custom'\n\nexport type TableauMathliveType = 'doubleEntree' | 'proportionnalite'\n","import { writable } from 'svelte/store'\nimport type { CanOptions } from '../types/can'\nexport const canOptions = writable<CanOptions>({\n  durationInMinutes: 4,\n  subTitle: new Date().getFullYear().toString(),\n  isChoosen: false,\n  solutionsAccess: false,\n  solutionsMode: 'gathered',\n  isInteractive: false,\n  remainingTimeInSeconds: 0,\n  questionGetAnswer: [],\n  state: 'start',\n})\n","import { get } from 'svelte/store'\nimport { type InterfaceGlobalOptions, type VueType } from '../../lib/types'\nimport { canOptions } from '../stores/canStore'\nimport { exercicesParams, globalOptions } from '../stores/generalStore'\n\nexport class MathAleaURL extends URL {\n  /**\n   * Utilise l'URL courante pour fabriquer l'URL lors de l' appel new MathAleaURL()\n   */\n  constructor(url?: string) {\n    if (url === undefined) {\n      url = document.URL\n    }\n    super(url)\n  }\n\n  /**\n   * Utilise le store exercicesParams pour fabriquer l'URL (utile pour les recorders qui freezent l'url)\n   */\n  static fromExercisesParams(): MathAleaURL {\n    const url = new URL(\n      window.location.protocol +\n        '//' +\n        window.location.host +\n        window.location.pathname,\n    )\n    const params = get(exercicesParams)\n    for (const ex of params) {\n      url.searchParams.append('uuid', ex.uuid)\n      if (ex.id != null) url.searchParams.append('id', ex.id)\n      if (ex.nbQuestions !== undefined)\n        url.searchParams.append('n', ex.nbQuestions.toString())\n      if (ex.duration != null)\n        url.searchParams.append('d', ex.duration.toString())\n      if (ex.sup != null) url.searchParams.append('s', ex.sup)\n      if (ex.sup2 != null) url.searchParams.append('s2', ex.sup2)\n      if (ex.sup3 != null) url.searchParams.append('s3', ex.sup3)\n      if (ex.sup4 != null) url.searchParams.append('s4', ex.sup4)\n      if (ex.sup5 != null) url.searchParams.append('s5', ex.sup5)\n      if (ex.versionQcm != null) url.searchParams.append('qcm', ex.versionQcm)\n      if (ex.alea != null) url.searchParams.append('alea', ex.alea)\n      if (ex.interactif === '1') url.searchParams.append('i', '1')\n      if (ex.cd != null) url.searchParams.append('cd', ex.cd)\n      if (ex.cols != null) url.searchParams.append('cols', ex.cols.toString())\n    }\n    return new MathAleaURL(url.toString())\n  }\n\n  /**\n   * Retire de l'URL le paramtre fourni et retourne l'URL modifie\n   * @param paramToBeRemoved paramtre  supprimer dans l'URL (seulement les proprits de InterfaceGlobalOptions sont permises )\n   * @returns l'URL\n   */\n  removeParam(paramToBeRemoved: keyof InterfaceGlobalOptions): MathAleaURL {\n    this.searchParams.delete(paramToBeRemoved)\n    return this\n  }\n\n  /**\n   * Ajoute un paramtre avec sa valeur  l'URL et retourne l'URL modifie\n   * @param param paramtre  ajouter (seulement les proprits de InterfaceGlobalOptions sont permises)\n   * @param value valeur du paramtre\n   * @returns l'URL\n   */\n  addParam(param: keyof InterfaceGlobalOptions, value: string): MathAleaURL {\n    this.searchParams.append(param, value)\n    return this\n  }\n\n  /**\n   * Supprime la graine de l'alatoire de l'URL et retourne l'URL modifie\n   */\n  removeSeed(): MathAleaURL {\n    this.searchParams.delete('alea')\n    return this\n  }\n\n  /**\n   * Ajoute (ou remplace) un paramtre avec sa valeur  l'URL et retourne l'URL modifie\n   * @param param paramtre  ajouter (seulement les proprits de InterfaceGlobalOptions sont permises)\n   * @param value valeur du paramtre\n   * @returns l'URL\n   */\n  setParam(param: keyof InterfaceGlobalOptions, value: string): MathAleaURL {\n    this.searchParams.set(param, value)\n    return this\n  }\n\n  /**\n   * Ajoute/remplace une vue cible  l'URL et retourne cette URL\n   * @param value la vue cible\n   * @returns l'URL\n   */\n  setVue(value: VueType): MathAleaURL {\n    this.setParam('v', value)\n    return this\n  }\n}\n\n/**\n * Construit l'URL pour la feuille lve en mettant tous les paramtres existants et ceux des rglages de la page de configuration\n * @param view la vue dans laquelle va s'afficher la srie d'exercice\n * @param mode le mode de prsentation des exercices\n * @returns l'URL correspondant  la feuille d'exercices avec tous les paramtres\n */\nexport function buildMathAleaURL(options: {\n  view?: VueType\n  mode?: InterfaceGlobalOptions['presMode']\n  isEncrypted?: boolean\n  isShort?: boolean\n  removeSeed?: boolean\n  /** S'il y a un recorder l'url est cache et doit tre construite  partir du store exercicesParams */\n  recorder?: 'Moodle'\n}): URL {\n  const url = options.recorder\n    ? MathAleaURL.fromExercisesParams()\n    : new MathAleaURL()\n  if (options.removeSeed) {\n    url.removeSeed()\n  }\n  const global = get(globalOptions)\n  const can = get(canOptions)\n  if (options.view)\n    url.setVue(options.view).addParam('es', buildEsParams(options.mode))\n  if (options.view === 'can') {\n    // paramtres spcifiques  la can dans l'URL\n    url\n      .addParam('canD', (can.durationInMinutes ?? 1).toString())\n      .addParam('canT', can.subTitle.toString())\n      .addParam('canSA', can.solutionsAccess ? '1' : '0')\n      .addParam('canSM', can.solutionsMode)\n      .addParam('canI', can.isInteractive ? '1' : '0')\n  } else if (options.view === 'diaporama') {\n    url.addParam('ds', buildDsParams())\n    if (\n      global.select !== undefined &&\n      global.select !== undefined &&\n      global.select.length > 0 &&\n      global.select.length < get(exercicesParams).length\n    ) {\n      url.addParam('select', global.select.join('-'))\n    }\n    if (\n      global.order !== undefined &&\n      global.order.length > 0 &&\n      global.shuffle\n    ) {\n      url.addParam('order', global.order.join('-'))\n    }\n  } else {\n    const title = global.title ?? 'valuation'\n    if (title !== '') {\n      url.addParam('title', title)\n    }\n  }\n  if (global.beta) {\n    url.addParam('beta', '1')\n  }\n  const cryptedUrl = options.isEncrypted\n    ? encrypt(url.toString())\n    : url.toString()\n  return new URL(cryptedUrl)\n}\n\n/**\n * Construit la chane reprsentant les rglages de la vue lve/can\n * @param mode mode de prsentation\n * @returns la chane de 6 chiffres reprsentant le setup\n */\nexport function buildEsParams(\n  mode?: InterfaceGlobalOptions['presMode'],\n): string {\n  const options = get(globalOptions)\n  const presentationMode = new Map([\n    // sync with src/lib/stores/generalStore.ts presModeId\n    ['liste_exos', 0],\n    ['un_exo_par_page', 1],\n    ['liste_exos', 2],\n    ['une_question_par_page', 3],\n    ['recto', 4],\n    ['verso', 5],\n  ])\n  let es = ''\n  // Paramtre 'es' : presMode|setInteractive|isSolutionAccessible|isInteractiveFree|oneShot|twoColumns|isTitleDisplayed\n  es += presentationMode.get(\n    mode !== undefined ? mode : (options.presMode ?? 'liste_exos'),\n  )\n  es += options.setInteractive ?? '2'\n  es += options.isSolutionAccessible ? '1' : '0'\n  es += options.isInteractiveFree ? '1' : '0'\n  es += options.oneShot ? '1' : '0'\n  es += options.twoColumns ? '1' : '0'\n  es += options.isTitleDisplayed ? '1' : '0'\n  return es\n}\n\nexport function buildDsParams(): string {\n  let ds = ''\n  const options = get(globalOptions)\n  ds += options.nbVues?.toString() ?? '1'\n  ds += options.flow?.toString() ?? '0'\n  ds += options.screenBetweenSlides ? '1' : '0'\n  ds += options.sound?.toString() ?? '0'\n  ds += options.shuffle ? '1' : '0'\n  ds += options.manualMode ? '1' : '0'\n  ds += options.pauseAfterEachQuestion ? '1' : '0'\n  ds += options.isImagesOnSides ? '1' : '0'\n  return ds\n}\n\nexport async function getShortenedCurrentUrl(\n  addendum: string = '',\n): Promise<string> {\n  const urlObj = new URL(window.location.href)\n  const port = urlObj.port\n  const baseUrl = port ? 'https://coopmaths.fr/alea' : document.URL\n  const url = `${baseUrl}${addendum}`\n\n  try {\n    const response = await fetch(\n      `https://api.shrtco.de/v2/shorten?url=${encodeURIComponent(url)}`,\n    )\n    if (!response.ok) {\n      throw new Error('Network response was not ok.')\n    }\n    const jsonResponse = await response.json()\n    return jsonResponse.result.full_short_link\n  } catch (error) {\n    window.notify(\"Impossible de raccourcir l'url\", { error })\n    return url\n  }\n}\n\n/**\n * Encrypte la partie de l'URL aprs le point d'interrogation '?'\n * Principe : on ajoute 'EEEE' aprs le '?' pour reconnatre une URL encrypte\n * par la suite et on encode le reste de l'URL en suivant l'algorithme montr\n * [ici](https://stackoverflow.com/questions/67855828/encrypt-and-decrypt-a-string-using-simple-javascript-without-using-any-external)...\n * @param {string} url URL a encrypter\n * @returns {URL} URL encrypte\n * @author sylvain\n */\nexport function encrypt(url: string): string {\n  const urlParts = url.split('?')\n  let newUrl = urlParts[0] + '?EEEE'\n  let char, nextChar, combinedCharCode\n  let partEncrypted = ''\n  const partToEncrypt = encodeURI(urlParts[1])\n  for (let i = 0; i < partToEncrypt.length; i += 2) {\n    char = partToEncrypt.charCodeAt(i)\n    if (i + 1 < partToEncrypt.length) {\n      nextChar = partToEncrypt.charCodeAt(i + 1) - 31\n      combinedCharCode =\n        char +\n        '' +\n        nextChar.toLocaleString('fr-FR', { minimumIntegerDigits: 2 })\n      partEncrypted += String.fromCharCode(parseInt(combinedCharCode, 10))\n    } else {\n      partEncrypted += partToEncrypt.charAt(i)\n    }\n  }\n  const hexPartEncrypted = partEncrypted.split('').reduce((hex, c) => {\n    hex += c.charCodeAt(0).toString(16).padStart(4, '0')\n    return hex\n  }, '')\n  newUrl += hexPartEncrypted\n  return newUrl\n}\n\n/**\n * Dcrypte _si besoin_ une URL sur la base du cryptage prcdent\n * @param {URL} url URL  dcrypter\n * @returns {URL} URL dcrypte\n * @author sylvain\n */\nexport function decrypt(url: URL): URL {\n  const oldUrl = url.href\n  const part1 = oldUrl.slice(0, oldUrl.indexOf('?'))\n  const part2withEEEE = oldUrl.replace(part1 + '?', '')\n  let newUrl = ''\n  if (part2withEEEE.substring(0, 4) !== 'EEEE') {\n    newUrl = url.toString()\n  } else {\n    let char, codeStr, firstCharCode, lastCharCode\n    let decryptedPart = ''\n    newUrl = part1 + '?'\n    let part2 = part2withEEEE.slice(4, part2withEEEE.length) // on enlve les `EEEE`\n    const matches = part2.match(/.{1,4}/g)\n    if (matches !== null) {\n      part2 = matches.reduce(\n        (acc, char) => acc + String.fromCharCode(parseInt(char, 16)),\n        '',\n      )\n    }\n\n    for (let i = 0; i < part2.length; i++) {\n      char = part2.charCodeAt(i)\n      if (char > 132) {\n        codeStr = char.toString(10)\n        firstCharCode = parseInt(codeStr.substring(0, codeStr.length - 2), 10)\n        lastCharCode =\n          parseInt(codeStr.substring(codeStr.length - 2, codeStr.length), 10) +\n          31\n        decryptedPart +=\n          String.fromCharCode(firstCharCode) + String.fromCharCode(lastCharCode)\n      } else {\n        decryptedPart += part2.charAt(i)\n      }\n    }\n    newUrl += decryptedPart\n  }\n  return new URL(newUrl)\n}\n\n/**\n * Dtecte si une URL a t encrypte par `encrypt`\n * @param {URL} url Chane representant l'URL  analyser\n * @returns {boolean} `true` si l'URL est crypt avec la fonction `encrypt`\n */\nexport function isCrypted(url: URL): boolean {\n  return url.href.includes('?EEEE')\n}\n\n/**\n * Tlcharger un fichier connaissant l'URL\n *\n * __Exemple__\n * ```tsx\n * downloadFileFromURL(url, 'image.jpg');\n * ```\n *\n * __Paramtres__\n * @param {string} url URL du fichier  tlcharger\n * @param {string} filename nom don au fichier tlcharg\n * @see {@link https://blog.gitnux.com/code/javascript-download-file-from-url/}\n */\nexport async function downloadFileFromURL(url: string, filename: string) {\n  try {\n    // Fetch the file\n    const response = await fetch(url)\n    // Check if the request was successful\n    if (response.status !== 200) {\n      throw new Error(\n        `Unable to download file. HTTP status: ${response.status}`,\n      )\n    }\n\n    // Get the Blob data\n    const blob = await response.blob()\n\n    // Create a download link\n    const downloadLink = document.createElement('a')\n    downloadLink.href = URL.createObjectURL(blob)\n    downloadLink.download = filename\n\n    // Trigger the download\n    document.body.appendChild(downloadLink)\n    downloadLink.click()\n\n    // Clean up\n    setTimeout(() => {\n      URL.revokeObjectURL(downloadLink.href)\n      document.body.removeChild(downloadLink)\n    }, 100)\n  } catch (error: unknown) {\n    if (error instanceof Error) {\n      console.error('Error downloading the file:', error.message)\n    }\n  }\n}\n","import type { FrenchDateString } from './dates'\nimport codeList from '../../json/codeToLevelList.json'\nimport referentielsActivationList from '../../json/referentielsActivation.json'\n// ===========================================================================\n//\n//    Types des bouts de chanes des rfrentiels (les donnes des exercices)\n//\n// ===========================================================================\nexport const EXAMS = ['dnb', 'dnbpro', 'bac', 'crpe', 'e3c', 'evacom']\nexport type Level = keyof typeof codeList | 'alea'\nexport type ActivationName = keyof typeof referentielsActivationList\n/**\n * Paramtres d'une fonctionnalit\n * @interface FeatureParams\n * @property {string} type : mot cl dcrivant le type de l'interactivit\n * @property {boolean} isActive : flag pour savoir si la fonctionnalit est active ou pas\n */\nexport interface FeatureParams {\n  type: string\n  isActive: boolean\n}\n\n/**\n * Fonctionnalits supplmentaires d'un exercice.\n * @remark **Au 2024-11-03, ces fonctionnalits sont au nombre de trois seulement**\n * @interface Features\n * @property {FeatureParams} interactif : interactivit dans l'exercice\n * @property {FeatureParams} amc : possibilit d'exportation pour utilisation dans AMC\n * @property {FeatureParams} qcm : possibilit d'exportation pour utilisation dans AMC\n */\nexport interface Features {\n  interactif?: FeatureParams\n  amc?: FeatureParams\n  qcm?: FeatureParams\n  qcmcam?: FeatureParams\n}\n\n/**\n * Description d'une application tierce\n * @interface AppTierce\n * @property {string} uuid : identifiant unique gnr dfinitivement par le moteur  la cration de l'exercice\n * @property {tring} title : titre de l'application\n * @property {string} presentation : texte bref expliquant les intentions de l'application\n * @property {string} imgPath : chemin vers le fichier image dans l'arborescence\n */\nexport interface AppTierce {\n  uuid: string\n  title: string\n  presentation: string\n  imgPath: string\n}\n\n/**\n * Groupe d'applications tierces lies par une provenance\n * @interface AppTierceGroup\n * @property {string} rubrique : titre de la rubrique sous laquelle sont regroupes les applications\n * @property {AppTierce[]} liste : liste des applications dans le groupe\n */\nexport interface AppTierceGroup {\n  rubrique: string\n  liste: AppTierce[]\n}\n\n/**\n * Tous les type de ressources disponibles dans un rfrentiel\n */\nexport type ExerciseType =\n  | 'alea'\n  | 'dnb'\n  | 'dnbpro'\n  | 'crpe'\n  | 'bac'\n  | 'simple'\n  | 'html'\n  | 'svelte'\n  | 'e3c'\n  | 'evacom'\n  | 'outil'\n  | 'tierce'\n  | 'static'\n\n/**\n * Description d'un objet de base dans un reerentiel de ressources\n * @interface BaseItemInReferentiel\n * @property {string} uuid : identifiant unique gnr dfinitivement par le moteur  la cration de l'exercice\n * @property {string[]} tags : listes de toutes les tiquettes marquant les sujets couverts par la ressource\n * @property {ExerciseType} typeExercice : catgorie de la ressource\n */\nexport interface BaseItemInReferentiel {\n  uuid: string\n  tags: string[]\n  typeExercice: ExerciseType\n}\n\n/**\n * Description d'une ressource d'un exercice CRPE dans un rfrentiel\n * @interface crpeItemInreferentiel\n * @extends BaseItemInReferentiel\n * @property {string[]} png : liste des chemins vers les images des contenus de la ressource\n * @property {string[]} pngCor : liste des chemins vers les images des correction des contenus de la ressource\n * @property {string} tex: chemin vers le source LaTeX du contenu\n * @property {string} texCor: chemin vers le source LaTeX de la correction du contenu\n */\nexport interface crpeItemInreferentiel extends BaseItemInReferentiel {\n  png: string[]\n  pngCor: string[]\n  tex?: string\n  texCor?: string\n  annee: string\n  lieu: string\n  numeroInitial: string\n  typeExercice: 'crpe'\n}\n\n/**\n * Description d'une ressource statique dans un rfrentiel\n * @interface StaticItemInreferentiel\n * @extends BaseItemInReferentiel\n * @property {string[]} png : liste des chemins vers les images des contenus de la ressource\n * @property {string[]} pngCor : liste des chemins vers les images des correction des contenus de la ressource\n * @property {string} tex: chemin vers le source LaTeX du contenu\n * @property {string} texCor: chemin vers le source LaTeX de la correction du contenu\n */\nexport interface StaticItemInreferentiel extends BaseItemInReferentiel {\n  png: string\n  pngCor: string\n  tex: string\n  texCor: string\n  typeExercice: 'static' | 'dnb' | 'dnbpro' | 'bac' | 'e3c' | 'evacom'\n}\n\n/**\n * Description d'une ressource venant un examen dans un rfrentiel\n * @interface ExamItemInReferentiel\n * @extends StaticItemInreferentiel\n * @property {string|undefined} mois : mois de la publication de l'examen (optionnel)\n * @property {string} annee : anne de la publication de l'examen\n * @property {string} lieu : endroit o a t diffus l'examen\n * @property {string} numeroInitial : numrode positionnement de l'exercice dans le sujet initial de l'examen\n */\nexport interface ExamItemInReferentiel extends StaticItemInreferentiel {\n  mois?: string\n  annee: string\n  lieu: string\n  numeroInitial: string\n  jour?: 'J1' | 'J2'\n  typeExercice: 'dnb' | 'dnbpro' | 'bac'\n}\n\n/**\n * Description dans un rfrentiel d'un exercice MathALA typique\n * @interface ExerciceItemInReferentiel\n * @extends BaseItemInReferentiel\n * @property {string} url : chemin vers les sources javascript de l'exercice\n * @property {string} id : identifiant provenant du rfrentiel de classification des comptences (diffrent de `uuid`)\n * @property {Feature[]} features : liste des fonctionnalits supplmentaires de l'exercice (`interactif` et/ou `amc`)\n * @property {string} datePublication : date de la publication de l'exercice (optionnel)\n * @property {string} dateModification : date de la *dernire* modification de l'exercice (optionnel)\n */\nexport interface ExerciceItemInReferentiel extends BaseItemInReferentiel {\n  url: string\n  id: string\n  titre: string\n  features: Features\n  datePublication?: FrenchDateString\n  dateModification?: FrenchDateString\n  typeExercice: 'alea'\n}\n\nexport interface ToolItemInReferentiel extends BaseItemInReferentiel {\n  url: string\n  id: string\n  titre: string\n  typeExercice: 'outil' | 'html'\n}\n// ===========================================================================\n//\n//    Type pour les rfrentiels eux-mmes\n//\n// ===========================================================================\n\n/**\n * Type rcursif pour les rfrentiels eux-mmes : en rcuprant les JSON en import\n * on fabrique un objet dont le type est dfini ci-dessous. Les extrmits des imbrications\n * sont correspondent aux diffrents types de ressources dcrites ci-dessus.\n */\n// Type pour un objet situ en fin de rfrentiel\nexport type JSONReferentielEnding =\n  // | BaseItemInReferentiel  <-- pas de terminaison aussi basique\n  | StaticItemInreferentiel\n  | ExamItemInReferentiel\n  | ExerciceItemInReferentiel\n  | ToolItemInReferentiel\n// Type pour un rfrentiel complet\nexport interface JSONReferentielObject\n  extends Record<\n    string,\n    JSONReferentielEnding | JSONReferentielObject | string | string[] | Features\n  > {}\n// Type correspondant  une branche dstructure : chemin + terminaison (donnes de la ressource)\nexport type ResourceAndItsPath = {\n  resource: JSONReferentielEnding\n  pathToResource: string[]\n}\n// Type pour passer un rfrentiel au menu\nexport type ReferentielInMenu = {\n  title: string\n  name: ActivationName\n  searchable: boolean\n  referentiel: JSONReferentielObject\n}\n\n// ===========================================================================\n//\n//     Fonctions pour vrifier les types\n//\n// ===========================================================================\nexport const isExerciceItemInReferentiel = (\n  obj: any,\n): obj is ExerciceItemInReferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('uuid') &&\n  obj.uuid !== undefined &&\n  Object.keys(obj).includes('features') &&\n  obj.features !== undefined\n\nexport const isExamItemInReferentiel = (\n  obj: any,\n): obj is ExamItemInReferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('uuid') &&\n  obj.uuid !== undefined &&\n  Object.keys(obj).includes('annee') &&\n  obj.annee !== undefined\n\nexport const isJSONReferentielEnding = (\n  obj: any,\n): obj is JSONReferentielEnding =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('uuid') &&\n  obj.uuid !== undefined\n\nexport const isTool = (obj: any): obj is ToolItemInReferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('typeExercice') &&\n  (obj.typeExercice === 'outil' || obj.typeExercice === 'html')\n\nexport const resourceHasPlace = (\n  obj: any,\n): obj is ExamItemInReferentiel | crpeItemInreferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('lieu') &&\n  obj.lieu !== undefined\n\nexport const resourceHasMonth = (obj: any): obj is ExamItemInReferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('mois') &&\n  obj.mois !== undefined\n\nexport const isLevelType = (obj: any): obj is Level =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(codeList).includes(obj)\n\nexport const isFeatures = (obj: any): obj is Features => {\n  if (obj !== null && typeof obj !== 'undefined') {\n    return false\n  } else {\n    const keys = Object.keys(obj)\n    return keys.includes('interactif') || keys.includes('amc')\n  }\n}\n\n/**\n * Inspecte le type d'un objet et dtermine s'il c'est un tableau de chanes non vide ou pas\n * @see https://stackoverflow.com/a/50523378/6625987\n * @param value objet  examiner\n * @returns {boolean}\n */\nexport function isNonEmptyArrayOfStrings(value: unknown): value is string[] {\n  return (\n    Array.isArray(value) &&\n    value.length > 0 &&\n    value.every((item) => typeof item === 'string')\n  )\n}\n\nexport const isRealJSONReferentielObject = (obj: any): boolean => {\n  if (\n    typeof obj === 'string' ||\n    isNonEmptyArrayOfStrings(obj) ||\n    isFeatures(obj)\n  ) {\n    return false\n  } else {\n    return true\n  }\n}\n\nexport const isStaticType = (obj: any): obj is StaticItemInreferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('png') &&\n  obj.png !== undefined &&\n  !isNonEmptyArrayOfStrings(obj.png)\n\nexport const isCrpeType = (obj: any): obj is crpeItemInreferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  Object.keys(obj).includes('typeExercice') &&\n  obj.typeExercice !== undefined &&\n  obj.typeExercice === 'crpe'\n\nexport const isStaticWithoutPngUrl = (obj: any): obj is ExamItemInReferentiel =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  !Object.keys(obj).includes('png') &&\n  Object.keys(obj).includes('annee') &&\n  Object.keys(obj).includes('lieu') &&\n  Object.keys(obj).includes('typeExercice') &&\n  obj.annee !== undefined &&\n  obj.lieu !== undefined &&\n  (obj.typeExercice === 'sti2d' ||\n    obj.typeExercice === 'dnb' ||\n    obj.typeExercice === 'stl' ||\n    obj.typeExercice === 'dnbpro' ||\n    obj.typeExercice === 'eam' ||\n    obj.typeExercice === 'bac')\n\n/**\n * Dtecte si la terminaison d'un rfrentiel est un exercice de gomtrie dynamique ou pas.\n * On teste la prsence de la chaine `geodyn` en dbut d'url (si elle existe)\n * @param obj {JSONReferentielEnding} terminaison  tester\n * @returns `true` si la terminaison rfrence un exercice de gomtrie dynamique\n */\nexport const isGeoDynamic = (obj: JSONReferentielEnding): boolean => {\n  const geoDynRegExp = /^geodyn/\n  if (\n    obj !== null &&\n    typeof obj !== 'undefined' &&\n    Object.keys(obj).includes('url') &&\n    //  ce stade, on est sr que l'objet ne peu tpas tre de type StaticItemInreferentiel car il a la proprit `url`\n    (obj as Exclude<JSONReferentielEnding, StaticItemInreferentiel>).url !==\n      undefined &&\n    typeof (obj as Exclude<JSONReferentielEnding, StaticItemInreferentiel>)\n      .url === 'string' &&\n    (obj as Exclude<JSONReferentielEnding, StaticItemInreferentiel>).url.match(\n      geoDynRegExp,\n    ) !== null\n  ) {\n    return true\n  } else {\n    return false\n  }\n}\n","import { get, writable } from 'svelte/store'\nimport { statsPageTracker } from '../../modules/statsUtils'\nimport { buildDsParams } from '../components/urls'\nimport type {\n  InterfaceGlobalOptions,\n  InterfaceParams,\n  InterfaceResultExercice,\n  VueType,\n  bibliothequeExercise,\n} from '../types'\nimport { type JSONReferentielEnding } from '../types/referentiels'\nimport { canOptions } from './canStore'\n\n/**\n * Pour bloquer la mise  jour de l'url\n */\nexport const freezeUrl = writable<boolean>(false)\n\n/**\n * Pour signaler que MathALA est dans une iframe\n */\nexport const isInIframe = writable<boolean>(false)\n\n/**\n * exercicesParams est un tableau d'objets dcrivant les exercices\n * {id, uuid, alea, interactif, cd, sup, sup2, sup3, sup4,sup5, n}\n */\nexport const exercicesParams = writable<InterfaceParams[]>([])\n\n// tenir le compte des changements dans la liste : ajout/retrait -> +1\nexport const changes = writable<number>(0)\n\n/**\n * * `v`: vue\n * * `z`: zoom\n * * `title` : titre pour la vue lve uniquement\n * * `presMode` : type d'affichage pour la vue eleve uniquement (page, exos, liste, questions)\n * * `setInteractive` : uniquement pour la vue eleve (0 : pas d'interactivit, 1 : tout interactif, 2 : au choix exercice par exercice)\n * * `isSolutionAccessible` : uniquement pour la vue eleve, pour savoir si les corrections sont disponibles ou pas\n * * `isInteractiveFree` : uniquement pour la vue eleve, pour savoir si l'lve peut changer l'interactivit ou pas\n * * `oneShot` : uniquement pour la vue eleve, pour savoir si l'lve peut rpondre une ou plusieurs fois en interactif.\n * * `twoColumns` : dans les vues lves avec tous les exercices/questions sur une mme page, on adopte la prsentation du texte sur deux colonnes\n *\n * `globalOptions` est utilis dans `Mathalea.updateUrl()` et dans `Mathalea.loadExercicesFromUrl()`\n * Il permet de sauvegarder le type de vue (`v=...`)\n *\n * Le paramtre `es` est utilis pour renseigner les rglages de la vue lve :\n * une unique chane de caractres contient dans l'ordre : titre + mode prsentation + interactivit +  accs solutions + affichage deux colonnes\n */\nexport const globalOptions = writable<InterfaceGlobalOptions>({\n  v: undefined,\n  z: '1',\n  title: 'valuation',\n  presMode: 'liste_exos',\n  setInteractive: '2',\n  isSolutionAccessible: true,\n  isInteractiveFree: true,\n  isTitleDisplayed: true,\n  oneShot: false,\n  twoColumns: false,\n  beta: false,\n  lang: 'fr-FR',\n})\n\n// pour la gestion du mode sombre\nexport const darkMode = writable({ isActive: false })\n\nexport const capytaleMode = writable<\n  'none' | 'create' | 'assignment' | 'review' | 'view'\n>('none')\n\nexport const capytaleStudentAssignment = writable<InterfaceResultExercice[]>()\n\n// sauvegarde des rsultats des exercices\nexport const resultsByExercice = writable<InterfaceResultExercice[]>([])\n\n// vue lve : dtecter la ncessit d'un menu\nexport const isMenuNeededForExercises = writable<boolean>(false)\nexport const isMenuNeededForQuestions = writable<boolean>(false)\nexport const isSettingsMenuVisible = writable<boolean>(false)\nexport const isExportMenuVisible = writable<boolean>(false)\n\n// pour garder trace du statut d'ouverture du menu de choix\nexport const isSideMenuVisible = writable<boolean>(true)\n\n// pour garder trace de la page appelant l'export\nexport const previousView = writable<undefined | '' | VueType>(undefined)\n\n// pour sauvegarder l'objet correspondant  la rubrique choisie pour les exos statiques\nexport const bibliothequeSectionContent = writable<bibliothequeExercise[]>([])\nexport const bibliothequeDisplayedContent =\n  writable<Record<string, JSONReferentielEnding>>()\nexport const bibliothequePathToSection = writable<string[]>([])\n\n/**\n * Dplace un exercice dans exercicesParams\n */\nexport function moveExercice(\n  liste: InterfaceParams[],\n  iDepart: number,\n  iArrivee: number,\n): InterfaceParams[] {\n  liste.splice(iArrivee, 0, liste.splice(iDepart, 1)[0])\n  return liste\n}\n\nlet urlToWrite: URL\nlet timerId: ReturnType<typeof setTimeout> | undefined\n\n/**\n * Complte l'URL courante avec les lments relatifs au diaporama\n */\nexport function updateGlobalOptionsInURL(url: URL) {\n  const options = get(globalOptions)\n  const canStore = get(canOptions)\n  if (options.v) {\n    url.searchParams.append('v', options.v)\n  } else {\n    url.searchParams.delete('v')\n  }\n  if (options.z && options.z !== '1') {\n    url.searchParams.append('z', options.z)\n  } else {\n    url.searchParams.delete('z')\n  }\n  if (options.durationGlobal) {\n    url.searchParams.append('dGlobal', options.durationGlobal.toString())\n  } else {\n    url.searchParams.delete('dGlobal')\n  }\n  if (\n    options.v === 'eleve' ||\n    options.v === 'myriade' ||\n    options.v === 'indices'\n  ) {\n    if (options.title != null && options.title.length > 0) {\n      url.searchParams.append('title', options.title)\n    } else {\n      url.searchParams.delete('title')\n    }\n    if (options.iframe !== undefined && options.iframe.length > 0) {\n      url.searchParams.append('iframe', options.iframe)\n    } else {\n      url.searchParams.delete('iframe')\n    }\n    if (options.answers !== undefined && options.answers.length > 0) {\n      url.searchParams.append('answers', JSON.stringify(options.answers))\n    } else {\n      url.searchParams.delete('answers')\n    }\n    if (typeof options !== 'undefined') {\n      let es = ''\n      if (options.presMode != null) {\n        es = presModeId.indexOf(options.presMode).toString()\n      } else es = '1'\n      es += options.setInteractive ?? '2'\n      es += options.isSolutionAccessible ? '1' : '0'\n      es += options.isInteractiveFree ? '1' : '0'\n      es += options.oneShot ? '1' : '0'\n      es += options.twoColumns ? '1' : '0'\n      es += options.isTitleDisplayed ? '1' : '0'\n      url.searchParams.append('es', es)\n    }\n    if (options.done) {\n      url.searchParams.append('done', options.done)\n    } else {\n      url.searchParams.delete('done')\n    }\n  } else {\n    url.searchParams.delete('title')\n    url.searchParams.delete('es')\n    url.searchParams.delete('iframe')\n    url.searchParams.delete('answers')\n    url.searchParams.delete('recorder')\n    url.searchParams.delete('done')\n  }\n  if (options.v === 'can') {\n    if (canStore) {\n      url.searchParams.append('canD', canStore.durationInMinutes.toString())\n      url.searchParams.append('canT', canStore.subTitle)\n      url.searchParams.append('canSA', canStore.solutionsAccess ? '1' : '0')\n      url.searchParams.append('canSM', canStore.solutionsMode)\n      url.searchParams.append('canI', canStore.isInteractive ? '1' : '0')\n    }\n  }\n  if (options.recorder) {\n    url.searchParams.append('recorder', options.recorder)\n  } else {\n    url.searchParams.delete('recorder')\n  }\n  if (options.v === 'diaporama' || options.v === 'overview') {\n    url.searchParams.append('ds', buildDsParams())\n    if (\n      options.select !== undefined &&\n      options.select !== undefined &&\n      options.select.length > 0 &&\n      options.select.length < get(exercicesParams).length\n    ) {\n      url.searchParams.append('select', options.select.join('-'))\n    }\n    if (\n      options.order !== undefined &&\n      options.order.length > 0 &&\n      options.shuffle\n    ) {\n      url.searchParams.append('order', options.order.join('-'))\n    }\n  } else {\n    url.searchParams.delete('ds')\n    url.searchParams.delete('select')\n    url.searchParams.delete('order')\n  }\n  if (options.beta) {\n    url.searchParams.append('beta', '1')\n  }\n  const currentUrl = new URL(window.location.href)\n  if (currentUrl.searchParams.has('triche')) {\n    url.searchParams.append('triche', '1')\n  }\n  const logParam = currentUrl.searchParams.get('log')\n  if (logParam !== null && /^[0-9]$/.test(logParam)) {\n    url.searchParams.append('log', logParam)\n  }\n  const pdfParam = currentUrl.searchParams.get('pdfParam')\n  if (\n    (options.v === 'latex' || options.v === 'pdf') &&\n    pdfParam !== null &&\n    /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(\n      pdfParam,\n    )\n  ) {\n    url.searchParams.append('pdfParam', pdfParam)\n  }\n  urlToWrite = url\n  // On ne met  jour l'url qu'une fois toutes les 0,5 s\n  // pour viter l'erreur Attempt to use history.pushState() more than 100 times per 30 seconds\n  if (timerId === undefined) {\n    timerId = setTimeout(() => {\n      const currentUrl = new URL(window.location.href)\n      if (urlToWrite.href === currentUrl.href) {\n        timerId = undefined\n        return\n      }\n      window.history.pushState({}, '', urlToWrite)\n      statsPageTracker()\n      timerId = undefined\n    }, 500)\n  }\n}\n\nexport const presModeId: [\n  // sync with src/components/urls.ts presentationMode\n  'liste_exos',\n  'un_exo_par_page',\n  'liste_exos',\n  'une_question_par_page',\n  'recto',\n  'verso',\n  // 'cartes'\n] = [\n  'liste_exos',\n  'un_exo_par_page',\n  'liste_exos',\n  'une_question_par_page',\n  'recto',\n  'verso',\n  // 'cartes'\n]\n","import Bugsnag, { type NotifiableError } from '@bugsnag/js'\nimport bigInt from 'big-integer'\n\nimport { tropDeChiffres } from './modules/outils'\nimport { showDialogForLimitedTime } from './lib/components/dialogs'\nimport { get } from 'svelte/store'\nimport {\n  capytaleMode,\n  capytaleStudentAssignment,\n  exercicesParams,\n  globalOptions,\n} from './lib/stores/generalStore'\nimport { canOptions } from './lib/stores/canStore'\nimport { createURL } from './lib/mathalea'\n\ntype Metadatas = Record<string, unknown>\n\n/* global BigInt */\nif (typeof BigInt === 'undefined') {\n  // @ts-expect-error\n  window.BigInt = bigInt\n}\n\nfunction handleBugsnag() {\n  // const fileName = '../_private/bugsnagApiKey'\n  // PROVISOIRE : MGU\n  const getBugsnagApiKey = '6f45f454e2366599256bddc91cd7000b' // await import(/* @vite-ignore */fileName)\n  const key = getBugsnagApiKey // .default() || ''\n  Bugsnag.start({\n    apiKey: key,\n    onError: function (event) {\n      event.addMetadata('Parametres Exos', get(exercicesParams))\n      event.addMetadata('Parametres: ', {\n        globalOptions: get(globalOptions),\n        canOptions: get(canOptions),\n        capytaleMode: get(capytaleMode),\n        studentAssignment: get(capytaleStudentAssignment),\n      })\n      event.addMetadata('Url Exos', {\n        url: createURL(get(exercicesParams)).toString(),\n      })\n    },\n  })\n}\n\nif (document.location.hostname === 'coopmaths.fr') {\n  handleBugsnag()\n}\n\nfunction isDevMode() {\n  return window.location.href.startsWith('http://localhost')\n}\n\nexport function notifyLocal(error: string | Error, metadatas: Metadatas) {\n  if (!isDevMode()) return\n  if (typeof error === 'string') {\n    // @ts-expect-error\n    if (error.includes(tropDeChiffres) && !window.Bugsnag) {\n      console.error(\n        error +\n          \"\\nIl y a un risque d'erreur d'approximation (la limite est de 15 chiffres significatifs)\\nnb : \" +\n          metadatas.nb +\n          '\\nprecision (= nombre de dcimales demand) : ' +\n          metadatas.precision,\n      )\n    }\n    error = Error(error).message\n  }\n  const message =\n    'Ce message ne sera pas envoy  Bugsnag dans la version en ligne, mais il faut traiter le problme !'\n  showDialogForLimitedTime(\n    'notifDialog',\n    5000,\n    message + ' : <br>' + error.toString() + JSON.stringify(metadatas),\n  )\n  console.error(message, error)\n  if (metadatas) console.info('avec les metadatas', metadatas)\n  if (metadatas) console.info(JSON.stringify(metadatas))\n  console.info('Paramtres des exercices', get(exercicesParams))\n  console.trace()\n}\n/**\n * Une fonction  importer dans les fichiers typescript si on veut faire du window.notify() on utilise notify().\n * @param error\n * @param metadatas\n */\nexport function notify(error: string | NotifiableError, metadatas: Metadatas) {\n  if (typeof error === 'string') {\n    // @ts-expect-error\n    if (error.includes(tropDeChiffres) && !window.Bugsnag) {\n      console.error(\n        error +\n          \"\\nIl y a un risque d'erreur d'approximation (la limite est de 15 chiffres significatifs)\\nnb : \" +\n          metadatas.nb +\n          '\\nprecision (= nombre de dcimales demand) : ' +\n          metadatas.precision,\n      )\n    }\n    error = Error(error).message\n  }\n  // console.error(error)\n  // if (metadatas) console.info('Avec les metadatas:', metadatas)\n  // console.info('Paramtres des exercices:', get(exercicesParams))\n  // return\n\n  if (Bugsnag && !isDevMode()) {\n    if (metadatas) Bugsnag.addMetadata('ajouts', metadatas)\n    Bugsnag.addMetadata('Paramtres des exercices', get(exercicesParams))\n    Bugsnag.notify(error)\n    console.error(error)\n  } else {\n    const message =\n      \"message qui aurait t envoy  bugsnag s'il avait t configur\"\n    showDialogForLimitedTime(\n      'notifDialog',\n      5000,\n      message + ' : <br>' + error.toString(),\n    )\n    console.error(message, error)\n    if (metadatas) console.info('avec les metadatas', metadatas)\n    console.info('Paramtres des exercices', get(exercicesParams))\n  }\n}\n\n// @ts-expect-error\nwindow.notify = notify\n\n// @ts-expect-error\nwindow.notifyLocal = notifyLocal\n","import { notify } from '../../../bugsnag'\nimport { buildDataKeyboardFromStyle } from '../claviers/keyboard'\nimport './tableauMathlive.scss'\nexport interface Icell {\n  texte: string\n  latex: boolean\n  gras: boolean\n  color: string\n  style?: string\n  options?: {\n    texteApres?: string\n    texteAvant?: string\n    blocCenter?: boolean\n    espace?: boolean\n  }\n}\n\nexport type FlecheCote = false | string\nexport type FlecheSens = 'bas' | 'haut'\nexport type Fleche = [number, number, string, number] | [number, number, string]\nexport type Raws = Array<Icell[]>\ntype ObjetParams = Record<string, string>\n\n// Le TabPropMathlive ne gre pas les flches... alors, je ne sais pas pourquoi j'ai mis toutes ces proprits faculatives... Pour l'avenir ?\n// Si quelqu'un sait faire, qu'il ne se gne pas !\nexport interface Itableau {\n  nbColonnes: number\n  ligne1: Icell[]\n  ligne2: Icell[]\n  flecheHaut?: Fleche[] // [[1, 2, '\\\\times 6,4', 3], [2, 3, '\\\\div 6']]\n  flecheBas?: Fleche[]\n  flecheDroite?: FlecheCote //  remplacer par un string\n  flecheDroiteSens?: FlecheSens\n  flecheGauche?: FlecheCote\n  flecheGaucheSens?: FlecheSens\n}\n\nexport interface ItabDbleEntry {\n  raws: Array<Icell[]>\n  headingCols: Icell[]\n  headingLines: Icell[]\n}\n\n/**\n * Ajoute une cellule et ce qu'il faut dedans\n * @param {boolean} isInteractif\n * @param line\n * @param icell\n * @param indexCol\n * @param indexLine\n * @param tag\n * @param classes\n * @param NoEx\n * @param NoQ\n */\nfunction appendCell({\n  isInteractif,\n  line,\n  icell,\n  indexCol,\n  indexLine,\n  tag,\n  classes,\n  NoEx,\n  NoQ,\n  style,\n}: {\n  isInteractif: boolean\n  line: HTMLElement\n  icell: Icell\n  indexCol: number\n  indexLine: number\n  tag: 'th' | 'td'\n  classes: string\n  NoEx: number\n  NoQ: number\n  style: string\n}) {\n  const cell = document.createElement(tag)\n  let element: HTMLElement\n  const options = icell.options || {}\n  if (icell.texte === '') {\n    if (isInteractif) {\n      if (options.texteAvant != null && options.texteAvant !== '') {\n        const spanAvant = document.createElement('span')\n        spanAvant.classList.add('tableauMathlive')\n        spanAvant.textContent = options.texteAvant\n        cell.appendChild(spanAvant)\n      }\n      element = document.createElement('math-field')\n      if (options.espace) {\n        element.setAttribute('data-space', 'true')\n      }\n      element.classList.add('tableauMathlive')\n\n      const classeString = buildDataKeyboardFromStyle(classes).join(' ')\n      /*  for (const classe of classes.split(' ')) {\n        // if (classe === 'clavierDeBase') element.setAttribute('data-keyboard', 'numbersOperations')\n        // else if (classe === 'clavierDeBaseAvecFraction') element.setAttribute('data-keyboard', 'numbers basicOperations')\n        if (classe === 'angles') element.setAttribute('data-keyboard', 'angles')\n        else if (classe === 'clavierDeBaseAvecFraction')\n          element.setAttribute('data-keyboard', 'numbers basicOperations')\n        else if (classe === 'clavierDeBaseAvecVariable')\n          element.setAttribute(\n            'data-keyboard',\n            'numbers basicOperations variables',\n          )\n        else if (classe === 'clavierDeBaseAvecEgal')\n          element.setAttribute('data-keyboard', 'numbers2 basicOperations')\n        else element.setAttribute('data-keyboard', 'numbersOperations')\n      }\n        */\n      element.setAttribute('data-keyboard', classeString)\n      element.id = `champTexteEx${NoEx}Q${NoQ}L${indexLine}C${indexCol}`\n      element.setAttribute('virtual-keyboard-mode', 'manual')\n      cell.appendChild(element)\n      if (options.texteApres != null && options.texteApres !== '') {\n        const spanApres = document.createElement('span')\n        spanApres.textContent = options.texteApres\n        cell.appendChild(spanApres)\n      }\n      const spanResultat = document.createElement('span')\n      spanResultat.id = `resultatCheckEx${NoEx}Q${NoQ}L${indexLine}C${indexCol}`\n      cell.appendChild(spanResultat)\n    } else {\n      element = document.createElement('span')\n      element.classList.add('tableauMathlive')\n      for (const classe of classes.split(' ')) {\n        if (classe !== '') element.classList.add(classe)\n      }\n      element.id = `cell${NoEx}Q${NoQ}L${indexLine}C${indexCol}`\n      cell.appendChild(element)\n    }\n  } else {\n    if (icell.latex) {\n      // J'aimerais pouvoir utiliser mathlive mais a semble poser des soucis, je remplace par katex...\n      //  element = document.createElement('math-field')\n      // element.innerHTML = `<math-field read-only style=\"display:inline-block\" id=\"L${indexLine}C${i + 1}\">${icell.texte}</math-field>`\n      element = document.createElement('span')\n      cell.appendChild(element)\n      element.outerHTML = `<span id=\"spanEx${NoEx}Q${NoQ}L${indexLine}C${indexCol}\">$${icell.texte}$</span>`\n    } else {\n      element = document.createElement('span')\n      cell.appendChild(element)\n      element.outerHTML = `<span id=\"spanEx${NoEx}Q${NoQ}L${indexLine}C${indexCol}\">${icell.texte}</span>`\n    }\n  }\n  if (style != null) {\n    cell.style.backgroundColor = style.split(';')[0] || 'transparent'\n    cell.style.color = style.split(';')[1] || 'black'\n  }\n  line.appendChild(cell)\n}\n\n/**\n * @param {HTMLTableRowElement} line L'lment HTML <tr> qui reoit les cellules\n * @param {Icell[]} content la liste des cellules au format Icell\n * @param {number} index le numro de la ligne pour fabriquer l'identifiant de cellule\n * @param {'td'|'th'} tag le tag (td pour des cellules  l'intrieur th pour des cellules d'entte)\n * @param {string} classes une liste de className dans un string spars par des espaces\n */\nconst fillLine = function ({\n  isInteractif,\n  line,\n  content,\n  index,\n  tag,\n  classes,\n  NoEx,\n  NoQ,\n  style,\n}: {\n  isInteractif: boolean\n  line: HTMLElement\n  content: Icell[]\n  index: number\n  tag: 'td' | 'th'\n  classes: string\n  NoEx: number\n  NoQ: number\n  style: ObjetParams\n}): void {\n  for (let i = 0; i < content.length; i++) {\n    appendCell({\n      isInteractif,\n      line,\n      icell: content[i],\n      indexCol: i,\n      indexLine: index,\n      tag,\n      classes,\n      NoEx,\n      NoQ,\n      style: style[`L${index}C${i}`],\n    })\n  }\n}\n\nexport class AddTabPropMathlive {\n  styles: Record<string, string>\n  id!: string // ce sera ncessaire pour retrouver le tableau s'il y en a plusieurs dans la page.\n  numeroExercice: number\n  numeroQuestion: number\n  output!: string\n  nbColonnes: number\n  ligne1!: Icell[]\n  ligne2!: Icell[]\n  flecheHaut: Fleche[] // [[1, 2, '\\\\times 6,4', 3], [2, 3, '\\\\div 6']]\n  flecheBas: Fleche[]\n  flecheDroite: FlecheCote //  remplacer par un string\n  flecheDroiteSens: FlecheSens\n  flecheGauche: FlecheCote\n  flecheGaucheSens: FlecheSens\n  classes?: string\n  isInteractif: boolean\n\n  private constructor(\n    numeroExercice: number,\n    question: number,\n    tableau: Itableau,\n    classes: string,\n    isInteractif: boolean,\n  ) {\n    this.nbColonnes = tableau.nbColonnes ?? 1\n    this.flecheHaut = tableau.flecheHaut ?? []\n    this.flecheBas = tableau.flecheBas ?? []\n    this.flecheDroite = tableau.flecheDroite ?? false\n    this.flecheDroiteSens = tableau.flecheDroiteSens ?? 'bas'\n    this.flecheGauche = tableau.flecheGauche ?? false\n    this.flecheGaucheSens = tableau.flecheGaucheSens ?? 'haut'\n    this.numeroExercice = numeroExercice ?? 0\n    this.numeroQuestion = question\n    this.id = `tabMLEx${this.numeroExercice}Q${this.numeroQuestion}`\n    this.classes = classes\n    this.isInteractif = isInteractif\n    this.styles = {}\n  }\n\n  static create(\n    numeroExercice: number,\n    question: number,\n    tableau: Itableau,\n    classes: string,\n    isInteractif: boolean,\n    style: ObjetParams,\n  ) {\n    if (!Array.isArray(tableau.ligne1) || !Array.isArray(tableau.ligne1)) {\n      notify('ajouteTableauMathlive : vrifiez vos paramtres !', {\n        ligne1: tableau.ligne1,\n        ligne2: tableau.ligne2,\n        nbColonnes: tableau.nbColonnes,\n      })\n    }\n    if (style == null) style = {}\n    // a, c'est pour ne pas modifier les lignes du tableau pass en argument\n    const NoEx = numeroExercice ?? 0\n    const NoQ = question\n    const ligne1 = [...tableau.ligne1]\n    const ligne2 = [...tableau.ligne2]\n    const tableauMathlive: AddTabPropMathlive = new AddTabPropMathlive(\n      numeroExercice,\n      question,\n      tableau,\n      classes,\n      isInteractif,\n    )\n    tableauMathlive.ligne1 = ligne1.map((el) => JSON.parse(JSON.stringify(el))) // on clone les lignes pour ne pas modifier le tableau pass en argument\n    tableauMathlive.ligne2 = ligne2.map((el) => JSON.parse(JSON.stringify(el)))\n    tableauMathlive.styles = style\n    const table = document.createElement('table')\n    table.className = 'tableauMathlive'\n    table.id = `tabMathliveEx${NoEx}Q${question}`\n    const firstLine = document.createElement('tr')\n    const entete1 = ligne1.shift()\n    if (entete1)\n      appendCell({\n        isInteractif,\n        line: firstLine,\n        icell: entete1,\n        indexCol: 0,\n        indexLine: 0,\n        tag: 'th',\n        classes,\n        NoEx,\n        NoQ,\n        style: style[`L${0}C${0}`],\n      })\n    for (let i = 0; i < ligne1.length; i++) {\n      appendCell({\n        isInteractif,\n        line: firstLine,\n        icell: ligne1[i],\n        indexCol: i + 1,\n        indexLine: 0,\n        tag: 'td',\n        classes,\n        NoEx,\n        NoQ,\n        style: style[`L${0}C${i + 1}`] ?? ligne1[i].style,\n      })\n    }\n    table.appendChild(firstLine)\n    // tableau de proportionnalit conforme  ceux dfinis dans src/lib/2d/tableau\n    const secondLine = document.createElement('tr')\n    const entete2 = ligne2.shift()\n    if (entete2)\n      appendCell({\n        isInteractif,\n        line: secondLine,\n        icell: entete2,\n        indexCol: 0,\n        indexLine: 1,\n        tag: 'th',\n        classes,\n        NoEx,\n        NoQ,\n        style: style[`L${1}C${0}`],\n      })\n    for (let i = 0; i < ligne2.length; i++) {\n      appendCell({\n        isInteractif,\n        line: secondLine,\n        icell: ligne2[i],\n        indexCol: i + 1,\n        indexLine: 1,\n        tag: 'td',\n        classes,\n        NoEx,\n        NoQ,\n        style: style[`L${1}C${i + 1}`] ?? ligne2[i].style,\n      })\n    }\n    table.appendChild(secondLine)\n    const spanCheckOuterHTML = `<span id=\"resultatCheckEx${numeroExercice}Q${question}\"></span>`\n    // pour l'instant je retourne l'objet complet avec le HTML de la table dans sa proprit output,\n    // mais il sera peut-tre possible de ne retourner que le HTML comme pour ajouteChampTexteMathlive...\n    tableauMathlive.output = table.outerHTML + spanCheckOuterHTML\n    return tableauMathlive\n  }\n\n  /**\n   * Les listes de tableauColonneLigne sont des listes de strings.\n   * Celles des tableaux Mathlive, doivent tre des Icell[] (interface exporte par ce fichier).\n   * Cette fonction prends les diffrentes listes de tableauColonneLigne en argument et retourne un tableau pour AddTabDblEntry\n   * @param tabEntetesColonnes\n   * @param tabEntetesLignes\n   * @param tabLignes\n   */\n  static convertTableauToTableauMathlive(\n    lgn1: string[],\n    lgn2: string[],\n    gras: boolean = false,\n    color: string = 'black',\n  ): Itableau {\n    const nbColonnes = Math.max(lgn1.length, lgn2.length)\n    const ligne1: Icell[] = []\n    const ligne2: Icell[] = []\n    for (const str of lgn1) {\n      ligne1.push({ texte: str, latex: true, gras, color })\n    }\n    for (const str of lgn2) {\n      ligne2.push({ texte: str, latex: true, gras, color })\n    }\n    return { ligne1, ligne2, nbColonnes }\n  }\n\n  get latexOutput(): string {\n    // retourne le tableau au format latex\n    let output =\n      '\\\\begin{tabular}{|c|' + 'c|'.repeat(this.nbColonnes - 1) + '}\\n'\n    output += '\\\\hline\\n'\n    let content: string[] = []\n    for (let i = 0; i < this.ligne1.length; i++) {\n      const cellule = this.ligne1[i]\n      const style = this.styles[`L0C${i}`] ?? ''\n      content.push(\n        `${(style ?? ';').split(';')[0] !== '' ? `\\\\cellcolor{${(style ?? ';').split(';')[0]}}` : ''} ${`${cellule.latex ? '$' : ''}${cellule.texte}${cellule.latex ? '$' : ''}`}`.replace(\n          '$$',\n          '',\n        ),\n      )\n    }\n    output += content.join(' & ') + '\\\\\\\\\\n'\n\n    output += '\\\\hline\\n'\n    content = []\n    for (let i = 0; i < this.ligne2.length; i++) {\n      const cellule = this.ligne2[i]\n      const style = this.styles[`L1C${i}`] ?? ''\n      content.push(\n        `${(style ?? ';').split(';')[0] !== '' ? `\\\\cellcolor{${(style ?? ';').split(';')[0]}}` : ''} ${`${cellule.latex ? '$' : ''}${cellule.texte}${cellule.latex ? '$' : ''}`}`.replace(\n          '$$',\n          '',\n        ),\n      )\n    }\n    output += content.join(' & ') + '\\\\\\\\\\n'\n    output += '\\\\hline\\n'\n    output += '\\\\end{tabular}'\n    return output\n  }\n}\n\nexport class AddTabDbleEntryMathlive {\n  id!: string // ce sera ncessaire pour retrouver le tableau s'il y en a plusieurs dans la page.\n  numeroExercice: number\n  numeroQuestion: number\n  output!: string\n  raws!: Raws\n  headingCols: Icell[]\n  headingLines: Icell[]\n  classes: string\n  isInteractif: boolean\n  private constructor(\n    numeroExercice: number,\n    question: number,\n    tableau: ItabDbleEntry,\n    classes: string,\n    isInteractif: boolean,\n  ) {\n    if (numeroExercice == null) {\n      // @ts-expect-error\n      window.notify(\n        \"AddTabDbleEntryMathlive a besoin absolument d'un numero d'exercice\",\n      )\n    }\n    this.headingCols = tableau.headingCols\n    this.headingLines = tableau.headingLines\n    this.numeroExercice = numeroExercice ?? 0\n    this.numeroQuestion = question\n    this.id = `tabMLEx${this.numeroExercice}Q${this.numeroQuestion}`\n    this.raws = tableau.raws\n    this.classes = classes\n    this.isInteractif = isInteractif\n  }\n\n  static create(\n    numeroExercice: number,\n    question: number,\n    tableau: ItabDbleEntry,\n    classes: string,\n    isInteractif: boolean,\n    style: ObjetParams,\n  ) {\n    // tableau doit contenir headingCols et headingLines, qui peuvent tre vides, mais doivent tre fournis.\n    if (\n      !Array.isArray(tableau.headingCols) ||\n      !Array.isArray(tableau.headingLines)\n    ) {\n      notify('ajouteTableauMathlive : vrifiez vos paramtres !', {\n        headingCols: tableau.headingCols,\n        headingLines: tableau.headingLines,\n      })\n    }\n    if (style == null) style = {}\n    const tableauMathlive: AddTabDbleEntryMathlive =\n      new AddTabDbleEntryMathlive(\n        numeroExercice,\n        question,\n        tableau,\n        classes,\n        isInteractif,\n      )\n    const table = document.createElement('table')\n    const NoEx = numeroExercice ?? 0\n    const NoQ = question\n    table.className = 'tableauMathlive'\n    table.id = `tabMathliveEx${numeroExercice}Q${question}`\n    const firstLine = document.createElement('tr')\n    table.appendChild(firstLine)\n    tableauMathlive.headingCols = tableau.headingCols.map((el) =>\n      JSON.parse(JSON.stringify(el)),\n    ) // on clone les lignes pour ne pas modifier le tableau pass en argument\n    if (tableau.headingCols != null) {\n      fillLine({\n        isInteractif,\n        line: firstLine,\n        content: tableau.headingCols,\n        index: 0,\n        tag: 'th',\n        classes,\n        NoEx,\n        NoQ,\n        style,\n      })\n    }\n    // lignes suivantes\n    for (let j = 0; j < tableau.raws.length; j++) {\n      const newLine = document.createElement('tr')\n      table.appendChild(newLine)\n      if (tableau.headingLines != null) {\n        tableauMathlive.headingLines = tableau.headingLines.map((el) =>\n          JSON.parse(JSON.stringify(el)),\n        ) // on clone les lignes pour ne pas modifier le tableau pass en argument\n        const sty =\n          style[`L${tableau.headingCols != null ? 1 + j : j}C${0}`] ||\n          style[`LC${0}`]\n        appendCell({\n          isInteractif,\n          line: newLine,\n          icell: tableau.headingLines[j],\n          indexCol: 0,\n          indexLine: tableau.headingCols != null ? 1 + j : j,\n          tag: 'th',\n          classes,\n          NoEx,\n          NoQ,\n          style: sty,\n        })\n        /*\n        const head = document.createElement('th')\n        head.textContent = `$${tableau.headingLines[j]}$`\n        newLine.appendChild(head)\n        */\n      }\n      tableauMathlive.raws = tableau.raws.map((el) =>\n        JSON.parse(JSON.stringify(el)),\n      ) // on clone les raws pour ne pas modifier le tableau pass en argument\n      const raw = tableau.raws[j]\n      if (Array.isArray(raw) && raw.length > 0) {\n        for (let i = 0; i < raw.length; i++) {\n          appendCell({\n            isInteractif,\n            line: newLine,\n            icell: raw[i],\n            indexCol: tableau.headingLines != null ? i + 1 : i,\n            indexLine: tableau.headingCols != null ? 1 + j : j,\n            tag: 'td',\n            classes,\n            NoEx,\n            NoQ,\n            style:\n              style[\n                `L${tableau.headingCols != null ? 1 + j : j}C${tableau.headingLines != null ? i + 1 : i}`\n              ],\n          })\n        }\n      }\n    }\n    const spanCheckOuterHTML = `<span id=\"feedbackEx${numeroExercice}Q${question}\"></span>`\n    // pour l'instant je retourne l'objet complet avec le HTML de la table dans sa proprit output,\n    // mais il sera peut-tre possible de ne retourner que le HTML comme pour ajouteChampTexteMathlive...\n    tableauMathlive.output = table.outerHTML + spanCheckOuterHTML\n    return tableauMathlive\n  }\n\n  get latexOutput(): string {\n    if (this.headingCols.length === 0 && this.headingLines.length === 0) {\n      throw Error(\n        'Un tableau  double entre doit avoir des entte de colonne et des entte de ligne',\n      )\n    }\n    const nbCols =\n      this.headingCols.length > 0\n        ? this.headingCols.length\n        : this.raws[0].length + (this.headingLines.length > 0 ? 1 : 0)\n    const nbLines =\n      this.headingLines.length > 0 ? this.headingLines.length : this.raws.length\n\n    // retourne le tableau au format latex\n    let output = '\\\\begin{tabular}{|c|' + 'c|'.repeat(nbCols - 1) + '}\\n'\n    output += '\\\\hline\\n'\n    for (let i = 0; i < nbLines; i++) {\n      if (this.headingLines[i] != null) {\n        output += `$${this.headingLines[i].texte}$ & `\n      }\n      const raw = this.raws[i]\n      output +=\n        raw.map((cellule) => `$${cellule.texte}$`).join(' & ') + '\\\\\\\\\\n'\n      output += '\\\\hline\\n'\n    }\n    output += '\\\\end{tabular}'\n    return output\n  }\n\n  /**\n   * Les listes de tableauColonneLigne sont des listes de strings.\n   * Celles des tableaux Mathlive, doivent tre des Icell[] (interface exporte par ce fichier).\n   * Cette fonction prends les diffrentes listes de tableauColonneLigne en argument et retourne un tableau pour AddTabDblEntry\n   * @param tabEntetesColonnes\n   * @param tabEntetesLignes\n   * @param tabLignes\n   */\n  static convertTclToTableauMathlive(\n    tabEntetesColonnes: (string | number)[],\n    tabEntetesLignes: (string | number)[],\n    tabLignes: (string | number)[],\n    gras: boolean = true,\n    color: string = 'black',\n  ) {\n    const headingCols: Icell[] = []\n    for (const enTete of tabEntetesColonnes) {\n      headingCols.push({ texte: enTete.toString(), latex: true, gras, color })\n    }\n    const headingLines: Icell[] = []\n    for (const enTete of tabEntetesLignes) {\n      headingLines.push({\n        texte: enTete.toString(),\n        latex: !enTete.toString().includes('<pre class'),\n        gras,\n        color,\n      })\n    }\n    const raws: Array<Icell[]> = []\n    const haveHeadC = headingCols.length > 0\n    const haveHeadL = headingLines.length > 0\n    if (!haveHeadL && !haveHeadC)\n      throw Error(\n        'Un tableau  double entre doit avoir des entte de colonne et des entte de ligne',\n      )\n    // on boucle sur les lignes mais il peut ne pas y avoir de headingLines ! On doit alors diviser le nombre de cellules par le nombre de colonnes  remplir.\n    const nbCols =\n      haveHeadL && haveHeadC\n        ? headingCols.length - 1\n        : haveHeadC\n          ? headingCols.length\n          : tabLignes.length / headingLines.length\n    const nbLines = haveHeadL ? headingLines.length : tabLignes.length / nbCols\n    for (let i = 0; i < nbLines; i++) {\n      const raw: Icell[] = []\n      for (let j = 0; j < nbCols; j++) {\n        raw.push({\n          texte: tabLignes[i * nbCols + j].toString(),\n          latex: true,\n          gras,\n          color,\n        })\n      }\n      raws.push(raw)\n    }\n    return { headingLines, headingCols, raws }\n  }\n}\n","import type Exercice from '../../exercices/Exercice'\nimport { context } from '../../modules/context'\nimport { sp } from '../outils/outilString'\nimport type { InteractivityType, TableauMathliveType } from '../types'\nimport './champTexte.scss'\nimport { buildDataKeyboardFromStyle } from './claviers/keyboard'\nimport {\n  handleAnswers,\n  type ReponseParams,\n  type Valeur,\n} from './gestionInteractif'\nimport {\n  AddTabDbleEntryMathlive,\n  AddTabPropMathlive,\n  type ItabDbleEntry,\n  type Itableau,\n} from './tableaux/AjouteTableauMathlive'\n\nconst buildDataKeyboardString = (style = '') => {\n  const blocks = buildDataKeyboardFromStyle(style)\n  return blocks.join(' ')\n}\n\n/**\n * Une question pour rassembler les ajouteChampTexte et Cie et les handleHanswers.\n * Il faudrait pouvoir fournir autre chose que objetReponse.\n * Un truc du style :\n * [{id: 'reponse', value: 'valeur', compare: fonctionComparaison, options: {}},\n * {id: 'reponse2', value: 'valeur2', compare: fonctionComparaison, options: {}},\n * {id: 'reponse3', value: 'valeur3', compare: fonctionComparaison, options: {}}]\n * qui alimentera objetReponse.\n * ou alors, on fait un type conditionnel sur objetReponse...\n * C'est balaize  faire, mais ce serait mieux : on ouvre l'accolade, et si on commence  taper rep... il ouvre l'accolade, demande value, demande compare, demande options... idem si on commence  taper champ1....\n * @author Jean-Claude Lhote\n * @param {Exercice} exercice\n * @param {number} question\n * @param {Valeur} objetReponse\n * @param {ReponseParams} reponseParams\n * @param {InteractivityType} typeInteractivite\n * @param {string} content\n * @param {string} classe\n * @param {ItabDbleEntry | Itableau} tableau\n * @param {TableauMathliveType} typeTableau\n * @param {string} texteAvant\n * @param {string} texteApres\n * @param {boolean} blocCenter\n * @param {boolean} espace\n * @returns string\n */\nexport function ajouteQuestionMathlive({\n  exercice,\n  question,\n  objetReponse,\n  reponseParams,\n  typeInteractivite,\n  content = '',\n  classe = '',\n  tableau,\n  typeTableau = 'doubleEntree',\n  texteAvant = '',\n  texteApres = '',\n  blocCenter = false,\n  espace = false,\n}: {\n  exercice: Exercice\n  question: number\n  objetReponse: Valeur\n  reponseParams?: ReponseParams\n  typeInteractivite: InteractivityType\n  content?: string\n  classe?: string\n  tableau?: ItabDbleEntry | Itableau\n  typeTableau?: TableauMathliveType\n  texteAvant?: string\n  texteApres?: string\n  blocCenter?: boolean\n  espace?: boolean\n}) {\n  if (context.isHtml && exercice.interactif) {\n    if (\n      !(\n        typeInteractivite === 'mathlive' ||\n        typeInteractivite === 'fillInTheBlank' ||\n        typeInteractivite === 'tableauMathlive' ||\n        typeInteractivite === 'texte'\n      )\n    ) {\n      window.notify(\n        `Type d'interactivit ${typeInteractivite} non reconnu. Exercice ${exercice.id} ${exercice.uuid}`,\n        { typeInteractivite },\n      )\n      return ''\n    }\n    if (reponseParams === undefined) {\n      reponseParams = { formatInteractif: 'mathlive' }\n    }\n    handleAnswers(exercice, question, objetReponse, reponseParams)\n    switch (typeInteractivite) {\n      case 'fillInTheBlank':\n        return remplisLesBlancs(exercice, question, content, classe, '\\\\ldots')\n      case 'tableauMathlive': {\n        if (!tableau) {\n          window.notify(\n            `Tableau non dfini pour l'interactivit tableauMathlive. Exercice ${exercice.id} ${exercice.uuid}`,\n            { typeInteractivite },\n          )\n          return ''\n        }\n        const leTableau =\n          typeTableau === 'doubleEntree'\n            ? AddTabDbleEntryMathlive.create(\n                exercice.numeroExercice ?? 0,\n                question,\n                tableau as ItabDbleEntry,\n                classe,\n                true,\n                {\n                  texteAvant,\n                  texteApres,\n                  blocCenter: blocCenter ? ' bloccenter' : '',\n                  espace: espace ? ' ' : '',\n                },\n              )\n            : AddTabPropMathlive.create(\n                exercice.numeroExercice ?? 0,\n                question,\n                tableau as Itableau,\n                classe,\n                true,\n                {\n                  texteAvant,\n                  texteApres,\n                  blocCenter: blocCenter ? ' bloccenter' : '',\n                  espace: espace ? ' ' : '',\n                },\n              )\n        return leTableau.output\n      }\n      case 'texte':\n        return ajouteChampTexte(exercice, question, classe, {\n          texteAvant,\n          texteApres,\n          blocCenter,\n          espace,\n        })\n      default:\n        return ajouteChampTexteMathLive(exercice, question, classe, {\n          texteAvant,\n          texteApres,\n          blocCenter,\n          espace,\n        })\n    }\n  }\n  return ''\n}\n\n/**\n * Retourne le code html d'un div prvu pour le feedback toute forme d'interactivit.\n * @param {Exercice} exercice\n * @param {number} question\n * @param {string} style\n * @deprecated si vous l'utilisez aprs ajouteChampTexteMathlive, ajouteChampTexte ou remplisLesBlancs, vous n'avez pas besoin de l'utiliser, il est ajout automatiquement.\n */\nexport function ajouteFeedback(\n  exercice: Exercice,\n  question: number,\n  style = 'style=\"display: none\"',\n) {\n  if (!context.isHtml) return ''\n  const exo = exercice.numeroExercice\n  if (\n    exercice == null ||\n    typeof exo !== 'number' ||\n    typeof question !== 'number'\n  )\n    return ''\n  return `<div class =\"ml-2 py-2 italic text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest\" id=\"feedbackEx${exo}Q${question}\" ${style !== '' ? style : ''}></div>`\n}\n\ntype OptionsChamp = {\n  texteApres?: string\n  texteAvant?: string\n  blocCenter?: boolean\n  espace?: boolean\n  placeholder?: string\n}\n\nexport function ajouteChampTexte(\n  exercice: Exercice,\n  i: number,\n  style = '',\n  options: OptionsChamp = {},\n) {\n  return ajouteChamp({ type: 'texte', exercice, i, style }, options)\n}\n\nexport function ajouteChampTexteMathLive(\n  exercice: Exercice,\n  i: number,\n  style = '',\n  options: OptionsChamp = {},\n) {\n  return ajouteChamp({ type: 'mathlive', exercice, i, style }, options)\n}\n\ntype ParamsChamp = {\n  type: 'texte' | 'mathlive'\n  exercice: Exercice\n  i: number\n  style?: string\n}\n\nfunction ajouteChamp(params: ParamsChamp, options: OptionsChamp = {}) {\n  const { type, exercice, i, style = '' } = params\n  let {\n    texteAvant = '',\n    texteApres = '',\n    blocCenter = false,\n    espace = false,\n    placeholder = '',\n  } = options\n  if (texteApres !== '') texteApres = sp() + texteApres\n  if (!context.isHtml || !exercice.interactif || style === 'none') return ''\n  if (typeof style !== 'string') {\n    window.notify(\n      `style doit tre une chane de caractres. Exercice ${exercice.id} ${exercice.uuid}`,\n      { style },\n    )\n  }\n  if (style.includes('blocCenter')) blocCenter = true\n  const dataKeyboard = buildDataKeyboardString(\n    typeof style === 'string' ? style : '',\n  )\n  const balise = type === 'mathlive' ? 'math-field' : 'input'\n  let html = `<label>${texteAvant}</label><${balise} data-keyboard=\"${dataKeyboard}\" ${espace ? 'data-space=\"true\"' : ''} ${placeholder ? `placeholder=\"${placeholder}\"` : ''} virtual-keyboard-mode=manual class=\"${style}\" id=\"champTexteEx${exercice.numeroExercice}Q${i}\"></${balise}>${texteApres ? `<span>${texteApres}</span>` : ''} <span id=\"resultatCheckEx${exercice.numeroExercice}Q${i}\"></span>`\n  if (blocCenter) {\n    html = `<div style='display: flex;justify-content: center; margin:5px;'>${html}<div>`\n  }\n  html += ajouteFeedback(exercice, i)\n  return html\n}\n\nexport function remplisLesBlancs(\n  exercice: Exercice,\n  question: number,\n  content: string,\n  classes = '',\n  blanc = '\\\\ldots',\n) {\n  let mfeValue = ''\n  let resteContent = content\n  while (resteContent) {\n    const chunks = /^(.*?)%\\{([^}]+)}(.*?)$/.exec(resteContent)\n    if (chunks) {\n      const [, start, n, end] = chunks\n      const name = n\n      if (name == null) throw Error(`Dfinition de ${name} manquante`)\n      mfeValue += start\n      if (exercice.interactif) {\n        mfeValue += `\\\\placeholder[${name}]{}`\n      } else {\n        mfeValue += blanc\n      }\n      resteContent = end ?? ''\n    } else {\n      mfeValue += resteContent\n      resteContent = ''\n    }\n  }\n  if (exercice.interactif && context.isHtml) {\n    const dataKeyboard = buildDataKeyboardString(classes)\n    let classe = ''\n    if (classes !== '') {\n      if (classes === 'fillInTheBlank' || classes === 'fillInTheBlanks')\n        classe = 'fillInTheBlanks'\n      else\n        classe = [\n          'fillInTheBlanks',\n          ...classes\n            .split(' ')\n            .filter(\n              (el) => el !== 'fillInTheBlank' && el !== 'fillInTheBlanks',\n            ),\n        ].join(' ')\n    } else {\n      classe = 'fillInTheBlanks'\n    }\n    return `<math-field data-keyboard=\"${dataKeyboard}\" virtual-keyboard-mode=manual readonly class=\"${classe}\" id=\"champTexteEx${exercice.numeroExercice}Q${question}\">${mfeValue}</math-field><span id=\"resultatCheckEx${exercice.numeroExercice}Q${question}\"></span>${ajouteFeedback(exercice, question)}`\n  }\n  if (mfeValue === '') return ''\n  return `$${mfeValue}$`\n}\n","// =========================================================================\n//\n//    Dclaration des types pour les dates dclares en chane de caractres\n//    source: https://gist.github.com/aperkaz/580e72b98eba5afac30549387562655d\n//\n// =========================================================================\ntype oneToNine = 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9\ntype zeroToNine = 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9\n/**\n * Years\n */\nexport const YEARS = [...Array(199).keys()].map((x) => (x + 1900).toString())\nexport const MONTHS = [\n  'janvier',\n  'fvrier',\n  'mars',\n  'avril',\n  'mai',\n  'juin',\n  'juillet',\n  'aot',\n  'septembre',\n  'octobre',\n  'novembre',\n  'dcembre',\n]\ntype YYYY = `19${zeroToNine}${zeroToNine}` | `20${zeroToNine}${zeroToNine}`\nexport const isYYYYType = (obj: any): obj is YYYY =>\n  obj !== null &&\n  typeof obj !== 'undefined' &&\n  typeof obj === 'string' &&\n  YEARS.includes(obj)\n/**\n * Months\n */\ntype MM = `0${oneToNine}` | `1${0 | 1 | 2}`\n/**\n * Days\n */\ntype DD = `${0}${oneToNine}` | `${1 | 2}${zeroToNine}` | `3${0 | 1}`\n/**\n * YYYYMMDD ou DD/MM/YYYY\n */\nexport type RawDateString = `${YYYY}${MM}${DD}`\nexport type FrenchDateString = `${DD}/${MM}/${YYYY}`\n/**\n * Indique s'il s'est coul strictement moins d'un mois depuis\n * une date passe en paramtre\n * @param {FrenchDateString} dateString date au format franais (par exemple : `23/02/2011`)\n * @remark La date passe entre paramtre doit tre comprise entre `01/01/1900` et `31/12/2099`\n * @returns {boolean} `true` si moins d'un mois s'est coul depuis la date jusqu' l'appel de la fonction\n */\nexport function isLessThan1Month(\n  dateString: FrenchDateString | undefined,\n): boolean {\n  if (dateString === undefined) return false\n  const [jour, mois, annee] = dateString.split('/')\n  const date = new Date(parseInt(annee), parseInt(mois) - 1, parseInt(jour))\n  const elapsedTime = Date.now() - date.getTime()\n  const unMois = 3600 * 24 * 30 * 1000\n  return elapsedTime < unMois\n}\n","/**\n * Transforme un objet en arbre bas sur un type Map.\n * Chaque proprit devient une cl et la valeur correspondante devient :\n * - soit une valeur si la valeur de la proprit est un tableau\n * - soit une autre map dans le cas contraire\n * @param {any} obj\n * @return {Map} l'arbre correspondant  l'objet\n * @author sylvain Chambon\n */\nexport function toMap(obj) {\n  const dico = new Map()\n  for (const cle of Object.keys(obj)) {\n    if (obj[cle] instanceof Object) {\n      if (obj[cle] instanceof Array) {\n        dico.set(cle, obj[cle])\n      } else {\n        dico.set(cle, toMap(obj[cle]))\n      }\n    } else {\n      dico.set(cle, obj[cle])\n    }\n  }\n  return dico\n}\n","import codeListForLevels from '../../json/codeToLevelList.json'\nimport codeListForThemes from '../../json/codeToThemeList.json'\nimport referentielsActivation from '../../json/referentielsActivation.json'\nimport { isLessThan1Month } from '../types/dates'\nimport {\n    type JSONReferentielEnding,\n    type JSONReferentielObject,\n    type ResourceAndItsPath,\n    isExerciceItemInReferentiel,\n    isJSONReferentielEnding,\n} from '../types/referentiels'\nimport { toMap } from './toMap'\n\n/**\n * Rcuprer la liste des exercices rcents !\n * @param {JSONReferentielObject} refObj le rfrentiel  inspecter\n * @returns {ResourceAndItsPath[]} un tableau de tous les exercices ayant une date de modification/publication infrieure  un mois\n * @author sylvain\n */\nexport function getRecentExercices(\n  refObj: JSONReferentielObject,\n): ResourceAndItsPath[] {\n  return findResourcesAndPaths(refObj, (e: JSONReferentielEnding) => {\n    if (isExerciceItemInReferentiel(e)) {\n      if (\n        (e.datePublication && isLessThan1Month(e.datePublication)) ||\n        (e.dateModification && isLessThan1Month(e.dateModification))\n      ) {\n        return true\n      } else {\n        return false\n      }\n    } else {\n      return false\n    }\n  })\n}\n\n/**\n * Rcuprer la liste de TOUS exercices.\n * @param {JSONReferentielObject} refObj le rfrentiel  rcuprer\n * @returns {ResourceAndItsPath[]} un tableau de tous les exercices (terminaisons) avec leur chemin\n * @author sylvain\n */\nexport function getAllEndings(\n  refObj: JSONReferentielObject,\n): ResourceAndItsPath[] {\n  return findResourcesAndPaths(refObj, () => true)\n}\n\n/**\n * Retrouve le titre d'un niveau bas sur son code\n *\n * #### Exemple de code\n * `levelCode` : \"6e\" --> Traduction: \"Sixime\"\n * @param {string} levelCode code du niveau\n * @author sylvain\n */\nexport function codeToLevelTitle(levelCode: string): string {\n  const listeNiveaux: { [key: string]: string } = codeListForLevels\n  const listeThemes: { [key: string]: string } = codeListForThemes\n  if (listeNiveaux[levelCode]) {\n    // une traduction du code est trouve dans la liste des niveaux\n    return listeNiveaux[levelCode]\n  } else if (listeThemes[levelCode]) {\n    // une traduction du code est trouve dans la liste des niveaux\n    return listeThemes[levelCode]\n  } else {\n    // pas d'entre trouve : on retourne le code\n    return levelCode\n  }\n}\n\n/**\n * Parcourt toutes les branches d'un rfrentiel pass en paramtre\n * et remplit une liste (passe en paramtre) avec les extrmits\n * qui passent le test d'une fonction passe en paramtre\n * @param {JSONReferentielObject} referentiel le rfrentiel  parcourir\n * @param {JSONReferentielEnding[]} harvest la liste stockant la rcolte\n * @param {function(e: JSONReferentielEnding):boolean} goalReachedWith fonction de triage\n * @author sylvain\n * @example\n * ```ts\n * fetchThrough(ref, results, (e: JSONReferentielEnding) => {\n    if (isExerciceItemInReferentiel(e)) {\n      return true\n    } else {\n      return false\n    }\n * ```\n */\nexport function fetchThrough(\n  referentiel: JSONReferentielObject,\n  harvest: JSONReferentielEnding[],\n  goalReachedWith: (e: JSONReferentielEnding) => boolean,\n): void {\n  Object.values(referentiel).forEach((value) => {\n    if (isJSONReferentielEnding(value)) {\n      if (goalReachedWith(value)) {\n        harvest.push(value)\n      }\n    } else {\n      fetchThrough(value as JSONReferentielObject, harvest, goalReachedWith)\n    }\n  })\n}\n\n/**\n * Parcourt un rfrentiel jusqu' ses extrmits et en garde la trace\n * avec son chemin lorsque cette extrmit remplie les conditions fixes\n * par la fonction passe en paramtre\n * @param {JSONReferentielObject} referentiel Le rfrentiel  chercher\n * @param {(e: JSONReferentielEnding) => boolean} goalReachedWith la fonction de filtrage\n * @returns {ResourceAndItsPath[]} Une liste d'objets du type\n * `{resource: JSONReferentielEnding,  pathToResource: string[]}`\n * @author sylvain\n */\nexport function findResourcesAndPaths(\n  referentiel: JSONReferentielObject,\n  goalReachedWith: (e: JSONReferentielEnding) => boolean,\n): ResourceAndItsPath[] {\n  const harvest: ResourceAndItsPath[] = []\n  const path: string[] = []\n  function find(ref: JSONReferentielObject) {\n    Object.entries(ref).forEach(([key, value]) => {\n      if (isJSONReferentielEnding(value)) {\n        if (goalReachedWith(value)) {\n          path.push(key)\n          harvest.push({ resource: value, pathToResource: [...path] })\n          path.pop()\n        }\n      } else {\n        path.push(key)\n        find(value as JSONReferentielObject)\n        path.pop()\n      }\n    })\n  }\n  find(referentiel)\n  return harvest\n}\n\n/**\n * Recherche une ressource dans un rfrentiel donn correspondant  une uuid\n * passe en paramtre\n * @param referentiel le rfrentiel dans lequel on cherche l'uuid\n * @param targetUuid l'uuid  rechercher\n * @returns la terminaison si une seule uuid matche, `null` si pas de match\n * @throws erreur si l'uuid est retrouve plus d'une fois\n * @author sylvain\n */\nexport function retrieveResourceFromUuid(\n  referentiel: JSONReferentielObject,\n  targetUuid: string,\n): JSONReferentielEnding | null {\n  const harvest: JSONReferentielEnding[] = []\n  fetchThrough(\n    referentiel,\n    harvest,\n    (resource: JSONReferentielEnding) => resource.uuid === targetUuid,\n  )\n  switch (harvest.length) {\n    case 0:\n      return null\n    case 1:\n      return harvest[0]\n    default:\n      return harvest[0]\n    // throw new Error(\n    //   `${targetUuid} est prsente ${harvest.length} fois dans le rfrentiel !!!`\n    // )\n  }\n}\n\n/**\n *  partir d'un objet de type `ResourceAndItsPath`, construit l'objet imbriqu correspondant\n * @param item Un objet constitu de la liste des nuds et de la terminaison\n * @returns un objet aux entres imbriques correspondant  une branche + une terminaison\n * @author sylvain\n */\nfunction pathToObject(item: ResourceAndItsPath): JSONReferentielObject {\n  return item.pathToResource.reduceRight(\n    (value, key) => ({ [key]: value }),\n    (<unknown>item.resource) as JSONReferentielObject,\n  )\n}\n\n/**\n * Construit  partir d'une liste d'objet de type `ResourceAndItsPath`\n * la liste des objets imbriqus (branche+terminaison) correspondants\n * @param {ResourceAndItsPath[]} items la liste des objets  transformer\n * @returns {JSONReferentielObject[]} la liste des objets transforms\n * @author sylvain\n */\nfunction pathsToObjectsArray(\n  items: ResourceAndItsPath[],\n): JSONReferentielObject[] {\n  const result: JSONReferentielObject[] = []\n  for (const item of items) {\n    result.push(pathToObject(item))\n  }\n  return result\n}\n\n/**\n * Fabrique de zro un rfrentiels sur la base d'entres constitues d'un chemin d'accs\n * et d'une terminaison `{resource: JSONReferentielEnding,  pathToResource: string[]}`\n * @param {ResourceAndItsPath[]} refList la liste des entres pour constituer le rfrentiel\n * @returns {JSONReferentielObject} un rfrentiel sous forme d'objet\n * @author sylvain\n */\nexport function buildReferentiel(\n  refList: ResourceAndItsPath[],\n): JSONReferentielObject {\n  return pathsToObjectsArray(refList).reduce((prev, current) => {\n    return mergeReferentielObjects(prev, current)\n  }, {})\n}\n\n/**\n * Fusionne des objets rfrentiels sans craser les entres prcdentes\n * @param {JSONReferentielObject[]} objects les objets  fusionner\n * @returns {JSONReferentielObject} un rfrentiel\n * @see https://tutorial.eyehunts.com/js/javascript-merge-objects-without-overwriting-example-code/\n * @author sylvain\n */\nexport function mergeReferentielObjects(\n  ...objects: JSONReferentielObject[]\n): JSONReferentielObject {\n  const isObject = (obj: unknown) => obj && typeof obj === 'object'\n  return objects.reduce((prev, obj) => {\n    Object.keys(obj).forEach((key) => {\n      const pVal = prev[key]\n      const oVal = obj[key]\n      if (Array.isArray(pVal) && Array.isArray(oVal)) {\n        prev[key] = pVal.concat(...oVal)\n      } else if (isObject(pVal) && isObject(oVal)) {\n        prev[key] = mergeReferentielObjects(pVal, oVal)\n      } else {\n        prev[key] = oVal\n      }\n    })\n\n    return prev\n  }, {})\n}\n\n/**\n * Consulte le fichier `src/json/referentielsActivation.json`\n * et retourne la valeur d'activation `true`/`false` indiqu pour un nom de rfrentiel donn.\n * @param refName nom du rfrentiel (conformment au type `ReferentielNames` dans `src/lib/types.ts`)\n * @returns la valeur mentionne dans `src/json/referentielsActivation.json` <br/> `false` si le nom du rfrentiel n'exoiste pas.\n * @author sylvain\n */\nexport function isReferentielActivated(refName: string): boolean {\n  const referentielList = toMap({ ...referentielsActivation })\n  if (referentielList.has(refName)) {\n    return referentielList.get(refName) === 'true'\n  } else {\n    console.warn(refName + ' is not a valid referentiel name !')\n    return false\n  }\n}\n","import seedrandom from 'seedrandom'\nimport { get } from 'svelte/store'\nimport type TypeExercice from '../../exercices/Exercice'\nimport Exercice from '../../exercices/Exercice'\nimport referentielStaticCH from '../../json/referentielStaticCH.json'\nimport referentielStaticFR from '../../json/referentielStaticFR.json'\nimport uuidToUrl from '../../json/uuidsToUrlFR.json'\nimport { retrieveResourceFromUuid } from '../../lib/components/refUtils'\nimport {\n  isStaticType,\n  type JSONReferentielObject,\n} from '../../lib/types/referentiels'\nimport {\n  mathaleaFormatExercice,\n  mathaleaHandleExerciceSimple,\n  mathaleaHandleParamOfOneExercice,\n  mathaleaLoadExerciceFromUuid,\n} from '../mathalea'\nimport { exercicesParams, globalOptions } from '../stores/generalStore'\n\nconst allStaticReferentiels: JSONReferentielObject = {\n  ...referentielStaticFR,\n  ...referentielStaticCH,\n}\n\n// on supprime les entres par thme qui entrane des doublons\ndelete allStaticReferentiels['BrevetTags']\ndelete allStaticReferentiels['EVACOMTags']\ndelete allStaticReferentiels['E3CTags']\ndelete allStaticReferentiels['crpeTags']\n\n/**\n * Construit la liste des exercices base sur le contenu du store exercicesParams\n * @returns liste des exercices EN PROMESSE\n */\nexport const buildExercisesList = (\n  filter: string[] = [],\n): Promise<TypeExercice>[] => {\n  const promiseExos: Promise<TypeExercice>[] = []\n  const options = get(globalOptions)\n  const exosParams = get(exercicesParams)\n  for (const paramsExercice of exosParams) {\n    if (filter.length > 0 && !filter.includes(paramsExercice.uuid)) {\n      continue\n    }\n    if (isStatic(paramsExercice.uuid)) {\n      const p = new Promise<TypeExercice>((resolve) => {\n        // console.log('id' + paramsExercice.id)\n        const exo = new Exercice()\n        exo.titre = `Uuid ${paramsExercice.uuid}`\n        exo.listeQuestions[0] = `Uuid ${paramsExercice.uuid}<br>`\n        exo.listeCorrections[0] = `Uuid ${paramsExercice.uuid}<br>`\n        exo.nbQuestions = 1\n        const foundResource = retrieveResourceFromUuid(\n          allStaticReferentiels,\n          paramsExercice.uuid,\n        )\n        if (isStaticType(foundResource)) {\n          exo.listeQuestions[0] =\n            exo.listeQuestions[0] +\n            `<br>\n          <img src=\"${foundResource.png || ''}\" style=\"width: calc(100% * {zoomFactor}\" alt=\"nonc\" />`\n          exo.listeCorrections[0] =\n            exo.listeCorrections[0] +\n            `<br>\n          <img src=\"${foundResource.pngCor || ''}\" style=\"width: calc(100% * {zoomFactor}\" alt=\"correction\" />`\n        }\n        mathaleaHandleParamOfOneExercice(exo, paramsExercice)\n        if (options.setInteractive === '1' && exo?.interactifReady) {\n          exo.interactif = true\n        }\n        resolve(exo)\n        // console.log('id resolu' + paramsExercice.id)\n      })\n      promiseExos.push(p)\n    } else {\n      const p = new Promise<TypeExercice>((resolve) => {\n        // console.log('id' + paramsExercice.id)\n        mathaleaLoadExerciceFromUuid(paramsExercice.uuid).then((exo) => {\n          if (typeof exo === 'undefined') {\n            throw new Error(\n              \"L'exercice correspondant  l'uuid \" +\n                paramsExercice.uuid +\n                \" n'est pas dfini...\",\n            )\n          }\n          mathaleaHandleParamOfOneExercice(exo, paramsExercice)\n          if (options.setInteractive === '1' && exo?.interactifReady) {\n            exo.interactif = true\n          }\n          resolve(exo)\n        })\n        // console.log('id resolu' + paramsExercice.id)\n      })\n      promiseExos.push(p)\n    }\n  }\n  return promiseExos\n}\n\n/**\n * Dtermine si l'uuid a un prfixe d'exercice statique\n * @param uuid\n * @returns boolean\n */\nexport function isStatic(uuid: string | undefined) {\n  if (uuid === undefined) {\n    return false\n  }\n  return (\n    uuid.startsWith('crpe') ||\n    uuid.startsWith('dnb_') ||\n    uuid.startsWith('dnbpro_') ||\n    uuid.startsWith('e3c_') ||\n    uuid.startsWith('bac_') ||\n    uuid.startsWith('sti2d_') ||\n    uuid.startsWith('evacom_') ||\n    uuid.startsWith('eam_') ||\n    uuid.startsWith('stl_') ||\n    uuid.startsWith('sti2d_') ||\n    uuid.startsWith('2nd_')\n  )\n}\n\nexport function isSvelte(uuid: string) {\n  const urlExercice = uuidToUrl[uuid as keyof typeof uuidToUrl]\n  return urlExercice && urlExercice.includes('.svelte')\n}\n\nexport const splitExercisesIntoQuestions = (\n  exercices: TypeExercice[],\n): {\n  questions: string[]\n  consignes: string[]\n  corrections: string[]\n  consignesCorrections: string[]\n  isCorrectionVisible: boolean[]\n  indiceExercice: number[]\n  indiceQuestionInExercice: number[]\n} => {\n  let questions: string[] = []\n  let consignes: string[] = []\n  let corrections: string[] = []\n  let consignesCorrections: string[] = []\n\n  const isCorrectionVisible: boolean[] = []\n  const indiceExercice: number[] = []\n  const indiceQuestionInExercice: number[] = []\n\n  for (const [k, exercice] of exercices.entries()) {\n    exercice.score = 0\n    exercice.numeroExercice = k\n    if (exercice.typeExercice === 'simple') {\n      mathaleaHandleExerciceSimple(exercice, exercice.interactif, k)\n    } else {\n      if (exercice.nouvelleVersionWrapper !== undefined) {\n        if (exercice.seed !== undefined) {\n          seedrandom(exercice.seed, { global: true })\n        }\n        exercice.nouvelleVersionWrapper(k)\n      }\n    }\n    isCorrectionVisible[k] = false\n    const cumulConsignesCorrections = []\n    if (exercice.listeQuestions === undefined) {\n      exercice.listeQuestions = []\n    }\n    if (exercice.listeCorrections === undefined) {\n      exercice.listeCorrections = []\n    }\n    for (let i = 0; i < exercice.listeQuestions.length; i++) {\n      consignes.push(\n        `${exercice?.consigne} ${exercice?.consigne && exercice?.introduction ? '<br>\\n' : ''} ${exercice?.introduction}`,\n      )\n      indiceExercice.push(k)\n      indiceQuestionInExercice.push(i)\n      if (exercice.consigneCorrection !== undefined) {\n        cumulConsignesCorrections.push(exercice.consigneCorrection)\n      }\n    }\n    questions = [...questions, ...exercice.listeQuestions]\n    corrections = [...corrections, ...exercice.listeCorrections]\n    consignesCorrections = [\n      ...consignesCorrections,\n      ...cumulConsignesCorrections,\n    ]\n    questions = questions.map(mathaleaFormatExercice)\n    corrections = corrections.map(mathaleaFormatExercice)\n    consignesCorrections = consignesCorrections.map(mathaleaFormatExercice)\n    consignes = consignes.map(mathaleaFormatExercice)\n  }\n\n  return {\n    questions,\n    consignes,\n    corrections,\n    consignesCorrections,\n    isCorrectionVisible,\n    indiceExercice,\n    indiceQuestionInExercice,\n  }\n}\n","/**\n * Calcule et attribue la taille (largeur et hauteur) des SVGs et adapte la position des `divLatex`  l'intrieur\n * du SVG. Le principe est le suivant : on rcupre la largeur du container parent (passe en paramtre)\n * et on calcule la largeur du SVG en multipliant la largeur du parent par le coefficient pass en paramtre.\n * Les ratioi sont calculs en fonction de ces deux largeurs pour la hauteur et les positions des divLatex.\n * @param parent container contenant la question CAN et des figures SVG ventuelles\n * @param coef coefficient de rduction par rapport  la larguer du parent (sert dans le calcul de la largeur)\n */\nexport const setSizeWithinSvgContainer = (parent: HTMLDivElement) => {\n  if (parent.classList.contains('hidden')) {\n    // si la question est cache, on ne fait rien\n    return\n  }\n\n  if (parent.firstElementChild === null) {\n    return\n  }\n\n  const originalClientWidth = parent.clientWidth\n  const originalClientHeight = parent.clientHeight\n\n  let zoom = 3 // parseFloat(fontSize) / 16\n  parent.style.fontSize = `${zoom}rem` // on remet zoom  3... au dpart\n\n  const svgContainers = parent.getElementsByClassName('svgContainer')\n\n  do {\n    if (svgContainers.length > 0) {\n      for (const svgContainer of svgContainers) {\n        svgContainer.classList.add('flex')\n        svgContainer.classList.add('justify-center')\n        updateFigures(svgContainer, zoom)\n      }\n    }\n    if (\n      parent.firstElementChild.scrollHeight > originalClientHeight ||\n      parent.firstElementChild.scrollWidth > originalClientWidth\n    ) {\n      zoom -= 0.2\n      if (zoom >= 1) parent.style.fontSize = `${zoom}rem`\n    }\n  } while (\n    zoom > 0.6 &&\n    (parent.firstElementChild.scrollHeight > originalClientHeight ||\n      parent.firstElementChild.scrollWidth > originalClientWidth)\n  )\n}\n// Pour les schmas en boite\n\nfunction resizeSchemaContainer(schemaContainer: HTMLElement, zoom: number) {\n  const originalWidth =\n    schemaContainer.dataset.originalWidth || schemaContainer.scrollWidth\n  const originalHeight =\n    schemaContainer.dataset.originalHeight || schemaContainer.scrollHeight\n\n  // Store the original dimensions if not already stored\n  if (!schemaContainer.dataset.originalWidth) {\n    schemaContainer.dataset.originalWidth = originalWidth.toString()\n  }\n  if (!schemaContainer.dataset.originalHeight) {\n    schemaContainer.dataset.originalHeight = originalHeight.toString()\n  }\n\n  // Apply the zoom\n  // schemaContainer.style.transform = `scale(${zoom})`\n  // schemaContainer.style.transformOrigin = 'top left'\n\n  schemaContainer.style.height = `${Math.round(parseFloat(String(originalHeight)) * zoom)}px`\n  schemaContainer.style.width = `${Math.round(parseFloat(String(originalWidth)) * zoom)}px`\n}\n\nexport function resizeContent(container: HTMLElement | null, zoom: number) {\n  const ZOOM_MIN = 0.2\n  if (!container) return\n  // mathalea2d\n  const svgContainers = container.getElementsByClassName('svgContainer') ?? []\n  for (const svgContainer of svgContainers) {\n    updateFigures(svgContainer, Math.max(zoom, ZOOM_MIN))\n  }\n  // Scratch\n  const scratchDivs = container.getElementsByClassName('scratchblocks')\n  for (const scratchDiv of scratchDivs) {\n    const svgDivs = scratchDiv.getElementsByTagName('svg')\n    resizeTags([...svgDivs], Math.max(zoom, ZOOM_MIN))\n  }\n  // Checkboxes des QCM\n  const checkboxes = container.querySelectorAll('input[type=\"checkbox\"]')\n  for (const checkbox of checkboxes) {\n    if (checkbox instanceof HTMLInputElement) {\n      resizeTags([checkbox], Math.max(zoom, ZOOM_MIN))\n    }\n  }\n  // Schmas en boite\n  const schemaContainers =\n    container.getElementsByClassName('SchemaContainer') ?? []\n  for (const schemaContainer of schemaContainers) {\n    resizeSchemaContainer(\n      schemaContainer as HTMLElement,\n      Math.max(zoom, ZOOM_MIN),\n    )\n  }\n  // Texte\n  container.style.fontSize = `${Math.max(zoom, ZOOM_MIN)}rem`\n}\n\nexport function updateFigures(svgContainer: Element, zoom: number) {\n  const svgDivs = svgContainer.querySelectorAll<SVGElement>('.mathalea2d')\n  for (const svgDiv of svgDivs) {\n    if (svgDiv instanceof SVGElement) {\n      const figure = svgDiv\n      const width = figure.getAttribute('width')\n      const height = figure.getAttribute('height')\n      if (!figure.dataset.widthInitiale && width != null)\n        figure.dataset.widthInitiale = width\n      if (!figure.dataset.heightInitiale && height != null)\n        figure.dataset.heightInitiale = height\n      const newHeight = (\n        Number(figure.dataset.heightInitiale) * zoom\n      ).toString()\n      const newWidth = (Number(figure.dataset.widthInitiale) * zoom).toString()\n      if (newHeight !== height) {\n        figure.setAttribute(\n          'height',\n          (Number(figure.dataset.heightInitiale) * zoom).toString(),\n        )\n      }\n      if (newWidth !== width) {\n        figure.setAttribute(\n          'width',\n          (Number(figure.dataset.widthInitiale) * zoom).toString(),\n        )\n      }\n\n      // accorder la position des lments dans la figure SVG\n      const eltsInVariationTables =\n        svgContainer.getElementsByClassName('divLatex') ?? []\n      for (const elt of eltsInVariationTables) {\n        const e = elt as HTMLDivElement\n        if (!e.dataset.top) e.dataset.top = e.style.top.replace('px', '')\n        if (!e.dataset.left) e.dataset.left = e.style.left.replace('px', '')\n        const initialTop = Number(e.dataset.top)\n        const initialLeft = Number(e.dataset.left)\n        e.style.setProperty('top', (initialTop * zoom).toString() + 'px')\n        e.style.setProperty('left', (initialLeft * zoom).toString() + 'px')\n      }\n    }\n  }\n}\n\n/**\n * Change la taille de tous les divs passs en paramtres.\n *\n * On teste l'existence des attributs directs `width` et`height`.\n *\n * - S'ils existent, on sauvegarde leurs valeurs initiales dans le data-set (si besoin)\n *  et on applique le facteur d'chelle\n * - S'ils n'existent pas, on travaillent avec le style directement\n * (`width` et `height` peuvent avoir des units diffrentes).\n * @param {HTMLOrSVGElement[]} tags Liste des divs  inspecter et changer\n * @param {number} factor facteur d'agrandissement par rapport  la taille initiale\n */\nexport const resizeTags = (\n  tags: HTMLElement[] | SVGElement[],\n  factor: number = 1,\n) => {\n  let widthUnit, heightUnit: string\n  for (const tag of tags) {\n    const widthAttributeExists: boolean = tag.hasAttribute('width')\n    const heightAttributeExists: boolean = tag.hasAttribute('height')\n    if (tag.hasAttribute('data-width') === false) {\n      let originalWidth: string | null\n      if (widthAttributeExists) {\n        originalWidth = tag.getAttribute('width')\n      } else {\n        const width = tag.style.width\n        const units = width.match(/\\D/g) ?? []\n        widthUnit = units.join('')\n        originalWidth = String(\n          parseFloat(tag.style.width.replace(widthUnit, '')),\n        )\n      }\n      tag.dataset.width = originalWidth ?? '50'\n    }\n    if (\n      !widthAttributeExists &&\n      tag.hasAttribute('data-width-unit') === false\n    ) {\n      tag.dataset.widthUnit = widthUnit\n    }\n    if (tag.hasAttribute('data-height') === false) {\n      let originalHeight: string | null\n      if (heightAttributeExists) {\n        originalHeight = tag.getAttribute('height')\n        heightUnit = 'px'\n      } else {\n        const height = tag.style.height\n        const units = height.match(/\\D/g) ?? []\n        heightUnit = units.join('')\n        originalHeight = String(\n          parseFloat(tag.style.height.replace(heightUnit, '')),\n        )\n      }\n      tag.dataset.height = originalHeight ?? '30'\n    } else {\n      heightUnit = 'px'\n    }\n\n    if (\n      !heightAttributeExists &&\n      tag.hasAttribute('data-height-unit') === false\n    ) {\n      tag.dataset.heightUnit = heightUnit\n    }\n    const w = Number(tag.getAttribute('data-width')) * factor\n    const h = Number(tag.getAttribute('data-height')) * factor\n    if (widthAttributeExists && heightAttributeExists) {\n      tag.setAttribute('width', String(w))\n      tag.setAttribute('height', String(h))\n    } else {\n      tag.setAttribute(\n        'style',\n        'width:' +\n          String(w) +\n          tag.dataset.widthUnit +\n          '; height:' +\n          String(h) +\n          tag.dataset.heightUnit +\n          ';',\n      )\n    }\n  }\n}\n\nexport const updateIframeSize = (\n  container: HTMLDivElement,\n  iframe: HTMLIFrameElement,\n) => {\n  if (container.offsetWidth !== 0) {\n    iframe.setAttribute('width', '100%')\n    iframe.setAttribute('height', iframe.offsetWidth * 0.75 + '')\n  }\n}\n","/**\n * Retourne une chane formatte pour afficher une dure en (XXh XXmin XXs)\n * @param {number} nbOfSeconds dure en secondes\n * @return {string} dure en h min s\n */\nexport function formattedTimeStamp(nbOfSeconds: number): string {\n  const nbOfHours = Math.floor(nbOfSeconds / 3600)\n  const nbOfMinutes = Math.floor((nbOfSeconds - nbOfHours * 3600) / 60)\n  const nbOfSecondsLeft = nbOfSeconds - nbOfHours * 3600 - nbOfMinutes * 60\n  if (nbOfHours > 0) {\n    return `${nbOfHours}h ${nbOfMinutes}min ${nbOfSecondsLeft}s`\n  } else {\n    if (nbOfMinutes > 0) {\n      if (nbOfSecondsLeft === 0) {\n        return `${nbOfMinutes}min`\n      } else {\n        return `${nbOfMinutes}min ${nbOfSecondsLeft}s`\n      }\n    } else {\n      return `${nbOfSecondsLeft}s`\n    }\n  }\n}\n\n/**\n * Gestion du message dans le modal de rglage de la dure de projection\n * @param duree valeur de la dure en secondes retourne par le curseur\n */\nexport function setPhraseDuree(duree: number) {\n  if (duree >= 2) return duree + ' secondes'\n  else if (duree === 0) return 'Dfilement manuel'\n  else return duree + ' seconde'\n}\n\n/**\n * Fabriquer une chane de caractres unique base sur un time stamp.\n * @param {string} prefix Prfixe  ajouter devant la chane de caractres unique (vide par dfaut)\n * @returns {string} La chane de caractre unique\n * @author sylvain\n */\nexport function getUniqueStringBasedOnTimeStamp(prefix: string = '') {\n  // /!\\ ATTENTION new Date().getTime() est en ms et n'est pas assez prcis pour donner des chanes uniques\n  // Mais utiliser Math.random peut interfrer avec d'autres usages de Math.random dans l'application et gner la gnration de valeurs alatoires reproductibles\n  const timeStamp = String(new Date().getTime())\n  // const timeStamp = String(\n  //   performance.now().toString().replace('.', '') + Math.random(),\n  // ).replace('.', '')\n  return `${prefix}${timeStamp}`\n}\n\n/**\n * Permet de retarder l'appel d'une fonction. Utiliser pour les frappes au clavier par exemple\n * pour ne pas activer la recherche immdiatement aprs qu'un caractre ait t saisi.\n * @see https://stackoverflow.com/a/72207078/6625987\n * @param callback fonction  appeler lorsque le dlai est pass\n * @param delay dlais (en millisecondes)\n * @param immediate flag pour court-circuiter le dlai\n * @returns {void}\n */\nexport function debounce<T extends (...args: any[]) => void>(\n  callback: T,\n  delay: number = 20,\n  immediate: boolean = false,\n) {\n  let timeout: ReturnType<typeof setTimeout> | null\n\n  return function <U>(this: U, ...args: Parameters<typeof callback>) {\n    const later = () => {\n      timeout = null\n\n      if (!immediate) {\n        callback.apply(this, args)\n      }\n    }\n    const callNow = immediate && !timeout\n\n    if (typeof timeout === 'number') {\n      clearTimeout(timeout)\n    }\n\n    timeout = setTimeout(later, delay)\n\n    if (callNow) {\n      callback.apply(this, args)\n    }\n  }\n}\n\n/**\n * Compte  rebours\n * @param time {number} le temps  dcompter en ms\n * @returns promise\n */\nexport function delay(time: number) {\n  return new Promise((resolve) => setTimeout(resolve, time))\n}\n\n/**\n * Calcule le nombre de minnutes et de secondes dans une dure donne en millisecondes\n * et renvoie ces deux nombres dans un objet.\n * @param milliseconds dure en millisecondes\n * @returns un objet constitu du nombre de minutes et du nombre de secondes\n */\nexport function millisecondToMinSec(milliseconds: number): {\n  minutes: number\n  seconds: number\n} {\n  const seconds = Math.floor((milliseconds / 1000) % 60)\n  const minutes = Math.floor((milliseconds / 1000 / 60) % 60)\n  return { minutes, seconds }\n}\n","import type { Activity, InterfaceResultExercice } from '../lib/types'\nimport {\n  capytaleMode,\n  capytaleStudentAssignment,\n  exercicesParams,\n  globalOptions,\n  resultsByExercice,\n} from './stores/generalStore'\nimport {\n  mathaleaGoToView,\n  mathaleaWriteStudentPreviousAnswers,\n} from './mathalea'\nimport { get } from 'svelte/store'\nimport { RPC } from '@mixer/postmessage-rpc'\nimport { canOptions as canOptionsStore } from './stores/canStore'\nimport type { CanState } from './types/can'\n\ninterface AssignmentData {\n  duration?: number\n  resultsByQuestion?: boolean[]\n}\n\ninterface ActivityParams {\n  mode: 'create' | 'assignment' | 'review' | 'view'\n  activity: Activity\n  workflow: 'current' | 'finished' | 'corrected'\n  studentAssignment: InterfaceResultExercice[]\n  assignmentData: AssignmentData\n}\n\nconst serviceId = 'capytale-player'\n\n// Gestion des postMessage avec Capytale\nconst rpc = new RPC({\n  target: window.parent,\n  serviceId,\n  origin: '*',\n})\n\n// On copie les rponses pour que la vue CAN puisse les utiliser\nexport let answersFromCapytale: InterfaceResultExercice[] = []\nexport let assignmentDataFromCapytale: AssignmentData = {}\n\n// timer pour ne pas lancer hasChanged trop souvent\nlet timerId: ReturnType<typeof setTimeout> | undefined\nlet firstTime = true\nlet currentMode: 'create' | 'assignment' | 'review' | 'view'\n\n/**\n * Fonction pour recevoir les paramtres des exercices depuis Capytale\n */\nasync function toolSetActivityParams({\n  mode,\n  activity,\n  workflow,\n  studentAssignment,\n  assignmentData,\n}: ActivityParams) {\n  assignmentDataFromCapytale = assignmentData\n  // On garde dans le store ce qui tait en base de donnes chez Capytale pour pouvoir le renvoyer avec la modification d'un seul exercice\n  capytaleStudentAssignment.set(studentAssignment)\n  // mode : create (le prof cr sa sance), assignment (l'lve voit sa copie), review (le prof voit la copie d'un lve), view (le prof voit la sance d'un collgue dans la bibliothque et pourra la cloner)\n  // workflow : current (la copie n'a pas encore t rendue), finished (la copie a t rendue), corrected (la copie a t anote par l'enseignant)\n  // On rcupre les paramtres de l'activit\n  currentMode = mode\n  capytaleMode.set(mode)\n  const canOptions = get(canOptionsStore)\n  if (activity === null || activity === undefined) return\n  const [newExercicesParams, newGlobalOptions, newCanOptions] = [\n    activity.exercicesParams,\n    activity.globalOptions,\n    activity.canOptions,\n  ]\n  // On met  jour les paramtres des exercices\n  exercicesParams.update((l) => {\n    Object.assign(l, newExercicesParams)\n    return l\n  })\n  // On met  jour les paramtres globaux\n  globalOptions.update((l) => {\n    Object.assign(l, newGlobalOptions)\n    return l\n  })\n\n  if (newCanOptions === null || newCanOptions === undefined) {\n    window.notify('Aucun paramtre CAN trouv', {\n      mode,\n      activity,\n      workflow,\n      studentAssignment,\n      assignmentData,\n    })\n  }\n  canOptionsStore.update((l) => {\n    if (newCanOptions) newCanOptions.state = 'canHomeScreen'\n    Object.assign(l, newCanOptions)\n    l.state = 'canHomeScreen'\n    l.isInteractive = newGlobalOptions.setInteractive === '1'\n    return l\n  })\n  // On charge l'ala qui a pu tre modifi par l'lve\n  if (studentAssignment !== null && studentAssignment !== undefined) {\n    for (const exercice of studentAssignment) {\n      if (\n        exercice != null &&\n        exercice.alea != null &&\n        exercice.indice != null\n      ) {\n        exercicesParams.update((l) => {\n          if (Array.isArray(l)) {\n            l[exercice.indice as number].alea = exercice.alea\n            l[exercice.indice as number].bestScore = exercice.bestScore\n          }\n          return l\n        })\n      }\n    }\n  }\n  if (mode !== 'create') {\n    // Vue lve\n    if (newCanOptions?.isChoosen) {\n      mathaleaGoToView('can')\n      globalOptions.update((l) => {\n        l.v = 'can'\n        return l\n      })\n    } else {\n      mathaleaGoToView('eleve')\n      globalOptions.update((l) => {\n        l.v = 'eleve'\n        return l\n      })\n    }\n  }\n  if (mode === 'assignment') {\n    // Si la copie a dj t rendue, on ne peut plus modifier les rponses\n    if (workflow !== 'current') {\n      globalOptions.update((l) => {\n        l.done = '1'\n        return l\n      })\n    }\n    // En vue CAN, on efface la graine pour que l'lve ne recommence pas le mme exercice\n    if (\n      newCanOptions?.isChoosen &&\n      (newGlobalOptions.isDataRandom === undefined ||\n        newGlobalOptions.isDataRandom === true)\n    ) {\n      exercicesParams.update((l) => {\n        for (const param of l) {\n          if (param.alea !== undefined) {\n            param.alea = undefined\n          }\n        }\n        return l\n      })\n    }\n  } else if (mode === 'review') {\n    // Mettre le done  true pour que l'on ne puisse plus modifier les rponses\n    globalOptions.update((l) => {\n      l.done = '1'\n      return l\n    })\n  }\n  await new Promise((resolve) => setTimeout(resolve, 500))\n  if (studentAssignment != null) {\n    answersFromCapytale = studentAssignment\n    console.info('Rponses  charger', studentAssignment)\n    if (!newCanOptions?.isChoosen) {\n      // On charge les rponses de l'lve (si ce n'est pas la CAN)\n      for (const exercice of studentAssignment) {\n        if (exercice == null) continue\n        if (exercice != null && exercice.answers != null) {\n          if (exercice.type === 'app') {\n            // On prvient les apps avec un message\n            if (exercice != null) {\n              const message = {\n                type: 'mathaleaHasScore',\n                score: exercice?.numberOfPoints,\n                numeroExercice: exercice?.indice,\n                numberOfQuestions: exercice?.numberOfQuestions,\n                finalState: exercice?.answers,\n              }\n              window.postMessage(message, '*')\n            }\n          } else {\n            const starttime = window.performance.now()\n            await Promise.all(\n              mathaleaWriteStudentPreviousAnswers(exercice.answers),\n            )\n            const time = window.performance.now()\n          }\n        }\n      }\n    }\n    await new Promise((resolve) => setTimeout(resolve, 500))\n    // On attend 500 ms pour que les champs texte soient bien remplis\n    if (!canOptions.isChoosen) {\n      console.info(\n        'Maintenant que les rponses sont charges, clic sur les boutons score',\n        studentAssignment,\n      )\n      for (const exercice of studentAssignment) {\n        if (exercice == null) continue\n        // Pour les exercices MathALEA, on clique sur le bouton pour recalculer le score\n        const buttonScore = document.querySelector(\n          `#buttonScoreEx${exercice?.indice}`,\n        ) as HTMLButtonElement\n        if (buttonScore !== null) {\n          // On note dans le bouton que ce sont les rponses sauvegardes et pas de nouvelles rponses de l'lve\n          // Cela vite, en cas de problme de chargement, d'effacer les rponses de l'lve\n          buttonScore.dataset.capytaleLoadAnswers = '1'\n          buttonScore.click()\n        } else {\n          console.info(\n            `Bouton score #buttonScoreEx${exercice.indice} non trouv`,\n          )\n        }\n      }\n    }\n  }\n\n  // Gestion du state de la CAN\n  if (canOptions.isChoosen) {\n    if (canOptions.state !== 'canHomeScreen') return\n    let newState: CanState = 'start'\n    if (mode === 'review') {\n      // Un prof regarde une copie\n      newState = 'solutions'\n    }\n    if (mode === 'assignment' && studentAssignment != null) {\n      // Un lve fait une copie mais a dj t valu\n      if (workflow === 'current') {\n        newState = get(globalOptions).oneShot ? 'canHomeScreen' : 'start'\n      } else {\n        newState = canOptions.solutionsAccess ? 'solutions' : 'canHomeScreen'\n      }\n    }\n    if (newState !== 'canHomeScreen') {\n      canOptionsStore.update((l) => {\n        l.state = newState\n        l.solutionsMode = 'gathered' // Faut-il en faire une option par dfaut ?\n        return l\n      })\n    }\n  }\n}\n\nexport async function sendToCapytaleMathaleaHasChanged() {\n  if (firstTime) {\n    // attendre 1 seconde\n    await new Promise((resolve) => setTimeout(resolve, 1000))\n    firstTime = false\n    return\n  }\n  // On ne prvient Capytale qu'une fois toutes les demi-secondes\n  if (timerId === undefined) {\n    timerId = setTimeout(() => {\n      rpc.call('hasChanged', {})\n      timerId = undefined\n    }, 500)\n  }\n}\n\nexport function sendToCapytaleSaveStudentAssignment({\n  indiceExercice,\n  assignmentData,\n}: {\n  indiceExercice?: number | 'all'\n  assignmentData?: AssignmentData\n}) {\n  if (indiceExercice === undefined) return\n  const results = get(resultsByExercice) || []\n  // On rcupre les rsultats prcdents de l'lve en provenance de Capytale\n  let newStudentAssignement = get(capytaleStudentAssignment) || []\n  let evaluation = 0\n  for (const resultExercice of results) {\n    if (Number.isFinite(resultExercice?.numberOfPoints)) {\n      evaluation += resultExercice.numberOfPoints\n    }\n  }\n  if (currentMode === 'assignment') {\n    // exerciceGraded est l'indice du dernier exercice valu\n    // L'information est envoye  Capytale pour qu'ils sachent quel exercice ajouter en base de donnes\n    // Dans le cas d'une vue Course aux Nombre on envoie all pour forcer de mettre  jour en base de donnes tous les scores\n    if (indiceExercice !== 'all') {\n      // On n'est donc pas en vue CAN\n      const bestScore = results[indiceExercice]?.bestScore ?? 0\n      const newScore = results[indiceExercice]?.numberOfPoints ?? -1\n      if (newScore < bestScore) {\n        console.info(\n          'Exercice non sauvegard car le score est infrieur au meilleur score',\n        )\n        return\n      }\n      // On ne sauvegarde que les donnes de l'exercice qui vient d'tre soumis\n      newStudentAssignement[indiceExercice] = results[indiceExercice]\n      capytaleStudentAssignment.set(newStudentAssignement)\n    } else {\n      // Pour la CAN, on ne garde rien des enregistrements prcdents\n      newStudentAssignement = results\n      capytaleStudentAssignment.set(newStudentAssignement)\n    }\n    const data = {\n      // Les rponses de l'lve\n      // Le tableau fourni remplace compltement les rponses prcdemment sauvegardes.\n      studentAssignment: newStudentAssignement,\n      // L'valuation totale\n      evaluation: evaluation.toString(),\n      // L'index dans le tableau `studentAssignment` de l'exercice qui vient d'tre soumis\n      // 'all' pour indiquer que tous les exercices sont soumis\n      exerciceGraded: indiceExercice,\n      // Des donnes globales concernant le travail de l'lve : temps pass, etc... Format  dfinir.\n      // Les donnes fournies remplacent compltement les donnes prcdemment sauvegardes.\n      assignmentData,\n      // Indique que l'activit est termine et doit tre verrouille pour l'lve : workflow = 'finished'\n      final: get(canOptionsStore).isChoosen && get(globalOptions).oneShot,\n    }\n    console.info('Message envoy  Capytale', data)\n    const promiseSaveStudentAssignment = rpc.call('saveStudentAssignment', data)\n    promiseSaveStudentAssignment\n      .then(() => {\n        console.info('Sauvegarde effectue')\n        // Afficher sauvegarde russie\n      })\n      .catch(() => {\n        console.error('Problme avec la sauvegarde')\n        // Indiquer  l'lve qu'il y a un soucis rseau\n      })\n  }\n}\n\nfunction sendToCapytaleActivityParams() {\n  console.log('[HANDLECAPYTALE]  sendToCapytaleActivityParams called!')\n  const params = get(exercicesParams)\n  const options = get(globalOptions)\n  const canOptions = get(canOptionsStore)\n  for (const param of params) {\n    if (param.alea !== undefined && get(globalOptions).isDataRandom) {\n      param.alea = undefined\n    }\n  }\n  const result = { exercicesParams: params, globalOptions: options, canOptions }\n  console.log('[HANDLECAPYTALE]  Returning:', result)\n  return result\n}\n\nexport default async function handleCapytale() {\n  console.log('[HANDLECAPYTALE]  Exposing platformGetActivityParams...')\n  rpc.expose('platformGetActivityParams', sendToCapytaleActivityParams)\n  console.log('[HANDLECAPYTALE]  Calling toolGetActivityParams...')\n  try {\n    const activityParams = await rpc.call<ActivityParams>(\n      'toolGetActivityParams',\n      {},\n    )\n    console.log('[HANDLECAPYTALE]  Received activityParams:', activityParams)\n    toolSetActivityParams(activityParams)\n  } catch (error) {\n    console.error('[HANDLECAPYTALE]  Problme de communication avec Capytale', error)\n  }\n}\n","import scratchblocks from 'scratchblocks'\nimport scratchFr from '../json/scratchFr.json'\n\nexport default function renderScratch(selector = '') {\n  // Excuter 2 fois le rendu sur un mme lment <pre> semble buguer\n  // Donc le slectionneur css ne cible que l'exercice en cours\n  // pour ne pas altrer les rendus des autres exercices\n  if (selector !== '') selector = selector + ' '\n  scratchblocks.loadLanguages({ fr: scratchFr })\n  if (document.querySelector(`${selector}pre.blocks`)) {\n    scratchblocks.renderMatching(`${selector}pre.blocks`, {\n      style: 'scratch3',\n      languages: ['fr'],\n      scale: 0.7,\n    })\n    // Le code est rendu dans un svg enfant de pre.blocks\n    // Quand le render passe une 2e fois, il essaie de rendre le code svg d'o le bug\n    // Donc une fois le code rendu, on enlve la classe blocks pour ne plus le slectionner\n    document\n      .querySelectorAll(`${selector}pre.blocks`)\n      .forEach((el) => el.classList.remove('blocks'))\n  }\n  if (document.querySelector(`${selector}code.b`)) {\n    scratchblocks.renderMatching(`${selector}code.b`, {\n      inline: true,\n      style: 'scratch3',\n      languages: ['fr'],\n      scale: 0.7,\n    })\n  }\n\n  // POUR GERER LE ZOOM\n  const elts = document.querySelectorAll(`${selector}pre.blocks2`)\n  const scales = new Set()\n  elts.forEach((ele) => {\n    const scale = Number(ele.getAttribute('scale'))\n    scales.add(scale)\n  })\n  scales.forEach((scale) => {\n    scratchblocks.renderMatching(`${selector}pre.blocks2[scale=\"${scale}\"]`, {\n      style: 'scratch3',\n      languages: ['fr'],\n      scale,\n    })\n    document\n      .querySelectorAll(`${selector}pre.blocks2[scale=\"${scale}\"]`)\n      .forEach((el) => el.classList.remove('blocks2'))\n  })\n}\n","import type { VueType } from '../types'\n\nexport const ALLOWED_LANGUAGES = ['fr-FR', 'fr-CH'] as const\nexport type Language = (typeof ALLOWED_LANGUAGES)[number]\nexport type LanguageDisplay = Record<\n  Language,\n  { short: string; long: string; country: string }\n>\nexport const isLanguage = (obj: unknown): obj is Language =>\n  obj !== null &&\n  typeof obj === 'string' &&\n  ALLOWED_LANGUAGES.includes(obj as Language)\nexport const VUES_WITH_LANG_STATUS_ONLY: VueType[] = [\n  'confeleve',\n  'amc',\n  'anki',\n  'can',\n  'diaporama',\n  'eleve',\n  'latex',\n  'moodle',\n]\n","import { get, writable } from 'svelte/store'\nimport { isLanguage, type Language } from '../types/languages'\nimport { decrypt } from '../components/urls'\nimport refToUuidFR from '../../json/refToUuidFR.json'\nimport refToUuidCH from '../../json/refToUuidCH.json'\n\nexport const localisedIDToUuid: Record<Language, Record<string, string>> = {\n  'fr-CH': { ...refToUuidCH },\n  'fr-FR': { ...refToUuidFR },\n}\n\nexport const referentielLocale = writable<Language>('fr-FR')\n\nexport const updateReferentielLocaleFromURL = (\n  urlString = window.location.href,\n) => {\n  let url: URL\n  try {\n    url = new URL(urlString)\n  } catch {\n    return {}\n  }\n  url = decrypt(url)\n  const params = url.searchParams\n  const lang = params.get('lang')\n  if (lang) {\n    if (isLanguage(lang) && lang !== get(referentielLocale)) {\n      referentielLocale.set(lang)\n    }\n  } else if (get(referentielLocale) !== 'fr-FR') {\n    referentielLocale.set('fr-FR')\n  }\n}\n\nexport const updateURLFromReferentielLocale = (url: URL) => {\n  const locale = get(referentielLocale)\n  const params = url.searchParams\n  if (locale === 'fr-FR') {\n    params.delete('lang')\n  } else {\n    params.set('lang', locale)\n  }\n}\n\nexport function getLang() {\n  return get(referentielLocale)\n}\n","/**\n * Le type NumberRange<T, U> qu'on peut trouver dans src/lib/types.ts est trs bien pour dfinir un intervalle de nombres,\n * mais il n'est pas \"type guardable\". C'est--dire qu'on ne peut pas crer de fonction qui permet dire  typescript\n * que la valeur passe en argument est bien un NumberRange<T, U>.\n * Il est mme probable que ce soit impossible  faire avec la version de typescript actuelle.\n * En attendant, je propose d'utiliser ce fichier pour crer les intervalles de nombres dont on a besoin au fur et  mesure avec les type guards qui vont avec.\n */\n\nexport type IntegerInRange0to2 = 0 | 1 | 2\nexport function isIntegerInRange0to2(obj: unknown): obj is IntegerInRange0to2 {\n  return obj === 0 || obj === 1 || obj === 2\n}\n\nexport type IntegerInRange0to3 = 0 | 1 | 2 | 3\nexport function isIntegerInRange0to3(obj: unknown): obj is IntegerInRange0to3 {\n  return obj === 0 || obj === 1 || obj === 2 || obj === 3\n}\n\nexport type IntegerInRange0to4 = 0 | 1 | 2 | 3 | 4\nexport function isIntegerInRange0to4(obj: unknown): obj is IntegerInRange0to4 {\n  return obj === 0 || obj === 1 || obj === 2 || obj === 3 || obj === 4\n}\n\nexport type IntegerInRange1to4 = 1 | 2 | 3 | 4\nexport function isIntegerInRange1to4(obj: unknown): obj is IntegerInRange1to4 {\n  return obj === 1 || obj === 2 || obj === 3 || obj === 4\n}\n","import Decimal from 'decimal.js'\nimport renderMathInElement from 'katex/contrib/auto-render'\nimport 'katex/dist/katex.min.css'\nimport seedrandom from 'seedrandom'\nimport { get } from 'svelte/store'\nimport type TypeExercice from '../exercices/Exercice'\nimport Exercice from '../exercices/Exercice'\nimport ExerciceSimple from '../exercices/ExerciceSimple'\nimport referentielStaticCH from '../json/referentielStaticCH.json'\nimport referentielStaticFR from '../json/referentielStaticFR.json'\nimport uuidToUrl from '../json/uuidsToUrlFR.json'\nimport {\n  ajouteChampTexteMathLive,\n  remplisLesBlancs,\n} from '../lib/interactif/questionMathLive'\nimport FractionEtendue from '../modules/FractionEtendue'\nimport Grandeur from '../modules/Grandeur'\nimport { contraindreValeur } from '../modules/outils'\nimport {\n  showDialogForLimitedTime,\n  showPopupAndWait,\n} from './components/dialogs'\nimport { isStatic, isSvelte } from './components/exercisesUtils'\nimport { resizeContent } from './components/sizeTools'\nimport { delay } from './components/time'\nimport { decrypt, isCrypted } from './components/urls'\nimport { checkForServerUpdate } from './components/version'\nimport { sendToCapytaleMathaleaHasChanged } from './handleCapytale'\nimport { fonctionComparaison } from './interactif/comparisonFunctions'\nimport {\n  handleAnswers,\n  isAnswerValueType,\n  setReponse,\n  type AnswerValueType,\n  type MathaleaSVG,\n  type ReponseComplexe,\n  type Valeur,\n} from './interactif/gestionInteractif'\nimport type ListeDeroulanteElement from './interactif/listeDeroulante/ListeDeroulanteElement'\nimport { propositionsQcm } from './interactif/qcm'\nimport { shuffle } from './outils/arrayOutils'\nimport { formaterReponse } from './outils/ecritures'\nimport renderScratch from './renderScratch'\nimport { canOptions } from './stores/canStore'\nimport {\n  exercicesParams,\n  freezeUrl,\n  globalOptions,\n  presModeId,\n  previousView,\n  updateGlobalOptionsInURL,\n} from './stores/generalStore'\nimport {\n  getLang,\n  localisedIDToUuid,\n  referentielLocale,\n  updateURLFromReferentielLocale,\n} from './stores/languagesStore'\nimport type { MySpreadsheetElement } from './tableur/MySpreadSheet'\nimport {\n  convertVueType,\n  type InterfaceGlobalOptions,\n  type InterfaceParams,\n  type VueType,\n} from './types'\nimport {\n  isIntegerInRange0to2,\n  isIntegerInRange0to4,\n  isIntegerInRange1to4,\n} from './types/integerInRange'\n\nconst ERROR_MESSAGE =\n  'Erreur - Veuillez actualiser la page et nous contacter si le problme persiste.'\n\nfunction getExerciceByUuid(\n  root: { [key: string]: any },\n  targetUUID: string,\n): object | null {\n  if ('uuid' in root) {\n    if (root.uuid === targetUUID) {\n      return root\n    }\n  }\n  for (const child in root) {\n    if (typeof root[child] !== 'object') continue\n    const foundObject = getExerciceByUuid(root[child], targetUUID)\n    if (foundObject) {\n      return foundObject\n    }\n  }\n\n  return null\n}\n\n/*\n Chargement d'un composant SVELTE\n ATTENTION : oliger d'tre daans ce rpertoire, sinon diffrence entre le serveur de test et de production\n*/\nexport async function getSvelteComponent(paramsExercice: InterfaceParams) {\n  const urlExercice = uuidToUrl[paramsExercice.uuid as keyof typeof uuidToUrl]\n\n  let filename, directory\n  if (urlExercice) {\n    ;[filename, directory] = urlExercice\n      .replaceAll('\\\\', '/')\n      .split('/')\n      .reverse()\n  }\n  try {\n    if (filename && filename.includes('.svelte')) {\n      return (\n        await import(\n          `../exercicesInteractifs/${directory === undefined ? '' : `${directory}/`}${filename.replace('.svelte', '')}.svelte`\n        )\n      ).default\n    }\n  } catch (err) {\n    console.error(\n      `Chargement de l'exercice ${paramsExercice.uuid} impossible. Vrifier  ${directory === undefined ? '' : `${directory}/`}${filename}`,\n    )\n  }\n  throw new Error(\n    `Chargement de l'exercice ${paramsExercice.uuid} impossible. Vrifier ${directory === undefined ? '' : `${directory}/`}${filename}`,\n  )\n}\n\n/**\n * Charge un svelte exercice depuis son uuid\n * Exemple : mathaleaLoadSvelteExerciceFromUuid('clavier')\n * @param {string} uuid\n * @returns {Promise<Exercice>} exercice\n */\nexport async function mathaleaLoadSvelteExerciceFromUuid(uuid: string) {\n  const url = uuidToUrl[uuid as keyof typeof uuidToUrl]\n  let filename, directory, isCan\n  if (url) {\n    ;[filename, directory, isCan] = url\n      .replaceAll('\\\\', '/')\n      .split('/')\n      .reverse()\n  }\n  let attempts = 0\n  const maxAttempts = 3\n  while (attempts < maxAttempts) {\n    try {\n      // L'import dynamique ne peut descendre que d'un niveau, les sous-rpertoires de directory ne sont pas pris en compte\n      // cf https://github.com/rollup/plugins/tree/master/packages/dynamic-import-vars#globs-only-go-one-level-deep\n      // L'extension doit-tre visible donc on l'enlve avant de la remettre...\n      let module: any\n      if (isCan === 'can') {\n        if (filename != null && filename.includes('.ts')) {\n          module = await import(\n            `../exercices/can/${directory}/${filename.replace('.ts', '')}.ts`\n          )\n        } else if (filename != null) {\n          module = await import(\n            `../exercices/can/${directory}/${filename.replace('.js', '')}.js`\n          )\n        }\n      } else {\n        if (filename != null && filename.includes('.ts')) {\n          module = await import(\n            `../exercices/${directory}/${filename.replace('.ts', '')}.ts`\n          )\n        } else if (filename != null) {\n          module = await import(\n            `../exercices/${directory}/${filename.replace('.js', '')}.js`\n          )\n        }\n      }\n      const ClasseExercice = module.default\n      const exercice = new ClasseExercice()\n      ;[\n        'titre',\n        'amcReady',\n        'amcType',\n        'interactifType',\n        'interactifReady',\n      ].forEach((p) => {\n        if (module[p] !== undefined) exercice[p] = module[p]\n      })\n      ;(await exercice).id = filename\n      return exercice\n    } catch (error) {\n      attempts++\n      window.notify(`Un exercice ne s'est pas affich ${attempts} fois`, {})\n      if (attempts === maxAttempts) {\n        console.error(\n          `Chargement de l'exercice ${uuid} impossible. Vrifier ${directory}/${filename}`,\n        )\n        console.error(error)\n        const exercice = new Exercice()\n        exercice.titre = ERROR_MESSAGE\n        exercice.nouvelleVersion = () => {}\n        return exercice\n      } else {\n        await delay(1000)\n      }\n    }\n  }\n}\n\n/**\n * Charge un exercice depuis son uuid\n * Exemple : const exercice = loadExercice('3cvng')\n * @param {string} url\n * @returns {Promise<Exercice>} exercice\n */\nexport async function mathaleaLoadExerciceFromUuid(uuid: string) {\n  const url = uuidToUrl[uuid as keyof typeof uuidToUrl]\n  let filename, directory, isCan\n  if (url) {\n    ;[filename, directory, isCan] = url\n      .replaceAll('\\\\', '/')\n      .split('/')\n      .reverse()\n  }\n  let attempts = 0\n  const maxAttempts = 3\n  while (attempts < maxAttempts) {\n    try {\n      // L'import dynamique ne peut descendre que d'un niveau, les sous-rpertoires de directory ne sont pas pris en compte\n      // cf https://github.com/rollup/plugins/tree/master/packages/dynamic-import-vars#globs-only-go-one-level-deep\n      // L'extension doit-tre visible donc on l'enlve avant de la remettre...\n      let module\n      if (isCan === 'can') {\n        // D'aprs ChatGPT, avec vite, il faudrait comme a pour charger les modules dynamiquement\n        // un import direct avec safari plante alatoirement, et je ne sais pas pourquoi\n        const modules = import.meta.glob('../exercices/can/**/*.{ts,js}')\n        if (filename != null && filename.includes('.ts')) {\n          const path = `../exercices/can/${directory}/${filename.replace('.ts', '')}.ts`\n          const loader = modules[path]\n          if (!loader) throw new Error(`Module \"${path}\" introuvable`)\n          module = await loader()\n          // module = await import(`../exercices/can/${directory}/${filename.replace('.ts', '')}.ts`)\n        } else if (filename != null) {\n          const path = `../exercices/can/${directory}/${filename.replace('.js', '')}.js`\n          const loader = modules[path]\n          if (!loader) throw new Error(`Module \"${path}\" introuvable`)\n          module = await loader()\n          // module = await import(`../exercices/can/${directory}/${filename.replace('.js', '')}.js`)\n        }\n      } else if (isCan === 'QCMBrevet') {\n        if (filename != null && filename.includes('.ts')) {\n          module = await import(\n            `../exercices/QCMBrevet/${directory}/${filename.replace('.ts', '')}.ts`\n          )\n        } else if (filename != null) {\n          module = await import(\n            `../exercices/QCMBrevet/${directory}/${filename.replace('.js', '')}.js`\n          )\n        }\n      } else if (isCan === 'QCMBac') {\n        if (filename != null && filename.includes('.ts')) {\n          module = await import(\n            `../exercices/QCMBac/${directory}/${filename.replace('.ts', '')}.ts`\n          )\n        } else if (filename != null) {\n          module = await import(\n            `../exercices/QCMBac/${directory}/${filename.replace('.js', '')}.js`\n          )\n        }\n      } else {\n        if (filename != null && filename.includes('.ts')) {\n          module = await import(\n            `../exercices/${directory}/${filename.replace('.ts', '')}.ts`\n          )\n        } else if (filename != null) {\n          module = await import(\n            `../exercices/${directory}/${filename.replace('.js', '')}.js`\n          )\n        }\n      }\n      const ClasseExercice = module.default\n      const exercice = new ClasseExercice()\n      ;[\n        'titre',\n        'amcReady',\n        'amcType',\n        'interactifType',\n        'interactifReady',\n      ].forEach((p) => {\n        if (module[p] !== undefined) exercice[p] = module[p]\n      })\n      ;(await exercice).id = filename\n      return exercice\n    } catch (error) {\n      attempts++\n      const serverUpdated = await checkForServerUpdate()\n      if (serverUpdated) {\n        await showPopupAndWait()\n      }\n      window.notify(\n        `Un exercice ne s'est pas affich ${attempts} fois: uuid:${uuid} ,filename: ${directory}/${filename}, serverUpdated: ${serverUpdated}`,\n        { error },\n      )\n      if (attempts === maxAttempts) {\n        console.error(\n          `Chargement de l'exercice ${uuid} impossible. Vrifier ${directory}/${filename}`,\n        )\n        console.error(error)\n        const exercice = new Exercice()\n        exercice.titre = ERROR_MESSAGE\n        exercice.nouvelleVersion = () => {}\n        return exercice\n      } else {\n        await delay(1000)\n      }\n    }\n  }\n}\n\n/**\n * Charge tous les exercices et les paramtres\n * en fonction du store exercicesParams.\n */\nexport async function mathaleaGetExercicesFromParams(\n  params: InterfaceParams[],\n): Promise<TypeExercice[]> {\n  const exercices = []\n  for (const param of params) {\n    if (\n      param.uuid.substring(0, 4) === 'crpe' ||\n      param.uuid.substring(0, 4) === 'dnb_' ||\n      param.uuid.startsWith('dnbpro_') ||\n      param.uuid.substring(0, 4) === 'e3c_' ||\n      param.uuid.startsWith('eam_') ||\n      param.uuid.substring(0, 4) === 'bac_' ||\n      param.uuid.startsWith('sti2d_') ||\n      param.uuid.substring(0, 7) === 'evacom_' ||\n      param.uuid.startsWith('2nd_')\n    ) {\n      const infosExerciceStatique =\n        param.uuid.substring(0, 7) === 'evacom_'\n          ? getExerciceByUuid(referentielStaticCH, param.uuid)\n          : getExerciceByUuid(referentielStaticFR, param.uuid)\n      let content = ''\n      let contentCorr = ''\n      const sujet = param.uuid.split('_')[0]\n      if (\n        sujet === 'dnb' ||\n        sujet === 'dnbpro' ||\n        sujet === 'bac' ||\n        sujet === 'eam' ||\n        sujet === 'sti2d' ||\n        sujet === 'stl'\n      ) {\n        let response = await window.fetch(\n          `static/${sujet}/${infosExerciceStatique.annee}/tex/${param.uuid}.tex`,\n        )\n        if (response.status === 200) {\n          const text = await response.clone().text()\n          if (!text.trim().startsWith('<!DOCTYPE html>')) {\n            content = text\n          } else {\n            content = '\\n\\n\\t%Exercice non disponible\\n\\n'\n          }\n        }\n        response = await window.fetch(\n          `static/${sujet}/${infosExerciceStatique.annee}/tex/${param.uuid}_cor.tex`,\n        )\n        if (response.status === 200) {\n          const text = await response.clone().text()\n          if (!text.trim().startsWith('<!DOCTYPE html>')) {\n            contentCorr = text\n          } else {\n            contentCorr = '\\n\\n\\t%Pas de correction disponible\\n\\n'\n          }\n        }\n      } else {\n        if (infosExerciceStatique?.url) {\n          const response = await window.fetch(infosExerciceStatique.url)\n          if (response.status === 200) {\n            const text = await response.clone().text()\n            if (!text.trim().startsWith('<!DOCTYPE html>')) {\n              content = text\n            } else {\n              content = '\\n\\n\\t%Exercice non disponible\\n\\n'\n            }\n          }\n        }\n        if (infosExerciceStatique?.urlcor) {\n          const response = await window.fetch(infosExerciceStatique.urlcor)\n          if (response.status === 200) {\n            const text = await response.clone().text()\n            if (!text.trim().startsWith('<!DOCTYPE html>')) {\n              contentCorr = text\n            } else {\n              contentCorr = '\\n\\n\\t%Pas de correction disponible\\n\\n'\n            }\n          }\n        }\n      }\n      const annee = infosExerciceStatique?.annee\n      const lieu = infosExerciceStatique?.lieu\n      const mois = infosExerciceStatique?.mois\n      const numeroInitial = infosExerciceStatique?.numeroInitial\n      let examen: string = ''\n      if (param.uuid.substring(0, 4) === 'crpe') examen = 'CRPE'\n      if (param.uuid.substring(0, 4) === 'dnb_') examen = 'DNB'\n      if (param.uuid.startsWith('dnbpro_')) examen = 'DNBPRO'\n      if (param.uuid.substring(0, 4) === 'e3c_') examen = 'E3C'\n      if (param.uuid.substring(0, 4) === 'bac_') examen = 'BAC'\n      if (param.uuid.startsWith('sti2d_')) examen = 'STI2D'\n      if (param.uuid.startsWith('stl_')) examen = 'STL'\n      if (param.uuid.substring(0, 7) === 'evacom_') examen = 'EVACOM'\n      exercices.push({\n        typeExercice: 'statique',\n        uuid: param.uuid,\n        content,\n        contentCorr,\n        annee,\n        lieu,\n        mois,\n        numeroInitial,\n        examen,\n      })\n    } else {\n      const exercice = await mathaleaLoadExerciceFromUuid(param.uuid)\n      if (typeof exercice === 'undefined') continue\n      mathaleaHandleParamOfOneExercice(exercice, param)\n      exercices.push(exercice)\n    }\n  }\n  return exercices\n}\n\n/**\n * Applique les paramtres sauvegards dans un lment de exercicesParams  un exercice.\n */\nexport function mathaleaHandleParamOfOneExercice(\n  exercice: TypeExercice,\n  param: InterfaceParams,\n) {\n  exercice.uuid = param.uuid\n  if (param.nbQuestions) exercice.nbQuestions = param.nbQuestions\n  exercice.duration = param.duration ?? 10\n  if (param.id) exercice.id = param.id\n  if (param.sup) exercice.sup = mathaleaHandleStringFromUrl(param.sup)\n  if (param.sup2) exercice.sup2 = mathaleaHandleStringFromUrl(param.sup2)\n  if (param.sup3) exercice.sup3 = mathaleaHandleStringFromUrl(param.sup3)\n  if (param.sup4) exercice.sup4 = mathaleaHandleStringFromUrl(param.sup4)\n  if (param.sup5) exercice.sup5 = mathaleaHandleStringFromUrl(param.sup5)\n  if (param.versionQcm !== undefined && exercice instanceof ExerciceSimple)\n    exercice.versionQcm = param.versionQcm === '1'\n  if (param.interactif) exercice.interactif = param.interactif === '1'\n  if (param.alea) exercice.seed = param.alea\n  if (param.cols !== undefined && param.cols > 1) exercice.nbCols = param.cols\n  if (param.cd !== undefined) exercice.correctionDetaillee = param.cd === '1'\n  if (exercice.seed === undefined) {\n    exercice.seed = mathaleaGenerateSeed()\n  }\n}\n\n/**\n * sup, sup2, sup3 et sup4 permettent de sauvegarder les formulaires modifies par\n * les enseignants pour pparamtrer les exercices.\n * Ces paramtres peuvent tre des strings, des boolens ou des number mais que ce soit dans l'url\n * ou dans le store exercicesParams, ils sont sauvegards sous forme de string d'o cette fonction de conversion\n * d'un des trois types vers string.\n */\nexport function mathaleaHandleSup(param: boolean | string | number): string {\n  if (typeof param === 'string') {\n    return param\n  } else if (typeof param === 'number') {\n    return param.toString()\n  } else if (typeof param === 'boolean') {\n    return param ? 'true' : 'false'\n  }\n}\n\n/**\n * sup, sup2, sup3 et sup4 permettent de sauvegarder les formulaires modifis par\n * les enseignants pour paramtrer les exercices.\n * Ces paramtres peuvent tre des strings, des boolens ou des numbers mais que ce soit dans l'url\n * ou dans le store exercicesParams, ils sont sauvegards sous forme de string d'o cette fonction de conversion\n * du string vers boolen ou number.\n */\nexport function mathaleaHandleStringFromUrl(\n  text: string,\n): boolean | number | string {\n  if (text === 'true' || text === 'false') {\n    // \"true\"=>true\n    return text === 'true'\n  } else if (/^\\d+$/.test(text)) {\n    // \"17\"=>17\n    return parseInt(text)\n  } else {\n    return text\n  }\n}\n\nexport function mathaleaRenderDiv(\n  div: HTMLElement | null,\n  zoom?: number,\n): void {\n  if (!div) return\n  const params = get(globalOptions)\n  zoom = zoom ?? Number(params.z)\n\n  renderKatex(div)\n  renderScratch('body')\n  if (zoom !== -1) {\n    resizeContent(div, zoom)\n  }\n}\n\nfunction renderKatex(element: HTMLElement) {\n  renderMathInElement(element, {\n    delimiters: [\n      { left: '\\\\[', right: '\\\\]', display: true },\n      { left: '$', right: '$', display: false },\n    ],\n    // Les accolades permettent d'avoir une formule non coupe\n    preProcess: (chaine: string) =>\n      '{' + chaine.replaceAll(String.fromCharCode(160), '\\\\,') + '}',\n    throwOnError: true,\n    errorColor: '#CC0000',\n    strict: 'warn',\n    trust: false,\n  })\n  document.dispatchEvent(new window.Event('katexRendered'))\n}\n\nexport function createURL(params: InterfaceParams[]) {\n  const url = new URL(\n    window.location.protocol +\n      '//' +\n      window.location.host +\n      window.location.pathname,\n  )\n  for (const ex of params) {\n    url.searchParams.append('uuid', ex.uuid)\n    if (ex.id != null) url.searchParams.append('id', ex.id)\n    if (ex.nbQuestions !== undefined)\n      url.searchParams.append('n', ex.nbQuestions.toString())\n    if (ex.duration != null)\n      url.searchParams.append('d', ex.duration.toString())\n    if (ex.sup != null) url.searchParams.append('s', ex.sup)\n    if (ex.sup2 != null) url.searchParams.append('s2', ex.sup2)\n    if (ex.sup3 != null) url.searchParams.append('s3', ex.sup3)\n    if (ex.sup4 != null) url.searchParams.append('s4', ex.sup4)\n    if (ex.sup5 != null) url.searchParams.append('s5', ex.sup5)\n    if (ex.versionQcm != null) url.searchParams.append('qcm', ex.versionQcm)\n    if (ex.interactif === '1') url.searchParams.append('i', '1')\n    if (ex.cd != null) url.searchParams.append('cd', ex.cd)\n    if (ex.cols != null) url.searchParams.append('cols', ex.cols.toString())\n    if (ex.alea != null) url.searchParams.append('alea', ex.alea)\n  }\n  return url\n}\n/**\n * Modifie l'url courante avec le store exercicesParams ou un tableau similaire\n * sauf si le store freezeUrl est  true (utile sur un site externe)\n */\nexport function mathaleaUpdateUrlFromExercicesParams(\n  params?: InterfaceParams[],\n) {\n  if (get(globalOptions).recorder === 'capytale') {\n    sendToCapytaleMathaleaHasChanged()\n  }\n  if (get(freezeUrl) === true) return\n  if (params === undefined) {\n    params = get(exercicesParams)\n  }\n  const url = createURL(params)\n  updateURLFromReferentielLocale(url)\n  updateGlobalOptionsInURL(url)\n}\n\n/**\n * Analyse l'url courante de la fentre\n * pour mettre  jour exercicesParams\n * avec tous les exercices et les options\n * @returns vue\n */\nexport function mathaleaUpdateExercicesParamsFromUrl(\n  urlString = window.location.href,\n): InterfaceGlobalOptions {\n  console.log('[MATHALEA.TS]  mathaleaUpdateExercicesParamsFromUrl called with URL:', urlString)\n  const currentRefToUuid = localisedIDToUuid[get(referentielLocale)]\n  let urlNeedToBeFreezed = false\n  let v: VueType | undefined\n  let z = '1'\n  let durationGlobal = 0\n  let ds\n  let nbVues: 1 | 2 | 3 | 4 = 1\n  let flow: 0 | 1 | 2 = 0\n  let screenBetweenSlides\n  let pauseAfterEachQuestion\n  let isImagesOnSides = false\n  let sound: 0 | 1 | 2 | 3 | 4 = 0\n  let shuffle = false\n  let manualMode\n  let select: number[] = []\n  let order: number[] = []\n  let title = ''\n  let iframe = ''\n  let answers = ''\n  let recorder: 'capytale' | 'moodle' | 'labomep' | 'anki'\n  let done: '1'\n  let es\n  let presMode:\n    | 'liste_exos'\n    | 'un_exo_par_page'\n    | 'une_question_par_page'\n    | 'recto'\n    | 'verso' = 'liste_exos'\n  let setInteractive = '2'\n  let isSolutionAccessible = true\n  let isInteractiveFree = true\n  let oneShot = false\n  let twoColumns = false\n  let isTitleDisplayed = true\n  let beta = false\n  let url: URL\n  let canDuration = 540\n  let canTitle = ''\n  let canSolAccess = true\n  let canSolMode = 'gathered'\n  let canIsInteractive = true\n  try {\n    url = new URL(urlString)\n  } catch (error) {\n    return {}\n  }\n  // let url = new URL(urlString)\n  if (isCrypted(url)) {\n    urlNeedToBeFreezed = true\n    url = decrypt(url)\n  }\n  const entries = url.searchParams.entries()\n  let indiceExercice = -1\n  const newExercisesParams: InterfaceParams[] = []\n  let previousEntryWasUuid = false\n  try {\n    for (const entry of entries) {\n      if (entry[0] === 'uuid') {\n        indiceExercice++\n        const uuid = entry[1]\n        const id = (\n          Object.keys(currentRefToUuid) as (keyof typeof currentRefToUuid)[]\n        ).find((key) => {\n          return currentRefToUuid[key] === uuid\n        })\n        if (!newExercisesParams[indiceExercice])\n          newExercisesParams[indiceExercice] = { uuid, id }\n        newExercisesParams[indiceExercice].uuid = uuid // string\n        newExercisesParams[indiceExercice].id = id // string\n        newExercisesParams[indiceExercice].interactif = '0' // par dfaut\n      } else if (entry[0] === 'id' && !previousEntryWasUuid) {\n        // En cas de prsence d'un uuid juste avant, on ne tient pas compte de l'id\n        indiceExercice++\n        const id = entry[1]\n        const uuid = currentRefToUuid[id as keyof typeof currentRefToUuid]\n        if (!newExercisesParams[indiceExercice])\n          newExercisesParams[indiceExercice] = { id, uuid }\n      } else if (entry[0] === 'n') {\n        newExercisesParams[indiceExercice].nbQuestions = parseInt(entry[1]) // int\n      } else if (entry[0] === 'd') {\n        newExercisesParams[indiceExercice].duration = parseInt(entry[1]) // int\n      } else if (entry[0] === 's') {\n        newExercisesParams[indiceExercice].sup = entry[1]\n      } else if (entry[0] === 's2') {\n        newExercisesParams[indiceExercice].sup2 = entry[1]\n      } else if (entry[0] === 's3') {\n        newExercisesParams[indiceExercice].sup3 = entry[1]\n      } else if (entry[0] === 's4') {\n        newExercisesParams[indiceExercice].sup4 = entry[1]\n      } else if (entry[0] === 's5') {\n        newExercisesParams[indiceExercice].sup5 = entry[1]\n      } else if (entry[0] === 'qcm' && (entry[1] === '0' || entry[1] === '1')) {\n        newExercisesParams[indiceExercice].versionQcm = entry[1]\n      } else if (entry[0] === 'alea') {\n        newExercisesParams[indiceExercice].alea = entry[1]\n      } else if (entry[0] === 'cols') {\n        newExercisesParams[indiceExercice].cols = parseInt(entry[1])\n      } else if (entry[0] === 'i' && (entry[1] === '0' || entry[1] === '1')) {\n        newExercisesParams[indiceExercice].interactif = entry[1]\n      } else if (entry[0] === 'cd' && (entry[1] === '0' || entry[1] === '1')) {\n        newExercisesParams[indiceExercice].cd = entry[1]\n      } else if (entry[0] === 'v') {\n        v = convertVueType(entry[1])\n      } else if (entry[0] === 'recorder') {\n        console.log('[MATHALEA.TS]  Found recorder parameter in URL:', entry[1])\n        if (\n          entry[1] === 'capytale' ||\n          entry[1] === 'moodle' ||\n          entry[1] === 'labomep' ||\n          entry[1] === 'anki'\n        ) {\n          recorder = entry[1]\n          console.log('[MATHALEA.TS]  Setting recorder to:', recorder)\n        } else {\n          console.log('[MATHALEA.TS]  Invalid recorder value:', entry[1])\n        }\n      } else if (entry[0] === 'done' && entry[1] === '1') {\n        done = '1'\n      } else if (entry[0] === 'z') {\n        z = entry[1]\n      } else if (entry[0] === 'dGlobal') {\n        durationGlobal = parseInt(entry[1])\n      } else if (entry[0] === 'shuffle') {\n        shuffle = true\n      } else if (entry[0] === 'select') {\n        select = entry[1].split('-').map((e) => parseInt(e))\n      } else if (entry[0] === 'order') {\n        order = entry[1].split('-').map((e) => parseInt(e))\n      } else if (entry[0] === 'ds') {\n        ds = entry[1]\n      } else if (entry[0] === 'es') {\n        es = entry[1]\n      } else if (entry[0] === 'title') {\n        title = decodeURIComponent(entry[1])\n      } else if (entry[0] === 'iframe') {\n        iframe = entry[1]\n      } else if (entry[0] === 'answers') {\n        answers = entry[1]\n      } else if (entry[0] === 'beta') {\n        beta = true\n      } else if (entry[0] === 'canD') {\n        canDuration = parseInt(entry[1])\n      } else if (entry[0] === 'canT') {\n        canTitle = entry[1]\n      } else if (entry[0] === 'canSA') {\n        canSolAccess = entry[1] === '1'\n      } else if (entry[0] === 'canSM') {\n        canSolMode = entry[1]\n      } else if (entry[0] === 'canI') {\n        canIsInteractive = entry[1] === '1'\n      }\n\n      if (entry[0] === 'uuid') previousEntryWasUuid = true\n      else previousEntryWasUuid = false\n    }\n  } catch (error) {\n    // MOUCHARD SUR LES URLS FANTAISISTES\n    window.notify(`Erreur d'URL : ${error} `, {\n      err: error,\n      urlString,\n      url: window.location.href.toString(),\n      referrer: document.referrer,\n    })\n    console.error(error)\n    showDialogForLimitedTime(\n      'notifUrlIncorrecte',\n      5000,\n      \"L'URL prsente une erreur. Veuillez ressayer et nous contacter si le problme persiste.\",\n    )\n    return {}\n  }\n\n  const newExercisesParamsFiltered = newExercisesParams.filter(\n    (e) => e.uuid || e.id,\n  )\n\n  if (\n    JSON.stringify(get(exercicesParams)) !==\n    JSON.stringify(newExercisesParamsFiltered)\n  ) {\n    exercicesParams.set(newExercisesParamsFiltered)\n  }\n\n  if (urlNeedToBeFreezed) {\n    freezeUrl.set(true)\n  }\n\n  if (v === 'can' || get(globalOptions).recorder === 'capytale') {\n    canOptions.update((e) => {\n      e.durationInMinutes = canDuration\n      e.isInteractive = canIsInteractive\n      e.solutionsAccess = canSolAccess\n      if (canSolMode === 'gathered') e.solutionsMode = 'gathered'\n      else e.solutionsMode = 'split'\n      e.subTitle = canTitle\n      return e\n    })\n  }\n\n  if (ds) {\n    const nbVuesCandidate = contraindreValeur(1, 4, ds.charAt(0), 1)\n    const flowCandidate = contraindreValeur(0, 2, ds.charAt(1), 0)\n    const soundCandidate = contraindreValeur(0, 4, ds.charAt(3), 0)\n    if (isIntegerInRange1to4(nbVuesCandidate)) nbVues = nbVuesCandidate\n    if (isIntegerInRange0to2(flowCandidate)) flow = flowCandidate\n    if (isIntegerInRange0to4(soundCandidate)) sound = soundCandidate\n    screenBetweenSlides = ds.charAt(2) === '1'\n    shuffle = ds.charAt(4) === '1'\n    manualMode = ds.charAt(5) === '1'\n    pauseAfterEachQuestion = ds.charAt(6) === '1'\n    isImagesOnSides = ds.charAt(7) === '1'\n  }\n\n  /**\n   * es permet de rsumer les rglages de la vue lve\n   * Il est de la forme 210110\n   * Avec un caractre par rglage presMode|setInteractive|isSolutionAccessible|isInteractiveFree|oneShot|twoColumns|isTitleDisplayed\n   */\n  if (es && es.length === 6) {\n    presMode = presModeId[parseInt(es.charAt(0))]\n    setInteractive = es.charAt(1)\n    isSolutionAccessible = es.charAt(2) === '1'\n    isInteractiveFree = es.charAt(3) === '1'\n    oneShot = es.charAt(4) === '1'\n    twoColumns = es.charAt(5) === '1'\n  } else if (es && es.length === 7) {\n    presMode = presModeId[parseInt(es.charAt(0))]\n    setInteractive = es.charAt(1)\n    isSolutionAccessible = es.charAt(2) === '1'\n    isInteractiveFree = es.charAt(3) === '1'\n    oneShot = es.charAt(4) === '1'\n    twoColumns = es.charAt(5) === '1'\n    isTitleDisplayed = es.charAt(6) === '1'\n  }\n  v = v ?? ''\n  return {\n    v,\n    z,\n    durationGlobal,\n    ds,\n    nbVues,\n    flow,\n    screenBetweenSlides,\n    pauseAfterEachQuestion,\n    isImagesOnSides,\n    sound,\n    shuffle,\n    manualMode,\n    select,\n    order,\n    title,\n    presMode,\n    setInteractive,\n    isSolutionAccessible,\n    isInteractiveFree,\n    oneShot,\n    twoColumns,\n    isTitleDisplayed,\n    recorder,\n    done,\n    beta,\n    iframe,\n    answers,\n  }\n  console.log('[MATHALEA.TS]  Returning globalOptions with recorder =', recorder)\n  return {\n    z,\n    durationGlobal,\n    v,\n    ds,\n    nbVues,\n    flow,\n    screenBetweenSlides,\n    pauseAfterEachQuestion,\n    isImagesOnSides,\n    sound,\n    shuffle,\n    manualMode,\n    select,\n    order,\n    title,\n    presMode,\n    setInteractive,\n    isSolutionAccessible,\n    isInteractiveFree,\n    oneShot,\n    twoColumns,\n    isTitleDisplayed,\n    recorder,\n    done,\n    beta,\n    iframe,\n    answers,\n  }\n}\n\n/**\n * Les exercice qui ont le paramtre typeExercice gale  'simple'\n * ne dfinissent qu'une seule question.\n * Avec cette fonction, on permet la cration de plusieurs questions.\n */\nexport function mathaleaHandleExerciceSimple(\n  exercice: TypeExercice,\n  isInteractif: boolean,\n  numeroExercice?: number,\n) {\n  if (numeroExercice !== undefined) exercice.numeroExercice = numeroExercice\n  exercice.reinit()\n  exercice.interactif = isInteractif\n  for (\n    let i = 0, cptSecours = 0;\n    i < exercice.nbQuestions && cptSecours < 50;\n\n  ) {\n    const compare =\n      exercice.compare == null ? fonctionComparaison : exercice.compare\n    // Rmi : On devrait mettre cette comparaison par dfaut mais cela ne convient pas aux expressions littrales\n    // const options = exercice.optionsDeComparaison == null ? { nombreDecimalSeulement: true } : exercice.optionsDeComparaison\n    const options =\n      exercice.optionsDeComparaison == null ? {} : exercice.optionsDeComparaison\n    seedrandom(String(exercice.seed) + i + cptSecours, { global: true })\n    if (\n      exercice.nouvelleVersion &&\n      typeof exercice.nouvelleVersion === 'function'\n    )\n      exercice.nouvelleVersion(numeroExercice)\n    if (exercice.questionJamaisPosee(i, String(exercice.correction))) {\n      if (exercice.reponse != null) {\n        if (compare != null) {\n          /// DE LA AU PROCHAIN LA, ce sera  supprimer quand il n'y aura plus de this.compare\n          let reponse = {}\n          if (\n            typeof exercice.reponse !== 'string' &&\n            typeof exercice.reponse !== 'number'\n          ) {\n            if (exercice.reponse instanceof FractionEtendue) {\n              reponse = {\n                reponse: {\n                  value: exercice.reponse.texFraction,\n                  compare,\n                  options,\n                },\n              }\n            } else if (exercice.reponse instanceof Decimal) {\n              reponse = {\n                reponse: {\n                  value: exercice.reponse.toString(),\n                  compare,\n                  options,\n                },\n              }\n            } else if (exercice.reponse instanceof Grandeur) {\n              reponse = {\n                reponse: { value: exercice.reponse, compare, options },\n              }\n            } else if (\n              typeof exercice.reponse === 'object' &&\n              !Array.isArray(exercice.reponse)\n            ) {\n              // Si c'est handleAnswer qu'on veut utiliser directement avec un fillInTheBlank par exemple, on met l'objet reponse complet dans this.reponse\n              reponse = exercice.reponse\n            } else if (Array.isArray(exercice.reponse)) {\n              reponse = {\n                reponse: { value: exercice.reponse, compare, options },\n              }\n            } else {\n              window.notify(\n                `MathaleaHandleExerciceSimple n'a pas russi  dterminer le type de exercice.reponse, dans ${exercice?.numeroExercice + 1} - ${exercice.titre} ${JSON.stringify(exercice.reponse)}, on Stingifie, mais c'est sans doute une erreur  rectifier`,\n                { exercice: JSON.stringify(exercice) },\n              )\n              reponse = {\n                reponse: { value: String(exercice.reponse), compare, options },\n              }\n            }\n          } else {\n            reponse = {\n              reponse: {\n                value:\n                  typeof exercice.reponse === 'number'\n                    ? String(exercice.reponse)\n                    : exercice.reponse,\n                compare,\n                options,\n              },\n            }\n          }\n          handleAnswers(exercice, i, reponse, {\n            formatInteractif: exercice.formatInteractif ?? 'mathlive',\n          }) /// // PROCHAIN LA : La partie ci-dessus sera  supprimer quand il n'y aura plus de this.compare\n        } else if (\n          exercice.reponse instanceof Object &&\n          exercice.reponse.reponse != null &&\n          exercice.reponse.reponse.value != null &&\n          typeof exercice.reponse.reponse.value === 'string'\n        ) {\n          handleAnswers(exercice, i, exercice.reponse)\n        } else {\n          setReponse(exercice, i, String(exercice.reponse), {\n            formatInteractif: exercice.formatInteractif ?? 'calcul',\n          })\n        }\n      } else {\n        if (exercice.formatInteractif !== 'qcm')\n          window.notify(\n            \"Un exercice simple doit avoir un this.reponse sauf si c'est un qcm\",\n            { exercice: JSON.stringify(exercice) },\n          )\n      }\n      if (exercice.formatInteractif !== 'fillInTheBlank') {\n        if (\n          exercice.formatInteractif === 'qcm' ||\n          (exercice instanceof ExerciceSimple &&\n            exercice.distracteurs.length > 0 &&\n            exercice.versionQcm)\n        ) {\n          if (\n            exercice instanceof ExerciceSimple &&\n            exercice.distracteurs.length > 0\n          ) {\n            exercice.distracteurs = getDistracteurs(exercice)\n            exercice.autoCorrection[i] = {\n              options: { radio: true },\n              enonce: exercice.question,\n              propositions: [\n                {\n                  texte: formaterReponse(exercice.reponse),\n                  statut: true,\n                },\n                ...exercice.distracteurs.map((distracteur) => ({\n                  texte: formaterReponse(distracteur),\n                  statut: false,\n                })),\n              ],\n            }\n            const qcm = propositionsQcm(exercice, i, {\n              style: 'margin:0 3px 0 3px;',\n              format: exercice.interactif ? 'case' : 'lettre',\n            })\n            exercice.question += qcm.texte\n          }\n          exercice.listeQuestions.push(exercice.question || '')\n        } else if (exercice.formatInteractif === 'listeDeroulante') {\n          const n = exercice.numeroExercice\n          exercice.question = exercice.question?.replace(\n            `id=\"ex${n}Q0\"`,\n            `id=\"ex${n}Q${i}\"`,\n          )\n          exercice.question = exercice.question?.replace(\n            `CheckEx${n}Q0\"`,\n            `CheckEx${n}Q${i}\"`,\n          )\n          exercice.listeQuestions.push(exercice.question ?? '')\n        } else {\n          exercice.listeQuestions.push(\n            exercice.question +\n              ajouteChampTexteMathLive(\n                exercice,\n                i,\n                String(exercice.formatChampTexte),\n                exercice.optionsChampTexte || {},\n              ),\n          )\n        }\n      } else {\n        // La question doit contenir une unique variable %{champ1} On est en fillInTheBlank\n        // Ou bien, on fait appel  un callback\n        exercice.listeQuestions.push(\n          remplisLesBlancs(\n            exercice,\n            i,\n            String(exercice.question),\n            'fillInTheBlank ' + exercice.formatChampTexte,\n            '\\\\ldots',\n          ),\n        )\n        if (\n          typeof exercice.reponse === 'object' &&\n          'callback' in exercice.reponse\n        ) {\n          // Cas d'un callback dans un exercice simple\n          handleAnswers(exercice, i, exercice.reponse)\n        } else if (\n          typeof exercice.reponse === 'object' &&\n          'champ1' in exercice.reponse\n        ) {\n          handleAnswers(exercice, i, exercice.reponse as Valeur, {\n            formatInteractif: 'fillInTheBlank',\n          })\n        } else {\n          handleAnswers(\n            exercice,\n            i,\n            { champ1: { value: exercice.reponse ?? '' } },\n            { formatInteractif: 'fillInTheBlank' },\n          )\n        }\n      }\n      exercice.listeCorrections.push(exercice.correction ?? '')\n      exercice.listeCanEnonces?.push(exercice.canEnonce ?? '')\n      exercice.listeCanReponsesACompleter?.push(\n        exercice.canReponseACompleter ?? '',\n      )\n      exercice.listeCanLiees?.push(exercice.canLiee ?? '')\n      exercice.listeCanNumerosLies?.push(exercice.canNumeroLie ?? '')\n\n      cptSecours = 0\n      i++\n    } else {\n      cptSecours++\n    }\n  }\n}\n\nexport function getDistracteurs(\n  exerciceSimple: ExerciceSimple,\n): (string | number)[] {\n  const distracteursUniques = [...new Set(exerciceSimple.distracteurs)]\n  const distracteursNonSolutions = distracteursUniques.filter((distracteur) => {\n    const reponse: ReponseComplexe | undefined = exerciceSimple.reponse\n    if (reponse == null) {\n      return true // Si pas de rponse, on garde tous les distracteurs\n    }\n    let value: AnswerValueType | undefined\n    if (isAnswerValueType(reponse)) {\n      value = reponse\n    } else {\n      // Si reponse n'est pas un AnswerValueType, alors c'est un Valeur dont on va rcuprer le AnswerValueType\n      const reponseReponse = reponse.reponse\n      if (reponseReponse !== undefined) value = reponseReponse.value\n    }\n    if (value === undefined) {\n      // Si pas de valeur, on garde tous les distracteurs\n      return true\n    }\n    if (Array.isArray(value)) {\n      return !value.some((v) => {\n        if (v instanceof FractionEtendue) {\n          return v.texFraction !== distracteur.toString()\n        }\n        return distracteur.toString() !== v.toString()\n      })\n    }\n    if (value instanceof FractionEtendue) {\n      return value.texFraction !== distracteur.toString()\n    }\n    return distracteur.toString() !== value.toString()\n  })\n  return shuffle(distracteursNonSolutions).slice(0, 3)\n}\n\n/**\n * Gnre un string de 4 caractres qui sera utilis comme seed pour l'alatoire\n */\nexport function mathaleaGenerateSeed({\n  includeUpperCase = true,\n  includeNumbers = true,\n  length = 4,\n  startsWithLowerCase = false,\n}: {\n  includeUpperCase?: boolean\n  includeNumbers?: boolean\n  length?: number\n  startsWithLowerCase?: boolean\n} = {}) {\n  let a = 10\n  const b = 'abcdefghijklmnopqrstuvwxyz'\n  let c = ''\n  let d = 0\n  let e = '' + b\n  if (startsWithLowerCase) {\n    c = b[Math.floor(Math.random() * b.length)]\n    d = 1\n  }\n  if (length) {\n    a = length\n  }\n  if (includeUpperCase) {\n    e += b.toUpperCase()\n  }\n  if (includeNumbers) {\n    e += '1234567890'\n  }\n\n  for (; d < a; d++) {\n    c += e[Math.floor(Math.random() * e.length)]\n  }\n  return c\n}\n\n/**\n * Pour la sortie HTML, il faut modifier certains codages LaTeX non pris en charge par KaTeX\n * @param {string} texte\n * @returns string\n */\n// Define the function with the condition check\nexport function mathaleaFormatExercice(texte = ' ') {\n  const lang = getLang()\n  // Replace symbols based on general rules\n  let formattedText = texte\n    .replace(/\\\\dotfill/g, '..............................')\n    .replace(/\\\\not=/g, '')\n    .replace(/\\\\ldots/g, '....')\n    .replaceAll(' ?', '&nbsp;?')\n    .replaceAll(' !', '&nbsp;!')\n    .replaceAll(' ;', '&nbsp;;')\n    .replaceAll(' :', '&nbsp;:')\n\n  // Check if the language is 'fr-CH' and replace \\times with \\cdot if true\n  if (lang === 'fr-CH') {\n    formattedText = formattedText.replace(/\\\\times/g, '\\\\cdot')\n    formattedText = formattedText.replace(/un antcdent/g, 'une primage')\n    formattedText = formattedText.replace(/l'antcdent/g, 'la primage')\n    formattedText = formattedText.replace(/des antcdents/g, 'des primages')\n    formattedText = formattedText.replace(/les antcdents/g, 'les primages')\n    formattedText = formattedText.replace(/pour antcdents/g, 'pour primages')\n    formattedText = formattedText.replace(/pour antcdent/g, 'pour primage')\n    formattedText = formattedText.replace(/d'antcdent/g, 'de primage')\n    formattedText = formattedText.replace(/antcdent/g, 'primage')\n    formattedText = formattedText.replace(\n      /s'il existe et en l'expliquant, le coefficient directeur/g,\n      'si elle existe, la pente',\n    )\n    formattedText = formattedText.replace(\n      /le coefficient directeur/g,\n      'la pente',\n    )\n    formattedText = formattedText.replace(\n      /coefficients directeurs/g,\n      'les pentes',\n    )\n    formattedText = formattedText.replace(\n      /coefficient directeur respectif/g,\n      'pente respective',\n    )\n    formattedText = formattedText.replace(\n      /le mme coefficient directeur/g,\n      'la mme pente',\n    )\n    formattedText = formattedText.replace(\n      /aucun coefficient directeur/g,\n      'aucune pente',\n    )\n    formattedText = formattedText.replace(/coefficient directeur/g, 'pente')\n  }\n\n  return formattedText\n}\n\nexport function mathaleaGoToView(destinationView: '' | VueType) {\n  const originView = get(globalOptions).v ?? ''\n  const oldPart = '&v=' + originView\n  const newPart = destinationView === '' ? '' : '&v=' + destinationView\n  const urlString = window.location.href.replace(oldPart, newPart)\n  previousView.set(originView)\n  globalOptions.update((l) => {\n    l.v = destinationView\n    return l\n  })\n}\n\n/**\n * On attend un lment ou des lments du DOM en fonction d'un selecteur\n * @param elementId selecteur\n * @param timeWait temps en secondes\n * @returns une promise sur l'lment ou les lments en question\n */\nconst waitForElement = async (\n  elementId: string,\n  timeWait = 4,\n): Promise<NodeListOf<HTMLElement>> => {\n  return new Promise((resolve, reject) => {\n    const ele = document.querySelectorAll<HTMLElement>(elementId)\n    if (ele.length) {\n      // pas besoin d'attendre\n      resolve(ele)\n      return\n    }\n\n    let tempTime = 0\n    const timeWait1000 = timeWait * 10\n    const checkExist = setInterval(function () {\n      const ele = document.querySelectorAll<HTMLElement>(elementId)\n      if (ele.length) {\n        // console.log(`Exists ${elementId}`)\n        clearInterval(checkExist)\n        resolve(ele)\n      } else if (ele.length === 0 && tempTime > timeWait1000) {\n        // console.log('Doesn\\'t exist...')\n        clearInterval(checkExist)\n        reject(new Error(`Element not found ${elementId}`))\n      } else {\n        tempTime++\n        // console.log(`Waiting for ${elementId}`, tempTime)\n      }\n    }, 100) // check every 100ms\n  })\n}\n\nfunction log(message: string) {\n  // console.log(message)\n}\n\nexport function mathaleaWriteStudentPreviousAnswers(answers?: {\n  [key: string]: string\n}): Promise<Boolean>[] {\n  const promiseAnswers: Promise<Boolean>[] = []\n  const starttime = window.performance.now()\n  for (const answer in answers) {\n    if (answer.includes('sheet')) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement('#' + answer)\n          .then(() => {\n            // La rponse correspond  une figure apigeom\n            const sheetElement = document.getElementById(\n              answer,\n            ) as MySpreadsheetElement\n            if (sheetElement != null) {\n              sheetElement.setData(JSON.parse(answers[answer]))\n            }\n            const time = window.performance.now()\n            log(`duration ${answer}: ${time - starttime}`)\n            resolve(true)\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (\n      answer.includes('apigeom') ||\n      answers[answer].includes('apiGeomVersion')\n    ) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement('#' + answer)\n          .then(() => {\n            // La rponse correspond  une figure apigeom\n            const event = new CustomEvent(answer, { detail: answers[answer] })\n            document.dispatchEvent(event)\n            const time = window.performance.now()\n            log(`duration ${answer}: ${time - starttime}`)\n            resolve(true)\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (answer.includes('cliquefigure')) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement('#' + answer)\n          .then(() => {\n            // La rponse correspond  une figure cliquefigures\n            const ele = document.querySelector(`#${answer}`) as MathaleaSVG\n            if (ele) {\n              ele.etat = true\n              ele.style.border = '3px solid #f15929'\n              const time = window.performance.now()\n              log(`duration ${answer}: ${time - starttime}`)\n              resolve(true)\n            }\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (answer.includes('rectangleDND')) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement(`div#${answer.replace('DND', '')}`)\n          .then(() => {\n            const rectangle = document.querySelector(\n              `div#${answer.replace('DND', '')}`,\n            )\n            if (rectangle !== null) {\n              const listeOfIds = answers[answer].split(';')\n              for (const id of listeOfIds) {\n                // attention ! on a peut-tre  faire  des clones ! qu'il faut recrer !\n                if (!id.includes('-clone-')) {\n                  // Non, c'est un original\n                  const etiquette = document.querySelector(`div#${id}`)\n                  if (etiquette !== null) {\n                    // Remet l'tiquette  la bonne rponse\n                    rectangle.appendChild(etiquette)\n                  }\n                } else {\n                  // L, on doit recloner l'original !\n                  const idOriginalAndDate = id.split('-clone-')\n                  const etiquetteOriginale = document.querySelector(\n                    `div#${idOriginalAndDate[0]}`,\n                  )\n                  if (etiquetteOriginale != null) {\n                    const clonedEtiquette = etiquetteOriginale.cloneNode(\n                      true,\n                    ) as HTMLDivElement\n                    clonedEtiquette.id = `${idOriginalAndDate[0]}-clone-${idOriginalAndDate[1]}`\n                    rectangle.appendChild(clonedEtiquette)\n                  }\n                }\n              }\n              const time = window.performance.now()\n              log(`duration ${answer}: ${time - starttime}`)\n              resolve(true)\n            }\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (answer.includes('clockEx')) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement('#' + answer)\n          .then(() => {\n            // La rponse correspond  une horloge\n            const clock = document.querySelector(`#${answer}`)\n            if (clock !== null) {\n              const [hour, minute] = answers[answer].split('h')\n              clock.setAttribute('hour', hour)\n              clock.setAttribute('minute', minute)\n              if (\n                'updateHandHour' in clock &&\n                typeof clock.updateHandHour === 'function'\n              ) {\n                clock.updateHandHour()\n              }\n              if (\n                'updateHandMinute' in clock &&\n                typeof clock.updateHandMinute === 'function'\n              ) {\n                clock.updateHandMinute()\n              }\n              const time = window.performance.now()\n              log(`duration ${answer}: ${time - starttime}`)\n              resolve(true)\n            }\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else if (answer.includes('sheet-')) {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement('#' + answer)\n          .then(() => {\n            // La rponse correspond  une feuille de calcul univer\n            const ele = document.querySelector(\n              `#${answer}`,\n            ) as MySpreadsheetElement\n            if (ele) {\n              const actions = answers[answer].split('&')\n              for (const action of actions) {\n                const [cell, formula] = action.split('->')\n                console.info(cell, formula)\n              }\n              ele.style.pointerEvents = 'none' // Plus possible de modifier la feuille\n              resolve(true)\n            }\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    } else {\n      const p = new Promise<Boolean>((resolve) => {\n        waitForElement(`[id$='${answer}']`)\n          .then((eles) => {\n            eles.forEach((ele) => {\n              if (ele.tagName === 'LISTE-DEROULANTE') {\n                // La rponse correspond  un select\n                ;(ele as ListeDeroulanteElement).value = answers[answer]\n                const time = window.performance.now()\n                log(`duration ${answer}: ${time - starttime}`)\n                resolve(true)\n              } else if (ele.id.includes('check')) {\n                // La rponse correspond  une case  cocher qui doit tre coche\n                if (answers[answer] === '1') {\n                  ;(ele as HTMLInputElement).checked = true\n                }\n                const time = window.performance.now()\n                log(`duration ${answer}: ${time - starttime}`)\n                resolve(true)\n              } else if (\n                ele.tagName === 'MATH-FIELD' &&\n                'setValue' in ele &&\n                typeof (ele as any).setValue === 'function'\n              ) {\n                // La rponse correspond  un champs texte\n                ;(ele as any).setValue(answers[answer])\n                const time = window.performance.now()\n                log(`duration ${answer}: ${time - starttime}`)\n                resolve(true)\n              } else if (ele.tagName === 'INPUT') {\n                ;(ele as HTMLInputElement).value = answers[answer]\n                const time = window.performance.now()\n                log(`duration ${answer}: ${time - starttime}`)\n                resolve(true)\n              }\n            })\n          })\n          .catch((reason) => {\n            console.error(reason)\n            window.notify(`Erreur dans la rponse ${answer} : ${reason}`, {})\n            resolve(true)\n          })\n      })\n      promiseAnswers.push(p)\n    }\n  }\n  return promiseAnswers\n}\n\nexport async function getExercisesFromExercicesParams() {\n  const exercises = []\n  for (const paramsExercice of get(exercicesParams)) {\n    if (isStatic(paramsExercice.uuid) || isSvelte(paramsExercice.uuid)) {\n      continue\n    }\n    const exercise: TypeExercice = await mathaleaLoadExerciceFromUuid(\n      paramsExercice.uuid,\n    )\n    mathaleaHandleParamOfOneExercice(exercise, paramsExercice)\n    exercise.duration = paramsExercice.duration ?? 10\n    exercises.push(exercise)\n  }\n  return exercises\n}\n","import { writable } from 'svelte/store'\n\nexport type VendorEntity = {\n  name: string\n  logoPath: string\n}\nexport type Vendor = {\n  brand: VendorEntity\n  product: VendorEntity\n}\n\nexport const vendor = writable<Vendor>({\n  brand: {\n    name: 'bordas',\n    logoPath: '',\n  },\n  product: {\n    name: 'indices',\n    logoPath: 'assets/images/vendors/bordas/indicesbordas-logo.png',\n  },\n})\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import type { CanState } from '../../../../lib/types/can'\n  import { canOptions } from '../../../../lib/stores/canStore'\n  export let state: CanState\n  export let count: number = 6\n  onMount(() => {\n    const counter = document.getElementById('counter')\n    if (counter) {\n      const interval = window.setInterval(() => {\n        const nextcount = --count\n        if (nextcount === 0) {\n          window.clearInterval(interval)\n          canOptions.update((options) => {\n            options.state = 'race'\n            return options\n          })\n          state = 'race'\n        }\n        requestAnimationFrame(() => {\n          counter.textContent = nextcount.toString()\n          counter.classList.remove('big')\n          requestAnimationFrame(() => {\n            counter.classList.add('big')\n          })\n        })\n      }, 1000)\n    }\n  })\n</script>\n\n<div\n  class=\"h-full w-full flex flex-col items-center justify-center bg-coopmaths-struct dark:bg-coopmathsdark-canvas text-coopmaths-canvas dark:text-coopmathsdark-corpus\"\n>\n  <div id=\"counter\" class=\"big font-black\">3</div>\n</div>\n\n<style>\n  #counter.big {\n    font-size: 2000%;\n    opacity: 0;\n    transition: all linear 1s;\n  }\n</style>\n","<script lang=\"ts\">\n  export let text: string\n  export let title: string = ''\n  export let disabled: boolean = false\n  export let icon: string = ''\n  export let iconFirst: boolean = true\n</script>\n\n<button\n  type=\"button\"\n  {title}\n  id=\"{$$props.id}\"\n  class=\"{$$props.class || 'rounded-lg py-1 px-2'}\"\n  {disabled}\n  on:click\n>\n  {#if iconFirst}\n    {#if icon !== ''}\n      <i class=\"bx {icon} pr-1\"></i>\n    {/if}\n    {text}\n  {:else}\n    {text}\n    {#if icon !== ''}\n      <i class=\"bx {icon} pl-1\"></i>\n    {/if}\n  {/if}\n</button>\n","<script lang=\"ts\">\n  import ButtonText from './ButtonText.svelte'\n  export let text: string\n  export let title: string = ''\n  export let disabled: boolean = false\n  export let icon: string = ''\n  export let inverted: boolean = false\n  export let iconFirst = true\n</script>\n\n<ButtonText\n  id=\"{$$props.id}\"\n  class=\"{$$props.class || 'rounded-lg py-1 px-2'}\n    {disabled\n    ? 'dark:bg-coopmathsdark-action bg-opacity-10 dark:bg-opacity-10'\n    : ''}\n    {inverted\n    ? `border border-coopmaths-action\n        text-coopmaths-action dark:text-coopmathsdark-action\n        bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\n        hover:bg-coopmaths-action dark:hover:bg-coopmathsdark-action\n        hover:text-coopmaths-canvas dark:hover:text-coopmathsdark-canvas`\n    : `text-coopmaths-canvas dark:text-coopmathsdark-canvas\n        bg-coopmaths-action dark:bg-coopmathsdark-action\n        hover:bg-coopmaths-action-lightest dark:hover:bg-coopmathsdark-action-lightest`}\"\n  {text}\n  {title}\n  {disabled}\n  {icon}\n  {inverted}\n  {iconFirst}\n  on:click\n/>\n","<script lang=\"ts\">\n  import ButtonTextAction from '../../../shared/forms/ButtonTextAction.svelte'\n  import { canOptions } from '../../../../lib/stores/canStore'\n  import type { CanState } from '../../../../lib/types/can'\n  export let state: CanState\n  export let score: string\n  export let time: string\n</script>\n\n<div\n  class=\"h-full w-full flex flex-col items-center justify-center bg-coopmaths-struct dark:bg-coopmathsdark-canvas\"\n>\n  <div\n    id=\"counter\"\n    class=\"text-[130px] text-coopmaths-canvas dark:text-coopmathsdark-corpus font-black\"\n  >\n    Fin !\n  </div>\n  <div\n    class=\"flex flex-col md:flex-row space-x-0 md:space-x-4 space-y-2 md:space-y-0 py-4 md:py-10 items-center\"\n  >\n    {#if $canOptions.isInteractive}\n      <div\n        id=\"score\"\n        class=\"text-3xl md:text-7xl text-coopmaths-canvas dark:text-coopmathsdark-corpus font-light\"\n      >\n        Score : <span\n          class=\"text-coopmaths-warn-800 dark:text-coopmathsdark-warn font-bold\"\n          >{score}</span\n        >\n      </div>\n      <div\n        class=\"hidden md:flex text-coopmaths-canvas dark:text-coopmathsdark-corpus text-3xl md:text-7xl\"\n      >\n        &nbsp;&nbsp;\n      </div>\n    {/if}\n    <div\n      id=\"score\"\n      class=\"text-3xl md:text-7xl text-coopmaths-canvas dark:text-coopmathsdark-corpus font-light\"\n    >\n      Temps : <span\n        class=\"text-coopmaths-warn-800 dark:text-coopmathsdark-warn font-bold\"\n        >{time}</span\n      >\n    </div>\n  </div>\n  {#if $canOptions.solutionsAccess}\n    <ButtonTextAction\n      text=\"Accder aux solutions\"\n      class=\"p-2 md:p-4 font-bold rounded-lg text-sm md:text-xl mt-6 md:mt-10\"\n      on:click=\"{() => {\n        state = 'solutions'\n      }}\"\n    />\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { assignmentDataFromCapytale } from '../../../../lib/handleCapytale'\n  import type { CanState } from '../../../../lib/types/can'\n  import ButtonTextAction from '../../../shared/forms/ButtonTextAction.svelte'\n  export let state: CanState\n  export let title = 'Course aux Nombres'\n  export let subTitle = '2023'\n\n  /**\n   * Construit la chane qui sera affiche pour le score\n   * nombre de points obtenu / nombre de questions\n   */\n  function buildStringScore(): string {\n    const score = getScore()\n    if (assignmentDataFromCapytale?.resultsByQuestion !== undefined) {\n      return `Meilleur score : ${score} / ${assignmentDataFromCapytale?.resultsByQuestion.length} en ${assignmentDataFromCapytale?.duration} s`\n    } else {\n      return ''\n    }\n  }\n\n  function getScore(): number {\n    let score = 0\n    if (assignmentDataFromCapytale?.resultsByQuestion !== undefined) {\n      for (const result of assignmentDataFromCapytale?.resultsByQuestion) {\n        if (result === true) {\n          score++\n        }\n      }\n    }\n    return score\n  }\n</script>\n\n<div\n  class=\"h-full w-full flex flex-col items-center justify-center bg-coopmaths-struct dark:bg-coopmathsdark-canvas text-coopmaths-canvas dark:text-coopmathsdark-corpus\"\n>\n  <div class=\"font-black text-center uppercase text-6xl md:text-[130px]\">\n    {title}\n  </div>\n  <div class=\"pt-2 md:pt-6 font-extralight text-5xl md:text-[100px]\">\n    {subTitle}\n  </div>\n  <div class=\"pt-2 md:pt-6 font-extralight text-3xl\">\n    {buildStringScore()}\n  </div>\n  <div class=\"pt-10\">\n    {#if state === 'start'}\n      <ButtonTextAction\n        class=\"py-3 px-6 text-3xl rounded-xl flex flex-row-reverse items-center space-x-6 font-bold animate-pulse\"\n        text=\"Dmarrer\"\n        icon=\"bx-play bx-lg pl-1\"\n        on:click=\"{() => {\n          state = 'countdown'\n        }}\"\n      />\n    {/if}\n  </div>\n  <slot />\n</div>\n","import { writable } from 'svelte/store'\nimport type {\n  AlphanumericPages,\n  BlockForKeyboard,\n} from '../types/keyboardContent'\n\nexport const keyboardState = writable<{\n  isVisible: boolean\n  isInLine: boolean\n  idMathField: string\n  alphanumericLayout: AlphanumericPages\n  blocks: BlockForKeyboard[]\n}>({\n  isVisible: false,\n  isInLine: !('ontouchstart' in window),\n  idMathField: '',\n  alphanumericLayout: 'AlphaLow',\n  blocks: ['numbers', 'fullOperations'],\n})\n","import loadjs from 'loadjs'\nimport { MathfieldElement } from 'mathlive'\nimport { get } from 'svelte/store'\nimport { keyboardState } from '../components/keyboard/stores/keyboardStore'\nimport { getKeyboardShortcusts } from '../lib/interactif/claviers/keyboard'\nimport { globalOptions } from '../lib/stores/generalStore'\nimport { context } from './context'\nimport { UserFriendlyError } from './messages'\n/**\n * Nos applis prdtermines avec la liste des fichiers  charger\n * @type {Object}\n */\nconst apps = {\n  scratchblocks: 'assets/externalJs/scratchblocks-v3.5-min',\n  slick: [\n    '/assets/externalJs/semantic-ui/semantic.min.css',\n    '/assets/externalJs/semantic-ui/semantic.min',\n    '/assets/externalJs/semantic-ui/components/state.min',\n  ],\n}\n\n/**\n * Charge une appli liste dans apps (pour mutualiser l'appel de loadjs)\n * @private\n * @param {string} name\n * @return {Promise<undefined, Error>} promesse de chargement\n */\nasync function load(name) {\n  // on est dans une fct async, si l'une de ces deux lignes plantent a va retourner une promesse rejete avec l'erreur\n  if (!apps[name]) throw UserFriendlyError(`application ${name} inconnue`)\n  // cf https://github.com/muicss/loadjs\n  try {\n    if (!loadjs.isDefined(name)) {\n      await loadjs(apps[name], name, { returnPromise: true })\n    }\n  } catch (error) {\n    console.error(error)\n    throw new UserFriendlyError(`Le chargement de ${name} a chou`)\n  }\n  // loadjs.ready veut une callback, on emballe a dans une promesse\n  return new Promise((resolve, reject) => {\n    loadjs.ready(name, {\n      success: resolve,\n      // si le chargement prcdent a russi on voit pas trop comment on pourrait arriver l, mais a reste plus prudent de grer l'erreur ventuelle\n      error: () =>\n        reject(new UserFriendlyError(`Le chargement de ${name} a chou`)),\n    })\n  })\n}\n\n/**\n * Charge prism\n * @return {Promise<undefined>}\n */\nexport function loadPrism() {\n  return load('prism')\n}\n\n/**\n * Charge scratchblocks\n * @return {Promise} qui peut chouer\n */\nexport function loadScratchblocks() {\n  return load('scratchblocks')\n}\n\n/**\n * Charge MathLive et personnalise les rglages\n * MathLive est charg ds qu'un tag math-field est cr\n */\nexport async function loadMathLive(divExercice) {\n  await import('mathlive')\n  let champs\n  if (divExercice) {\n    champs = divExercice.getElementsByTagName('math-field')\n  } else {\n    champs = document.getElementsByTagName('math-field')\n  }\n  if (champs != null) {\n    for (const mf of champs) {\n      if (mf instanceof MathfieldElement) {\n        if (mf.classList.contains('fillInTheBlanks')) {\n          mf.classList.remove('invisible')\n        }\n        mf.classList.add('ml-1')\n        mf.addEventListener('focus', handleFocusMathField)\n        mf.addEventListener('focusout', handleFocusOutMathField)\n        mf.addEventListener('input', () => {\n          const content = mf.getValue()\n          // Remplace les espaces conscutifs par un seul espace\n          const filteredContent = content.replaceAll('\\\\,\\\\,', '\\\\,')\n          mf.setValue(filteredContent)\n        })\n        if (mf.getAttribute('data-space') === 'true') {\n          mf.mathModeSpace = '\\\\,'\n        }\n\n        if (mf.isConnected) {\n          // mf is already in the DOM. You can check if it's ready by accessing a property.\n          setMathfield(mf)\n        } else {\n          // Add a listener for the `mount` event in case it's not mounted yet.\n          mf.addEventListener('mount', setMathfield, { once: true })\n        }\n      }\n    }\n    // On envoie la hauteur de l'iFrame aprs le chargement des champs MathLive\n    if (context.vue === 'exMoodle') {\n      const hauteurExercice =\n        window.document.querySelector('section').scrollHeight\n      window.parent.postMessage(\n        {\n          hauteurExercice,\n          iMoodle: parseInt(\n            new URLSearchParams(window.location.search).get('iMoodle'),\n          ),\n        },\n        '*',\n      )\n      const domExerciceInteractifReady = new window.Event(\n        'domExerciceInteractifReady',\n        { bubbles: true },\n      )\n      document.dispatchEvent(domExerciceInteractifReady)\n    }\n  }\n}\n\nfunction handleFocusMathField(event) {\n  const mf = event.target\n  const isFillInTheBlanks = mf.classList.contains('fillInTheBlanks')\n  const isNotFillInTheBlanksAndReadOnly = !isFillInTheBlanks && mf.readOnly\n  const isCorrected =\n    isNotFillInTheBlanksAndReadOnly || mf.classList.contains('corrected')\n  getKeyboardShortcusts(mf)\n  keyboardState.update((value) => {\n    return {\n      isVisible: true && !isCorrected, // Les fiilInTheBlanks sont toujours readOnly\n      isInLine: value.isInLine,\n      idMathField: event.target.id,\n      alphanumericLayout: value.alphanumericLayout,\n      blocks:\n        'keyboard' in mf.dataset\n          ? mf.dataset.keyboard.split(' ')\n          : ['numbers', 'fullOperations', 'variables'],\n    }\n  })\n}\n\nfunction handleFocusOutMathField() {\n  // Si le focus est sur un autre lment que mathfield, on cache le clavier\n  // On utilise setTimeout pour tre sr que le focus soit bien sur le nouvel lment\n  // car au focusout, le focus est sur body\n  if (get(globalOptions).v === 'can') return\n  setTimeout(() => {\n    if (document.activeElement.tagName !== 'MATH-FIELD') {\n      keyboardState.update((value) => {\n        const newValue = value\n        newValue.isVisible = false\n        return newValue\n      })\n    }\n  }, 200)\n}\n\nfunction setMathfield(mf) {\n  if ('mathVirtualKeyboardPolicy' in mf) mf.mathVirtualKeyboardPolicy = 'manual'\n  if ('menuItems' in mf) mf.menuItems = []\n  if ('virtualKeyboardMode' in mf) mf.virtualKeyboardMode = 'manual'\n  mf.removeEventListener('mount', setMathfield)\n}\n","import { addElement, get, setStyles } from '../html/dom'\nimport { afficheScore } from './afficheScore'\n\nexport function mouseOverSvgEffect() {\n  this.style.border = '1px solid #1DA962'\n}\n\nexport function mouseOutSvgEffect() {\n  this.style.border = 'none'\n}\n\nexport function mouseSvgClick() {\n  if (this.etat) {\n    // Dja choisi, donc on le rinitialise\n    this.style.border = 'none'\n    this.addEventListener('mouseover', mouseOverSvgEffect)\n    this.addEventListener('mouseout', mouseOutSvgEffect)\n    this.addEventListener('click', mouseSvgClick)\n    this.etat = false\n  } else {\n    // Passe  l'tat choisi donc on dsactive les listenners pour over et pour out\n    this.removeEventListener('mouseover', mouseOverSvgEffect)\n    this.removeEventListener('mouseout', mouseOutSvgEffect)\n    this.style.border = '3px solid #f15929'\n    this.etat = true\n  }\n}\n\n/**\n * Retrouve les numros des figures cliques dans une question de type \"cliqueFigure\"\n */\nexport function indexQuestionCliqueFigure(exercice, i) {\n  const elementArray = []\n  for (let j = 0; j < exercice.figures[i].length; j++) {\n    const eltFigure = document.getElementById(exercice.figures[i][j].id)\n    elementArray.push(eltFigure)\n  }\n\n  function documentPositionComparator(a, b) {\n    if (a === b) {\n      return 0\n    }\n    const position = a.compareDocumentPosition(b)\n\n    if (\n      position & Node.DOCUMENT_POSITION_FOLLOWING ||\n      position & Node.DOCUMENT_POSITION_CONTAINED_BY\n    ) {\n      return -1\n    } else if (\n      position & Node.DOCUMENT_POSITION_PRECEDING ||\n      position & Node.DOCUMENT_POSITION_CONTAINS\n    ) {\n      return 1\n    } else {\n      return 0\n    }\n  }\n  const figs = elementArray.sort(documentPositionComparator)\n  const numbs = []\n  for (let j = 0; j < figs.length; j++) {\n    if (figs[j].etat) numbs.push((j + 1).toString())\n  }\n  return numbs.join(';')\n}\n\nexport function verifQuestionCliqueFigure(exercice, i) {\n  // Le get est non strict car on sait que l'lment n'existe pas  la premire itration de l'exercice\n  let eltFeedback = get(`resultatCheckEx${exercice.numeroExercice}Q${i}`, false)\n  // On ajoute le div pour le feedback\n  if (!eltFeedback) {\n    const eltExercice = get(`exercice${exercice.numeroExercice}`)\n    eltFeedback = addElement(eltExercice, 'div', {\n      id: `resultatCheckEx${exercice.numeroExercice}Q${i}`,\n    })\n  }\n  if (exercice.answers === undefined) {\n    exercice.answers = {}\n  }\n  setStyles(eltFeedback, 'marginBottom: 20px')\n  if (eltFeedback) eltFeedback.innerHTML = ''\n  let erreur = false // Aucune erreur dtecte\n  let nbFiguresCliquees = 0\n  for (const objetFigure of exercice.figures[i]) {\n    const eltFigure = document.getElementById(objetFigure.id)\n    eltFigure.removeEventListener('mouseover', mouseOverSvgEffect)\n    eltFigure.removeEventListener('mouseout', mouseOutSvgEffect)\n    eltFigure.removeEventListener('click', mouseSvgClick)\n    eltFigure.hasMathaleaListener = false\n    if (eltFigure.etat) nbFiguresCliquees++\n    if (eltFigure.etat) exercice.answers[objetFigure.id] = '1'\n    if (eltFigure.etat !== objetFigure.solution) erreur = true\n  }\n  if (nbFiguresCliquees > 0 && !erreur) {\n    eltFeedback.innerHTML = ''\n    return 'OK'\n  } else {\n    eltFeedback.innerHTML = ''\n    return 'KO'\n  }\n}\n\nexport function questionCliqueFigure(figSvg) {\n  if (figSvg) {\n    if (!figSvg.hasMathaleaListener) {\n      figSvg.addEventListener('mouseover', mouseOverSvgEffect)\n      figSvg.addEventListener('mouseout', mouseOutSvgEffect)\n      figSvg.addEventListener('click', mouseSvgClick)\n      figSvg.etat = false\n      figSvg.style.margin = '10px'\n      figSvg.hasMathaleaListener = true\n      // On enregistre que l'lment a dj un listenner pour ne pas lui remettre le mme  l'appui sur \"Nouvelles Donnes\"\n    }\n  }\n}\n\nexport function exerciceCliqueFigure(exercice) {\n  document.addEventListener('exercicesAffiches', () => {\n    // Ds que l'exercice est affich, on rajoute des listenners sur chaque lments de this.figures.\n    for (let i = 0; i < exercice.nbQuestions; i++) {\n      for (const objetFigure of exercice.figures[i]) {\n        const figSvg = document.getElementById(objetFigure.id)\n        questionCliqueFigure(figSvg)\n      }\n    }\n    // Gestion de la correction\n    const button = document.querySelector(\n      `#btnValidationEx${exercice.numeroExercice}-${exercice.id}`,\n    )\n    if (button) {\n      if (!button.hasMathaleaListener) {\n        button.addEventListener('click', (event) => {\n          let nbBonnesReponses = 0\n          let nbMauvaisesReponses = 0\n          for (let i = 0; i < exercice.nbQuestions; i++) {\n            verifQuestionCliqueFigure(exercice, i) === 'OK'\n              ? nbBonnesReponses++\n              : nbMauvaisesReponses++\n          }\n          afficheScore(exercice, nbBonnesReponses, nbMauvaisesReponses)\n        })\n        button.hasMathaleaListener = true\n      }\n    }\n  })\n}\n","<script lang=\"ts\">\n  import { afterUpdate, onMount } from 'svelte'\n  import { mathaleaRenderDiv } from '../../../../lib/mathalea'\n  import { setSizeWithinSvgContainer } from '../../../../lib/components/sizeTools'\n  import { loadMathLive } from '../../../../modules/loaders'\n  import { keyboardState } from '../../../keyboard/stores/keyboardStore'\n  import type { MathfieldElement } from 'mathlive'\n  import { canOptions } from '../../../../lib/stores/canStore'\n  import { questionCliqueFigure } from '../../../../lib/interactif/cliqueFigure'\n\n  export let question: string\n  export let consigne: string\n  export let correction: string\n  export let consigneCorrection: string\n  export let mode: 'display' | 'correction' = 'display'\n  export let visible: boolean\n  export let index: number\n  export let nextQuestion: () => void\n\n  let questionContainer: HTMLDivElement\n  import { onDestroy } from 'svelte'\n\n  onDestroy(() => {\n    const mf = questionContainer?.querySelector(\n      'math-field',\n    ) as MathfieldElement\n    if (mf) {\n      mf.removeEventListener('keyup', handleKeyUp)\n      mf.removeEventListener('input', handleMathfieldElement)\n    }\n  })\n  onMount(() => {\n    const questionContent = document.getElementById(\n      `question-content-${index}`,\n    ) as HTMLDivElement\n    if (questionContent) {\n      mathaleaRenderDiv(questionContent)\n      setSizeWithinSvgContainer(questionContent)\n    }\n    loadMathLive()\n  })\n\n  afterUpdate(() => {\n    if (visible) {\n      updateInteractivity()\n      const questionContent = document.getElementById(\n        `question-content-${index}`,\n      ) as HTMLDivElement\n      setSizeWithinSvgContainer(questionContent)\n    }\n  })\n\n  function handleKeyUp(e: KeyboardEvent) {\n    /* MGu obliger de mettre l'event quand on relache la touche, car sinon events multiples pour la mme touche */\n    if (e.key === 'Enter') {\n      nextQuestion()\n    }\n  }\n\n  function handleMathfieldElement(this: HTMLElement, ev: Event) {\n    /* ca peut venir du clavier vituel ou du clavier physique */\n    if ((this as MathfieldElement).value !== '') {\n      if ($canOptions.questionGetAnswer[index] !== true) {\n        $canOptions.questionGetAnswer[index] = true\n      }\n    } else {\n      if ($canOptions.questionGetAnswer[index] !== false) {\n        $canOptions.questionGetAnswer[index] = false\n      }\n    }\n  }\n\n  function updateInteractivity() {\n    if (questionContainer) {\n      const mf = questionContainer?.querySelector(\n        'math-field',\n      ) as MathfieldElement\n      if (mf) {\n        if (!mf.dataset.listenerAdded) {\n          mf.dataset.listenerAdded = 'true' // Marquer comme ajout\n          mf.addEventListener('keyup', handleKeyUp)\n          mf.addEventListener('input', handleMathfieldElement)\n        }\n        $keyboardState.idMathField = mf.id\n        window.setTimeout(() => {\n          mf.focus()\n          // @ToFix Je remets le clavier visible pour les fillInTheBlanks mais en fait je ne sais pas ce qui les rend invisibles\n          // Mgu je n'ai pas reproduit le problme ...\n          // $keyboardState.isVisible = true\n        }, 0)\n        return\n      }\n\n      const figureCliquables =\n        questionContainer?.querySelectorAll<HTMLInputElement>(\n          '[id^=\"cliquefigure\"]',\n        )\n      if (figureCliquables.length > 0) {\n        $keyboardState.isVisible = false\n        for (const figureCliquable of figureCliquables) {\n          questionCliqueFigure(figureCliquable)\n          if (!figureCliquable.dataset.listenerAdded) {\n            figureCliquable.dataset.listenerAdded = 'true' // Marquer comme ajout\n            figureCliquable.addEventListener('click', () => {\n              const val = Array.from(figureCliquables).reduce((acc, b) => {\n                if ((b as any).etat) {\n                  acc = true\n                }\n                return acc\n              }, false)\n              // au moins une figure coche\n              if ($canOptions.questionGetAnswer[index] !== val) {\n                $canOptions.questionGetAnswer[index] = val\n              }\n            })\n          }\n        }\n        return\n      }\n\n      const clocks =\n        questionContainer?.querySelectorAll<HTMLInputElement>('[id^=\"clockEx\"]')\n      if (clocks.length > 0) {\n        $keyboardState.isVisible = false\n        if (!clocks[0].dataset.listenerAdded) {\n          clocks[0].dataset.listenerAdded = 'true' // Marquer comme ajout\n          clocks[0].addEventListener('click', () => {\n            if ($canOptions.questionGetAnswer[index] !== true) {\n              $canOptions.questionGetAnswer[index] = true\n            }\n          })\n        }\n        return\n      }\n\n      const qcm = questionContainer?.querySelectorAll<HTMLInputElement>(\n        'input[id^=\"checkEx\"]',\n      )\n      if (qcm.length > 0) {\n        $keyboardState.isVisible = false\n        for (const box of qcm) {\n          if (!box.dataset.listenerAdded) {\n            box.dataset.listenerAdded = 'true' // Marquer comme ajout\n            box.addEventListener('click', () => {\n              const val = Array.from(qcm).reduce((acc, b) => {\n                if (b.checked) {\n                  acc = true\n                }\n                return acc\n              }, false)\n              // au moins 1 coch\n              if ($canOptions.questionGetAnswer[index] !== val) {\n                $canOptions.questionGetAnswer[index] = val\n              }\n            })\n          }\n        }\n        return\n      }\n\n      const apigeoms =\n        questionContainer?.querySelectorAll<HTMLElement>('[id^=\"apigeom\"]')\n      if (apigeoms.length > 0) {\n        $keyboardState.isVisible = false\n        if (!apigeoms[0].dataset.listenerAdded) {\n          apigeoms[0].dataset.listenerAdded = 'true' // Marquer comme ajout\n\n          function handleApigeomClick(this: HTMLElement, ev: Event) {\n            // MGu: il faudrait faire mieux mais bon...\n            // Un click sur la figure ne fonctionne pas car dans apigeom, il ne se propage pas...\n            // donc on surveille mouseleave ou touchend est suffisant pour valider la question\n            if ($canOptions.questionGetAnswer[index] !== true) {\n              $canOptions.questionGetAnswer[index] = true\n            }\n          }\n          apigeoms[0]\n            .querySelector('#divFigure > svg')\n            ?.addEventListener('pointerleave', handleApigeomClick)\n        }\n        return\n      }\n\n      const selects =\n        questionContainer?.querySelectorAll<HTMLSelectElement>(\n          'select[id^=\"ex\"]',\n        )\n      if (selects.length > 0) {\n        $keyboardState.isVisible = false\n        for (const select of selects) {\n          if (!select.dataset.listenerAdded) {\n            select.dataset.listenerAdded = 'true' // Marquer comme ajout\n            select.addEventListener('change', function () {\n              if (select.selectedIndex > 0) {\n                if ($canOptions.questionGetAnswer[index] !== true) {\n                  $canOptions.questionGetAnswer[index] = true\n                }\n              } else {\n                if ($canOptions.questionGetAnswer[index] !== false) {\n                  $canOptions.questionGetAnswer[index] = false\n                }\n              }\n            })\n          }\n        }\n        return\n      }\n\n      const rectangles = questionContainer?.querySelectorAll<HTMLInputElement>(\n        '[id^=\"rectangle\"].rectangleDND',\n      )\n      if (rectangles.length > 0) {\n        $keyboardState.isVisible = false\n        for (const rectangle of rectangles) {\n          if (!rectangle.dataset.listenerAdded) {\n            rectangle.dataset.listenerAdded = 'true' // Marquer comme ajout\n            const onHoverEnd = function () {\n              const divCount = rectangle.querySelectorAll(':scope > div').length\n              if (divCount > 0) {\n                if ($canOptions.questionGetAnswer[index] !== true) {\n                  $canOptions.questionGetAnswer[index] = true\n                }\n              } else {\n                if ($canOptions.questionGetAnswer[index] !== false) {\n                  $canOptions.questionGetAnswer[index] = false\n                }\n              }\n            }\n            rectangle.addEventListener('mouseleave', onHoverEnd)\n            rectangle.addEventListener('touchend', onHoverEnd)\n          }\n        }\n        return\n      }\n    }\n  }\n</script>\n\n<div\n  id=\"question-content-{index}\"\n  class=\"{visible\n    ? 'px-4 md:px-20 lg:px-32 flex flex-col justify-center items-center font-normal leading-relaxed h-[100%]  w-[100%] text-center'\n    : 'hidden'}\"\n  bind:this=\"{questionContainer}\"\n>\n  {#if mode === 'display' || mode === 'correction'}\n    <div\n      style=\"padding:15px;\"\n      class=\"flex flex-col overflow-x-auto overflow-y-auto\"\n    >\n      <div class=\"text-pretty\">\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html consigne}\n      </div>\n      <div class=\"text-pretty\" style=\"\">\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html question}\n      </div>\n    </div>\n  {/if}\n\n  {#if mode === 'correction'}\n    <div\n      class=\"relative flex p-4 mt-10 bg-coopmaths-warn-200 dark:bg-coopmathsdark-warn-lightest text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n    >\n      <div class=\"text-pretty\">\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html consigneCorrection}\n      </div>\n      <div class=\"text-pretty\">\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html correction}\n      </div>\n      <div\n        class=\"flex absolute top-8 -left-12 font-bold text-xl text-coopmaths-warn-1000 dark:text-coopmathsdark-warn-dark -rotate-90\"\n      >\n        Solution\n      </div>\n    </div>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { canOptions } from '../../../../lib/stores/canStore'\n  import type { CanState } from '../../../../lib/types/can'\n\n  export let current: number\n  export let numberOfQuestions: number\n  export let state: CanState\n  export let resultsByQuestion: boolean[]\n</script>\n\n<nav\n  aria-label=\"course pagination\"\n  class=\"w-full hidden md:flex flex-row justify-center items-centers py-4\"\n>\n  <u\n    class=\"list-none w-full flex flex-row flex-wrap justify-around items-center\"\n  >\n    {#each [...Array(numberOfQuestions).keys()] as i}\n      <li class=\"relative block\">\n        <button\n          role=\"tab\"\n          aria-controls=\"tab-{i + 1}\"\n          aria-selected=\"{current === i ? 'true' : 'false'}\"\n          type=\"button\"\n          class=\"rounded-full px-3 py-1.5 text-sm md:text-base font-black transition-all duration-300\n        {i === current\n            ? 'text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-struct dark:bg-coopmathsdark-struct'\n            : 'bg-transparent text-coopmaths-action hover:bg-coopmaths-action-lightest hover:bg-opacity-20  dark:text-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest dark:hover:bg-opacity-20'}\"\n          on:click=\"{() => {\n            current = i\n          }}\"\n        >\n          {i + 1}\n        </button>\n        {#if state === 'race'}\n          <div\n            class=\"absolute -bottom-1 left-1/2 -translate-x-1/2 h-3 w-3 rounded-full bg-coopmaths-struct\n        {$canOptions.isInteractive && $canOptions.questionGetAnswer[i]\n              ? 'flex'\n              : 'hidden'}\"\n          ></div>\n        {/if}\n        {#if state === 'solutions'}\n          <div class=\"absolute -bottom-1 left-1/2 -translate-x-1/2 flex\">\n            <i\n              class=\"bx {resultsByQuestion[i]\n                ? 'bxs-check-square text-coopmaths-warn-800 dark:text-green-500'\n                : 'bxs-x-square text-red-500 dark:text-coopmathsdark-warn'}\"\n            ></i>\n          </div>\n        {/if}\n      </li>\n    {/each}\n  </u>\n</nav>\n","<script lang=\"ts\">\n  import { canOptions } from '../../../../lib/stores/canStore'\n  import type { CanState } from '../../../../lib/types/can'\n\n  export let current: number\n  export let state: CanState\n  export let resultsByQuestion: boolean[]\n</script>\n\n<div\n  aria-label=\"course pagination\"\n  class=\"w-full md:hidden flex flex-row justify-center items-centers py-4\"\n>\n  <div class=\"relative block\">\n    <div\n      class=\"rounded-full px-3 py-1.5 text-sm md:text-base font-black transition-all duration-300 text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-struct dark:bg-coopmathsdark-struct\"\n    >\n      {current + 1}\n    </div>\n    {#if state === 'race'}\n      <div\n        class=\"absolute -bottom-1 left-1/2 -translate-x-1/2 h-3 w-3 rounded-full bg-coopmaths-struct\n        {$canOptions.isInteractive && $canOptions.questionGetAnswer[current]\n          ? 'flex'\n          : 'hidden'}\"\n      ></div>\n    {/if}\n    {#if state === 'solutions'}\n      <div class=\"absolute -bottom-4 left-1/2 -translate-x-1/2 flex\">\n        <i\n          class=\"bx {resultsByQuestion[current]\n            ? 'bxs-check-square text-coopmaths-warn-800 dark:text-green-500'\n            : 'bxs-x-square text-red-500 dark:text-coopmathsdark-warn'}\"\n        ></i>\n      </div>\n    {/if}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import { swipe } from 'svelte-gestures'\n  import type { CanState } from '../../../../lib/types/can'\n  import { Modal, initTE } from 'tw-elements'\n  import ShortPagination from './ShortPagination.svelte'\n\n  export let current: number\n  export let numberOfQuestions: number\n  export let handleEndOfRace: () => void\n  export let state: CanState\n  export let resultsByQuestion: boolean[]\n\n  onMount(() => {\n    initTE({ Modal })\n    setTimeout(() => {\n      const endButtonDiv = document.getElementById('race-ended-by-user-btn')\n      if (endButtonDiv) {\n        endButtonDiv.removeAttribute('disabled')\n      }\n    }, 5 * 1000)\n  })\n\n  let direction\n\n  function handleSwipe(event: CustomEvent) {\n    direction = event.detail.direction\n    if (direction === 'left' && current < numberOfQuestions - 1) {\n      current += 1\n    }\n    if (direction === 'right' && current > 0) {\n      current -= 1\n    }\n  }\n</script>\n\n<div\n  use:swipe=\"{{ timeframe: 300, minSwipeDistance: 60 }}\"\n  on:swipe=\"{handleSwipe}\"\n  class=\"w-full pb-8 md:pb-10 px-10 space-y-4 flex flex-col md:flex-row justify-start md:justify-between items-center\"\n>\n  <div></div>\n  <div class=\"flex flex-row space-x-10\">\n    <button\n      class=\"md:hidden flex justify-center items-center\"\n      type=\"button\"\n      on:click=\"{() => {\n        if (current >= 10) {\n          current -= 10\n        }\n      }}\"\n    >\n      <i\n        class=\"bx bxs-chevrons-left text-coopmaths-action dark:text-coopmathsdark-action text-3xl md:text-7xl\n            {current < 10\n          ? 'text-opacity-10'\n          : 'text-opacity_100 hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest'}\"\n      ></i>\n    </button>\n    <button\n      type=\"button\"\n      on:click=\"{() => {\n        if (current > 0) {\n          current -= 1\n        }\n      }}\"\n    >\n      <i\n        class=\"bx bxs-chevron-left md:bxs-left-arrow text-coopmaths-action dark:text-coopmathsdark-action text-3xl md:text-7xl\n            {current === 0\n          ? 'text-opacity-10'\n          : 'text-opacity_100 hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest'}\"\n      ></i>\n    </button>\n    <ShortPagination {current} {state} {resultsByQuestion} />\n    <button\n      type=\"button\"\n      on:click=\"{() => {\n        if (current < numberOfQuestions - 1) {\n          current += 1\n        }\n      }}\"\n    >\n      <i\n        class=\"bx bxs-chevron-right md:bxs-right-arrow text-coopmaths-action dark:text-coopmathsdark-action text-3xl md:text-7xl\n            {current === numberOfQuestions - 1\n          ? 'text-opacity-10'\n          : 'text-opacity_100 hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest'}\"\n      ></i>\n    </button>\n    <button\n      class=\"md:hidden flex justify-center items-center\"\n      type=\"button\"\n      on:click=\"{() => {\n        if (current + 10 <= numberOfQuestions - 1) {\n          current += 10\n        }\n      }}\"\n    >\n      <i\n        class=\"bx bxs-chevrons-right text-coopmaths-action dark:text-coopmathsdark-action text-3xl md:text-7xl\n            {current > numberOfQuestions - 11\n          ? 'text-opacity-10'\n          : 'text-opacity_100 hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest'}\"\n      ></i>\n    </button>\n  </div>\n  <div>\n    {#if state === 'race'}\n      <button\n        id=\"race-ended-by-user-btn\"\n        type=\"button\"\n        class=\"inline-block p-2 md:p-4 font-bold rounded-lg text-sm md:text-xl leading-normal text-coopmaths-canvas dark:text-coopmathsdark-canvas transition duration-150 ease-in-out bg-coopmaths-action hover:bg-coopmaths-action-lightest focus:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest dark:focus:bg-coopmathsdark-action-lightest focus:outline-none focus:ring-0 active:bg-coopmaths-action-light dark:active:bg-coopmathsdark-action-light disabled:bg-opacity-10\"\n        data-te-toggle=\"modal\"\n        data-te-target=\"#staticBackdrop\"\n        disabled\n      >\n        Rendre la copie\n      </button>\n    {/if}\n  </div>\n</div>\n<!-- Modal -->\n<div\n  data-te-modal-init\n  class=\"fixed left-0 top-0 z-[1055] hidden h-full w-full overflow-y-auto overflow-x-hidden outline-none\"\n  id=\"staticBackdrop\"\n  data-te-backdrop=\"static\"\n  data-te-keyboard=\"false\"\n  tabindex=\"-1\"\n  aria-labelledby=\"staticBackdropLabel\"\n  aria-hidden=\"true\"\n>\n  <div\n    data-te-modal-dialog-ref\n    class=\"pointer-events-none relative w-auto translate-y-[-50px] opacity-0 transition-all duration-300 ease-in-out min-[576px]:mx-auto min-[576px]:mt-7 min-[576px]:max-w-[500px]\"\n  >\n    <div\n      class=\"min-[576px]:shadow-[0_0.5rem_1rem_rgba(#000, 0.15)] pointer-events-auto relative flex w-full flex-col rounded-md border-none bg-coopmaths-canvas dark:bg-coopmathsdark-canvas bg-clip-padding text-current shadow-lg outline-none\"\n    >\n      <div\n        class=\"flex flex-shrink-0 items-center justify-between rounded-t-md p-4 bg-coopmaths-warn-900 dark:bg-coopmathsdark-warn\"\n      >\n        <!--Modal title-->\n        <h5\n          class=\"text-xl leading-normal text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-warn-900 dark:bg-coopmathsdark-warn font-bold\"\n          id=\"staticBackdropLabel\"\n        >\n          Attention !\n        </h5>\n        <!--Close button-->\n        <button\n          type=\"button\"\n          class=\"box-content rounded-none border-none hover:no-underline hover:opacity-75 focus:opacity-100 focus:shadow-none focus:outline-none text-coopmaths-canvas dark:text-coopmathsdark-canvas-darkest\"\n          data-te-modal-dismiss\n          aria-label=\"Close\"\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke-width=\"1.5\"\n            stroke=\"currentColor\"\n            class=\"h-6 w-6\"\n          >\n            <path\n              stroke-linecap=\"round\"\n              stroke-linejoin=\"round\"\n              d=\"M6 18L18 6M6 6l12 12\"\n            ></path>\n          </svg>\n        </button>\n      </div>\n\n      <!--Modal body-->\n      <div data-te-modal-body-ref class=\"relative p-4\">\n        <div\n          class=\"flex flex-col space-y-4 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n        >\n          <div class=\"w-full flex justify-center items-center p-8\">\n            <i\n              class=\"bx bxs-error text-coopmaths-warn-900 dark:text-coopmathsdark-warn-dark text-[70px]\"\n            ></i>\n          </div>\n          <div>\n            Si vous cliquez sur le bouton\n            <span class=\"font-bold\">Terminer </span>\n            alors vous ne pourrez plus revenir en arrire.\n          </div>\n          <div>Que souhaitez-vous faire ?</div>\n        </div>\n      </div>\n\n      <!--Modal footer-->\n      <div\n        class=\"flex flex-shrink-0 flex-wrap items-center justify-end rounded-b-md border-t-2 border-neutral-100 border-opacity-100 p-4 dark:border-opacity-50\"\n      >\n        <button\n          type=\"button\"\n          class=\"inline-block rounded bg-coopmaths-action-200 dark:bg-coopmathsdark-action-lightest px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal text-coopmaths-action dark:text-coopmathsdark-action-dark transition duration-150 ease-in-out hover:bg-coopmaths-action-400 focus:bg-coopmaths-action-400 dark:hover:bg-coopmathsdark-action-light dark:focus:bg-coopmathsdark-action-light focus:outline-none focus:ring-0 active:bg-coopmaths-action-500 dark:active:bg-coopmathsdark-action-light\"\n          data-te-modal-dismiss\n        >\n          Annuler\n        </button>\n        <button\n          type=\"button\"\n          class=\"ml-1 inline-block rounded bg-coopmaths-action dark:bg-coopmathsdark-action px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal text-coopmaths-canvas dark:text-coopmathsdark-canvas transition duration-150 ease-in-out hover:bg-coopmaths-action-dark focus:bg-coopmaths-action-dark dark:hover:bg-coopmathsdark-action-dark dark:focus:bg-coopmathsdark-action-dark focus:outline-none focus:ring-0 dark:active:bg-coopmathsdark-action-dark\"\n          on:click=\"{() => {\n            handleEndOfRace()\n          }}\"\n          data-te-modal-dismiss\n        >\n          Terminer\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n","import type { Prefix, UnitCategory } from '../types/units'\n\nexport const prefixes = {\n  24: {\n    symbol: 'Y',\n    name: 'yotta',\n  },\n  21: {\n    symbol: 'Z',\n    name: 'zetta',\n  },\n  18: {\n    symbol: 'E',\n    name: 'exa',\n  },\n  15: {\n    symbol: 'P',\n    name: 'peta',\n  },\n  12: {\n    symbol: 'T',\n    name: 'tera',\n  },\n  9: {\n    symbol: 'G',\n    name: 'giga',\n  },\n  6: {\n    symbol: 'M',\n    name: 'mga',\n  },\n  3: {\n    symbol: 'k',\n    name: 'kilo',\n  },\n  2: {\n    symbol: 'h',\n    name: 'hecto',\n  },\n  1: {\n    symbol: 'da',\n    name: 'dca',\n  },\n  0: {\n    symbol: '',\n\n    name: '',\n  },\n  '-1': {\n    symbol: 'd',\n    name: 'dci',\n  },\n  '-2': {\n    symbol: 'c',\n    name: 'centi',\n  },\n  '-3': {\n    symbol: 'm',\n    name: 'milli',\n  },\n  '-6': {\n    symbol: '',\n    name: 'micro',\n  },\n  '-9': {\n    symbol: 'n',\n    name: 'nano',\n  },\n  '-12': {\n    symbol: 'p',\n    name: 'pico',\n  },\n  '-15': {\n    symbol: 'f',\n    name: 'femto',\n  },\n  '-18': {\n    symbol: 'a',\n    name: 'atto',\n  },\n  '-21': {\n    symbol: 'z',\n    name: 'zepto',\n  },\n  '-24': {\n    symbol: 'y',\n    name: 'yocto',\n  },\n}\n\nexport const units = {\n  length: {\n    symbol: 'm',\n    name: 'mtre',\n  },\n  content: {\n    symbol: 'L',\n    name: 'litre',\n  },\n  mass: {\n    symbol: 'g',\n    name: 'gramme',\n  },\n  power: {\n    symbol: 'W',\n    name: 'watt',\n  },\n  current: {\n    symbol: 'A',\n    name: 'ampre',\n  },\n  frequency: {\n    symbol: 'Hz',\n    name: 'hertz',\n  },\n  energy: {\n    symbol: 'J',\n    name: 'joule',\n  },\n  resistance: {\n    symbol: '',\n    name: 'ohm',\n  },\n  potential: {\n    symbol: 'V',\n    name: 'volt',\n  },\n  pressure: {\n    symbol: 'Pa',\n    name: 'pascal',\n  },\n  area: {\n    symbol: 'a',\n    name: 'are',\n  },\n}\n\nexport class Unit {\n  prefix: Prefix\n  category: UnitCategory\n  exp: 1 | 2 | 3\n  name: string\n  symbol: string\n  insert: string\n  private superscript = [\n    {\n      name: '',\n      symbol: '',\n      latexInsert: '',\n    },\n    {\n      name: ' carr',\n      symbol: '',\n      latexInsert: '^2',\n    },\n    {\n      name: ' cube',\n      symbol: '',\n      latexInsert: '^3',\n    },\n  ]\n\n  constructor(pre: Prefix, cat: UnitCategory, e: 1 | 2 | 3 = 1) {\n    this.prefix = pre\n    this.category = cat\n    this.exp = e\n    this.name = [\n      prefixes[this.prefix].name,\n      units[this.category].name,\n      this.superscript[this.exp - 1].name,\n    ].join('')\n    this.symbol = [\n      prefixes[this.prefix].symbol,\n      units[this.category].symbol,\n      this.superscript[this.exp - 1].symbol,\n    ].join('')\n    const symbol = [\n      prefixes[this.prefix].symbol,\n      units[this.category].symbol,\n    ].join('')\n    const pow = this.superscript[this.exp - 1].latexInsert\n    this.insert = `$$\\\\operatorname{ ${symbol}}${pow}$$`\n  }\n}\n\nexport class UnitSystem {\n  units: Unit[]\n  private exp: number\n\n  constructor(prefixList: Prefix[], cat: UnitCategory, e: 1 | 2 | 3 = 1) {\n    this.units = prefixList.map((p) => new Unit(p, cat, e))\n    this.exp = e\n  }\n}\n\nexport const lengthUnits: UnitSystem = new UnitSystem(\n  [3, 2, 1, 0, '-1', '-2', '-3'],\n  'length',\n)\nexport const areaMetricUnits: UnitSystem = new UnitSystem(\n  [3, 2, 1, 0, '-1', '-2', '-3'],\n  'length',\n  2,\n)\nexport const areaOtherUnits: UnitSystem = new UnitSystem([2, 0, '-2'], 'area')\nexport const volumeMetricUnits: UnitSystem = new UnitSystem(\n  [3, 2, 1, 0, '-1', '-2', '-3'],\n  'length',\n  3,\n)\nexport const volumeOtherUnits: UnitSystem = new UnitSystem(\n  [2, 1, 0, '-1', '-2', '-3'],\n  'content',\n)\nexport const massUnits: UnitSystem = new UnitSystem(\n  [3, 2, 1, 0, '-1', '-2', '-3'],\n  'mass',\n)\n","import {\n  areaMetricUnits,\n  areaOtherUnits,\n  lengthUnits,\n  massUnits,\n  volumeMetricUnits,\n  volumeOtherUnits,\n} from './unitsSystem'\n\nconst basicKeys = {\n  // ================== numbers\n  0: { display: '0' },\n  1: { display: '1' },\n  2: { display: '2' },\n  3: { display: '3' },\n  4: { display: '4' },\n  5: { display: '5' },\n  6: { display: '6' },\n  7: { display: '7' },\n  8: { display: '8' },\n  9: { display: '9' },\n  // ================== operations\n  ADD: {\n    display: '+',\n    insert: '+',\n  },\n  SUB: {\n    display: '',\n    insert: '-',\n  },\n  MULT: {\n    display: '$\\\\times$',\n    insert: '\\\\times',\n  },\n  DIV: {\n    display: '$\\\\div$',\n    insert: '\\\\div',\n  },\n  FRAC: {\n    display: '$\\\\frac{\\\\square}{\\\\square}$',\n    insert: '\\\\frac{#@}{#1}',\n  },\n  SQRT: {\n    display: '$\\\\sqrt{\\\\square}$',\n    insert: '\\\\sqrt{#1}',\n  },\n  NORM: {\n    display: '$\\\\vert\\\\square\\\\vert$',\n    insert: '\\\\vert#0\\\\vert',\n  },\n  SQRTN: {\n    display: '$\\\\sqrt[\\\\square]{\\\\square}$',\n    insert: '\\\\sqrt[#1]{#2}',\n  },\n  SQ: {\n    display: '$\\\\square^2$',\n    insert: '^2',\n  },\n  CUBE: {\n    display: '$x^3$',\n    insert: '^3',\n  },\n  POW: {\n    display: '$\\\\square^\\\\square$',\n    insert: '#@^{#0}',\n  },\n  'e^': {\n    display: '$e^{\\\\square}$',\n    insert: 'e^{#0}',\n  },\n  LOG: {\n    display: '$\\\\log(\\\\square)$',\n    insert: '\\\\log(#0)',\n  },\n  LN: {\n    display: '$\\\\ln(\\\\square)$',\n    insert: '\\\\ln(#0)',\n  },\n  POW10: {\n    display: '$\\\\times10^\\\\square$',\n    insert: '$$\\\\times10^#0$$',\n  },\n  // ================== suites\n\n  INDICE: {\n    display: '$\\\\square_\\\\square$',\n    insert: '#@_{#0}',\n  },\n  INDICE_N: {\n    display: '$\\\\square_{n}$',\n    insert: '#@_{n}',\n  },\n  U_INDICE_N: {\n    display: '$u_{n}$',\n    insert: 'u_{n}',\n  },\n  V_INDICE_N: {\n    display: '$v_{n}$',\n    insert: 'v_{n}',\n  },\n  W_INDICE_N: {\n    display: '$w_{n}$',\n    insert: 'w_{n}',\n  },\n  C_INDICE_N: {\n    display: '$c_{n}$',\n    insert: 'c_{n}',\n  },\n\n  // ================== functions\n  COS: {\n    display: 'cos',\n    insert: '\\\\cos(#0)',\n  },\n  SIN: {\n    display: 'sin',\n    insert: '\\\\sin(#0)',\n  },\n  TAN: {\n    display: 'tan',\n    insert: '\\\\tan(#0)',\n  },\n  // ================== symbols\n  COMMA: {\n    display: ',',\n    insert: '{,}',\n  },\n  POINT: {\n    display: '.',\n  },\n  SPACE: {\n    display: '$\\\\tiny\\\\text{espace}$',\n    insert: '\\\\,',\n  },\n  '(': {\n    display: '(',\n    insert: '\\\\lparen',\n  },\n  ')': {\n    display: ')',\n    insert: '\\\\rparen',\n  },\n  PARENTHESES: {\n    display: '$(\\\\square)$',\n    insert: '\\\\lparen#0\\\\rparen',\n  },\n  '{': {\n    display: '{',\n    insert: '$$\\\\{$$',\n  },\n  '}': {\n    display: '}',\n    insert: '$$\\\\}$$',\n  },\n  '[': {\n    display: '[',\n    insert: '$[$',\n  },\n  ']': {\n    display: ']',\n    insert: '$]$',\n  },\n  '=': {\n    display: '=',\n  },\n  DEG: {\n    display: '',\n  },\n  DEGCELSIUS: {\n    display: 'C',\n    insert: 'C',\n  },\n  ANG: {\n    display: '$\\\\widehat{\\\\square}$',\n    insert: '$$\\\\widehat{#0}$$',\n  },\n  PERCENT: {\n    display: '%',\n    insert: '\\\\%',\n  },\n  COLON: {\n    display: ':',\n  },\n  SEMICOLON: {\n    display: ';',\n  },\n  LESS: {\n    display: '<',\n  },\n  GREAT: {\n    display: '>',\n  },\n  LESSEQ: {\n    display: '$\\\\leqslant$',\n    insert: '$$\\\\leqslant$$',\n  },\n  GREATEQ: {\n    display: '$\\\\geqslant$',\n    insert: '$$\\\\geqslant$$',\n  },\n  IN: {\n    display: '$\\\\in$',\n    insert: '$$\\\\in$$',\n  },\n  AST: {\n    display: '*',\n    insert: '$$\\\\ast$$',\n  },\n  SLASH: {\n    display: '/',\n    insert: '\\\\slash',\n  },\n  BACKSLASH: {\n    display: '\\\\',\n    insert: '\\\\backslash',\n  },\n  QUOTE: {\n    display: \"'\",\n    insert: \"{\\\\:\\\\text{'}\\\\:}\",\n  },\n  DBLQUOTE: {\n    display: '\"',\n    insert: '{\\\\:\\\\text{\"}\\\\:}',\n  },\n  INTPOINT: {\n    display: '?',\n    insert: '{\\\\:\\\\text{?}\\\\:}',\n  },\n  EXCPOINT: {\n    display: '!',\n    insert: '{\\\\:\\\\text{!}\\\\:}',\n  },\n  AROBASE: {\n    display: '@',\n    insert: '{\\\\:\\\\text{@}\\\\:}',\n  },\n  HASH: {\n    display: '#',\n    insert: '{\\\\:\\\\text{#}\\\\:}',\n  },\n  DOLLAR: {\n    display: '$',\n    insert: '{\\\\:\\\\text{\\\\$}\\\\:}',\n  },\n  AND: {\n    display: '&',\n    insert: '{\\\\:\\\\text{\\\\&}\\\\:}',\n  },\n  OR: {\n    display: '|',\n    insert: '{\\\\:\\\\text{|}\\\\:}',\n  },\n  TILDE: {\n    display: '~',\n    insert: '$$\\\\sim$$',\n  },\n  BRACKETS: {\n    display: '$[\\\\square]$',\n    insert: '$$[#0]$$',\n  },\n  BRACES: {\n    display: '$\\\\{\\\\square\\\\}$',\n    insert: '$$\\\\{#0\\\\}$$',\n  },\n  VECT: {\n    display: '$\\\\overrightarrow{\\\\square}$',\n    insert: '$$\\\\overrightarrow#0$$',\n  },\n  INFTY: {\n    display: '$\\\\infty$',\n    insert: '\\\\infty',\n  },\n  // ================== letters\n  a: { display: 'a' },\n  b: { display: 'b' },\n  c: { display: 'c' },\n  d: { display: 'd' },\n  e: { display: 'e' },\n  f: { display: 'f' },\n  g: { display: 'g' },\n  h: { display: 'h' },\n  i: { display: 'i' },\n  iComplex: { display: 'i', insert: '\\\\text{i}' },\n  j: { display: 'j' },\n  k: { display: 'k' },\n  l: { display: 'l' },\n  m: { display: 'm' },\n  n: { display: 'n' },\n  o: { display: 'o' },\n  p: { display: 'p' },\n  q: { display: 'q' },\n  r: { display: 'r' },\n  s: { display: 's' },\n  t: { display: 't' },\n  u: { display: 'u' },\n  v: { display: 'v' },\n  w: { display: 'w' },\n  x: { display: 'x' },\n  y: { display: 'y' },\n  z: { display: 'z' },\n  A: { display: 'A' },\n  B: { display: 'B' },\n  C: { display: 'C' },\n  D: { display: 'D' },\n  E: { display: 'E' },\n  F: { display: 'F' },\n  G: { display: 'G' },\n  H: { display: 'H' },\n  I: { display: 'I' },\n  J: { display: 'J' },\n  K: { display: 'K' },\n  L: { display: 'L' },\n  M: { display: 'M' },\n  N: { display: 'N' },\n  O: { display: 'O' },\n  P: { display: 'P' },\n  Q: { display: 'Q' },\n  R: { display: 'R' },\n  S: { display: 'S' },\n  T: { display: 'T' },\n  U: { display: 'U' },\n  V: { display: 'V' },\n  W: { display: 'W' },\n  X: { display: 'X' },\n  Y: { display: 'Y' },\n  Z: { display: 'Z' },\n  // ================== maths letters\n  xMath: { display: '$x$', insert: 'x' },\n  yMath: { display: '$y$', insert: 'y' },\n  zMath: { display: '$z$', insert: 'z' },\n  aMath: { display: '$a$', insert: 'a' },\n  bMath: { display: '$b$', insert: 'b' },\n  cMath: { display: '$c$', insert: 'c' },\n  iMath: { display: '$i$', insert: 'i' },\n  kMath: { display: '$k$', insert: 'k' },\n  nMath: { display: '$n$', insert: 'n' },\n  // ================== greek letters\n  PI: {\n    display: '$\\\\pi$',\n    insert: '\\\\pi',\n  },\n  ALPHA: {\n    display: '',\n    insert: '\\\\alpha',\n  },\n  BETA: {\n    display: '',\n    insert: '\\\\beta',\n  },\n  GAMMA: {\n    display: '',\n    insert: '\\\\gamma',\n  },\n  DELTA: {\n    display: '',\n    insert: '\\\\delta',\n  },\n  EPSILON: {\n    display: '',\n    insert: '\\\\epsilon',\n  },\n  THETA: {\n    display: '',\n    insert: '\\\\theta',\n  },\n  LAMBDA: {\n    display: '',\n    insert: '\\\\lambda',\n  },\n  OMEGA: {\n    display: '',\n    insert: '\\\\omega',\n  },\n  // ================== hours, minutes, secondes\n  WEEK: {\n    display: '$\\\\tiny\\\\text{semaines}$',\n    insert: '{\\\\:\\\\text{semaines}\\\\:}',\n  },\n  DAY: { display: 'j', insert: '{\\\\:\\\\text{j}\\\\:}' },\n  HOUR: { display: 'h', insert: '{\\\\:\\\\text{h}\\\\:}' },\n  MIN: { display: 'min', insert: '{\\\\:\\\\text{min}\\\\:}' },\n  SEC: { display: 's', insert: '{\\\\:\\\\text{s}\\\\:}' },\n  // ================== special keys\n  BACK: {\n    display: '<i class=\"bx bx-arrow-back\"/>',\n    command: ['performWithFeedback', 'moveToPreviousChar'],\n  },\n  FWD: {\n    display: '<i class=\"bx bx-arrow-back bx-rotate-180\"/>',\n    command: ['performWithFeedback', 'moveToNextChar'],\n  },\n  CLOSE: {\n    display: '<i class=\"bx bx-window-close\"/>',\n    command: 'closeKeyboard',\n  },\n  DEL: {\n    display: '',\n    command: ['performWithFeedback', 'deleteBackward'],\n  },\n  ABC: {\n    display: 'ABC',\n  },\n  abc: {\n    display: 'abc',\n  },\n  NUM: {\n    display: '?123',\n  },\n  // =================== sets\n  COMP: {\n    display: '$\\\\mathbb{C}$',\n    insert: '\\\\mathbb{C}',\n  },\n  REAL: {\n    display: '$\\\\mathbb{R}$',\n    insert: '\\\\mathbb{R}',\n  },\n  RATIO: {\n    display: '$\\\\mathbb{Q}$',\n    insert: '\\\\mathbb{Q}',\n  },\n  DECIMAL: {\n    display: '$\\\\mathbb{D}$',\n    insert: '\\\\mathbb{D}',\n  },\n  REL: {\n    display: '$\\\\mathbb{Z}$',\n    insert: '\\\\mathbb{Z}',\n  },\n  INTEG: {\n    display: '$\\\\mathbb{N}$',\n    insert: '\\\\mathbb{N}',\n  },\n  EMPTY: {\n    display: '$\\\\emptyset$',\n    insert: '\\\\emptyset',\n  },\n  UNION: {\n    display: '$\\\\cup$',\n    insert: '\\\\cup',\n  },\n  INTER: {\n    display: '$\\\\cap$',\n    insert: '\\\\cap',\n  },\n  // =================== functions\n  LIM: {\n    display: '$\\\\lim\\\\limits_{\\\\square\\\\to\\\\square}$',\n    insert: '$$\\\\lim_{#0\\\\to\\\\ #1}}$$',\n  },\n  FCT: {\n    display: '$f(\\\\square)$',\n    insert: '$$f(#0)$$',\n  },\n  SIGMA: {\n    display: '$\\\\sum\\\\limits_{\\\\square}^{\\\\square}$',\n    insert: '$$\\\\sum_#0^#1$$',\n  },\n  INT: {\n    display: '$\\\\int_{\\\\square}^{\\\\square}$',\n    insert: '$$\\\\int_#0^#1$$',\n  },\n  // =================== probabilities\n  BINOM: {\n    display: '$\\\\tbinom{\\\\square}{\\\\square}$',\n    insert: '$$\\\\tbinom{#0}{#1}$$',\n  },\n  PROB: {\n    display: '$P_{\\\\square}({\\\\square})$',\n    insert: '$$P_{#0}({#1})$$',\n  },\n  OVERLINE: {\n    display: '$\\\\overline{\\\\square}$',\n    insert: '$$\\\\overline{#0}$$',\n  },\n  Vrai: {\n    display: '$\\\\text{Vrai}$',\n    insert: '\\\\text{Vrai}',\n  },\n  Faux: {\n    display: '$\\\\text{Faux}$',\n    insert: '\\\\text{Faux}',\n  },\n  // =================== numration\n  MILLION: {\n    display: '$\\\\tiny\\\\text{million}$',\n    insert: '\\\\text{million}',\n  },\n  MILLIARD: {\n    display: '$\\\\tiny\\\\text{milliard}$',\n    insert: '\\\\text{milliard}',\n  },\n  MILLE: {\n    display: '$\\\\tiny\\\\text{mille}$',\n    insert: '\\\\text{mille}',\n  },\n  CENTAINE: {\n    display: '$\\\\tiny\\\\text{centaine}$',\n    insert: '\\\\text{centaine}',\n  },\n  DIZAINE: {\n    display: '$\\\\tiny\\\\text{dizaine}$',\n    insert: '\\\\text{dizaine}',\n  },\n  UNITE: {\n    display: '$\\\\tiny\\\\text{unit}$',\n    insert: '\\\\text{unit}',\n  },\n  DE: {\n    display: '$\\\\tiny\\\\text{ de }$',\n    insert: '\\\\text{ de }',\n  },\n  DIXIEME: {\n    display: '$\\\\tiny\\\\text{dixime}$',\n    insert: '\\\\text{dixime}',\n  },\n  CENTIEME: {\n    display: '$\\\\tiny\\\\text{centime}$',\n    insert: '\\\\text{centime}',\n  },\n  MILLIEME: {\n    display: '$\\\\tiny\\\\text{millime}$',\n    insert: '\\\\text{millime}',\n  },\n  DIX_MILLIEME: {\n    display: '$\\\\tiny\\\\text{dix-millime}$',\n    insert: '\\\\text{dix-millime}',\n  },\n  CENT_MILLIEME: {\n    display: '$\\\\tiny\\\\text{cent-millime}$',\n    insert: '\\\\text{cent-millime}',\n  },\n  MILLIONIEME: {\n    display: '$\\\\tiny\\\\text{millionime}$',\n    insert: '\\\\text{millionime}',\n  },\n  HYPHEN: {\n    display: '$\\\\tiny\\\\text{-}$',\n    insert: '\\\\text{-}',\n  },\n  DIX: {\n    display: '$\\\\tiny\\\\text{dix}$',\n    insert: '\\\\text{dix}',\n  },\n  VINGT: {\n    display: '$\\\\tiny\\\\text{vingt}$',\n    insert: '\\\\text{vingt}',\n  },\n  TRENTE: {\n    display: '$\\\\tiny\\\\text{trente}$',\n    insert: '\\\\text{trente}',\n  },\n  QUARANTE: {\n    display: '$\\\\tiny\\\\text{quarante}$',\n    insert: '\\\\text{quarante}',\n  },\n  CINQUANTE: {\n    display: '$\\\\tiny\\\\text{cinquante}$',\n    insert: '\\\\text{cinquante}',\n  },\n  SOIXANTE: {\n    display: '$\\\\tiny\\\\text{soixante}$',\n    insert: '\\\\text{soixante}',\n  },\n  SOIXANTE_DIX: {\n    display: '$\\\\tiny\\\\text{soixante-dix}$',\n    insert: '\\\\text{soixante-dix}',\n  },\n  QUATRE_VINGT: {\n    display: '$\\\\tiny\\\\text{quatre-vingt}$',\n    insert: '\\\\text{quatre-vingt}',\n  },\n  QUATRE_VINGT_DIX: {\n    display: '$\\\\tiny\\\\text{quatre-vingt-dix}$',\n    insert: '\\\\text{quatre-vingt-dix}',\n  },\n  CENT: {\n    display: '$\\\\tiny\\\\text{cent}$',\n    insert: '\\\\text{cent}',\n  },\n}\n\nconst massUnitsKeys: Record<string, { display: string; insert: string }> = {}\nfor (const unit of massUnits.units) {\n  const k = `MASS ${unit.symbol}`\n  massUnitsKeys[k] = {\n    display: unit.symbol,\n    insert: unit.insert,\n  }\n}\n\nconst lengthUnitsKeys: Record<string, { display: string; insert: string }> = {}\nfor (const unit of lengthUnits.units) {\n  const k = `LENGTH ${unit.symbol}`\n  lengthUnitsKeys[k] = {\n    display: unit.symbol,\n    insert: unit.insert,\n  }\n}\n\nconst areaUnitsKeys: Record<string, { display: string; insert: string }> = {}\nfor (const unit of [...areaMetricUnits.units, ...areaOtherUnits.units]) {\n  const k = `AREA ${unit.symbol}`\n  areaUnitsKeys[k] = {\n    display: unit.symbol,\n    insert: unit.insert,\n  }\n}\n\nconst volumeUnitsKeys: Record<string, { display: string; insert: string }> = {}\nfor (const unit of volumeMetricUnits.units) {\n  const k = `VOLUME' ${unit.symbol}`\n  volumeUnitsKeys[k] = {\n    display: unit.symbol,\n    insert: unit.insert,\n  }\n}\n\nconst capacityUnitsKeys: Record<string, { display: string; insert: string }> =\n  {}\nfor (const unit of volumeOtherUnits.units) {\n  const k = `CAPACITY ${unit.symbol}`\n  capacityUnitsKeys[k] = {\n    display: unit.symbol,\n    insert: unit.insert,\n  }\n}\n\nexport const keys = {\n  ...basicKeys,\n  ...lengthUnitsKeys,\n  ...massUnitsKeys,\n  ...areaUnitsKeys,\n  ...volumeUnitsKeys,\n  ...capacityUnitsKeys,\n}\n","import { keys } from '../lib/keycaps'\nimport type {\n  BlockForKeyboard,\n  CompleteKeysList,\n  KeyboardBlock,\n  KeysList,\n} from '../types/keyboardContent'\n\n// Keycaps lists\nexport const specialKeysCaps: CompleteKeysList = {\n  inline: ['BACK', 'FWD', 'DEL', 'CLOSE'],\n  block: ['BACK', 'FWD', 'DEL', 'CLOSE'],\n}\nconst numbersCaps: CompleteKeysList = {\n  inline: [1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 'COMMA', 'PI'],\n  block: [7, 8, 9, 4, 5, 6, 1, 2, 3, 0, 'COMMA', 'PI'],\n}\nconst complexesCap: CompleteKeysList = {\n  inline: [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    0,\n    'iComplex',\n    'ADD',\n    'SUB',\n    'FRAC',\n    'POW',\n    'PI',\n    'COMMA',\n    'PARENTHESES',\n    'SQRT',\n    'e^',\n    'COS',\n    'SIN',\n    'THETA',\n    'NORM',\n  ],\n  block: [\n    7,\n    8,\n    9,\n    'iComplex',\n    'FRAC',\n    'COS',\n    4,\n    5,\n    6,\n    'ADD',\n    'POW',\n    'SIN',\n    1,\n    2,\n    3,\n    'SUB',\n    'PI',\n    'THETA',\n    0,\n    'COMMA',\n    'PARENTHESES',\n    'SQRT',\n    'e^',\n    'NORM',\n  ],\n}\nconst numbersCaps2: CompleteKeysList = {\n  inline: [1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 'COMMA', '='],\n  block: [7, 8, 9, 4, 5, 6, 1, 2, 3, 0, 'COMMA', '='],\n}\nconst numbersCapsX: CompleteKeysList = {\n  inline: [1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 'COMMA', 'xMath'],\n  block: [7, 8, 9, 4, 5, 6, 1, 2, 3, 0, 'COMMA', 'xMath'],\n}\nconst numbersOperationsCaps: CompleteKeysList = {\n  inline: [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    0,\n    'COMMA',\n    'PI',\n    'DIV',\n    'MULT',\n    'SUB',\n    'ADD',\n  ],\n  block: [\n    7,\n    8,\n    9,\n    'DIV',\n    4,\n    5,\n    6,\n    'MULT',\n    1,\n    2,\n    3,\n    'SUB',\n    0,\n    'COMMA',\n    'PI',\n    'ADD',\n  ],\n}\nconst numbersOperationsXCaps: CompleteKeysList = {\n  inline: [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    0,\n    'COMMA',\n    'xMath',\n    'DIV',\n    'MULT',\n    'SUB',\n    'ADD',\n  ],\n  block: [\n    7,\n    8,\n    9,\n    'DIV',\n    4,\n    5,\n    6,\n    'MULT',\n    1,\n    2,\n    3,\n    'SUB',\n    0,\n    'COMMA',\n    'xMath',\n    'ADD',\n  ],\n}\nconst numbersSpaceCaps: CompleteKeysList = {\n  inline: [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    0,\n    'COMMA',\n    'SPACE',\n    'DIV',\n    'MULT',\n    'SUB',\n    'ADD',\n  ],\n  block: [\n    1,\n    2,\n    3,\n    'DIV',\n    4,\n    5,\n    6,\n    'MULT',\n    7,\n    8,\n    9,\n    'SUB',\n    0,\n    'COMMA',\n    'SPACE',\n    'ADD',\n  ],\n}\nconst variableCaps: CompleteKeysList = {\n  inline: [\n    'aMath',\n    'bMath',\n    'cMath',\n    'xMath',\n    'yMath',\n    'zMath',\n    'kMath',\n    'nMath',\n    'iMath',\n    'e',\n    'V',\n    'F',\n  ],\n  block: [\n    'aMath',\n    'xMath',\n    'kMath',\n    'bMath',\n    'yMath',\n    'nMath',\n    'cMath',\n    'zMath',\n    'iMath',\n    'e',\n    'V',\n    'F',\n  ],\n}\nconst basicOperationCaps: CompleteKeysList = {\n  inline: ['ADD', 'SUB', 'MULT', 'DIV', 'SQ', 'FRAC', '(', ')'],\n  block: ['ADD', 'SUB', 'MULT', 'DIV', 'SQ', 'FRAC', '(', ')'],\n}\nconst basicOperationPlusCaps: CompleteKeysList = {\n  inline: [\n    'ADD',\n    'SUB',\n    'MULT',\n    'DIV',\n    'xMath',\n    'SQ',\n    'POW',\n    'FRAC',\n    '(',\n    ')',\n    'BRACKETS',\n    'SEMICOLON',\n  ],\n  block: [\n    'xMath',\n    'ADD',\n    'SUB',\n    'SQ',\n    'MULT',\n    'DIV',\n    'POW',\n    'BRACKETS',\n    'FRAC',\n    'SEMICOLON',\n    '(',\n    ')',\n  ],\n}\nconst basicOperationCaps2: CompleteKeysList = {\n  inline: ['ADD', 'SUB', 'MULT', 'DIV', '=', 'FRAC', '(', ')'],\n  block: ['ADD', 'SUB', 'MULT', 'DIV', '=', 'FRAC', '(', ')'],\n}\nconst fullOperationCaps: CompleteKeysList = {\n  inline: [\n    'ADD',\n    'SUB',\n    'MULT',\n    'DIV',\n    'FRAC',\n    '=',\n    '(',\n    ')',\n    'xMath',\n    'SQRT',\n    'SQ',\n    'POW',\n    'POW10',\n    'DEG',\n    'PERCENT',\n    'SEMICOLON',\n  ],\n  block: [\n    'ADD',\n    'SUB',\n    'xMath',\n    'DEG',\n    'MULT',\n    'DIV',\n    'SQ',\n    'SQRT',\n    '(',\n    ')',\n    'POW',\n    'PERCENT',\n    '=',\n    'FRAC',\n    'POW10',\n    'SEMICOLON',\n  ],\n}\nconst terminaleCaps: CompleteKeysList = {\n  inline: [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    0,\n    'LOG',\n    'LN',\n    'POW',\n    'FRAC',\n    'SEMICOLON',\n    'COMMA',\n    'DIV',\n    'MULT',\n    'SUB',\n    'ADD',\n    'SQRT',\n    'SQRTN',\n    'e^',\n    'INFTY',\n    'PARENTHESES',\n    'POW10',\n    'BRACES',\n    'BRACKETS',\n  ],\n  block: [\n    'SQRT',\n    'SQRTN',\n    'LN',\n    'LOG',\n    7,\n    8,\n    9,\n    'POW',\n    'e^',\n    'FRAC',\n    'INFTY',\n    4,\n    5,\n    6,\n    'POW10',\n    'PARENTHESES',\n    'BRACES',\n    'xMath',\n    1,\n    2,\n    3,\n    'ADD',\n    'SUB',\n    'MULT',\n    'DIV',\n    0,\n    'COMMA',\n    'SEMICOLON',\n  ],\n}\n\nconst numerationCaps: CompleteKeysList = {\n  inline: [\n    'MILLIARD',\n    'MILLION',\n    'MILLE',\n    'CENTAINE',\n    'DIZAINE',\n    'UNITE',\n    'DE',\n    'DIXIEME',\n    'CENTIEME',\n    'MILLIEME',\n    'DIX_MILLIEME',\n    'CENT_MILLIEME',\n    'MILLIONIEME',\n    'HYPHEN',\n    'DIX',\n    'VINGT',\n    'TRENTE',\n    'QUARANTE',\n    'CINQUANTE',\n    'SOIXANTE',\n    'SOIXANTE_DIX',\n    'QUATRE_VINGT',\n    'QUATRE_VINGT_DIX',\n    'CENT',\n  ],\n  block: [\n    'MILLIARD',\n    'MILLION',\n    'MILLE',\n    'CENTAINE',\n    'DIZAINE',\n    'UNITE',\n    'DE',\n    'DIXIEME',\n    'CENTIEME',\n    'MILLIEME',\n    'DIX_MILLIEME',\n    'CENT_MILLIEME',\n    'MILLIONIEME',\n    'HYPHEN',\n    'DIX',\n    'VINGT',\n    'TRENTE',\n    'QUARANTE',\n    'CINQUANTE',\n    'SOIXANTE',\n    'SOIXANTE_DIX',\n    'QUATRE_VINGT',\n    'QUATRE_VINGT_DIX',\n    'CENT',\n  ],\n}\n\nconst probabiliteCaps: CompleteKeysList = {\n  inline: [\n    'PROB',\n    'BINOM',\n    'OVERLINE',\n    'UNION',\n    'INTER',\n    'EMPTY',\n    'SEMICOLON',\n    'PARENTHESES',\n    'POW',\n    'INDICE',\n    'QUOTE',\n    '=',\n  ],\n  block: [\n    'PROB',\n    'BINOM',\n    'OVERLINE',\n    'UNION',\n    'INTER',\n    'EMPTY',\n    'SEMICOLON',\n    'PARENTHESES',\n    'POW',\n    'INDICE',\n    'QUOTE',\n    '=',\n  ],\n}\n\nconst ensembleCaps: CompleteKeysList = {\n  inline: [\n    'ADD',\n    'SUB',\n    'INFTY',\n    'BRACES',\n    '[',\n    ']',\n    'IN',\n    'SEMICOLON',\n    'FRAC',\n    'SQRT',\n    'POW',\n    'POW10',\n  ],\n  block: [\n    'ADD',\n    'SUB',\n    'INFTY',\n    'BRACES',\n    '[',\n    ']',\n    'IN',\n    'SEMICOLON',\n    'FRAC',\n    'SQRT',\n    'POW',\n    'POW10',\n  ],\n}\n\nconst ensembleDefiniCaps: CompleteKeysList = {\n  inline: [\n    'COMP',\n    'REAL',\n    'RATIO',\n    'DECIMAL',\n    'REL',\n    'INTEG',\n    'EMPTY',\n    'UNION',\n    'INTER',\n  ],\n  block: [\n    'COMP',\n    'REAL',\n    'RATIO',\n    'DECIMAL',\n    'REL',\n    'INTEG',\n    'EMPTY',\n    'UNION',\n    'INTER',\n  ],\n}\n\nconst suiteCaps: CompleteKeysList = {\n  inline: [\n    'U_INDICE_N',\n    'V_INDICE_N',\n    'W_INDICE_N',\n    'C_INDICE_N',\n    'nMath',\n    'kMath',\n    'INDICE_N',\n    'INDICE',\n  ],\n  block: [\n    'U_INDICE_N',\n    'V_INDICE_N',\n    'W_INDICE_N',\n    'C_INDICE_N',\n    'nMath',\n    'kMath',\n    'INDICE_N',\n    'INDICE',\n  ],\n}\n\nconst hmsCaps: CompleteKeysList = {\n  inline: ['WEEK', 'DAY', 'HOUR', 'MIN', 'SEC'],\n  block: ['WEEK', 'DAY', 'HOUR', 'MIN', 'SEC'],\n}\n\nconst greekCaps: CompleteKeysList = {\n  inline: [\n    'ALPHA',\n    'BETA',\n    'GAMMA',\n    'DELTA',\n    'EPSILON',\n    'THETA',\n    'LAMBDA',\n    'OMEGA',\n  ],\n  block: [\n    'ALPHA',\n    'BETA',\n    'GAMMA',\n    'DELTA',\n    'EPSILON',\n    'THETA',\n    'LAMBDA',\n    'OMEGA',\n  ],\n}\n\nconst compareCaps: CompleteKeysList = {\n  inline: ['LESS', 'GREAT', '=', 'LESSEQ', 'GREATEQ'],\n  block: ['LESS', 'GREAT', '=', 'LESSEQ', 'GREATEQ'],\n}\n\nconst degreCaps: CompleteKeysList = {\n  inline: ['DEG'],\n  block: ['DEG'],\n}\n\nconst degreCelsiusCaps: CompleteKeysList = {\n  inline: ['DEGCELSIUS'],\n  block: ['DEGCELSIUS'],\n}\n\nconst trigoCaps: CompleteKeysList = {\n  inline: ['COS', 'SIN', 'TAN', 'ANG'],\n  block: ['COS', 'SIN', 'TAN', 'ANG'],\n}\n\nconst advancedCaps: CompleteKeysList = {\n  inline: [\n    'FCT',\n    'LIM',\n    'INT',\n    'SIGMA',\n    'BINOM', //\n    'UNION',\n    'INTER',\n    'INFTY',\n    'EMPTY',\n    'PROB', //\n    'VECT',\n    'BRACKETS',\n    'BRACES',\n    'LESSEQ',\n    'GREATEQ', //\n    'COMP',\n    'REAL',\n    'RATIO',\n    'REL',\n    'INTEG',\n  ],\n  block: [\n    'FCT',\n    'LIM',\n    'INT',\n    'SIGMA',\n    'BINOM', //\n    'UNION',\n    'INTER',\n    'INFTY',\n    'EMPTY',\n    'PROB', //\n    'VECT',\n    'BRACKETS',\n    'BRACES',\n    'LESSEQ',\n    'GREATEQ', //\n    'COMP',\n    'REAL',\n    'RATIO',\n    'REL',\n    'INTEG',\n  ],\n}\n\nconst anglesCaps: CompleteKeysList = {\n  inline: ['ANG', 'DEG', 'QUOTE', '='],\n  block: ['ANG', 'DEG', 'QUOTE', '='],\n}\n\nconst aToHCaps: CompleteKeysList = {\n  inline: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'],\n  block: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'],\n}\n\nconst iToPCaps: CompleteKeysList = {\n  inline: ['I', 'J', 'K', 'L', 'M', 'N', 'O', 'P'],\n  block: ['I', 'J', 'K', 'L', 'M', 'N', 'O', 'P'],\n}\n\nconst qToWCaps: CompleteKeysList = {\n  inline: ['Q', 'R', 'S', 'T', 'U', 'V', 'W'],\n  block: ['Q', 'R', 'S', 'T', 'U', 'V', 'W'],\n}\n\nconst xToZCaps: CompleteKeysList = {\n  inline: ['X', 'Y', 'Z'],\n  block: ['X', 'Y', 'Z'],\n}\n\nconst vFONCaps: CompleteKeysList = {\n  inline: ['V', 'F', 'O', 'N'],\n  block: ['V', 'F', 'O', 'N'],\n}\n\nconst eosnCaps: CompleteKeysList = {\n  inline: ['O', 'E', 'S', 'N', 'DEG', 'SEMICOLON'],\n  block: ['O', 'E', 'S', 'N', 'DEG', 'SEMICOLON'],\n}\n\n// @ts-expect-error Problme de typage\nconst lengthUnitsKeys = Object.keys(keys)\n  .filter((k) => k.includes('LENGTH'))\n  .reduce((prev, k) => Object.assign(prev, { [k]: keys[k] }), {})\nconst lengthsCaps: CompleteKeysList = {\n  inline: Object.keys(lengthUnitsKeys) as KeysList,\n  block: Object.keys(lengthUnitsKeys) as KeysList,\n}\n\n// @ts-expect-error Problme de typage\nconst areasUnitsKeys = Object.keys(keys)\n  .filter((k) => k.includes('AREA'))\n  .reduce((prev, k) => Object.assign(prev, { [k]: keys[k] }), {})\nconst areasCaps: CompleteKeysList = {\n  inline: Object.keys(areasUnitsKeys) as KeysList,\n  block: Object.keys(areasUnitsKeys) as KeysList,\n}\n\n// @ts-expect-error Problme de typage\nconst volumesUnitsKeys = Object.keys(keys)\n  .filter((k) => k.includes('VOLUME'))\n  .reduce((prev, k) => Object.assign(prev, { [k]: keys[k] }), {})\nconst volumesCaps: CompleteKeysList = {\n  inline: Object.keys(volumesUnitsKeys) as KeysList,\n  block: Object.keys(volumesUnitsKeys) as KeysList,\n}\n\n// @ts-expect-error Problme de typage\nconst capacitiesUnitsKeys = Object.keys(keys)\n  .filter((k) => k.includes('CAPACITY'))\n  .reduce((prev, k) => Object.assign(prev, { [k]: keys[k] }), {})\nconst capacitiesCaps: CompleteKeysList = {\n  inline: Object.keys(capacitiesUnitsKeys) as KeysList,\n  block: Object.keys(capacitiesUnitsKeys) as KeysList,\n}\n\n// @ts-expect-error Problme de typage\nconst massesUnitsKeys = Object.keys(keys)\n  .filter((k) => k.includes('MASS'))\n  .reduce((prev, k) => Object.assign(prev, { [k]: keys[k] }), {})\nconst massesCaps: CompleteKeysList = {\n  inline: Object.keys(massesUnitsKeys) as KeysList,\n  block: Object.keys(massesUnitsKeys) as KeysList,\n}\n\nexport const specialKeys: KeyboardBlock = {\n  keycaps: specialKeysCaps,\n  cols: 1,\n  title: 'Touches spciales',\n  isUnits: false,\n}\n\nexport const complexes: KeyboardBlock = {\n  keycaps: complexesCap,\n  cols: 6,\n  title: 'Nombres complexes',\n  isUnits: false,\n}\n\nexport const numbers: KeyboardBlock = {\n  keycaps: numbersCaps,\n  cols: 3,\n  title: 'Nombres',\n  isUnits: false,\n}\nexport const numbersX: KeyboardBlock = {\n  keycaps: numbersCapsX,\n  cols: 3,\n  title: 'Nombres',\n  isUnits: false,\n}\nexport const numbers2: KeyboardBlock = {\n  keycaps: numbersCaps2,\n  cols: 3,\n  title: 'Nombres',\n  isUnits: false,\n}\nexport const numbersOperations: KeyboardBlock = {\n  keycaps: numbersOperationsCaps,\n  cols: 4,\n  title: 'Nombres+Oprations',\n  isUnits: false,\n}\n\nexport const numbersOperationsX: KeyboardBlock = {\n  keycaps: numbersOperationsXCaps,\n  cols: 4,\n  title: 'Nombres+Oprations',\n  isUnits: false,\n}\n\nexport const numbersSpace: KeyboardBlock = {\n  keycaps: numbersSpaceCaps,\n  cols: 4,\n  title: 'Nombres',\n  isUnits: false,\n}\n\nexport const variables: KeyboardBlock = {\n  keycaps: variableCaps,\n  cols: 3,\n  title: 'Variables',\n  isUnits: false,\n}\n\nexport const vFON: KeyboardBlock = {\n  keycaps: vFONCaps,\n  cols: 1,\n  title: 'Vrai/Faux/Impossible',\n  isUnits: false,\n}\n\nexport const basicOperations: KeyboardBlock = {\n  keycaps: basicOperationCaps,\n  cols: 2,\n  title: 'Oprations de base',\n  isUnits: false,\n}\n\nexport const basicOperations2: KeyboardBlock = {\n  keycaps: basicOperationCaps2,\n  cols: 2,\n  title: 'Oprations de base',\n  isUnits: false,\n}\n\nexport const basicOperationsPlus: KeyboardBlock = {\n  keycaps: basicOperationPlusCaps,\n  cols: 3,\n  title: 'Oprations de base',\n  isUnits: false,\n}\n\nexport const fullOperations: KeyboardBlock = {\n  keycaps: fullOperationCaps,\n  cols: 4,\n  title: 'Oprations complexes',\n  isUnits: false,\n}\n\nexport const clavierFonctionsTerminales: KeyboardBlock = {\n  keycaps: terminaleCaps,\n  cols: 7,\n  title: 'Fonctions de Terminales',\n  isUnits: false,\n}\n\nexport const numeration: KeyboardBlock = {\n  keycaps: numerationCaps,\n  cols: 6,\n  title: 'Logarithme et puissance',\n  isUnits: false,\n}\n\nexport const probabilite: KeyboardBlock = {\n  keycaps: probabiliteCaps,\n  cols: 3,\n  title: 'Probabilits',\n  isUnits: false,\n}\n\nexport const hms: KeyboardBlock = {\n  keycaps: hmsCaps,\n  cols: 1,\n  title: 'Temps',\n  isUnits: true,\n}\n\nexport const greek: KeyboardBlock = {\n  keycaps: greekCaps,\n  cols: 2,\n  title: 'Lettres grecques',\n  isUnits: false,\n}\n\nexport const compare: KeyboardBlock = {\n  keycaps: compareCaps,\n  cols: 3,\n  title: 'Comparaison',\n  isUnits: false,\n}\n\nexport const degre: KeyboardBlock = {\n  keycaps: degreCaps,\n  cols: 1,\n  title: 'Degr',\n  isUnits: true,\n}\n\nexport const degreCelsius: KeyboardBlock = {\n  keycaps: degreCelsiusCaps,\n  cols: 1,\n  title: 'Degr Celsius',\n  isUnits: true,\n}\n\nexport const trigo: KeyboardBlock = {\n  keycaps: trigoCaps,\n  cols: 1,\n  title: 'Trigonomtrie',\n  isUnits: false,\n}\nexport const advanced: KeyboardBlock = {\n  keycaps: advancedCaps,\n  cols: 5,\n  title: 'Fonctions avances',\n  isUnits: false,\n}\n\nexport const lengths: KeyboardBlock = {\n  keycaps: lengthsCaps,\n  cols: 2,\n  title: 'Longueurs',\n  isUnits: true,\n}\n\nexport const areas: KeyboardBlock = {\n  keycaps: areasCaps,\n  cols: 3,\n  title: 'Aires',\n  isUnits: true,\n}\n\nexport const ensemble: KeyboardBlock = {\n  keycaps: ensembleCaps,\n  cols: 3,\n  title: 'Ensembles',\n  isUnits: false,\n}\n\nexport const ensembleDefini: KeyboardBlock = {\n  keycaps: ensembleDefiniCaps,\n  cols: 3,\n  title: 'EnsemblesDefinis',\n  isUnits: false,\n}\n\nexport const suite: KeyboardBlock = {\n  keycaps: suiteCaps,\n  cols: 2,\n  title: 'Suites',\n  isUnits: false,\n}\n\nexport const volumes: KeyboardBlock = {\n  keycaps: volumesCaps,\n  cols: 2,\n  title: 'Volumes',\n  isUnits: true,\n}\n\nexport const capacities: KeyboardBlock = {\n  keycaps: capacitiesCaps,\n  cols: 2,\n  title: 'Capacits',\n  isUnits: true,\n}\n\nexport const masses: KeyboardBlock = {\n  keycaps: massesCaps,\n  cols: 2,\n  title: 'Masses',\n  isUnits: true,\n}\n\nexport const angles: KeyboardBlock = {\n  keycaps: anglesCaps,\n  cols: 1,\n  title: 'Angles',\n  isUnits: false,\n}\n\nexport const uppercaseAToH: KeyboardBlock = {\n  keycaps: aToHCaps,\n  cols: 2,\n  title: 'Majuscules: A  H',\n  isUnits: false,\n}\n\nexport const uppercaseIToP: KeyboardBlock = {\n  keycaps: iToPCaps,\n  cols: 2,\n  title: 'Majuscules: I  P',\n  isUnits: false,\n}\n\nexport const uppercaseQToW: KeyboardBlock = {\n  keycaps: qToWCaps,\n  cols: 2,\n  title: 'Majuscules: Q  W',\n  isUnits: false,\n}\n\nexport const uppercaseXToZ: KeyboardBlock = {\n  keycaps: xToZCaps,\n  cols: 1,\n  title: 'Majuscules: X  Z',\n  isUnits: false,\n}\n\nexport const estOuestSudNord: KeyboardBlock = {\n  keycaps: eosnCaps,\n  cols: 2,\n  title: 'Points cardinaux',\n  isUnits: false,\n}\n\nexport const keyboardBlocks: {\n  [key in Exclude<BlockForKeyboard, 'alphanumeric'>]: KeyboardBlock\n} = {\n  advanced,\n  angles,\n  areas,\n  basicOperations,\n  basicOperations2,\n  basicOperationsPlus,\n  capacities,\n  compare,\n  complexes,\n  degre,\n  degreCelsius,\n  ensemble,\n  ensembleDefini,\n  suite,\n  greek,\n  fullOperations,\n  hms,\n  lengths,\n  clavierFonctionsTerminales,\n  masses,\n  numbers,\n  numbersSpace,\n  numbersX,\n  numbers2,\n  numbersOperations,\n  numbersOperationsX,\n  numeration,\n  probabilite,\n  trigo,\n  variables,\n  volumes,\n  vFON,\n  uppercaseAToH,\n  uppercaseIToP,\n  uppercaseQToW,\n  uppercaseXToZ,\n  estOuestSudNord,\n}\n","export const KEYCAP_WIDTH = {\n  sm: 30,\n  md: 40,\n  lg: 60,\n  xl: 80,\n}\nexport const KEYCAP_HEIGHT = {\n  sm: 40,\n  md: 40,\n}\nexport const GAP_BETWEEN_BLOCKS = {\n  sm: 10,\n  md: 15,\n  lg: 15,\n  xl: 15,\n}\nexport const GAP_BETWEEN_KEYS = {\n  sm: 4,\n  md: 8,\n  lg: 8,\n  xl: 8,\n}\n\nexport const SM_BREAKPOINT = 640\nexport const MD_BREAKPOINT = 768\nexport const LG_BREAKPOINT = 1024\nexport const XL_BREAKPOINT = 1280\n\nexport const getMode = function (\n  innerWidth: number,\n  isInLine: boolean,\n): 'sm' | 'md' | 'lg' | 'xl' {\n  if (isInLine) {\n    return innerWidth <= SM_BREAKPOINT ? 'sm' : 'md'\n  }\n  return innerWidth <= SM_BREAKPOINT\n    ? 'sm'\n    : innerWidth <= MD_BREAKPOINT\n      ? 'md'\n      : innerWidth <= LG_BREAKPOINT\n        ? 'lg'\n        : 'xl'\n}\n","import { specialKeys } from '../layouts/keysBlocks'\nimport type { keys } from '../lib/keycaps'\nimport { GAP_BETWEEN_KEYS, KEYCAP_WIDTH } from '../lib/sizes'\nexport type Keys = keyof typeof keys\nexport type KeysList = Keys[]\nexport type AlphanumericPages = 'AlphaUp' | 'AlphaLow' | 'Numeric'\nexport type BlockForKeyboard =\n  | 'alphanumeric'\n  | 'advanced'\n  | 'angles'\n  | 'areas'\n  | 'basicOperations'\n  | 'basicOperations2'\n  | 'basicOperationsPlus'\n  | 'capacities'\n  | 'compare'\n  | 'complexes'\n  | 'degre'\n  | 'degreCelsius'\n  | 'ensemble'\n  | 'ensembleDefini'\n  | 'fullOperations'\n  | 'greek'\n  | 'hms'\n  | 'lengths'\n  | 'clavierFonctionsTerminales'\n  | 'masses'\n  | 'numbers'\n  | 'numbersX'\n  | 'numbers2'\n  | 'numbersOperations'\n  | 'numbersOperationsX'\n  | 'numbersSpace'\n  | 'numeration'\n  | 'probabilite'\n  | 'suite'\n  | 'trigo'\n  | 'variables'\n  | 'volumes'\n  | 'vFON'\n  | 'uppercaseAToH'\n  | 'uppercaseIToP'\n  | 'uppercaseQToW'\n  | 'uppercaseXToZ'\n  | 'estOuestSudNord'\n\nexport interface CompleteKeysList {\n  inline: KeysList\n  block: KeysList\n}\n\nexport interface KeyboardBlock {\n  keycaps: CompleteKeysList\n  cols: number\n  title: string\n  isUnits: boolean\n}\n\nexport class Keyboard {\n  blocks: KeyboardBlock[] = [specialKeys]\n\n  constructor(kb?: KeyboardBlock) {\n    if (kb) {\n      this.blocks.push(kb)\n    }\n  }\n\n  /**\n   * Ajoute un bloc de touche au clavier\n   * @param kb {KeyboardBlock} bloc de touches  ajouter\n   * @returns le clavier lui-mme (on peut donc chaner cette fonction)\n   */\n  add = (kb: KeyboardBlock): Keyboard => {\n    this.blocks.push(kb)\n    return this\n  }\n\n  empty = (): void => {\n    this.blocks.length = 0\n    this.blocks.push(specialKeys)\n  }\n\n  /**\n   * Retrouve le nombre de blocs dans le clavier\n   * @returns nombre de blocs dans le clavier\n   */\n  numberOfBlocks = (): number => this.blocks.length\n\n  /**\n   * Construit un tableau dont les lments sont le nombre de touche par bloc\n   * @returns nombre de touches par bloc (liste de nombres)\n   */\n  numberOfKeysPerBlock = (): number[] => {\n    const result: number[] = []\n    for (const block of this.blocks) {\n      result.push(block.keycaps.inline.length)\n    }\n    return result\n  }\n\n  /**\n   * Calcule le nombre total de touches dans le clavier\n   * @returns nombre total de touches\n   */\n  numberOfKeys = (): number =>\n    this.numberOfKeysPerBlock().reduce((prev, current) => prev + current)\n\n  /**\n   * Dcide si on passe le bloc des touches spciales sur deux colonnes\n   * lorsqu'on a que deux touches par bloc\n   * (utile dans la cas de clavier cotenant trs peu de touches)\n   */\n  checkSmallLayoutAllowed = (): void => {\n    const maximumNbKeysPerBlock = this.numberOfKeysPerBlock()\n      .slice(1)\n      .reduce((prev, current) => (prev < current ? current : prev), 0)\n    if (maximumNbKeysPerBlock <= 2) {\n      // le premier bloc est celui des touches spciales, on le passe en deux colonnes.\n      this.blocks[0].cols = 2\n    }\n  }\n}\n\nexport const inLineBlockWidth = (\n  block: KeyboardBlock,\n  mode: 'sm' | 'md' | 'lg' | 'xl',\n): number => {\n  // 3G30-1 renvoie un keycaps undefined, pourquoi ?\n  const numberOfKeys = block?.keycaps?.inline?.length || 0\n  // console.log('nb of keys: ' + numberOfKeys + ' / key width: ' + KEYCAP_WIDTH[mode]s + ' / gap between keys: ' + GAP_BETWEEN_KEYS[mode])\n  return (\n    numberOfKeys * KEYCAP_WIDTH[mode] +\n    (numberOfKeys - 1) * GAP_BETWEEN_KEYS[mode]\n  )\n}\nexport const usualBlockWidth = (\n  block: KeyboardBlock,\n  mode: 'sm' | 'md' | 'lg' | 'xl',\n): number => {\n  const numberOfCols = block.cols\n  return (\n    numberOfCols * KEYCAP_WIDTH[mode] +\n    (numberOfCols - 1) * GAP_BETWEEN_KEYS[mode]\n  )\n}\n","<script lang=\"ts\">\n  import type { KeyCap } from '../../../../types/keycap'\n  import {\n    KEYCAP_HEIGHT,\n    KEYCAP_WIDTH,\n    SM_BREAKPOINT,\n    MD_BREAKPOINT,\n    LG_BREAKPOINT,\n    getMode,\n  } from '../../../../lib/sizes'\n  import type { Keys } from '../../../../types/keyboardContent'\n  export let innerWidth: number\n  export let keyName: Keys\n  export let key: KeyCap\n  export let isInLine: boolean\n  export let isSpecial: boolean = false\n  export let clickKeycap: (data: KeyCap, event: MouseEvent) => void\n  let button: HTMLButtonElement\n  $: keycapwidth = KEYCAP_WIDTH[getMode(innerWidth, isInLine)]\n\n  $: keycapheight =\n    innerWidth <= SM_BREAKPOINT ? KEYCAP_HEIGHT.sm : KEYCAP_HEIGHT.md\n</script>\n\n<button\n  bind:this=\"{button}\"\n  class=\"key--{keyName} customdimensions h-full flex justify-center items-center text-sm md:text-xl border-b-2 border-r border-r-slate-400 dark:border-r-gray-500 border-b-slate-300 dark:border-b-gray-600 active:border-b-0 active:border-r-0 text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light active:text-coopmaths-canvas active:translate-y-[1.5px] dark:active:text-coopmathsdark-canvas active:bg-coopmaths-action active:shadow-none dark:active:bg-coopmathsdark-action dark:active:shadow-none transition-transform ease-in-out shadow-[2px_2px_4px_rgba(180,180,180,0.5)] {isSpecial\n    ? 'bg-coopmaths-canvas-moredark dark:bg-coopmathsdark-canvas-moredark'\n    : 'bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas'}  py-1 px-1 md:py-2 md:px-4 text-center rounded-md font-mono touch-none\"\n  style=\"--keycapwidth:{keycapwidth}; --keycapheight:{keycapheight};\"\n  on:mousedown=\"{(e) => {\n    e.preventDefault()\n    e.stopPropagation()\n  }}\"\n  on:click=\"{(e) => {\n    clickKeycap(key, e)\n  }}\"\n>\n  <div id=\"key-{key.display}\" class=\"relative\">\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    <span>{@html key.display}</span>\n  </div>\n</button>\n\n<style>\n  .customdimensions {\n    width: calc(var(--keycapwidth) * 1px);\n    height: calc(var(--keycapheight) * 1px);\n  }\n  @media (min-width: 768px) {\n    button.key--FCT,\n    button.key--LIM,\n    button.key--BRACKETS,\n    button.key--BRACES,\n    button.key--VECT,\n    button.key--INT,\n    button.key--BINOM,\n    button.key--SIGMA,\n    button.key--COS,\n    button.key--SIN,\n    button.key--TAN,\n    button[class^='key--MASS'],\n    button[class^='key--LENGTH'],\n    button[class^='key--AREA'],\n    button[class^='key--CAPACITY'],\n    button[class^='key--VOLUME'] {\n      font-size: 1rem /* 16px */;\n      line-height: 1.5rem /* 24px */;\n    }\n    button.key--PROB {\n      font-size: 0.75rem /* 12px */;\n      line-height: 1rem /* 16px */;\n    }\n  }\n  @media only screen and (max-width: 768px) {\n    button.key--FCT,\n    button.key--INT,\n    button.key--BINOM,\n    button.key--BRACKETS,\n    button.key--BRACES,\n    button.key--VECT,\n    button.key--LIM,\n    button.key--SIGMA,\n    button.key--COS,\n    button.key--SIN,\n    button.key--TAN,\n    button.key--SQRT,\n    button[class^='key--MASS'],\n    button[class^='key--LENGTH'],\n    button[class^='key--AREA'],\n    button[class^='key--CAPACITY'],\n    button[class^='key--VOLUME'] {\n      font-size: 0.5rem /* 16px */;\n      line-height: 1.5rem /* 24px */;\n    }\n    button.key--PROB {\n      font-size: 0.4rem /* 12px */;\n      line-height: 1rem /* 16px */;\n    }\n  }\n\n  button.key--DEL,\n  button.key--FWD {\n    touch-action: none;\n  }\n</style>\n","import type { Keys } from './keyboardContent'\n\nexport type KeyCap = {\n  display: string\n  insert?: string\n  command?: string | string[]\n}\n\nexport const isSpecialKey = (key: Keys): boolean =>\n  ['DEL', 'CLOSE', 'BACK', 'FWD', 'abc', 'ABC', 'NUM'].includes(key.toString())\nexport const isPageKey = (key: Keys): boolean =>\n  ['abc', 'ABC', 'NUM'].includes(key.toString())\n","<script lang=\"ts\">\n  import Key from './keycap/Keycap.svelte'\n  import { GAP_BETWEEN_KEYS, SM_BREAKPOINT, getMode } from '../../../lib/sizes'\n  import type { KeyboardBlock } from '../../../types/keyboardContent'\n  import { keys } from '../../../lib/keycaps'\n  import { type KeyCap, isSpecialKey } from '../../../types/keycap'\n  export let innerWidth: number\n  export let block: KeyboardBlock\n  export let isInLine: boolean = false\n  export let clickKeycap: (data: KeyCap, event: MouseEvent) => void\n\n  $: gapsize = GAP_BETWEEN_KEYS[getMode(innerWidth, isInLine)]\n</script>\n\n{#if block !== undefined}\n  <div\n    id=\"kb-block-{block.title\n      .toLowerCase()\n      .normalize('NFD')\n      .replace(/\\p{Diacritic}/gu, '')\n      .replace(' ', '-')}\"\n  >\n    {#if isInLine}\n      <div\n        class=\"grid grid-cols-{block.keycaps.inline.length} customgap h-full\"\n        style=\"--gapsize:{gapsize};\"\n      >\n        {#each block.keycaps.inline as key}\n          <Key\n            keyName=\"{key}\"\n            key=\"{keys[key]}\"\n            isSpecial=\"{isSpecialKey(key)}\"\n            {isInLine}\n            {innerWidth}\n            {clickKeycap}\n          />\n        {/each}\n      </div>\n    {:else}\n      <div\n        class=\"grid grid-cols-{block.cols} customgap h-full\"\n        style=\"--gapsize:{gapsize};\"\n      >\n        {#each block.keycaps.block as key}\n          <Key\n            keyName=\"{key}\"\n            key=\"{keys[key]}\"\n            isSpecial=\"{isSpecialKey(key)}\"\n            {isInLine}\n            {innerWidth}\n            {clickKeycap}\n          />\n        {/each}\n      </div>\n    {/if}\n  </div>\n{/if}\n\n<style>\n  .customgap {\n    gap: calc(var(--gapsize) * 1px);\n  }\n</style>\n","<script lang=\"ts\">\n  import type { KeyboardBlock } from '../../../types/keyboardContent'\n  import { getUniqueStringBasedOnTimeStamp } from '../../../../../lib/components/time'\n  import BlockOfKeycaps from './BlockOfKeycaps.svelte'\n  import { GAP_BETWEEN_BLOCKS, SM_BREAKPOINT } from '../../../lib/sizes'\n  import type { KeyCap } from '../../../types/keycap'\n  import { keyboardBlocks } from '../../../layouts/keysBlocks'\n  export let blocksList: KeyboardBlock[] = [\n    keyboardBlocks.lengths,\n    keyboardBlocks.areas,\n    keyboardBlocks.volumes,\n    keyboardBlocks.capacities,\n  ]\n  export let clickKeycap: (data: KeyCap, event: MouseEvent) => void\n  export let isInLine: boolean\n  $: blockgapsize =\n    innerWidth <= SM_BREAKPOINT ? GAP_BETWEEN_BLOCKS.sm : GAP_BETWEEN_BLOCKS.md\n  /**\n   * Pour retirer les accents et autres bizarrerie dans les chanes\n   * @see https://stackoverflow.com/a/37511463\n   * @param s chane  transformer\n   */\n  const toRegularCharacters = (s: string): string =>\n    s.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '')\n  const possibleBlocks = [\n    ...blocksList.map((b) => toRegularCharacters(b.title)),\n  ] as const\n  $: currentBlock = possibleBlocks[0]\n\n  const switchToBlock = (newBlock: (typeof possibleBlocks)[number]) => {\n    currentBlock = newBlock\n  }\n</script>\n\n<div class=\"flex flex-col\">\n  <ul\n    class=\"mb-1 flex list-none flex-row flex-wrap border-b-0 pl-0\"\n    style=\"--blockgapsize:{blockgapsize}\"\n    id=\"keysblocknav-{getUniqueStringBasedOnTimeStamp()}\"\n    role=\"tablist\"\n    data-te-nav-ref\n  >\n    {#each blocksList as block}\n      <li role=\"presentation\">\n        <button\n          type=\"button\"\n          class=\"mb-1 block border-x-0 border-b-2 border-t-0 px-2 pb-1 text-[0.7rem] font-light leading-tight {currentBlock ===\n          toRegularCharacters(block.title)\n            ? 'text-coopmaths-struct border-coopmaths-struct dark:text-coopmathsdark-struct dark:border-coopmathsdark-struct'\n            : 'text-coopmaths-action dark:text-coopmathsdark-action border-transparent'}   hover:text-coopmaths-action-lightest active:border-coopmaths-struct active:text-coopmaths-struct dark:hover:bg-transparent dark:active:border-coopmathsdark-struct dark:active:text-coopmathsdark-struct\"\n          id=\"tabs-{toRegularCharacters(block.title)}-tab\"\n          role=\"tab\"\n          aria-controls=\"tabs-{toRegularCharacters(block.title)}\"\n          on:click=\"{(e) => {\n            e.preventDefault()\n            e.stopPropagation()\n            switchToBlock(toRegularCharacters(block.title))\n          }}\"\n          on:mousedown=\"{(e) => {\n            e.preventDefault()\n            e.stopPropagation()\n          }}\"\n        >\n          {block.title}\n        </button>\n      </li>\n    {/each}\n  </ul>\n  <!--Blocks content-->\n  <div class=\"flex justify-center\">\n    {#each blocksList as block}\n      <div\n        class=\"{currentBlock === toRegularCharacters(block.title)\n          ? 'flex opacity-100'\n          : 'hidden opacity-0'} transition-opacity duration-150 ease-linear data-[te-tab-active]:block\"\n        id=\"tabs-{toRegularCharacters(block.title)}\"\n        role=\"tabpanel\"\n        aria-labelledby=\"tabs-{toRegularCharacters(block.title)}-tab\"\n      >\n        <BlockOfKeycaps {block} {isInLine} {innerWidth} {clickKeycap} />\n      </div>\n    {/each}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import BlockOfKeyCaps from './keyboardblock/BlockOfKeycaps.svelte'\n  import type { KeyboardBlock } from '../../types/keyboardContent'\n  import { GAP_BETWEEN_BLOCKS, SM_BREAKPOINT, getMode } from '../../lib/sizes'\n  import type { KeyCap } from '../../types/keycap'\n  import BlockOfKeycapsWithPagination from './keyboardblock/BlockOfKeycapsWithPagination.svelte'\n  import { afterUpdate, beforeUpdate } from 'svelte'\n\n  export let innerWidth: number\n  export let unitsBlocks: KeyboardBlock[]\n  export let usualBlocks: KeyboardBlock[]\n  export let page: KeyboardBlock[]\n  let blocks: KeyboardBlock[] =\n    unitsBlocks.length > 1 ? [...usualBlocks] : [...unitsBlocks, ...usualBlocks]\n  export let clickKeycap: (data: KeyCap, event: MouseEvent) => void\n  export let isInLine: boolean\n  // // $: blocksToBeDisplayed = isInLine ? [...page] : [...blocks]\n  $: blockgapsize = GAP_BETWEEN_BLOCKS[getMode(innerWidth, isInLine)]\n\n  beforeUpdate(() => {\n    // if (debug) console.log('beforeUpdate KeyboardPage)\n    blocks =\n      unitsBlocks.length > 1\n        ? [...usualBlocks]\n        : [...unitsBlocks, ...usualBlocks]\n  })\n\n  afterUpdate(() => {\n    // if (debug) console.log('afterUpdate KeyboardPage)\n  })\n</script>\n\n<div\n  class=\"bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark flex flex-row blockgap items-center justify-center w-full\"\n  style=\"--blockgapsize:{blockgapsize}\"\n>\n  {#if isInLine}\n    <div id=\"kb-page\" class=\"flex flex-row blockgap items-start justify-center\">\n      {#each page as block}\n        <BlockOfKeyCaps {block} {isInLine} {innerWidth} {clickKeycap} />\n      {/each}\n    </div>\n  {:else}\n    <div class=\"{unitsBlocks.length > 1 && !isInLine ? 'flex' : 'hidden'}\">\n      <BlockOfKeycapsWithPagination\n        blocksList=\"{unitsBlocks}\"\n        {isInLine}\n        {clickKeycap}\n      />\n    </div>\n    <div\n      id=\"kb-block\"\n      class=\"flex flex-row blockgap items-start justify-center\"\n    >\n      {#each blocks as block}\n        <BlockOfKeyCaps {block} {isInLine} {innerWidth} {clickKeycap} />\n      {/each}\n    </div>\n  {/if}\n</div>\n\n<style>\n  .blockgap {\n    column-gap: calc(var(--blockgapsize) * 1px);\n  }\n</style>\n","import type { KeysList, AlphanumericPages } from '../types/keyboardContent'\n\nconst rowsAlphaLow: KeysList[] = [\n  ['a', 'z', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p'],\n  ['q', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l', 'm'],\n  ['ABC', 'w', 'x', 'c', 'v', 'b', 'n', 'DEL'],\n  ['NUM', 'COMMA', 'SPACE', 'POINT', 'BACK', 'FWD', 'CLOSE'],\n]\nconst rowsAlphaUp: KeysList[] = [\n  ['A', 'Z', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P'],\n  ['Q', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L', 'M'],\n  ['abc', 'W', 'X', 'C', 'V', 'B', 'N', 'DEL'],\n  ['NUM', 'COMMA', 'SPACE', 'POINT', 'BACK', 'FWD', 'CLOSE'],\n]\nconst rowsNum: KeysList[] = [\n  [1, 2, 3, 4, 5, 6, 7, 8, 9, 0],\n  [\n    'ADD',\n    'SUB',\n    'MULT',\n    'DIV',\n    'FRAC',\n    '=',\n    'COLON',\n    'SEMICOLON',\n    'QUOTE',\n    'DBLQUOTE',\n  ],\n  ['SQ', 'CUBE', 'POW', 'POW10', 'SQRT', 'LESS', 'GREAT', 'AND', 'OR', 'AST'],\n  ['abc', '(', ')', '[', ']', '{', '}', 'INTPOINT', 'EXCPOINT', 'PERCENT'],\n]\n\nexport const alphanumericLayouts: { [key in AlphanumericPages]: KeysList[] } = {\n  AlphaLow: rowsAlphaLow,\n  AlphaUp: rowsAlphaUp,\n  Numeric: rowsNum,\n}\n","<script lang=\"ts\">\n  import { alphanumericLayouts } from '../../layouts/alphanumericRows'\n  import { isSpecialKey } from '../../types/keycap'\n  import { keys } from '../../lib/keycaps'\n  import type { AlphanumericPages, Keys } from '../../types/keyboardContent'\n  import type { KeyCap } from '../../types/keycap'\n  // import type { KeyCap } from '../../types/keycap'\n  export let pageType: AlphanumericPages\n  $: rows = alphanumericLayouts[pageType]\n  export let clickKeycap: (\n    data: KeyCap,\n    event: MouseEvent,\n    value?: Keys,\n  ) => void\n</script>\n\n<div class=\"flex justify-center\">\n  <div\n    class=\"flex flex-col w-2/3 space-y-1 md:space-y-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas-dark\"\n  >\n    {#each rows as row}\n      <div\n        class=\"flex flex-row w-full bg-coopmaths-canvas dark:bg-coopmathsdark-canvas-dark justify-evenly space-x-1 md:space-x-4\"\n      >\n        {#each row as key}\n          <button\n            type=\"button\"\n            class=\"key--{key} flex justify-center items-center grow h-10 text-mormal md:text-xl border-b-2 border-r border-r-slate-400 dark:border-r-gray-500 border-b-slate-300 dark:border-b-gray-600 active:border-b-0 active:border-r-0 text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light active:text-coopmaths-canvas active:translate-y-[1.5px] dark:active:text-coopmathsdark-canvas active:bg-coopmaths-action active:shadow-none dark:active:bg-coopmathsdark-action dark:active:shadow-none transition-transform ease-in-out shadow-[2px_2px_4px_rgba(180,180,180,0.5)]\n            {isSpecialKey(key)\n              ? 'bg-coopmaths-canvas-moredark dark:bg-coopmathsdark-canvas-moredark'\n              : 'bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas-darkest'}  py-1.5 px-2 md:py-2 md:px-4 text-center rounded-md font-mono\"\n            on:click=\"{(e) => {\n              clickKeycap(keys[key], e, key)\n            }}\"\n          >\n            <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n            {@html keys[key].display}\n          </button>\n        {/each}\n      </div>\n    {/each}\n  </div>\n</div>\n\n<style>\n  button.key--SPACE {\n    flex: var(--special-flex, 3);\n  }\n</style>\n","<script lang=\"ts\">\n  import { tick } from 'svelte'\n  import { keyboardState } from './stores/keyboardStore'\n  import { mathaleaRenderDiv } from '../../lib/mathalea'\n  import { fly } from 'svelte/transition'\n  import {\n    Keyboard,\n    inLineBlockWidth,\n    type KeyboardBlock,\n    type Keys,\n    type AlphanumericPages,\n  } from './types/keyboardContent'\n  import { keyboardBlocks } from './layouts/keysBlocks'\n  import KeyboardPage from './presentationalComponents/keyboardpage/KeyboardPage.svelte'\n  import { GAP_BETWEEN_BLOCKS, getMode } from './lib/sizes'\n  import type { KeyCap } from './types/keycap'\n  import { MathfieldElement } from 'mathlive'\n  import Alphanumeric from './presentationalComponents/alphanumeric/Alphanumeric.svelte'\n  import { isPageKey } from './types/keycap'\n\n  $: innerWidth = 0\n\n  let pages: KeyboardBlock[][] = []\n  let usualBlocks: KeyboardBlock[] = []\n  let unitsBlocks: KeyboardBlock[] = []\n  let currentPageIndex = 0\n  let divKeyboard: HTMLDivElement\n  let alphanumericDisplayed: boolean = false\n  let isVisible = false\n  let isInLine = false\n  let pageType: AlphanumericPages = 'AlphaLow'\n  const myKeyboard: Keyboard = new Keyboard()\n\n  const computePages = () => {\n    pages.length = 0\n    let pageWidth: number = 0\n    let page: KeyboardBlock[] = []\n    const mode = getMode(innerWidth, true)\n    const blockList = [...usualBlocks, ...unitsBlocks].reverse()\n    while (blockList.length > 0) {\n      const block = blockList.pop()\n      const blockWidth =\n        inLineBlockWidth(block!, mode) + GAP_BETWEEN_BLOCKS[mode]\n      if (pageWidth + blockWidth > 0.8 * innerWidth) {\n        // plus de places\n        pages.push(page.reverse())\n        page = []\n        pageWidth = 0\n      }\n      page.push(block!)\n      pageWidth = +blockWidth\n    }\n    if (page.length !== 0) {\n      pages.push(page.reverse())\n    }\n  }\n\n  keyboardState.subscribe(async (value) => {\n    isVisible = value.isVisible\n    isInLine = value.isInLine\n    pageType = value.alphanumericLayout\n    myKeyboard.empty()\n    for (const block of value.blocks) {\n      if (block !== 'alphanumeric') myKeyboard.add(keyboardBlocks[block])\n    }\n    myKeyboard.checkSmallLayoutAllowed()\n    unitsBlocks.length = 0\n    usualBlocks.length = 0\n    for (const block of myKeyboard.blocks) {\n      if (\n        block &&\n        Object.prototype.hasOwnProperty.call(block, 'isUnits') &&\n        block.isUnits\n      ) {\n        unitsBlocks.push(block)\n      } else {\n        usualBlocks.push(block)\n      }\n    }\n    unitsBlocks = unitsBlocks\n    usualBlocks = usualBlocks\n    computePages()\n    pages = pages\n    if (currentPageIndex >= pages.length) currentPageIndex = 0\n    alphanumericDisplayed = value.blocks.includes('alphanumeric')\n    await tick()\n    mathaleaRenderDiv(divKeyboard)\n    // document.dispatchEvent(new window.Event('KeyboardUpdated', { bubbles: true }))\n    // console.log('message envoy: ' + 'KeyboardUpdated')\n  })\n\n  async function navRight(e: MouseEvent) {\n    e.preventDefault()\n    e.stopPropagation()\n    if (currentPageIndex !== 0) {\n      currentPageIndex--\n    }\n    // console.log('page  afficher n' + currentPageIndex)\n    // console.log(pages[currentPageIndex])\n    await tick()\n    mathaleaRenderDiv(divKeyboard)\n  }\n\n  async function navLeft(e: MouseEvent) {\n    e.preventDefault()\n    e.stopPropagation()\n    if (currentPageIndex !== pages.length - 1) {\n      currentPageIndex++\n    }\n    // console.log('page  afficher n' + currentPageIndex)\n    // console.log(pages[currentPageIndex])\n    await tick()\n    mathaleaRenderDiv(divKeyboard)\n  }\n\n  const clickKeycap = (key: KeyCap, event: MouseEvent, value?: Keys) => {\n    if (value && isPageKey(value)) {\n      // la touche est une touche du clavier alphanumeric pour changer de page\n      switch (value) {\n        case 'abc':\n          $keyboardState.alphanumericLayout = 'AlphaLow'\n          break\n        case 'ABC':\n          $keyboardState.alphanumericLayout = 'AlphaUp'\n          break\n        case 'NUM':\n          $keyboardState.alphanumericLayout = 'Numeric'\n          break\n        default:\n          $keyboardState.alphanumericLayout = 'AlphaLow'\n          break\n      }\n    } else {\n      if (event.currentTarget instanceof HTMLButtonElement) {\n        const idMathField = $keyboardState.idMathField\n        const mf = document.querySelector(\n          ('#' + idMathField).replace('-button', ''),\n        ) as MathfieldElement\n        // console.log({\n        //   mf,\n        //   idMathField,\n        //   command: `${key.command}`,\n        //   insert: `${key.insert}`\n        // })\n        if (mf != null) {\n          mf.focus()\n          if (key.command && key.command === 'closeKeyboard') {\n            keyboardState.update((value) => {\n              value.isVisible = false\n              value.idMathField = ''\n              return value\n            })\n          } else if (key.command && key.command[0] !== '') {\n            // @ts-expect-error : command doit tre compatible avec MathLive\n            mf.executeCommand(key.command)\n          } else {\n            mf.executeCommand(['insert', key.insert || key.display])\n          }\n        }\n      }\n    }\n  }\n</script>\n\n<svelte:window bind:innerWidth />\n{#if isVisible}\n  <div\n    on:mousedown=\"{(e) => {\n      e.preventDefault()\n      e.stopPropagation()\n    }}\"\n    role=\"none\"\n    transition:fly|global=\"{{ y: '100%', opacity: 1 }}\"\n    bind:this=\"{divKeyboard}\"\n    class=\" bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark p-2 md:p-4 w-full fixed bottom-0 left-0 right-0 z-[9999] drop-shadow-[0_-3px_5px_rgba(130,130,130,0.25)] dark:drop-shadow-[0_-3px_5px_rgba(250,250,250,0.25)]\"\n  >\n    {#if alphanumericDisplayed}\n      <Alphanumeric {clickKeycap} {pageType} />\n    {:else}\n      <div class=\"{isInLine ? 'relative px-10' : 'py-2 md:py-0'}\">\n        <KeyboardPage\n          unitsBlocks=\"{[...unitsBlocks].reverse()}\"\n          usualBlocks=\"{[...usualBlocks].reverse()}\"\n          page=\"{pages[currentPageIndex]}\"\n          {isInLine}\n          {innerWidth}\n          {clickKeycap}\n        />\n        <!-- Boutons de navigation entre les pages : vers la DROITE -->\n        <button\n          id=\"kb-nav-right\"\n          class=\"absolute right-2 md:right-0 top-0 bottom-0 m-auto flex justify-center items-center h-8 w-8 text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest disabled:text-opacity-0 dark:disabled:text-opacity-0\"\n          on:click=\"{navRight}\"\n          on:mousedown=\"{(e) => {\n            e.preventDefault()\n            e.stopPropagation()\n          }}\"\n          disabled=\"{pages.length === 1 || currentPageIndex === 0 || !isInLine}\"\n        >\n          <i class=\"bx bx-chevron-right bx-lg\"></i>\n        </button>\n        <!-- Boutons de navigation entre les pages : vers la GAUCHE -->\n        <button\n          id=\"kb-nav-left\"\n          class=\"absolute left-2 md:left-0 top-0 bottom-0 m-auto flex justify-center items-center h-8 w-8 text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest disabled:text-opacity-0 dark:disabled:text-opacity-0\"\n          on:click=\"{navLeft}\"\n          on:mousedown=\"{(e) => {\n            e.preventDefault()\n            e.stopPropagation()\n          }}\"\n          disabled=\"{pages.length === 1 ||\n            currentPageIndex === pages.length - 1 ||\n            !isInLine}\"\n        >\n          <i class=\"bx bx-chevron-left bx-lg\"></i>\n        </button>\n      </div>\n    {/if}\n    <!-- Bouton de rduction du clavier -->\n    <button\n      id=\"kb-nav-reduced\"\n      type=\"button\"\n      class=\"z-[10000] absolute right-0 top-0 h-5 w-5 rounded-sm bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action-light dark:hover:bg-coopmathsdark-action-lightest text-coopmaths-canvas dark:text-coopmaths-canvas\"\n      on:click=\"{async (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        computePages()\n        $keyboardState.isInLine = !$keyboardState.isInLine\n        await tick()\n        mathaleaRenderDiv(divKeyboard)\n      }}\"\n      on:mousedown=\"{(e) => {\n        e.preventDefault()\n        e.stopPropagation()\n      }}\"\n    >\n      <i class=\"bx {isInLine ? 'bx-plus' : 'bx-minus'}\"></i>\n    </button>\n    <!-- bouton de passage du clavier alphanumrique au clavier maths-->\n    <button\n      id=\"kb-nav-alpha\"\n      type=\"button\"\n      class=\"z-[10000] {$keyboardState.blocks.includes('alphanumeric')\n        ? 'flex justify-center items-center'\n        : 'hidden'} absolute right-0 top-6 h-5 w-5 rounded-sm bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action-light dark:hover:bg-coopmathsdark-action-lightest text-coopmaths-canvas dark:text-coopmaths-canvas\"\n      on:click=\"{async (e) => {\n        e.preventDefault()\n        e.stopPropagation()\n        alphanumericDisplayed = !alphanumericDisplayed\n        await tick()\n        mathaleaRenderDiv(divKeyboard)\n      }}\"\n      on:mousedown=\"{(e) => {\n        e.preventDefault()\n        e.stopPropagation()\n      }}\"\n    >\n      <i class=\"bx {alphanumericDisplayed ? 'bx-math' : 'bx-font-family'}\"></i>\n    </button>\n  </div>\n{/if}\n","<script lang=\"ts\">\n  export let widthFactor: number\n  export let displayedTime: string\n</script>\n\n<div\n  class=\"w-full bg-coopmaths-canvas dark:bg-coopmathsdark-canvas flex flex-row\"\n>\n  <div\n    class=\"relative h-5 bg-coopmaths-warn-500 dark:bg-coopmathsdark-struct-dark\"\n    style=\"width: calc( 100% * {widthFactor} );\"\n  >\n    <div\n      id=\"time-display-1\"\n      class=\"{widthFactor <= 0.2\n        ? 'hidden'\n        : ''} absolute right-2 top-1/2 -translate-y-1/2 text-coopmaths-corpus dark:text-coopmaths-corpus font-extralight dark:font-light text-lg\"\n    >\n      {displayedTime}\n    </div>\n  </div>\n  <div\n    class=\"relative h-5 bg-coopmaths-action bg-opacity-70 dark:bg-coopmathsdark-warn-light dark:bg-opacity-70\"\n    style=\"width: calc( 100% * ( 1 - {widthFactor} ) );\"\n  >\n    <div\n      id=\"time-display-2\"\n      class=\"{widthFactor > 0.2\n        ? 'hidden'\n        : ''} absolute left-2 top-1/2 -translate-y-1/2 text-coopmaths-corpus dark:text-coopmaths-corpus font-extralight dark:font-light text-lg\"\n    >\n      {displayedTime}\n    </div>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { onDestroy, createEventDispatcher } from 'svelte'\n  import ElapsedTime from './ElapsedTime.svelte'\n  import { millisecondToMinSec } from '../../../../lib/components/time'\n\n  export let durationInMilliSeconds\n  const dispatch = createEventDispatcher()\n\n  let elapsed = 0\n  const duration = durationInMilliSeconds // 1min\n  let displayedTime = ''\n  let widthFactor = 1\n\n  let lastTime = window.performance.now()\n  let frame: number | undefined\n  ;(function update() {\n    const time = window.performance.now()\n    elapsed += time - lastTime\n\n    if (elapsed > duration) {\n      terminateTimer()\n    } else {\n      frame = requestAnimationFrame(update)\n      const timeD = millisecondToMinSec(duration - elapsed)\n      const formattedtime = [\n        timeD.minutes.toString().padStart(2, '0'),\n        timeD.seconds.toString().padStart(2, '0'),\n      ].join(':')\n\n      displayedTime = formattedtime\n      widthFactor = (duration - elapsed) / duration\n      lastTime = time\n    }\n  })()\n\n  export const terminateTimer = (): void => {\n    if (frame) cancelAnimationFrame(frame)\n    frame = undefined\n    dispatch('message', {\n      state: 'endTimer',\n      elapsed,\n      duration,\n    })\n  }\n  onDestroy(() => {\n    if (frame) cancelAnimationFrame(frame)\n    frame = undefined\n  })\n</script>\n\n<ElapsedTime {widthFactor} {displayedTime} />\n","<script lang=\"ts\">\n  import { afterUpdate, type SvelteComponent } from 'svelte'\n  import type { CanState } from '../../../../lib/types/can'\n  import Question from './Question.svelte'\n  import Pagination from './Pagination.svelte'\n  import NavigationButtons from './NavigationButtons.svelte'\n  import { canOptions } from '../../../../lib/stores/canStore'\n  import Keyboard from '../../../keyboard/Keyboard.svelte'\n  import { keyboardState } from '../../../keyboard/stores/keyboardStore'\n  import Timer from './Timer.svelte'\n  interface TimerComponent extends SvelteComponent {\n    terminateTimer: () => void\n  }\n\n  export let state: CanState\n  export let numberOfSeconds: number = 20\n  export let checkAnswers: () => void\n  let current: number = 0\n  export let questions: string[]\n  export let consignes: string[]\n  const numberOfQuestions: number = questions.length\n  let timerComponent: TimerComponent\n\n  afterUpdate(() => {\n    const exercicesAffiches = new window.Event('exercicesAffiches', {\n      bubbles: true,\n    })\n    document.dispatchEvent(exercicesAffiches)\n  })\n\n  function endTimer(e: CustomEvent) {\n    const du = parseInt(e.detail.duration)\n    const el = parseInt(e.detail.elapsed)\n    $canOptions.remainingTimeInSeconds =\n      el >= du ? 0 : Math.floor((du - el) / 1000)\n    handleEndOfRace()\n  }\n  /**\n   * Gestion de la fin de la course : on annule le dcompte,\n   * si le mode interactif est prsent, on vrifie les questions\n   * et on bascule sur l'tat `end`\n   */\n  function handleEndOfRace() {\n    if ($canOptions.isInteractive) {\n      checkAnswers()\n    }\n    state = 'end'\n  }\n\n  function nextQuestion() {\n    if (current < numberOfQuestions - 1) {\n      current += 1\n    }\n  }\n</script>\n\n<div\n  class=\"w-full h-full flex flex-col justify-between items-center overflow-y-auto bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n>\n  <div class=\"w-full flex flex-col\">\n    <Timer\n      bind:this=\"{timerComponent}\"\n      durationInMilliSeconds=\"{numberOfSeconds * 1000}\"\n      on:message=\"{endTimer}\"\n    />\n    <Pagination\n      bind:current\n      {numberOfQuestions}\n      state=\"{'race'}\"\n      resultsByQuestion=\"{[]}\"\n    />\n  </div>\n  <div\n    id=\"questions-container\"\n    class=\"flex flex-col justify-center items-center font-light text-coopmaths-corpus dark:text-coopmathsdark-corpus text-3xl md:text-5xl\n     {$keyboardState.isVisible && !$keyboardState.isInLine\n      ? 'h-[calc(100%-30rem)]'\n      : ''}\n     {$keyboardState.isVisible && $keyboardState.isInLine\n      ? 'h-[calc(100%-20rem)]'\n      : ''}\n     {!$keyboardState.isVisible ? 'h-full' : ''} w-full\"\n  >\n    {#each [...Array(numberOfQuestions).keys()] as i}\n      <Question\n        consigne=\"{consignes[i]}\"\n        question=\"{questions[i]}\"\n        consigneCorrection=\"{''}\"\n        correction=\"{''}\"\n        mode=\"{'display'}\"\n        visible=\"{current === i}\"\n        index=\"{i}\"\n        {nextQuestion}\n      />\n    {/each}\n  </div>\n  <div\n    class=\"flex justify-center w-full {$keyboardState.isVisible &&\n    $keyboardState.isInLine\n      ? 'mb-20'\n      : ''} {$keyboardState.isVisible && !$keyboardState.isInLine\n      ? 'mb-52'\n      : ''}\"\n  >\n    <NavigationButtons\n      bind:current\n      {numberOfQuestions}\n      handleEndOfRace=\"{() => {\n        timerComponent.terminateTimer()\n      }}\"\n      {state}\n      resultsByQuestion=\"{[]}\"\n    />\n  </div>\n  <Keyboard />\n</div>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import { getUniqueStringBasedOnTimeStamp } from '../../../lib/components/time'\n\n  export let titles: string[] = ['', '']\n  export let value: boolean = true\n  export let isDisabled: boolean = false\n  export let classAddenda: string = ''\n  export let textSize: string = 'sm'\n  export let buttonSize: string = 'sm'\n  export let id: string = 'toggle-' + getUniqueStringBasedOnTimeStamp()\n\n  const dispatch = createEventDispatcher()\n\n  function toggle() {\n    value = !value\n    dispatch('toggle')\n  }\n</script>\n\n<!--\n  @component\n  Bouton toogle avec deux tats\n\n  __Paramtres__ :\n\n  * `titles` : tableau pour le titre du boutons (un pour `true`, un pour `false`)\n  * `value`: boolen li au bouton\n  * `isDisabled`: boolen servant  dsactiver le bouton\n  * `classAddenda`: chane correspondant  des _ajouts_ pour le style\n\n  Usage:\n    ```tsx\n  <ButtonToggle\n      titles={['Titre pour true', 'Titre pour false']}\n      bind:value={maVariable}\n      isDisabled={variable2 === 0}\n      on:click={maFonction}\n  />\n  ```\n -->\n<div class=\"flex flex-row justify-start items-center {classAddenda}\">\n  <button\n    type=\"button\"\n    {id}\n    class=\"flex justify-center items-center\"\n    on:click=\"{toggle}\"\n    disabled=\"{isDisabled}\"\n  >\n    <i\n      class=\" text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-{buttonSize} translate-y-[0.15rem] {value\n        ? 'bx-toggle-right'\n        : 'bx-toggle-left'}\n        {isDisabled ? 'text-opacity-10' : ''}\"\n      aria-describedby=\"{value ? titles[0] : titles[1]}\"\n    ></i>\n  </button>\n  <div\n    class=\"{textSize === 'xs'\n      ? 'pl-1'\n      : 'pl-2'} inline-block text-{textSize} font-light text-coopmaths-corpus dark:text-coopmathsdark-corpus {isDisabled\n      ? 'text-opacity-10'\n      : 'text-opacity-70'}\"\n  >\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    {@html `${value ? titles[0] : titles[1]}`}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { afterUpdate, onMount } from 'svelte'\n  import { mathaleaRenderDiv } from '../../../../lib/mathalea'\n  import { canOptions } from '../../../../lib/stores/canStore'\n  import ButtonToggle from '../../../shared/forms/ButtonToggle.svelte'\n  import NavigationButtons from './NavigationButtons.svelte'\n  import Pagination from './Pagination.svelte'\n  import Question from './Question.svelte'\n\n  let current: number = 0\n  export let questions: string[]\n  export let consignes: string[]\n  export let corrections: string[]\n  export let consignesCorrections: string[]\n  export let answers: string[]\n  export let resultsByQuestion: boolean[]\n  export let time: string\n  export let score: string\n  const numberOfQuestions: number = questions.length\n  const solutionDisplayed: boolean[] = new Array(numberOfQuestions).fill(false)\n\n  let displayCorrection = true\n\n  onMount(() => {\n    const questionContent = document.getElementById(\n      'can-solutions',\n    ) as HTMLDivElement\n    if (questionContent) {\n      mathaleaRenderDiv(questionContent)\n    }\n  })\n\n  afterUpdate(() => {\n    const answersContents = document.querySelectorAll(\n      '[id^=\"answer-container\"]',\n    )\n    for (let i = 0; i < answersContents.length; i++) {\n      const content = answersContents[i] as HTMLDivElement\n      mathaleaRenderDiv(content)\n    }\n    const exercicesAffiches = new window.Event('exercicesAffiches', {\n      bubbles: true,\n    })\n    document.dispatchEvent(exercicesAffiches)\n  })\n\n  function formatAnswer(question: string, answer: string) {\n    if (!answer) return 'aucune'\n    if (question.includes('checkbox')) return answer // Pour les QCM\n    if (question.includes('<liste-deroulante')) return answer // Pour les listeDeroulante\n    if (question.includes('interactive-clock'))\n      return `$${answer.split('h')[0]}$ h $${answer.split('h')[1]}$` // Pour les horloges interactives\n    if (question.includes('<input') && question.includes('champTexteEx'))\n      return answer // Pour les champTexte\n    if (question.includes('apigeomEx')) return answer // Pour le \"Voir figure\" des figures apigeom\n    if (question.includes('divDragAndDropEx')) return answer // Pour les drag and drop\n    return '$' + cleanFillInTheBlanks(answer, false) + '$'\n  }\n\n  function removeMathField(text: string, removeDollar: boolean = true) {\n    if (typeof text !== 'string') return ''\n    if (text.includes('placeholder'))\n      return cleanFillInTheBlanks(text, removeDollar) // Pour les fillInTheBlanks\n    if (text.includes('interactive-clock')) return removeInteractiveClock(text) // Pour les horloges interactives\n    if (text.includes('<select')) return cleanSelect(text) // Pour les listeDeroulante\n    const regex = /<math-field[^>]*>[^]*?<\\/math-field>/g\n    return text.replace(regex, ' ... ')\n  }\n\n  function cleanSelect(text: string) {\n    const regex = /<select[^>]*>[^]*?<\\/select>/g\n    return text.replace(regex, '')\n  }\n\n  function cleanFillInTheBlanks(text: string, removeDollar: boolean = true) {\n    if (typeof text !== 'string') return ''\n    if (removeDollar) text = text.replace(/\\$/g, '')\n    return text\n      .replace(/\\\\placeholder(\\[[^\\]]*\\])+/g, '')\n      .replace(/\\{\\}/g, '{...}')\n  }\n\n  function removeInteractiveClock(text: string) {\n    if (typeof text !== 'string') return ''\n    const regex = /<interactive-clock[^>]*\\/>/g\n    return text.replace(regex, '')\n  }\n</script>\n\n<div\n  class=\"w-full h-full flex flex-col items-center bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\n   {$canOptions.solutionsMode === 'split'\n    ? 'justify-between'\n    : 'justify-start'}\"\n>\n  {#if $canOptions.solutionsMode === 'split'}\n    <div class=\"w-full flex flex-col\">\n      <Pagination\n        bind:current\n        {numberOfQuestions}\n        {resultsByQuestion}\n        state=\"{'solutions'}\"\n      />\n    </div>\n    <div\n      class=\"flex flex-col justify-center items-center font-light text-coopmaths-corpus dark:text-coopmathsdark-corpus text-3xl md:text-5xl\"\n    >\n      {#key current}\n        <Question\n          consigne=\"{consignes[current]}\"\n          question=\"{questions[current]}\"\n          consigneCorrection=\"{consignesCorrections[current]}\"\n          correction=\"{corrections[current]}\"\n          mode=\"{'correction'}\"\n          visible=\"{true}\"\n          index=\"{current}\"\n          nextQuestion=\"{() => {}}\"\n        />\n        {#if $canOptions.isInteractive}\n          <div\n            id=\"answer-container-{current}\"\n            class=\"text-2xl text-coopmaths-corpus dark:text-coopmathsdark-corpus font-light py-2 md:py-4\"\n          >\n            Rponse donne&nbsp;:&nbsp;\n            <span\n              id=\"answer-{current}\"\n              class=\"text-coopmaths-warn-800 dark:text-coopmathsdark-warn font-medium\"\n            >\n              {@html formatAnswer(questions[current], answers[current])}\n            </span>\n          </div>\n        {/if}\n      {/key}\n    </div>\n    <NavigationButtons\n      bind:current\n      {numberOfQuestions}\n      state=\"{'solutions'}\"\n      {resultsByQuestion}\n      handleEndOfRace=\"{() => {}}\"\n    />\n  {/if}\n  {#if $canOptions.solutionsMode === 'gathered'}\n    <div\n      class=\"w-full flex justify-center items-center p-6 bg-coopmaths-struct text-coopmaths-canvas dark:bg-coopmathsdark-struct dark:text-coopmathsdark-canvas text-5xl md:text-7xl font-black\"\n    >\n      Corrections\n    </div>\n    <div\n      class=\"w-full grid grid-rows-3 md:grid-cols-3 py-4 px-4 md:px-10 mb-10\"\n    >\n      {#if $canOptions.isInteractive}\n        <div\n          id=\"score\"\n          class=\"text-normal text-center text-coopmaths-corpus dark:text-coopmathsdark-corpus font-light\"\n        >\n          Score : <span\n            class=\"text-coopmaths-warn-1000 dark:text-coopmathsdark-warn font-bold\"\n            >{score}</span\n          >\n        </div>\n      {/if}\n      <div\n        id=\"score\"\n        class=\"text-normal text-center text-coopmaths-corpus dark:text-coopmathsdark-corpus font-light\"\n      >\n        Temps : <span\n          class=\"text-coopmaths-warn-1000 dark:text-coopmathsdark-warn font-bold\"\n          >{time}</span\n        >\n      </div>\n      <div class=\"flex justify-center text-center\">\n        <ButtonToggle\n          bind:value=\"{displayCorrection}\"\n          titles=\"{[\n            'Correction uniquement des mauvaises rponses',\n            'Correction de toutes les questions',\n          ]}\"\n        />\n      </div>\n    </div>\n    <ol\n      class=\"w-full list-none list-inside text-base flex flex-row flex-wrap p-4 md:p-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n      id=\"can-solutions\"\n    >\n      {#each [...Array(numberOfQuestions).keys()] as i}\n        <li class=\"break-inside-avoid-column mx-2 min-w-[32%]\">\n          <div class=\"flex flex-row items-center justify-start\">\n            <div\n              class=\"text-lg text-coopmaths-struct dark:text-coopmathsdark-struct font-bold\"\n            >\n              Question {i + 1}\n            </div>\n            <div\n              class=\"{$canOptions.isInteractive ? 'flex text-xl' : 'hidden'}\"\n            >\n              {#if resultsByQuestion[i]}\n                <button\n                  type=\"button\"\n                  on:click=\"{() => {\n                    solutionDisplayed[i] = !solutionDisplayed[i]\n                  }}\"\n                >\n                  <i\n                    class=\"pl-2 bx bxs-check-square text-coopmaths-warn-800 dark:text-green-500\"\n                  ></i>\n                </button>\n              {:else}\n                <i\n                  class=\"pl-2 bx bxs-x-square text-red-500 dark:text-coopmathsdark-warn\"\n                ></i>\n              {/if}\n            </div>\n          </div>\n          <div class=\"flex flex-col\">\n            <div\n              class=\"p-2 text-pretty text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n              hidden=\"{!solutionDisplayed[i] &&\n                resultsByQuestion[i] &&\n                displayCorrection}\"\n            >\n              <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n              {@html removeMathField(questions[i], false)}\n            </div>\n            <div\n              class=\"p-2 text-pretty bg-coopmaths-warn-200 dark:bg-coopmathsdark-warn-lightest text-coopmaths-corpus dark:text-coopmathsdark-corpus-darkest\"\n              hidden=\"{!solutionDisplayed[i] &&\n                resultsByQuestion[i] &&\n                displayCorrection}\"\n            >\n              <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n              {@html consignesCorrections[i]}\n              <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n              {@html corrections[i]}\n            </div>\n            <div\n              id=\"answer-container-{i}\"\n              class=\"{$canOptions.isInteractive &&\n              (!resultsByQuestion[i] || !displayCorrection)\n                ? 'flex text-coopmaths-corpus dark:text-coopmathsdark-corpus font-light py-2 md:py-4'\n                : 'hidden'} \"\n            >\n              Rponse donne&nbsp;:&nbsp;\n              <span\n                id=\"answer-{i}\"\n                class=\"text-coopmaths-warn-1000 dark:text-coopmathsdark-warn font-medium\"\n              >\n                {@html formatAnswer(questions[i], answers[i])}\n              </span>\n            </div>\n          </div>\n        </li>\n      {/each}\n    </ol>\n  {/if}\n</div>\n","import { exercicesParams, globalOptions } from '../lib/stores/generalStore'\nimport type { InterfaceParams } from '../lib/types'\nimport { logDebug, log, getIntrus } from './statsUtils'\n\ndeclare global {\n  interface Window {\n    _paq: any[]\n    logDebug: number\n  }\n}\n\n// pour pour pouvoir le dactiver en mode debug...\n// eslint-disable-next-line prefer-const\nlet activeStats = document.location.hostname === 'coopmaths.fr'\n\nif (activeStats) {\n  const _paq = (window._paq = window._paq || [])\n  _paq.push(['trackPageView'])\n  ;(function () {\n    const u = '//ynh.coopmaths.fr/matomo/'\n    _paq.push(['setTrackerUrl', u + 'matomo.php'])\n    _paq.push(['setSiteId', '1'])\n    const d = document\n    const g = d.createElement('script')\n    const s = d.getElementsByTagName('script')[0]\n    g.async = true\n    g.src = u + 'matomo.js'\n    if (s.parentNode) {\n      s.parentNode.insertBefore(g, s)\n    }\n  })()\n}\n\nlogDebug('Matomo loaded')\n\nconst paramExos: string[] = []\nconst uuids: string[] = []\nconst vueUuids: string[] = []\nconst vue: string[] = ['']\nconst recorder: string[] = ['']\n\nfunction paraConvert(param: InterfaceParams) {\n  const par: {\n    nb?: number\n    uuid: string\n    t?: string\n    e?: string | number\n    c?: string\n    et?: string | number\n    s1?: string\n    s2?: string\n    s3?: string\n    s4?: string\n    s5?: string\n    a?: string\n    i?: string\n    s?: number\n  } = { uuid: param.uuid }\n  if (param.nbQuestions) par.nb = param.nbQuestions\n  if (param.type) par.t = param.type\n  if (param.exo) par.e = param.exo\n  if (param.exoType) par.et = param.exoType\n  if (param.cd) par.c = param.cd\n  if (param.sup) par.s1 = param.sup.replace('true', 't').replace('false', 'f')\n  if (param.sup2) par.s2 = param.sup2.replace('true', 't').replace('false', 'f')\n  if (param.sup3) par.s3 = param.sup3.replace('true', 't').replace('false', 'f')\n  if (param.sup4) par.s4 = param.sup4.replace('true', 't').replace('false', 'f')\n  if (param.sup5) par.s5 = param.sup5.replace('true', 't').replace('false', 'f')\n  if (param.alea) par.a = param.alea\n  if (param.interactif) par.i = param.interactif\n  if (param.bestScore) par.s = param.bestScore\n  return par\n}\n\nglobalOptions.subscribe((options) => {\n  logDebug('globalOptions', options)\n\n  if (options) {\n    if (options.v === undefined) return // chargement du site\n    if (vue[0] === (options.v || 'prof')) {\n      logDebug('Pas de changement de vue')\n      return\n    }\n    // nouvelle vue\n    vue[0] = options.v || 'prof'\n    log('vue', vue[0])\n    if (window._paq) window._paq.push(['trackEvent', 'Vue', vue[0]])\n    // if (window._paq) window._paq.push(['setCustomDimension', 1, vue[0]])\n    if (options.recorder) recorder[0] = options.recorder\n    log('recorder', recorder[0])\n    // if (window._paq) window._paq.push(['setCustomDimension', 2, recorder[0]])\n    if (window._paq && options.recorder)\n      window._paq.push(['setCustomDimension', 1, options.recorder])\n\n    // changement de vue\n    const vueUuids1: string[] = []\n    for (let i = 0; i < paramExos.length; i++) {\n      const parsedExo = JSON.parse(paramExos[i])\n      // if (window._paq) window._paq.push(['trackEvent', 'VueExo', vue[0] + '-' + parsedExo.uuid, paramExos[i]])\n      log(vue[0] + '-' + parsedExo.uuid, 'par:', paramExos[i])\n      if (vue[0] !== '')\n        vueUuids1.push(\n          vue[0] +\n            '-' +\n            parsedExo.uuid +\n            (recorder[0] ? '-' + recorder[0] : ''),\n        )\n    }\n\n    // changement de vue pour les exercices\n    getIntrus(vueUuids1, vueUuids).forEach((intrus) => {\n      if (intrus.difference > 0) {\n        for (let j = 0; j < intrus.difference; j++) {\n          vueUuids.push(intrus.value)\n          log('Ajout de', intrus.value, 'dans vueUuids')\n          if (window._paq)\n            window._paq.push(['trackEvent', 'VueUuid', intrus.value])\n        }\n      } else if (intrus.difference < 0) {\n        for (let j = 0; j < Math.abs(intrus.difference); j++) {\n          const index = vueUuids.lastIndexOf(intrus.value)\n          if (index > -1) {\n            vueUuids.splice(index, 1)\n            log('Suppression de', intrus.value, 'de vueUuids')\n          }\n        }\n      }\n    })\n    logDebug('vueUuids:', vueUuids)\n  }\n})\n\nexercicesParams.subscribe((params) => {\n  logDebug('exercicesParams', params)\n  if (params) {\n    const vueUuids1: string[] = []\n    params.forEach((param) => {\n      // on met  jour la liste des exercices\n      if (uuids.includes(param.uuid)) {\n        logDebug('Uuid dj charg:', param.uuid)\n      } else {\n        uuids.push(param.uuid)\n        if (window._paq) window._paq.push(['trackEvent', 'Uuid', param.uuid])\n        log('Uuids-' + param.uuid)\n      }\n      // on met  jour la liste des paramtres avec la vue et le recorder:\n      if (vue[0] !== '')\n        vueUuids1.push(\n          vue[0] + '-' + param.uuid + (recorder[0] ? '-' + param.recorder : ''),\n        )\n      const par = paraConvert(param)\n      if (paramExos.includes(JSON.stringify(par))) {\n        logDebug('dj charg:', param.uuid)\n      } else {\n        paramExos.push(JSON.stringify(par))\n        // if (window._paq && vue[0] !== '') window._paq.push(['trackEvent', 'VueExo', vue[0] + '-' + par.uuid, JSON.stringify(par)])\n        if (vue[0] !== '')\n          log(vue[0] + '-' + par.uuid, 'par:', JSON.stringify(par))\n      }\n    })\n    // Supprimer les lments qui ne sont pas dans la rfrence\n    for (let i = paramExos.length - 1; i >= 0; i--) {\n      if (\n        !params.some(\n          (param) => JSON.stringify(paraConvert(param)) === paramExos[i],\n        )\n      ) {\n        const ele = paramExos.splice(i, 1)\n        log('exercice supprim', ele)\n      }\n    }\n    logDebug('paramExos:', paramExos)\n    for (let i = uuids.length - 1; i >= 0; i--) {\n      if (!params.some((param) => param.uuid === uuids[i])) {\n        const ele = uuids.splice(i, 1)\n        log('uuid supprim', ele)\n      }\n    }\n    logDebug('uuids:', uuids)\n    getIntrus(vueUuids1, vueUuids).forEach((intrus) => {\n      if (intrus.difference > 0) {\n        for (let j = 0; j < intrus.difference; j++) {\n          vueUuids.push(intrus.value)\n          log('Ajout de', intrus.value, 'dans vueUuids')\n          if (window._paq)\n            window._paq.push(['trackEvent', 'VueUuid', intrus.value])\n        }\n      } else if (intrus.difference < 0) {\n        for (let j = 0; j < Math.abs(intrus.difference); j++) {\n          const index = vueUuids.lastIndexOf(intrus.value)\n          if (index > -1) {\n            vueUuids.splice(index, 1)\n            log('Suppression de', intrus.value, 'de vueUuids')\n          }\n        }\n      }\n    })\n    logDebug('vueUuids:', vueUuids)\n  }\n})\n\nexport function statsCanTracker(recorder: string, vue: string) {\n  logDebug('Tracking can stats...')\n  for (let i = 0; i < vueUuids.length; i++) {\n    const uuid = vueUuids[i].split('-')[1]\n    if (window._paq) {\n      window._paq.push([\n        'trackEvent',\n        'CheckCan',\n        vue + '-' + uuid + (recorder ? '-' + recorder : ''),\n      ])\n    }\n    log(vue + '-' + uuid, 'CheckCan', recorder ? '-' + recorder : '')\n  }\n}\n","<script lang=\"ts\">\n  import type { CanState } from '../../../lib/types/can'\n  import type TypeExercice from '../../../exercices/Exercice'\n  import { canOptions } from '../../../lib/stores/canStore'\n  import CountDown from './presentationalComponents/CountDown.svelte'\n  import End from './presentationalComponents/End.svelte'\n  import KickOff from './presentationalComponents/KickOff.svelte'\n  import Race from './presentationalComponents/Race.svelte'\n  import { onMount } from 'svelte'\n  import {\n    splitExercisesIntoQuestions,\n    buildExercisesList,\n  } from '../../../lib/components/exercisesUtils'\n  import Solutions from './presentationalComponents/Solutions.svelte'\n  import { verifQuestionMathLive } from '../../../lib/interactif/mathLive'\n  import { verifQuestionQcm } from '../../../lib/interactif/qcm'\n  import { verifQuestionListeDeroulante } from '../../../lib/interactif/questionListeDeroulante'\n  import {\n    indexQuestionCliqueFigure,\n    verifQuestionCliqueFigure,\n  } from '../../../lib/interactif/cliqueFigure'\n  import {\n    darkMode,\n    exercicesParams,\n    globalOptions,\n    resultsByExercice,\n  } from '../../../lib/stores/generalStore'\n  import {\n    answersFromCapytale,\n    assignmentDataFromCapytale,\n    sendToCapytaleSaveStudentAssignment,\n  } from '../../../lib/handleCapytale'\n  import { millisecondToMinSec } from '../../../lib/components/time'\n  import { keyboardState } from '../../keyboard/stores/keyboardStore'\n  import type { InterfaceResultExercice } from '../../../lib/types'\n  import { context } from '../../../modules/context'\n  import { mathaleaUpdateUrlFromExercicesParams } from '../../../lib/mathalea'\n  import { get } from 'svelte/store'\n  import MetaExercice from '../../../exercices/MetaExerciceCan'\n  import { verifDragAndDrop } from '../../../lib/interactif/DragAndDrop'\n  import { statsCanTracker } from '../../../modules/stats'\n\n  let state: CanState = 'canHomeScreen'\n  let exercises: TypeExercice[] = []\n  let questions: string[] = []\n  let consignes: string[] = []\n  let corrections: string[] = []\n  let consignesCorrections: string[] = []\n  let indiceExercice: number[] = []\n  let indiceQuestionInExercice: number[] = []\n  let resultsByQuestion: boolean[] = []\n  let answers: string[] = []\n  let recordedTimeFromCapytale: number\n  onMount(async () => {\n    // handleCapytale peut changer la valeur du store pour que le\n    // professeur aille directement aux solutions de l'lve ou pour l'empcher de recommencer\n    canOptions.subscribe((value) => {\n      state = value.state\n      if (value.state !== 'solutions' && value.state !== 'canHomeScreen') return\n      if (answersFromCapytale.length === 0) {\n        return\n      }\n      for (const param of exercises) {\n        param.interactif = false\n      }\n\n      for (const exercice of answersFromCapytale) {\n        if (exercice.answers === undefined) {\n          answers.push('')\n          continue\n        }\n        const keys = Object.keys(exercice.answers)\n        if (keys.length > 1) {\n          const regex = /^Ex\\d+Q\\d+$/\n          const key = keys.find((k) => regex.test(k))\n          answers.push(key ? exercice.answers[key] : '')\n        } else if (keys.length === 1) {\n          const value = exercice.answers[keys[0]]\n          if (value?.includes('apiGeomVersion')) {\n            answers.push('Voir figure')\n            const event = new CustomEvent(keys[0], { detail: value })\n            document.dispatchEvent(event)\n          } else {\n            answers.push(value ? exercice.answers[keys[0]] : '')\n          }\n        } else {\n          answers.push('')\n        }\n      }\n      console.info('answers', answers)\n\n      if (assignmentDataFromCapytale?.resultsByQuestion !== undefined)\n        resultsByQuestion = assignmentDataFromCapytale.resultsByQuestion\n      if (assignmentDataFromCapytale?.duration !== undefined)\n        recordedTimeFromCapytale = assignmentDataFromCapytale.duration\n    })\n    context.isDiaporama = true\n    // force le mode interactif\n    globalOptions.update((gOpt) => {\n      gOpt.setInteractive = '1'\n      return gOpt\n    })\n    // reconstitution des exercices\n    exercises = await Promise.all(buildExercisesList())\n    // met  jour la url avec la graine...\n    mathaleaUpdateUrlFromExercicesParams(get(exercicesParams))\n    // interactivit\n    if ($canOptions.isInteractive) {\n      $keyboardState.isVisible = true\n      for (const param of exercises) {\n        param.interactif = true\n      }\n    }\n    // dcoupage des exerices en questions\n    const splitResults = splitExercisesIntoQuestions(exercises)\n    questions = [...splitResults.questions]\n    consignes = [...splitResults.consignes]\n    corrections = [...splitResults.corrections]\n    consignesCorrections = [...splitResults.consignesCorrections]\n    indiceExercice = [...splitResults.indiceExercice]\n    indiceQuestionInExercice = [...splitResults.indiceQuestionInExercice]\n    for (let i = 0; i < questions.length; i++) {\n      $canOptions.questionGetAnswer.push(false)\n    }\n  })\n\n  type answerType = {\n    type:\n      | 'mathlive'\n      | 'fillInTheBlank'\n      | 'dnd'\n      | 'qcm'\n      | 'listeDeroulante'\n      | 'custom'\n      | 'cliqueFigure'\n      | 'unknown'\n    index: number\n    answers?: { [key: string]: string }\n    answerTxt: string\n  }\n\n  function checkAnswers() {\n    statsCanTracker($globalOptions.recorder ?? '', $globalOptions.v ?? '')\n    const answersType: answerType[] = []\n    for (let i = 0; i < questions.length; i++) {\n      const exercice = exercises[indiceExercice[i]]\n      const type =\n        exercice.autoCorrection?.[indiceQuestionInExercice[i]]?.reponse?.param\n          ?.formatInteractif ?? exercice.interactifType\n      if (type === 'mathlive' || type === 'fillInTheBlank') {\n        resultsByQuestion[i] = Boolean(\n          verifQuestionMathLive(exercice, indiceQuestionInExercice[i])?.isOk,\n        )\n        // rcupration de la rponse\n        answersType[i] = {\n          type,\n          index: i,\n          answers: {\n            [`Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`]:\n              exercice.answers![\n                `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`\n              ],\n          },\n          answerTxt:\n            exercice.answers![\n              `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`\n            ],\n        }\n        answers[i] = answersType[i].answerTxt\n      } else if (type === 'dnd') {\n        resultsByQuestion[i] = verifDragAndDrop(\n          exercice,\n          indiceQuestionInExercice[i],\n        ).isOk\n        // rcupration de la rponse\n        answersType[i] = {\n          type,\n          index: i,\n          answers: Object.keys(exercice.answers ?? {})\n            .filter(\n              (key: string) =>\n                key.startsWith(\n                  `rectangleDNDEx${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n                ) ||\n                key.startsWith(\n                  `texteDNDEx${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n                ),\n            )\n            .reduce((result: { [key: string]: any }, k) => {\n              result[k] = exercice.answers![k]\n              return result\n            }, {}),\n          answerTxt: Object.keys(exercice.answers ?? {})\n            .filter((key: string) =>\n              key.startsWith(\n                `texteDNDEx${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n              ),\n            )\n            .reduce((result: string, k) => {\n              result = exercice.answers![k]\n              return result\n            }, ''),\n        }\n        answers[i] = answersType[i].answerTxt\n        answersType[i].answers![\n          `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`\n        ] = answersType[i].answerTxt\n      } else if (type === 'qcm') {\n        resultsByQuestion[i] =\n          verifQuestionQcm(exercice, indiceQuestionInExercice[i]) === 'OK'\n        // rcupration de la rponse\n        const propositions =\n          exercice.autoCorrection[indiceQuestionInExercice[i]].propositions\n        const qcmAnswers: string[] = []\n        propositions!.forEach((proposition, indice: number) => {\n          if (\n            exercice.answers![\n              `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}R${indice}`\n            ] === '1'\n          ) {\n            if (proposition.texte !== undefined) {\n              qcmAnswers.push(proposition.texte)\n            }\n          }\n        })\n        answers[i] = qcmAnswers.join(' ; ')\n        exercice.answers![\n          `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`\n        ] = answers[i]\n        answersType[i] = {\n          type,\n          index: i,\n          answers: Object.keys(exercice.answers ?? {})\n            .filter((key: string) =>\n              key.startsWith(\n                `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n              ),\n            )\n            .reduce((result: { [key: string]: any }, k) => {\n              result[k] = exercice.answers![k]\n              return result\n            }, {}),\n          answerTxt: answers[i],\n        }\n      } else if (type === 'listeDeroulante') {\n        resultsByQuestion[i] =\n          verifQuestionListeDeroulante(\n            exercice,\n            indiceQuestionInExercice[i],\n          ) === 'OK'\n        answers[i] =\n          exercice.answers?.[\n            `ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`\n          ] ??\n          exercice.answers?.[\n            `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`\n          ] ??\n          ''\n        answersType[i] = {\n          type,\n          index: i,\n          answers: Object.keys(exercice.answers ?? {})\n            .filter(\n              (key: string) =>\n                key.startsWith(\n                  `ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n                ) ||\n                key.startsWith(\n                  `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n                ),\n            )\n            .reduce((result: { [key: string]: any }, k) => {\n              result[k] = exercice.answers![k]\n              return result\n            }, {}),\n          answerTxt: answers[i],\n        }\n      } else if (type === 'cliqueFigure') {\n        resultsByQuestion[i] =\n          verifQuestionCliqueFigure(exercice, indiceQuestionInExercice[i]) ===\n          'OK'\n        answers[i] = indexQuestionCliqueFigure(\n          exercice,\n          indiceQuestionInExercice[i],\n        )\n        answersType[i] = {\n          type,\n          index: i,\n          answers: Object.keys(exercice.answers ?? {})\n            .filter((key: string) =>\n              key.endsWith(\n                `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n              ),\n            )\n            .reduce((result: { [key: string]: any }, k) => {\n              result[k] = exercice.answers![k]\n              return result\n            }, {}),\n          answerTxt: answers[i],\n        }\n      } else if (type === 'custom') {\n        // si le type est `custom` on est sr que `correctionInteractive` existe\n        // d'o le ! aprs `correctionInteractive`\n        if (exercice instanceof MetaExercice) {\n          const result = exercice.correctionInteractives[\n            indiceQuestionInExercice[i]\n          ](indiceQuestionInExercice[i])\n          Array.isArray(result)\n            ? (resultsByQuestion[i] = result.includes('OK'))\n            : (resultsByQuestion[i] = result === 'OK')\n        } else {\n          const result = exercice.correctionInteractive!(\n            indiceQuestionInExercice[i],\n          )\n          Array.isArray(result)\n            ? (resultsByQuestion[i] = result.includes('OK'))\n            : (resultsByQuestion[i] = result === 'OK')\n        }\n        answersType[i] = {\n          type,\n          index: i,\n          answers: Object.keys(exercice.answers ?? {})\n            .filter(\n              (key: string) =>\n                key.endsWith(\n                  `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n                ) ||\n                key.startsWith(\n                  `apigeomEx${indiceExercice[i]}F${indiceQuestionInExercice[i]}`,\n                ),\n            )\n            .reduce((result: { [key: string]: any }, k) => {\n              result[k] = exercice.answers![k]\n              return result\n            }, {}),\n          answerTxt: '',\n        }\n        answersType[i].answerTxt = Object.keys(answersType[i].answers ?? {})\n          .filter((key: string, index: number) => index === 0)\n          .reduce((result: string, k) => {\n            result = answersType[i].answers![k]\n            return result\n          }, '')\n        answers[i] = answersType[i].answerTxt.includes('apiGeomVersion')\n          ? 'Voir figure'\n          : answersType[i].answerTxt\n      } else {\n        answersType[i] = {\n          type: 'unknown',\n          index: i,\n          answers: Object.keys(exercice.answers ?? {})\n            .filter((key: string) =>\n              key.endsWith(\n                `Ex${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n              ),\n            )\n            .reduce((result: { [key: string]: any }, k) => {\n              result[k] = exercice.answers![k]\n              return result\n            }, {}),\n          answerTxt: '',\n        }\n      }\n      // Pour Capytale, on a besoin du score de l'exercice et non de la question\n      // donc on sauvegarde le score dans l'exercice\n      if (resultsByQuestion[i] && exercice.score !== undefined) {\n        exercice.score++\n      }\n    }\n\n    // Dsactiver l'interactivit avant l'affichage des solutions\n    for (const param of exercises) {\n      param.interactif = false\n    }\n    const resultsByExerciceArray: InterfaceResultExercice[] = []\n    for (let i = 0, ind = 0; i < exercises.length; i++) {\n      const exercise = exercises[i]\n      for (let q = 0; q < exercise.nbQuestions; q++) {\n        const quest: InterfaceResultExercice = {\n          uuid: exercise.uuid,\n          title: exercise.titre,\n          indice: exercise.numeroExercice as number,\n          state: 'done',\n          alea: exercise.seed,\n          answers: answersType[ind].answers,\n          numberOfPoints: resultsByQuestion[ind] ? 1 : 0,\n          numberOfQuestions: 1,\n          bestScore: resultsByQuestion[ind] ? 1 : 0,\n          resultsByQuestion: [resultsByQuestion[ind]],\n          duration: Math.floor(\n            $canOptions.durationInMinutes * 60 -\n              $canOptions.remainingTimeInSeconds,\n          ),\n        }\n        ind++\n        resultsByExerciceArray.push(quest)\n      }\n    }\n    resultsByExercice.update((l) => {\n      l = resultsByExerciceArray\n      return l\n    })\n    if ($globalOptions.recorder === 'moodle') {\n      const url = new URL(window.location.href)\n      const iframe = url.searchParams.get('iframe')\n      console.info({\n        resultsByExercice: $resultsByExercice,\n        duration: getDuration(),\n        action: 'mathalea:score',\n        iframe,\n      })\n      window.parent.postMessage(\n        {\n          resultsByExercice: $resultsByExercice,\n          duration: getDuration(),\n          action: 'mathalea:score',\n          iframe,\n        },\n        '*',\n      )\n    } else if ($globalOptions.recorder === 'capytale') {\n      if (\n        getRecordedScore() > getScoreTotal() ||\n        (getRecordedScore() === getScoreTotal() &&\n          assignmentDataFromCapytale?.duration &&\n          assignmentDataFromCapytale?.duration < getDuration())\n      ) {\n        return\n      }\n      sendToCapytaleSaveStudentAssignment({\n        indiceExercice: 'all',\n        assignmentData: {\n          duration: getDuration(),\n          resultsByQuestion,\n        },\n      })\n    }\n  }\n\n  function getDuration(): number {\n    return Math.floor(\n      $canOptions.durationInMinutes * 60 - $canOptions.remainingTimeInSeconds,\n    )\n  }\n\n  /**\n   * Construit la chane qui sera affiche pour le score\n   * nombre de points obtenu / nombre de questions\n   */\n  function buildStringScore(): string {\n    const score = getScoreTotal()\n    return score + '/' + resultsByQuestion.length\n  }\n\n  function getScoreTotal(): number {\n    let score = 0\n    for (const result of resultsByQuestion) {\n      if (result === true) {\n        score++\n      }\n    }\n    return score\n  }\n\n  function getRecordedScore(): number {\n    let score = 0\n    if (assignmentDataFromCapytale?.resultsByQuestion !== undefined) {\n      for (const result of assignmentDataFromCapytale.resultsByQuestion) {\n        if (result === true) {\n          score++\n        }\n      }\n    }\n    return score\n  }\n\n  /**\n   * Construit la chane MM:SS qui sera affiche pour le temps mis  faire la course\n   */\n  function buildTime(): string {\n    const nbOfSeconds =\n      recordedTimeFromCapytale ||\n      $canOptions.durationInMinutes * 60 - $canOptions.remainingTimeInSeconds\n    const time = millisecondToMinSec(nbOfSeconds * 1000)\n    return [\n      time.minutes.toString().padStart(2, '0'),\n      time.seconds.toString().padStart(2, '0'),\n    ].join(':')\n  }\n</script>\n\n<div\n  class=\"{$darkMode.isActive\n    ? 'dark'\n    : ''} relative w-full h-screen bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n>\n  {#if state === 'start' || state === 'canHomeScreen'}\n    <KickOff subTitle=\"{$canOptions.subTitle}\" bind:state />\n  {/if}\n  {#if state === 'countdown'}\n    <CountDown bind:state />\n  {/if}\n  {#if state === 'race'}\n    <Race\n      numberOfSeconds=\"{$canOptions.durationInMinutes * 60}\"\n      bind:state\n      {questions}\n      {consignes}\n      {checkAnswers}\n    />\n  {/if}\n  {#if state === 'end'}\n    <End bind:state score=\"{buildStringScore()}\" time=\"{buildTime()}\" />\n  {/if}\n  {#if state === 'solutions'}\n    <Solutions\n      {questions}\n      {consignes}\n      {corrections}\n      {consignesCorrections}\n      {answers}\n      {resultsByQuestion}\n      score=\"{buildStringScore()}\"\n      time=\"{buildTime()}\"\n    />\n  {/if}\n  <div class=\"fixed flex bottom-2 right-2\">\n    <label\n      class=\"swap swap-rotate text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n    >\n      <!-- this hidden checkbox controls the state -->\n      <input\n        id=\"hidden-checkbox-for-darkmode\"\n        type=\"checkbox\"\n        class=\"invisible\"\n        bind:checked=\"{$darkMode.isActive}\"\n      />\n      <!-- sun icon -->\n      <div class=\"swap-on\"><i class=\"bx bx-sm bx-sun\"></i></div>\n      <!-- moon icon -->\n      <div class=\"swap-off\"><i class=\"bx bx-sm bx-moon\"></i></div>\n    </label>\n  </div>\n</div>\n","let canvas: HTMLCanvasElement\n\nexport function remToPixels(rem: number) {\n  return rem * parseFloat(getComputedStyle(document.documentElement).fontSize)\n}\n\n/**\n * Uses canvas.measureText to compute and return the width of the given text of given font in pixels.\n *\n * @param {String} text The text to be rendered.\n * @param {String} font The css font descriptor that text is to be rendered with (e.g. \"bold 14px verdana\").\n *\n * @see https://stackoverflow.com/questions/118241/calculate-text-width-with-javascript/21015393#21015393\n */\nexport function getTextWidth(\n  text: string,\n  font: string,\n  factor: number = 1,\n): number {\n  // re-use canvas object for better performance\n  if (canvas == null) {\n    canvas = document.createElement('canvas')\n  }\n  const context: CanvasRenderingContext2D | null = canvas.getContext('2d')\n  if (!context) {\n    throw new Error('Canvas context is null')\n  }\n  context.font = font\n  const metrics: TextMetrics = context.measureText(text)\n  return metrics.width * factor\n}\nexport function getCssStyle(element: HTMLElement, prop: string) {\n  return window.getComputedStyle(element, null).getPropertyValue(prop)\n}\nexport function getCanvasFontDetails(el = document.body) {\n  const fontWeight = getCssStyle(el, 'font-weight') || 'normal'\n  const fontSize = getCssStyle(el, 'font-size') || '16px'\n  const fontFamily = getCssStyle(el, 'font-family') || 'Times New Roman'\n\n  return {\n    weigth: `${fontWeight}`,\n    size: `${fontSize}`,\n    family: `${fontFamily}`,\n  }\n}\nexport function getCanvasFont(el = document.body) {\n  const fontWeight = getCssStyle(el, 'font-weight') || 'normal'\n  const fontSize = getCssStyle(el, 'font-size') || '16px'\n  const fontFamily = getCssStyle(el, 'font-family') || 'Times New Roman'\n\n  return `${fontWeight} ${fontSize} ${fontFamily}`\n}\n/**\n * Dtecter le type de machine sur lequel le site est utilis\n * ([Source](https://attacomsian.com/blog/javascript-detect-mobile-device))\n * @return {('mobile'|'tablet'|'desktop')} nom du type de machine\n * @author sylvain\n */\nexport const deviceType = () => {\n  const ua = navigator.userAgent\n  if (/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(ua)) {\n    return 'tablet'\n  } else if (\n    /Mobile|Android|iP(hone|od)|IEMobile|BlackBerry|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(\n      ua,\n    )\n  ) {\n    return 'mobile'\n  }\n  return 'desktop'\n}\n","export function isLocalStorageAvailable() {\n  try {\n    window.localStorage.setItem('__test__', '__test__')\n    window.localStorage.removeItem('__test__')\n    return true\n  } catch (e) {\n    return false\n  }\n}\n","import type Exercice from '../../../exercices/Exercice'\n\nexport function countMathField(exercise: Exercice): number {\n  if (exercise == null) return 0\n  let numbOfAnswerFields: number = 0\n  if (exercise.interactif) {\n    if (!exercise.autoCorrection || !Array.isArray(exercise.autoCorrection)) {\n      return 0\n    }\n    for (const autoCorr of exercise.autoCorrection) {\n      if (\n        autoCorr != null &&\n        autoCorr.reponse != null &&\n        autoCorr.reponse.param != null &&\n        autoCorr.reponse.param.formatInteractif != null\n      ) {\n        if (\n          autoCorr.reponse?.param?.formatInteractif === 'mathlive' ||\n          autoCorr.reponse?.param?.formatInteractif === 'qcm'\n        ) {\n          numbOfAnswerFields++\n        }\n      }\n    }\n    if (\n      exercise.interactifType === 'custom' &&\n      'goodAnswers' in exercise &&\n      Array.isArray(exercise.goodAnswers)\n    ) {\n      for (const goodAnswer of exercise.goodAnswers) {\n        if (Array.isArray(goodAnswer)) {\n          numbOfAnswerFields += goodAnswer.length\n        } else {\n          numbOfAnswerFields++\n        }\n      }\n    }\n    return numbOfAnswerFields\n  }\n  return 0\n}\n","// Ajout le 15/07/2025 par JC-Lhote pour peermettre  des listeners de savoir que la correction est affiche\n\nimport { tick } from 'svelte'\n\n// Peut-tre est  dplacer dans un fichier de fonctions utilitaires ?\nexport function handleCorrectionAffichee() {\n  tick().then(() => {\n    if (document.querySelector('[id^=\"correction-exo\"]')) {\n      document.dispatchEvent(\n        new window.Event('correctionsAffichees', { bubbles: true }),\n      )\n      return\n    }\n    // Sinon, observe le DOM jusqu' ce que l'lment apparaisse\n    const observer = new MutationObserver(() => {\n      if (document.querySelector('[id^=\"correction-exo\"]')) {\n        document.dispatchEvent(\n          new window.Event('correctionsAffichees', { bubbles: true }),\n        )\n        observer.disconnect()\n      }\n    })\n    observer.observe(document.body, { childList: true, subtree: true })\n  })\n}\n","<script lang=\"ts\">\n  export let isMenuNeededForExercises: boolean\n  export let presMode: string\n  export let title: string\n  export let indiceExercice: number\n  export let showNumber = true\n</script>\n\n<!--\n  @component\n  Barre de titre et d'actions au-dessus d'un exercice\n\n  __Utilisation__ :\n\n  ```tsx\n  const headerExerciceProps = {\n    title: exercice.titre,\n    indiceExercice: 2\n  }\n  <HeaderExerciceVueEleve {...headerExerciceProps}/>\n  ```\n -->\n\n<div class=\"z-0 flex-1\">\n  <h1\n    id=\"headerExoVueEleve-{indiceExercice}\"\n    class=\" text-coopmaths-struct dark:text-coopmathsdark-struct pb-2 flex {isMenuNeededForExercises\n      ? 'flex-col items-start'\n      : 'flex-row items-center'}\"\n  >\n    <!-- titre -->\n    <div\n      class=\"flex flex-row justify-start items-start\"\n      id=\"exerciceHeader{indiceExercice}\"\n    >\n      <div class=\"{showNumber ? 'flex' : 'hidden'}\">\n        <div\n          class=\"{isMenuNeededForExercises && presMode !== 'liste_exos'\n            ? 'hidden'\n            : 'inline-flex'} items-center justify-center h-6 w-6 bg-coopmaths-struct text-coopmaths-canvas font-light text-lg lg:text-normal translate-y-1\"\n        >\n          {indiceExercice + 1}\n        </div>\n      </div>\n      <div\n        class=\"font-light {isMenuNeededForExercises && presMode !== 'liste_exos'\n          ? 'text-xl'\n          : 'text-lg'} ml-2\"\n      >\n        {title}\n      </div>\n    </div>\n  </h1>\n</div>\n","<script lang=\"ts\">\n  export let isOnStateActive: boolean = false\n  export let size: number = 5\n</script>\n\n<!--\n  @component\n  Icne avec deux tats\n\n   ### Paramtres :\n\n  * `isOnStateActive` : boolen pour basculer entre les deux icnes\n  * `size`: nombre pour rgler la taille de l'icne (`5` par dfault)\n\n  ### Exemple :\n\n  ```tsx\n  <InteractivityIcon isOnStateActive={<monBoolean>}>\n    <i slot=\"icon_to_switch_on\" class=\"bx bxs-phone\" />\n    <i slot=\"icon_to_switch_off\" class=\"bx bxs-phone-off\" />\n  </InteractivityIcon>\n  ```\n -->\n<div class=\"{isOnStateActive ? 'hidden' : 'block'}\">\n  <slot name=\"icon_to_switch_on\">\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 8.467 8.467\"\n      class=\"w-{size} h-{size} fill-coopmaths-action dark:fill-coopmathsdark-action stroke-coopmaths-action dark:stroke-coopmathsdark-action\"\n    >\n      <defs>\n        <marker\n          id=\"a\"\n          markerHeight=\"2\"\n          markerWidth=\"2\"\n          orient=\"auto-start-reverse\"\n          preserveAspectRatio=\"xMidYMid\"\n          refX=\"0\"\n          refY=\"0\"\n          style=\"overflow:visible\"\n          viewBox=\"0 0 5.324 6.155\"\n        >\n          <path\n            d=\"m5.77 0-8.65 5V-5Z\"\n            style=\"fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt\"\n            transform=\"scale(.5)\"\n          ></path>\n        </marker>\n        <marker\n          id=\"b\"\n          markerHeight=\"2\"\n          markerWidth=\"2\"\n          orient=\"auto-start-reverse\"\n          preserveAspectRatio=\"xMidYMid\"\n          refX=\"0\"\n          refY=\"0\"\n          style=\"overflow:visible\"\n          viewBox=\"0 0 5.324 6.155\"\n        >\n          <path\n            d=\"m5.77 0-8.65 5V-5Z\"\n            style=\"fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt\"\n            transform=\"scale(.5)\"\n          ></path>\n        </marker>\n      </defs>\n      <g transform=\"matrix(.87062 0 0 .87062 .723 1.111)\">\n        <path\n          d=\"M6.117 4.022a2.086 2.086 0 0 0-2.084 2.083c0 1.15.935 2.084 2.084 2.084A2.086 2.086 0 0 0 8.2 6.105a2.086 2.086 0 0 0-2.083-2.083zm0 3.75a1.669 1.669 0 0 1-1.52-2.35l.096.058c.082.052.164.104.268.143.103.04.226.065.391.065s.289-.026.392-.065c.103-.039.186-.09.268-.143.083-.052.165-.104.268-.143.103-.04.227-.065.392-.065s.289.026.392.065c.103.039.185.091.268.143.082.052.165.104.268.143.037.014.078.026.121.036.04.142.063.291.063.446 0 .92-.748 1.667-1.667 1.667z\"\n          style=\"stroke-width:.208363\"\n        ></path>\n        <circle cx=\"5.388\" cy=\"6.209\" r=\".313\" style=\"stroke-width:.208363\"\n        ></circle>\n        <circle cx=\"6.846\" cy=\"6.209\" r=\".313\" style=\"stroke-width:.208363\"\n        ></circle>\n      </g>\n      <path\n        d=\"M1.062.56h3.08a.474.474 0 0 1 .474.474v2.37a.474.474 0 0 1-.474.473h-3.08a.474.474 0 0 1-.474-.474v-2.37A.474.474 0 0 1 1.062.56Z\"\n        style=\"fill:none;stroke-width:.236966;stroke-linecap:round;stroke-linejoin:round\"\n      ></path>\n      <path\n        d=\"M.773.536.536.752v.432h4.029V.752L4.327.536Zm1.948.141h1.421a.118.118 0 0 1 .12.12.118.118 0 0 1-.12.12H2.721a.118.118 0 0 1-.12-.12.118.118 0 0 1 .12-.12ZM1.019.68a.118.118 0 0 1 .009 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.118.118.118.118 0 0 1-.119-.118.118.118 0 0 1 .11-.118Zm.313 0a.118.118 0 0 1 .009 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.118.118.118.118 0 0 1-.119-.118.118.118 0 0 1 .11-.118Zm.313 0a.118.118 0 0 1 .01 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.119.118.118.118 0 0 1-.118-.118.118.118 0 0 1 .11-.118z\"\n        style=\"stroke:none;stroke-width:.226291px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"\n      ></path>\n      <path\n        d=\"M7.062 3.945V1.536h-1.21\"\n        style=\"fill:none;stroke-width:.747516;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#a)\"\n      ></path><path\n        d=\"M1.589 4.668v2.41h1.208\"\n        style=\"fill:none;stroke-width:.747516;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#b)\"\n      ></path>\n    </svg>\n  </slot>\n</div>\n<div class=\" {isOnStateActive ? 'block' : 'hidden'}\">\n  <slot name=\"icon_to_switch_off\">\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 8.467 8.467\"\n      class=\" w-{size} h-{size} text-coopmaths-action dark:text-coopmathsdark-action fill-coopmaths-action dark:fill-coopmathsdark-action stroke-coopmaths-action dark:stroke-coopmathsdark-action\"\n    >\n      <defs>\n        <marker\n          id=\"a\"\n          markerHeight=\"2\"\n          markerWidth=\"2\"\n          orient=\"auto-start-reverse\"\n          preserveAspectRatio=\"xMidYMid\"\n          refX=\"0\"\n          refY=\"0\"\n          style=\"overflow:visible\"\n          viewBox=\"0 0 5.324 6.155\"\n        >\n          <path\n            d=\"m5.77 0-8.65 5V-5Z\"\n            style=\"fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt\"\n            transform=\"scale(.5)\"\n          ></path>\n        </marker>\n        <marker\n          id=\"b\"\n          markerHeight=\"2\"\n          markerWidth=\"2\"\n          orient=\"auto-start-reverse\"\n          preserveAspectRatio=\"xMidYMid\"\n          refX=\"0\"\n          refY=\"0\"\n          style=\"overflow:visible\"\n          viewBox=\"0 0 5.324 6.155\"\n        >\n          <path\n            d=\"m5.77 0-8.65 5V-5Z\"\n            style=\"fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt\"\n            transform=\"scale(.5)\"\n          ></path>\n        </marker>\n      </defs>\n      <g transform=\"matrix(.87062 0 0 .87062 .723 1.111)\">\n        <path\n          d=\"M6.117 4.022a2.086 2.086 0 0 0-2.084 2.083c0 1.15.935 2.084 2.084 2.084A2.086 2.086 0 0 0 8.2 6.105a2.086 2.086 0 0 0-2.083-2.083zm0 3.75a1.669 1.669 0 0 1-1.52-2.35l.096.058c.082.052.164.104.268.143.103.04.226.065.391.065s.289-.026.392-.065c.103-.039.186-.09.268-.143.083-.052.165-.104.268-.143.103-.04.227-.065.392-.065s.289.026.392.065c.103.039.185.091.268.143.082.052.165.104.268.143.037.014.078.026.121.036.04.142.063.291.063.446 0 .92-.748 1.667-1.667 1.667z\"\n          style=\"stroke-width:.208363\"\n        ></path>\n        <circle cx=\"5.388\" cy=\"6.209\" r=\".313\" style=\"stroke-width:.208363\"\n        ></circle>\n        <circle cx=\"6.846\" cy=\"6.209\" r=\".313\" style=\"stroke-width:.208363\"\n        ></circle>\n      </g>\n      <path\n        d=\"M1.062.56h3.08a.474.474 0 0 1 .474.474v2.37a.474.474 0 0 1-.474.473h-3.08a.474.474 0 0 1-.474-.474v-2.37A.474.474 0 0 1 1.062.56Z\"\n        style=\"fill:none;stroke-width:.236966;stroke-linecap:round;stroke-linejoin:round\"\n      ></path>\n      <path\n        d=\"M.773.536.536.752v.432h4.029V.752L4.327.536Zm1.948.141h1.421a.118.118 0 0 1 .12.12.118.118 0 0 1-.12.12H2.721a.118.118 0 0 1-.12-.12.118.118 0 0 1 .12-.12ZM1.019.68a.118.118 0 0 1 .009 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.118.118.118.118 0 0 1-.119-.118.118.118 0 0 1 .11-.118Zm.313 0a.118.118 0 0 1 .009 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.118.118.118.118 0 0 1-.119-.118.118.118 0 0 1 .11-.118Zm.313 0a.118.118 0 0 1 .01 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.119.118.118.118 0 0 1-.118-.118.118.118 0 0 1 .11-.118z\"\n        style=\"stroke:none;stroke-width:.226291px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"\n      ></path>\n      <path\n        d=\"M7.062 3.945V1.536h-1.21\"\n        style=\"fill:none;stroke-width:.747516;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#a)\"\n      ></path>\n      <path\n        d=\"M1.589 4.668v2.41h1.208\"\n        style=\"fill:none;stroke-width:.747516;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#b)\"\n      ></path>\n      <path\n        d=\"m.53.53 7.407 7.407\"\n        style=\"fill:none;stroke-width:.79375;stroke-linecap:round;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1\"\n      ></path>\n    </svg>\n  </slot>\n</div>\n","<script lang=\"ts\">\n  import type { InterfaceGlobalOptions } from '../../../../../../lib/types'\n  import type TypeExercice from '../../../../../../exercices/Exercice'\n  import ButtonTextAction from '../../../../forms/ButtonTextAction.svelte'\n  import InteractivityIcon from '../../../../icons/TwoStatesIcon.svelte'\n  export let exercise: TypeExercice\n  export let indiceLastExercice: number\n  export let globalOptions: InterfaceGlobalOptions\n  export let newData: () => void\n  export let isCorrectionVisible: boolean\n  export let switchCorrectionVisible: () => void\n  export let isInteractif: boolean\n  export let switchInteractif: () => void\n  export let columnsCount: number\n  export let columnsCountUpdate: (plusMinus: '+' | '-') => void\n</script>\n\n<div\n  class=\"flex flex-row justify-start items-center {indiceLastExercice > 1 &&\n  globalOptions.presMode !== 'un_exo_par_page'\n    ? 'ml-2 lg:ml-6'\n    : 'ml-2'} mb-2 lg:mb-6 {globalOptions.presMode === 'recto' ||\n  globalOptions.presMode === 'verso'\n    ? 'hidden'\n    : 'flex'}\"\n>\n  <div\n    class=\"{!globalOptions.oneShot && globalOptions.done !== '1'\n      ? 'flex'\n      : 'hidden'}\"\n  >\n    <ButtonTextAction\n      text=\"Nouvel nonc\"\n      icon=\"bx-refresh\"\n      class=\"py-[2px] px-2 text-[0.7rem]\"\n      inverted=\"{true}\"\n      on:click=\"{() => {\n        newData()\n      }}\"\n    />\n  </div>\n  <div\n    class=\"{globalOptions.isSolutionAccessible &&\n    !exercise.isDone &&\n    ((exercise.interactif && exercise.isDone) || !exercise.interactif)\n      ? 'flex ml-2'\n      : 'hidden'}\"\n  >\n    <ButtonTextAction\n      text=\"{isCorrectionVisible\n        ? 'Masquer la correction'\n        : 'Voir la correction'}\"\n      icon=\"{isCorrectionVisible ? 'bx-hide' : 'bx-show'}\"\n      class=\"py-[2px] px-2 text-[0.7rem] w-36\"\n      inverted=\"{true}\"\n      on:click=\"{switchCorrectionVisible}\"\n    />\n  </div>\n  <button\n    class=\"{globalOptions.isInteractiveFree && exercise?.interactifReady\n      ? 'w-5 ml-2 tooltip tooltip-right tooltip-neutral '\n      : 'hidden'}\"\n    data-tip=\"{isInteractif\n      ? \"Dsactiver l'interactivit\"\n      : 'Rendre interactif'}\"\n    type=\"button\"\n    on:click=\"{switchInteractif}\"\n  >\n    <InteractivityIcon isOnStateActive=\"{isInteractif}\" size=\"{4}\" />\n  </button>\n  {#if globalOptions.recorder === undefined}\n    <div\n      class=\"hidden md:flex flex-row justify-start items-center text-coopmaths-struct dark:text-coopmathsdark-struct text-xs\"\n    >\n      <button\n        class=\"{columnsCount > 1 && window.innerWidth > 1000\n          ? 'visible'\n          : 'invisible'}\"\n        type=\"button\"\n        on:click=\"{() => columnsCountUpdate('-')}\"\n      >\n        <i\n          class=\"text-coopmaths-action hover:text-coopmaths-action-darkest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-darkest bx ml-2 bx-xs bx-minus\"\n        ></i>\n      </button>\n      <i class=\"bx ml-1 bx-xs bx-columns\"></i>\n      <button type=\"button\" on:click=\"{() => columnsCountUpdate('+')}\">\n        <i\n          class=\"text-coopmaths-action hover:text-coopmaths-action-darkest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-darkest bx ml-1 bx-xs bx-plus\"\n        ></i>\n      </button>\n    </div>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import type TypeExercice from '../../../../../../exercices/Exercice'\n  import { mathaleaFormatExercice } from '../../../../../../lib/mathalea'\n\n  export let exercise: TypeExercice\n  export let exerciseIndex: number\n  export let questionIndex: number\n  export let isCorrectionVisible: boolean\n</script>\n\n<div\n  style=\"break-inside:avoid\"\n  id=\"consigne{exerciseIndex}-{questionIndex}\"\n  class=\"container max-w-full text-justify grid grid-cols-1 auto-cols-min gap-4 mb-3 lg:mb-4\"\n>\n  <li\n    id=\"exercice{exerciseIndex}Q{questionIndex}\"\n    style=\"line-height: {exercise.spacing || 1}\"\n  >\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    {@html mathaleaFormatExercice(exercise.listeQuestions[questionIndex])}\n  </li>\n  {#if isCorrectionVisible}\n    <div\n      class=\"relative self-start border-l-coopmaths-struct dark:border-l-coopmathsdark-struct border-l-[3px] text-coopmaths-corpus dark:text-coopmathsdark-corpus mt-6 mb-4 lg:mb-0 ml-0 lg:ml-0 py-2 pl-4 lg:pl-6\"\n      id=\"correction-exo{exerciseIndex}Q{questionIndex}\"\n    >\n      <div\n        class=\"{exercise.consigneCorrection.length !== 0\n          ? 'container max-w-full text-justify bg-coopmaths-canvas dark:bg-coopmathsdark-canvas-dark px-4 py-2 mr-2 ml-6 mb-2 font-light relative w-2/3'\n          : 'hidden'}\"\n      >\n        <div\n          class=\"{exercise.consigneCorrection.length !== 0\n            ? 'container max-w-full text-justify absolute top-4 -left-4'\n            : 'hidden'} \"\n        >\n          <i\n            class=\"bx bx-bulb scale-200 text-coopmaths-warn-dark dark:text-coopmathsdark-warn-dark\"\n          ></i>\n        </div>\n        <div class=\"\">\n          <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n          {@html exercise.consigneCorrection}\n        </div>\n      </div>\n      <div\n        class=\"container overflow-x-auto overflow-y-hidden md:overflow-x-auto py-1\"\n        style=\"line-height: {exercise.spacingCorr || 1}; break-inside:avoid\"\n      >\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html mathaleaFormatExercice(exercise.listeCorrections[questionIndex])}\n      </div>\n      <div\n        class=\"absolute flex flex-row py-[1.5px] px-3 rounded-t-md justify-center items-center -left-[3px] -top-[15px] bg-coopmaths-struct dark:bg-coopmathsdark-struct font-semibold text-xs text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n      >\n        Correction\n      </div>\n      <div\n        class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct bottom-0 left-0 border-b-[3px] w-4\"\n      ></div>\n    </div>\n  {/if}\n</div>\n\n<style>\n  li {\n    break-inside: avoid;\n  }\n</style>\n","<script lang=\"ts\">\n  import seedrandom from 'seedrandom'\n  import { afterUpdate, beforeUpdate, onDestroy, onMount, tick } from 'svelte'\n  import type TypeExercice from '../../../../../exercices/Exercice'\n  import { sendToCapytaleSaveStudentAssignment } from '../../../../../lib/handleCapytale'\n  import {\n    exerciceInteractif,\n    prepareExerciceCliqueFigure,\n  } from '../../../../../lib/interactif/gestionInteractif'\n  import {\n    mathaleaGenerateSeed,\n    mathaleaHandleExerciceSimple,\n    mathaleaRenderDiv,\n    mathaleaUpdateUrlFromExercicesParams,\n    mathaleaWriteStudentPreviousAnswers,\n  } from '../../../../../lib/mathalea'\n  import {\n    exercicesParams,\n    globalOptions,\n    isMenuNeededForExercises,\n    resultsByExercice,\n  } from '../../../../../lib/stores/generalStore'\n  import { isLocalStorageAvailable } from '../../../../../lib/stores/storage'\n  import type {\n    InterfaceParams,\n    InterfaceResultExercice,\n  } from '../../../../../lib/types'\n  import { loadMathLive } from '../../../../../modules/loaders'\n  import { statsTracker } from '../../../../../modules/statsUtils'\n  import { countMathField } from '../../countMathField'\n  import { handleCorrectionAffichee } from '../../handleCorrection'\n  import HeaderExerciceVueEleve from '../../presentationalComponents/shared/HeaderExerciceVueEleve.svelte'\n  import ExerciceVueEleveButtons from './presentationalComponents/ExerciceVueEleveButtons.svelte'\n  import Question from './presentationalComponents/Question.svelte'\n  export let exercise: TypeExercice\n  export let exerciseIndex: number\n  export let indiceLastExercice: number\n  export let isCorrectionVisible: boolean = false\n\n  let divExercice: HTMLDivElement\n  let divScore: HTMLDivElement\n  let buttonScore: HTMLButtonElement\n  let columnsCount = $exercicesParams[exerciseIndex].cols || 1\n  let isInteractif = exercise.interactif && exercise?.interactifReady\n  // une variable locale car si on modifie isCorrectionVisible, parfois elle devient undefined\n  let isCorrectVisible = isCorrectionVisible\n\n  let title: string\n  if ($globalOptions.isTitleDisplayed) {\n    title = exercise.id\n      ? `${exercise.id.replace('.js', '').replace('.ts', '')} - ${exercise.titre}`\n      : exercise.titre\n  } else {\n    title = exercise.id || ''\n  }\n  // Evnement indispensable pour pointCliquable par exemple\n  const exercicesAffiches = new window.Event('exercicesAffiches', {\n    bubbles: true,\n  })\n\n  let headerExerciceProps: { title: string } = { title }\n\n  $: {\n    if (isInteractif && buttonScore) initButtonScore()\n    if (!isInteractif && divScore) divScore.innerHTML = ''\n    headerExerciceProps = headerExerciceProps\n  }\n\n  let numberOfAnswerFields: number = 0\n\n  async function forceUpdate() {\n    if (exercise == null) return\n    exercise.numeroExercice = exerciseIndex\n    await adjustMathalea2dFiguresWidth()\n  }\n\n  function updateAnswers() {\n    if ($globalOptions.done === '1' && $globalOptions.recorder !== 'capytale') {\n      const q1 = document.querySelector<HTMLElement>(\n        '#exercice' + exercise.numeroExercice + 'Q0',\n      )\n      if (q1?.innerText === 'chargement...') return // en attente du chargement de l'exercice\n      const fields = document.querySelectorAll('math-field')\n      fields.forEach((field) => {\n        field.setAttribute('disabled', 'true')\n      })\n      const url = new URL(window.location.href)\n      // Pour Moodle, les rponses sont dans l'URL\n      const answers = url.searchParams.get('answers')\n      const objAnswers = answers ? JSON.parse(answers) : undefined\n      if (\n        JSON.stringify($globalOptions.answers) === JSON.stringify(objAnswers)\n      ) {\n        $globalOptions.answers = objAnswers\n      }\n      mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n      Promise.all(mathaleaWriteStudentPreviousAnswers(objAnswers)).then(() => {\n        // une fois que les rponses sont charges et on en est sr, on clique...\n        if (buttonScore) {\n          exercise.isDone = true\n          buttonScore.click()\n        }\n      })\n    }\n  }\n\n  onDestroy(() => {\n    log('ondestroy' + exercise.id)\n    // Dtruit l'objet exercice pour librer la mmoire\n    exercise.reinit() // MGu ncessaire pour supprimer les listeners\n  })\n\n  onMount(async () => {\n    log('onMount')\n    document.addEventListener('newDataForAll', newData)\n    document.addEventListener('setAllInteractif', setAllInteractif)\n    document.addEventListener('removeAllInteractif', removeAllInteractif)\n    document.addEventListener('updateAsyncEx', forceUpdate)\n    updateDisplay()\n    if ($globalOptions.setInteractive === '1') {\n      setAllInteractif()\n    } else if ($globalOptions.setInteractive === '0') {\n      removeAllInteractif()\n    }\n  })\n\n  beforeUpdate(async () => {\n    log('beforeUpdate:' + exercise.id)\n    numberOfAnswerFields = countMathField(exercise)\n    log('isCorrectVisible:' + isCorrectVisible)\n  })\n\n  afterUpdate(async () => {\n    log('afterUpdate')\n    // console.trace()\n    // const starttime = window.performance.now()\n    if (exercise) {\n      await tick()\n      // let time = window.performance.now()\n      // log('duration tick:'+ (time - starttime))\n      updateAnswers()\n      // time = window.performance.now()\n      // log('duration updateAnswers:'+ (time - starttime))\n      mathaleaRenderDiv(divExercice)\n      // time = window.performance.now()\n      // log('duration mathaleaRenderDiv:'+ (time - starttime))\n      adjustMathalea2dFiguresWidth()\n      // time = window.performance.now()\n      // log('duration adjustMathalea2dFiguresWidth:'+ (time - starttime))\n      if (exercise.interactif) {\n        log('loadMathLive')\n        loadMathLive(divExercice)\n        log('end loadMathLive')\n        // time = window.performance.now()\n        // log('duration loadMathLive:'+ (time - starttime))\n        if (exercise.interactifType === 'cliqueFigure' && !isCorrectVisible) {\n          prepareExerciceCliqueFigure(exercise)\n        }\n\n        // Ne pas tre not sur un exercice dont on a dj vu la correction\n        try {\n          if (\n            isLocalStorageAvailable() &&\n            exercise.id !== undefined &&\n            exercise.seed !== undefined &&\n            window.localStorage.getItem(`${exercise.id}|${exercise.seed}`) !=\n              null\n          ) {\n            newData()\n          }\n        } catch (e) {\n          console.error(e)\n        }\n        // time = window.performance.now()\n        // log('duration interactif:'+ (time - starttime))\n      }\n    }\n    // affectation du zoom pour les figures scratch\n    const scratchDivs = divExercice.getElementsByClassName('scratchblocks')\n    for (const scratchDiv of scratchDivs) {\n      const svgDivs = scratchDiv.getElementsByTagName('svg')\n      for (const svg of svgDivs) {\n        if (svg.hasAttribute('data-width') === false) {\n          const originalWidth = svg.getAttribute('width')\n          svg.dataset.width = originalWidth ?? ''\n        }\n        if (svg.hasAttribute('data-height') === false) {\n          const originalHeight = svg.getAttribute('height')\n          svg.dataset.height = originalHeight ?? ''\n        }\n        const w =\n          Number(svg.getAttribute('data-width')) * Number($globalOptions.z)\n        const h =\n          Number(svg.getAttribute('data-height')) * Number($globalOptions.z)\n        svg.setAttribute('width', w.toString())\n        svg.setAttribute('height', h.toString())\n      }\n    }\n    document.dispatchEvent(exercicesAffiches)\n    if (isCorrectVisible) {\n      handleCorrectionAffichee()\n    }\n  })\n\n  async function newData() {\n    exercise.isDone = false\n    if (isCorrectVisible) switchCorrectionVisible(false)\n    const seed = mathaleaGenerateSeed()\n    exercise.seed = seed\n    if (buttonScore) initButtonScore()\n    if (buttonScore?.dataset?.capytaleLoadAnswers === '1') {\n      // si les donnes ont t charges par Capytale, on remet  0\n      buttonScore.dataset.capytaleLoadAnswers = '0'\n    }\n    if (divScore) divScore.innerHTML = ''\n    updateDisplay()\n  }\n\n  async function setAllInteractif() {\n    if (exercise?.interactifReady && !isInteractif) {\n      isInteractif = true\n      updateDisplay()\n    }\n  }\n  async function removeAllInteractif() {\n    if (exercise?.interactifReady && isInteractif) {\n      isInteractif = false\n      updateDisplay()\n    }\n  }\n\n  const debug = false\n  function log(str: string) {\n    if (debug) {\n      console.info(str)\n    }\n  }\n\n  async function updateDisplay() {\n    log('updateDisplay')\n    if (exercise.typeExercice === 'simple') {\n      if (exercise.seed === undefined) exercise.seed = mathaleaGenerateSeed()\n      seedrandom(exercise.seed, { global: true })\n      mathaleaHandleExerciceSimple(exercise, !!isInteractif, exerciseIndex)\n    }\n    exercise.interactif = isInteractif\n    if ($exercicesParams[exerciseIndex] != null) {\n      // Des erreurs bugsnag font tat de cet objet undefined. JC le 3/12/2024\n      // MGU ne sette que si ncessaire, car ici c'est un storer\n      if ($exercicesParams[exerciseIndex].alea !== exercise.seed)\n        $exercicesParams[exerciseIndex].alea = exercise.seed\n      if (isInteractif && $exercicesParams[exerciseIndex].interactif !== '1')\n        $exercicesParams[exerciseIndex].interactif = '1'\n      if (!isInteractif && $exercicesParams[exerciseIndex].interactif !== '0')\n        $exercicesParams[exerciseIndex].interactif = '0'\n      if (\n        columnsCount > 1 &&\n        columnsCount !== $exercicesParams[exerciseIndex].cols\n      )\n        $exercicesParams[exerciseIndex].cols = columnsCount\n      if (\n        columnsCount <= 1 &&\n        $exercicesParams[exerciseIndex].hasOwnProperty('cols') &&\n        $exercicesParams[exerciseIndex].cols !== undefined\n      )\n        $exercicesParams[exerciseIndex].cols = undefined\n    }\n    exercise.numeroExercice = exerciseIndex\n    if (\n      exercise !== undefined &&\n      exercise.typeExercice !== 'simple' &&\n      typeof exercise.nouvelleVersionWrapper === 'function'\n    ) {\n      if (exercise.seed === undefined) exercise.seed = mathaleaGenerateSeed()\n      seedrandom(exercise.seed, { global: true })\n      exercise.nouvelleVersionWrapper(exerciseIndex)\n    }\n    mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n    await adjustMathalea2dFiguresWidth()\n  }\n\n  function verifExerciceVueEleve() {\n    log('verifExerciceVueEleve')\n    if (exercise.numeroExercice != null && !(exercise.isDone === true))\n      statsTracker(\n        exercise,\n        $globalOptions.recorder ?? '',\n        $globalOptions.v ?? '',\n      )\n    exercise.isDone = true\n    if ($globalOptions.isSolutionAccessible) isCorrectVisible = true\n    if (exercise.numeroExercice != null) {\n      const previousBestScore =\n        $exercicesParams[exercise.numeroExercice]?.bestScore ?? 0\n      const { numberOfPoints, numberOfQuestions } = exerciceInteractif(\n        exercise,\n        divScore,\n        buttonScore,\n      )\n      const isThisTryBetter = numberOfPoints >= previousBestScore\n      if (\n        buttonScore.dataset.capytaleLoadAnswers === '1' &&\n        previousBestScore !== numberOfPoints\n      ) {\n        // ICI les rponses ont t charges par Capytale et\n        //  le score ne peut pas tre inferieur  best score,\n        //  car c'est de la restitution de la meilleure copie\n        // donc si on est ici dans ce IF, c'est un bug du moteur  faire vite remonter\n        window.notify(\n          `Le score de l'exercice ${exercise.numeroExercice} est incorrect, pass de ${previousBestScore}  ${numberOfPoints}. Merci de le signaler au support.`,\n          {\n            exo: exercise,\n            globalOptions: $globalOptions,\n            exercicesParams: $exercicesParams,\n            resultsByExercice: $resultsByExercice,\n          },\n        )\n      }\n\n      let bestScore = previousBestScore\n      // On ne met  jour resultsByExercice que si le score est meilleur\n      if (isThisTryBetter) {\n        bestScore = numberOfPoints\n        exercicesParams.update((l: InterfaceParams[]) => {\n          l[exercise.numeroExercice as number].bestScore = bestScore\n          return l\n        })\n        resultsByExercice.update((l: InterfaceResultExercice[]) => {\n          l[exercise.numeroExercice as number] = {\n            uuid: exercise.uuid,\n            title: exercise.titre,\n            indice: exercise.numeroExercice as number,\n            state: 'done',\n            alea: exercise.seed,\n            answers: exercise.answers,\n            numberOfPoints,\n            numberOfQuestions,\n            bestScore,\n          }\n          return l\n        })\n      }\n\n      if ($globalOptions.recorder === 'moodle') {\n        const url = new URL(window.location.href)\n        const iframe = url.searchParams.get('iframe')\n        console.info({\n          resultsByExercice: $resultsByExercice,\n          action: 'mathalea:score',\n          iframe,\n        })\n        window.parent.postMessage(\n          {\n            resultsByExercice: $resultsByExercice,\n            action: 'mathalea:score',\n            iframe,\n          },\n          '*',\n        )\n      } else if ($globalOptions.recorder === 'capytale') {\n        if (buttonScore.dataset.capytaleLoadAnswers === '1') {\n          console.info(\n            'Les rponses ont t charges par Capytale donc on ne les renvoie pas  nouveau',\n          )\n          return\n        }\n        if (isThisTryBetter) {\n          sendToCapytaleSaveStudentAssignment({\n            indiceExercice: exerciseIndex,\n          })\n        }\n      }\n    }\n  }\n\n  function initButtonScore() {\n    buttonScore.classList.remove(...buttonScore.classList)\n    buttonScore.id = `buttonScoreEx${exerciseIndex}`\n    buttonScore.classList.add(\n      'inline-block',\n      'px-6',\n      'py-2.5',\n      'mr-10',\n      'my-5',\n      'ml-6',\n      'bg-coopmaths-action',\n      'dark:bg-coopmathsdark-action',\n      'text-coopmaths-canvas',\n      'dark:text-coopmathsdark-canvas',\n      'font-medium',\n      'text-xs',\n      'leading-tight',\n      'uppercase',\n      'rounded',\n      'shadow-md',\n      'transform',\n      'hover:bg-coopmaths-action-lightest',\n      'dark:hover:bg-coopmathsdark-action-lightest',\n      'hover:shadow-lg',\n      'focus:bg-coopmaths-action-lightest',\n      'dark:focus:bg-coopmathsdark-action-lightest',\n      'focus:shadow-lg',\n      'focus:outline-none',\n      'focus:ring-0',\n      'active:bg-coopmaths-action-lightest',\n      'dark:active:bg-coopmathsdark-action-lightest',\n      'active:shadow-lg',\n      'transition',\n      'duration-150',\n      'ease-in-out',\n      'checkReponses',\n    )\n  }\n\n  /**\n   * Recherche toutes les figures ayant la classe `mathalea2d` et rduit leur largeur  95% de la valeur\n   * maximale du div reper par l'ID `consigne<X>-0` o `X` est l'indice de l'exercice\n   * @param {boolean} initialDimensionsAreNeeded si `true`, les valeurs initiales sont recharges ()`false` par dfaut)\n   * @author sylvain\n   */\n  async function adjustMathalea2dFiguresWidth(\n    initialDimensionsAreNeeded: boolean = false,\n  ) {\n    const mathalea2dFigures =\n      document.querySelectorAll<SVGElement>('.mathalea2d')\n    const zoom = Number($globalOptions.z ?? 1)\n    // console.log('zoom:' + zoom )\n    if (mathalea2dFigures != null) {\n      if (mathalea2dFigures.length !== 0) {\n        // await tick()\n        // console.log('adjustMathalea2dFiguresWidth:' + initialDimensionsAreNeeded )\n        for (let k = 0; k < mathalea2dFigures.length; k++) {\n          if (initialDimensionsAreNeeded) {\n            // rinitialisation\n            const initialWidth = mathalea2dFigures[k].getAttribute(\n              'data-width-initiale',\n            )\n            const initialHeight = mathalea2dFigures[k].getAttribute(\n              'data-height-initiale',\n            )\n            mathalea2dFigures[k].setAttribute(\n              'width',\n              (Number(initialWidth) * zoom).toString(),\n            )\n            mathalea2dFigures[k].setAttribute(\n              'height',\n              (Number(initialHeight) * zoom).toString(),\n            )\n            // les lments Katex des figures SVG\n            if (\n              mathalea2dFigures[k] != null &&\n              mathalea2dFigures[k].parentElement != null\n            ) {\n              const eltsInFigures =\n                mathalea2dFigures[\n                  k\n                ].parentElement?.querySelectorAll<HTMLElement>(\n                  'div.divLatex',\n                ) || []\n              for (const elt of eltsInFigures) {\n                const e = elt\n                e.style.setProperty(\n                  'top',\n                  (Number(e.dataset.top) * zoom).toString() + 'px',\n                )\n                e.style.setProperty(\n                  'left',\n                  (Number(e.dataset.left) * zoom).toString() + 'px',\n                )\n              }\n            }\n          }\n          /* Mickael:\n          Ne surtout pas mettre la rfrence de l'exercice dans la requte suivante,\n          car dans svelte, la rfrence est lie au dernier exercice charg, ce qui bug!\n          */\n          const consigneDiv = mathalea2dFigures[k]\n            .closest('article')\n            ?.querySelector('[id^=\"consigne\"]')\n          // const consigneDiv = document.getElementById('consigne' + exnumero + '-0')\n          if (\n            consigneDiv &&\n            mathalea2dFigures[k].clientWidth > consigneDiv.clientWidth\n          ) {\n            const coef =\n              (consigneDiv.clientWidth * 0.95) /\n              mathalea2dFigures[k].clientWidth\n            // console.log('coef:' + coef )\n            const width = mathalea2dFigures[k].getAttribute('width')\n            const height = mathalea2dFigures[k].getAttribute('height')\n            if (!mathalea2dFigures[k].dataset.widthInitiale && width != null)\n              mathalea2dFigures[k].dataset.widthInitiale = width\n            if (!mathalea2dFigures[k].dataset.heightInitiale && height != null)\n              mathalea2dFigures[k].dataset.heightInitiale = height\n            const newHeight = (\n              Number(mathalea2dFigures[k].dataset.heightInitiale) *\n              zoom *\n              coef\n            ).toString()\n            const newWidth = (\n              Number(mathalea2dFigures[k].dataset.widthInitiale) *\n              zoom *\n              coef\n            ).toString()\n            if (width !== newWidth) {\n              mathalea2dFigures[k].setAttribute('width', newWidth)\n            }\n            if (height !== newHeight) {\n              mathalea2dFigures[k].setAttribute('height', newHeight)\n            }\n\n            if (\n              mathalea2dFigures[k] != null &&\n              mathalea2dFigures[k].parentElement !== null\n            ) {\n              const eltsInFigures =\n                mathalea2dFigures[\n                  k\n                ].parentElement?.querySelectorAll<HTMLElement>(\n                  'div.divLatex',\n                ) || []\n              for (const elt of eltsInFigures) {\n                const e = elt\n                const initialTop = Number(e.dataset.top) ?? 0\n                const initialLeft = Number(e.dataset.left) ?? 0\n                e.style.setProperty(\n                  'top',\n                  (initialTop * coef * zoom).toString() + 'px',\n                )\n                e.style.setProperty(\n                  'left',\n                  (initialLeft * coef * zoom).toString() + 'px',\n                )\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  // pour recalculer les tailles lors d'un changement de dimension de la fentre\n  window.onresize = () => {\n    adjustMathalea2dFiguresWidth(true)\n  }\n\n  function switchCorrectionVisible(newdata: boolean = true) {\n    isCorrectVisible = !isCorrectVisible\n    if (\n      isCorrectVisible &&\n      isLocalStorageAvailable() &&\n      exercise.id !== undefined\n    ) {\n      window.localStorage.setItem(`${exercise.id}|${exercise.seed}`, 'true')\n    }\n    if (\n      newdata &&\n      !$globalOptions.oneShot &&\n      exercise.interactif &&\n      !isCorrectVisible &&\n      !exercise.isDone\n    ) {\n      newData()\n    }\n    if (newdata) adjustMathalea2dFiguresWidth()\n  }\n\n  function switchInteractif() {\n    if (isCorrectVisible) switchCorrectionVisible()\n    isInteractif = !isInteractif\n    exercise.interactif = isInteractif\n    $exercicesParams[exerciseIndex].interactif = isInteractif ? '1' : '0'\n    updateDisplay()\n  }\n\n  function columnsCountUpdate(plusMinus: '+' | '-') {\n    if (plusMinus === '+') columnsCount++\n    if (plusMinus === '-') columnsCount--\n    updateDisplay()\n  }\n</script>\n\n<div class=\"z-0 flex-1 w-full mb-10 lg:mb-20\" bind:this=\"{divExercice}\">\n  {#if $globalOptions.presMode !== 'recto' && $globalOptions.presMode !== 'verso'}\n    <HeaderExerciceVueEleve\n      {...headerExerciceProps}\n      indiceExercice=\"{exerciseIndex}\"\n      showNumber=\"{indiceLastExercice > 0 &&\n        $globalOptions.presMode !== 'un_exo_par_page'}\"\n      isMenuNeededForExercises=\"{$isMenuNeededForExercises}\"\n      presMode=\"{$globalOptions.presMode}\"\n    />\n  {/if}\n\n  <div class=\"flex flex-col-reverse lg:flex-row\">\n    <div\n      class=\"flex flex-col justify-start items-start\"\n      id=\"exercice{exerciseIndex}\"\n    >\n      <ExerciceVueEleveButtons\n        globalOptions=\"{$globalOptions}\"\n        {indiceLastExercice}\n        {exercise}\n        isCorrectionVisible=\"{isCorrectVisible}\"\n        {newData}\n        {switchCorrectionVisible}\n        {isInteractif}\n        {switchInteractif}\n        {columnsCount}\n        {columnsCountUpdate}\n      />\n      <article\n        class=\" {$isMenuNeededForExercises\n          ? 'text-2xl'\n          : 'text-base'} relative w-full\"\n        style=\"font-size: {(\n          $globalOptions.z || 1\n        ).toString()}rem;  line-height: calc({$globalOptions.z || 1});\"\n      >\n        <div class=\"flex flex-col w-full mt-2 lg:mt-0 mb-2\">\n          {#if typeof exercise.consigne !== 'undefined' && exercise.consigne.length !== 0}\n            <div>\n              <p\n                class=\"mt-2 mb-2 ml-2 lg:mx-6 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n              >\n                <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                {@html exercise.consigne}\n              </p>\n            </div>\n          {/if}\n          {#if exercise.introduction}\n            <div>\n              <p\n                class=\"mt-2 mb-2 ml-2 lg:mx-6 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n              >\n                <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                {@html exercise.introduction}\n              </p>\n            </div>\n          {/if}\n        </div>\n        <div\n          style=\"columns: {window.innerWidth > 1000\n            ? columnsCount.toString()\n            : '1'}\"\n        >\n          <ul\n            class=\"{exercise.listeQuestions.length === 1 ||\n            !exercise.listeAvecNumerotation\n              ? 'list-none'\n              : 'list-decimal'} list-inside mx-2 lg:mx-6 marker:text-coopmaths-struct dark:marker:text-coopmathsdark-struct marker:font-bold\"\n          >\n            <!-- eslint-disable-next-line @typescript-eslint/no-unused-vars -->\n            {#each exercise.listeQuestions as question, questionIndex (questionIndex + '_' + (exercise.seed || ''))}\n              <Question\n                {exercise}\n                {questionIndex}\n                {exerciseIndex}\n                isCorrectionVisible=\"{isCorrectVisible}\"\n              />\n            {/each}\n            <div bind:this=\"{divScore}\" id=\"divScoreEx{exerciseIndex}\"></div>\n          </ul>\n        </div>\n      </article>\n      {#if isInteractif && !isCorrectVisible}\n        <button\n          type=\"submit\"\n          on:click=\"{verifExerciceVueEleve}\"\n          bind:this=\"{buttonScore}\"\n          >Vrifier {numberOfAnswerFields > 1\n            ? 'les rponses'\n            : 'la rponse'}</button\n        >\n      {/if}\n    </div>\n  </div>\n</div>\n","import type { InterfaceParams } from '../types'\n\n/**\n * Compte le nombre d'apparitions de chaque UUIDs dans un tableau d'exercices (`InterfaceParams`)\n * @param {InterfaceParams[]} exosParams Un tableau des exercices\n * @returns Objet contenant toutes les UUIDs avec le nombres d'apparition\n */\nexport function uuidCount(\n  exosParams: InterfaceParams[],\n): Record<string, number> {\n  const counts: Record<string, number> = {}\n  for (const ex of exosParams) {\n    counts[ex.uuid] = counts[ex.uuid] ? counts[ex.uuid] + 1 : 1\n  }\n  return counts\n}\n\nexport function exercisesUuidRanking(exosParams: InterfaceParams[]): number[] {\n  const codesList: string[] = exosParams.map((p) => p.uuid)\n  const ranks: number[] = []\n  for (const [i, ex] of exosParams.entries()) {\n    const rank: number = codesList.slice(0, i + 1).filter((c) => {\n      return c === ex.uuid\n    }).length\n    ranks.push(rank)\n  }\n  return ranks\n}\n","<script lang=\"ts\">\n  import {\n    exercicesParams,\n    moveExercice,\n  } from '../../../../../lib/stores/generalStore'\n  export let indice: number\n  function monter() {\n    exercicesParams.update((l) => {\n      return moveExercice(l, indice, indice - 1)\n    })\n  }\n</script>\n\n<button on:click=\"{monter}\" class=\"{indice === 0 ? 'hidden md:invisible' : ''}\">\n  <i\n    class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-up-arrow-circle\"\n  ></i>\n</button>\n","<script lang=\"ts\">\n  import {\n    exercicesParams,\n    moveExercice,\n  } from '../../../../../lib/stores/generalStore'\n  export let indice: number\n  export let indiceLastExercice: number\n  function descendre() {\n    exercicesParams.update((l) => {\n      return moveExercice(l, indice, indice + 1)\n    })\n  }\n</script>\n\n<button\n  on:click=\"{descendre}\"\n  class=\"{indice === indiceLastExercice ? 'hidden md:invisible' : ''}\"\n>\n  <i\n    class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-down-arrow-circle\"\n  ></i>\n</button>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import BoutonMonter from './BoutonMonter.svelte'\n  import BoutonDescendre from './BoutonDescendre.svelte'\n  import {\n    globalOptions,\n    exercicesParams,\n  } from '../../../../../lib/stores/generalStore'\n  import InteractivityIcon from '../../../icons/TwoStatesIcon.svelte'\n  import uuidsRessources from '../../../../../json/uuidsRessources.json'\n  import refProfs from '../../../../../json/referentielProfs.json'\n  import { toMap } from '../../../../../lib/components/toMap'\n  import { mathaleaGenerateSeed } from '../../../../../lib/mathalea'\n\n  // paramtres obligatoires\n  export let title: string | undefined\n  export let id: string\n  export let indiceExercice: number\n  export let indiceLastExercice: number\n  export let interactifReady: boolean\n  // paramtres optionnels\n  export let randomReady = true\n  export let settingsReady = true\n  export let correctionReady = true\n  export let correctionExists = true\n  export let isInteractif: boolean = false\n  export let isSortable: boolean = true\n  export let isDeletable: boolean = true\n  export let isHidable: boolean = true\n  let isVisible = true\n  export let isSettingsVisible = true\n  const isContentVisible = true\n  let isCorrectionVisible = false\n  // redfinition du titre lorsqu'un exercice apparait plusieurs fois :\n  // si le titre contient le caractre | (ajout lors de la cration de l'exercice)\n  // on coupe le titre en deux et on distingue le titre de base de l'addendum\n  // afin de pouvoir dcorer cet addendum\n  let titleAddendum: string\n  let titleBase: string\n  $: {\n    if (title?.includes('|')) {\n      const decompo = title.split('|')\n      titleBase = decompo[0]\n      titleAddendum = decompo[1]\n    } else {\n      titleBase = title || ''\n      titleAddendum = ''\n    }\n  }\n  // ttablissement de la catgorie\n  const ressourcesUuids = Object.keys({ ...uuidsRessources })\n  const profsUuids = Array.from(toMap({ ...refProfs }).values()).map((e) =>\n    e.get('uuid'),\n  )\n  let category: string\n  if (ressourcesUuids.includes($exercicesParams[indiceExercice]?.uuid)) {\n    category = 'Ressource'\n  } else if (profsUuids.includes($exercicesParams[indiceExercice]?.uuid)) {\n    category = 'Outil'\n  } else {\n    category = 'Exercice'\n  }\n  const dispatch = createEventDispatcher()\n\n  function switchInteractif() {\n    isInteractif = !isInteractif\n    dispatch('clickInteractif', { isInteractif })\n  }\n\n  function newData() {\n    dispatch('clickNewData')\n  }\n\n  function remove() {\n    exercicesParams.update((l) => [\n      ...l.slice(0, indiceExercice),\n      ...l.slice(indiceExercice + 1),\n    ])\n    dispatch('exerciseRemoved')\n  }\n\n  function duplicate() {\n    exercicesParams.update((l) => {\n      const newExercice = { ...l[indiceExercice] }\n      newExercice.alea = mathaleaGenerateSeed()\n      return [\n        ...l.slice(0, indiceExercice + 1),\n        newExercice,\n        ...l.slice(indiceExercice + 1),\n      ]\n    })\n  }\n</script>\n\n<!--\n  @component\n  Barre de titre et d'actions au-dessus d'un exercice\n\n  __Utilisation__ :\n\n  ```tsx\n  const headerExerciceProps: HeaderProps = {\n    title: exercice.titre,\n    indiceExercice: 2,\n    indiceLastExercice: 4,\n    interactifReady: true,\n    randomReady: true,\n    settingsReady: true,\n    correctionReady: true\n  }\n  <HeaderExerciceVueProf {...headerExerciceProps}/>\n  ```\n -->\n\n<div class=\"z-0 flex-1\">\n  <h1\n    class=\"border-b border-coopmaths-struct dark:border-coopmathsdark-struct text-coopmaths-struct dark:text-coopmathsdark-struct pl-0 mt-4 flex flex-col lg:flex-row justify-start lg:justify-between items-start xl:items-baseline\"\n  >\n    <div\n      class=\"flex flex-col xl:flex-row xl:justify-start xl:items-center\"\n      id=\"exercice{indiceExercice}\"\n    >\n      <div\n        class=\"flex flex-row items-center whitespace-pre font-bold text-sm md:text-base lg:text-xl pb-1 lg:pb-0\"\n      >\n        <div\n          class=\"{$exercicesParams.length <= 1\n            ? 'hidden'\n            : 'flex'} items-center justify-center h-4 lg:h-8 w-4 lg:w-6 bg-coopmaths-struct dark:bg-coopmathsdark-struct text-coopmaths-canvas dark:text-coopmathsdark-canvas font-light text-xs lg:text-lg mr-2 lg:mr-4\"\n        >\n          {indiceExercice + 1}\n        </div>\n        {category}&#8239\n        {#if id && id.length !== 0}\n          {id}<span class=\"hidden xl:inline-flex xl:mx-1 font-bold\"\n            >&middot;</span\n          >\n        {/if}\n      </div>\n      {#key titleAddendum}\n        <div\n          id=\"exotitle-{indiceExercice}\"\n          class=\"flex flex-row justify-start whitespace-pre-wrap text-start font-normal items-center text-sm md:text-base xl:text-lg pl-0\n        {id && id.length !== 0 ? 'lg:pl-0' : 'lg:pl-4'}\"\n        >\n          {titleBase}\n          {#if titleAddendum}\n            <span\n              class=\"ml-2 flex justify-center items-center rounded-full h-5 w-5 bg-coopmaths-warn-900 text-coopmaths-canvas font-bold text-sm\"\n            >\n              {titleAddendum}\n            </span>\n          {/if}\n        </div>\n      {/key}\n    </div>\n    <div\n      class=\"print-hidden flex flex-col md:flex-row justify-start space-x-2 md:space-x-10 text-normal mt-1 text-xl lg:justify-end mr-1\"\n    >\n      <div class=\"flex flex-row justify-start items-center\">\n        <!-- <button\n          class=\"mx-2 tooltip tooltip-left\"\n          data-tip={isMessagesVisible ? \"Masquer les messages\" : \"Montrer les messages\"}\n          type=\"button\"\n          on:click={() => {\n            isMessagesVisible = !isMessagesVisible\n            dispatch(\"clickMessages\", { isMessagesVisible })\n          }}\n        >\n          <i class=\"bx {isMessagesVisible ? 'bxs-bulb' : 'bx-bulb'}\" />\n        </button> -->\n        <button\n          class=\"mx-2 tooltip tooltip-left tooltip-neutral {correctionExists &&\n          correctionReady\n            ? ''\n            : 'hidden'}\"\n          data-tip=\"{isCorrectionVisible\n            ? 'Masquer la correction'\n            : 'Montrer la correction'}\"\n          type=\"button\"\n          on:click=\"{() => {\n            isCorrectionVisible = !isCorrectionVisible\n            dispatch('clickCorrection', {\n              isCorrectionVisible,\n              isContentVisible,\n            })\n          }}\"\n        >\n          <i\n            class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx {isCorrectionVisible\n              ? 'bxs-check-circle'\n              : 'bx-check-circle'}\"\n          ></i>\n        </button>\n        <button\n          class=\"mx-2 tooltip tooltip-left tooltip-neutral {$globalOptions.isInteractiveFree &&\n          interactifReady\n            ? ''\n            : 'hidden'}\"\n          data-tip=\"{isInteractif\n            ? \"Dsactiver l'interactivit\"\n            : 'Rendre interactif'}\"\n          type=\"button\"\n          on:click=\"{switchInteractif}\"\n        >\n          <InteractivityIcon isOnStateActive=\"{isInteractif}\" />\n        </button>\n        <button\n          class=\"mx-2 tooltip tooltip-left\"\n          data-tip=\"Nouvel nonc\"\n          type=\"button\"\n          on:click=\"{newData}\"\n        >\n          <i\n            class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-refresh {randomReady\n              ? ''\n              : 'hidden'}\"\n          ></i>\n        </button>\n        {#if isHidable}\n          <button\n            type=\"button\"\n            on:click=\"{() => {\n              isVisible = !isVisible\n              dispatch('clickVisible', { isVisible })\n            }}\"\n            class=\"mx-2 tooltip tooltip-left\"\n            data-tip=\" {isVisible ? 'Masquer' : 'Montrer'} l'exercice\"\n          >\n            <i\n              class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx {isVisible\n                ? 'bx-hide'\n                : 'bx-show'}\"\n            ></i>\n          </button>\n        {/if}\n        <button\n          class=\"mx-2 tooltip tooltip-left tooltip-neutral\"\n          data-tip=\"Dupliquer l'exercice\"\n          type=\"button\"\n          on:click=\"{duplicate}\"\n        >\n          <i\n            class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-duplicate\"\n          ></i>\n        </button>\n        {#if isDeletable}\n          <button\n            class=\"mx-2 tooltip tooltip-left tooltip-neutral\"\n            data-tip=\"Supprimer l'exercice\"\n            type=\"button\"\n            on:click=\"{remove}\"\n          >\n            <i\n              class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-trash\"\n            ></i>\n          </button>\n        {/if}\n        <button\n          class=\"mx-2 tooltip tooltip-left tooltip-neutral {settingsReady\n            ? ''\n            : 'hidden'} \"\n          data-tip=\"Changer les paramtres de l'exercice\"\n          type=\"button\"\n          on:click=\"{() => {\n            isSettingsVisible = !isSettingsVisible\n            dispatch('clickSettings', { isSettingsVisible })\n          }}\"\n        >\n          <i\n            class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-slider\"\n          ></i>\n        </button>\n      </div>\n      <div\n        class=\"flex flex-row justify-start items-center space-x-4 md:space-x-1\"\n      >\n        {#if isSortable}\n          <BoutonMonter indice=\"{indiceExercice}\" />\n          <BoutonDescendre indice=\"{indiceExercice}\" {indiceLastExercice} />\n        {/if}\n      </div>\n    </div>\n  </h1>\n</div>\n","<script lang=\"ts\">\n  import { createEventDispatcher, onMount } from 'svelte'\n  import type Exercice from '../../../../../../exercices/Exercice'\n  import ExerciceSimple from '../../../../../../exercices/ExerciceSimple'\n\n  export let exercice: Exercice\n  export let exerciceIndex: number\n  export let isVisible: boolean = true\n\n  const dispatch = createEventDispatcher()\n\n  type FormNumerique = {\n    titre: string\n    champs: string[] | number\n  }\n\n  let nbQuestions: number\n  let duration: number\n  let sup: boolean\n  let sup2: boolean\n  let sup3: boolean\n  let sup4: boolean\n  let sup5: boolean\n  let versionQcm: boolean\n  let alea: string\n  let correctionDetaillee: boolean\n\n  let isCommentDisplayed: boolean = false\n\n  let formNum1: FormNumerique\n  let formNum2: FormNumerique\n  let formNum3: FormNumerique\n  let formNum4: FormNumerique\n  let formNum5: FormNumerique\n\n  let previousSeed: string | undefined\n  $: {\n    // Pour que la srie dans le formulaire se mette  jour lorsqu'on clique sur \"Nouvel nonc\"\n    if (previousSeed !== exercice.seed) {\n      // Sans a, on ne peut pas modifier la srie dans le formulaire\n      previousSeed = exercice.seed\n      alea = exercice.seed ?? ''\n    }\n  }\n\n  onMount(() => {\n    nbQuestions = exercice.nbQuestions\n    duration = exercice.duration || 10\n    sup = exercice.sup === 'false' ? false : exercice.sup\n    sup2 = exercice.sup2 === 'false' ? false : exercice.sup2\n    sup3 = exercice.sup3 === 'false' ? false : exercice.sup3\n    sup4 = exercice.sup4 === 'false' ? false : exercice.sup4\n    sup5 = exercice.sup5 === 'false' ? false : exercice.sup5\n    versionQcm =\n      exercice instanceof ExerciceSimple ? exercice.versionQcm || false : false\n    correctionDetaillee = exercice.correctionDetaillee\n\n    if (\n      Array.isArray(exercice.besoinFormulaireNumerique) &&\n      exercice.besoinFormulaireNumerique.length > 0\n    ) {\n      formNum1 = parseFormNumerique(exercice.besoinFormulaireNumerique)\n    }\n    if (\n      Array.isArray(exercice.besoinFormulaire2Numerique) &&\n      exercice.besoinFormulaire2Numerique.length > 0\n    ) {\n      formNum2 = parseFormNumerique(exercice.besoinFormulaire2Numerique)\n    }\n    if (\n      Array.isArray(exercice.besoinFormulaire3Numerique) &&\n      exercice.besoinFormulaire3Numerique.length > 0\n    ) {\n      formNum3 = parseFormNumerique(exercice.besoinFormulaire3Numerique)\n    }\n    if (\n      Array.isArray(exercice.besoinFormulaire4Numerique) &&\n      exercice.besoinFormulaire4Numerique.length > 0\n    ) {\n      formNum4 = parseFormNumerique(exercice.besoinFormulaire4Numerique)\n    }\n    if (\n      Array.isArray(exercice.besoinFormulaire5Numerique) &&\n      exercice.besoinFormulaire5Numerique.length > 0\n    ) {\n      formNum5 = parseFormNumerique(exercice.besoinFormulaire5Numerique)\n    }\n  })\n\n  /**\n   * Transforme le tableau des tooltips d'un paramtre type numrique en un objet\n   * constitu d'un titre (celui du paramtre) et soit d'un tableau\n   * des options, soit d'un nombre correspond  la valeur maximale.\n   * <i>Rfrence :</i> commentaire du fichier Exercice.ts sur la proprit\n   * <code>besoinFormulaireNumerique</code> (<code>false</code>\n   * sinon this.besoinFormulaireNumerique = [texte, max, tooltip facultatif])\n   * @param {string[]} entreesFormulaire Typiquement la valeur de la proprit\n   * <code>besoinFormulaireNumerique</code>\n   * @author sylvain chambon\n   */\n  function parseFormNumerique(\n    entreesFormulaire:\n      | [titre: string, max: number, tooltip: string]\n      | [titre: string, max: number],\n  ): FormNumerique {\n    const entrees:\n      | [titre: string, max: number, tooltip: string]\n      | [titre: string, max: number] = [...entreesFormulaire]\n    if (![2, 3].includes(entrees.length)) {\n      // `besoinFormulaireNumerique` est de la forme [texte, max, tooltip] ou [texte, max]\n      throw new Error(\n        `Dans ${exercice.uuid}, besoinFormulaireNumerique est mal dclar`,\n      )\n    } else {\n      // la liste entrees a deux ou trois lments\n      const premier = entrees.shift()\n      const titre: string = (premier as string) ?? '' // le titre du paramtre est le 1er elt\n      let champs: string[] | number\n      if (entrees.length > 1) {\n        // il y a une liste de tooltips qui deviendront les entres\n        const dernier = entrees.pop() as string\n        if (dernier) {\n          champs = dernier\n            .split('\\n')\n            .map((x) => x.replace(/(?:\\d* *: *)/i, ''))\n        } else {\n          champs = []\n        }\n      } else {\n        // les champs se rsument  un seul nombre correspondant au maximum\n        const max = entrees[0]\n        champs = typeof max === 'number' ? max : parseInt(max)\n      }\n      return { titre, champs }\n    }\n  }\n\n  function dispatchNewSettings() {\n    dispatch('settings', {\n      nbQuestions,\n      duration,\n      sup,\n      sup2,\n      sup3,\n      sup4,\n      sup5,\n      versionQcm,\n      alea,\n      correctionDetaillee,\n    })\n  }\n</script>\n\n<div\n  id=\"settings{exerciceIndex}\"\n  class=\"relative bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark z-20 {isVisible\n    ? 'visible lg:w-1/4'\n    : 'hidden lg:w-0'} flex flex-col duration-500\"\n>\n  <div class=\"absolute top-2 right-3\">\n    <button\n      type=\"button\"\n      on:click=\"{() => {\n        isVisible = !isVisible\n        dispatch('clickSettings', { isVisible })\n      }}\"\n    >\n      <i\n        class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest text-xl bx bx-x\"\n      ></i>\n    </button>\n  </div>\n  <div\n    class=\"text-lg lg:text-base ml-2 lg:ml-4 space-y-4 p-3 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n  >\n    <h3 class=\"text-coopmaths-struct dark:text-coopmathsdark-struct font-bold\">\n      Paramtres\n    </h3>\n    {#if exercice.nbQuestionsModifiable}\n      <div>\n        <span\n          class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n        >\n          Nombre de questions :\n        </span>\n        <input\n          type=\"number\"\n          id=\"settings-nb-questions-{exerciceIndex}\"\n          min=\"1\"\n          max=\"100\"\n          bind:value=\"{nbQuestions}\"\n          on:change=\"{dispatchNewSettings}\"\n          class=\"w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n        />\n      </div>\n    {/if}\n    {#if exercice.besoinFormulaireCaseACocher}\n      <div class=\"container\">\n        <label\n          class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n          for=\"settings-check1-{exerciceIndex}\"\n        >\n          {#if typeof exercice.besoinFormulaireCaseACocher !== 'boolean'}\n            {exercice.besoinFormulaireCaseACocher[0]} :\n          {/if}\n        </label>\n        <input\n          name=\"settings-check1\"\n          type=\"checkbox\"\n          id=\"settings-check1-{exerciceIndex}\"\n          class=\"ml-2 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas border-coopmaths-action text-coopmaths-action dark:border-coopmathsdark-action dark:text-coopmathsdark-action focus:ring-1 focus:ring-coopmaths-action dark:focus:ring-coopmathsdark-action h-4 w-4 rounded cursor-pointer\"\n          bind:checked=\"{sup}\"\n          on:change=\"{dispatchNewSettings}\"\n        />\n      </div>\n    {/if}\n    {#if formNum1}\n      {#if Array.isArray(formNum1.champs)}\n        <div class=\"flex flex-col\">\n          <form id=\"settings-form-formNum1-{exerciceIndex}\" action=\"\">\n            <label\n              class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n              for=\"settings-formNum1-{exerciceIndex}\">{formNum1.titre} :</label\n            >\n            <select\n              class=\"flex flex-auto w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n              name=\"formNum1\"\n              id=\"settings-formNum1-{exerciceIndex}\"\n              bind:value=\"{sup}\"\n              on:change=\"{dispatchNewSettings}\"\n            >\n              {#each formNum1.champs as entree, i}\n                <option\n                  value=\"{i + 1}\"\n                  class=\"bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n                  >{entree}</option\n                >\n              {/each}\n            </select>\n          </form>\n        </div>\n      {:else}\n        <div>\n          <!-- Pas de tooltips -->\n          <label\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n            for=\"settings-formNum1-{exerciceIndex}\"\n            >{formNum1.titre} :\n          </label>\n          <input\n            name=\"formNum1\"\n            id=\"settings-formNum1-{exerciceIndex}\"\n            type=\"number\"\n            class=\"w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n            min=\"1\"\n            max=\"{formNum1.champs}\"\n            bind:value=\"{sup}\"\n            on:change=\"{dispatchNewSettings}\"\n          />\n        </div>\n      {/if}\n    {/if}\n    {#if exercice.besoinFormulaireTexte}\n      <form\n        id=\"settings-form-formText1-{exerciceIndex}\"\n        name=\"settings-form-formText1\"\n        on:submit|preventDefault=\"{dispatchNewSettings}\"\n      >\n        {#if typeof exercice.besoinFormulaireTexte !== 'boolean'}\n          <label\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n            for=\"settings-formText1-{exerciceIndex}\"\n          >\n            {exercice.besoinFormulaireTexte[0]} :\n          </label>\n          <div\n            class=\"tooltip tooltip-bottom w-full before:whitespace-pre-wrap before:content-[attr(data-tip)] before:text-left\"\n            data-tip=\"{exercice.besoinFormulaireTexte[1]}\"\n          >\n            <input\n              class=\"w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n              name=\"settings-formText1\"\n              id=\"settings-formText1-{exerciceIndex}\"\n              type=\"text\"\n              bind:value=\"{sup}\"\n              on:input=\"{dispatchNewSettings}\"\n            />\n          </div>\n        {/if}\n      </form>\n    {/if}\n\n    <!-- sup2 -->\n    {#if exercice.besoinFormulaire2CaseACocher}\n      <div class=\"container\">\n        <label\n          class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n          for=\"settings-check2-{exerciceIndex}\"\n        >\n          {#if typeof exercice.besoinFormulaire2CaseACocher !== 'boolean'}\n            {exercice.besoinFormulaire2CaseACocher[0]} :\n          {/if}\n        </label>\n        <input\n          name=\"settings-check2\"\n          id=\"settings-check2-{exerciceIndex}\"\n          type=\"checkbox\"\n          class=\"ml-2 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas border-coopmaths-action text-coopmaths-action dark:border-coopmathsdark-action dark:text-coopmathsdark-action focus:ring-1 focus:ring-coopmaths-action dark:focus:ring-coopmathsdark-action h-4 w-4 rounded cursor-pointer\"\n          bind:checked=\"{sup2}\"\n          on:change=\"{dispatchNewSettings}\"\n        />\n      </div>\n    {/if}\n    {#if formNum2}\n      {#if Array.isArray(formNum2.champs)}\n        <div class=\"flex flex-col\">\n          <form id=\"settings-form-formNum2-{exerciceIndex}\" action=\"\">\n            <label\n              class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n              for=\"settings-formNum2-{exerciceIndex}\">{formNum2.titre} :</label\n            >\n            <select\n              class=\"flex flex-auto w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n              name=\"settings-formNum2\"\n              id=\"settings-formNum2-{exerciceIndex}\"\n              bind:value=\"{sup2}\"\n              on:change=\"{dispatchNewSettings}\"\n            >\n              {#each formNum2.champs as entree, i}\n                <option\n                  value=\"{i + 1}\"\n                  class=\"bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n                  >{entree}</option\n                >\n              {/each}\n            </select>\n          </form>\n        </div>\n      {:else}\n        <div>\n          <!-- Pas de tooltips -->\n          <label\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n            for=\"settings-formNum2-{exerciceIndex}\"\n            >{formNum2.titre} :\n          </label>\n          <input\n            name=\"settings-formNum2\"\n            type=\"number\"\n            id=\"settings-formNum2-{exerciceIndex}\"\n            class=\"w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n            min=\"1\"\n            max=\"{formNum2.champs}\"\n            bind:value=\"{sup2}\"\n            on:change=\"{dispatchNewSettings}\"\n          />\n        </div>\n      {/if}\n    {/if}\n    {#if exercice.besoinFormulaire2Texte}\n      <form\n        id=\"settings-form-formText2-{exerciceIndex}\"\n        name=\"settings-form-formText2\"\n        on:submit|preventDefault=\"{dispatchNewSettings}\"\n      >\n        {#if typeof exercice.besoinFormulaire2Texte !== 'boolean'}\n          <label\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n            for=\"settings-formText2-{exerciceIndex}\"\n          >\n            {exercice.besoinFormulaire2Texte[0]} :\n          </label>\n          <div\n            class=\"tooltip tooltip-bottom w-full before:whitespace-pre-wrap before:content-[attr(data-tip)] before:text-left\"\n            data-tip=\"{exercice.besoinFormulaire2Texte[1]}\"\n          >\n            <input\n              class=\"w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n              name=\"settings-formText2\"\n              id=\"settings-formText2-{exerciceIndex}\"\n              type=\"text\"\n              bind:value=\"{sup2}\"\n              on:input=\"{dispatchNewSettings}\"\n            />\n          </div>\n        {/if}\n      </form>\n    {/if}\n\n    <!-- sup3 -->\n    {#if exercice.besoinFormulaire3CaseACocher}\n      <div class=\"container\">\n        <label\n          class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n          for=\"settings-check3-{exerciceIndex}\"\n        >\n          {#if typeof exercice.besoinFormulaire3CaseACocher !== 'boolean'}\n            {exercice.besoinFormulaire3CaseACocher[0]} :\n          {/if}\n        </label>\n        <input\n          name=\"settings-check3\"\n          id=\"settings-check3-{exerciceIndex}\"\n          type=\"checkbox\"\n          class=\"ml-2 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas border-coopmaths-action text-coopmaths-action dark:border-coopmathsdark-action dark:text-coopmathsdark-action focus:ring-1 focus:ring-coopmaths-action dark:focus:ring-coopmathsdark-action h-4 w-4 rounded cursor-pointer\"\n          bind:checked=\"{sup3}\"\n          on:change=\"{dispatchNewSettings}\"\n        />\n      </div>\n    {/if}\n    {#if formNum3}\n      {#if Array.isArray(formNum3.champs)}\n        <div class=\"flex flex-col\">\n          <form id=\"settings-form-formNum3-{exerciceIndex}\" action=\"\">\n            <label\n              class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n              for=\"settings-formNum3-{exerciceIndex}\">{formNum3.titre} :</label\n            >\n            <select\n              class=\"flex flex-auto w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n              name=\"settings-formNum3\"\n              id=\"settings-formNum3-{exerciceIndex}\"\n              bind:value=\"{sup3}\"\n              on:change=\"{dispatchNewSettings}\"\n            >\n              {#each formNum3.champs as entree, i}\n                <option\n                  value=\"{i + 1}\"\n                  class=\"bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n                  >{entree}</option\n                >\n              {/each}\n            </select>\n          </form>\n        </div>\n      {:else}\n        <div>\n          <!-- Pas de tooltips -->\n          <label\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n            for=\"settings-formNum3-{exerciceIndex}\"\n            >{formNum3.titre} :\n          </label>\n          <input\n            name=\"settings-formNum3\"\n            id=\"settings-formNum3-{exerciceIndex}\"\n            type=\"number\"\n            class=\"w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n            min=\"1\"\n            max=\"{formNum3.champs}\"\n            bind:value=\"{sup3}\"\n            on:change=\"{dispatchNewSettings}\"\n          />\n        </div>\n      {/if}\n    {/if}\n    {#if exercice.besoinFormulaire3Texte}\n      <form\n        id=\"settings-form-formText3-{exerciceIndex}\"\n        name=\"settings-form-formText3\"\n        on:submit|preventDefault=\"{dispatchNewSettings}\"\n      >\n        {#if typeof exercice.besoinFormulaire3Texte !== 'boolean'}\n          <label\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n            for=\"settings-formText3-{exerciceIndex}\"\n          >\n            {exercice.besoinFormulaire3Texte[0]} :\n          </label>\n          <div\n            class=\"tooltip tooltip-bottom w-full before:whitespace-pre-wrap before:content-[attr(data-tip)] before:text-left\"\n            data-tip=\"{exercice.besoinFormulaire3Texte[1]}\"\n          >\n            <input\n              class=\"w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n              name=\"settings-formText3\"\n              id=\"settings-formText3-{exerciceIndex}\"\n              type=\"text\"\n              bind:value=\"{sup3}\"\n              on:input=\"{dispatchNewSettings}\"\n            />\n          </div>\n        {/if}\n      </form>\n    {/if}\n\n    <!-- sup4 -->\n    {#if exercice.besoinFormulaire4CaseACocher}\n      <div class=\"container\">\n        <label\n          class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n          for=\"settings-check4-{exerciceIndex}\"\n        >\n          {#if typeof exercice.besoinFormulaire4CaseACocher !== 'boolean'}\n            {exercice.besoinFormulaire4CaseACocher[0]} :\n          {/if}\n        </label>\n        <input\n          name=\"settings-check4\"\n          id=\"settings-check4-{exerciceIndex}\"\n          type=\"checkbox\"\n          class=\"ml-2 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas border-coopmaths-action text-coopmaths-action dark:border-coopmathsdark-action dark:text-coopmathsdark-action focus:ring-1 focus:ring-coopmaths-action dark:focus:ring-coopmathsdark-action h-4 w-4 rounded cursor-pointer\"\n          bind:checked=\"{sup4}\"\n          on:change=\"{dispatchNewSettings}\"\n        />\n      </div>\n    {/if}\n    {#if formNum4}\n      {#if Array.isArray(formNum4.champs)}\n        <div class=\"flex flex-col\">\n          <form id=\"settings-form-formNum4-{exerciceIndex}\" action=\"\">\n            <label\n              class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n              for=\"settings-formNum4-{exerciceIndex}\">{formNum4.titre} :</label\n            >\n            <select\n              class=\"flex flex-auto w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n              name=\"settings-formNum4\"\n              id=\"settings-formNum4-{exerciceIndex}\"\n              bind:value=\"{sup4}\"\n              on:change=\"{dispatchNewSettings}\"\n            >\n              {#each formNum4.champs as entree, i}\n                <option\n                  value=\"{i + 1}\"\n                  class=\"bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n                  >{entree}</option\n                >\n              {/each}\n            </select>\n          </form>\n        </div>\n      {:else}\n        <div>\n          <!-- Pas de tooltips -->\n          <label\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n            for=\"settings-formNum4-{exerciceIndex}\"\n            >{formNum4.titre} :\n          </label>\n          <input\n            name=\"settings-formNum4\"\n            id=\"settings-formNum4-{exerciceIndex}\"\n            type=\"number\"\n            class=\"w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n            min=\"1\"\n            max=\"{formNum4.champs}\"\n            bind:value=\"{sup4}\"\n            on:change=\"{dispatchNewSettings}\"\n          />\n        </div>\n      {/if}\n    {/if}\n    {#if exercice.besoinFormulaire4Texte}\n      <form\n        id=\"settings-form-formText4-{exerciceIndex}\"\n        name=\"settings-form-formText4\"\n        class=\"flex flex-col justify-start\"\n        on:submit|preventDefault=\"{dispatchNewSettings}\"\n      >\n        {#if typeof exercice.besoinFormulaire4Texte !== 'boolean'}\n          <label\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n            for=\"settings-formText4-{exerciceIndex}\"\n          >\n            {exercice.besoinFormulaire4Texte[0]} :\n          </label>\n          <div\n            class=\"tooltip tooltip-bottom w-full before:whitespace-pre-wrap before:content-[attr(data-tip)] before:text-left\"\n            data-tip=\"{exercice.besoinFormulaire4Texte[1]}\"\n          >\n            <input\n              class=\"w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n              name=\"settings-formText4\"\n              id=\"settings-formText4-{exerciceIndex}\"\n              type=\"text\"\n              bind:value=\"{sup4}\"\n              on:input=\"{dispatchNewSettings}\"\n            />\n          </div>\n        {/if}\n      </form>\n    {/if}\n\n    <!-- sup5 -->\n    {#if exercice.besoinFormulaire5CaseACocher}\n      <div class=\"container\">\n        <label\n          class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n          for=\"settings-check5-{exerciceIndex}\"\n        >\n          {#if typeof exercice.besoinFormulaire5CaseACocher !== 'boolean'}\n            {exercice.besoinFormulaire5CaseACocher[0]} :\n          {/if}\n        </label>\n        <input\n          name=\"settings-check5\"\n          id=\"settings-check5-{exerciceIndex}\"\n          type=\"checkbox\"\n          class=\"ml-2 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas border-coopmaths-action text-coopmaths-action dark:border-coopmathsdark-action dark:text-coopmathsdark-action focus:ring-1 focus:ring-coopmaths-action dark:focus:ring-coopmathsdark-action h-4 w-4 rounded cursor-pointer\"\n          bind:checked=\"{sup5}\"\n          on:change=\"{dispatchNewSettings}\"\n        />\n      </div>\n    {/if}\n    {#if formNum5}\n      {#if Array.isArray(formNum5.champs)}\n        <div class=\"flex flex-col\">\n          <form id=\"settings-form-formNum5-{exerciceIndex}\" action=\"\">\n            <label\n              class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n              for=\"settings-formNum5-{exerciceIndex}\">{formNum5.titre} :</label\n            >\n            <select\n              class=\"flex flex-auto w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n              name=\"settings-formNum5\"\n              id=\"settings-formNum5-{exerciceIndex}\"\n              bind:value=\"{sup5}\"\n              on:change=\"{dispatchNewSettings}\"\n            >\n              {#each formNum5.champs as entree, i}\n                <option\n                  value=\"{i + 1}\"\n                  class=\"bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n                  >{entree}</option\n                >\n              {/each}\n            </select>\n          </form>\n        </div>\n      {:else}\n        <div>\n          <!-- Pas de tooltips -->\n          <label\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n            for=\"settings-formNum5-{exerciceIndex}\"\n            >{formNum5.titre} :\n          </label>\n          <input\n            name=\"settings-formNum5\"\n            id=\"settings-formNum5-{exerciceIndex}\"\n            type=\"number\"\n            class=\"w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n            min=\"1\"\n            max=\"{formNum5.champs}\"\n            bind:value=\"{sup5}\"\n            on:change=\"{dispatchNewSettings}\"\n          />\n        </div>\n      {/if}\n    {/if}\n    {#if exercice.besoinFormulaire5Texte}\n      <form\n        id=\"settings-form-formText5-{exerciceIndex}\"\n        name=\"settings-form-formText5\"\n        class=\"flex flex-col justify-start\"\n        on:submit|preventDefault=\"{dispatchNewSettings}\"\n      >\n        {#if typeof exercice.besoinFormulaire5Texte !== 'boolean'}\n          <label\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n            for=\"settings-formText5-{exerciceIndex}\"\n          >\n            {exercice.besoinFormulaire5Texte[0]} :\n          </label>\n          <div\n            class=\"tooltip tooltip-bottom w-full before:whitespace-pre-wrap before:content-[attr(data-tip)] before:text-left\"\n            data-tip=\"{exercice.besoinFormulaire5Texte[1]}\"\n          >\n            <input\n              class=\"w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n              name=\"settings-formText5\"\n              id=\"settings-formText5-{exerciceIndex}\"\n              type=\"text\"\n              bind:value=\"{sup5}\"\n              on:input=\"{dispatchNewSettings}\"\n            />\n          </div>\n        {/if}\n      </form>\n    {/if}\n\n    {#if exercice.correctionDetailleeDisponible}\n      <div class=\"container\">\n        <label for=\"settings-correction-detaillee-{exerciceIndex}\">\n          <span\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n          >\n            Correction dtaille :\n          </span>\n        </label>\n        <input\n          type=\"checkbox\"\n          id=\"settings-correction-detaillee-{exerciceIndex}\"\n          class=\"ml-2 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas border-coopmaths-action text-coopmaths-action dark:border-coopmathsdark-action dark:text-coopmathsdark-action focus:ring-1 focus:ring-coopmaths-action dark:focus:ring-coopmathsdark-action h-4 w-4 rounded cursor-pointer\"\n          bind:checked=\"{correctionDetaillee}\"\n          on:change=\"{dispatchNewSettings}\"\n        />\n      </div>\n    {/if}\n\n    {#if exercice instanceof ExerciceSimple && exercice.versionQcmDisponible}\n      <div class=\"container\">\n        <label for=\"settings-version-qcm-{exerciceIndex}\">\n          <span\n            class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n          >\n            Version QCM :\n          </span>\n        </label>\n        <input\n          type=\"checkbox\"\n          id=\"settings-version-qcm-{exerciceIndex}\"\n          class=\"ml-2 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas border-coopmaths-action text-coopmaths-action dark:border-coopmathsdark-action dark:text-coopmathsdark-action focus:ring-1 focus:ring-coopmaths-action dark:focus:ring-coopmathsdark-action h-4 w-4 rounded cursor-pointer\"\n          bind:checked=\"{versionQcm}\"\n          on:change=\"{dispatchNewSettings}\"\n        />\n      </div>\n    {/if}\n    <form\n      id=\"settings-form-formAlea-{exerciceIndex}\"\n      name=\"settings-form-formAlea\"\n      on:submit|preventDefault=\"{dispatchNewSettings}\"\n    >\n      <label\n        class=\"text-sm md:text-normal text-coopmaths-struct dark:text-coopmathsdark-struct font-light\"\n        for=\"settings-formAlea-{exerciceIndex}\"\n      >\n        Srie :\n      </label>\n      <input\n        class=\"w-full text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-dark border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n        name=\"settings-formAlea\"\n        id=\"settings-formAlea-{exerciceIndex}\"\n        type=\"text\"\n        bind:value=\"{alea}\"\n        on:input=\"{dispatchNewSettings}\"\n      />\n    </form>\n    {#if exercice.comment !== undefined}\n      <div class=\"flex flex-col justify-start items-start p-2\">\n        <button\n          type=\"button\"\n          class=\"flex items-center text-coopmaths-action dark:text-coopmathsdark-action cursor-pointer\"\n          on:click=\"{() => {\n            isCommentDisplayed = !isCommentDisplayed\n          }}\"\n          on:keydown=\"{() => {\n            isCommentDisplayed = !isCommentDisplayed\n          }}\"\n        >\n          <i class=\"bx bx-info-circle mr-2\"></i>En savoir plus...\n        </button>\n        <div\n          class=\"{isCommentDisplayed\n            ? 'block'\n            : 'hidden'} pt-4 font-light text-justify text-coopmaths-corpus-light text-sm\"\n        >\n          <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n          {@html exercice.comment}\n        </div>\n      </div>\n    {/if}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import seedrandom from 'seedrandom'\n  import { afterUpdate, beforeUpdate, onDestroy, onMount, tick } from 'svelte'\n  import { get } from 'svelte/store'\n  import Exercice from '../../../../../exercices/Exercice'\n  import ExerciceSimple from '../../../../../exercices/ExerciceSimple'\n  import {\n    exercisesUuidRanking,\n    uuidCount,\n  } from '../../../../../lib/components/counts'\n  import {\n    exerciceInteractif,\n    prepareExerciceCliqueFigure,\n  } from '../../../../../lib/interactif/gestionInteractif'\n  import {\n    mathaleaFormatExercice,\n    mathaleaHandleExerciceSimple,\n    mathaleaHandleSup,\n    mathaleaRenderDiv,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../../../lib/mathalea'\n  import {\n    changes,\n    exercicesParams,\n    globalOptions,\n    resultsByExercice,\n  } from '../../../../../lib/stores/generalStore'\n  import { isLocalStorageAvailable } from '../../../../../lib/stores/storage'\n  import type { InterfaceParams } from '../../../../../lib/types'\n  import type { HeaderProps } from '../../../../../lib/types/ui'\n  import { loadMathLive } from '../../../../../modules/loaders'\n  import { countMathField } from '../../countMathField'\n  import { handleCorrectionAffichee } from '../../handleCorrection'\n  import HeaderExerciceVueProf from '../../shared/headerExerciceVueProf/HeaderExerciceVueProf.svelte'\n  import Settings from './presentationalComponents/Settings.svelte'\n\n  export let exercise: Exercice\n  export let exerciseIndex: number\n  export let indiceLastExercice: number\n  export let isCorrectionVisible = false\n  export let toggleSidenav: (open: boolean) => void\n\n  let divExercice: HTMLDivElement\n  let divScore: HTMLDivElement\n  let buttonScore: HTMLButtonElement\n  /*\n   * MGu Attention interfaceParams est un objet qui est une copie du store,\n   * donc le mettre  jour directement met  jour le store sans le signaler au subscriber\n   * DE PLUS, si on change l'ordre des exercices OU si on supprime un exercice, exerciseIndex\n   * va devenir faux mais cela n'est pas gnant car l'exercice va tre destroy...\n   * Cependant, avant un DESTROY, il y aura un beforeupdate et un afterupdate, donc cette variable\n   * peut devenir UNDEFINED ou ERRONEE\n   */\n  let interfaceParams: InterfaceParams | undefined =\n    get(exercicesParams)[exerciseIndex]\n  let exercicesNumber: number = get(exercicesParams).length\n\n  let id: string =\n    interfaceParams && interfaceParams.id\n      ? interfaceParams.id\n      : (exercise.id ?? '')\n\n  const subscribeExercicesParamsStore = exercicesParams.subscribe((value) => {\n    log('new interface')\n    if (value[exerciseIndex] !== interfaceParams) {\n      // MGu c'est une comparaison par rfrence\n      log('new interfaceParams subscribe:' + JSON.stringify(interfaceParams))\n      interfaceParams = value[exerciseIndex]\n    }\n    if (exercicesNumber !== value.length) {\n      exercicesNumber = value.length\n    }\n  })\n\n  let columnsCount = interfaceParams.cols || 1\n  let isVisible = true\n  let isContentVisible = true\n  let isSettingsVisible = true\n  let isInteractif = exercise.interactif\n  const interactifReady = exercise.interactifReady\n  const exerciceHasNoSettings =\n    !exercise.nbQuestionsModifiable &&\n    !exercise.correctionDetailleeDisponible &&\n    !exercise.seed &&\n    !exercise.besoinFormulaireCaseACocher &&\n    !exercise.besoinFormulaireNumerique &&\n    !exercise.besoinFormulaireTexte &&\n    !exercise.besoinFormulaire2CaseACocher &&\n    !exercise.besoinFormulaire2Numerique &&\n    !exercise.besoinFormulaire2Texte &&\n    !exercise.besoinFormulaire3CaseACocher &&\n    !exercise.besoinFormulaire3Numerique &&\n    !exercise.besoinFormulaire3Texte &&\n    !exercise.besoinFormulaire4CaseACocher &&\n    !exercise.besoinFormulaire4Numerique &&\n    !exercise.besoinFormulaire4Texte &&\n    !exercise.besoinFormulaire5CaseACocher &&\n    !exercise.besoinFormulaire5Numerique &&\n    !exercise.besoinFormulaire5Texte\n  let isExerciceChecked = false\n  const generateTitleAddendum = (): string => {\n    const ranks = exercisesUuidRanking(get(exercicesParams))\n    const counts = uuidCount(get(exercicesParams))\n    if (\n      interfaceParams &&\n      interfaceParams.uuid &&\n      counts[interfaceParams.uuid] > 1\n    ) {\n      return '|' + ranks[exerciseIndex]\n    } else {\n      return ''\n    }\n  }\n  let headerProps: HeaderProps = {\n    title: '',\n    id,\n    indiceExercice: exerciseIndex,\n    indiceLastExercice,\n    isInteractif,\n    interactifReady,\n    isSettingsVisible,\n  }\n\n  $: {\n    if (isContentVisible && isInteractif && buttonScore) initButtonScore()\n    if (!isInteractif && divScore) divScore.innerHTML = ''\n    headerProps.settingsReady = !exerciceHasNoSettings\n    headerProps.isSortable = true\n    headerProps.isDeletable = true\n    headerProps.isHidable = true\n    headerProps.id = id\n    headerProps.isInteractif = isInteractif\n    headerProps.correctionExists = exercise.listeCorrections.length > 0\n    headerProps.title = exercise.titre + generateTitleAddendum()\n    headerProps.indiceExercice = exerciseIndex\n    headerProps.indiceLastExercice = exercicesNumber\n    headerProps.isSettingsVisible = isSettingsVisible\n    headerProps = headerProps\n  }\n\n  let numberOfAnswerFields: number = 0\n\n  // on dtecte les changements dans la liste des exercices\n  // afin de mettre  jour le titre\n  const unsubscribeToChangesStore = changes.subscribe(() => {\n    headerProps.title = exercise.titre + generateTitleAddendum()\n  })\n\n  async function forceUpdate() {\n    if (exercise == null) return\n    exercise.numeroExercice = exerciseIndex\n    await adjustMathalea2dFiguresWidth()\n  }\n\n  function log(str: string) {\n    const debug = new URL(window.location.href).searchParams.get('log') === '1'\n    if (debug) {\n      console.info(exerciseIndex, exercise.id)\n      console.info(str)\n    }\n  }\n\n  beforeUpdate(async () => {\n    log('beforeUpdate:' + exercise.id)\n    if (numberOfAnswerFields !== countMathField(exercise)) {\n      numberOfAnswerFields = countMathField(exercise)\n    }\n    if (get(exercicesParams)[exerciseIndex] !== interfaceParams) {\n      // interface  changer car un exercice a t supprim au dessus...\n      interfaceParams = get(exercicesParams)[exerciseIndex]\n      log('new interfaceParams beforeUpdate:' + JSON.stringify(interfaceParams))\n      // obliger de charger l'exercice car son numro  changer, et il faut grer les id correctement des HTMLElements\n      await updateDisplay()\n    }\n  })\n\n  /**\n   * Fonction appele lorsque le listener dtecte `languageHasChanged`.\n   * Elle change la variable `interfaceParams` et surtout met  jour `id`\n   * qui est succeptible de changer avec la langue.\n   * @author sylvain\n   */\n  const updateExerciceAfterLanguageChange = () => {\n    if ($exercicesParams.length !== 0) {\n      interfaceParams = get(exercicesParams)[exerciseIndex]\n      id = get(exercicesParams)[exerciseIndex].id || ''\n    }\n  }\n\n  onMount(async () => {\n    log('onMount:' + exercise.id)\n    document.addEventListener('newDataForAll', newData)\n    document.addEventListener('setAllInteractif', setAllInteractif)\n    document.addEventListener('removeAllInteractif', removeAllInteractif)\n    document.addEventListener('updateAsyncEx', forceUpdate)\n    document.addEventListener(\n      'languageHasChanged',\n      updateExerciceAfterLanguageChange,\n    )\n    await updateDisplay()\n  })\n\n  onDestroy(() => {\n    log('ondestroy' + exercise.id)\n    // Dtruit l'objet exercice pour librer la mmoire\n    exercise.reinit() // MGu ncessaire pour supprimer les listeners\n    exercise.destroy()\n    for (const prop of Object.keys(exercise)) {\n      Reflect.deleteProperty(exercise, prop)\n    }\n    document.removeEventListener('newDataForAll', newData)\n    document.removeEventListener('setAllInteractif', setAllInteractif)\n    document.removeEventListener('removeAllInteractif', removeAllInteractif)\n    document.removeEventListener('updateAsyncEx', forceUpdate)\n    document.removeEventListener(\n      'languageHasChanged',\n      updateExerciceAfterLanguageChange,\n    )\n    unsubscribeToChangesStore()\n    subscribeExercicesParamsStore()\n  })\n\n  afterUpdate(async () => {\n    log('afterUpdate:' + exercise.id)\n    if (exercise) {\n      await tick()\n      if (isInteractif) {\n        await loadMathLive()\n        if (\n          exercise?.interactifType === 'cliqueFigure' &&\n          !isCorrectionVisible\n        ) {\n          prepareExerciceCliqueFigure(exercise)\n        }\n        // Ne pas tre not sur un exercice dont on a dj vu la correction\n        if (\n          isLocalStorageAvailable() &&\n          exercise.id !== undefined &&\n          exercise.seed !== undefined &&\n          window.localStorage.getItem(`${exercise.id}|${exercise.seed}`) !=\n            null &&\n          isContentVisible\n        ) {\n          await newData()\n        }\n      }\n      mathaleaRenderDiv(divExercice)\n      if (exerciceHasNoSettings) {\n        isSettingsVisible = false\n      }\n    }\n    // Evnement indispensable pour pointCliquable par exemple\n    const exercicesAffiches = new window.Event('exercicesAffiches', {\n      bubbles: true,\n    })\n    document.dispatchEvent(exercicesAffiches)\n    if (isCorrectionVisible) {\n      handleCorrectionAffichee()\n    }\n  })\n\n  async function newData() {\n    log('newData' + exercise.id)\n    if (Object.prototype.hasOwnProperty.call(exercise, 'listeQuestions')) {\n      if (isCorrectionVisible && isInteractif) isCorrectionVisible = false\n      if (\n        exercise !== undefined &&\n        typeof exercise?.applyNewSeed === 'function'\n      ) {\n        exercise.applyNewSeed()\n      }\n      if (buttonScore) initButtonScore()\n      if (divScore) divScore.innerHTML = ''\n      if (\n        isLocalStorageAvailable() &&\n        exercise.id !== undefined &&\n        isCorrectionVisible\n      ) {\n        window.localStorage.setItem(`${exercise.id}|${exercise.seed}`, 'true')\n      }\n      await updateDisplay()\n    }\n  }\n\n  async function setAllInteractif() {\n    if (exercise?.interactifReady) isInteractif = true\n    await updateDisplay()\n  }\n  async function removeAllInteractif() {\n    if (exercise?.interactifReady) isInteractif = false\n    await updateDisplay()\n  }\n\n  function handleNewSettings(event: CustomEvent) {\n    log('handleNewSettings:' + JSON.stringify(event.detail))\n    if (!interfaceParams) {\n      return\n    }\n    if (event.detail.nbQuestions) {\n      exercise.nbQuestions = event.detail.nbQuestions\n      interfaceParams.nbQuestions = exercise.nbQuestions\n    }\n    if (event.detail.duration) {\n      exercise.duration = event.detail.duration\n      interfaceParams.duration = exercise.duration\n    }\n    if (event.detail.sup !== undefined) {\n      exercise.sup = event.detail.sup\n      interfaceParams.sup = mathaleaHandleSup(exercise.sup)\n    }\n    if (event.detail.sup2 !== undefined) {\n      exercise.sup2 = event.detail.sup2\n      interfaceParams.sup2 = mathaleaHandleSup(exercise.sup2)\n    }\n    if (event.detail.sup3 !== undefined) {\n      exercise.sup3 = event.detail.sup3\n      interfaceParams.sup3 = mathaleaHandleSup(exercise.sup3)\n    }\n    if (event.detail.sup4 !== undefined) {\n      exercise.sup4 = event.detail.sup4\n      interfaceParams.sup4 = mathaleaHandleSup(exercise.sup4)\n    }\n    if (event.detail.sup5 !== undefined) {\n      exercise.sup5 = event.detail.sup5\n      interfaceParams.sup5 = mathaleaHandleSup(exercise.sup5)\n    }\n    if (\n      event.detail.versionQcm !== undefined &&\n      exercise instanceof ExerciceSimple\n    ) {\n      exercise.versionQcm = event.detail.versionQcm\n      interfaceParams.versionQcm = exercise.versionQcm ? '1' : '0'\n    }\n    if (event.detail.alea !== undefined) {\n      exercise.seed = event.detail.alea\n      interfaceParams.alea = exercise.seed\n    }\n    if (event.detail.correctionDetaillee !== undefined) {\n      exercise.correctionDetaillee = event.detail.correctionDetaillee\n      interfaceParams.cd = exercise.correctionDetaillee ? '1' : '0'\n    }\n    exercicesParams.update((list) => {\n      // interfaceParams a t mis  jour donc le store est  jour\n      return list\n    })\n    if (isExerciceChecked) {\n      // Si on change des rglages alors qu'on a dj une note  l'exercice\n      // alors on part sur de nouvelles donnes ainsi on efface le score et les rponses proposes\n      isExerciceChecked = false\n      newData()\n    } else {\n      updateDisplay()\n    }\n  }\n\n  async function updateDisplay(withNewVersion = true) {\n    log('updateDisplay:' + exercise.id)\n    if (\n      exercise === null ||\n      interfaceParams === undefined ||\n      exercise.uuid !== interfaceParams.uuid\n    ) {\n      return\n    }\n    if (\n      exercise.seed === undefined &&\n      typeof exercise.applyNewSeed === 'function'\n    ) {\n      exercise.applyNewSeed()\n    }\n    seedrandom(exercise.seed, { global: true })\n    if (exercise.typeExercice === 'simple' && withNewVersion) {\n      mathaleaHandleExerciceSimple(exercise, Boolean(isInteractif))\n    }\n    exercise.interactif = isInteractif\n    if (interfaceParams.alea !== exercise.seed && exercise.seed !== undefined) {\n      // on met  jour le storer seulement si besoin\n      interfaceParams.alea = exercise.seed\n      log('interfaceParams.alea updated' + interfaceParams.alea)\n      exercicesParams.update((list) => {\n        // interfaceParams a t mis  jour donc le store est  jour\n        return list\n      })\n    }\n    if (interfaceParams.interactif !== (isInteractif ? '1' : '0')) {\n      // on met  jour le storer seulement si besoin\n      interfaceParams.interactif = isInteractif ? '1' : '0'\n      log('interfaceParams.interactif updated' + interfaceParams.interactif)\n      exercicesParams.update((list) => {\n        // interfaceParams a t mis  jour donc le store est  jour\n        return list\n      })\n    }\n    if (interfaceParams.cols !== columnsCount) {\n      // on met  jour le storer seulement si besoin\n      if (columnsCount === 1 && interfaceParams.cols !== undefined) {\n        interfaceParams.cols = undefined\n        log('interfaceParams.cols updated' + interfaceParams.cols)\n        exercicesParams.update((list) => {\n          // interfaceParams a t mis  jour donc le store est  jour\n          return list\n        })\n      } else if (columnsCount > 1 && interfaceParams.cols !== columnsCount) {\n        interfaceParams.cols = columnsCount\n        log('interfaceParams.cols updated' + interfaceParams.cols)\n        exercicesParams.update((list) => {\n          // interfaceParams a t mis  jour donc le store est  jour\n          return list\n        })\n      }\n    }\n    exercise.numeroExercice = exerciseIndex\n    if (\n      exercise.typeExercice !== 'simple' &&\n      typeof exercise.nouvelleVersionWrapper === 'function' &&\n      withNewVersion\n    ) {\n      exercise.nouvelleVersionWrapper(exerciseIndex)\n    }\n    mathaleaUpdateUrlFromExercicesParams()\n    await adjustMathalea2dFiguresWidth()\n  }\n\n  function verifExercice() {\n    isCorrectionVisible = true\n    isExerciceChecked = true\n    resultsByExercice.update((l) => {\n      const indice = exercise.numeroExercice ?? 0\n      const result = {\n        ...exerciceInteractif(exercise, divScore, buttonScore),\n        indice,\n      }\n      if (result != null) {\n        l[indice] = result\n      }\n      return l\n    })\n  }\n\n  function initButtonScore() {\n    buttonScore.classList.remove(...buttonScore.classList)\n    buttonScore.classList.add(\n      'inline-flex',\n      'px-6',\n      'py-2.5',\n      'ml-6',\n      'bg-coopmaths-action',\n      'dark:bg-coopmathsdark-action',\n      'text-coopmaths-canvas',\n      'dark:text-coopmathsdark-canvas',\n      'font-medium',\n      'text-xs',\n      'leading-tight',\n      'uppercase',\n      'rounded',\n      'shadow-md',\n      'transform',\n      'hover:bg-coopmaths-action-lightest',\n      'dark:hover:bg-coopmathsdark-action-lightest',\n      'hover:shadow-lg',\n      'focus:bg-coopmaths-action-lightest',\n      'dark:focus:bg-coopmathsdark-action-lightest',\n      'focus:shadow-lg',\n      'focus:outline-none',\n      'focus:ring-0',\n      'active:bg-coopmaths-action-lightest',\n      'dark:active:bg-coopmathsdark-action-lightest',\n      'active:shadow-lg',\n      'transition',\n      'duration-150',\n      'ease-in-out',\n      'checkReponses',\n    )\n  }\n\n  /**\n   * Recherche toutes les figures ayant la classe `mathalea2d` et rduit leur largeur  95% de la valeur\n   * maximale du div reper par l'ID `consigne<X>-0` o `X` est l'indice de l'exercice\n   * @param {boolean} initialDimensionsAreNeeded si `true`, les valeurs initiales sont recharges ()`false` par dfaut)\n   * @author sylvain\n   */\n  async function adjustMathalea2dFiguresWidth(\n    initialDimensionsAreNeeded: boolean = false,\n  ) {\n    await tick()\n    const mathalea2dFigures =\n      document?.querySelectorAll<SVGElement>('.mathalea2d')\n    if (\n      mathalea2dFigures !== null &&\n      mathalea2dFigures !== undefined &&\n      mathalea2dFigures.length !== 0\n    ) {\n      for (let k = 0; k < mathalea2dFigures.length; k++) {\n        if (initialDimensionsAreNeeded) {\n          // rinitialisation\n          const initialWidth = mathalea2dFigures[k].getAttribute(\n            'data-width-initiale',\n          )\n          const initialHeight = mathalea2dFigures[k].getAttribute(\n            'data-height-initiale',\n          )\n          mathalea2dFigures[k].setAttribute('width', initialWidth ?? '0')\n          mathalea2dFigures[k].setAttribute('height', initialHeight ?? '0')\n          // les lments Katex des figures SVG\n          if (\n            mathalea2dFigures[k] != null &&\n            mathalea2dFigures[k].parentElement != null\n          ) {\n            const eltsInFigures =\n              mathalea2dFigures[k].parentElement?.querySelectorAll<HTMLElement>(\n                'div.divLatex',\n              ) || []\n            for (const elt of eltsInFigures) {\n              const e = elt\n              e.style.setProperty('top', e.dataset.top + 'px')\n              e.style.setProperty('left', e.dataset.left + 'px')\n            }\n          }\n        }\n        const consigneDiv = mathalea2dFigures[k].closest('[id^=\"consigne\"]')\n        if (\n          consigneDiv &&\n          mathalea2dFigures[k].clientWidth > consigneDiv.clientWidth\n        ) {\n          const coef =\n            (consigneDiv.clientWidth * 0.95) / mathalea2dFigures[k].clientWidth\n          const width = mathalea2dFigures[k].getAttribute('width')\n          const height = mathalea2dFigures[k].getAttribute('height')\n          if (!mathalea2dFigures[k].dataset.widthInitiale && width != null) {\n            mathalea2dFigures[k].dataset.widthInitiale = width\n          }\n          if (!mathalea2dFigures[k].dataset.heightInitiale && height != null) {\n            mathalea2dFigures[k].dataset.heightInitiale = height\n          }\n          mathalea2dFigures[k].setAttribute(\n            'height',\n            (\n              Number(mathalea2dFigures[k].dataset.heightInitiale) * coef\n            ).toString(),\n          )\n          mathalea2dFigures[k].setAttribute(\n            'width',\n            (\n              Number(mathalea2dFigures[k].dataset.widthInitiale) * coef\n            ).toString(),\n          )\n\n          if (\n            mathalea2dFigures[k] != null &&\n            mathalea2dFigures[k].parentElement !== null\n          ) {\n            const eltsInFigures =\n              mathalea2dFigures[k].parentElement?.querySelectorAll<HTMLElement>(\n                'div.divLatex',\n              ) || []\n            for (const elt of eltsInFigures) {\n              const e = elt\n              const initialTop = Number(e.dataset.top) ?? 0\n              const initialLeft = Number(e.dataset.left) ?? 0\n              e.style.setProperty('top', (initialTop * coef).toString() + 'px')\n              e.style.setProperty(\n                'left',\n                (initialLeft * coef).toString() + 'px',\n              )\n            }\n          }\n        }\n      }\n    }\n  }\n  // pour recalculer les tailles lors d'un changement de dimension de la fentre\n  window.onresize = async () => {\n    await adjustMathalea2dFiguresWidth(true)\n  }\n\n  async function handleExerciseRemoved(event: CustomEvent) {\n    if ($exercicesParams.length === 0) {\n      toggleSidenav(true)\n    }\n    await updateDisplay()\n  }\n</script>\n\n<div class=\"z-0 flex-1\" bind:this=\"{divExercice}\">\n  <HeaderExerciceVueProf\n    {...headerProps}\n    on:clickVisible=\"{(event) => {\n      isVisible = event.detail.isVisible\n    }}\"\n    on:clickSettings=\"{(event) =>\n      (isSettingsVisible = event.detail.isSettingsVisible)}\"\n    on:clickCorrection=\"{async (event) => {\n      isContentVisible = event.detail.isContentVisible\n      isCorrectionVisible = event.detail.isCorrectionVisible\n\n      if (\n        isLocalStorageAvailable() &&\n        exercise.id !== undefined &&\n        isCorrectionVisible\n      ) {\n        window.localStorage.setItem(`${exercise.id}|${exercise.seed}`, 'true')\n      }\n      if (isInteractif) {\n        isInteractif = !isInteractif\n        exercise.interactif = isInteractif\n        await updateDisplay()\n      }\n      await adjustMathalea2dFiguresWidth()\n    }}\"\n    on:clickInteractif=\"{async (event) => {\n      isInteractif = event.detail.isInteractif\n      exercise.interactif = isInteractif\n      exercicesParams.update((params) => {\n        params[exerciseIndex].interactif = isInteractif ? '1' : '0'\n        return params\n      })\n      await updateDisplay()\n    }}\"\n    on:clickNewData=\"{newData}\"\n    interactifReady=\"{Boolean(\n      exercise?.interactifReady &&\n        !isCorrectionVisible &&\n        headerProps?.interactifReady,\n    )}\"\n    on:exerciseRemoved=\"{handleExerciseRemoved}\"\n  />\n\n  {#if isVisible}\n    <div class=\"flex flex-col-reverse lg:flex-row\">\n      <div\n        class=\"flex flex-col justify-start items-start relative {isSettingsVisible\n          ? 'w-full lg:w-3/4'\n          : 'w-full'} duration-500\"\n        id=\"exercice{exerciseIndex}\"\n      >\n        <div\n          class=\"print-hidden hidden md:flex flex-row justify-start text-coopmaths-struct dark:text-coopmathsdark-struct text-xs mt-2 pl-0 md:pl-2\"\n        >\n          <button\n            class=\"{columnsCount > 1 ? 'visible' : 'invisible'}\"\n            type=\"button\"\n            on:click=\"{() => {\n              columnsCount--\n              updateDisplay(false)\n            }}\"\n          >\n            <i\n              class=\" text-coopmaths-action hover:text-coopmaths-action-darkest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-darkest bx ml-2 bx-xs bx-minus\"\n            ></i>\n          </button>\n          <i class=\"bx ml-1 bx-xs bx-columns\"></i>\n          <button\n            type=\"button\"\n            on:click=\"{() => {\n              columnsCount++\n              updateDisplay(false)\n            }}\"\n          >\n            <i\n              class=\"text-coopmaths-action hover:text-coopmaths-action-darkest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-darkest bx ml-1 bx-xs bx-plus\"\n            ></i>\n          </button>\n        </div>\n        <article\n          class=\"lg:text-base relative\"\n          style=\"font-size: {(\n            $globalOptions.z || 1\n          ).toString()}rem; line-height: calc({$globalOptions.z || 1});\"\n        >\n          <div class=\"mt-6 mb-4\">\n            {#if typeof exercise.consigne !== 'undefined' && exercise.consigne.length !== 0}\n              <div>\n                <p\n                  class=\"mt-2 mb-2 ml-2 lg:mx-5 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n                >\n                  <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                  {@html mathaleaFormatExercice(exercise.consigne)}\n                </p>\n              </div>\n            {/if}\n            {#if exercise.introduction}\n              <div>\n                <p\n                  class=\"mt-2 mb-2 ml-2 lg:mx-5 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n                >\n                  <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                  {@html exercise.introduction}\n                </p>\n              </div>\n            {/if}\n          </div>\n          <div\n            style=\"columns: {columnsCount.toString()}\"\n            class=\"mt-4 lg:mt-6 mb-5\"\n          >\n            <ul\n              class=\"{exercise.listeQuestions.length === 1 ||\n              !exercise.listeAvecNumerotation\n                ? 'list-none'\n                : 'numbered-list'} w-full list-inside mb-2 mx-0 marker:text-coopmaths-struct dark:marker:text-coopmathsdark-struct marker:font-bold\"\n            >\n              {#each exercise.listeQuestions as item, i (i + '_' + (exercise.seed || ''))}\n                <div\n                  style=\"break-inside:avoid\"\n                  id=\"consigne{exerciseIndex}-{i}\"\n                  class=\"container w-full grid grid-cols-1 auto-cols-min gap-1 lg:gap-4 mb-2 lg:mb-4 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n                >\n                  <li\n                    id=\"exercice{exerciseIndex}Q{i}\"\n                    style=\"line-height: {exercise.spacing || 1}\"\n                  >\n                    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                    {@html mathaleaFormatExercice(item)}\n                  </li>\n                  {#if isCorrectionVisible}\n                    <!-- EE : remplacement de ce class pour celui du dessous class=\"relative border-l-coopmaths-struct dark:border-l-coopmathsdark-struct border-l-[3px] text-coopmaths-corpus dark:text-coopmathsdark-corpus mt-6 lg:mt-2 mb-6 py-2 pl-4\"  -->\n                    <div\n                      class=\"relative border-l-coopmaths-struct dark:border-l-coopmathsdark-struct border-l-[3px] text-coopmaths-corpus dark:text-coopmathsdark-corpus py-2 pl-4 mt-6 md:mt-4\"\n                      id=\"correction-exo{exerciseIndex}-Q{i}\"\n                    >\n                      <div\n                        class=\"{exercise.consigneCorrection.length !== 0\n                          ? 'container bg-coopmaths-canvas dark:bg-coopmathsdark-canvas-dark px-4 py-2 mr-2 ml-6 mb-2 font-light relative w-2/3'\n                          : 'hidden'}\"\n                      >\n                        <div\n                          class=\"{exercise.consigneCorrection.length !== 0\n                            ? 'container'\n                            : 'hidden'} absolute top-4 -left-4\"\n                        >\n                          <i\n                            class=\"bx bx-bulb scale-200 text-coopmaths-warn-dark dark:text-coopmathsdark-warn-dark\"\n                          ></i>\n                        </div>\n                        <div class=\"\">\n                          <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                          {@html exercise.consigneCorrection}\n                        </div>\n                      </div>\n                      <div\n                        class=\"container overflow-x-scroll overflow-y-hidden md:overflow-x-auto py-1\"\n                        style=\"line-height: {exercise.spacingCorr ||\n                          1}; break-inside:avoid\"\n                      >\n                        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                        {@html mathaleaFormatExercice(\n                          exercise.listeCorrections[i],\n                        )}\n                      </div>\n                      <!-- Avant le commit du 28/03/23, il y avait une mise en page plus complexe\n                      et cela posait problme au changement des paramtres avec la correction visible -->\n                      <!-- <div class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct top-0 left-0 border-b-[3px] w-10\" /> -->\n                      <div\n                        class=\"absolute flex flex-row py-[1.5px] px-3 rounded-t-md justify-center items-center -left-[3px] -top-[15px] bg-coopmaths-struct dark:bg-coopmathsdark-struct font-semibold text-xs text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n                      >\n                        Correction\n                      </div>\n                      <div\n                        class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct bottom-0 left-0 border-b-[3px] w-4\"\n                      ></div>\n                    </div>\n                  {/if}\n                </div>\n              {/each}\n            </ul>\n          </div>\n        </article>\n\n        {#if isInteractif && interactifReady && !isCorrectionVisible && isContentVisible}\n          <button\n            id=\"verif{exerciseIndex}\"\n            type=\"submit\"\n            on:click=\"{verifExercice}\"\n            bind:this=\"{buttonScore}\"\n            >Vrifier {numberOfAnswerFields > 1\n              ? 'les rponses'\n              : 'la rponse'}</button\n          >\n        {/if}\n        <div bind:this=\"{divScore}\"></div>\n      </div>\n      <Settings\n        exercice=\"{exercise}\"\n        bind:isVisible=\"{isSettingsVisible}\"\n        exerciceIndex=\"{exerciseIndex}\"\n        on:settings=\"{handleNewSettings}\"\n      />\n    </div>\n  {/if}\n</div>\n\n<style>\n  li {\n    break-inside: avoid;\n  }\n</style>\n","<script lang=\"ts\">\n  import type TypeExercice from '../../../../exercices/Exercice'\n  import ExerciceMathaleaVueEleve from './exerciceMathaleaVueEleve/ExerciceMathaleaVueEleve.svelte'\n  import ExerciceMathaleaVueProf from './exerciceMathaleaVueProf/ExerciceMathaleaVueProf.svelte'\n\n  export let vue: 'prof' | 'eleve'\n  export let exercise: TypeExercice\n  export let exerciseIndex: number\n  export let indiceLastExercice: number\n  export let isCorrectionVisible: boolean = false\n  export let toggleSidenav: (open: boolean) => void\n</script>\n\n{#if vue === 'prof'}\n  <ExerciceMathaleaVueProf\n    {exercise}\n    {exerciseIndex}\n    {indiceLastExercice}\n    {isCorrectionVisible}\n    {toggleSidenav}\n    on:exerciseRemoved\n  />\n{:else if vue === 'eleve'}\n  <ExerciceMathaleaVueEleve\n    {exercise}\n    {exerciseIndex}\n    {indiceLastExercice}\n    {isCorrectionVisible}\n  />\n{/if}\n","<script lang=\"ts\">\n  import { onDestroy, onMount } from 'svelte'\n  import HeaderExerciceVueProf from '../../shared/headerExerciceVueProf/HeaderExerciceVueProf.svelte'\n  import type TypeExercice from '../../../../../exercices/Exercice'\n  import HeaderExerciceVueEleve from '../shared/HeaderExerciceVueEleve.svelte'\n  import type { VueType } from '../../../../../lib/types'\n  import {\n    globalOptions,\n    isMenuNeededForExercises,\n  } from '../../../../../lib/stores/generalStore'\n  export let vue: VueType | undefined\n  export let exercise: TypeExercice\n  export let indiceExercice: number\n  export let indiceLastExercice: number\n\n  let divExercice: HTMLDivElement\n\n  const headerExerciceProps = {\n    title: exercise.titre,\n    id: '',\n    indiceExercice,\n    indiceLastExercice,\n    interactifReady: false,\n    randomReady: false,\n    settingsReady: false,\n    correctionReady: false,\n    isHidable: false,\n  }\n\n  onMount(async () => {\n    if (exercise.html != null) {\n      divExercice.appendChild(exercise.html)\n    }\n    const exercicesAffiches = new window.Event('addedToDom', { bubbles: true })\n    divExercice.children[0].dispatchEvent(exercicesAffiches)\n  })\n\n  onDestroy(() => {\n    if (exercise.destroy != null) {\n      exercise.destroy()\n    }\n  })\n\n  $: {\n    headerExerciceProps.indiceExercice = indiceExercice\n    headerExerciceProps.indiceLastExercice = indiceLastExercice\n  }\n</script>\n\n{#if vue === 'eleve'}\n  <HeaderExerciceVueEleve\n    {...headerExerciceProps}\n    isMenuNeededForExercises=\"{$isMenuNeededForExercises}\"\n    presMode=\"{$globalOptions.presMode ?? 'liste_exos'}\"\n  />\n{:else}\n  <HeaderExerciceVueProf {...headerExerciceProps} on:exerciseRemoved />\n{/if}\n<section id=\"insert-html-{indiceExercice}\" class=\"mt-6 mb-2 ml-2 lg:mx-5\">\n  <div bind:this=\"{divExercice}\"></div>\n</section>\n","<script lang=\"ts\">\n  import HeaderExerciceVueProf from '../../shared/headerExerciceVueProf/HeaderExerciceVueProf.svelte'\n  import { retrieveResourceFromUuid } from '../../../../../lib/components/refUtils'\n  import {\n    resourceHasPlace,\n    isStaticType,\n    type JSONReferentielObject,\n    isCrpeType,\n    isStaticWithoutPngUrl,\n  } from '../../../../../lib/types/referentiels'\n  /**\n   * Gestion du rfrentiel pour la recherche de l'uuid\n   */\n  import referentielStaticFR from '../../../../../json/referentielStaticFR.json'\n  import referentielStaticCH from '../../../../../json/referentielStaticCH.json'\n\n  import referentielBibliotheque from '../../../../../json/referentielBibliotheque.json'\n  import type { HeaderProps } from '../../../../../lib/types/ui'\n  // on rassemble les deux rfrentiel statique\n  const allStaticReferentiels: JSONReferentielObject = {\n    ...referentielBibliotheque,\n    ...referentielStaticFR,\n    ...referentielStaticCH,\n  }\n  // on supprime les entres par thme qui entrane des doublons\n  delete allStaticReferentiels['Brevet des collges par thme - APMEP']\n  delete allStaticReferentiels['BAC par thme - APMEP']\n  delete allStaticReferentiels['CRPE (2015-2019) par thme - COPIRELEM']\n  delete allStaticReferentiels['CRPE (2022-2023) par thme']\n  delete allStaticReferentiels['E3C par thme - APMEP']\n  delete allStaticReferentiels['EVACOM par thme']\n\n  export let uuid: string\n  export let indiceExercice: number\n  export let indiceLastExercice: number\n  export let zoomFactor: string\n  export let isSolutionAccessible: boolean\n  const foundResource = retrieveResourceFromUuid(allStaticReferentiels, uuid)\n  if (isStaticWithoutPngUrl(foundResource)) {\n    const [examen, filiere] = foundResource.uuid.split('_')\n    if (examen === 'eam') {\n    foundResource.png = `https://coopmaths.fr/alea/static/eam/${foundResource.annee}/tex/png/${foundResource.uuid}.png`\n    foundResource.pngCor = `https://coopmaths.fr/alea/static/eam/${foundResource.annee}/tex/png/${foundResource.uuid}_cor.png`\n    }\n    else if (examen === 'STL') {\n      foundResource.png = `https://coopmaths.fr/alea/static/stl/${foundResource.annee}/tex/png/${foundResource.uuid}.png`\n      foundResource.pngCor = `https://coopmaths.fr/alea/static/stl/${foundResource.annee}/tex/png/${foundResource.uuid}_cor.png`\n    } else {\n    foundResource.png = `https://coopmaths.fr/alea/static/${examen}/${foundResource.annee}/tex/png/${foundResource.uuid}.png`\n    foundResource.pngCor = `https://coopmaths.fr/alea/static/${examen}/${foundResource.annee}/tex/png/${foundResource.uuid}_cor.png`\n  }\n  console.log(foundResource)\n  }\n  const resourceToDisplay =\n    isStaticType(foundResource) || isCrpeType(foundResource)\n      ? { ...foundResource }\n      : null\n  const exercice =\n    resourceToDisplay === null\n      ? null\n      : {\n          png:\n            typeof resourceToDisplay.png === 'string'\n              ? [resourceToDisplay.png]\n              : resourceToDisplay.png,\n          pngCor:\n            typeof resourceToDisplay.pngCor === 'string'\n              ? [resourceToDisplay.pngCor]\n              : resourceToDisplay.pngCor,\n        }\n  let isCorrectionVisible = false\n  let isContentVisible = true\n  let headerExerciceProps: HeaderProps\n  if (resourceToDisplay !== null) {\n    headerExerciceProps = {\n      title: '',\n      id: '',\n      isInteractif: false,\n      settingsReady: false,\n      isSettingsVisible: false,\n      interactifReady: false,\n      indiceExercice,\n      indiceLastExercice,\n      randomReady: false,\n      correctionReady: isSolutionAccessible,\n    }\n    if (resourceHasPlace(resourceToDisplay)) {\n      headerExerciceProps.title = `${resourceToDisplay.typeExercice.toUpperCase()} ${\n        resourceToDisplay.mois || ''\n      } ${resourceToDisplay.annee} ${resourceToDisplay.lieu} ${resourceToDisplay.jour || ''} Ex ${resourceToDisplay.numeroInitial}`\n    } else {\n      headerExerciceProps.title = resourceToDisplay.uuid\n    }\n  }\n\n  let noCorrectionAvailable = false\n\n  function handleNoCorrectionAvailable() {\n    noCorrectionAvailable = true\n  }\n</script>\n\n<HeaderExerciceVueProf\n  {...headerExerciceProps}\n  {indiceExercice}\n  {indiceLastExercice}\n  on:clickCorrection=\"{(event) => {\n    isCorrectionVisible = event.detail.isCorrectionVisible\n  }}\"\n  on:clickVisible=\"{(event) => {\n    isContentVisible = event.detail.isVisible\n    isCorrectionVisible = event.detail.isVisible\n  }}\"\n  on:exerciseRemoved\n/>\n\n<div class=\"p-4\">\n  {#if isContentVisible}\n    {#if exercice}\n      {#each exercice.png as url}\n        <img\n          src=\"{url}\"\n          class=\"mb-6\"\n          style=\"width: calc(100% * {zoomFactor}\"\n          alt=\"nonc\"\n        />\n      {/each}\n    {/if}\n  {/if}\n\n  {#if isCorrectionVisible}\n    <div\n      class=\"relative border-l-coopmaths-struct dark:border-l-coopmathsdark-struct border-l-[3px] text-coopmaths-corpus dark:text-coopmathsdark-corpus mt-6 lg:mt-2 mb-6 py-2 pl-4\"\n      id=\"correction{indiceExercice}\"\n    >\n      <div class=\"container\">\n        {#if exercice}\n          {#each exercice.pngCor as url}\n            {#if noCorrectionAvailable}\n              <p class=\"text-red-500\">Aucune correction disponible</p>\n            {:else}\n              <img\n                src=\"{url}\"\n                class=\"p-2\"\n                style=\"width: calc(100% * {zoomFactor}\"\n                alt=\"correction\"\n                on:error=\"{handleNoCorrectionAvailable}\"\n              />\n            {/if}\n          {/each}\n        {/if}\n      </div>\n      <!-- <div class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct top-0 left-0 border-b-[3px] w-10\" /> -->\n      <div\n        class=\"absolute flex flex-row py-[1.5px] px-3 rounded-t-md justify-center items-center -left-[3px] -top-[15px] bg-coopmaths-struct dark:bg-coopmathsdark-struct font-semibold text-xs text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n      >\n        Correction\n      </div>\n      <div\n        class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct bottom-0 left-0 border-b-[3px] w-4\"\n      ></div>\n    </div>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { SvelteComponent, onMount } from 'svelte'\n  import Exercice from '../../../exercices/Exercice'\n  import { isStatic, isSvelte } from '../../../lib/components/exercisesUtils'\n  import {\n    getSvelteComponent,\n    mathaleaHandleParamOfOneExercice,\n    mathaleaLoadExerciceFromUuid,\n  } from '../../../lib/mathalea'\n  import { globalOptions } from '../../../lib/stores/generalStore'\n  import type { InterfaceParams } from '../../../lib/types'\n  import ExerciceMathalea from './exerciceMathalea/ExerciceMathalea.svelte'\n  import ExerciceHtml from './presentationalComponents/exerciceHtml/ExerciceHtml.svelte'\n  import ExerciceStatic from './presentationalComponents/exerciceStatic/ExerciceStatic.svelte'\n\n  export let paramsExercice: InterfaceParams\n  export let indiceExercice: number\n  export let indiceLastExercice: number\n  export let isCorrectionVisible = false\n  export let toggleSidenav: (open: boolean) => void\n\n  type ExerciseType =\n    | 'mathaleaVueProf'\n    | 'mathaleaVueEleve'\n    | 'static'\n    | 'html'\n    | 'svelte'\n\n  let exercise: Exercice\n  let exerciseType: ExerciseType\n  let ComponentExercice: typeof SvelteComponent<any>\n\n  onMount(async () => {\n    if (isStatic(paramsExercice.uuid)) {\n      exerciseType = 'static'\n    } else if (isSvelte(paramsExercice.uuid)) {\n      exerciseType = 'svelte'\n      ComponentExercice = await getSvelteComponent(paramsExercice)\n    } else {\n      exercise = await getExercise(paramsExercice)\n      exerciseType = await getExerciseType(exercise)\n    }\n  })\n\n  async function getExercise(\n    paramsExercice: InterfaceParams,\n  ): Promise<Exercice> {\n    const exercise = await mathaleaLoadExerciceFromUuid(paramsExercice.uuid)\n    exercise.numeroExercice = indiceExercice\n    mathaleaHandleParamOfOneExercice(exercise, paramsExercice)\n    if (paramsExercice.duration) exercise.duree = paramsExercice.duration\n    return exercise\n  }\n\n  async function getExerciseType(exercise: Exercice): Promise<ExerciseType> {\n    if (exercise.typeExercice && exercise.typeExercice.includes('html')) {\n      return 'html'\n    } else {\n      if (\n        $globalOptions.v === 'eleve' ||\n        $globalOptions.v === 'myriade' ||\n        $globalOptions.v === 'indices'\n      ) {\n        return 'mathaleaVueEleve'\n      } else {\n        return 'mathaleaVueProf'\n      }\n    }\n  }\n</script>\n\n{#if exerciseType === 'static'}\n  <ExerciceStatic\n    {indiceExercice}\n    {indiceLastExercice}\n    uuid=\"{paramsExercice.uuid}\"\n    zoomFactor=\"{$globalOptions.z ?? '1'}\"\n    isSolutionAccessible=\"{!!$globalOptions.isSolutionAccessible}\"\n    on:exerciseRemoved\n  />\n{:else if exerciseType === 'html'}\n  <ExerciceHtml\n    vue=\"{$globalOptions.v}\"\n    {exercise}\n    {indiceExercice}\n    {indiceLastExercice}\n    on:exerciseRemoved\n  />\n{:else if exerciseType === 'svelte'}\n  <svelte:component\n    this=\"{ComponentExercice}\"\n    {indiceExercice}\n    {indiceLastExercice}\n  />\n{:else if exerciseType === 'mathaleaVueEleve'}\n  <ExerciceMathalea\n    vue=\"eleve\"\n    {exercise}\n    exerciseIndex=\"{indiceExercice}\"\n    {indiceLastExercice}\n    {isCorrectionVisible}\n    {toggleSidenav}\n    on:exerciseRemoved\n  />\n{:else if exerciseType === 'mathaleaVueProf'}\n  <ExerciceMathalea\n    vue=\"prof\"\n    {exercise}\n    exerciseIndex=\"{indiceExercice}\"\n    {indiceLastExercice}\n    {isCorrectionVisible}\n    {toggleSidenav}\n    on:exerciseRemoved\n  />\n{/if}\n\n<style>\n</style>\n","<script lang=\"ts\">\n  import { resizeTags } from '../../../lib/components/sizeTools'\n  import { mathaleaUpdateUrlFromExercicesParams } from '../../../lib/mathalea'\n  import {\n    exercicesParams,\n    globalOptions,\n  } from '../../../lib/stores/generalStore'\n\n  export let size: 'xs' | 'sm' | 'md' | 'lg' | 'bx-sm md:bx-md' = 'sm'\n  export let isBorderTransparent: boolean = false\n\n  const urlParams = new URLSearchParams(window.location.search)\n  const z = urlParams.get('z')\n  let zoom: number = z ? Number.parseFloat(z) : 1\n\n  function zoomMinus() {\n    // zoom -= 0.1\n    zoom = Number.parseFloat((zoom - 0.1).toFixed(1))\n    updateSize()\n  }\n\n  function zoomPlus() {\n    // zoom += 0.1\n    zoom = Number.parseFloat((zoom + 0.1).toFixed(1))\n    updateSize()\n  }\n\n  function updateSize() {\n    globalOptions.update((params) => {\n      params.z = zoom.toString()\n      return params\n    })\n    // figures scratch\n    const scratchDivs = document.getElementsByClassName('scratchblocks')\n    for (const scratchDiv of scratchDivs) {\n      const svgDivs = scratchDiv.getElementsByTagName('svg')\n      resizeTags([...svgDivs], parseInt($globalOptions.z ?? '1'))\n    }\n    // QCM\n    const checkboxes = document.querySelectorAll('[id^=checkEx')\n    resizeTags([...checkboxes], parseInt($globalOptions.z ?? '1'))\n    mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n    // Event pour apiGeom\n    const zoomEvent = new CustomEvent('zoomChanged', {\n      detail: { zoom: $globalOptions.z },\n    })\n    document.dispatchEvent(zoomEvent)\n  }\n</script>\n\n<button\n  type=\"button\"\n  on:click=\"{zoomMinus}\"\n  class=\"tooltip tooltip-left tooltip-neutral\"\n  data-tip=\"Rduire la taille du texte\"\n>\n  <i\n    class=\"bx {size} rounded-full p-1 bx-minus border border-coopmaths-action hover:border-coopmaths-action-lightest bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmaths-action-lightest\n    {isBorderTransparent ? 'lg:border-transparent' : ''}\"\n  ></i>\n</button>\n<button\n  type=\"button\"\n  on:click=\"{zoomPlus}\"\n  class=\"tooltip tooltip-left tooltip-neutral\"\n  data-tip=\"Augmenter la taille du texte\"\n>\n  <i\n    class=\"bx {size} rounded-full p-1 bx-plus border border-coopmaths-action hover:border-coopmaths-action-lightest bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest dark:hover:text-coopmaths-action-lightest\n    {isBorderTransparent ? 'lg:border-transparent' : ''}\"\n  ></i>\n</button>\n","<script lang=\"ts\">\n  export let icon: string\n  export let title: string = ''\n  export let disabled: boolean = false\n  export let floatUnderText: string = ''\n  export let cornerIcon: string = ''\n  export let cornerIconClass: string = ''\n</script>\n\n<button\n  type=\"button\"\n  {title}\n  class=\"{$$props.class ||\n    ''} text-coopmaths-action dark:text-coopmathsdark-action\n    {disabled\n    ? 'text-opacity-10 dark:text-opacity-10'\n    : 'hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest'}\"\n  {disabled}\n  on:click\n>\n  <i class=\"relative bx {icon}\">\n    {#if floatUnderText !== ''}\n      <div\n        class=\"absolute left-1/2 -translate-x-1/2 -translate-y-2 text-sm font-extrabold font-sans\"\n      >\n        {floatUnderText}\n      </div>\n    {/if}\n    {#if cornerIcon !== ''}\n      <i\n        class=\"absolute -bottom-1 bx {cornerIcon} text-sm -translate-x-3\n        {cornerIconClass || 'text-coopmaths-warn dark:text-coopmathsdark-warn'}\"\n      ></i>\n    {/if}\n  </i>\n</button>\n","<script lang=\"ts\">\n  import ButtonIcon from './ButtonIcon.svelte'\n  export let icon: string\n  export let tooltip: string\n  export let tooltipPosition: 'auto' | 'top' | 'bottom' | 'left' | 'right' =\n    'bottom'\n  export let title: string = ''\n  export let disabled: boolean = false\n  export let floatUnderText: string = ''\n  export let cornerIcon: string = ''\n  export let cornerIconClass: string = ''\n</script>\n\n<!--  la diffrence de ButtonIcon qui est vraiment un bouton, ButtonIconTooltip est un div qui contient un bouton -->\n\n<div\n  class=\"tooltip tooltip-{tooltipPosition} tooltip-neutral\"\n  data-tip=\"{tooltip}\"\n>\n  <ButtonIcon\n    class=\"{$$props.class || ''}\"\n    {icon}\n    {title}\n    {disabled}\n    {floatUnderText}\n    {cornerIcon}\n    {cornerIconClass}\n    on:click\n  />\n</div>\n","<script lang=\"ts\">\n  import { mathaleaGoToView } from '../../../lib/mathalea'\n  import ButtonIconTooltip from '../forms/ButtonIconTooltip.svelte'\n\n  export let brandImagePath: string | null = null\n  export let productImagePath: string | null =\n    'assets/images/vendors/bordas/myriade-bordas-logo.png'\n  export let icon: string = 'bxs-cog'\n\n  function goToVueProf() {\n    window.history.replaceState({}, '', window.location.href)\n    mathaleaGoToView('')\n    window.history.replaceState({}, '', window.location.href)\n  }\n</script>\n\n<div\n  id=\"vendor-banner\"\n  class=\"flex flex-col items-center justify-center w-full px-2 lg:px-8 bg-coopmaths-canvas\"\n>\n  <div class=\"flex items-center justify-between w-full p-4\">\n    <img\n      src=\"assets/svg/logo_mathalea.svg\"\n      alt=\"D MathALA\"\n      class=\"h-7 lg:h-9\"\n    />\n    <div class=\"flex flex-row m-0 p-0 items-center justify-center space-x-3\">\n      <img class=\"h-6 lg:h-8\" src=\"{productImagePath}\" alt=\"Manual\" />\n      {#if brandImagePath}\n        <img class=\"h-6 lg:h-8\" src=\"{brandImagePath}\" alt=\"Brand\" />\n      {/if}\n    </div>\n    <ButtonIconTooltip\n      {icon}\n      tooltip=\"Accder aux rglages\"\n      class=\"hidden lg:block text-3xl\"\n      on:click=\"{goToVueProf}\"\n    />\n  </div>\n  <ButtonIconTooltip\n    {icon}\n    tooltip=\"Accder aux rglages\"\n    class=\"block lg:hidden text-3xl\"\n    on:click=\"{goToVueProf}\"\n  />\n</div>\n","<!--\n  @component\n  Permet de dessinner une flash card qui rvle la rponse on hover.\n  inspiration : https://jacky-ttt.medium.com/day156-css-card-flip-d25f102547bd\n  /!\\ si ne marche pas sur smartphone, essayer d'ajouter group-active:flip-rotate-y-180\n -->\n<div\n  class=\"{`${$$props.class || 'w-[420px] h-[300px]'} bg-transparent group perspective cursor-pointer`}\"\n>\n  <div\n    class=\"relative preserve-3d group-hover:flip-rotate-y-180 w-full h-full rounded-xl duration-1000 shadow-xl\"\n  >\n    <div\n      class=\"absolute backface-hidden w-full h-full flex justify-center items-center rounded-xl text-2xl border-2 bg-coopmaths-canvas text-coopmaths-corpus border-coopmaths-struct-lightest dark:bg-coopmathsdark-canvas dark:text-coopmathsdark-corpus dark:border-coopmathsdark-struct-lightest\"\n    >\n      <slot name=\"question\">Question</slot>\n    </div>\n    <div\n      class=\"absolute flip-rotate-y-180 backface-hidden w-full h-full flex justify-center items-center rounded-xl text-2xl font-light bg-coopmaths-canvas-dark text-coopmaths-corpus dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-corpus\"\n    >\n      <slot name=\"answer\">Rponse</slot>\n    </div>\n  </div>\n</div>\n","<script>\n</script>\n\n<footer\n  class=\"flex-1 w-full bg-coopmaths-canvas dark:bg-coopmathsdark-canvas h-12 flex justify-center bottom-0 opacity-100\"\n>\n  <a href=\"/\" target=\"_blank\">\n    <img\n      class=\"px-6\"\n      style=\"height: 30px\"\n      src=\"assets/images/logo2.png\"\n      alt=\"Logo Coopmaths 2\"\n    />\n  </a>\n</footer>\n","<script lang=\"ts\">\n  import { afterUpdate, beforeUpdate, onDestroy, onMount, tick } from 'svelte'\n  import type TypeExercice from '../../../exercices/Exercice'\n  import {\n    buildExercisesList,\n    splitExercisesIntoQuestions,\n  } from '../../../lib/components/exercisesUtils'\n  import {\n    getCanvasFont,\n    getTextWidth,\n    remToPixels,\n  } from '../../../lib/components/measures'\n  import { resizeContent } from '../../../lib/components/sizeTools'\n  import { verifQuestionCliqueFigure } from '../../../lib/interactif/cliqueFigure'\n  import { prepareExerciceCliqueFigure } from '../../../lib/interactif/gestionInteractif'\n  import { verifQuestionMathLive } from '../../../lib/interactif/mathLive'\n  import { verifQuestionQcm } from '../../../lib/interactif/qcm'\n  import { verifQuestionListeDeroulante } from '../../../lib/interactif/questionListeDeroulante'\n  import {\n    mathaleaFormatExercice,\n    mathaleaRenderDiv,\n    mathaleaUpdateExercicesParamsFromUrl,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../lib/mathalea'\n  import {\n    darkMode,\n    exercicesParams,\n    globalOptions,\n    isMenuNeededForExercises,\n    isMenuNeededForQuestions,\n    resultsByExercice,\n  } from '../../../lib/stores/generalStore'\n  import { vendor } from '../../../lib/stores/vendorStore'\n  import { loadMathLive } from '../../../modules/loaders'\n  import handleCapytale from '../../../lib/handleCapytale'\n  import Keyboard from '../../keyboard/Keyboard.svelte'\n  import { keyboardState } from '../../keyboard/stores/keyboardStore'\n  import Exercice from '../../shared/exercice/Exercice.svelte'\n  import ButtonTextAction from '../../shared/forms/ButtonTextAction.svelte'\n  import ButtonToggle from '../../shared/forms/ButtonToggle.svelte'\n  import BtnZoom from '../../shared/ui/btnZoom.svelte'\n  import Banner from '../../shared/vendors/Banner.svelte'\n  import FlipCard from './FlipCard.svelte'\n  import Footer2 from './Footer2.svelte'\n\n  let currentIndex: number = 0\n  let exercices: TypeExercice[] = []\n  let questions: string[] = []\n  let consignes: string[] = []\n  let corrections: string[] = []\n  let consignesCorrections: string[] = []\n  let indiceExercice: number[] = []\n  let indiceQuestionInExercice: number[] = []\n  const resultsByQuestion: boolean[] = []\n  const isDisabledButton: boolean[] = []\n  let isCorrectionVisible: boolean[] = []\n  const divsCorrection: HTMLDivElement[] = []\n  let currentWindowWidth: number = document.body.clientWidth\n  let eleveSection: HTMLElement\n  const brandImagePath = $vendor.brand.logoPath\n  const productImagePath = $vendor.product.logoPath\n\n  function urlToDisplay() {\n    const urlOptions = mathaleaUpdateExercicesParamsFromUrl()\n    globalOptions.update(() => {\n      urlOptions.v = 'eleve'\n      return urlOptions\n    })\n  }\n\n  /**\n   * Adaptation du titre des pages pour chaque exercice\n   * Plus le nombre d'exercices est lev, moins le titre contient de caractres\n   * @param {numer} dim largeur disponible  considrer pour le calcul si lment non dispo (dclenche le re-calcul)\n   * @param {number} nbOfExercises  nombre d'exercices\n   * @returns {string} titre\n   * @author sylvain\n   */\n  function buildExoTitle(dim: number, nbOfExercises: number) {\n    if ($globalOptions.presMode === 'liste_exos' || nbOfExercises === 0) {\n      return 'Exercice'\n    }\n    const navigationHeaderElt = document.getElementById('navigationHeaderID')\n    const exerciseTitleElt = document.getElementById('exerciseTitleID0')\n    // soit l'lment existe et on rcupre sa vraie largeur, soit on calcule une valeur approche\n    const roomForQuestionsTitles = navigationHeaderElt\n      ? navigationHeaderElt.offsetWidth\n      : ((dim - 2 * remToPixels(1)) * 11) / 12\n    const roomForOne =\n      roomForQuestionsTitles / nbOfExercises - 2 * remToPixels(1.5)\n    if (\n      roomForOne >=\n      getTextWidth(\n        'Exercice 10',\n        getCanvasFont(exerciseTitleElt ?? document.body),\n      )\n    ) {\n      if ($isMenuNeededForExercises) $isMenuNeededForExercises = false\n      return 'Exercice'\n    } else if (\n      roomForOne >=\n      getTextWidth('Ex 10', getCanvasFont(exerciseTitleElt ?? document.body)) +\n        20\n    ) {\n      if ($isMenuNeededForExercises) $isMenuNeededForExercises = false\n      return 'Ex'\n    } else if (\n      roomForOne >=\n      getTextWidth('10', getCanvasFont(exerciseTitleElt ?? document.body)) + 20\n    ) {\n      if ($isMenuNeededForExercises) $isMenuNeededForExercises = false\n      return ''\n    } else {\n      if (!$isMenuNeededForExercises) $isMenuNeededForExercises = true\n      return ''\n    }\n  }\n\n  $: exerciseTitle = buildExoTitle(currentWindowWidth, $exercicesParams.length)\n\n  /**\n   * Adaptation du titre des pages pour chaque question\n   * Plus le nombre de questions est lev, moins le titre contient de caractres\n   * @param {numer} dim largeur disponible  considrer pour le calcul si lment non dispo (dclenche le re-calcul)\n   * @param {number} nbOfQuestions  nombre de questions\n   * @returns {string} titre\n   * @author sylvain\n   */\n  function buildQuestionTitle(dim: number, nbOfQuestions: number) {\n    if ($globalOptions.presMode === 'liste_exos' || nbOfQuestions === 0) {\n      return 'Question'\n    }\n    const navigationHeaderElt = document.getElementById('navigationHeaderID')\n    const questionTitleElt = document.getElementById('questionTitleID0')\n    // soit l'lment existe et on rcupre sa vraie largeur, soit on calcule une valeur approche\n    const roomForQuestionsTitles = navigationHeaderElt\n      ? navigationHeaderElt.offsetWidth\n      : ((dim - 2 * remToPixels(1)) * 11) / 12\n    const roomForOne =\n      roomForQuestionsTitles / nbOfQuestions - 2 * remToPixels(0.5)\n    if (\n      roomForOne >=\n      getTextWidth(\n        'Question 10',\n        getCanvasFont(questionTitleElt ?? document.body),\n      )\n    ) {\n      $isMenuNeededForQuestions = false\n      return 'Question'\n    } else if (\n      roomForOne >=\n      getTextWidth('Q 10', getCanvasFont(questionTitleElt ?? document.body)) +\n        20\n    ) {\n      $isMenuNeededForQuestions = false\n      return 'Q'\n    } else if (\n      roomForOne >=\n      getTextWidth('10', getCanvasFont(questionTitleElt ?? document.body)) + 20\n    ) {\n      $isMenuNeededForQuestions = false\n      return ''\n    } else {\n      $isMenuNeededForQuestions = true\n      return ''\n    }\n  }\n\n  $: questionTitle = buildQuestionTitle(currentWindowWidth, questions.length)\n\n  function log(str: string) {\n    const debug = false\n    if (debug) {\n      console.info(str)\n    }\n  }\n\n  beforeUpdate(() => {\n    log('before eleve')\n  })\n\n  afterUpdate(() => {\n    log('after eleve')\n\n    // Evnement indispensable pour pointCliquable par exemple\n    const exercicesAffiches = new window.Event('exercicesAffiches', {\n      bubbles: true,\n    })\n    document.dispatchEvent(exercicesAffiches)\n    if (eleveSection) {\n      const params = $globalOptions\n      const zoom = Number(params.z) ?? 1\n      resizeContent(eleveSection, zoom)\n    }\n  })\n\n  let resizeObserver: ResizeObserver\n  onMount(async () => {\n    log('mount eleve')\n    // Si presMode est undefined cela signifie que l'on charge cet url\n    // sinon en venant du modal il existerait\n    if ($globalOptions.presMode === undefined) {\n      const urlOptions = mathaleaUpdateExercicesParamsFromUrl()\n      urlOptions.v = 'eleve'\n      globalOptions.update(() => {\n        return urlOptions\n      })\n      urlToDisplay()\n    } else {\n      // Si ce n'est pas un chargement d'url alors il faut initialiser le store des rsultats\n      if ($resultsByExercice.length > 0) {\n        resultsByExercice.update(() => [])\n      }\n    }\n    if ($globalOptions.setInteractive === '1') {\n      for (const param of $exercicesParams) {\n        if (param.interactif !== '1') {\n          param.interactif = '1'\n        }\n      }\n    }\n\n    if ($globalOptions.presMode === 'une_question_par_page') {\n      /** Charge les exercices\n       * MGU : pas besoin de charger les exos si ce n'est pas des questions,\n       * car c'est le composant qui affiche l'exo qui le charge\n       * DONC UNIQUEMENT SI ON EST EN MODE UNE QUESTION PAR PAGE!\n       */\n      exercices = await Promise.all(buildExercisesList())\n\n      // construit les questions\n      buildQuestions()\n    }\n\n    if (\n      $globalOptions.recorder === 'capytale' ||\n      $globalOptions.recorder === 'moodle' ||\n      $globalOptions.recorder === 'anki' ||\n      $globalOptions.recorder === 'labomep'\n    ) {\n      // attend la fin de la mise  jour pour mettre l'observer\n      await tick()\n\n      /*\n      Ce code est ncessaire seulement si coopmaths est intgr dans un autre site pour permettre de redimensionner la fentre\n      */\n      resizeObserver = new ResizeObserver((x) => {\n        const url = new URL(window.location.href)\n        const iframe = url.searchParams.get('iframe')\n        window.parent.postMessage(\n          {\n            hauteurExercice: x[0].contentRect.height,\n            action: 'mathalea:resize',\n            iframe,\n          },\n          '*',\n        )\n        // ou x[0].contentRect.height ou x[0].contentBoxSize[0].blockSize ou x[0].borderBoxSize[0].inlineSize ou x[0].target.scrollHeight\n      })\n      if (eleveSection != null) resizeObserver.observe(eleveSection)\n    }\n\n    if ($globalOptions.recorder === 'capytale') {\n      $globalOptions.isInteractiveFree = false\n      console.log('[ELEVE]  Appel de handleCapytale()...')\n      handleCapytale()\n    }\n    log('fin mount eleve')\n  })\n\n  onDestroy(() => {\n    if (resizeObserver) resizeObserver.disconnect()\n  })\n\n  async function buildQuestions() {\n    const splitResults = splitExercisesIntoQuestions(exercices)\n    questions = [...splitResults.questions]\n    consignes = [...splitResults.consignes]\n    corrections = [...splitResults.corrections]\n    consignesCorrections = [...splitResults.consignesCorrections]\n    isCorrectionVisible = [...splitResults.isCorrectionVisible]\n    indiceExercice = [...splitResults.indiceExercice]\n    indiceQuestionInExercice = [...splitResults.indiceQuestionInExercice]\n    if ($globalOptions.presMode === 'une_question_par_page') {\n      // Pour les autres mode de prsentation, cela est gr par ExerciceMathaleaVueProf\n      mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n      await tick()\n      const body = document.querySelector<HTMLElement>('body')\n      if (body) {\n        mathaleaRenderDiv(body)\n      }\n      loadMathLive()\n    }\n    const section = document.querySelector('section') as HTMLElement\n    const hauteurExercice = section.scrollHeight\n    const url = new URL(window.location.href)\n    const iframe = url.searchParams.get('iframe')\n    window.parent.postMessage(\n      {\n        hauteurExercice,\n        exercicesParams: $exercicesParams,\n        action: 'mathalea:init',\n        iframe,\n      },\n      '*',\n    )\n  }\n\n  async function checkQuestion(i: number) {\n    // ToFix exercices custom avec pointsCliquable\n    const exercice = exercices[indiceExercice[i]]\n    let type =\n      exercice.autoCorrection[indiceQuestionInExercice[i]]?.reponse?.param\n        ?.formatInteractif\n    if (type === undefined || type === null) {\n      type = exercice.interactifType\n    }\n    if (type == null) {\n      // @fixme on ne devrait jamais arriver ici pour un exercice non interactif !\n      window.notify(\n        'checkQuestion a t appel pour un exercice non interactif',\n        {\n          exercice: exercice.uuid,\n        },\n      )\n      resultsByQuestion[i] = false\n      return\n    }\n    if (type.toLowerCase() === 'mathlive') {\n      const resu = verifQuestionMathLive(\n        exercices[indiceExercice[i]],\n        indiceQuestionInExercice[i],\n      )\n      resultsByQuestion[i] = resu.isOk === 'Ok' || resu.isOk === true\n    } else if (type === 'qcm') {\n      resultsByQuestion[i] =\n        verifQuestionQcm(\n          exercices[indiceExercice[i]],\n          indiceQuestionInExercice[i],\n        ) === 'OK'\n    } else if (type === 'listeDeroulante') {\n      resultsByQuestion[i] =\n        verifQuestionListeDeroulante(\n          exercices[indiceExercice[i]],\n          indiceQuestionInExercice[i],\n        ) === 'OK'\n    } else if (type === 'cliqueFigure') {\n      resultsByQuestion[i] =\n        verifQuestionCliqueFigure(\n          exercices[indiceExercice[i]],\n          indiceQuestionInExercice[i],\n        ) === 'OK'\n    } else if (type === 'custom') {\n      // si le typ est `custom` on est sr que `correctionInteractive` existe\n      // d'o le ! aprs `correctionInteractive`\n      resultsByQuestion[i] =\n        exercices[indiceExercice[i]].correctionInteractive!(\n          indiceQuestionInExercice[i],\n        ) === 'OK'\n    }\n    isDisabledButton[i] = true\n    isCorrectionVisible[i] = true\n    await tick()\n    const feedback = document.querySelector<HTMLElement>(\n      `#feedbackEx${indiceExercice[i]}Q${indiceQuestionInExercice[i]}`,\n    )\n    // ncessaire pour le feedback\n    if (feedback !== null && feedback !== undefined) mathaleaRenderDiv(feedback)\n    mathaleaRenderDiv(divsCorrection[i])\n  }\n\n  async function switchCorrectionVisible(i: number) {\n    isCorrectionVisible[i] = !isCorrectionVisible[i]\n    if (isCorrectionVisible[i]) {\n      await tick()\n      mathaleaRenderDiv(divsCorrection[i])\n    }\n  }\n\n  async function handleIndexChange(exoNum: number) {\n    currentIndex = exoNum\n    if ($globalOptions.presMode === 'une_question_par_page') {\n      await tick() // MGU attendre que le div soit affich avant de mettre  jour la question\n      const exo = exercices[indiceExercice[exoNum]]\n      const questionEvent = new CustomEvent('questionDisplay', {\n        detail: {\n          uuid: exo.uuid,\n          exoNumber: indiceExercice[exoNum],\n          questionNumber: exoNum,\n        },\n      })\n      document.dispatchEvent(questionEvent)\n      if (exo && exo.interactifType === 'cliqueFigure' && exo.interactif) {\n        prepareExerciceCliqueFigure(exo)\n      }\n    } else if ($globalOptions.presMode === 'un_exo_par_page') {\n      await tick() // MGU attendre que le div soit affich avant de mettre  jour la question\n      const exo = $exercicesParams[exoNum]\n      const questionEvent = new CustomEvent('questionDisplay', {\n        detail: {\n          uuid: exo.uuid,\n          exoNumber: exoNum,\n          questionNumber: null,\n        },\n      })\n      document.dispatchEvent(questionEvent)\n    }\n  }\n</script>\n\n<svelte:window bind:innerWidth=\"{currentWindowWidth}\" />\n<section\n  bind:this=\"{eleveSection}\"\n  class=\"relative flex flex-col min-h-screen min-w-screen bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-corpus dark:text-coopmathsdark-corpus {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  {#if $globalOptions.v === 'myriade' || $globalOptions.v === 'indices'}\n    <Banner {brandImagePath} {productImagePath} />\n  {/if}\n  <div\n    class=\"fixed z-20 h-16 bottom-4 right-2 {(typeof $globalOptions.title ===\n      'string' &&\n      $globalOptions.title.length === 0 &&\n      $globalOptions.presMode === 'liste_exos') ||\n    ($globalOptions.title != null && $globalOptions.title.length > 0)\n      ? 'lg:top-8'\n      : 'lg:top-20'}  lg:right-6\"\n  >\n    <div\n      class=\"flex flex-col-reverse lg:flex-row space-y-reverse space-y-4 lg:space-y-0 lg:space-x-4 scale-75 lg:scale-100\n      {$globalOptions.v === 'myriade' || $globalOptions.v === 'indices'\n        ? 'translate-y-16'\n        : ''}\"\n    >\n      <BtnZoom\n        size=\"bx-sm md:bx-md\"\n        isBorderTransparent=\"{typeof $globalOptions.title === 'string' &&\n          $globalOptions.title.length > 0}\"\n      />\n    </div>\n  </div>\n  <div class=\"mb-auto\">\n    <div\n      class=\"{typeof $globalOptions.title === 'string' &&\n      $globalOptions.title.length === 0 &&\n      $globalOptions.presMode === 'liste_exos'\n        ? 'hidden'\n        : 'h-[10%]'}  w-full flex flex-col justify-center items-center\"\n    >\n      <!-- titre de la feuille -->\n      {#if typeof $globalOptions.title === 'string' && $globalOptions.title.length > 0}\n        <div\n          class=\"w-full p-8 text-center text-4xl font-light {$globalOptions.recorder ===\n          'capytale'\n            ? 'bg-black'\n            : 'bg-coopmaths-struct'} dark:bg-coopmathsdark-struct text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n        >\n          {$globalOptions.title}\n        </div>\n      {/if}\n      <!-- barre de navigation -->\n      <div\n        id=\"navigationHeaderID\"\n        class=\"grid justify-items-center w-full mt-4 mb-8 grid-cols-{$globalOptions.presMode ===\n        'un_exo_par_page'\n          ? $exercicesParams.length\n          : questions.length}\n          {($globalOptions.presMode === 'un_exo_par_page' &&\n          !$isMenuNeededForExercises) ||\n        ($globalOptions.presMode === 'une_question_par_page' &&\n          !$isMenuNeededForQuestions)\n          ? 'border-b-2 border-coopmaths-struct'\n          : 'border-b-0'}\n              bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-struct dark:text-coopmathsdark-struct\"\n      >\n        {#if $globalOptions.presMode === 'un_exo_par_page' && !$isMenuNeededForExercises}\n          {#each $exercicesParams as paramsExercice, i (paramsExercice)}\n            <div class=\"\">\n              <button\n                class=\"relative group {currentIndex === i\n                  ? 'border-b-4'\n                  : 'border-b-0'} border-coopmaths-struct dark:border-coopmathsdark-struct text-coopmaths-action hover:text-coopmaths-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-lightest\"\n                disabled=\"{currentIndex === i}\"\n                on:click=\"{() => handleIndexChange(i)}\"\n              >\n                <div\n                  id=\"exerciseTitleID{i}\"\n                  class=\"pt-2 pb-4 px-6 text-xl font-light\"\n                >\n                  {exerciseTitle}\n                  {i + 1}\n                  {#if $resultsByExercice[i] !== undefined}\n                    <div\n                      style=\"--nbPoints:{$resultsByExercice[i]\n                        .bestScore}; --nbQuestions:{$resultsByExercice[i]\n                        .numberOfQuestions};\"\n                      class=\"absolute bottom-0 left-0 right-0 mx-auto text-xs font-bold progressbar dark:progressbardark text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n                    >\n                      {$resultsByExercice[i].bestScore +\n                        '/' +\n                        $resultsByExercice[i].numberOfQuestions}\n                    </div>\n                  {/if}\n                </div>\n                <span\n                  class=\"absolute -bottom-1 left-1/2 w-0 h-1 bg-coopmaths-struct group-hover:w-1/2 group-hover:transition-all duration-300 ease-out group-hover:ease-in group-hover:duration-300\"\n                ></span>\n                <span\n                  class=\"absolute -bottom-1 right-1/2 w-0 h-1 bg-coopmaths-struct group-hover:w-1/2 group-hover:transition-all duration-300 ease-out group-hover:ease-in group-hover:duration-300\"\n                ></span>\n              </button>\n            </div>\n          {/each}\n        {/if}\n        {#if $globalOptions.presMode === 'une_question_par_page' && !$isMenuNeededForQuestions}\n          {#each questions as question, i (i + '_' + question)}\n            <div class=\"\">\n              <button\n                class=\"relative group {currentIndex === i\n                  ? 'border-b-4'\n                  : 'border-b-0'} border-coopmaths-struct dark:border-coopmathsdark-struct text-coopmaths-action hover:text-coopmaths-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-lightest\"\n                disabled=\"{currentIndex === i}\"\n                on:click=\"{() => handleIndexChange(i)}\"\n              >\n                <div\n                  id=\"questionTitleID{i}\"\n                  class=\"py-2 px-2 text-xl font-light\"\n                >\n                  {questionTitle}\n                  {i + 1}\n                  {#if $resultsByExercice[i] !== undefined}\n                    <div\n                      class=\"absolute left-0 right-0 mx-auto bottom-1 h-2 w-2 rounded-full bg-coopmaths-warn\n                      {resultsByQuestion[i] === true ? '' : 'invisible'}\"\n                    ></div>\n                    <div\n                      class=\"absolute left-0 right-0 mx-auto bottom-1 h-2 w-2 rounded-full bg-red-600\n                      {resultsByQuestion[i] === false ? '' : 'invisible'}\"\n                    ></div>\n                  {/if}\n                </div>\n                <span\n                  class=\"absolute -bottom-1 left-1/2 w-0 h-1 bg-coopmaths-struct group-hover:w-1/2 group-hover:transition-all duration-300 ease-out group-hover:ease-in group-hover:duration-300\"\n                ></span>\n                <span\n                  class=\"absolute -bottom-1 right-1/2 w-0 h-1 bg-coopmaths-struct group-hover:w-1/2 group-hover:transition-all duration-300 ease-out group-hover:ease-in group-hover:duration-300\"\n                ></span>\n              </button>\n            </div>\n          {/each}\n        {/if}\n      </div>\n    </div>\n    <!-- Exercices -->\n    <div class=\"px-2 lg:px-8\">\n      {#if $globalOptions.presMode === 'un_exo_par_page'}\n        {#each $exercicesParams as paramsExercice, i (paramsExercice)}\n          <div class=\"flex flex-col\">\n            <div class=\"{$isMenuNeededForExercises ? '' : 'hidden'}\">\n              <button\n                class=\"w-full {currentIndex === i\n                  ? 'bg-coopmaths-canvas-darkest'\n                  : 'bg-coopmaths-canvas-dark'} hover:bg-coopmaths-canvas-darkest text-coopmaths-action hover:text-coopmaths-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-lightest\"\n                disabled=\"{currentIndex === i}\"\n                on:click=\"{() => handleIndexChange(i)}\"\n              >\n                <div\n                  id=\"exerciseTitleID2{i}\"\n                  class=\"flex flex-row items-center justify-center py-3 px-2 text-2xl font-bold\"\n                >\n                  Exercice {i + 1}\n                  {#if $resultsByExercice[i] !== undefined}\n                    <div\n                      class=\"ml-4 text-sm font-bold text-coopmaths-warn-dark dark:text-coopmathsdark-warn-dark\"\n                    >\n                      {$resultsByExercice[i].numberOfPoints +\n                        '/' +\n                        $resultsByExercice[i].numberOfQuestions}\n                    </div>\n                  {:else}\n                    <div class=\"ml-4 text-sm font-bold invisible\">8/8</div>\n                  {/if}\n                </div>\n              </button>\n            </div>\n            <div class=\"{currentIndex === i ? '' : 'hidden'}\">\n              <Exercice\n                {paramsExercice}\n                indiceExercice=\"{i}\"\n                indiceLastExercice=\"{$exercicesParams.length - 1}\"\n                isCorrectionVisible=\"{isCorrectionVisible[i]}\"\n                toggleSidenav=\"{() => {}}\"\n              />\n            </div>\n          </div>\n        {/each}\n      {:else if $globalOptions.presMode === 'liste_exos'}\n        <div\n          id=\"exercises-list\"\n          class=\"p-4 columns-1 {$globalOptions.twoColumns\n            ? 'md:columns-2'\n            : ''}\"\n        >\n          {#each $exercicesParams as paramsExercice, i (paramsExercice)}\n            <div class=\"break-inside-avoid-column\">\n              <Exercice\n                {paramsExercice}\n                indiceExercice=\"{i}\"\n                indiceLastExercice=\"{$exercicesParams.length - 1}\"\n                isCorrectionVisible=\"{isCorrectionVisible[i]}\"\n                toggleSidenav=\"{() => {}}\"\n              />\n            </div>\n          {/each}\n        </div>\n      {:else if $globalOptions.presMode === 'recto' || $globalOptions.presMode === 'verso'}\n        <div\n          id=\"exercises-list\"\n          class=\"p-4 columns-1 {$globalOptions.twoColumns\n            ? 'md:columns-2'\n            : ''}\"\n        >\n          {#each $exercicesParams as paramsExercice, i (paramsExercice)}\n            <div class=\"break-inside-avoid-column\">\n              <Exercice\n                {paramsExercice}\n                indiceExercice=\"{i}\"\n                indiceLastExercice=\"{$exercicesParams.length - 1}\"\n                isCorrectionVisible=\"{$globalOptions.presMode === 'verso'}\"\n                toggleSidenav=\"{() => {}}\"\n              />\n            </div>\n          {/each}\n        </div>\n      {:else if $globalOptions.presMode === 'une_question_par_page'}\n        <div>\n          {#each questions as question, k (k + '_' + question)}\n            <div class=\"flex flex-col\">\n              <div class=\"{$isMenuNeededForQuestions ? '' : 'hidden'}\">\n                <button\n                  class=\"group w-full {currentIndex === k\n                    ? 'bg-coopmaths-canvas-darkest'\n                    : 'bg-coopmaths-canvas-dark'} hover:bg-coopmaths-canvas-darkest text-coopmaths-action hover:text-coopmaths-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-lightest\"\n                  disabled=\"{currentIndex === k}\"\n                  on:click=\"{() => handleIndexChange(k)}\"\n                >\n                  <div\n                    id=\"questionTitleID2{k}\"\n                    class=\"flex flex-row items-center justify-center py-3 px-2 text-xl font-bold\"\n                  >\n                    Question {k + 1}\n                    <div\n                      class=\"relative ml-2 h-2 w-2 rounded-full {currentIndex ===\n                      k\n                        ? 'bg-coopmaths-canvas-darkest'\n                        : 'bg-coopmaths-canvas-dark'} group-hover:bg-coopmaths-canvas-darkest\"\n                    >\n                      {#if $resultsByExercice[k] !== undefined}\n                        <div\n                          class=\"absolute h-2 w-2 rounded-full bg-coopmaths-warn {resultsByQuestion[\n                            k\n                          ] === true\n                            ? ''\n                            : 'hidden'}\"\n                        ></div>\n                        <div\n                          class=\"absolute h-2 w-2 rounded-full bg-red-600 {resultsByQuestion[\n                            k\n                          ] === false\n                            ? ''\n                            : 'hidden'}\"\n                        ></div>\n                      {/if}\n                    </div>\n                  </div>\n                </button>\n              </div>\n              <div\n                class=\"{currentIndex === k ? '' : 'hidden'}\"\n                id=\"{`exercice${indiceExercice[k]}Q${k}`}\"\n              >\n                <div\n                  class=\"pb-4 flex flex-col items-start justify-start relative {isMenuNeededForQuestions\n                    ? 'lg:mt-2'\n                    : ''}\"\n                >\n                  <div\n                    class=\"container grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-10\"\n                    style=\"font-size: {($globalOptions.z || 1).toString()}rem\"\n                  >\n                    <div class=\"flex flex-col my-2 py-2\">\n                      <div class=\"text-coopmaths-corpus pl-2\">\n                        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                        {@html consignes[k]}\n                      </div>\n                      <div class=\"text-coopmaths-corpus pl-2\">\n                        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                        {@html question}\n                      </div>\n                    </div>\n                    {#if isCorrectionVisible[k]}\n                      <div\n                        class=\"relative border-l-coopmaths-struct dark:border-l-coopmathsdark-struct border-l-[3px] text-coopmaths-corpus dark:text-coopmathsdark-corpus mt-2 lg:{$isMenuNeededForQuestions\n                          ? 'mt-6'\n                          : 'mt-2'} mb-6 py-2 pl-4\"\n                        style=\"break-inside:avoid\"\n                        bind:this=\"{divsCorrection[k]}\"\n                      >\n                        {#if consignesCorrections[k].length !== 0}\n                          <div\n                            class=\"container bg-coopmaths-canvas dark:bg-coopmathsdark-canvas-dark px-4 py-2 mr-2 ml-6 mb-2 font-light relative w-2/3\"\n                          >\n                            <div class=\"container absolute top-4 -left-4\">\n                              <i\n                                class=\"bx bx-bulb scale-200 text-coopmaths-warn-dark dark:text-coopmathsdark-warn-dark\"\n                              ></i>\n                            </div>\n                            <div class=\"\">\n                              <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                              {@html consignesCorrections[k]}\n                            </div>\n                          </div>\n                        {/if}\n                        <div\n                          class=\"container overflow-x-auto overflow-y-hidden md:overflow-x-auto\"\n                          style=\"break-inside:avoid\"\n                        >\n                          <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                          {@html mathaleaFormatExercice(corrections[k])}\n                        </div>\n                        <!-- <div class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct top-0 left-0 border-b-[3px] w-10\" /> -->\n                        <div\n                          class=\"absolute flex flex-row py-[1.5px] px-3 rounded-t-md justify-center items-center -left-[3px] -top-[15px] bg-coopmaths-struct dark:bg-coopmathsdark-struct font-semibold text-xs text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n                        >\n                          Correction\n                        </div>\n                        <div\n                          class=\"absolute border-coopmaths-struct dark:border-coopmathsdark-struct bottom-0 left-0 border-b-[3px] w-4\"\n                        ></div>\n                      </div>\n                    {/if}\n                  </div>\n                  {#if exercices[indiceExercice[k]].interactif}\n                    <div class=\"pb-4 mt-10\">\n                      <ButtonTextAction\n                        text=\"Vrifier\"\n                        on:click=\"{() => checkQuestion(k)}\"\n                        disabled=\"{isDisabledButton[k]}\"\n                      />\n                    </div>\n                  {:else if $globalOptions.isSolutionAccessible}\n                    <div class=\"{$isMenuNeededForExercises ? 'ml-4' : ''}\">\n                      <ButtonToggle\n                        titles=\"{[\n                          'Voir la correction',\n                          'Masquer la correction',\n                        ]}\"\n                        on:toggle=\"{() => switchCorrectionVisible(k)}\"\n                      />\n                    </div>\n                  {/if}\n                </div>\n              </div>\n            </div>\n          {/each}\n        </div>\n      {:else if $globalOptions.presMode === 'cartes'}\n        <div\n          class=\"grid grid-flow-row gri-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 auto-rows-auto gap-6\"\n        >\n          {#each questions as question, k (k + '_' + question)}\n            <FlipCard>\n              <div slot=\"question\">\n                <div class=\"p-2\">\n                  <div class=\"text-coopmaths-corpus pl-2\">\n                    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                    {@html consignes[k]}\n                  </div>\n                  <div class=\"text-coopmaths-corpus pl-2\">\n                    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                    {@html question}\n                  </div>\n                </div>\n              </div>\n              <div slot=\"answer\">\n                <div class=\"p-2\">\n                  <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n                  {@html mathaleaFormatExercice(corrections[k])}\n                </div>\n              </div>\n            </FlipCard>\n          {/each}\n        </div>\n      {/if}\n    </div>\n  </div>\n  <Keyboard />\n  {#if $globalOptions.v !== 'myriade' && $globalOptions.v !== 'indices'}\n    <div\n      class=\"flex justify-center w-full {$keyboardState.isVisible\n        ? 'mt-52'\n        : ''}\"\n    >\n      <Footer2 />\n    </div>\n  {/if}\n</section>\n\n<style>\n  /* sur une ide de Mathieu Degrange */\n  .progressbar {\n    background: linear-gradient(\n      90deg,\n      #6ebc1f 0%,\n      #6ebc1f calc(100% / var(--nbQuestions) * var(--nbPoints)),\n      #d43d0e calc(100% / var(--nbQuestions) * var(--nbPoints)),\n      #d43d0e 100%\n    );\n  }\n  .progressbardark {\n    background: linear-gradient(\n      90deg,\n      #ff94d1 0%,\n      #ff94d1 calc(100% / var(--nbQuestions) * var(--nbPoints)),\n      #ff9523 calc(100% / var(--nbQuestions) * var(--nbPoints)),\n      #ff9523 100%\n    );\n  }\n</style>\n","<script lang=\"ts\">\n  export let subtitle: string = ''\n  export let type: 'export' | 'design' = 'export'\n</script>\n\n<!--\n  @component\n  Sous-titre du header de NavBarV2\n\n  __Paramtres__ :\n\n  * `subtitle` :  titre du groupe de boutons\n  * `type`: `export`(dfaut) ou `design`\n\n  __Exemple__ :\n\n    ```tsx\n  <NavBarV2Subtitle\n    subtitle = \"Mon sous-titre\"\n    type = \"design\"\n  />\n  ```\n -->\n<div\n  class=\"flex flex-row items-center align-middle font-logo9 tracking-tighter ml-4\n  pt-6 md:pt-0\n  text-lg md:text-3xl xl:text-5xl\"\n>\n  <div\n    class=\"font-light\n    pl-0 md:pl-10\n    text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-lightest\"\n  >\n    <i\n      class=\"{type === 'export'\n        ? 'bx bx-export rotate-90 md:translate-y-1'\n        : 'hidden'}\"\n    ></i>\n    <i\n      class=\"{type === 'design'\n        ? 'bx bx-chevron-right md:translate-y-1'\n        : 'hidden'}\"\n    ></i>\n  </div>\n  <div\n    class=\"font-black\n    ml-1 md:ml-3 xl:ml-5\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    {subtitle}\n  </div>\n</div>\n","import type { Language, LanguageDisplay } from '../types/languages'\nimport refToUuidCH from '../../json/refToUuidCH.json'\nimport refToUuidFR from '../../json/refToUuidFR.json'\n\ntype ValueOf<T> = T[keyof T]\nconst REFERENCES_TO_UUIDS_CH = { ...refToUuidCH } as const\nconst REFERENCES_TO_UUIDS_FR = { ...refToUuidFR } as const\ntype ReferencesCH = keyof typeof REFERENCES_TO_UUIDS_CH\ntype UuidsCH = ValueOf<typeof REFERENCES_TO_UUIDS_CH> // on devrait avoir des uuid mais on a que des string :-(\ntype ReferencesFR = keyof typeof REFERENCES_TO_UUIDS_FR\ntype UuidsFR = ValueOf<typeof REFERENCES_TO_UUIDS_FR>\ntype RefUuidPairs =\n  | Record<ReferencesCH, UuidsCH>\n  | Record<ReferencesFR, UuidsFR>\n\nconst allReferencesToUuids: Record<Language, RefUuidPairs> = {\n  'fr-FR': REFERENCES_TO_UUIDS_FR,\n  'fr-CH': REFERENCES_TO_UUIDS_CH,\n}\n\n/**\n * Objet pour associer les lments  afficher au langage slectionn\n */\nexport const languages: LanguageDisplay = {\n  'fr-FR': {\n    short: 'FR',\n    long: 'franais',\n    country: 'France',\n  },\n  'fr-CH': {\n    short: 'CH',\n    long: 'suisse',\n    country: 'Suisse',\n  },\n}\n\n/**\n * Retourne le drapeau correspondant  une langue (symbole alpha ISO du pays)\n * @param country langue slectionne\n * @returns le chemin vers le drapeau correspondant  une langue\n */\nexport const buildLangIconPath = (country: string): string => {\n  if (country.length !== 2) {\n    throw new Error(\n      `ISO country name \"${country}\" should have exactly two characters.`,\n    )\n  } else {\n    return `assets/svg/flags/${country.toLowerCase()}.svg`\n  }\n}\n\n/**\n * Recherche dans le rfrentiel de la langue slectionne si un UUID existe.\n * - si oui, on renvoie la rfrence correspondante\n * - si non, on renvoie la rfrence franaise\n * - si aucune correspondance n'est trouve, on renvoie une chane vide.\n * @param uuid uuid  cherche\n * @param locale langue slectionne sur le site\n * @returns la rfrence correspondant  l'UUID dans le rfrentiel local/franais\n */\nexport const uuidToLocaleRef = (\n  uuid: string,\n  locale: Language = 'fr-FR',\n): string => {\n  let reference = ''\n  if (locale !== 'fr-FR') {\n    // on regarde si la rfrence existe dans le rfrentiel local\n    const values = Object.fromEntries(\n      Object.entries(allReferencesToUuids[locale]).map(([k, v]) => [v, k]),\n    )\n    reference = values[uuid] // undefined si la rfrence n'existe pas\n  }\n  if (reference === undefined || locale === 'fr-FR') {\n    // la recherche prcdente n'a rien donn : on cherche dans le rfrentiel franais\n    const values = Object.fromEntries(\n      Object.entries(allReferencesToUuids['fr-FR']).map(([k, v]) => [v, k]),\n    )\n    reference = values[uuid]\n  }\n  return reference || ''\n}\n","<script lang=\"ts\">\n  import { languages } from '../../../lib/components/languagesUtils'\n  import type { Language } from '../../../lib/types/languages'\n  export let locale: Language\n</script>\n\n<div\n  class=\"{`${$$props.class || ''} relative flex justify-center items-center  text-coopmaths-struct dark:text-coopmathsdark-struct`}\"\n>\n  <i class=\"bx bx-sm bx-world\"></i>\n  <div class=\"absolute -bottom-1 -right-1 text-xs font-bold font-mono\">\n    {languages[locale].short}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import {\n    buildLangIconPath,\n    languages,\n  } from '../../../lib/components/languagesUtils'\n  import type { Language } from '../../../lib/types/languages'\n  export let locale: Language\n</script>\n\n<img\n  src=\"{buildLangIconPath(languages[locale].short)}\"\n  alt=\"{languages[locale].short}\"\n  class=\"h-4 w-4\"\n/>\n","<script lang=\"ts\">\n  import type { Language } from '../../../lib/types/languages'\n  import { languages } from '../../../lib/components/languagesUtils'\n  import LanguageIcon from './LanguageIcon.svelte'\n  export let locale: Language\n  let isMenuOpen: boolean = false\n  export let handleLanguage: (lang: string) => void\n</script>\n\n<div class=\"w-full group inline-block relative\">\n  <button\n    type=\"button\"\n    class=\"flex flex-row justify-start items-center\"\n    on:click=\"{() => {\n      isMenuOpen = !isMenuOpen\n    }}\"\n  >\n    <LanguageIcon {locale} />\n    <i\n      class=\"bx bx-chevron-down {isMenuOpen\n        ? 'rotate-180'\n        : 'rotate-0'} transition-transform ease-in-out duration-300 text-coopmaths-action dark:text-coopmathsdark-action\"\n    ></i>\n  </button>\n  <ul\n    id=\"languageChoiceMenu\"\n    class=\"{isMenuOpen ? '' : 'hidden'}\n    w-full relative md:absolute md:top-5 md:right-0 min-w-[15rem] flex flex-col justify-start items-end shadow-lg\"\n  >\n    {#each Object.entries(languages) as [loc, lang]}\n      <li\n        class=\"w-full space-x-2 py-2 px-4 font-light bg-coopmaths-canvas dark:bg-coopmathsdark-canvas hover:bg-coopmaths-canvas-dark dark:hover:bg-coopmathsdark-canvas-dark\"\n      >\n        <button\n          type=\"button\"\n          class=\"w-full flex flex-row space-x-2 justify-end items-center text-coopmaths-action dark:text-coopmathsdark-action\"\n          id=\"languageChoice{lang.short}\"\n          on:click=\"{() => {\n            handleLanguage(loc)\n            isMenuOpen = false\n          }}\"\n        >\n          <div class=\"flex flex-row items-center\">\n            <i\n              class=\"bx bx-check pr-2 {loc.localeCompare(locale) === 0\n                ? ''\n                : 'hidden'}\"\n            ></i>\n            <span>Rfrentiel {lang.long}</span>\n          </div>\n          <div>\n            <LanguageIcon locale=\"{loc}\" />\n          </div>\n        </button>\n      </li>\n    {/each}\n  </ul>\n</div>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import ButtonIcon from '../forms/ButtonIcon.svelte'\n\n  export let isDisplayed: boolean //  bind avec le parent\n  export let icon: string = ''\n  export let isWithCloseButton: boolean = true\n\n  const dispatch = createEventDispatcher()\n\n  let dialog: HTMLDialogElement\n\n  $: if (dialog && isDisplayed) dialog.showModal()\n  $: if (dialog && !isDisplayed) dialog.close()\n</script>\n\n<div class=\"flex justify-center\">\n  <!-- pour que la modale ne soit pas affecte par les modifications de marge de ses parents -->\n\n  <!-- Ceux qui n'ont pas de souris ont le focus sur le bouton de la croix pour fermer donc ce n'est pas grave s'ils ne peuvent pas fermer en interagissant avec le fond de la modale -->\n  <!-- svelte-ignore a11y-click-events-have-key-events -->\n  <!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n  <dialog\n    bind:this=\"{dialog}\"\n    on:click|self=\"{() => dialog.close()}\"\n    on:close=\"{() => {\n      isDisplayed = false\n      dispatch('close')\n    }}\"\n    class=\"rounded-xl\n      w-full md:w-2/3 xl:w-1/2\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  >\n    <div class=\"relative p-6 text-center\">\n      {#if isWithCloseButton}\n        <ButtonIcon\n          icon=\"bx-x text-2xl\"\n          class=\"absolute top-3 right-3\"\n          on:click=\"{() => dialog.close()}\"\n        />\n      {/if}\n      {#if icon !== ''}\n        <div\n          class=\"flex items-center justify-center h-12 w-12 mx-auto mt-2 mb-6 rounded-full\n          bg-coopmaths-warn-100 text-coopmaths-warn-darkest\"\n        >\n          <i class=\"bx bx-sm {icon}\"></i>\n        </div>\n      {/if}\n      <div\n        class=\"w-full mb-4\n        text-2xl font-bold\n        text-coopmaths-struct dark:text-coopmathsdark-struct\"\n      >\n        <slot name=\"header\" />\n      </div>\n      <div class=\"w-full\">\n        <slot name=\"content\" />\n      </div>\n      <div class=\"w-full mt-6 mb-3\">\n        <slot name=\"footer\" />\n      </div>\n    </div>\n  </dialog>\n</div>\n","<script lang=\"ts\">\n  import { languages } from '../../../lib/components/languagesUtils'\n  import type { Language } from '../../../lib/types/languages'\n  import LanguageIcon from '../ui/LanguageIcon.svelte'\n  import BasicClassicModal from './BasicClassicModal.svelte'\n\n  export let showLanguageChoiceModal: boolean\n  export let handleLanguage: (lang: string) => void\n  export let locale: Language\n</script>\n\n<BasicClassicModal bind:isDisplayed=\"{showLanguageChoiceModal}\">\n  <div slot=\"header\" class=\"text-2xl w-full\">Langue du Rfrentiel</div>\n  <div slot=\"content\">\n    <ul class=\"p2 flex flex-col justify-start items-end\">\n      {#each Object.entries(languages) as [loc, lang]}\n        <li\n          class=\"w-full space-x-2 py-2 px-4 font-light bg-coopmaths-canvas dark:bg-coopmathsdark-canvas hover:bg-coopmaths-canvas-dark dark:hover:bg-coopmathsdark-canvas-dark\"\n        >\n          <button\n            type=\"button\"\n            class=\"w-full flex flex-row space-x-2 justify-end items-center text-coopmaths-action dark:text-coopmathsdark-action\"\n            id=\"languageChoice{lang.short}\"\n            on:click=\"{() => {\n              handleLanguage(loc)\n              showLanguageChoiceModal = false\n            }}\"\n          >\n            <div class=\"flex flex-row items-center\">\n              <i\n                class=\"bx bx-check pr-2 {loc.localeCompare(locale) === 0\n                  ? ''\n                  : 'hidden'}\"\n              ></i>\n              <span>Rfrentiel {lang.long}</span>\n            </div>\n            <div>\n              <LanguageIcon locale=\"{loc}\" />\n            </div>\n          </button>\n        </li>\n      {/each}\n    </ul>\n  </div>\n</BasicClassicModal>\n","<script lang=\"ts\">\n  import { globalOptions, darkMode } from '../../../lib/stores/generalStore'\n  import ButtonIcon from '../forms/ButtonIcon.svelte'\n  import { mathaleaGoToView } from '../../../lib/mathalea'\n  import NavBarSubtitle from './NavBarSubtitle.svelte'\n  import {\n    VUES_WITH_LANG_STATUS_ONLY,\n    type Language,\n  } from '../../../lib/types/languages'\n  import LanguageStatus from '../ui/LanguageStatus.svelte'\n  import LanguageDropdown from '../ui/LanguageDropdown.svelte'\n  import LanguageIcon from '../ui/LanguageIcon.svelte'\n  import ModalLanguageChoice from '../modal/ModalLanguageChoice.svelte'\n\n  export let title: string = 'MathALA'\n  export let subtitle: string = ''\n  export let subtitleType: 'export' | 'design' = 'export'\n  export let locale: Language\n  export let handleLanguage: (lang: string) => void\n\n  let showLanguageChoiceModal: boolean = false\n</script>\n\n<!--\n  @component\n  Barre de titre pour une section du site positionne en haut dans la page.\n  Contient un titre pour l'endroit du site (MathALA, etc.),\n  un sous titre pour indiquer la section (export, ), un bouton pour grer le mode sombre et ventuellement\n  un bouton pour fermer (c'est--dire revenir  la page d'accueil de la section.)\n\n  ### Paramtres\n\n  * `title` : le titre de la page (`MathALA` par dfaut)\n  * `subtitle` : son sous-titre\n  * `subTItleType` : mot indiquant le type de la section pour dcider de l'affichage (seulelemnt deux mode `export` et `design`)\n\n  ### Exemple\n\n  ```tsx\n    <NavBarV2 subtitle=\"Conception de document\" subtitleType=\"design\" />\n  ```\n -->\n\n<nav\n  class=\"p-2\n  md:h-[60px]\n  bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n>\n  <!-- container -->\n  <div\n    class=\"flex flex-row justify-between items-center w-full mx-auto gap-4\"\n  >\n    <div\n      class=\"flex justify-start flex-col\n      space-x-0 md:space-x-2\"\n    >\n      <div\n        class=\"flex align-middle\n        flex-col md:flex-row\"\n      >\n        <div>\n          <div\n            on:click=\"{() => mathaleaGoToView('')}\"\n            on:keydown=\"{() => mathaleaGoToView('')}\"\n            role=\"link\"\n            tabindex=\"0\"\n            class=\"relative inline-flex font-logo9 tracking-tighter font-black\n            text-2xl md:text-4xl\n            {subtitleType === 'design'\n              ? 'text-coopmaths-struct dark:text-coopmathsdark-struct'\n              : `cursor-pointer\n                text-coopmaths-action dark:text-coopmathsdark-action\n                hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest`}\"\n          >\n            {title}\n          </div>\n          <div\n            class=\"absolute ml-3 -mt-0.5 font-light text-sm\n              text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-lightest\"\n          >\n            <span class=\"font-light font-sans tracking-normal\">par</span>\n            <a\n              href=\"https://coopmaths.fr\"\n              target=\"_blank\"\n              rel=\"noreferrer\"\n              class=\"font-extrabold font-logo9 tracking-tighter\n                text-coopmaths-action dark:text-coopmathsdark-action\n                hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n            >\n              CoopMaths\n            </a>\n          </div>\n        </div>\n        <NavBarSubtitle {subtitle} type=\"{subtitleType}\" />\n      </div>\n    </div>\n    <div\n      class=\"flex flex-row space-x-4 pt-1\n      pr-0 md:pr-4\"\n    >\n      {#if $globalOptions.v && VUES_WITH_LANG_STATUS_ONLY.includes($globalOptions.v)}\n        <LanguageStatus {locale} />\n      {:else}\n        <!-- Menu droulant en mode desktop -->\n        <div class=\"hidden md:block\">\n          <LanguageDropdown {locale} {handleLanguage} />\n        </div>\n        <!-- En mode smartphone bouton commandant un dialogue -->\n        <div class=\"md:hidden\">\n          <button\n            type=\"button\"\n            on:click=\"{() => {\n              showLanguageChoiceModal = !showLanguageChoiceModal\n            }}\"\n          >\n            <LanguageIcon {locale} />\n          </button>\n        </div>\n      {/if}\n      <label\n        class=\"swap swap-rotate\n          text-coopmaths-action dark:text-coopmathsdark-action\n          hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n      >\n        <!-- this hidden checkbox controls the state -->\n        <input\n          id=\"hidden-checkbox-for-darkmode\"\n          type=\"checkbox\"\n          class=\"invisible\"\n          bind:checked=\"{$darkMode.isActive}\"\n        />\n        <div class=\"swap-on\"><i class=\"bx bx-sm bx-sun\"></i></div>\n        <div class=\"swap-off\"><i class=\"bx bx-sm bx-moon\"></i></div>\n      </label>\n      <ButtonIcon\n        icon=\"bx-x {subtitleType === 'design' ? 'hidden' : ''}\"\n        class=\"text-3xl\"\n        on:click=\"{() => {\n          mathaleaGoToView('')\n        }}\"\n      />\n    </div>\n  </div>\n</nav>\n<ModalLanguageChoice bind:showLanguageChoiceModal {locale} {handleLanguage} />\n","<script>\n  import { keyboardState } from './keyboard/stores/keyboardStore'\n</script>\n\n<footer\n  class=\"{$keyboardState.isVisible\n    ? 'pt-48 md:pt-60'\n    : 'pt-4'} w-full bg-coopmaths-canvas dark:bg-coopmathsdark-canvas h-12 flex flex-row-reverse justify-center items-center opacity-100 pb-4 px-4\"\n>\n  <a href=\"https://coopmaths.fr/www/mentions_legales/\" target=\"_blank\">\n    <img\n      class=\"hidden md:block px-6\"\n      style=\"height: 20px\"\n      src=\"assets/images/logo2.png\"\n      alt=\"Logo Coopmaths 2\"\n    />\n  </a>\n  <!-- <a\n    class=\"flex flex-row items-center justify-start pr-6 font-thin text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n    href=\"https://mathstodon.xyz/@coopmaths\"\n    target=\"_blank\"\n  >\n    <i class=\"bx bx-sm bxl-mastodon\" />\n  </a> -->\n  <a\n    class=\"flex flex-row items-center justify-start pr-6 font-thin text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n    href=\"mailto:contact@coopmaths.fr\"\n  >\n    <i class=\"bx bx-sm bx-envelope\"></i>\n  </a>\n</footer>\n","import type Exercice from '../exercices/Exercice'\nimport type { InterfaceParams } from './types'\n\ninterface Items {\n  [key: string]: string\n}\n\ninterface DocumentsEntity {\n  title: string\n  items: string[]\n  number?: number\n}\n\nexport interface UserSettings {\n  items: Items\n  documents: DocumentsEntity[]\n}\n\nexport interface itemsWithExercises {\n  [key: string]: Exercice[]\n}\n\nexport function handleUrl(url: URL) {\n  const entries = url.searchParams.entries()\n  let indiceExercice = -1\n  const newExercisesParams: InterfaceParams[] = []\n  for (const entry of entries) {\n    if (entry[0] === 'uuid') {\n      indiceExercice++\n      const uuid = entry[1]\n      if (!newExercisesParams[indiceExercice])\n        newExercisesParams[indiceExercice] = { uuid }\n      newExercisesParams[indiceExercice].uuid = uuid // string\n      newExercisesParams[indiceExercice].interactif = '0' // par dfaut\n    } else if (entry[0] === 'n') {\n      newExercisesParams[indiceExercice].nbQuestions = parseInt(entry[1]) // int\n    } else if (entry[0] === 's') {\n      newExercisesParams[indiceExercice].sup = entry[1]\n    } else if (entry[0] === 's2') {\n      newExercisesParams[indiceExercice].sup2 = entry[1]\n    } else if (entry[0] === 's3') {\n      newExercisesParams[indiceExercice].sup3 = entry[1]\n    } else if (entry[0] === 's4') {\n      newExercisesParams[indiceExercice].sup4 = entry[1]\n    } else if (entry[0] === 's5') {\n      newExercisesParams[indiceExercice].sup5 = entry[1]\n    } else if (entry[0] === 'alea') {\n      newExercisesParams[indiceExercice].alea = entry[1]\n    } else if (entry[0] === 'cols') {\n      newExercisesParams[indiceExercice].cols = parseInt(entry[1])\n    } else if (entry[0] === 'i' && (entry[1] === '0' || entry[1] === '1')) {\n      newExercisesParams[indiceExercice].interactif = entry[1]\n    } else if (entry[0] === 'cd' && (entry[1] === '0' || entry[1] === '1')) {\n      newExercisesParams[indiceExercice].cd = entry[1]\n    }\n  }\n  return newExercisesParams\n}\n\nexport function generateLatex(\n  userSettings: UserSettings,\n  itemsWithExercises: itemsWithExercises,\n) {\n  let output = preambuleLight\n  let outputCorr = '\\n\\n%%%%%%%%%%%%%%%%%%%%'\n  outputCorr += '\\n%%%  CORRECTION  %%%'\n  outputCorr += '\\n%%%%%%%%%%%%%%%%%%%%'\n  outputCorr += '\\n\\n\\\\fancyhead[L]{Correction}'\n  for (const document of userSettings.documents) {\n    const numberOfVersions = document.number || 1\n    for (let i = 0; i < numberOfVersions; i++) {\n      const intro = `\n  \n  %%% ${document.title} %%%\n  \\\\clearpage\n  \\\\fancyhead[R]{${document.title}}\n  \\\\setcounter{numexercice}{0}\n  \n  `\n      output += intro\n      outputCorr += intro\n\n      for (const item of document.items) {\n        if (itemsWithExercises[item]) {\n          for (const exercise of itemsWithExercises[item]) {\n            exercise.reinit()\n            exercise.nouvelleVersion()\n            output += '\\n\\n\\\\exercice{}\\n' + exercise.contenu\n            outputCorr += '\\n\\n\\\\exercice{}\\n' + exercise.contenuCorrection\n          }\n        }\n      }\n    }\n  }\n  outputCorr += '\\n\\n\\\\end{document}'\n  return output + outputCorr\n}\n\nconst preambuleLight = `\n\\\\documentclass[12pt]{article}\n\\\\usepackage[left=1.5cm,right=1.5cm,top=2cm,bottom=2cm]{geometry}\n\\\\usepackage[utf8]{inputenc}        \n\\\\usepackage[T1]{fontenc}\n\\\\usepackage[french]{babel}\n\\\\usepackage{multicol} \n\\\\usepackage{calc} \n\\\\usepackage{enumerate}\n\\\\usepackage{enumitem}\n\\\\usepackage{graphicx}\n\\\\usepackage{tabularx}\n\\\\usepackage[autolanguage,np]{numprint}\n\\\\usepackage{hyperref}\n\\\\usepackage{amsmath,amsfonts,amssymb,mathrsfs} \n\\\\usepackage{cancel}\n\\\\usepackage{textcomp}\n\\\\usepackage{gensymb}\n\\\\usepackage{eurosym}\n\\\\usepackage{fancyhdr,lastpage}          \n\\\\pagestyle{fancy}                      \n\\\\usepackage{fancybox}\n\\\\usepackage{setspace}\n\\\\usepackage{colortbl}\n\\\\usepackage{xcolor}\n\\\\usepackage{qrcode}\n\\\\usepackage{pgf,tikz}\n\n\\\\setlength{\\\\parindent}{0mm}\n\\\\renewcommand{\\\\arraystretch}{1.5}\n\\\\renewcommand{\\\\labelenumi}{\\\\textbf{\\\\theenumi{}.}}\n\\\\renewcommand{\\\\labelenumii}{\\\\textbf{\\\\theenumii{}.}}\n\\\\newcommand{\\\\version}[1]{\\\\fancyhead[R]{Version #1}}\n\\\\setlength{\\\\headheight}{14.5pt}\n\n\\\\newcounter{numexercice}\n\\\\setcounter{numexercice}{0}\n\\\\newcommand{\\\\exercice}{\n  \\\\stepcounter{numexercice}\n  \\\\subsection*{Exercice \\\\thenumexercice}\n}\n\n\\\\fancyhead[C]{valuation  la carte}\n\\\\fancyfoot{}\n\\\\fancyhead[R]{}\n\n\\\\renewcommand{\\\\headrulewidth}{0.4pt}\n\n\\\\begin{document}\n`\n","export default \"%%% COULEURS %%%\\n\\\\usepackage[table,svgnames]{xcolor}\\n\\\\definecolor{nombres}{cmyk}{0,.8,.95,0}\\n\\\\definecolor{gestion}{cmyk}{.75,1,.11,.12}\\n\\\\definecolor{gestionbis}{cmyk}{.75,1,.11,.12}\\n\\\\definecolor{grandeurs}{cmyk}{.02,.44,1,0}\\n\\\\definecolor{geo}{cmyk}{.62,.1,0,0}\\n\\\\definecolor{algo}{cmyk}{.69,.02,.36,0}\\n\\\\definecolor{correction}{cmyk}{.63,.23,.93,.06}\\n\\\\arrayrulecolor{couleur_theme} % Couleur des filets des tableaux\\n\\n\\\\usepackage[most]{tcolorbox} % Supprim  cause de conflits avec ProfCollege\\n\\\\tcbuselibrary{documentation}\\n\\n%%%%%%%% Modification paramtrage pour footnotes\\n% Le paquet semble dj appel en amont, curieux qu'il n'y ait pas eu de clash\\n% avec l'appel ci-dessous mais seulement quand j'ai essay de l'inclure avec l'option lualatex\\n\\n% \\\\usepackage{hyperref}\\n% Parametrages\\n\\\\hypersetup{\\n    colorlinks=true,% On active la couleur pour les liens. Couleur par dfaut rouge\\n    linkcolor=black,% On dfinit la couleur pour les liens internes\\n    % filecolor=magenta,% On dfinit la couleur pour les liens vers les fichiers locaux      \\n    urlcolor=black,% On dfinit la couleur pour les liens vers des sites web\\n    % pdftitle={Puissance Quatre},% On dfinit un titre pour le document pdf\\n    % pdfpagemode=FullScreen,% On fixe l'affichage par dfaut  plein cran\\n    }\\n% Pour avoir les numrotations arabic y compris dans les environnements tcolorbox\\n\\\\renewcommand{\\\\thempfootnote}{\\\\arabic{mpfootnote}}\\n%%%%%%%%\\n\\n\\\\usepackage{multicol} \\n\\\\usepackage{calc}\\n\\\\usepackage{enumitem}\\n\\\\usepackage{graphicx}\\n\\\\usepackage{tabularx}\\n\\n\\\\setlength{\\\\parindent}{0mm}\\n\\\\renewcommand{\\\\arraystretch}{1.5}\\n\\\\renewcommand{\\\\labelenumi}{\\\\textbf{\\\\theenumi{}.}}\\n\\\\renewcommand{\\\\labelenumii}{\\\\textbf{\\\\theenumii{}.}}\\n\\\\setlength{\\\\fboxsep}{3mm}\\n\\n\\\\setlength{\\\\headheight}{14.5pt}\\n\\n\\\\setlength{\\\\premulticols}{0pt}\\n\\n\\\\newcounter{ExoMA}\\n\\n\\\\newlength{\\\\parindentMA}%\\n\\\\setlength{\\\\parindentMA}{\\\\parindent}\\n\\\\addtolength{\\\\parindentMA}{30pt}\\n\\n\\\\usepackage{simplekv}\\n\\n\\\\setKVdefault[Theme]{Coopmath,Classiques=false,CANs=false}\\n\\\\defKV[Theme]{Classique=\\\\setKV[Theme]{Coopmath=false}\\\\setKV[Theme]{Classiques}}\\n\\\\defKV[Theme]{CAN=\\\\setKV[Theme]{Coopmath=false}\\\\setKV[Theme]{CANs}}\\n\\n\\\\usepackage{fancyhdr}\\n\\\\fancyhead[C]{}\\n\\\\fancyfoot{}\\n\\n\\\\def\\\\bla{}\\n\\n\\\\NewDocumentCommand\\\\Theme{o m m m m}{%\\n  \\\\useKVdefault[Theme]%\\n  \\\\setKV[Theme]{#1}%\\n  \\\\ifboolKV[Theme]{CANs}{%\\n    \\\\usepackage[left=1.5cm,right=1.5cm,top=2cm,bottom=2cm]{geometry}%\\n    \\\\fancypagestyle{premierePage}{%\\n      \\\\fancyhead[C]{\\\\textsc{\\\\ifx\\\\bla#2\\\\bla Course aux nombres\\\\else#2\\\\fi}}%\\n      \\\\fancyfoot[R]{\\\\scriptsize Coopmaths.fr -- CC-BY-SA}%\\n      \\\\setlength{\\\\headheight}{14.5pt}%\\n      \\\\NewDocumentCommand\\\\dureeCan{}{\\\\ifx\\\\bla#4\\\\bla 9 minutes\\\\else #4\\\\fi}\\n      \\\\NewDocumentCommand\\\\titreSujetCan{}{\\\\ifx\\\\bla#3\\\\bla\\\\else\\\\textbf{#3}\\\\fi}\\n    }%\\n    \\\\pagestyle{premierePage}\\n    \\\\colorlet{couleur_theme}{black}%\\n    \\\\colorlet{couleur_numerotation}{couleur_theme}%\\n    \\\\let\\\\EXO\\\\EXOCan\\\\let\\\\endEXO\\\\endEXOCan%\\n  }{%\\n    \\\\renewcommand{\\\\headrulewidth}{0pt}\\n    \\\\renewcommand{\\\\footrulewidth}{0pt}\\n    \\\\pagestyle{fancy}\\n    \\\\ifboolKV[Theme]{Classiques}{%\\n      \\\\usepackage[left=0.65cm,right=0.65cm,top=2cm,bottom=1.5cm]{geometry}\\n      \\\\let\\\\EXO\\\\EXOlibre\\\\let\\\\endEXO\\\\endEXOlibre%\\n      \\\\colorlet{couleur_theme}{black}%\\n      \\\\colorlet{couleur_numerotation}{couleur_theme}%\\n      \\\\fancyhead[C]{\\\\bfseries #3}\\n      \\\\fancyhead[L]{\\\\bfseries #4}\\n      \\\\fancyfoot[R]{#5}\\n    }{%\\n      \\\\usepackage[left=1.5cm,right=1.5cm,top=4cm,bottom=2cm]{geometry}\\n      \\\\theme{#2}{#3}{#4}{#5}%\\n      \\\\let\\\\EXO\\\\EXOcoop\\\\let\\\\endEXO\\\\endEXOcoop%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentEnvironment{EXOCan}{m m +b}{%\\n  #3\\n}\\n\\n\\\\NewDocumentEnvironment{EXOcoop}{m m +b}{%\\n  \\\\begin{tcolorbox}[%\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=white,\\n    coltitle=black,\\n    title=\\\\IfNoValueTF{#1}{}{\\\\textmd{#1}},%\\n    overlay unbroken and first={%\\n      \\\\IfNoValueTF{#2}{}{%\\n        \\\\node[%\\n        fill=white,\\n        anchor=east,\\n        xshift=10pt,\\n        text=black\\n        ]\\n        at (frame.north east)\\n        {\\\\scriptsize #2};\\n      }\\n      \\\\node[anchor=west,xshift=-20pt,yshift=-15pt] at (frame.north west) {\\\\stepcounter{ExoMA}\\\\numb{\\\\arabic{ExoMA}}};\\n    }\\n    ]\\n    #3\\n  \\\\end{tcolorbox}\\n}\\n\\n\\\\NewDocumentEnvironment{EXOlibre}{m m +b}{%\\n  \\\\begin{tcolorbox}[%\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=white,%couleur_theme,\\n    coltitle=black,\\n    title=\\\\stepcounter{ExoMA}\\\\textbf{Exercice \\\\arabic{ExoMA}},%\\n    ]\\n    \\\\IfNoValueTF{#1}{}{#1\\\\par}%\\n    #3\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\n%%% MISE EN PAGE %%%\\n\\\\usepackage{setspace}\\n\\\\usepackage{pgf}%\\n\\\\usepackage{pgfplots}\\n\\\\pgfplotsset{compat=1.18}\\n\\\\usetikzlibrary{babel,arrows, arrows.meta,calc,fit,patterns,plotmarks,shapes.geometric,shapes.misc,shapes.symbols,shapes.arrows,shapes.callouts, shapes.multipart, shapes.gates.logic.US,shapes.gates.logic.IEC, er, automata,backgrounds,chains,topaths,trees,petri,mindmap,matrix, calendar, folding,fadings,through,positioning,scopes,decorations.fractals,decorations.shapes,decorations.text,decorations.pathmorphing,decorations.pathreplacing,decorations.footprints,decorations.markings,shadows}\\n\\n\\\\spaceskip=2\\\\fontdimen2\\\\font plus 3\\\\fontdimen3\\\\font minus3\\\\fontdimen4\\\\font\\\\relax %Pour doubler l'espace entre les mots\\n\\\\newcommand\\\\numb[1]{ % Dessin autour du numro d'exercice\\n  \\\\begin{tikzpicture}[overlay,scale=.8]%,yshift=-.3cm\\n    \\\\draw[fill=couleur_numerotation,couleur_numerotation](-.4,-0.1)rectangle($(-0.4,.8)+(2em,0)$);\\n    \\\\draw (-.4,.8) node[white,anchor=north west,inner sep=0.5pt]{\\\\bfseries EX}; \\n    \\\\draw[line width=.05cm,couleur_numerotation,fill=white] (0,0)--(.5,.5)--(1,0)--(.5,-.5)--cycle;\\n    \\\\draw (0.5,0) node[anchor=center,couleur_numerotation]{\\\\large\\\\bfseries#1};\\n  \\\\end{tikzpicture}\\n}\\n\\n% echelle pour le d\\n\\\\def\\\\globalscale {0.04}\\n% abscisse initiale pour les chevrons\\n\\\\def\\\\xini {3}\\n\\n\\\\newcommand\\\\theme[4]{%\\n  \\\\fancyhead[C]{%\\n    % Trac du d\\n    \\\\begin{tikzpicture}[y=0.80pt, x=0.80pt, yscale=-\\\\globalscale, xscale=\\\\globalscale,remember picture, overlay,transform canvas={xshift=-0.5\\\\linewidth,yshift=2.7cm},fill=couleur_theme]%,xshift=17cm,yshift=9.5cm\\n      %%%% Arc suprieur gauche%%%%\\n      \\\\path[fill](523,1424)..controls(474,1413)and(404,1372)..(362,1333)..controls(322,1295)and(313,1272)..(331,1254)..controls(348,1236)and(369,1245)..(410,1283)..controls(458,1328)and(517,1356)..(575,1362)..controls(635,1368)and(646,1375)..(643,1404)..controls(641,1428)and(641,1428)..(596,1430)..controls(571,1431)and(538,1428)..(523,1424)--cycle;\\n      %%%% D face suprieur%%%%\\n      \\\\path[fill](512,1272)..controls(490,1260)and(195,878)..(195,861)..controls(195,854)and(198,846)..(202,843)..controls(210,838)and(677,772)..(707,772)..controls(720,772)and(737,781)..(753,796)..controls(792,833)and(1057,1179)..(1057,1193)..controls(1057,1200)and(1053,1209)..(1048,1212)..controls(1038,1220)and(590,1283)..(551,1282)..controls(539,1282)and(521,1278)..(512,1272)--cycle;\\n      %%%% D faces gauche et droite%%%%\\n      \\\\path[fill](1061,1167)..controls(1050,1158)and(978,1068)..(900,967)..controls(792,829)and(756,777)..(753,756)--(748,729)--(724,745)..controls(704,759)and(660,767)..(456,794)..controls(322,813)and(207,825)..(200,822)..controls(193,820)and(187,812)..(187,804)..controls(188,797)and(229,688)..(279,563)..controls(349,390)and(376,331)..(391,320)..controls(406,309)and(462,299)..(649,273)..controls(780,254)and(897,240)..(907,241)..controls(918,243)and(927,249)..(928,256)..controls(930,264)and(912,315)..(889,372)..controls(866,429)and(848,476)..(849,477)..controls(851,479)and(872,432)..(897,373)..controls(936,276)and(942,266)..(960,266)..controls(975,266)and(999,292)..(1089,408)..controls(1281,654)and(1290,666)..(1290,691)..controls(1290,720)and(1104,1175)..(1090,1180)..controls(1085,1182)and (1071,1176)..(1061,1167)--cycle;\\n      %%%% Arc infrieur bas%%%%\\n      \\\\path[fill](1329,861)..controls(1316,848)and(1317,844)..(1339,788)..controls(1364,726)and(1367,654)..(1347,591)..controls(1330,539)and(1338,522)..(1375,526)..controls(1395,528)and(1400,533)..(1412,566)..controls(1432,624)and(1426,760)..(1401,821)..controls(1386,861)and(1380,866)..(1361,868)..controls(1348,870)and(1334,866)..(1329,861)--cycle;\\n      %%%% Arc infrieur gauche%%%%\\n      \\\\path[fill](196,373)..controls(181,358)and(186,335)..(213,294)..controls(252,237)and(304,190)..(363,161)..controls(435,124)and(472,127)..(472,170)..controls(472,183)and(462,192)..(414,213)..controls(350,243)and(303,283)..(264,343)..controls(239,383)and(216,393)..(196,373)--cycle;\\n    \\\\end{tikzpicture}\\n    \\\\begin{tikzpicture}[line cap=round,line join=round,remember picture, overlay, shift={(current page.north west)},yshift=-8.5cm]\\n      \\\\fill[fill=couleur_theme] (0,5) rectangle (21,6);\\n      \\\\fill[fill=couleur_theme] (\\\\xini,6)--(\\\\xini+1.5,6)--(\\\\xini+2.5,7)--(\\\\xini+1.5,8)--(\\\\xini,8)--(\\\\xini+1,7)-- cycle;\\n      \\\\fill[fill=couleur_theme] (\\\\xini+2,6)--(\\\\xini+2.5,6)--(\\\\xini+3.5,7)--(\\\\xini+2.5,8)--(\\\\xini+2,8)--(\\\\xini+3,7)-- cycle;  \\n      \\\\fill[fill=couleur_theme] (\\\\xini+3,6)--(\\\\xini+3.5,6)--(\\\\xini+4.5,7)--(\\\\xini+3.5,8)--(\\\\xini+3,8)--(\\\\xini+4,7)-- cycle;   \\n      \\\\node[color=white] at (10.5,5.5) {\\\\LARGE \\\\bfseries{ \\\\MakeUppercase{#4}}};\\n    \\\\end{tikzpicture}\\n    \\\\begin{tikzpicture}[remember picture,overlay]\\n      \\\\node[anchor=north east,inner sep=0pt] at ($(current page.north east)+(0,-.8cm)$) {};\\n      \\\\node[anchor=west, fill=white, inner sep = 0pt] at ($(current page.north west)+(0.2,-2.3cm)$) {\\\\footnotesize \\\\bfseries{MathALA}};\\n    \\\\end{tikzpicture}\\n    \\\\begin{tikzpicture}[remember picture,overlay]\\n      \\\\node[anchor=north east,inner sep=0pt] at ($(current page.north east)+(0,-.8cm)$) {};\\n      \\\\node[anchor=east, fill=white] at ($(current page.north east)+(-2,-1.5cm)$) {\\\\Huge \\\\textcolor{couleur_theme}{\\\\bfseries{\\\\#}} \\\\bfseries{#2} \\\\textcolor{couleur_theme}{\\\\bfseries \\\\MakeUppercase{#3}}};\\n    \\\\end{tikzpicture}\\n  }%\\n  \\\\fancyfoot[R]{%\\n    \\\\begin{tikzpicture}[remember picture,overlay]\\n      \\\\node[anchor=south east] at ($(current page.south east)+(-2,0.25cm)$) {\\\\scriptsize {\\\\bfseries \\\\href{https://coopmaths.fr/}{Coopmaths.fr} -- \\\\href{http://creativecommons.fr/licences/}{CC-BY-SA}}};\\n    \\\\end{tikzpicture}\\n    \\\\begin{tikzpicture}[line cap=round,line join=round,remember picture, overlay,xscale=0.5,yscale=0.5, shift={(current page.south west)},xshift=35.7cm,yshift=-6cm]\\n      \\\\fill[fill=couleur_theme] (\\\\xini,6)--(\\\\xini+1.5,6)--(\\\\xini+2.5,7)--(\\\\xini+1.5,8)--(\\\\xini,8)--(\\\\xini+1,7)-- cycle;\\n      \\\\fill[fill=couleur_theme] (\\\\xini+2,6)--(\\\\xini+2.5,6)--(\\\\xini+3.5,7)--(\\\\xini+2.5,8)--(\\\\xini+2,8)--(\\\\xini+3,7)-- cycle;  \\n      \\\\fill[fill=couleur_theme] (\\\\xini+3,6)--(\\\\xini+3.5,6)--(\\\\xini+4.5,7)--(\\\\xini+3.5,8)--(\\\\xini+3,8)--(\\\\xini+4,7)-- cycle;  \\n    \\\\end{tikzpicture}\\n  }\\n  \\\\fancyfoot[C]{}\\n  \\\\colorlet{couleur_theme}{#1}\\n  \\\\colorlet{couleur_numerotation}{couleur_theme}\\n  \\\\def\\\\iconeobjectif{icone-objectif-#1}\\n  \\\\def\\\\urliconeomethode{icone-methode-#1}\\n}%\\n\\n\\\\newcommand*\\\\tikzfootMA{%\\n  \\\\ifboolKV[Theme]{CANs}{\\n    \\\\begin{tikzpicture}[remember picture,overlay,shift=(current page.north west)]\\n      \\\\begin{scope}[x=\\\\textwidth-\\\\oddsidemargin,y=\\\\textheight+5pt]\\n        \\\\draw[correction,line width=4pt,dashed,dash pattern= on 10pt off 10pt,shift={(-\\\\oddsidemargin,\\\\topmargin)}] (0,0) rectangle (1,-1);\\n      \\\\end{scope}\\n    \\\\end{tikzpicture} \\n  }{%\\n  \\\\ifboolKV[Theme]{Classiques}{%\\n  \\\\begin{tikzpicture}[remember picture,overlay,shift=(current page.south west)]\\n    \\\\begin{scope}[x={(current page.south east)},y={(current page.north west)}]\\n      \\\\draw[correction,line width=4pt,dashed,dash pattern= on 10pt off 10pt] ($(0,0)+(5mm,1cm)$) rectangle ($(1,1)+(-5mm,-1.75cm)$);\\n    \\\\end{scope}\\n  \\\\end{tikzpicture} \\n  }{%\\n  \\\\begin{tikzpicture}[remember picture,overlay,shift=(current page.south west)]\\n    \\\\begin{scope}[x={(current page.south east)},y={(current page.north west)}]\\n      \\\\draw[correction,line width=4pt,dashed,dash pattern= on 10pt off 10pt] ($(0,0)+(5mm,1.5cm)$) rectangle ($(1,1)+(-5mm,-3.75cm)$);\\n    \\\\end{scope}\\n  \\\\end{tikzpicture} \\n  }%\\n  }\\n}\\n\\n\\\\newenvironment{Correction}{%\\n  \\\\setcounter{ExoMA}{0}%\\n  \\\\cfoot{\\\\tikzfootMA}\\n}{}%\\n\\n\\\\newcommand\\\\version[1]{\\n  \\\\fancyhead[R]{\\n    \\\\begin{tikzpicture}[remember picture,overlay]\\n    \\\\node[anchor=north east,inner sep=0pt] at ($(current page.north east)+(-.5,-.5cm)$) {\\\\large \\\\textcolor{couleur_theme}{\\\\bfseries V#1}};\\n    \\\\end{tikzpicture}\\n  }\\n}\\n\\n\\\\usepackage[french]{babel}\"","import type { LatexFileInfos, contentsType } from '../Latex'\n\nexport function loadFonts(latexFileInfos: LatexFileInfos) {\n  return `\\n\\\\usepackage{etoolbox}\n\\\\newbool{dys}\n\\\\setbool{dys}{${latexFileInfos.fontOption === 'DysFont' ? 'true' : 'false'}}          \n\\\\ifbool{dys}{\n% POLICE DYS\n% ===== VARIABLE =====\n\\\\def\\\\FontChoisie{Fira} % valeurs possibles : Fira, lmodern, tgheros\n\\\\newcommand{\\\\choiceFontsDys}[1]{\n\\\\ifstrequal{#1}{Fira}{%\n  % Fira Sans + Fira Math\n  % Description : Fira Sans est une police moderne, et Fira Math est une version mathmatique compatible qui maintient le style sans-serif.\n  % Utilisation : Fonctionne bien avec XeLaTeX et LuaLaTeX.\n  \\\\usepackage{fontspec}\n  \\\\setmainfont{Fira Sans}\n  \\\\setsansfont{Fira Sans}\n  \\\\usepackage{unicode-math}\n  \\\\setmathfont{Fira Math}\n}{}\n\\\\ifstrequal{#1}{lmodern}{%\n  % Latin Modern Sans\n  % Description : Une version sans-serif de la clbre police Latin Modern, qui est compatible avec mathastext.\n  % Utilisation : Fonctionne avec pdfLaTeX, XeLaTeX et LuaLaTeX.\n  \\\\usepackage{lmodern}\n  \\\\renewcommand{\\\\familydefault}{\\\\sfdefault}\n  \\\\usepackage{mathastext}\n}{}\n\\\\ifstrequal{#1}{tgheros}{%\n  % TeX Gyre Heros + mathastext\n  % Description : TeX Gyre Heros est une alternative  Helvetica, et le package mathastext permet d'utiliser la mme police pour les mathmatiques.\n  % Utilisation : Fonctionne avec pdfLaTeX, XeLaTeX, ou LuaLaTeX.\n  \\\\usepackage{tgheros}\n  \\\\renewcommand{\\\\familydefault}{\\\\sfdefault}\n  \\\\usepackage{mathastext}\n}{}\n}\n% Fira ou lmodern ou tgheros\n\\\\choiceFontsDys{\\\\FontChoisie}\n\n%\\\\usepackage{unicode-math}\n%\\\\usepackage{fontspec}\n%\\\\setmainfont{TeX Gyre Schola}\n%\\\\setsansfont{TeX Gyre Schola}\n%\\\\setmathfont{TeX Gyre Schola Math}\n%\\\\setmainfont{OpenDyslexic}[Scale=1.0]\n%\\\\setsansfont{OpenDyslexic}[Scale=1.0]\n%\\\\setmathfont{OpenDyslexic}[Scale=1.0,range=up/{Latin,latin,num}]\n\\\\usepackage[fontsize=${latexFileInfos.dysTailleFontOption}]{scrextend}\n\\\\usepackage{setspace}\n\\\\setstretch{1.7}\n% Une valeur d'environ 1.2  1.7 est souvent recommande. Cela permet d'augmenter l'espace entre les lignes tout en offrant un lger espacement entre les mots.\n\\\\setlength{\\\\spaceskip}{1.2em}  \n% Une valeur d'environ 1.2em  1.5em est couramment conseille. Cela cre un espace plus ample entre les mots, ce qui peut aider  rduire la fatigue visuelle et  amliorer la fluidit de la lecture.\n}{\n% POLICE STANDARD\n\\\\usepackage[T1]{fontenc} \n\\\\usepackage[scaled=1]{helvet}\n\\\\usepackage[fontsize=${latexFileInfos.tailleFontOption}]{scrextend}\n}`\n}\n\nfunction loadNoteBasExercices(contents: contentsType) {\n  const noteBas = `\n\\\\newcounter{customfootnote}\n\\\\newcounter{tempreset}%\n\\\\newcounter{temp}\n\n\\\\makeatletter\n\\\\newcommand{\\\\anote}[1]{%\n  \\\\refstepcounter{customfootnote}%\n  \\\\textsuperscript{\\\\thecustomfootnote}%\n  \\\\expandafter\\\\gdef\\\\csname custom@footnote@\\\\thecustomfootnote\\\\endcsname{#1}%\n}\n\n\\\\newcommand{\\\\printcustomnotes}{%\n  \\\\par\\\\noindent\\\\rule{\\\\linewidth}{0.4pt}\\\\par\n  \\\\setcounter{temp}{1}%\n  \\\\whileboolexpr{\n    test {\\\\ifcsdef{custom@footnote@\\\\thetemp}}\n  }{%\n    \\\\noindent\\\\textsuperscript{\\\\thetemp}~\\\\csname custom@footnote@\\\\thetemp\\\\endcsname\\\\par\n    \\\\stepcounter{temp}%\n  }%\n}\n\n\\\\newcommand{\\\\resetcustomnotes}{%\n  \\\\setcounter{customfootnote}{0}%\n  \\\\setcounter{tempreset}{1}%\n  \\\\whileboolexpr{\n    test {\\\\ifcsdef{custom@footnote@\\\\thetempreset}}\n  }{%\n    \\\\global\\\\expandafter\\\\let\\\\csname custom@footnote@\\\\thetempreset\\\\endcsname\\\\@undefined\n    \\\\stepcounter{tempreset}%\n  }%\n}\n\\\\makeatother`\n  testIfLoaded(['\\\\anote{'], noteBas, contents)\n}\n\nexport function loadPreambule(\n  latexFileInfos: LatexFileInfos,\n  contents: contentsType,\n) {\n  if (latexFileInfos.style === 'Can') {\n    contents.preamble += loadPreambuleCan()\n  }\n  loadPackagesFromContent(contents)\n}\n\nfunction loadPreambuleCan() {\n  return `\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n% SPCIFIQUE SUJETS CAN                  %\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\\\\usepackage{tabularray} % EE : Pour pouvoir utiliser tableauCAN\n\\\\usepackage{longtable}\n\n\\\\tikzset{\n  mybox/.style={\n    rectangle,\n    drop shadow, \n    inner sep=17pt,\n    draw=gray,\n    shade,\n    top color=gray,\n    every shadow/.append style={fill=gray!40}, \n    bottom color=gray!20\n    }\n  }\n  \n  \\\\newcommand\\\\MyBox[2][]{%\n    \\\\tikz\\\\node[mybox,#1] {#2}; \n  }\n  % Un compteur pour les questions CAN\n  \\\\newcounter{nbEx}\n  % Pour travailler avec les compteurs\n  \\\\usepackage{totcount}\n  \\\\regtotcounter{nbEx}  \n\n  % Une checkmark !\n  \\\\def\\\\myCheckmark{\\\\tikz\\\\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;}  \n  % Repiqu sans vergogne dans lemanuel TikZ pour l'impatient\n  \\\\def\\\\arete{3}   \\\\def\\\\epaisseur{5}   \\\\def\\\\rayon{2}\n\n  \\\\newcommand{\\\\ruban}{(0,0)\n    ++(0:0.57735*\\\\arete-0.57735*\\\\epaisseur+2*\\\\rayon)\n    ++(-30:\\\\epaisseur-1.73205*\\\\rayon)\n    arc (60:0:\\\\rayon)   -- ++(90:\\\\epaisseur)\n    arc (0:60:\\\\rayon)   -- ++(150:\\\\arete)\n    arc (60:120:\\\\rayon) -- ++(210:\\\\epaisseur)\n    arc (120:60:\\\\rayon) -- cycle}\n\n  \\\\newcommand{\\\\mobiusCan}{\n    % Repiqu sans vergogne dans lemanuel TikZ pour l'impatient\n    \\\\begin{tikzpicture}[very thick,top color=white,bottom color=gray,scale=1.2]\n      \\\\shadedraw \\\\ruban;\n      \\\\shadedraw [rotate=120] \\\\ruban;\n      \\\\shadedraw [rotate=-120] \\\\ruban;\n      \\\\draw (-60:4) node[scale=5,rotate=30]{CAN};\n      \\\\draw (180:4) node[scale=3,rotate=-90]{MathALA};\n      \\\\clip (0,-6) rectangle (6,6); % pour croiser\n      \\\\shadedraw  \\\\ruban;\n      \\\\draw (60:4) node [gray,xscale=2.5,yscale=2.5,rotate=-30]{CoopMaths};\n    \\\\end{tikzpicture} \n  }\n  \n  \\\\newcommand{\\\\pageDeGardeCan}[1]{\n    % #1 --> nom du compteur pour le nombre de questions\n\n    %\\\\vspace*{10mm}\n    \\\\textsc{Nom} : \\\\makebox[.35\\\\linewidth]{\\\\dotfill} \\\\hfill \\\\textsc{Prnom} : \\\\makebox[.35\\\\linewidth]{\\\\dotfill}\n\n    \\\\vspace{10mm}\n    \\\\textsc{Classe} : \\\\makebox[.33\\\\linewidth]{\\\\dotfill} \\\\hfill\n    \\\\MyBox{\\\\Large\\\\textsc{Score} : \\\\makebox[.15\\\\linewidth]{\\\\dotfill} / \\\\total{#1}}      \n    \\\\par\\\\medskip \\\\hrulefill \\\\par\n    \\\\myCheckmark \\\\textit{\\\\textbf{Dure :  \\\\dureeCan}}\n\n    \\\\smallskip\n    \\\\myCheckmark \\\\textit{L'preuve comporte \\\\total{#1} questions.}\n\n    \\\\smallskip  \n    \\\\myCheckmark \\\\textit{L'usage de la calculatrice et du brouillon est interdit.}\n\n    \\\\smallskip\n    \\\\myCheckmark \\\\textit{Il n'est pas permis d'crire des calculs intermdiaires.}\n    \\\\par \\\\hrulefill \\\\par\\\\vspace{5mm}\n    \\\\begin{center}\n      \\\\textsc{\\\\titreSujetCan}\n      \\\\par\\\\vspace{5mm}\n      \\\\mobiusCan\n    \\\\end{center}\n  }\n\n  \\\\newlength{\\\\Largeurcp}\n  \n  % Nouveau TableauCan\n  % Supprimer les headers et footer du longtblr\n  \\\\DefTblrTemplate{contfoot-text}{default}{}\n  \\\\DefTblrTemplate{conthead-text}{default}{}\n  \\\\DefTblrTemplate{caption}{default}{}\n  \\\\DefTblrTemplate{conthead}{default}{}\n  \\\\DefTblrTemplate{capcont}{default}{}\n  \\\\UseTblrLibrary{counter,varwidth}\n  % Compteur des questions\n  \\\\newcounter{CompteurTableauCan}\n  \\\\newcommand{\\\\CompteurTC}{\\\\stepcounter{CompteurTableauCan}\\\\arabic{CompteurTableauCan}}\n  % ENvironnement proprement dit\n  \\\\NewDocumentEnvironment{TableauCan}{+b}{%\n  % #1 --> corps de tableau\n  \\\\begin{longtblr}{%\n    width=\\\\textwidth,%\n    colspec={X[c,0.075]X[c,0.55]X[c,0.28]X[c,0.1]},%\n    vlines,hlines,,measure=vbox,%\n    vspan=even,%\n    stretch=2.5,%\n    column{1}={bg={gray!20},font={\\\\bfseries}},%\n    row{1}={bg={gray!20},font={\\\\bfseries},halign={c}},%\n    rows={valign={m}}%\n  }\n  \\\\#&nonc&Rponse&Jury\\\\\\\\\n  #1\n  \\\\end{longtblr}\n  }{}\n  `\n}\n\nconst debug = false\nexport const logPDF = (str: string) => {\n  if (debug) console.log('PACKAGETEST:' + str)\n}\n\nexport function loadProfCollegeIfNeed(contents: contentsType) {\n  testIfLoaded(\n    [\n      '\\\\Engrenages[',\n      '\\\\Proba[',\n      '\\\\Propor[',\n      '\\\\Fraction[',\n      '\\\\Reperage[',\n      '\\\\Pythagore',\n      '\\\\Prix',\n      '\\\\SquarO[',\n      'begin{Scratch}',\n      'begin{Tableur}',\n      '\\\\pointilles',\n    ],\n    '\\\\usepackage{ProfCollege}',\n    contents,\n  )\n}\n\nfunction testIfLoaded(\n  values: string[],\n  valueToPut: string,\n  contents: contentsType,\n  display?: string,\n) {\n  for (const value of values) {\n    if (\n      contents.content.includes(value) ||\n      contents.contentCorr.includes(value)\n    ) {\n      if (!contents.preamble.includes(valueToPut))\n        contents.preamble += `\\n${valueToPut}`\n      logPDF(\n        `${display === undefined ? valueToPut : display}: ${window.location.href}`,\n      )\n    }\n  }\n}\n\nexport function loadPackagesFromContent(contents: contentsType) {\n  contents.preamble += '\\n% loadPackagesFromContent'\n  loadProfCollegeIfNeed(contents)\n  loadNoteBasExercices(contents)\n  testIfLoaded(['\\\\twemoji'], '\\\\usepackage{twemojis}', contents)\n  testIfLoaded(['ifthenelse'], '\\\\usepackage{ifthen}', contents)\n  testIfLoaded(\n    ['pspicture', '\\\\rput', '\\\\pscurve', '\\\\psset', '\\\\psframe'],\n    '\\\\usepackage{pstricks}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\PstPolygon', '\\\\PstStarFive'],\n    '\\\\usepackage{pst-poly}',\n    contents,\n  )\n  testIfLoaded(['\\\\pstext'], '\\\\usepackage{pst-text}', contents)\n  testIfLoaded(\n    ['\\\\pstGeonode', '\\\\pstLine', '\\\\pstLabelAB', '\\\\PstTriangle'],\n    '\\\\usepackage{pst-eucl}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\psaxes', '\\\\psline', '\\\\pspolygon', '\\\\psplot'],\n    '\\\\usepackage{pst-plot}',\n    contents,\n  )\n  testIfLoaded(['\\\\psbcurve'], '\\\\usepackage{pst-bezier}', contents)\n  testIfLoaded(['\\\\psBspline'], '\\\\usepackage{pst-bspline}', contents)\n  testIfLoaded(\n    ['\\\\pstThreeDLine', 'pstThreeDCoor'],\n    '\\\\usepackage{pst-3dplot}',\n    contents,\n  )\n  testIfLoaded(['\\\\multido'], '\\\\usepackage{multido}', contents)\n  testIfLoaded(\n    ['\\\\gradangle{', 'fillstyle=gradient'],\n    '\\\\usepackage{pst-grad}',\n    contents,\n  )\n  testIfLoaded(['\\\\pstree{', '\\\\pstree['], '\\\\usepackage{pst-tree}', contents)\n  testIfLoaded(\n    ['\\\\pnode', '\\\\ncline', '\\\\nccurve', '\\\\ncarc'],\n    '\\\\usepackage{pst-node}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\red', '\\\\blue', '\\\\white'],\n    '\\\\usepackage{pst-fun}',\n    contents,\n  )\n  testIfLoaded(['\\\\euro'], '\\\\usepackage[gen]{eurosym}', contents)\n  testIfLoaded(['\\\\tkzTabInit'], '\\\\usepackage{tkz-tab}', contents)\n  testIfLoaded(['{tabularx}', '{tabular}'], '\\\\usepackage{tabularx}', contents)\n  testIfLoaded(['\\\\ang', '\\\\num{'], '\\\\usepackage{siunitx}', contents)\n  testIfLoaded(['\\\\begin{multicols}'], '\\\\usepackage{multicol}', contents)\n  testIfLoaded(\n    ['\\\\opadd', '\\\\opsub', '\\\\opmul', '\\\\opdiv', '\\\\opidiv'],\n    '\\\\usepackage{xlop}',\n    contents,\n  )\n  testIfLoaded(['\\\\cancel'], '\\\\usepackage{cancel}', contents)\n  testIfLoaded(\n    ['\\\\draw[color={'],\n    '\\\\usepackage[table,svgnames]{xcolor}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\np{', '\\\\np[', '\\\\numprint{'],\n    '\\\\usepackage[autolanguage,np]{numprint}',\n    contents,\n  )\n  testIfLoaded(['\\\\mathscr'], '\\\\usepackage{mathrsfs}', contents)\n  testIfLoaded(\n    ['\\\\fcolorbox{nombres}'],\n    '\\\\definecolor{nombres}{cmyk}{0,.8,.95,0}',\n    contents,\n  )\n  testIfLoaded(['\\\\begin{tikzpicture}'], '\\\\usepackage{tikz}', contents)\n  testIfLoaded(['\\\\begin{bclogo}'], '\\\\usepackage[tikz]{bclogo}', contents)\n  if (contents.content.includes('\\\\begin{bclogo}')) {\n    logPDF(`definecolor{nombres} : ${window.location.href}`)\n    if (!contents.preamble.includes('definecolor{nombres}'))\n      contents.preamble += '\\n\\\\definecolor{nombres}{cmyk}{0,.8,.95,0}'\n  }\n  testIfLoaded(['\\\\begin{axis}'], '\\\\usepackage{pgfplots}', contents)\n  testIfLoaded(\n    ['pgfmathsetmacro'],\n    '\\\\usetikzlibrary{decorations,decorations.text}',\n    contents,\n  )\n  testIfLoaded(\n    ['decorate,decoration=', 'decorate, decoration='],\n    '\\\\usetikzlibrary{decorations.pathmorphing}',\n    contents,\n  )\n  testIfLoaded(\n    ['decoration=brace', 'decoration={brace}', 'decoration={brace,'],\n    '\\\\usetikzlibrary {decorations.pathreplacing}',\n    contents,\n  )\n  testIfLoaded(['\\\\tkzText'], '\\\\usepackage{tkz-fct}', contents)\n  testIfLoaded(['pic['], '\\\\usetikzlibrary{quotes}', contents)\n  testIfLoaded(['angle eccentricity'], '\\\\usetikzlibrary{angles}', contents)\n  testIfLoaded(\n    ['name intersections'],\n    '\\\\usetikzlibrary{intersections}',\n    contents,\n  )\n  testIfLoaded(['\\\\begin{wrapfigure}'], '\\\\usepackage{wrapfig}', contents)\n  testIfLoaded(['needspace'], '\\\\usepackage{needspace}', contents)\n  testIfLoaded(['\\\\ovaloperator{'], '\\\\usepackage{scratch3}', contents)\n  testIfLoaded(['\\\\begin{scratch}'], '\\\\usepackage{scratch3}', contents)\n  testIfLoaded(\n    ['\\\\begin{Scratch}'],\n    '\\\\usepackage{unicode-math}\\n\\\\newfontfamily\\\\myfontScratch[]{FreeSans}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\degre', '\\\\og', '\\\\up{', '\\\\ieme{', '\\\\no'],\n    '\\\\usepackage[french]{babel}',\n    contents,\n  )\n  testIfLoaded(['\\\\degree'], '\\\\usepackage{gensymb}', contents)\n  testIfLoaded(['\\\\tblr'], '\\\\usepackage{tabularray}', contents)\n  testIfLoaded(['\\\\multirow{'], '\\\\usepackage{multirow}', contents)\n  testIfLoaded(\n    ['\\\\dotfills'],\n    '\\\\newcommand\\\\dotfills[1][4cm]{\\\\makebox[#1]{\\\\dotfill}}',\n    contents,\n  )\n\n  testIfLoaded(\n    ['\\\\blocrep{', '\\\\blocrep['],\n    `\n\\\\usepackage{setspace}\n% ligne pointille\n\\\\newcommand{\\\\dotline}{\\\\noindent\\\\makebox[\\\\linewidth]{\\\\dotfill}}\n\n\n\n% bloc de rponses\n\\\\newcommand{\\\\blocrep}[3][1.5]{% #1 = nb lignes, #2 = nb colonnes\n  \\\\begin{spacing}{#1} % interligne\n  \\\\newcount\\\\foo\n  \\\\ifstrequal{#3}{1}{%\n  % --- Cas 1 colonne ---\n    \n  \\\\foo=#2\n\t\\\\loop\n\t\t\\\\dotline\n\n\t\t\\\\advance \\\\foo -1\n\t\\\\ifnum \\\\foo>0\n\t\\\\repeat\n  }{%\n    % --- Cas multi-colonnes ---\n    \\\\begin{multicols}{#3}\n    \\\\foo=\\\\numexpr#2 * #3\\\\relax\n\t  \\\\loop\n\t\t  \\\\dotline \n\t\t\n      \\\\advance \\\\foo -1\n    \\\\ifnum \\\\foo>0\n    \\\\repeat\n    \\\\end{multicols}\n  }%\n  \\\\end{spacing}\n  \\\\vspace{-0cm}\n}\n`,\n    contents,\n  )\n\n  if (\n    contents.content.includes('\\\\ovalbox{') ||\n    contents.content.includes('\\\\txtbox{')\n  ) {\n    // gestion pour les sujets DNB : 2021\n    contents.preamble += '\\n\\\\usepackage{fancybox}'\n    logPDF(`usepackage{fancybox}: ${window.location.href}`)\n    if (contents.content.includes('\\\\txtbox{')) {\n      logPDF(`\\\\newcommand{\\\\txtbox}{\\\\ovalnum}: ${window.location.href}`)\n      contents.preamble += '\\n\\\\newcommand{\\\\txtbox}{\\\\ovalnum}'\n    }\n  }\n  testIfLoaded(\n    ['\\\\begin{figure}'],\n    `\\n% supprime les figures flottantes du DNB\n\\\\makeatletter\n\\\\def\\\\provideenvironment{\\\\@star@or@long\\\\provide@environment}\n\\\\def\\\\provide@environment#1{%\n\\\\@ifundefined{#1}%\n  {\\\\def\\\\reserved@a{\\\\newenvironment{#1}}}%\n  {\\\\def\\\\reserved@a{\\\\renewenvironment{dummy@environ}}}%\n\\\\reserved@a\n}\n\\\\def\\\\dummy@environ{}\n\\\\makeatother\n\\\\provideenvironment{figure}{}{}\\\\renewenvironment{figure}{}{}`,\n    contents,\n    'begin{figure}',\n  )\n  if (contents.content.includes('\\\\selectarrownum')) {\n    logPDF(`\\\\selectarrownum : ${window.location.href}`)\n    // gestion des commandes pour les sujets DNB : dnb_2018_06_ameriquenord_4\n    contents.preamble +=\n      \"\\n\\\\newcommand*\\\\selectarrownum{% le petit triangle vers le bas  ct d'un _nombre_\"\n    contents.preamble +=\n      '\\n  \\\\unskip\\\\hskip0.125em \\\\tikz[baseline=-1.25ex,x=1ex,y=1ex,rounded corners=0pt]\\\\draw[fill=black!70,draw=none](0,0)--(1,0)--(0.5,-0.6)--cycle;'\n    contents.preamble += '\\n}'\n  }\n  testIfLoaded(\n    [\n      '\\\\R ',\n      '\\\\R{',\n      '\\\\R)',\n      '\\\\R.',\n      '\\\\R^',\n      '\\\\R\\\\',\n      '\\\\R$',\n      '\\\\R_+',\n      '\\\\in \\\\R',\n      '\\\\N ',\n      '\\\\N*',\n      '\\\\N^*',\n      '\\\\N,',\n      '\\\\N{',\n      '\\\\N^{',\n      '\\\\N$',\n      '\\\\N}',\n    ],\n    '\\\\usepackage{amsfonts}',\n    contents,\n  )\n  testIfLoaded(\n    [\n      '\\\\R ',\n      '\\\\R{',\n      '\\\\R.',\n      '\\\\R)',\n      '\\\\R_+',\n      '\\\\R$',\n      '\\\\R^',\n      '\\\\R\\\\',\n      '\\\\in \\\\R',\n    ],\n    '\\\\newcommand\\\\R{\\\\mathbb{R}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\N ', '\\\\N,', '\\\\N^*', '\\\\N{', '\\\\N^{', '\\\\N$', '\\\\N*', '\\\\N}'],\n    '\\\\newcommand\\\\N{\\\\mathbb{N}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\vect', '\\\\Oij', '\\\\Oijk', '\\\\Ouv'],\n    '\\\\newcommand{\\\\vect}[1]{\\\\overrightarrow{\\\\,\\\\mathstrut#1\\\\,}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\vectt'],\n    '\\\\newcommand{\\\\vectt}[1]{\\\\overrightarrow{\\\\,\\\\mathstrut\\\\text{#1}\\\\,}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\vv'],\n    '\\\\newcommand{\\\\vv}[1]{\\\\overrightarrow{\\\\,\\\\mathstrut#1\\\\,}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\vvt'],\n    '\\\\newcommand{\\\\vvt}[1]{\\\\overrightarrow{\\\\,\\\\mathstrut\\\\text{#1}\\\\,}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\Oij'],\n    '\\\\def\\\\Oij{$\\\\left(\\\\text{O}~;~\\\\vect{\\\\imath},~\\\\vect{\\\\jmath}\\\\right)$}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\Oijk'],\n    '\\\\def\\\\Oijk{$\\\\left(\\\\text{O}~;~\\\\vect{\\\\imath},~\\\\vect{\\\\jmath},~\\\\vect{k}\\\\right)$}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\Ouv'],\n    '\\\\def\\\\Ouv{$\\\\left(\\\\text{O}~;~\\\\vect{u},~\\\\vect{v}\\\\right)$}',\n    contents,\n  )\n  testIfLoaded(['\\\\e'], '\\\\newcommand{\\\\e}{\\\\text{e}}', contents)\n  testIfLoaded(\n    [\n      '\\\\ldots',\n      '\\\\cdots',\n      '\\\\dots',\n      '\\\\makebox',\n      '\\\\framebox',\n      '\\\\parbox',\n      '\\\\mbox',\n      '\\\\fbox',\n      '\\\\sbox',\n      '\\\\pbox',\n    ],\n    '\\\\usepackage{amsmath}',\n    contents,\n  )\n  testIfLoaded(\n    [\n      '\\\\leadsto',\n      '\\\\square',\n      '\\\\blacktriangleright',\n      '\\\\blacktriangleleft',\n      '\\\\mathbb',\n      '\\\\geqslant',\n      '\\\\leqslant',\n      '\\\\curvearrowleft',\n      '\\\\Box',\n      '\\\\checkmark',\n      '\\\\fbox',\n    ],\n    '\\\\usepackage{amssymb}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\columncolor{', '\\\\cellcolor', '\\\\rowcolor'],\n    '\\\\usepackage{colortbl}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\ovalnum{\\\\ovalnum'],\n    '\\\\definecolor{scrmovedddd}    {HTML}{3373cc}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\ding{', '\\\\textding', '\\\\decoone'],\n    '\\\\usepackage{pifont}',\n    contents,\n  )\n  testIfLoaded(['\\\\decoone'], '\\\\newcommand{\\\\decoone}{\\\\ding{87}}', contents)\n  testIfLoaded(\n    ['\\\\textding'],\n    '\\\\newcommand{\\\\textding}[1]{\\\\text{\\\\Large \\\\ding{#1}}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\starredbullet'],\n    '\\\\usepackage{MnSymbol}\\n\\\\newcommand\\\\starredbullet{\\\\medstar}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\decosix'],\n    '\\\\providecommand\\\\decosix{}\\n\\\\renewcommand\\\\decosix{$\\\\bullet$}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\toprule', '\\\\midrule', '\\\\bottomrule'],\n    '\\\\usepackage{booktabs}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\backslashbox', '\\\\diagbox{'],\n    '\\\\usepackage{diagbox}',\n    contents,\n  )\n  testIfLoaded(['\\\\ds'], '\\\\newcommand{\\\\ds}{\\\\displaystyle}', contents)\n  testIfLoaded(['\\\\EUR{'], '\\\\usepackage{marvosym}', contents)\n  testIfLoaded(\n    ['\\\\hautab'],\n    '\\\\newcommand\\\\hautab[1]{\\\\renewcommand{\\\\arraystretch}{#1}}',\n    contents,\n  )\n  testIfLoaded(\n    ['|C{', '{C{'],\n    '\\\\newcolumntype{C}[1]{>{\\\\centering\\\\arraybackslash}p{#1cm}}',\n    contents,\n  )\n  testIfLoaded(\n    ['pattern'],\n    '\\\\usetikzlibrary{patterns,patterns.meta}',\n    contents,\n  )\n  testIfLoaded(['framed'], '\\\\usetikzlibrary{backgrounds}', contents)\n  testIfLoaded(\n    ['single arrow', 'ellipse,'],\n    '\\\\usetikzlibrary{shapes}',\n    contents,\n  )\n  testIfLoaded(['>=triangle 45'], '\\\\usetikzlibrary{arrows}', contents)\n  testIfLoaded(\n    ['-{Latex', '-{Stealth', '-{Triangle', '-{Bar', '{Bar['],\n    '\\\\usetikzlibrary{arrows.meta}',\n    contents,\n  )\n  testIfLoaded(['below=2mm of'], '\\\\usetikzlibrary{positioning}', contents)\n  testIfLoaded(\n    ['\\\\llbracket', '\\\\rrbracket'],\n    '\\\\usepackage{stmaryrd}',\n    contents,\n  )\n  testIfLoaded(['\\\\newcommandtwoopt{'], '\\\\usepackage{twoopt}', contents)\n  testIfLoaded(\n    ['\\\\interval'],\n    '\\\\usepackage{interval}\\n \\\\intervalconfig{separator symbol=;}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\getprime{', '\\\\primedecomp{'],\n    decompDNB(),\n    contents,\n    'decompNombresPremiersDNB',\n  )\n  testIfLoaded(['\\\\SquarO['], squareO(), contents)\n  testIfLoaded(\n    ['\\\\con{'],\n    '\\\\newcommand{\\\\con}[1]{\\\\textcolor{violet}{#1}}',\n    contents,\n  )\n  testIfLoaded(\n    ['\\\\Coord'],\n    `\\\\newcommand*{\\\\Coord}[4]{% \n\\\\ensuremath{\\\\vect{#1}\\\\, \n      \\\\begin{pmatrix} \n        #2\\\\\\\\ \n        #3\\\\\\\\\n        #4\n\\\\end{pmatrix}}}`,\n    contents,\n    '\\\\Coord',\n  )\n  testIfLoaded(['\\\\widearc{', '\\\\eurologo'], '\\\\usepackage{fourier}', contents)\n  testIfLoaded(['\\\\tkzAxeXY'], '\\\\usepackage{tkz-base}', contents)\n  testIfLoaded(['\\\\tkz', '\\\\pic['], '\\\\usepackage{tkz-euclide}', contents)\n  testIfLoaded(\n    ['\\\\pstEllipse[linewidth='],\n    '\\\\providecommand\\\\pstEllipse{}\\n\\\\renewcommand{\\\\pstEllipse}[5][]{%\\n\\\\psset{#1}\\n\\\\parametricplot{#4}{#5}{#2\\\\space t cos mul #3\\\\space t sin mul}\\n}',\n    contents,\n    '\\\\pstEllipse',\n  )\n  testIfLoaded(['\\\\makecell'], '\\\\usepackage{makecell}', contents)\n  testIfLoaded(['\\\\polylongdiv'], '\\\\usepackage{polynom}', contents)\n  testIfLoaded(\n    ['\\\\includegraphicsembedded'],\n    '\\\\usepackage{luaimageembed}',\n    contents,\n  )\n\n  if (\n    contents.content.includes('\\\\begin{forest}') ||\n    contents.contentCorr.includes('\\\\begin{forest}')\n  ) {\n    logPDF(`usepackage{forest} : ${window.location.href}`)\n    // gestion des commandes pour les sujets DNB : 2023\n    contents.preamble += `\\n\\\\usetikzlibrary{trees} % arbre en proba\n\\\\usepackage{forest} % arbre en proba\n\\\\usetikzlibrary{positioning}\n% Structure servant  avoir l'vnement et la probabilit.\n\\\\def\\\\getEvene#1/#2\\\\endget{$#1$}\n\\\\def\\\\getProba#1/#2\\\\endget{$#2$}`\n  }\n}\n\nfunction decompDNB() {\n  return `%%% Table des nombres premiers  %%%%\n\\\\usepackage{xlop}\n\\\\newcount\\\\primeindex\n\\\\newcount\\\\tryindex\n\\\\newif\\\\ifprime\n\\\\newif\\\\ifagain\n\\\\newcommand\\\\getprime[1]{%\n\\\\opcopy{2}{P0}%\n\\\\opcopy{3}{P1}%\n\\\\opcopy{5}{try}\n\\\\primeindex=2\n\\\\loop\n\\\\ifnum\\\\primeindex<#1\\\\relax\n\\\\testprimality\n\\\\ifprime\n\\\\opcopy{try}{P\\\\the\\\\primeindex}%\n\\\\advance\\\\primeindex by1\n\\\\fi\n\\\\opadd*{try}{2}{try}%\n\\\\ifnum\\\\primeindex<#1\\\\relax\n\\\\testprimality\n\\\\ifprime\n\\\\opcopy{try}{P\\\\the\\\\primeindex}%\n\\\\advance\\\\primeindex by1\n\\\\fi\n\\\\opadd*{try}{4}{try}%\n\\\\fi\n\\\\repeat\n}\n\n\\\\newcommand\\\\testprimality{%\n\\\\begingroup\n\\\\againtrue\n\\\\global\\\\primetrue\n\\\\tryindex=0\n\\\\loop\n\\\\opidiv*{try}{P\\\\the\\\\tryindex}{q}{r}%\n\\\\opcmp{r}{0}%\n\\\\ifopeq \\\\global\\\\primefalse \\\\againfalse \\\\fi\n\\\\opcmp{q}{P\\\\the\\\\tryindex}%\n\\\\ifoplt \\\\againfalse \\\\fi\n\\\\advance\\\\tryindex by1\n\\\\ifagain\n\\\\repeat\n\\\\endgroup\n}\n\n%%% Dcomposition en nombres premiers %%%\n\n\\\\newcommand\\\\primedecomp[2][nil]{%\n\\\\begingroup\n\\\\opset{#1}%\n\\\\opcopy{#2}{NbtoDecompose}%\n\\\\opabs{NbtoDecompose}{NbtoDecompose}%\n\\\\opinteger{NbtoDecompose}{NbtoDecompose}%\n\\\\opcmp{NbtoDecompose}{0}%\n\\\\ifopeq\nJe refuse de dcomposer zro.\n\\\\else\n\\\\setbox1=\\\\hbox{\\\\opdisplay{operandstyle.1}%\n{NbtoDecompose}}%\n{\\\\setbox2=\\\\box2{}}%\n\\\\count255=1\n\\\\primeindex=0\n\\\\loop\n\\\\opcmp{NbtoDecompose}{1}\\\\ifopneq\n\\\\opidiv*{NbtoDecompose}{P\\\\the\\\\primeindex}{q}{r}%\n\\\\opcmp{0}{r}\\\\ifopeq\n\\\\ifvoid2\n\\\\setbox2=\\\\hbox{%\n\\\\opdisplay{intermediarystyle.\\\\the\\\\count255}%\n{P\\\\the\\\\primeindex}}%\n\\\\else\n\\\\setbox2=\\\\vtop{%\n\\\\hbox{\\\\box2}\n\\\\hbox{%\n\\\\opdisplay{intermediarystyle.\\\\the\\\\count255}%\n{P\\\\the\\\\primeindex}}}\n\\\\fi\n\\\\opcopy{q}{NbtoDecompose}%\n\\\\advance\\\\count255 by1\n\\\\setbox1=\\\\vtop{%\n\\\\hbox{\\\\box1}\n\\\\hbox{%\n\\\\opdisplay{operandstyle.\\\\the\\\\count255}%\n{NbtoDecompose}}\n}%\n\\\\else\n\\\\advance\\\\primeindex by1\n\\\\fi\n\\\\repeat\n\\\\hbox{\\\\box1\n\\\\kern0.5\\\\opcolumnwidth\n\\\\opvline(0,0.75){\\\\the\\\\count255.25}\n\\\\kern0.5\\\\opcolumnwidth\n\\\\box2}%\n\\\\fi\n\\\\endgroup\n}`\n}\n\nfunction squareO() {\n  return `%%%\n  % Squaro\n  %%% \n  \n  \\\\setKVdefault[Squaro]{Solution=false,Longueur=8,Largeur=8,Echelle=8mm,Graines=false,Perso=false} \n  \\\\defKV[Squaro]{Graine=\\\\setKV[Squaro]{Graines}}%\n  \n  \n  \\\\RenewDocumentCommand\\\\SquarO{o m}{%\n    \\\\useKVdefault[Squaro]%\n    \\\\setKV[Squaro]{#1}%\n    \\\\BuildSquaro[#2]%\n  }%\n  \n  \\\\def\\\\BuildSquarobase{%\n    numeric Longueur,Largeur;\n    Longueur=\\\\useKV[Squaro]{Longueur};\n    Largeur=\\\\useKV[Squaro]{Largeur};\n    boolean Solution,Graines,Perso;\n    Solution=\\\\useKV[Squaro]{Solution};\n    Graines=\\\\useKV[Squaro]{Graines};\n    Perso=\\\\useKV[Squaro]{Perso};\n    if Graines:\n      randomseed:=\\\\useKV[Squaro]{Graine};\n    fi;\n    u:=\\\\useKV[Squaro]{Echelle};\n    p:=0;\n    pair A[];%centre des carrs.\n    boolean Allume[][];\n  }\n  \n  \\\\RenewDocumentCommand\\\\BuildSquaro{o}{%\n    \\\\mplibforcehmode\n    \\\\begin{mplibcode}  \n      \\\\BuildSquarobase\n      \n    % Construction de la grille    \n      for k=0 upto Longueur-1:\n        for l=0 upto Largeur-1:\n          p:=p+1;\n          A[p]=u*(k,-l);\n          trace (unitsquare scaled u) shifted A[p];\n        endfor;\n      endfor;\n  \n      % Trac des cercles vides (ou pleins si Solution)\n      if Perso :\n      string GrillePers;  \n        GrillePers := \"#1\";\n        string valeur;\n        numeric indice;\n        indice=0;\n      for k=0 upto Largeur:\n          for l=0 upto Longueur:\n            valeur := substring(indice,indice+1) of GrillePers;\n            if valeur=\"1\":\n              Allume[k][l]=false;\n              fill cercles(u*(l,-k+1),1mm) withcolor white;\n            else :\n              Allume[k][l]=true;\n              fill cercles(u*(l,-k+1),1mm) if Solution=false:withcolor white fi;\n            fi;\n            trace cercles(u*(l,-k+1),1mm);\n            indice := indice + 2; % A cause de la virgule\n        endfor;\n      endfor;\n    else :\n      for k=0 upto Largeur:\n          for l=0 upto Longueur:\n             m:=uniformdeviate(1);\n            if m<0.5:\n              Allume[k][l]=true;\n              fill cercles(u*(l,-k+1),1mm) if Solution=false:withcolor white fi;\n            else:\n              Allume[k][l]=false;\n              fill cercles(u*(l,-k+1),1mm) withcolor white;\n            fi;\n            trace cercles(u*(l,-k+1),1mm);\n          endfor;\n        endfor;\n      fi;\n      \n    % Placement des chiffres dans les cases\n      for k=0 upto Largeur-1:\n      for l=0 upto Longueur-1:\n      Retiens:=0;\n      if Allume[k][l]:Retiens:=Retiens+1 fi;\n      if Allume[k][l+1]:Retiens:=Retiens+1 fi;\n      if Allume[k+1][l]:Retiens:=Retiens+1 fi;\n      if Allume[k+1][l+1]:Retiens:=Retiens+1 fi;\n      label(TEX(decimal(Retiens)),u*(l+0.5,-k+0.5));\n      endfor;\n      endfor;\n    \\\\end{mplibcode}\n  }%`\n}\n","import seedrandom from 'seedrandom'\nimport TypeExercice from '../exercices/Exercice'\nimport genericPreamble from '../lib/latex/preambule.tex?raw'\nimport {\n  loadFonts,\n  loadPackagesFromContent,\n  loadPreambule,\n  loadProfCollegeIfNeed,\n  logPDF,\n} from '../lib/latex/preambuleTex'\nimport { mathaleaHandleExerciceSimple } from './mathalea.js'\nimport { getLang } from './stores/languagesStore'\n// printPrettier pose problme avec begin{aligned}[t] en ajoutant un saut de ligne problmatique\n// import { printPrettier } from 'prettier-plugin-latex/standalone.js'\n\nexport interface Exo {\n  content?: string\n  serie?: string\n  month?: string\n  year?: string\n  zone?: string\n  title?: string\n}\n\nexport interface picFile {\n  name: string\n  format: string\n}\n\nexport type LatexFileInfos = {\n  title: string\n  reference: string\n  subtitle: string\n  dysTailleFontOption: number\n  tailleFontOption: number\n  durationCanOption: string\n  titleOption: string\n  style:\n    | 'Coopmaths'\n    | 'Classique'\n    | 'ProfMaquette'\n    | 'ProfMaquetteQrcode'\n    | 'Can'\n  nbVersions: number\n  fontOption: 'StandardFont' | 'DysFont'\n  correctionOption: 'AvecCorrection' | 'SansCorrection'\n  qrcodeOption: 'AvecQrcode' | 'SansQrcode'\n  typeFiche: 'Fiche' | 'Eval'\n  exos?: {\n    [key: string]: {\n      labels?: string\n      itemsep?: number\n      cols?: number\n      cols_corr?: number\n      blocrep?: { nbligs: number; nbcols: number }\n    }\n  }\n  signal?: AbortSignal | undefined\n}\n\nexport type contentsType = {\n  preamble: string\n  intro: string\n  content: string\n  contentCorr: string\n}\n\nexport type latexFileType = {\n  contents: contentsType\n  latexWithoutPreamble: string\n  latexWithPreamble: string\n}\n\ninterface ExoContent {\n  content?: string\n  contentCorr?: string\n  serie?: string\n  month?: string\n  year?: string\n  zone?: string\n  title?: string\n}\n\nfunction testIfLoaded(\n  values: string[],\n  valuetoSearch: string,\n  valueToPut: string,\n) {\n  let search = false\n  for (const value of values) {\n    if (value.includes(valuetoSearch)) {\n      search = true\n      break\n    }\n  }\n  if (search) {\n    return valueToPut\n  }\n  return ''\n}\n\nclass Latex {\n  exercices: TypeExercice[]\n  constructor() {\n    this.exercices = []\n  }\n\n  isExerciceStaticInTheList() {\n    return this.exercices.some((e) => e.typeExercice === 'statique')\n  }\n\n  getExercices() {\n    return this.exercices.map((e, i) => ({\n      titre: e.titre,\n      uuid: e.uuid,\n      index: i,\n    }))\n  }\n\n  addExercices(exercices: TypeExercice[]) {\n    this.exercices.push(...exercices)\n  }\n\n  getContentsForAVersion(\n    latexFileInfos: LatexFileInfos,\n    indiceVersion: number = 1,\n  ): { content: string; contentCorr: string } {\n    if (latexFileInfos.style === 'ProfMaquette') {\n      return {\n        content: this.getContentForAVersionProfMaquette(\n          indiceVersion,\n          latexFileInfos,\n        ),\n        contentCorr: '',\n      }\n    }\n    if (latexFileInfos.style === 'ProfMaquetteQrcode') {\n      latexFileInfos.qrcodeOption = 'AvecQrcode'\n      return {\n        content: this.getContentForAVersionProfMaquette(\n          indiceVersion,\n          latexFileInfos,\n        ),\n        contentCorr: '',\n      }\n    }\n    let content = ''\n    let contentCorr = ''\n    this.loadExercicesWithVersion(indiceVersion)\n    if (latexFileInfos.style === 'Can') {\n      content += '\\\\begin{TableauCan}\\n'\n      contentCorr += '\\n\\\\begin{enumerate}'\n      for (const exercice of this.exercices) {\n        if (exercice != null) {\n          // Initalisation de questionLiee  rien pour toutes les questions\n          const questionLiee: {\n            compteurQuestionsLiees: number\n            dejaLiee: boolean\n          }[] = Array.from({ length: exercice.listeQuestions.length }, () => ({\n            compteurQuestionsLiees: 0,\n            dejaLiee: false,\n          }))\n\n          for (let i = 0; i < exercice.listeQuestions.length; i++) {\n            // Enonc de la question\n            const enonce =\n              exercice.listeCanEnonces != null &&\n              exercice.listeCanEnonces[i] !== undefined &&\n              exercice.listeCanEnonces[i].length !== 0\n                ? exercice.listeCanEnonces[i]\n                : exercice.listeQuestions[i]\n\n            // Ne fonctionne que pour les CAN\n            if (\n              exercice.listeCanLiees != null &&\n              !exercice.listeCanLiees.every((subTab) => subTab.length === 0)\n            ) {\n              // Recherche si la question est lie  la suivante et aux prochaines\n              if (\n                exercice.listeCanLiees != null &&\n                exercice.listeCanLiees[i].length !== 0 &&\n                !questionLiee[i].dejaLiee\n              ) {\n                // Recherche d'une question lie  d'autres\n                let j = i + 1\n                let questionSuivante = j < exercice.listeQuestions.length\n                while (questionSuivante) {\n                  // Recherche des questions lies  la prcdente\n                  questionLiee[j].dejaLiee = exercice.listeCanLiees[j].includes(\n                    exercice.listeCanNumerosLies[i],\n                  )\n                  if (questionLiee[j].dejaLiee) {\n                    questionLiee[i].compteurQuestionsLiees++\n                  }\n                  questionSuivante =\n                    questionLiee[j] && j < exercice.listeQuestions.length - 1\n                  j++\n                }\n              }\n            }\n\n            // L'nonc des CAN est dpendant des questions lies ou pas\n            content += '\\\\CompteurTC  &'\n            if (questionLiee[i].compteurQuestionsLiees !== 0) {\n              content += `\\\\SetCell[r=${questionLiee[i].compteurQuestionsLiees + 1}]{c}`\n            }\n            content += !questionLiee[i].dejaLiee\n              ? ` { ${format(enonce)} }&`\n              : '&'\n\n            // La rponse  complter des CAN est indpendante des questions lies\n            if (\n              exercice.listeCanReponsesACompleter != null &&\n              exercice.listeCanReponsesACompleter[i] !== undefined\n            ) {\n              content += `{${format(exercice.listeCanReponsesACompleter[i])} }`\n            }\n            content += '&\\\\stepcounter{nbEx}\\\\\\\\'\n\n            if (\n              i + 1 < exercice.listeQuestions.length &&\n              questionLiee[i + 1].dejaLiee\n            ) {\n              content += '*'\n            } // Cette toile permet de grer les sauts de page malencontreux\n            content += '\\n'\n          }\n          for (const correction of exercice.listeCorrections) {\n            contentCorr += `\\n\\\\item ${format(correction)}`\n          }\n        }\n      }\n      contentCorr += '\\n\\\\end{enumerate}\\n'\n      content += '\\\\end{TableauCan}\\n\\\\addtocounter{nbEx}{-1}'\n      /** On supprime les lignes vides car elles posent problme dans l'environnement TableauCan */\n      content = content.replace(/\\n\\s*\\n/gm, '')\n    } else {\n      for (const exercice of this.exercices) {\n        if (exercice.typeExercice === 'statique') {\n          if (exercice.content === '') {\n            content += \"% Cet exercice n'est pas disponible au format LaTeX\"\n          } else {\n            content += `\\n% @see : ${getUrlFromExercice(exercice)}`\n            content += `\\n\\\\begin{EXO}{${exercice.examen || ''} ${exercice.mois || ''} ${exercice.annee || ''} ${exercice.lieu || ''}}{}\\n`\n            content += testIfLoaded(\n              [exercice.content ?? ''],\n              '\\\\anote{',\n              '\\n\\\\resetcustomnotes',\n            )\n            if (Number(exercice.nbCols) > 1) {\n              content += `\\\\begin{multicols}{${exercice.nbCols}}\\n`\n            }\n            content += exercice.content\n            if (Number(exercice.nbCols) > 1) {\n              content += '\\n\\\\end{multicols}\\n'\n            }\n            content += testIfLoaded(\n              [exercice.content ?? ''],\n              '\\\\anote{',\n              '\\n\\\\printcustomnotes',\n            )\n            content += '\\n\\\\end{EXO}\\n'\n            contentCorr += '\\n\\\\begin{EXO}{}{}\\n'\n            contentCorr += testIfLoaded(\n              [exercice.contentCorr ?? ''],\n              '\\\\anote{',\n              '\\n\\\\resetcustomnotes',\n            )\n            contentCorr += exercice.contentCorr\n            contentCorr += testIfLoaded(\n              [exercice.contentCorr ?? ''],\n              '\\\\anote{',\n              '\\n\\\\printcustomnotes',\n            )\n            contentCorr += '\\n\\\\end{EXO}\\n'\n          }\n        } else {\n          contentCorr += '\\n\\\\begin{EXO}{}{}\\n'\n          contentCorr += testIfLoaded(\n            exercice.listeCorrections,\n            '\\\\anote{',\n            '\\n\\\\resetcustomnotes',\n          )\n          if (Number(exercice.nbColsCorr) > 1) {\n            contentCorr += `\\\\begin{multicols}{${exercice.nbColsCorr}}\\n`\n          }\n          if (Number(exercice.nbQuestions) > 1) {\n            if (Number(exercice.spacingCorr) > 0) {\n              contentCorr += `\\n\\\\begin{enumerate}[itemsep=${exercice.spacingCorr}em]`\n            } else {\n              contentCorr += '\\n\\\\begin{enumerate}'\n            }\n          }\n          for (const correction of exercice.listeCorrections) {\n            if (Number(exercice.nbColsCorr) > 1) {\n              contentCorr += `\\n${Number(exercice.nbQuestions) > 1 ? '\\\\item' : ''} \\\\begin{minipage}[t]{\\\\linewidth}${format(correction)}\\\\end{minipage}`\n            } else {\n              contentCorr += `\\n${Number(exercice.nbQuestions) > 1 ? '\\\\item' : ''} ${format(correction)}`\n            }\n          }\n          if (Number(exercice.nbQuestions) > 1) {\n            contentCorr += '\\n\\\\end{enumerate}\\n'\n          }\n          if (Number(exercice.nbColsCorr) > 1) {\n            contentCorr += '\\\\end{multicols}\\n'\n          }\n          contentCorr += testIfLoaded(\n            exercice.listeCorrections,\n            '\\\\anote{',\n            '\\n\\\\printcustomnotes',\n          )\n          contentCorr += '\\n\\\\end{EXO}\\n'\n          content += `\\n% @see : ${getUrlFromExercice(exercice)}`\n          content += `\\n\\\\begin{EXO}{${testIfLoaded([exercice.introduction, exercice.consigne, ...exercice.listeQuestions], '\\\\anote{', '\\n\\\\resetcustomnotes ')}${format(exercice.consigne, false)}}{${String(exercice.id).replace('.js', '')}}\\n`\n          content += writeIntroduction(exercice.introduction)\n          content += writeInCols(\n            writeQuestions(\n              exercice.listeQuestions,\n              exercice.spacing,\n              Boolean(exercice.listeAvecNumerotation),\n              Number(exercice.nbCols),\n            ),\n            Number(exercice.nbCols),\n          )\n          content += testIfLoaded(\n            [\n              exercice.introduction,\n              exercice.consigne,\n              ...exercice.listeQuestions,\n            ],\n            '\\\\anote{',\n            '\\n\\\\printcustomnotes',\n          )\n          content += '\\n\\\\end{EXO}\\n'\n        }\n      }\n    }\n    return { content, contentCorr }\n  }\n\n  loadExercicesWithVersion(indiceVersion: number = 1) {\n    for (const exercice of this.exercices) {\n      if (exercice.typeExercice === 'statique') {\n        const serie = exercice?.examen?.toLowerCase()\n        if (serie === 'crpe' && indiceVersion === 1) {\n          exercice.content = exercice.content?.replaceAll('{Images/', '{')\n          exercice.contentCorr = exercice.contentCorr?.replaceAll(\n            '{Images/',\n            '{',\n          )\n        }\n        continue\n      }\n      if (!Object.prototype.hasOwnProperty.call(exercice, 'listeQuestions')) {\n        continue\n      }\n      const seedOld = exercice.seed\n      const seed =\n        indiceVersion > 1\n          ? exercice.seed + indiceVersion.toString()\n          : exercice.seed\n      exercice.seed = seed\n      if (exercice.typeExercice === 'simple') {\n        mathaleaHandleExerciceSimple(exercice, false)\n      } else {\n        seedrandom(seed, { global: true })\n        if (typeof exercice.nouvelleVersionWrapper === 'function') {\n          exercice.nouvelleVersionWrapper()\n        }\n      }\n      exercice.seed = seedOld // on remet l'ancienne seed pour ne pas perturber la gnration des versions suivantes\n    }\n  }\n\n  getContentForAVersionProfMaquette(\n    indiceVersion: number = 1,\n    latexFileInfos: LatexFileInfos,\n  ): string {\n    this.loadExercicesWithVersion(indiceVersion)\n    let content = ''\n    for (let k = 0; k < this.exercices.length; k++) {\n      const exercice = this.exercices[k]\n      const confExo: {\n        labels?: string\n        itemsep?: number\n        blocrep?: { nbligs: number; nbcols: number }\n        cols?: number\n        cols_corr?: number\n      } =\n        latexFileInfos.exos && latexFileInfos.exos[k]\n          ? latexFileInfos.exos[k]\n          : {}\n      content += `\\n% @see : ${getUrlFromExercice(exercice, indiceVersion)}`\n      if (exercice.typeExercice === 'statique') {\n        if (exercice.content === '') {\n          content += \"% Cet exercice n'est pas disponible au format LaTeX\"\n        } else {\n          content += '\\n\\\\needspace{10\\\\baselineskip}'\n          if (latexFileInfos.qrcodeOption === 'AvecQrcode') {\n            content += `\\n\\\\begin{exercice}[${\n              latexFileInfos.titleOption === 'AvecTitre'\n                ? `Titre=${latexFileInfos.titleOption}, `\n                : ''\n            }Ajout={\\\\node[anchor=north east, inner sep=2pt]\n        at (frame.north east) {\\\\hypersetup{urlcolor=black, pdfnewwindow=true}\\\\qrcode[height=2cm]{${getUrlFromExercice(exercice, indiceVersion)}&v=eleve&es=0211}};\n}]%[Lignes=5,Interieur]`\n          } else {\n            content += `\\n\\\\begin{exercice}${\n              latexFileInfos.titleOption === 'AvecTitre'\n                ? `[Titre=${latexFileInfos.titleOption}]`\n                : ''\n            }%[Lignes=5,Interieur]\\n`\n          }\n          content += exercice.content\n          content += '\\n\\\\end{exercice}\\n'\n          content += '\\n\\\\begin{Solution}\\n'\n          content += exercice.contentCorr\n          content += '\\n\\\\end{Solution}\\n'\n        }\n      } else {\n        content += '\\n\\\\needspace{10\\\\baselineskip}'\n        if (latexFileInfos.qrcodeOption === 'AvecQrcode') {\n          content += `\\n\\\\begin{exercice}[${\n            latexFileInfos.titleOption === 'AvecTitre'\n              ? `Titre=${exercice.titre}, `\n              : ''\n          }Ajout={\\\\node[anchor=north east, inner sep=2pt]\n        at (frame.north east) {\\\\hypersetup{urlcolor=black}\\\\qrcode[height=2cm]{${getUrlFromExercice(exercice, indiceVersion)}&v=eleve&es=0211}};\n}]%[Lignes=5,Interieur]`\n        } else {\n          content += `\\n\\\\begin{exercice}${\n            latexFileInfos.titleOption === 'AvecTitre'\n              ? `[Titre=${exercice.titre}]`\n              : ''\n          }%[Lignes=5,Interieur]\\n`\n        }\n        content += testIfLoaded(\n          [\n            ...exercice.listeQuestions,\n            exercice.consigne,\n            exercice.introduction,\n          ],\n          '\\\\anote{',\n          '\\n\\\\resetcustomnotes',\n        )\n        if (\n          latexFileInfos.qrcodeOption === 'AvecQrcode' &&\n          (exercice.introduction.length > 40 || exercice.consigne.length > 40)\n        ) {\n          // il faut un espace pour le QRCODE\n          content += '\\n\\\\vspace{2cm}'\n        }\n        content += writeIntroduction(exercice.introduction)\n        content += '\\n' + format(exercice.consigne)\n        content += writeInCols(\n          writeQuestions(\n            exercice.listeQuestions,\n            exercice.spacing,\n            Boolean(exercice.listeAvecNumerotation),\n            Number(exercice.nbCols),\n            confExo,\n          ),\n          confExo.cols ? confExo.cols : Number(exercice.nbCols),\n        )\n        content += testIfLoaded(\n          [\n            ...exercice.listeQuestions,\n            exercice.consigne,\n            exercice.introduction,\n          ],\n          '\\\\anote{',\n          '\\n\\\\printcustomnotes',\n        )\n        content += '\\n\\\\end{exercice}\\n'\n        content += '\\n\\\\begin{Solution}'\n        content += testIfLoaded(\n          [...exercice.listeCorrections],\n          '\\\\anote{',\n          '\\n\\\\resetcustomnotes',\n        )\n        content += writeInCols(\n          writeQuestions(\n            exercice.listeCorrections,\n            exercice.spacingCorr,\n            Boolean(exercice.listeAvecNumerotation),\n            Number(exercice.nbCols),\n          ),\n          confExo.cols_corr ? confExo.cols_corr : Number(exercice.nbColsCorr),\n        )\n        content += testIfLoaded(\n          [...exercice.listeCorrections],\n          '\\\\anote{',\n          '\\n\\\\printcustomnotes',\n        )\n        content += '\\n\\\\end{Solution}\\n'\n      }\n    }\n    return content\n  }\n\n  async getContents(latexFileInfos: LatexFileInfos): Promise<contentsType> {\n    const contents: contentsType = {\n      preamble: '',\n      intro: '',\n      content: '',\n      contentCorr: '',\n    }\n    if (\n      latexFileInfos.style === 'ProfMaquette' ||\n      latexFileInfos.style === 'ProfMaquetteQrcode'\n    ) {\n      if (latexFileInfos.style === 'ProfMaquette') {\n        for (let i = 1; i < latexFileInfos.nbVersions + 1; i++) {\n          if (latexFileInfos.signal?.aborted) {\n            throw new DOMException(\n              'Aborted in getContents of Latex.ts',\n              'AbortError',\n            )\n          }\n          const contentVersion = this.getContentForAVersionProfMaquette(\n            i,\n            latexFileInfos,\n          )\n          contents.content += `\\n\\\\begin{Maquette}[Fiche=${latexFileInfos.typeFiche === 'Fiche' ? 'true' : 'false'},IE=${latexFileInfos.typeFiche === 'Fiche' ? 'false' : 'true'}]{Numero= ,Niveau=${latexFileInfos.subtitle || ' '},Classe=${latexFileInfos.reference || ' '},Date= ${latexFileInfos.nbVersions > 1 ? 'v' + i : ' '} ,Theme=${latexFileInfos.title || 'Exercices'},Code= ,Calculatrice=false}\\n`\n          contents.content += contentVersion\n\n          contents.content += '\\n\\\\end{Maquette}'\n          contents.content += '\\n\\\\clearpage'\n          contents.contentCorr = ''\n        }\n      } else if (latexFileInfos.style === 'ProfMaquetteQrcode') {\n        for (let i = 1; i < latexFileInfos.nbVersions + 1; i++) {\n          if (latexFileInfos.signal?.aborted) {\n            throw new DOMException(\n              'Aborted2 in getContents of Latex.ts',\n              'AbortError',\n            )\n          }\n          latexFileInfos.qrcodeOption = 'AvecQrcode'\n          const contentVersion = this.getContentForAVersionProfMaquette(\n            i,\n            latexFileInfos,\n          )\n          contents.content += `\\n\\\\begin{Maquette}[Fiche=true, IE=false, CorrigeApres=false, CorrigeFin=true]{Niveau=${latexFileInfos.subtitle || ' '},Classe=${latexFileInfos.reference || ' '},Date= ${latexFileInfos.nbVersions > 1 ? 'v' + i : ' '} ,Theme=${latexFileInfos.title || 'Exercices'}}\\n`\n          contents.content += contentVersion\n          contents.content += '\\n\\\\end{Maquette}'\n          contents.content += '\\n\\\\clearpage'\n          contents.contentCorr = ''\n        }\n      }\n      if (latexFileInfos.signal?.aborted) {\n        throw new DOMException(\n          'Aborted3 in getContents of Latex.ts',\n          'AbortError',\n        )\n      }\n      this.loadPreambuleFromContents(contents, latexFileInfos)\n      contents.intro += '\\n\\\\begin{document}'\n    } else {\n      for (let i = 1; i < latexFileInfos.nbVersions + 1; i++) {\n        if (latexFileInfos.signal?.aborted) {\n          throw new DOMException(\n            'Aborted in getContents of Latex.ts',\n            'AbortError',\n          )\n        }\n        const contentVersion = this.getContentsForAVersion(latexFileInfos, i)\n        if (i > 1) {\n          contents.content += '\\n\\\\clearpage'\n          contents.content += '\\n\\\\setcounter{ExoMA}{0}'\n          contents.contentCorr += '\\n\\\\clearpage'\n          contents.contentCorr += '\\n\\\\setcounter{ExoMA}{0}'\n        }\n        if (latexFileInfos.nbVersions > 1) {\n          contents.content += `\\n\\\\version{${i}}`\n          contents.contentCorr += `\\n\\\\version{${i}}`\n          if (i > 1 && latexFileInfos.style === 'Can') {\n            contents.content += '\\n\\\\setcounter{nbEx}{1}'\n            contents.content += '\\n\\\\setcounter{CompteurTableauCan}{0}'\n            contents.content += '\\n\\\\pageDeGardeCan{nbEx}\\n\\\\clearpage'\n          }\n        }\n        contents.content += contentVersion.content\n        contents.contentCorr += contentVersion.contentCorr\n      }\n      if (latexFileInfos.signal?.aborted) {\n        throw new DOMException(\n          'Aborted in getContents of Latex.ts',\n          'AbortError',\n        )\n      }\n      if (latexFileInfos.style === 'Can') {\n        contents.preamble += `\\\\documentclass[a4paper,11pt,fleqn]{article}\\n\\n${addPackages(latexFileInfos, contents)}\\n\\n`\n        contents.preamble +=\n          '% Pour les carrs des cases  cocher\\n\\\\usepackage{fontawesome5}\\n\\n'\n        contents.preamble += '\\n\\\\newbool{correctionDisplay}'\n        contents.preamble += `\\n\\\\setbool{correctionDisplay}{${latexFileInfos.correctionOption === 'AvecCorrection' ? 'true' : 'false'}}`\n        contents.preamble += `\\n\\\\Theme[CAN]{}{}{${latexFileInfos.durationCanOption}}{}`\n        contents.intro += '\\n\\\\begin{document}'\n        contents.intro += '\\n\\\\setcounter{nbEx}{1}'\n        contents.intro += '\\n\\\\setcounter{CompteurTableauCan}{0}'\n        contents.intro += '\\n\\\\pageDeGardeCan{nbEx}'\n        contents.intro += '\\n\\\\clearpage'\n      } else {\n        contents.preamble += `\\\\documentclass[a4paper,11pt,fleqn]{article}\\n\\n${addPackages(latexFileInfos, contents)}\\n\\n`\n        contents.preamble += `\\\\Theme[${latexFileInfos.style}]{nombres}{${latexFileInfos.title}}{${latexFileInfos.reference}}{${latexFileInfos.subtitle}}`\n        contents.intro += '\\n\\\\begin{document}\\n'\n      }\n    }\n    return contents\n  }\n\n  private loadPreambuleFromContents(\n    contents: contentsType,\n    latexFileInfos: LatexFileInfos,\n  ) {\n    const currentUrl = new URL(window.location.href)\n    currentUrl.hostname = 'www.coopmaths.fr'\n    currentUrl.port = ''\n    currentUrl.protocol = 'https:'\n    currentUrl.searchParams.set('v', 'eleve')\n    contents.preamble = `% @see : ${currentUrl.href.replaceAll('%', '\\\\%')}`\n    contents.preamble += '\\n\\\\documentclass[a4paper,11pt,fleqn]{article}'\n    loadProfCollegeIfNeed(contents) // avant profmaquette sinon a plante\n    contents.preamble += '\\n\\\\usepackage{xcolor}'\n    contents.preamble += '\\n\\\\usepackage{ProfMaquette}'\n    contents.preamble += `\\n\\\\setKVdefault[Boulot]{CorrigeFin=${latexFileInfos.correctionOption === 'AvecCorrection' ? 'true' : 'false'}}`\n    contents.preamble +=\n      '\\n\\\\setKVdefault[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}'\n    contents.preamble +=\n      '\\n\\\\usepackage[left=1.5cm,right=1.5cm,top=2cm,bottom=2cm]{geometry}'\n    contents.preamble += '\\n\\\\usepackage[luatex]{hyperref}'\n    contents.preamble += '\\n\\\\usepackage{tikz}'\n    contents.preamble += '\\n\\\\usetikzlibrary{calc}'\n    contents.preamble += '\\n\\\\usepackage{fancyhdr}'\n    contents.preamble += '\\n\\\\pagestyle{fancy}'\n\n    contents.preamble += '\\n\\\\renewcommand\\\\headrulewidth{0pt}'\n    contents.preamble += '\\n\\\\setlength{\\\\headheight}{18pt}'\n    contents.preamble += `\\n\\\\fancyhead[R]{\\\\href{${currentUrl.href.replaceAll('%', '\\\\%')}}{Mathala}}`\n    contents.preamble += '\\n\\\\fancyfoot[C]{\\\\thepage}'\n    contents.preamble += `\\n\\\\fancyfoot[R]{%\n\\\\begin{tikzpicture}[remember picture,overlay]\n  \\\\node[anchor=south east] at ($(current page.south east)+(-2,0.25cm)$) {\\\\scriptsize {\\\\bfseries \\\\href{https://coopmaths.fr/}{Coopmaths.fr} -- \\\\href{http://creativecommons.fr/licences/}{CC-BY-SA}}};\n\\\\end{tikzpicture}\n}`\n    contents.preamble += `\\n\\\\fancyhead[L]{\n\\\\begin{tikzpicture}[y=0.8, x=0.8, yscale=-0.04, xscale=0.04,remember picture, overlay,fill=orange!50,transform canvas={xshift=-1cm,yshift=1cm}]\n%%%% Arc suprieur gauche%%%%\n\\\\path[fill](523,1424)..controls(474,1413)and(404,1372)..(362,1333)..controls(322,1295)and(313,1272)..(331,1254)..controls(348,1236)and(369,1245)..(410,1283)..controls(458,1328)and(517,1356)..(575,1362)..controls(635,1368)and(646,1375)..(643,1404)..controls(641,1428)and(641,1428)..(596,1430)..controls(571,1431)and(538,1428)..(523,1424)--cycle;\n%%%% D face suprieur%%%%\n\\\\path[fill](512,1272)..controls(490,1260)and(195,878)..(195,861)..controls(195,854)and(198,846)..(202,843)..controls(210,838)and(677,772)..(707,772)..controls(720,772)and(737,781)..(753,796)..controls(792,833)and(1057,1179)..(1057,1193)..controls(1057,1200)and(1053,1209)..(1048,1212)..controls(1038,1220)and(590,1283)..(551,1282)..controls(539,1282)and(521,1278)..(512,1272)--cycle;\n%%%% D faces gauche et droite%%%%\n\\\\path[fill](1061,1167)..controls(1050,1158)and(978,1068)..(900,967)..controls(792,829)and(756,777)..(753,756)--(748,729)--(724,745)..controls(704,759)and(660,767)..(456,794)..controls(322,813)and(207,825)..(200,822)..controls(193,820)and(187,812)..(187,804)..controls(188,797)and(229,688)..(279,563)..controls(349,390)and(376,331)..(391,320)..controls(406,309)and(462,299)..(649,273)..controls(780,254)and(897,240)..(907,241)..controls(918,243)and(927,249)..(928,256)..controls(930,264)and(912,315)..(889,372)..controls(866,429)and(848,476)..(849,477)..controls(851,479)and(872,432)..(897,373)..controls(936,276)and(942,266)..(960,266)..controls(975,266)and(999,292)..(1089,408)..controls(1281,654)and(1290,666)..(1290,691)..controls(1290,720)and(1104,1175)..(1090,1180)..controls(1085,1182)and (1071,1176)..(1061,1167)--cycle;\n%%%% Arc infrieur bas%%%%\n\\\\path[fill](1329,861)..controls(1316,848)and(1317,844)..(1339,788)..controls(1364,726)and(1367,654)..(1347,591)..controls(1330,539)and(1338,522)..(1375,526)..controls(1395,528)and(1400,533)..(1412,566)..controls(1432,624)and(1426,760)..(1401,821)..controls(1386,861)and(1380,866)..(1361,868)..controls(1348,870)and(1334,866)..(1329,861)--cycle;\n%%%% Arc infrieur gauche%%%%\n\\\\path[fill](196,373)..controls(181,358)and(186,335)..(213,294)..controls(252,237)and(304,190)..(363,161)..controls(435,124)and(472,127)..(472,170)..controls(472,183)and(462,192)..(414,213)..controls(350,243)and(303,283)..(264,343)..controls(239,383)and(216,393)..(196,373)--cycle;\n\\\\end{tikzpicture}\n}\n%%%%%% Style Fiche\n\\\\tcbset{%\n  userfiche/.style={%\n    %move upwards=-1cm,colback=red!75%\n    top=5pt, left=5pt, right=5pt, colback=red!5!white%\n  }%\n}%\n\\\\tcbset{%\n  userfichecor/.style={%\n    %spread upwards=-1cm,colback=gray!5%\n    top=5pt, left=5pt, right=5pt, colback=red!5!white%\n  }%\n}%\n${latexFileInfos.qrcodeOption === 'AvecQrcode' ? '\\n\\\\tcbset{\\n  tikzfiche/.append style={height=4cm, height plus=25cm}\\n}\\n' : ''}\n${\n  latexFileInfos.typeFiche === 'Eval'\n    ? `\n% Interrogations crites\n% Dfinir un toggle \"calculatrice\"\n\\\\newtoggle{CalculatriceDisplay}\n% Valeur par dfaut : dsactive\n\\\\togglefalse{CalculatriceDisplay}\n\\\\tcbset{%\n  userie/.style={%\n  colback=gray!5,\n  enhanced,%\n  overlay unbroken and first={%\n    \\\\iftoggle{CalculatriceDisplay}{\n    \\\\node[yshift=1em] at (frame.south) {\\\\scriptsize\\\\sffamily-- Calculatrice \\\\ifboolKV[IE]{Calculatrice}{autorise}{interdite} --};\n    }{}\n    }%\n  }%\n}%}`\n    : ''\n}\n% Parametrages\n\\\\hypersetup{\n    colorlinks=true,% On active la couleur pour les liens. Couleur par dfaut rouge\n    linkcolor=blue,% On dfinit la couleur pour les liens internes\n    % filecolor=magenta,% On dfinit la couleur pour les liens vers les fichiers locaux      \n    urlcolor=blue,% On dfinit la couleur pour les liens vers des sites web\n    % pdftitle={Puissance Quatre},% On dfinit un titre pour le document pdf\n    % pdfpagemode=FullScreen,% On fixe l'affichage par dfaut  plein cran\n}`\n    contents.preamble += '\\n\\\\usepackage{qrcode}'\n    contents.preamble += '\\n\\\\usepackage{mathrsfs}'\n    contents.preamble += '\\n\\\\usepackage{enumitem}'\n    contents.preamble += '\\n\\\\usepackage[french]{babel}'\n    contents.preamble += '\\n\\\\setlength{\\\\parindent}{0cm}'\n    loadPackagesFromContent(contents)\n    contents.preamble += loadFonts(latexFileInfos)\n    const [latexCmds, latexPackages] = this.getContentLatex()\n    for (const pack of latexPackages) {\n      logPDF(`pack: ${pack} : ${window.location.href}`)\n      if (pack === 'bclogo') {\n        if (!contents.preamble.includes('bclogo')) {\n          contents.preamble += '\\n\\\\usepackage[tikz]{' + pack + '}'\n        }\n      } else {\n        contents.preamble += '\\n\\\\usepackage{' + pack + '}'\n      }\n    }\n    for (const cmd of latexCmds) {\n      contents.preamble += '\\n' + cmd.replace('cmd', '')\n    }\n  }\n\n  async getFile(latexFileInfos: LatexFileInfos): Promise<latexFileType> {\n    const contents = await this.getContents(latexFileInfos)\n    const preamble = contents?.preamble\n    const intro = contents?.intro\n    const content = contents?.content\n    const contentCorr = contents?.contentCorr\n    let latexWithoutPreamble = ''\n    latexWithoutPreamble += intro\n    latexWithoutPreamble += content\n    if (\n      latexFileInfos.style === 'ProfMaquette' ||\n      latexFileInfos.style === 'ProfMaquetteQrcode'\n    ) {\n      latexWithoutPreamble += '\\n\\\\end{document}'\n    } else if (latexFileInfos.style === 'Can') {\n      latexWithoutPreamble +=\n        '\\n\\n\\\\clearpage\\n\\n\\\\ifbool{correctionDisplay}{\\n\\\\begin{Correction}' +\n        contentCorr +\n        '\\n\\\\clearpage\\n\\\\end{Correction}}{}\\n\\\\end{document}'\n      latexWithoutPreamble +=\n        '\\n\\n% Local Variables:\\n% TeX-engine: luatex\\n% End:'\n    } else {\n      latexWithoutPreamble +=\n        '\\n\\n\\\\clearpage\\n\\n\\\\begin{Correction}' +\n        contentCorr +\n        '\\n\\\\clearpage\\n\\\\end{Correction}\\n\\\\end{document}'\n      latexWithoutPreamble +=\n        '\\n\\n% Local Variables:\\n% TeX-engine: luatex\\n% End:'\n    }\n    const latexWithPreamble = preamble + latexWithoutPreamble\n    return { contents, latexWithoutPreamble, latexWithPreamble }\n  }\n\n  getContentLatex() {\n    const packLatex: string[] = []\n    for (const exo of this.exercices) {\n      if (typeof exo.listePackages === 'string') {\n        packLatex.push(exo.listePackages)\n      } else if (Array.isArray(exo.listePackages)) {\n        packLatex.push(...exo.listePackages)\n      }\n    }\n    const packageFiltered: string[] = packLatex.filter(\n      (value, index, array) => array.indexOf(value) === index,\n    )\n    const [latexCmds, latexPackages] = packageFiltered.reduce(\n      (result: [string[], string[]], element: string) => {\n        result[element.startsWith('cmd') ? 0 : 1].push(element)\n        return result\n      },\n      [[], []],\n    )\n\n    return [latexCmds, latexPackages]\n  }\n}\n\nfunction writeIntroduction(introduction = ''): string {\n  let content = ''\n  if (introduction.length > 0) {\n    content += '\\n' + format(introduction)\n  }\n  return content\n}\n\nfunction writeQuestions(\n  questions: string[],\n  spacing = 1,\n  numbersNeeded: boolean,\n  nbCols: number = 1,\n  confExo: {\n    labels?: string\n    itemsep?: number\n    blocrep?: { nbligs: number; nbcols: number }\n  } = {},\n): string {\n  let content = ''\n  const blocrep = confExo.blocrep\n    ? `\\\\blocrep[1.5]{${confExo.blocrep.nbligs}}{${confExo.blocrep.nbcols}} `\n    : ''\n  if (questions !== undefined && questions.length > 1) {\n    content += '\\n\\\\begin{enumerate}'\n    const specs: string[] = []\n    if (confExo.itemsep !== undefined && confExo.itemsep !== null) {\n      specs.push(`itemsep=${confExo.itemsep}em`)\n    } else if (spacing !== 0) {\n      specs.push(`itemsep=${spacing}em`)\n    }\n    if (confExo.labels) {\n      specs.push(`label=${confExo.labels}`)\n    } else if (!numbersNeeded) {\n      specs.push('label={}')\n    }\n    if (specs.length !== 0) {\n      content += '[' + specs.join(',') + ']'\n    }\n    for (const question of questions) {\n      if (nbCols > 1) {\n        content += `\\n\\t\\\\item \\\\begin{minipage}[t]{\\\\linewidth} ${format(question)} \\\\end{minipage}${blocrep}`\n      } else {\n        content += `\\n\\t\\\\item ${format(question)}${blocrep}`\n      }\n    }\n    content += '\\n\\\\end{enumerate}'\n  } else {\n    if (nbCols > 1) {\n      content += `\\n \\\\begin{minipage}[t]{\\\\linewidth} ${format(questions[0])} \\\\end{minipage}${blocrep}`\n    } else {\n      content += `\\n ${format(questions[0])}${blocrep}`\n    }\n  }\n  return content\n}\n\nfunction writeInCols(text: string, nb: number): string {\n  if (nb < 2) return text\n  return `\\\\begin{multicols}{${nb}}${text}\\n\\\\end{multicols}`\n}\n\n/**\n * Construire la liste des URLs pour les fichiers des images ncessaires\n * ### Remarques :\n * * Chaque URL est construite  partir de l'adresse du site Coopmaths\n * * Elle a __toujours__ pour forme `https://coopmaths.fr/alea/static/<serie>/<annee>/tex/<format>/<nom_image>.<format>`\n * * Elle prsuppose donc que les images sont toutes au format `eps` et qu'elles ne sont pas stockes ailleurs.\n * @author sylvain\n */\nexport function buildImagesUrlsList(\n  exosContentList: ExoContent[],\n  picsNames: picFile[][],\n) {\n  const imagesFilesUrls = [] as string[]\n  exosContentList.forEach((exo, i) => {\n    if (picsNames[i].length !== 0) {\n      const year = exo.year\n      const serie = exo?.serie?.toLowerCase()\n      for (const file of picsNames[i]) {\n        if (serie === 'crpe') {\n          if (file.format) {\n            imagesFilesUrls.push(\n              `${window.location.origin}/alea/static/${serie}/${year}/images/${file.name}.${file.format}`,\n            )\n          } else {\n            imagesFilesUrls.push(\n              `${window.location.origin}/alea/static/${serie}/${year}/images/${file.name}.png`,\n            )\n          }\n        } else if (serie != null) {\n          if (file.format) {\n            imagesFilesUrls.push(\n              `${window.location.origin}/alea/static/${serie}/${year}/tex/${file.format}/${file.name}.${file.format}`,\n            )\n          } else {\n            imagesFilesUrls.push(\n              `${window.location.origin}/alea/static/${serie}/${year}/tex/eps/${file.name}.eps`,\n            )\n          }\n        } else {\n          imagesFilesUrls.push(\n            `${window.location.origin}/alea/${file.name}.${file.format}`,\n          )\n        }\n      }\n    }\n  })\n  return imagesFilesUrls\n}\n\n/**\n * Constituer la liste des noms des images prsentes dans le code de la feuille d'exercices.\n * ### Principe :\n * * Les deux variables globales `exosContentList` et `picsNames` servent  stocker le contenu de chaque\n * exercice et le nom de chaque images.\n * * Dcoupe le contenu du code LaTeX pour identifier les exercices en dtectant\n * le texte entre les deux chanes `\\begin{EXO}` ... `\\end{EXO}` (hormi les corrections o `\\begin{EXO}`\n * est systmatiquement suivi de `{}` vides)\n * * Dans le code de chaque exercice, on repre la commande `\\includegraphics` dans les lignes non prcdes d'un signe `%`\n * et on rcupre le nom du fichier sans l'extension.\n * ### Remarques :\n * * `picsNames` est une tableau de tableaux au cas o des exercices contiendraient plusieurs figures\n * * les figures dans les corrections ne sont pas concernes.\n * @author sylvain\n */\n\nexport function getExosContentList(exercices: TypeExercice[]) {\n  const exosContentList: ExoContent[] = []\n  for (const exo of exercices) {\n    let data: ExoContent = {}\n    if (exo.typeExercice === undefined) {\n      Object.assign(data, {}, { content: exo.contenu ?? '' })\n    } else if (exo.typeExercice === 'simple') {\n      Object.assign(data, {}, { content: exo.listeQuestions.join(' ') })\n    } else {\n      data = {\n        content: exo.content,\n        contentCorr: exo.contentCorr,\n        serie: exo.examen,\n        month: exo.mois,\n        year: exo.annee,\n        zone: exo.lieu,\n        title: [exo.examen, exo.mois, exo.annee, exo.lieu].join(' '),\n      }\n    }\n    exosContentList.push(data)\n  }\n  return exosContentList\n}\nexport function getPicsNames(exosContentList: ExoContent[]) {\n  const picsList = [] as RegExpMatchArray[][]\n  const picsNames = [] as picFile[][]\n  const regDeleteCommentaires = /^(?:(?!%))(.*?)$/gm\n  const regExpImage =\n    /(?:.*?)\\\\includegraphics(?:\\[.*?\\])?\\{(?<fullName>.*?)\\}/gm\n  const regExpImageName = /(?<name>.*?)\\.(?<format>.*)$/gm\n  for (const exo of exosContentList) {\n    if (exo.content) {\n      const pics: RegExpMatchArray[] = []\n      // on supprime les phrases avec des commentaires\n      const content = [...exo.content.matchAll(regDeleteCommentaires)]\n      if (exo.contentCorr) {\n        content.push(...exo.contentCorr.matchAll(regDeleteCommentaires))\n      }\n      content.forEach((list) => {\n        // on recherche sur les lignes restantes si une image ou plusieurs images sont prsentes\n        const matchIm = Array.from(list[0].matchAll(regExpImage))\n        if (matchIm !== null && matchIm.length > 0) {\n          pics.push(...matchIm)\n        }\n      })\n      picsList.push(pics)\n    } else {\n      picsList.push([])\n    }\n  }\n  picsList.forEach((list, index) => {\n    picsNames.push([])\n    if (list.length !== 0) {\n      for (const item of list) {\n        let imgObj\n        if (item[1].match(regExpImageName)) {\n          const imgFile = [...item[1].matchAll(regExpImageName)]\n          if (imgFile[0].groups != null) {\n            imgObj = {\n              name: imgFile[0].groups.name,\n              format: imgFile[0].groups.format,\n            }\n          }\n        } else {\n          imgObj = { name: item[1], format: '' }\n        }\n        if (imgObj != null) {\n          picsNames[index].push(imgObj)\n        }\n      }\n    }\n  })\n  return picsNames\n}\n\n/**\n * Dtecter si le code LaTeX contient des images\n */\nexport function doesLatexNeedsPics(contents: {\n  content: string\n  contentCorr: string\n}) {\n  const exos: ExoContent = {\n    content: contents.content,\n    contentCorr: contents.content,\n  }\n  const imas = getPicsNames([exos])\n  return imas.some((e) => e.length > 0)\n}\n\nexport function makeImageFilesUrls(exercices: TypeExercice[]) {\n  const exosContentList = getExosContentList(exercices)\n  const picsNames = getPicsNames(exosContentList)\n  return buildImagesUrlsList(exosContentList, picsNames)\n}\n\n/**\n * Pour les exercices Mathalea on a des conventions pour les sauts de ligne qui fonctionnent en HTML comme en LaTeX\n * * `<br>` est remplac par un saut de paragraphe\n * * `<br><br>` est remplac par un saut de paragraphe et un medskip (si AvecLesDoublesEspaces est vrai). Dans this.consigne, il ne faut pas sinon cela fait planter la sortie LaTeX.\n *  Le \\\\euro mange l'espace qui vient aprs lui, d'o la ncessit d'insrer un espace inscable s'il y en avait un avant le replacement.\n */\nexport function format(\n  text: string,\n  AvecLesDoublesEspaces: boolean = true,\n): string {\n  if (text === undefined) return ''\n  const lang = getLang()\n  let formattedText = AvecLesDoublesEspaces\n    ? text.replace(/(<br *\\/?>[\\n\\t ]*)+<br *\\/?>/gim, '\\n\\n\\\\medskip\\n')\n    : text\n\n  formattedText = formattedText\n    .replace(/(\\d+)\\s*/g, '\\\\ang{$1}')\n    .replace(/<br>/g, '\\\\\\\\')\n    .replace(/( )?( )/g, '\\\\,\\\\euro{}~')\n    .replace(/( )?/g, '\\\\,\\\\euro{}')\n    .replace(/\\\\\\\\\\s*\\n\\n/gm, '\\\\\\\\')\n    .replaceAll('', '\\\\og{}')\n    .replaceAll('', '\\\\fg{}')\n    .replaceAll('', '\\\\oe ')\n    .replaceAll('', '$^\\\\circ$ ')\n\n  // Check if the language is 'fr-CH' and replace \\times with \\cdot if true\n  if (lang === 'fr-CH') {\n    formattedText = formattedText.replace(/\\\\times/g, '\\\\cdot')\n  }\n\n  return formattedText\n}\n\nfunction getUrlFromExercice(ex: TypeExercice, version: number = 1): string {\n  const url = new URL('https://coopmaths.fr/alea')\n  url.searchParams.append('uuid', String(ex.uuid))\n  if (ex.id !== undefined) url.searchParams.append('id', ex.id)\n  if (ex.nbQuestions !== undefined) {\n    url.searchParams.append('n', ex.nbQuestions.toString())\n  }\n  if (ex.duration !== undefined) {\n    url.searchParams.append('d', ex.duration.toString())\n  }\n  if (ex.sup !== undefined) url.searchParams.append('s', ex.sup)\n  if (ex.sup2 !== undefined) url.searchParams.append('s2', ex.sup2)\n  if (ex.sup3 !== undefined) url.searchParams.append('s3', ex.sup3)\n  if (ex.sup4 !== undefined) url.searchParams.append('s4', ex.sup4)\n  if (ex.sup5 !== undefined) url.searchParams.append('s5', ex.sup5)\n  if (ex.seed !== undefined)\n    url.searchParams.append(\n      'alea',\n      version > 1 ? ex.seed + version.toString : ex.seed,\n    )\n  if (ex.interactif) url.searchParams.append('i', '1')\n  if (ex.correctionDetaillee !== undefined) {\n    url.searchParams.append('cd', ex.correctionDetaillee ? '1' : '0')\n  }\n  if (ex.nbCols !== undefined) {\n    url.searchParams.append('cols', ex.nbCols.toString())\n  }\n  return url.href.replaceAll('%', '\\\\%')\n}\n\nfunction addPackages(latexFileInfos: LatexFileInfos, contents: contentsType) {\n  contents.preamble += genericPreamble\n  loadPreambule(latexFileInfos, contents)\n  contents.preamble += loadFonts(latexFileInfos)\n  return contents.preamble\n}\n\nexport default Latex\n","import JSZip from 'jszip'\nimport JSZipUtils from 'jszip-utils'\nimport { saveAs } from 'file-saver'\nimport {\n  buildImagesUrlsList,\n  doesLatexNeedsPics,\n  getExosContentList,\n  getPicsNames,\n  type latexFileType,\n} from './Latex'\nimport type TypeExercice from '../exercices/Exercice'\n\nexport function downloadZip(filesUrls: string[], zipFileName: string) {\n  const zip = new JSZip()\n  let count = 0\n  filesUrls.forEach((url) => {\n    JSZipUtils.getBinaryContent(url, (err, data) => {\n      if (err) {\n        throw err\n      }\n      const splitUrl = url.split('/')\n      const fileName = splitUrl[splitUrl.length - 1]\n      zip.file(fileName, data ?? '', { binary: true })\n      count++\n      if (count === filesUrls.length) {\n        zip.generateAsync({ type: 'blob' }).then((content) => {\n          saveAs(content, zipFileName)\n        })\n      }\n    })\n  })\n}\n\n/**\n * Construit l'archive ZIP contenant le code LaTeX et tous les fichiers images ncessaires pour la compilation du code LaTeX\n * @param {string} zipFileName nom donn pour l'archive\n * @param {Latex} latex objet Latex contenant les donnes des exercices\n * @param {LatexFileInfos} filesInfo paramtres du fichier LaTeX  gnrer\n * @author sylvain\n */\nexport async function downloadTexWithImagesZip(\n  zipFileName: string,\n  latexFile: latexFileType,\n  exercices: TypeExercice[],\n) {\n  const zip = new JSZip()\n  const withImages = doesLatexNeedsPics(latexFile.contents)\n  const exosContentList = getExosContentList(exercices)\n  const picsNames = getPicsNames(exosContentList)\n  zip.file('main.tex', latexFile.latexWithPreamble)\n  if (withImages) {\n    const urls = buildImagesUrlsList(exosContentList, picsNames)\n    const imagesFolder = zip.folder('images')\n    let count = 0\n    urls.forEach((url) => {\n      JSZipUtils.getBinaryContent(url, (err, data) => {\n        if (err) {\n          throw err\n        }\n        const splitUrl = url.split('/')\n        const fileName = splitUrl[splitUrl.length - 1]\n        imagesFolder?.file(fileName, data ?? '', { binary: true })\n        count++\n        if (count === urls.length) {\n          zip.generateAsync({ type: 'blob' }).then((content) => {\n            // saveAs(content, [archiveName.replace(/\\.(?:.*)$/g, \"\"), \"zip\"].join(\".\"))\n            saveAs(content, [zipFileName, 'zip'].join('.'))\n          })\n        }\n      })\n    })\n  } else {\n    zip.generateAsync({ type: 'blob' }).then((content) => {\n      saveAs(content, [zipFileName, 'zip'].join('.'))\n    })\n  }\n}\n\nexport async function downloadFile(\n  content: string,\n  fileName: string,\n): Promise<'success' | 'error'> {\n  try {\n    const element = document.createElement('a')\n    element.setAttribute(\n      'href',\n      'data:text/plain;charset=utf-8,' + encodeURIComponent(content),\n    )\n    element.setAttribute('download', fileName)\n    element.style.display = 'none'\n    document.body.appendChild(element)\n    element.click()\n    document.body.removeChild(element)\n  } catch (error) {\n    console.error('Impossible de tlcharger le fichier', error)\n    return 'error'\n  }\n  return 'success'\n}\n","<script lang=\"ts\">\n  import BasicClassicModal from './BasicClassicModal.svelte'\n\n  export let contentDisplayed: 'success' | 'error' | 'none' //  bind avec le parent\n  export let successMessage: string\n  export let errorMessage: string\n  export let displayDuration: number = 3000\n\n  let isSuccessDisplayed: boolean\n  $: if (contentDisplayed === 'success') {\n    isSuccessDisplayed = true\n    setTimeout(() => {\n      contentDisplayed = 'none'\n    }, displayDuration)\n  }\n\n  let isErrorDisplayed: boolean\n  $: if (contentDisplayed === 'error') {\n    isErrorDisplayed = true\n    setTimeout(() => {\n      contentDisplayed = 'none'\n    }, displayDuration)\n  }\n\n  $: if (contentDisplayed === 'none') {\n    isSuccessDisplayed = false\n    isErrorDisplayed = false\n  }\n</script>\n\n<BasicClassicModal\n  isWithCloseButton=\"{false}\"\n  bind:isDisplayed=\"{isSuccessDisplayed}\"\n  on:close=\"{() => (contentDisplayed = 'none')}\"\n>\n  <div slot=\"content\">\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    {@html successMessage}\n  </div>\n</BasicClassicModal>\n\n<BasicClassicModal\n  isWithCloseButton=\"{false}\"\n  bind:isDisplayed=\"{isErrorDisplayed}\"\n  on:close=\"{() => (contentDisplayed = 'none')}\"\n>\n  <div slot=\"content\">\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    {@html errorMessage}\n  </div>\n</BasicClassicModal>\n","<script lang=\"ts\">\n  import { buildMathAleaURL } from '../../../lib/components/urls'\n  import { downloadFile } from '../../../lib/files'\n  import BasicInfoModal from '../modal/BasicInfoModal.svelte'\n  import ButtonIconTooltip from './ButtonIconTooltip.svelte'\n  import ButtonTextAction from './ButtonTextAction.svelte'\n\n  export let action: 'copy' | 'download'\n  export let textToCopy: string = ''\n  export let urlToDownload: string = ''\n  export let fileName: string = 'mathAlea'\n  export let useCurrentUrl: boolean = false\n  export let removeSeed: boolean = false\n\n  export let icon: string = ''\n  export let tooltip: string = ''\n  export let disabled: boolean = false\n  export let floatUnderText: string = ''\n  export let cornerIcon: string = ''\n  export let cornerIconClass: string = ''\n\n  export let text: string = ''\n  export let title: string = ''\n  export let inverted: boolean = false\n\n  export let successMessage: string = 'Copi dans le presse-papier'\n  export let errorMessage: string =\n    'Une erreur est survenue lors de la copie dans le presse-papier.'\n  export let displayDuration: number = 3000\n\n  let contentDisplayed: 'success' | 'error' | 'none' = 'none'\n\n  let actionFunction: () => void\n  $: actionFunction = action === 'copy' ? copyToClipboard : download\n\n  // Reactive statement to update actionFunction when textToCopy changes\n  $: if (action === 'copy') {\n    actionFunction = copyToClipboard\n  } else {\n    actionFunction = download\n  }\n\n  function copyToClipboard() {\n    if (textToCopy === '' && !useCurrentUrl) {\n      console.error('Le texte  copier est vide')\n      contentDisplayed = 'error'\n      return\n    }\n    navigator.clipboard\n      .writeText(\n        useCurrentUrl\n          ? buildMathAleaURL({ removeSeed }).toString()\n          : textToCopy,\n      )\n      .then(\n        () => {\n          contentDisplayed = 'success'\n        },\n        (err) => {\n          console.error(\n            'Impossible de copier le texte dans le presse-papier',\n            err,\n          )\n          contentDisplayed = 'error'\n        },\n      )\n  }\n\n  function download() {\n    if (urlToDownload === '' && !useCurrentUrl) {\n      console.error(\"L'URL  tlcharger est vide\")\n      return\n    }\n    const text = `<html><head><meta http-equiv=\"refresh\" content=\"0;URL=${encodeURI(useCurrentUrl ? buildMathAleaURL({}).toString() : urlToDownload)}\"></head></html>`\n    downloadFile(text, `${fileName}.html`).then((returnString) => {\n      contentDisplayed = returnString\n    })\n  }\n</script>\n\n{#if text === ''}\n  <ButtonIconTooltip\n    {icon}\n    {tooltip}\n    {disabled}\n    {floatUnderText}\n    {cornerIcon}\n    {cornerIconClass}\n    class=\"{$$props.class || ''}\"\n    on:click=\"{actionFunction}\"\n  />\n{:else}\n  <ButtonTextAction\n    {text}\n    {title}\n    {disabled}\n    {icon}\n    {inverted}\n    class=\"{$$props.class || ''}\"\n    on:click=\"{actionFunction}\"\n  />\n{/if}\n\n<BasicInfoModal\n  bind:contentDisplayed\n  {successMessage}\n  {errorMessage}\n  {displayDuration}\n/>\n","<script lang=\"ts\">\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import { darkMode } from '../../../lib/stores/generalStore'\n  import Footer from '../../Footer.svelte'\n  import { writable } from 'svelte/store'\n  import { mathaleaGetExercicesFromParams } from '../../../lib/mathalea'\n  import type Exercice from '../../../exercices/Exercice'\n  import { generateLatex, handleUrl } from '../../../lib/alacarte'\n  import ButtonActionInfo from '../../shared/forms/ButtonActionInfo.svelte'\n  import ButtonTextAction from '../../shared/forms/ButtonTextAction.svelte'\n\n  const userInput = writable('')\n  const latexOutput = writable('')\n\n  const itemsWithExercises: { [key: string]: Exercice[] } = {}\n\n  function formatUserInput() {\n    try {\n      const parsedInput = JSON.parse($userInput)\n      userInput.set(JSON.stringify(parsedInput, null, 4))\n      return true\n    } catch (e) {\n      console.info('JSON non valide')\n      return false\n    }\n  }\n\n  async function handleValidate() {\n    if (!formatUserInput()) {\n      alert('JSON invalide')\n      return\n    }\n    const userSettings = JSON.parse($userInput)\n    const items = userSettings?.items ?? {}\n    for (const item in items) {\n      if (typeof items[item] === 'string') {\n        const url = new URL(items[item])\n        const exercisesParams = handleUrl(url)\n        const exercises = await mathaleaGetExercicesFromParams(exercisesParams)\n        itemsWithExercises[item] = exercises\n      }\n    }\n    const content = generateLatex(userSettings, itemsWithExercises)\n    latexOutput.set(content)\n    navigator.clipboard\n      .writeText(content)\n      .then(() => {\n        alert('Code LaTeX copi dans le presse-papiers')\n      })\n      .catch((err) => {\n        console.error('Erreur lors de la copie dans le presse-papiers: ', err)\n      })\n  }\n\n  function handleKeyDownUserInput(event: KeyboardEvent) {\n    if (event.key === 'Tab') {\n      event.preventDefault()\n    }\n  }\n\n  const defaultValueForUserInput = `{\n    \"items\": {\n        \"Pythagore\": \"https://coopmaths.fr/alea/?uuid=bd660&id=4G20&n=1&d=10&s=3&s2=3&s3=false&alea=DEW7&cd=1&uuid=40c47&id=4G20-1&n=1&d=10&s=1&s2=3&s3=false&alea=scAR&cd=1\",\n        \"Relatifs\": \"https://coopmaths.fr/alea/?uuid=745ba&id=4C10&alea=Vlug\"\n    },\n    \"documents\": [\n        {\n            \"title\": \"lve 1\",\n            \"items\": [\n                \"Pythagore\"\n            ],\n            \"number\": 2\n        },\n        {\n            \"title\": \"lve 2\",\n            \"items\": [\n                \"Pythagore\",\n                \"Relatifs\"\n            ],\n            \"number\": 2\n        }\n    ]\n}`\n\n  userInput.set(defaultValueForUserInput)\n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\" la carte\"\n    subtitleType=\"export\"\n    handleLanguage=\"{() => {}}\"\n    locale=\"{$referentielLocale}\"\n  />\n\n  <section\n    class=\"px-4 py-0 md:py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  >\n    <textarea\n      bind:value=\"{$userInput}\"\n      class=\"w-full p-2 border rounded mb-5\"\n      rows=\"10\"\n      placeholder=\"\"\n      on:keydown=\"{handleKeyDownUserInput}\"\n    ></textarea>\n\n    <ButtonTextAction text=\"Valider\" on:click=\"{handleValidate}\" />\n\n    <ButtonActionInfo\n      action=\"copy\"\n      textToCopy=\"{$latexOutput}\"\n      text=\"Copier le code\"\n      successMessage=\"Code LaTeX copi\"\n      errorMessage=\"Impossible de copier le code LaTeX dans le presse-papier\"\n      class=\"px-2 py-1 rounded-md\"\n    />\n\n    <pre\n      class=\"my-10 shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus dark:text-coopmathsdark-corpus p-4 w-full overflow-y-auto overflow-x-scroll text-xs\">\n      {$latexOutput}\n    </pre>\n  </section>\n  <footer>\n    <Footer />\n  </footer>\n</main>\n\n<style>\n  footer {\n    margin-top: auto;\n  }\n</style>\n","import { elimineDoublons } from '../../lib/interactif/qcm'\nimport { randint } from '../../modules/outils'\nimport { format as formatLatex } from '../Latex'\nimport {\n  arrondi,\n  nombreDeChiffresDansLaPartieDecimale,\n  nombreDeChiffresDansLaPartieEntiere,\n  nombreDeChiffresDe,\n} from '../outils/nombres'\nimport { lettreDepuisChiffre } from '../outils/outilString'\nimport { decimalToScientifique } from '../outils/texNombre'\n\n/**\n *\n * @param {array} exercice TypeExercice\n * @param {number} idExo c'est un numro unique pour grer les noms des lments d'un groupe de question, il est incrment par creerDocumentAmc()\n */\n\nexport function exportQcmAmc(exercice, idExo) {\n  let ref = `${exercice.id}/${exercice.sup ? 'S:' + exercice.sup : ''}${exercice.sup2 ? 'S2:' + exercice.sup2 : ''}${exercice.sup3 ? 'S3:' + exercice.sup3 : ''}${exercice.sup4 ? 'S4:' + exercice.sup4 : ''}${exercice.sup5 ? 'S5:' + exercice.sup5 : ''}`\n  if (ref[ref.length - 1] === '/') ref = ref.slice(0, -1)\n  const autoCorrection = exercice.autoCorrection\n  const titre = exercice.titre\n  const type = exercice.amcType\n  let texQr = ''\n  let id = 0\n  let horizontalite = 'reponseshoriz'\n  let lastchoice = false\n  let ordered = false\n  let nbChiffresPd, nbChiffresPe\n  let melange = true\n  let sautDeLigneApresEnonce\n  for (let j = 0; j < autoCorrection.length; j++) {\n    if (autoCorrection[j] === undefined) {\n      // normalement, cela ne devrait jamais arriver !\n      autoCorrection[j] = {}\n    }\n    if (autoCorrection[j].options !== undefined) {\n      if (autoCorrection[j].options.vertical === undefined) {\n        horizontalite = 'reponseshoriz'\n      } else {\n        horizontalite = 'reponses'\n      }\n      if (autoCorrection[j].options.ordered) {\n        ordered = true\n      }\n      if (autoCorrection[j].options.lastChoice !== undefined) {\n        lastchoice = autoCorrection[j].options.lastChoice\n      }\n    }\n    let valeurAMCNum = 0\n    if (autoCorrection[j].reponse !== undefined) {\n      if (!Array.isArray(autoCorrection[j].reponse.valeur))\n        autoCorrection[j].reponse.valeur = [autoCorrection[j].reponse.valeur]\n      valeurAMCNum = autoCorrection[j].reponse.valeur[0]\n      if (typeof valeurAMCNum === 'string') {\n        valeurAMCNum = valeurAMCNum.replace(/\\s/g, '').replaceAll(',', '.')\n      }\n    }\n    switch (type) {\n      case 'qcmMono': // question QCM 1 bonne rponse\n      case 'qcmMult':\n        if (elimineDoublons(autoCorrection[j].propositions)) {\n          console.error('doublons trouvs')\n        }\n        if (autoCorrection[j].enonce === undefined) {\n          autoCorrection[j].enonce = exercice.listeQuestions[j]\n        }\n        texQr += `\\\\element{${ref}}{\\n `\n        texQr += `\\\\begin{${type === 'qcmMono' ? 'question' : 'questionmult'}}{${ref}/${lettreDepuisChiffre(idExo + 1)}${id + 10}} \\n `\n        texQr += `${autoCorrection[j].enonce} \\n `\n        texQr += `\\t\\\\begin{${horizontalite}}`\n        if (ordered) {\n          texQr += '[o]'\n        }\n        texQr += '\\n '\n        for (let i = 0; i < autoCorrection[j].propositions.length; i++) {\n          if (lastchoice > 0 && i === lastchoice) {\n            texQr += '\\t\\t\\\\lastchoices\\n'\n          }\n          if (autoCorrection[j].propositions[i].statut) {\n            texQr += `\\t\\t\\\\bonne{${autoCorrection[j].propositions[i].texte}}\\n `\n          } else {\n            texQr += `\\t\\t\\\\mauvaise{${autoCorrection[j].propositions[i].texte}}\\n `\n          }\n        }\n        texQr += `\\t\\\\end{${horizontalite}}\\n `\n        texQr += `\\\\end{${type === 'qcmMono' ? 'question' : 'questionmult'}}\\n }\\n `\n        id++\n        break\n\n      case 'AMCOpen': // AMCOpen question ouverte corrige par l'enseignant\n        if (autoCorrection[j].enonce === undefined) {\n          autoCorrection[j].enonce = exercice.listeQuestions[j]\n        }\n        if (autoCorrection[j].propositions === undefined) {\n          autoCorrection[j].propositions = [\n            {\n              texte: exercice.listeCorrections[j],\n              statut: '3',\n            },\n          ]\n        }\n        texQr += `\\\\element{${ref}}{\\n `\n        texQr += `\\t\\\\begin{question}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n        texQr += `\\t\\t${autoCorrection[j].enonce} \\n `\n        texQr += `\\t\\t\\\\explain{${autoCorrection[j].propositions[0].texte}}\\n`\n        texQr += `\\t\\t\\\\notation{${autoCorrection[j].propositions[0].statut}}`\n        if (autoCorrection[j].propositions[0].sanscadre !== undefined) {\n          texQr += `[${autoCorrection[j].propositions[0].sanscadre}]` // le statut contiendra si on a un cadre ou pas\n        } else {\n          texQr += '[false]'\n        }\n        if (autoCorrection[j].propositions[0].pointilles !== undefined) {\n          texQr += `[${autoCorrection[j].propositions[0].pointilles}]` // // le statut contiendra les lignes sont des pointills ou vierges\n        } else {\n          texQr += '[true]'\n        }\n\n        texQr += '\\n\\t\\\\end{question}\\n }\\n'\n        id++\n        break\n      case 'AMCNum': // AMCNum avec encodage numrique de la rponse\n        /********************************************************************/\n        // On pourra rajouter des options : les paramtres sont nomms.\n        // {digits=0,digitsDen=0,digitsNum=0,decimals=0,vertical=false,signe=false,exposantNbChiffres=0,exposantSigne=false,approx=0}\n        // si digits=0 alors la fonction va analyser le nombre dcimal (ou entier) pour dterminer digits et decimals\n        // signe et exposantSigne sont des boolens\n        // approx est un entier : on enlve la virgule pour comparer la rponse avec la valeur : approx est le seuil de cette diffrence.\n        /********************************************************************/\n        if (autoCorrection[j].enonce === undefined) {\n          autoCorrection[j].enonce = exercice.listeQuestions[j]\n        }\n        if (autoCorrection[j].propositions === undefined) {\n          autoCorrection[j].propositions = [\n            {\n              texte: exercice.listeCorrections[j],\n              statut: '',\n            },\n          ]\n        }\n        if (!Array.isArray(autoCorrection[j].reponse.valeur)) {\n          autoCorrection[j].reponse.valeur = [autoCorrection[j].reponse.valeur]\n        }\n        if (autoCorrection[j].reponse.param.basePuissance !== undefined) {\n          if (autoCorrection[j].reponse.param.exposantPuissance === undefined) {\n            autoCorrection[j].reponse.param.exposantPuissance = 1000 // Nb volontairement grand pour faire comprendre  l'utilisateur AMC qu'il y a eu une erreur de programmation lors de la conception de l'exercice.\n          }\n          texQr += `\\\\element{${ref}}{\\n`\n          texQr += '\\\\begin{multicols}{2}\\n'\n          texQr += `\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n          texQr += `${autoCorrection[j].enonce} \\n \\\\vspace{0.25cm} \\n`\n          if (autoCorrection[j].propositions !== undefined) {\n            texQr += `\\\\explain{${autoCorrection[j].propositions[0].texte}}\\n`\n          }\n          let digitsBase = 0\n          if (autoCorrection[j].reponse.param.baseNbChiffres !== undefined) {\n            digitsBase = Math.max(\n              autoCorrection[j].reponse.param.baseNbChiffres,\n              nombreDeChiffresDansLaPartieEntiere(\n                autoCorrection[j].reponse.param.basePuissance,\n              ),\n            )\n          } else {\n            digitsBase = nombreDeChiffresDansLaPartieEntiere(\n              autoCorrection[j].reponse.param.basePuissance,\n            )\n          }\n          let digitsExposant = 0\n          if (\n            autoCorrection[j].reponse.param.exposantNbChiffres !== undefined\n          ) {\n            digitsExposant = Math.max(\n              autoCorrection[j].reponse.param.exposantNbChiffres,\n              nombreDeChiffresDansLaPartieEntiere(\n                autoCorrection[j].reponse.param.exposantPuissance,\n              ),\n            )\n          } else {\n            digitsExposant = nombreDeChiffresDansLaPartieEntiere(\n              autoCorrection[j].reponse.param.exposantPuissance,\n            )\n          }\n          texQr += '\\n'\n          texQr += `Base\\n \\\\AMCnumericChoices{${autoCorrection[j].reponse.param.basePuissance}}{digits=${digitsBase},decimals=0,sign=${autoCorrection[j].reponse.param.basePuissance < 0 || autoCorrection[j].reponse.param.signe ? 'true' : 'false'},approx=0,`\n          if (autoCorrection[j].reponse.param.aussiCorrect !== undefined)\n            texQr += `alsocorrect=${autoCorrection[j].reponse.param.aussiCorrect},`\n          texQr += `borderwidth=0pt,backgroundcol=lightgray,scoreapprox=${autoCorrection[j].reponse.param.scoreapprox || 0.667},scoreexact=1,Tpoint={,}}\\n`\n          texQr += '\\\\end{questionmultx}\\n'\n          texQr += '\\\\AMCquestionNumberfalse\\\\def\\\\AMCbeginQuestion#1#2{}'\n          texQr += `\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 1}} \\n `\n          texQr += '\\\\vspace{18pt}'\n          // texQr += `Exposant\\n \\\\AMCnumericChoices{${autoCorrection[j].reponse.param.exposantPuissance}}{digits=${digitsExposant},decimals=0,sign=${autoCorrection[j].reponse.param.exposantPuissance < 0 ? 'true' : 'false'},approx=0,`\n          texQr += `Exposant\\n \\\\AMCnumericChoices{${autoCorrection[j].reponse.param.exposantPuissance}}{digits=${digitsExposant},decimals=0,sign=true,approx=0,`\n          texQr += `borderwidth=0pt,backgroundcol=lightgray,scoreapprox=${autoCorrection[j].reponse.param.scoreapprox || 0.667},scoreexact=1,Tpoint={,}}\\n`\n          texQr += '\\\\end{questionmultx}\\n\\\\end{multicols}\\n}\\n\\n'\n          id += 2\n        } else if (\n          valeurAMCNum !== undefined &&\n          valeurAMCNum.num !== undefined\n        ) {\n          // Si une fraction a t passe  AMCNum, on met un seul AMCNumericChoice particulier\n          texQr += `\\\\element{${ref}}{\\n`\n          texQr += `\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n          texQr += `${autoCorrection[j].enonce} \\n`\n          if (autoCorrection[j].propositions !== undefined) {\n            texQr += `\\\\explain{${autoCorrection[j].propositions[0].texte}}\\n`\n          }\n          let digitsNum = 0\n          if (autoCorrection[j].reponse.param.digitsNum !== undefined) {\n            digitsNum = Math.max(\n              autoCorrection[j].reponse.param.digitsNum,\n              nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.num),\n            )\n          } else if (autoCorrection[j].reponse.param.digits !== undefined) {\n            digitsNum = Math.max(\n              autoCorrection[j].reponse.param.digits,\n              nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.num),\n            )\n          } else {\n            digitsNum = nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.num)\n          }\n          let digitsDen = 0\n          if (autoCorrection[j].reponse.param.digitsDen !== undefined) {\n            digitsDen = Math.max(\n              autoCorrection[j].reponse.param.digitsDen ?? 0,\n              nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den),\n            )\n          } else if (autoCorrection[j].reponse.param.digits !== undefined) {\n            digitsDen = Math.max(\n              autoCorrection[j].reponse.param.digits,\n              nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den),\n            )\n          } else {\n            digitsDen = nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den)\n          }\n          let signeNum = true\n          if (autoCorrection[j].reponse.param.signe !== undefined) {\n            signeNum = autoCorrection[j].reponse.param.signe\n          } else {\n            signeNum = valeurAMCNum.signe === -1\n          }\n          let reponseF\n          let reponseAlsoCorrect\n          if (valeurAMCNum.num > 0) {\n            reponseF = arrondi(\n              valeurAMCNum.num + valeurAMCNum.den / 10 ** digitsDen,\n              8,\n            )\n            reponseAlsoCorrect = arrondi(\n              valeurAMCNum.num +\n                valeurAMCNum.den /\n                  10 ** nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den),\n              8,\n            )\n          } else {\n            reponseF = arrondi(\n              valeurAMCNum.num - valeurAMCNum.den / 10 ** digitsDen,\n              8,\n            )\n            reponseAlsoCorrect = arrondi(\n              valeurAMCNum.num -\n                valeurAMCNum.den /\n                  10 ** nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den),\n              8,\n            )\n          }\n          texQr += `\\\\AMCnumericChoices{${reponseF}}{digits=${digitsNum + digitsDen},decimals=${digitsDen},sign=${signeNum},approx=0,`\n          texQr += `borderwidth=0pt,backgroundcol=lightgray,scoreexact=1,Tpoint={\\\\vspace{0.5cm} \\\\vrule height 0.4pt width 5.5cm },alsocorrect=${reponseAlsoCorrect}}\\n`\n          texQr += '\\\\end{questionmultx}\\n}\\n\\n'\n          id += 2\n        } else {\n          let nbChiffresExpo\n          if (\n            autoCorrection[j].reponse.param.exposantNbChiffres !== undefined &&\n            autoCorrection[j].reponse.param.exposantNbChiffres !== 0\n          ) {\n            nbChiffresPd = Math.max(\n              nombreDeChiffresDansLaPartieDecimale(\n                decimalToScientifique(valeurAMCNum)[0],\n              ),\n              autoCorrection[j].reponse.param.decimals ?? 0,\n            )\n            nbChiffresPe = Math.max(\n              nombreDeChiffresDansLaPartieEntiere(\n                decimalToScientifique(valeurAMCNum)[0],\n              ),\n              isNaN(autoCorrection[j].reponse.param.digits - nbChiffresPd)\n                ? 0\n                : autoCorrection[j].reponse.param.digits - nbChiffresPd,\n            )\n            nbChiffresExpo = Math.max(\n              nombreDeChiffresDansLaPartieEntiere(\n                decimalToScientifique(valeurAMCNum)[1],\n              ),\n              autoCorrection[j].reponse.param.exposantNbChiffres ?? 1,\n            )\n          } else {\n            nbChiffresPd = Math.max(\n              nombreDeChiffresDansLaPartieDecimale(valeurAMCNum),\n              autoCorrection[j].reponse.param.decimals ?? 0,\n            )\n            nbChiffresPe = Math.max(\n              nombreDeChiffresDansLaPartieEntiere(valeurAMCNum),\n              isNaN(autoCorrection[j].reponse.param.digits - nbChiffresPd)\n                ? 0\n                : autoCorrection[j].reponse.param.digits - nbChiffresPd,\n            )\n          }\n          if (autoCorrection[j].reponse.param.milieuIntervalle !== undefined) {\n            const demiMediane =\n              autoCorrection[j].reponse.param.milieuIntervalle - valeurAMCNum\n            nbChiffresPd = Math.max(\n              nbChiffresPd,\n              nombreDeChiffresDansLaPartieDecimale(demiMediane),\n            )\n            valeurAMCNum = autoCorrection[j].reponse.param.milieuIntervalle\n            autoCorrection[j].reponse.param.approx =\n              autoCorrection[j].reponse.param.approx === 'intervalleStrict'\n                ? demiMediane * 10 ** nbChiffresPd - 1\n                : demiMediane * 10 ** nbChiffresPd\n          }\n          texQr += `\\\\element{${ref}}{\\n `\n          texQr += `\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n          texQr += `${autoCorrection[j].enonce} \\n `\n          if (autoCorrection[j].propositions !== undefined) {\n            texQr += `\\\\explain{${autoCorrection[j].propositions[0].texte}}\\n`\n          }\n          if (autoCorrection[j].reponse.textePosition === 'left')\n            texQr += `${autoCorrection[j].reponse.texte} `\n          texQr += `\\\\AMCnumericChoices{${valeurAMCNum}}{digits=${nbChiffresPe + nbChiffresPd},decimals=${nbChiffresPd},sign=${autoCorrection[j].reponse.param.signe},`\n          if (autoCorrection[j].reponse.param.aussiCorrect !== undefined)\n            texQr += `alsocorrect=${autoCorrection[j].reponse.param.aussiCorrect},`\n          if (\n            autoCorrection[j].reponse.param.exposantNbChiffres !== undefined &&\n            autoCorrection[j].reponse.param.exposantNbChiffres !== 0\n          ) {\n            // besoin d'un champ pour la puissance de 10. (notation scientifique)\n            texQr += `exponent=${nbChiffresExpo},exposign=${autoCorrection[j].reponse.param.exposantSigne},`\n          }\n          if (\n            autoCorrection[j].reponse.param.approx !== undefined &&\n            autoCorrection[j].reponse.param.approx !== 0\n          ) {\n            texQr += `approx=${autoCorrection[j].reponse.param.approx},`\n            texQr += `scoreapprox=${autoCorrection[j].reponse.param.scoreapprox || 0.667},`\n          }\n          if (\n            autoCorrection[j].reponse.param.vertical !== undefined &&\n            autoCorrection[j].reponse.param.vertical\n          ) {\n            texQr += `vertical=${autoCorrection[j].reponse.param.vertical},`\n          }\n          if (\n            autoCorrection[j].reponse.param.strict !== undefined &&\n            autoCorrection[j].reponse.param.strict\n          ) {\n            texQr += `strict=${autoCorrection[j].reponse.param.strict},`\n          }\n          if (\n            autoCorrection[j].reponse.param.vhead !== undefined &&\n            autoCorrection[j].reponse.param.vhead\n          ) {\n            texQr += `vhead=${autoCorrection[j].reponse.param.vhead},`\n          }\n          if (\n            autoCorrection[j].reponse.param.tpoint !== undefined &&\n            autoCorrection[j].reponse.param.tpoint\n          ) {\n            texQr += `Tpoint={${autoCorrection[j].reponse.param.tpoint}},`\n          } else {\n            texQr += 'Tpoint={,},'\n          }\n          texQr += 'borderwidth=0pt,backgroundcol=lightgray,scoreexact=1} '\n          if (autoCorrection[j].reponse.textePosition === 'right')\n            texQr += `${autoCorrection[j].reponse.texte}\\n`\n          texQr += '\\\\end{questionmultx}\\n }\\n\\n'\n          id++\n        }\n        break\n      default: // Si on arrive ici, c'est que le type est AMCHybride\n        if (type !== 'AMCHybride') {\n          window.notify(\n            'exportQcmAMC : Il doit y avoir une erreur de type AMC, je ne connais pas le type : ',\n            { type },\n          )\n        }\n\n        if (autoCorrection[j].enonce === undefined) {\n          // Si l'nonc n'a pas t dfini, on va le chercher dans la question\n          autoCorrection[j].enonce = exercice.listeQuestions[j]\n          if (autoCorrection[j].enonce === undefined) break // Toujours vide car exercice.listeQuestions[j] vide. Ce cas se produit lorsqu'on a un exercice avec multi-rponses en interactif mais un seul AMChybride avec plusieurs AMCNum, comme 6N11\n        }\n        if (autoCorrection[j].propositions === undefined) break\n\n        if (autoCorrection[j].melange !== undefined) {\n          melange = autoCorrection[j].melange\n        }\n        texQr += `\\\\element{${ref}}{\\n ` // Un seul lment du groupe de question pour AMC... plusieurs questions dedans !\n        if (typeof autoCorrection[j].options !== 'undefined') {\n          if (autoCorrection[j].options.multicolsAll) {\n            texQr += '\\\\setlength{\\\\columnseprule}{'\n            if (autoCorrection[j].options.barreseparation) {\n              texQr += '0.5'\n            } else {\n              texQr += '0'\n            }\n            texQr += 'pt}\\\\begin{multicols}{2}\\n'\n          }\n        }\n\n        if (typeof autoCorrection[j].options !== 'undefined') {\n          if (autoCorrection[j].options.numerotationEnonce) {\n            texQr += `\\\\begin{question}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}Enonce} \\\\QuestionIndicative `\n          }\n        }\n\n        if (autoCorrection[j].enonceAGauche) {\n          texQr += `\\\\noindent\\\\fbox{\\\\begin{minipage}{${autoCorrection[j].enonceAGauche[0]}\\\\linewidth}\\n`\n        }\n        sautDeLigneApresEnonce = '\\n '\n        if (\n          !(autoCorrection[j].enonceCentre === undefined) ||\n          autoCorrection[j].enonceCentre\n        ) {\n          texQr += '\\\\begin{center}'\n          sautDeLigneApresEnonce = ''\n        }\n        if (autoCorrection[j].enonceAvant === undefined) {\n          // Dans une suite de questions, il se peut qu'il n'y ait pas d'nonc gnral donc pas besoin de saut de ligne non plus.\n          texQr += `${autoCorrection[j].enonce} ` + sautDeLigneApresEnonce\n        } else if (autoCorrection[j].enonceAvant) {\n          texQr += `${autoCorrection[j].enonce} ` + sautDeLigneApresEnonce\n        } else if (autoCorrection[j].enonceAvantUneFois !== undefined) {\n          if (autoCorrection[j].enonceAvantUneFois && j === 0) {\n            texQr += `${autoCorrection[j].enonce} ` + sautDeLigneApresEnonce\n          }\n        }\n        if (\n          !(autoCorrection[j].enonceCentre === undefined) ||\n          autoCorrection[j].enonceCentre\n        ) {\n          texQr += '\\\\end{center}'\n        }\n        if (autoCorrection[j].enonceAGauche) {\n          texQr += `\\\\end{minipage}}\\n\\\\noindent\\\\begin{minipage}[t]{${autoCorrection[j].enonceAGauche[1]}\\\\linewidth}\\n`\n        }\n        if (typeof autoCorrection[j].options !== 'undefined') {\n          if (autoCorrection[j].options.numerotationEnonce) {\n            texQr += '\\\\end{question}\\n'\n          }\n        }\n\n        if (typeof autoCorrection[j].options !== 'undefined') {\n          if (\n            autoCorrection[j].options.multicols &&\n            !autoCorrection[j].options.multicolsAll\n          ) {\n            texQr += '\\\\setlength{\\\\columnseprule}{'\n            if (autoCorrection[j].options.barreseparation) {\n              texQr += '0.5'\n            } else {\n              texQr += '0'\n            }\n            texQr += 'pt}\\\\begin{multicols}{2}\\n'\n          }\n        }\n        for (\n          let qr = 0, qrType, prop, propositions, rep, nbChiffresExpo;\n          qr < autoCorrection[j].propositions.length;\n          qr++\n        ) {\n          // Dbut de la boucle pour traiter toutes les questions-reponses de l'lment j\n          prop = autoCorrection[j].propositions[qr] // prop est un objet avec cette structure : {type,propositions,reponse}\n          qrType = prop.type\n\n          propositions = prop.propositions\n          switch (qrType) {\n            case 'qcmMono': // qcmMono de Hybride\n            case 'qcmMult': // qcmMult de Hybride la diffrence est juste le nom de l'environnement chang dynamiquement\n              if (elimineDoublons(propositions)) {\n                console.info('doublons trouvs')\n              }\n              if (prop.options !== undefined) {\n                if (prop.options.vertical === undefined) {\n                  horizontalite = 'reponseshoriz'\n                } else {\n                  horizontalite = 'reponses'\n                }\n                if (prop.options.ordered) {\n                  ordered = true\n                }\n                if (prop.options.lastChoice !== undefined) {\n                  lastchoice = prop.options.lastChoice\n                }\n              }\n              texQr += `${qr > 0 && (qrType === 'qcmMono' || (qrType === 'qcmMult' && typeof autoCorrection[j].options !== 'undefined' && !autoCorrection[j].options.avecSymboleMult)) ? '\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse' : ''}`\n              texQr +=\n                typeof autoCorrection[j].options !== 'undefined' &&\n                autoCorrection[j].options.numerotationEnonce\n                  ? '\\n \\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse'\n                  : ''\n              texQr += `\\\\begin{${qrType === 'qcmMono' ? 'question' : 'questionmult'}}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n              if (prop.enonce !== undefined) {\n                texQr += prop.enonce + '\\n'\n              }\n              /* EE 13/10/2022 : A mon avis, ne sert  rien. Je le laisse car si pb, on saura que c'est peut-tre cela la raison.\n              if (propositions[0].reponse !== undefined) {\n                if (propositions[0].reponse.texte) {\n                  texQr += propositions[0].reponse.texte + '\\n'\n                }\n              }\n              */\n              texQr += `\\t\\\\begin{${horizontalite}}`\n              if (ordered) {\n                texQr += '[o]'\n              }\n              texQr += '\\n '\n              for (let i = 0; i < propositions.length; i++) {\n                if (lastchoice > 0 && i === lastchoice) {\n                  texQr += '\\t\\t\\\\lastchoices\\n'\n                }\n                if (prop.propositions[i].statut) {\n                  texQr += `\\t\\t\\\\bonne{${propositions[i].texte}}\\n `\n                } else {\n                  texQr += `\\t\\t\\\\mauvaise{${propositions[i].texte}}\\n `\n                }\n              }\n              texQr += `\\t\\\\end{${horizontalite}}\\n `\n              texQr += `\\\\end{${qrType === 'qcmMono' ? 'question' : 'questionmult'}}\\n`\n              id++\n              break\n            case 'AMCNum': // AMCNum de Hybride\n              rep = prop.propositions[0].reponse\n              if (!Array.isArray(rep.valeur)) {\n                // rep.valeur est un tableau si la rponse est une fraction\n                rep.valeur = [rep.valeur]\n              }\n              if (rep.param.basePuissance !== undefined) {\n                // Hybride dont la rponse est une puissance\n                if (rep.param.exposantPuissance === undefined) {\n                  rep.param.exposantPuissance = 1000 // Nb volontairement grand pour faire comprendre  l'utilisateur AMC qu'il y a eu une erreur de programmation lors de la conception de l'exercice.\n                }\n                if (\n                  qr === 0 &&\n                  autoCorrection[j].enonceApresNumQuestion !== undefined &&\n                  autoCorrection[j].enonceApresNumQuestion\n                ) {\n                  texQr += `\\\\begin{questionmultx}{Enonce-${ref}/${lettreDepuisChiffre(idExo + 1)}${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n                  texQr += `${autoCorrection[j].enonce} \\n` // Enonce de la question\n                  texQr += '\\\\end{questionmultx}'\n                }\n\n                // texQr += '\\\\begin{minipage}{\\\\textwidth}\\n'\n                texQr += '\\\\begin{multicols}{2}\\n'\n                texQr += `${qr > 0 || (qr === 0 && autoCorrection[j].enonceApresNumQuestion !== undefined && autoCorrection[j].enonceApresNumQuestion) ? '\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse' : ''}\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n\n                if (propositions !== undefined) {\n                  texQr += `\\\\explain{${propositions[0].texte}}\\n`\n                }\n                texQr += `${rep.texte}\\n \\\\vspace{0.25cm} \\n`\n                let digitsBase = 0\n                if (rep.param.baseNbChiffres !== undefined) {\n                  digitsBase = Math.max(\n                    rep.param.baseNbChiffres,\n                    nombreDeChiffresDansLaPartieEntiere(\n                      rep.param.basePuissance,\n                    ),\n                  )\n                } else {\n                  digitsBase = nombreDeChiffresDansLaPartieEntiere(\n                    rep.param.basePuissance,\n                  )\n                }\n                let digitsExposant = 0\n                if (rep.param.exposantNbChiffres !== undefined) {\n                  digitsExposant = Math.max(\n                    rep.param.exposantNbChiffres,\n                    nombreDeChiffresDansLaPartieEntiere(\n                      rep.param.exposantPuissance,\n                    ),\n                  )\n                } else {\n                  digitsExposant = nombreDeChiffresDansLaPartieEntiere(\n                    rep.param.exposantPuissance,\n                  )\n                }\n                texQr += '\\n'\n                texQr += `Base\\n \\\\AMCnumericChoices{${rep.param.basePuissance}}{digits=${digitsBase},decimals=0,sign=${rep.param.basePuissance < 0 ? 'true' : 'false'},approx=0,`\n                texQr += `borderwidth=0pt,backgroundcol=lightgray,scoreapprox=${rep.param.scoreapprox || 0.667},scoreexact=1,Tpoint={,}}\\n`\n                texQr += '\\\\end{questionmultx}\\n'\n                texQr += '\\\\AMCquestionNumberfalse\\\\def\\\\AMCbeginQuestion#1#2{}'\n                texQr += `\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 1}} \\n `\n                texQr += '\\\\vspace{18pt}'\n                // texQr += `Exposant\\n \\\\AMCnumericChoices{${rep.param.exposantPuissance}}{digits=${digitsExposant},decimals=0,sign=${rep.param.exposantPuissance < 0 ? 'true' : 'false'},approx=0,`\n                texQr += `Exposant\\n \\\\AMCnumericChoices{${rep.param.exposantPuissance}}{digits=${digitsExposant},decimals=0,sign=true,approx=0,`\n                texQr += `borderwidth=0pt,backgroundcol=lightgray,scoreapprox=${rep.param.scoreapprox || 0.667},scoreexact=1,Tpoint={,}}\\n`\n                texQr += '\\\\end{questionmultx}\\\\end{multicols}\\n'\n                // texQr += '\\\\end{minipage}\\n\\n'\n                id += 2\n              } else if (rep.valeur[0].num !== undefined) {\n                // Hybride dont la rponse est une fraction (et non une puissance)\n                // Si une fraction a t passe  AMCNum, on met deux AMCNumericChoice\n                // Pour rappel : rep = prop.propositions[0].reponse\n                valeurAMCNum = rep.valeur[0]\n\n                if (\n                  qr === 0 &&\n                  autoCorrection[j].enonceApresNumQuestion !== undefined &&\n                  autoCorrection[j].enonceApresNumQuestion\n                ) {\n                  texQr += `\\\\begin{questionmultx}{Enonce-${ref}/${lettreDepuisChiffre(idExo + 1)}${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n                  texQr += `${autoCorrection[j].enonce} \\n` // Enonce de la question\n                  texQr += '\\\\end{questionmultx}'\n                }\n\n                texQr += `${qr > 0 || (qr === 0 && autoCorrection[j].enonceApresNumQuestion !== undefined && autoCorrection[j].enonceApresNumQuestion) ? '\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse' : ''}\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n                if (!(propositions[0].reponse.alignement === undefined)) {\n                  texQr += '\\\\begin{'\n                  texQr += `${propositions[0].reponse.alignement}}` // Alignement : gauche, droite, centr\n                }\n\n                if (\n                  !(\n                    qr === 0 &&\n                    autoCorrection[j].enonceApresNumQuestion !== undefined &&\n                    autoCorrection[j].enonceApresNumQuestion\n                  )\n                )\n                  texQr += `${autoCorrection[j].enonce} \\n` // Enonc de la question\n\n                if (propositions !== undefined) {\n                  texQr += `\\\\explain{${propositions[0].texte}}\\n` // Correction\n                }\n                texQr += `${rep.texte}\\n` // Texte juste avant les cases  cocher\n                let digitsNum = 0\n                if (rep.param.digitsNum !== undefined) {\n                  digitsNum = Math.max(\n                    rep.param.digitsNum,\n                    nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.num),\n                  )\n                } else if (rep.param.digits !== undefined) {\n                  digitsNum = Math.max(\n                    rep.param.digits,\n                    nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.num),\n                  )\n                } else {\n                  digitsNum = nombreDeChiffresDansLaPartieEntiere(\n                    valeurAMCNum.num,\n                  )\n                }\n                let digitsDen = 0\n                if (rep.param.digitsDen !== undefined) {\n                  digitsDen = Math.max(\n                    rep.param.digitsDen,\n                    nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den),\n                  )\n                } else if (rep.param.digits !== undefined) {\n                  digitsDen = Math.max(\n                    rep.param.digits,\n                    nombreDeChiffresDansLaPartieEntiere(valeurAMCNum.den),\n                  )\n                } else {\n                  digitsDen = nombreDeChiffresDansLaPartieEntiere(\n                    valeurAMCNum.den,\n                  )\n                }\n                let signeNum = true\n                if (rep.param.signe !== undefined) {\n                  signeNum = rep.param.signe\n                } else {\n                  signeNum = valeurAMCNum.num * valeurAMCNum.den < 0\n                }\n                let reponseF\n                let reponseAlsoCorrect\n                if (\n                  rep.param.aussiCorrect != null &&\n                  rep.param.aussiCorrect.num != null &&\n                  rep.param.aussiCorrect.den != null\n                ) {\n                  if (valeurAMCNum.num > 0) {\n                    reponseF = arrondi(\n                      valeurAMCNum.num + valeurAMCNum.den / 10 ** digitsDen,\n                      digitsDen,\n                    )\n                  } else {\n                    reponseF = arrondi(\n                      valeurAMCNum.num - valeurAMCNum.den / 10 ** digitsDen,\n                      digitsDen,\n                    )\n                  }\n                  if (rep.param.aussiCorrect.num > 0) {\n                    reponseAlsoCorrect = arrondi(\n                      rep.param.aussiCorrect.num +\n                        rep.param.aussiCorrect.den / 10 ** digitsDen,\n                      digitsDen,\n                    )\n                  } else {\n                    reponseAlsoCorrect = arrondi(\n                      rep.param.aussiCorrect.num -\n                        rep.param.aussiCorrect.den / 10 ** digitsDen,\n                    )\n                  }\n                } else {\n                  if (valeurAMCNum.num > 0) {\n                    reponseF = arrondi(\n                      valeurAMCNum.num + valeurAMCNum.den / 10 ** digitsDen,\n                      digitsDen,\n                    )\n                    reponseAlsoCorrect = arrondi(\n                      valeurAMCNum.num +\n                        valeurAMCNum.den /\n                          10 **\n                            nombreDeChiffresDansLaPartieEntiere(\n                              valeurAMCNum.den,\n                            ),\n                      8,\n                    )\n                  } else {\n                    reponseF = arrondi(\n                      valeurAMCNum.num - valeurAMCNum.den / 10 ** digitsDen,\n                      digitsDen,\n                    )\n                    reponseAlsoCorrect = arrondi(\n                      valeurAMCNum.num -\n                        valeurAMCNum.den /\n                          10 **\n                            nombreDeChiffresDansLaPartieEntiere(\n                              valeurAMCNum.den,\n                            ),\n                      8,\n                    )\n                  }\n                }\n                texQr += `\\\\AMCnumericChoices{${reponseF}}{digits=${digitsNum + digitsDen},decimals=${digitsDen},sign=${signeNum},approx=0,`\n                texQr += `borderwidth=0pt,backgroundcol=lightgray,scoreexact=1,Tpoint={\\\\vspace{0.5cm} \\\\vrule height 0.4pt width 5.5cm },alsocorrect=${reponseAlsoCorrect}}\\n`\n                if (!(propositions[0].reponse.alignement === undefined)) {\n                  texQr += '\\\\end{'\n                  texQr += `${propositions[0].reponse.alignement}}`\n                }\n                texQr += '\\\\end{questionmultx}\\n'\n                id += 2\n              } else {\n                // Hybride dont la rponse n'est ni une puissance, ni une fraction mais une valeur numrique simple (dcimal relatif)\n                if (\n                  rep.param.exposantNbChiffres !== undefined &&\n                  rep.param.exposantNbChiffres !== 0\n                ) {\n                  nbChiffresPd = Math.max(\n                    nombreDeChiffresDansLaPartieDecimale(\n                      decimalToScientifique(rep.valeur[0])[0],\n                    ),\n                    rep.param.decimals ?? 0,\n                  )\n                  nbChiffresPe = Math.max(\n                    nombreDeChiffresDansLaPartieEntiere(\n                      decimalToScientifique(rep.valeur[0])[0],\n                    ),\n                    isNaN(rep.param.digits - nbChiffresPd)\n                      ? 0\n                      : rep.param.digits - nbChiffresPd,\n                  )\n                  nbChiffresExpo = Math.max(\n                    nombreDeChiffresDansLaPartieEntiere(\n                      decimalToScientifique(rep.valeur[0])[1],\n                    ),\n                    rep.param.exposantNbChiffres ?? 0,\n                  )\n                } else {\n                  nbChiffresPd = Math.max(\n                    nombreDeChiffresDansLaPartieDecimale(rep.valeur[0]),\n                    rep.param.decimals ?? 0,\n                  )\n                  nbChiffresPe = Math.max(\n                    nombreDeChiffresDansLaPartieEntiere(rep.valeur[0]),\n                    isNaN(rep.param.digits - nbChiffresPd)\n                      ? nombreDeChiffresDe(rep.valeur[0] - nbChiffresPd)\n                      : rep.param.digits - nbChiffresPd,\n                  )\n                }\n                if (rep.param.milieuIntervalle !== undefined) {\n                  const demiMediane = rep.param.milieuIntervalle - valeurAMCNum\n                  nbChiffresPd = Math.max(\n                    nbChiffresPd,\n                    nombreDeChiffresDansLaPartieDecimale(demiMediane),\n                  )\n                  valeurAMCNum = rep.param.milieuIntervalle\n                  rep.param.approx =\n                    autoCorrection[j].reponse.param.approx ===\n                    'intervalleStrict'\n                      ? demiMediane * 10 ** nbChiffresPd - 1\n                      : demiMediane * 10 ** nbChiffresPd\n                }\n\n                // Rajout EE 27/12/2022 : Si on veut que l'nonc soit aprs le numro de la question\n                if (\n                  qr === 0 &&\n                  autoCorrection[j].enonceApresNumQuestion !== undefined &&\n                  autoCorrection[j].enonceApresNumQuestion\n                ) {\n                  texQr += `\\\\begin{questionmultx}{Enonce-${ref}/${lettreDepuisChiffre(idExo + 1)}${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n                  texQr += `${autoCorrection[j].enonce} \\n`\n                  texQr += '\\\\end{questionmultx}'\n                }\n\n                // Rajout EE 27/12/2022 : Si on veut que le multicols commence avant cette question\n                if (\n                  typeof propositions[0].multicolsBegin !== 'undefined' &&\n                  propositions[0].multicolsBegin\n                ) {\n                  texQr += '\\\\setlength{\\\\columnseprule}{'\n                  if (\n                    autoCorrection[j].options.barreseparation !== undefined &&\n                    autoCorrection[j].options.barreseparation\n                  ) {\n                    texQr += '0.5'\n                  } else {\n                    texQr += '0'\n                  }\n                  texQr += 'pt}\\\\begin{multicols}{2}\\n'\n                }\n\n                if (\n                  qr > 0 ||\n                  (qr === 0 &&\n                    autoCorrection[j].enonceApresNumQuestion !== undefined &&\n                    autoCorrection[j].enonceApresNumQuestion)\n                )\n                  texQr +=\n                    '\\n\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse'\n\n                texQr += `\\\\begin{questionmultx}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n `\n                /*\n                if (!(qr === 0 && autoCorrection[j].enonceApresNumQuestion !== undefined && autoCorrection[j].enonceApresNumQuestion)) {\n                  texQr += `${autoCorrection[j].enonce} \\n` // Enonce de la question\n                }\n                */\n                if (propositions !== undefined) {\n                  texQr += `\\\\explain{${propositions[0].texte}}\\n`\n                }\n                texQr += `${rep.texte}\\n`\n                if (!(propositions[0].reponse.alignement === undefined)) {\n                  texQr += '\\\\begin{'\n                  texQr += `${propositions[0].reponse.alignement}}`\n                }\n                texQr += `\\\\AMCnumericChoices{${rep.valeur[0]}}{digits=${nbChiffresPe + nbChiffresPd},decimals=${nbChiffresPd},sign=${rep.param.signe},`\n                if (\n                  rep.param.exposantNbChiffres !== undefined &&\n                  rep.param.exposantNbChiffres !== 0\n                ) {\n                  // besoin d'un champ pour la puissance de 10. (notation scientifique)\n                  texQr += `exponent=${nbChiffresExpo},exposign=${rep.param.exposantSigne},`\n                }\n                if (rep.param.approx !== undefined && rep.param.approx !== 0) {\n                  texQr += `approx=${rep.param.approx},`\n                  // texQr += `scoreapprox=${rep.param.scoreapprox || 0.667},`\n                }\n                if (rep.param.vertical !== undefined && rep.param.vertical) {\n                  texQr += `vertical=${rep.param.vertical},`\n                }\n                if (rep.param.strict !== undefined && rep.param.strict) {\n                  texQr += `strict=${rep.param.strict},`\n                }\n                if (rep.param.vhead !== undefined && rep.param.vhead) {\n                  texQr += `vhead=${rep.param.vhead},`\n                }\n                if (\n                  rep.param.aussiCorrect !== undefined &&\n                  rep.param.aussiCorrect\n                ) {\n                  texQr += `alsocorrect=${rep.param.aussiCorrect},`\n                }\n                if (rep.param.tpoint !== undefined && rep.param.tpoint) {\n                  texQr += `Tpoint={${rep.param.tpoint}},`\n                } else {\n                  texQr += 'Tpoint={,},'\n                }\n                texQr +=\n                  'borderwidth=0pt,backgroundcol=lightgray,scoreexact=1}\\n'\n                if (!(propositions[0].reponse.alignement === undefined)) {\n                  texQr += '\\\\end{'\n                  texQr += `${propositions[0].reponse.alignement}}`\n                }\n                texQr += '\\\\end{questionmultx}\\n'\n                // Rajout EE 27/12/2022 : Si on veut que le multicols finisse eprs cette question\n                if (typeof propositions[0].multicolsEnd !== 'undefined') {\n                  if (propositions[0].multicolsEnd) {\n                    texQr += '\\\\end{multicols}\\n'\n                  }\n                }\n\n                id++\n              }\n              break\n            case 'AMCOpen': // AMCOpen de Hybride\n              // Rajout EE 19/11/2023 : Si on veut que le multicols commence avant cette question\n              if (\n                typeof propositions[0].multicolsBegin !== 'undefined' &&\n                propositions[0].multicolsBegin\n              ) {\n                texQr += '\\\\setlength{\\\\columnseprule}{'\n                if (\n                  autoCorrection[j].options !== undefined &&\n                  autoCorrection[j].options.barreseparation !== undefined &&\n                  autoCorrection[j].options.barreseparation\n                ) {\n                  texQr += '0.5'\n                } else {\n                  texQr += '0'\n                }\n                texQr += '0pt}\\\\begin{multicols}{2}\\n'\n                if (qr > 0)\n                  texQr +=\n                    '\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse'\n              }\n              if (propositions[0].numQuestionVisible === undefined) {\n                texQr += `\\t${qr > 0 ? '\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse' : ''}\\\\begin{question}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n`\n              } else if (propositions[0].numQuestionVisible) {\n                texQr += `\\t${qr > 0 ? '\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse' : ''}\\\\begin{question}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}} \\n`\n              } else {\n                texQr += `\\t\\\\def\\\\AMCbeginQuestion#1#2{}\\\\AMCquestionNumberfalse \\\\begin{question}{${ref}/${lettreDepuisChiffre(idExo + 1)}-${id + 10}}\\\\QuestionIndicative \\n`\n              }\n              if (!(propositions[0].enonce === undefined))\n                texQr += `\\t${propositions[0].enonce}\\n`\n              texQr += `\\t\\t\\\\explain{${propositions[0].texte}}\\n`\n\n              // if (propositions[0].numQuestionVisible === undefined) {\n              texQr += `\\t\\t\\\\notation{${propositions[0].statut}}`\n              if (!isNaN(propositions[0].sanscadre)) {\n                texQr += `[${propositions[0].sanscadre}]` // le statut contiendra si on a un cadre ou pas\n              } else {\n                texQr += '[false]'\n              }\n              if (!isNaN(propositions[0].pointilles)) {\n                texQr += `[${propositions[0].pointilles}]` // le statut contiendra les lignes sont des pointills ou vierges\n              } else {\n                texQr += '[true]'\n              }\n              //  }\n\n              texQr += '\\n' // le statut contiendra le nombre de lignes pour ce type\n              texQr += '\\t\\\\end{question}\\n'\n              // Rajout EE 19/11/2023 : Si on veut que le multicols finisse eprs cette question\n              if (typeof propositions[0].multicolsEnd !== 'undefined') {\n                if (propositions[0].multicolsEnd) {\n                  texQr += '\\\\end{multicols}\\n'\n                }\n              }\n              id++\n              break\n          }\n        }\n        if (typeof autoCorrection[j].options !== 'undefined') {\n          if (\n            autoCorrection[j].options.multicols ||\n            autoCorrection[j].options.multicolsAll\n          ) {\n            texQr += '\\\\end{multicols}\\n'\n          }\n        }\n        if (autoCorrection[j].enonceAGauche) {\n          texQr += '\\\\end{minipage}\\n'\n        }\n        texQr += '}\\n'\n        break\n    }\n  }\n  texQr = texQr.replaceAll(\n    /(<br *\\/?>[\\n\\t ]*)+<br *\\/?>/gim,\n    '\\n\\n\\\\medskip\\n',\n  )\n  texQr = texQr.replaceAll('<br>', '\\\\\\\\\\n')\n  return [texQr, ref, exercice.nbQuestions, titre, melange]\n}\n\n/**\n * @author Jean-Claude Lhote\n * Fonction qui cre un document pour AMC (pour le compiler, le package automultiplechoice.sty doit tre prsent)\n *\n *  exercices est un tableau d'exercies TypeExercice[]\n *\n * nbQuestions est un tableau pour prciser le nombre de questions  prendre dans chaque groupe pour constituer une copie\n * s'il est indfini, toutes les questions du groupe seront poses.\n * nb_exemplaire est le nombre de copies  gnrer\n * matiere et titre se passent de commentaires : ils renseignent l'entte du sujet.\n */\nexport function creerDocumentAmc({\n  exercices,\n  nbQuestions = [],\n  nbExemplaires = 1,\n  matiere = 'Mathmatiques',\n  titre = 'Evaluation',\n  typeEntete = 'AMCcodeGrid',\n  format = 'A4',\n}) {\n  // Attention exercices est maintenant un tableau de tous les exercices.\n  // Dans cette partie, la fonction rcupre toutes les exercices et les trie pour les rassembler par groupe\n  // Toutes les questions d'un mme exercice seront regroupes ce qui permet ventuellement de les rcuprer dans des fichiers individuels pour se constituer une base\n  let idExo = 0\n  let code\n  let indexOfCode\n  const nombreDeQuestionsIndefinie = []\n  const graine = randint(1, 100000)\n  const groupeDeQuestions = []\n  const texQuestions = [[]]\n  const titreQuestion = []\n  const melangeQuestion = []\n  const nombreExoAmc = exercices.filter((el) => el.amcReady).length\n  if (nombreExoAmc === 0) return ''\n  for (const exercice of exercices) {\n    code = exportQcmAmc(exercice, idExo)\n    idExo++\n    indexOfCode = groupeDeQuestions.indexOf(code[1])\n    if (indexOfCode === -1) {\n      // si le groupe n'existe pas\n      groupeDeQuestions.push(code[1])\n      indexOfCode = groupeDeQuestions.indexOf(code[1])\n      texQuestions[indexOfCode] = formatLatex(code[0])\n\n      // Si le nombre de questions du groupe n'est pas dfini, alors on met toutes les questions sinon on laisse le nombre choisi par l'utilisateur\n      if (typeof nbQuestions[indexOfCode] === 'undefined') {\n        nombreDeQuestionsIndefinie[indexOfCode] = true\n        nbQuestions[indexOfCode] = code[2]\n      } else {\n        // Si le nombre de question ( restituer pour ce groupe de question) a t dfini par l'utilisateur, alors on le laisse !\n        nombreDeQuestionsIndefinie[indexOfCode] = false\n      }\n      // Si le nombre de questions du groupe n'est pas dfini, alors on met toutes les questions sinon on laisse le nombre choisi par l'utilisateur\n      titreQuestion[indexOfCode] = code[3]\n      melangeQuestion[indexOfCode] = code[4]\n    } else {\n      // Donc le groupe existe, on va vrifier si la question existe dj et si non, on l'ajoute.\n      if (texQuestions[indexOfCode].indexOf(code[0]) === -1) {\n        texQuestions[indexOfCode] += code[0]\n        // Si le nombre de questions du groupe n'est pas dfini, alors on met toutes les questions sinon on laisse le nombre choisi par l'utilisateur\n        if (nombreDeQuestionsIndefinie[indexOfCode]) {\n          nbQuestions[indexOfCode] += code[2]\n        }\n      }\n    }\n  }\n  // Fin de la prparation des groupes\n\n  let isImpressionRectoVerso = false\n  const checkBoxImpressionRectoVerso = document.getElementById(\n    'impression_recto_verso',\n  )\n  if (checkBoxImpressionRectoVerso !== null)\n    isImpressionRectoVerso = checkBoxImpressionRectoVerso.checked\n  // variable qui contiendra le code LaTeX pour AMC\n  let codeLatex = ''\n\n  // variable preambule  abonder le cas chant si des packages sont ncessaires.\n  // Merci  Sbastien Lozano pour la vrification des dpendances\n  // Merci  Liouba Leroux pour ses documents qui ont servi de base\n  // A faire : abonder le preambule pour qu'il colle  tous les exos Mathalea_AMC\n\n  let preambule = `%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  %%%%% -I- PRAMBULE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  \\n`\n  if (format === 'A3') {\n    preambule += `\\t \\\\documentclass[${isImpressionRectoVerso ? 'twoside,' : ''}10pt,a3paper,landscape,french,svgnames]{article}\\n`\n  } else {\n    preambule += `\\t \\\\documentclass[${isImpressionRectoVerso ? 'twoside,' : ''}10pt,a4paper,french,svgnames]{article}\\n`\n  }\n\n  preambule += `\\t\n  %%%%%% EE : Le mettre le plus tt possible pour viter un Warning  la compilation\n  \\\\RequirePackage{etex}\\t  % pour avoir plus de \"registres\" mmoires / tikz...\n  %%%%% PACKAGES LANGUE %%%%%\n  \\\\usepackage{babel} % sans option => langue dfinie dans la classe du document\n   \\\\usepackage[T1]{fontenc}\n   \\\\usepackage[utf8x]{inputenc}\n   \\\\usepackage{lmodern}\\t        \\t% Choix de la fonte (Latin Modern de D. Knuth)\n   \\\\usepackage{fp}\n   \\\\usepackage{ProfCollege}\n\n  %%%%%%%%%%%%%%%%%%%%% SPCIFICITS A.M.C. %%%%%%%%%%%%%%%%%%%%%%\n  %\\\\usepackage[francais,bloc,completemulti]{automultiplechoice}\n  %   remarque : avec completmulti => \"aucune rponse ne convient\" en +\n   \\\\usepackage[francais,bloc,insidebox,nowatermark]{automultiplechoice} %//,insidebox\n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\n  %%%%% PACKAGES MISE EN PAGE %%%%%\n   \\\\usepackage{multicol}\n   \\\\usepackage{wrapfig}\n   \\\\usepackage{fancybox}  % pour \\\\doublebox \\\\shadowbox  \\\\ovalbox \\\\Ovalbox\n   \\\\usepackage{calc} \\t% Calculs\n   \\\\usepackage{enumerate}\\t% Pour modifier les numrotations\n   \\\\usepackage{enumitem}\n   \\\\usepackage{tabularx}\\t% Pour faire des tableaux\n\n   \\\\usepackage{xargs}\\t% EE : pour permettre DES options dans newcommand\n\n  %%%%% PACKAGES FIGURES %%%%%\n  %\\\\usepackage{pstricks,pst-plot,pstricks-add}\n  %   POUR PSTRICKS d'o compilation sans PDFLateX mais : dvi, dvi2ps, ps2PDF...\n  %   MAIS ON PRFRERA UTILISER TIKZ...\n  \\\\usepackage{xcolor}% [avant tikz] xcolor permet de nommer + de couleurs\n  \\\\usepackage{pgf,tikz}\n  \\\\usepackage{graphicx} % pour inclure une image\n  \\\\usetikzlibrary{arrows,calc,fit,patterns,plotmarks,shapes.geometric,shapes.misc,shapes.symbols,shapes.arrows,\n    shapes.callouts, shapes.multipart, shapes.gates.logic.US,shapes.gates.logic.IEC, er, automata,backgrounds,chains,topaths,trees,petri,mindmap,matrix, calendar, folding,fadings,through,positioning,scopes,decorations.fractals,decorations.shapes,decorations.text,decorations.pathmorphing,decorations.pathreplacing,decorations.footprints,decorations.markings,shadows,babel} % Charge toutes les librairies de Tikz\n  \\\\usepackage{tkz-tab,tkz-fct,tkz-euclide}\\t% Gomtrie euclidienne avec TikZ\n  %\\\\usetkzobj{all} %problme de compilation\n\n  %%%%% PACKAGES MATHS %%%%%\n   \\\\usepackage{ucs}\n   \\\\usepackage{bm}\n   \\\\usepackage{amsmath}\n   \\\\usepackage{amsfonts}\n   \\\\usepackage{amssymb}\n   \\\\usepackage{gensymb}\n   \\\\usepackage{eurosym}\n   \\\\usepackage{frcursive}\n   \\\\newcommand{\\\\Vcurs}{\\\\begin{cursive}V\\\\end{cursive}}\n   \\\\usepackage[normalem]{ulem}\n   % plus utilis avec ProfCollege\n   % \\\\usepackage{sistyle} \\\\SIdecimalsign{,} %% => \\\\num{...} \\\\num*{...}\n   % cf. http://fr.wikibooks.org/wiki/LaTeX/%C3%89crire_de_la_physique\n   %  sous Ubuntu, paquet texlive-science  installer\n   %\\\\usepackage[autolanguage,np]{numprint} % dj appel par dfaut dans introLatex\n   \\\\usepackage{mathrsfs}  % Spcial math\n   %\\\\usepackage[squaren]{SIunits}\\t% Pour les units (gre le conflits avec  \\\\square de l'extension amssymb)\n   \\\\usepackage{pifont}\\t% Pour les symboles \"ding\"\n   \\\\usepackage{bbding}\\t% Pour les symboles\n   \\\\usepackage[misc]{ifsym}\\t% Pour les symboles\n   \\\\usepackage{cancel}\\t% Pour pouvoir barrer les nombres\n\n  %%%%% AUTRES %%%%%\n   \\\\usepackage{ifthen}\n   \\\\usepackage{url} \\t        \\t% Pour afficher correctement les url\n   \\\\urlstyle{sf}                          \\t% qui s'afficheront en police sans serif\n   \\\\usepackage{fancyhdr,lastpage}          \\t% En-ttes et pieds\n    \\\\pagestyle{fancy}                      \\t% de pages personnaliss\n   \\\\usepackage{fancybox}\\t% Pour les encadrs\n   \\\\usepackage{xlop}\\t% Pour les calculs poss\n  %\\\\usepackage{standalone}\\t% Pour avoir un apercu d'un fichier qui sera utilis avec un input\n   \\\\usepackage{multido}\\t% Pour faire des boucles\n  %\\\\usepackage{hyperref}\\t% Pour grer les liens hyper-texte\n   \\\\usepackage{fourier}\n   \\\\usepackage{colortbl} \\t% Pour des tableaux en couleur\n   \\\\usepackage{setspace}\\t% Pour \\\\begin{spacing}{2.0} \\\\end{spacing}\n   \\\\usepackage{multirow}\\t% Pour des cellules multilignes dans un tableau\n  %\\\\usepackage{import}\\t% Equivalent de input mais en spcifiant le rpertoire de travail\n  %\\\\usepackage[]{qrcode}\n  %\\\\usepackage{pdflscape}\n   \\\\usepackage[framemethod=tikz]{mdframed} % Pour les cadres\n   \\\\usepackage{tikzsymbols}\n   \\\\usepackage{scratch3}\n  %\\\\usepackage{tasks}\\t% Pour les listes horizontales\n\\\\usepackage{csvsimple}\n\n  %%%%% Librairies utilises par Mathgraphe32 %%%%\n  \\\\usepackage{fix-cm}\n  \\\\usepackage{textcomp}\n  \n  %%%%% PERSONNALISATION %%%%%\n  \\\\renewcommand{\\\\multiSymbole}{$\\\\begin{smallmatrix}\\\\circ\\\\bullet\\\\bullet \\\\\\\\\n           \\\\circ\\\\bullet\\\\circ \\\\end{smallmatrix}$\\\\noindent} % par dfaut $\\\\clubsuit$\n  %\\\\renewcommand{\\\\multiSymbole}{\\\\textbf{(! vent. plusieurs rponses !)}\\\\noindent} % par dfaut $\\\\clubsuit$\n  \\\\renewcommand{\\\\AMCbeginQuestion}[2]{\\\\noindent{\\\\colorbox{gray!20}{\\\\bf#1}}#2}\n  %\\\\renewcommand{\\\\AMCIntervalFormat}[2]{\\\\texttt{[}#1\\\\,;\\\\,#2\\\\texttt{[}}\n                           % Crochets plus nets, virgule...\n  %\\\\AMCboxDimensions{size=1.7ex,down=.2ex} %% taille des cases  cocher diminue\n  \\\\newcommand{\\\\collerVertic}{\\\\vspace{-3mm}} % vite un trop grand espace vertical\n  \\\\newcommand{\\\\TT}{\\\\sout{\\\\textbf{Tiers Temps}} \\\\noindent} %\n  \\\\newcommand{\\\\Prio}{\\\\fbox{\\\\textbf{PRIORITAIRE}} \\\\noindent} %\n  \\\\newcommandx{\\\\notation}[3][2=false,3=true]{\n    \\\\AMCOpen{lines=#1,lineup=#2,lineuptext=\\\\hspace{1cm},dots=#3}{\\\\mauvaise[{\\\\tiny NR}]{NR}\\\\scoring{0}\\\\mauvaise[{\\\\tiny RR}]{RR}\\\\scoring{0.01}\\\\mauvaise[{\\\\tiny R}]{R}\\\\scoring{0.33}\\\\mauvaise[{\\\\tiny V}]{V}\\\\scoring{0.67}\\\\bonne[{\\\\tiny VV}]{VV}\\\\scoring{1}}\n  }\n  %%\\\\newcommand{\\\\notation}[1]{\n  %%\\\\AMCOpen{lines=#1}{\\\\mauvaise[{\\\\tiny NR}]{NR}\\\\scoring{0}\\\\mauvaise[{\\\\tiny RR}]{RR}\\\\scoring{0.01}\\\\mauvaise[{\\\\tiny R}]{R}\\\\scoring{0.33}\\\\mauvaise[{\\\\tiny V}]{V}\\\\scoring{0.67}\\\\bonne[{\\\\tiny VV}]{VV}\\\\scoring{1}}\n  %%}\n  \n  %%pour afficher ailleurs que dans une question\n  \\\\makeatletter\n  \\\\newcommand{\\\\AffichageSiCorrige}[1]{\\\\ifAMC@correc #1\\\\fi}\n  \\\\makeatother\n  \n  \n  %%%%% TAILLES %%%%%\n   \\\\usepackage{geometry}\n   \\\\geometry{headsep=0.3cm, left=1.5cm,right=1.5cm,top=2.4cm,bottom=1.5cm}\n   \\\\DecimalMathComma\n  \n   \\\\AMCcodeHspace=.3em % rduction de la taille des cases pour le code lve\n   \\\\AMCcodeVspace=.3em\n  % \\\\AMCcodeBoxSep=.1em\n   \n   \\\\def\\\\AMCotextReserved{\\\\emph{Ne rien cocher, rserv au prof !}}\n   \n  %%%%%% Dfinition des barmes\n  \\\\baremeDefautS{\n    e=0.0001,% incohrence (plusieurs rponses donnes  0,0001 pour dfinir des manquements au respect de consignes)\n    b=1,% bonne rponse 1\n    m=-0.01,% mauvaise rponse 0,01 pour diffrencier de la\n    v=0} % non rponse qui reste  0\n  \n  \\\\baremeDefautM{formula=((NBC-NMC)/NB)*((NBC-NMC)/NB>0)} % nombre de bonnes rponses coches minores des mauvaises rponses coches, ramenes  1, et ramene  0 si rsultat ngatif.\n  \n  %%%%%%%%% Paramtres pour rponses  construire\n  \\\\AMCinterIrep=0pt \\\\AMCinterBrep=.5ex \\\\AMCinterIquest=0pt \\\\AMCinterBquest=3ex \\\\AMCpostOquest=7mm \\\\setlength{\\\\AMChorizAnswerSep}{3em plus 4em} \\\\setlength{\\\\AMChorizBoxSep}{1em}\n  %%%%% Fin du prambule %%%%%%%\n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  `\n\n  // Variable contenant la partie document\n  // Celle-ci contient une partie statique et une partie variable (la zone de dfinition des groupes qui est construite  la vole  partir de la variable groupeDeQuestions alimente au dbut)\n\n  let debutDocument = `%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%% -II-DOCUMENT %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\\\\begin{document}\n\\\\AMCrandomseed{${graine}}   % On choisit les \"graines\" pour initialiser le \"hasard\"\n\\\\FPseed=${graine}\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%% -II-a. CONCEPTION DU QCM %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\n  %%% prparation des groupes\n  \\\\setdefaultgroupmode{cyclic}\\n`\n\n  for (const g of groupeDeQuestions) {\n    const i = groupeDeQuestions.indexOf(g)\n    debutDocument += texQuestions[i]\n  }\n\n  // Variable qui contient l'entte d'une copie\n  // A faire : Proposer diffrent type d'entte en fonction d'un paramtre ?\n  const enteteTypeCodeGrid = `\\\\begin{minipage}{10cm}\n  \\\\champnom{\\\\fbox{\\\\parbox{10cm}{\n    crivez vos nom, prnom et classe : \\\\\\\\\n  }}}\n  \\\\end{minipage}\n  \n  %\\\\\\\\\n  \\\\vspace{2mm}\n  \n  Puis remplir les cases des trois premires lettres de votre \\\\textbf{nom de famille} PUIS des deux premires lettres de votre \\\\textbf{prnom}\n  \\\\vspace{1mm}\n\n  \\\\def\\\\AMCchoiceLabelFormat##1{\\\\textcolor{black!70}{{\\\\tiny ##1}}}  % pour allger la couleur des lettres dans les cases et les rduire\n  \\\\AMCcodeGrid[h]{ID}{ABCDEFGHIJKLMNOPQRSTUVWXYZ,\n  ABCDEFGHIJKLMNOPQRSTUVWXYZ,\n  ABCDEFGHIJKLMNOPQRSTUVWXYZ,\n  ABCDEFGHIJKLMNOPQRSTUVWXYZ,\n  ABCDEFGHIJKLMNOPQRSTUVWXYZ}\n  `\n  const enteteTypeChampnomSimple = `\\\\begin{minipage}{10cm}\n  \\\\champnom{\\\\fbox{\\\\parbox{10cm}{\n    crivez vos nom, prnom et classe : \\\\\\\\\n   \\\\\\\\\n  }}}\n  \\\\end{minipage}\n  \n  %\\\\\\\\\n  \\\\vspace{2mm}\n  `\n  const enteteTypePreremplie = `\\\\begin{center}\n  \\\\noindent{}\\\\fbox{\\\\vspace*{3mm}\n       \\\\Large\\\\bf\\\\nom{}~\\\\prenom{}\\\\normalsize{}%\n        \\\\vspace*{3mm}\n      }\n  \\\\end{center}\\n`\n\n  let enteteCopie = ''\n  if (typeEntete === 'AMCassociation') {\n    enteteCopie += '\\\\newcommand{\\\\sujet}{\\n'\n  }\n  enteteCopie += `\n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  %%%% -II-b. MISE EN PAGE DU QCM %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  \n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  \\\\exemplaire{${nbExemplaires}}{   % <======  /!\\\\ PENSER  ADAPTER /!\\\\  ===  %\n  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n  \\n`\n  if (format === 'A3') {\n    enteteCopie += '\\\\begin{multicols}{2}\\n'\n  }\n  enteteCopie += `\n  %%%%% EN-TTE, IDENTIFICATION AUTOMATIQUE DE L'LVE %%%%%\n  \n  \\\\vspace*{-17mm}\n  \n  %%%%% INTRODUCTION VENTUELLE %%%%%\n  \n  \\\\vspace{5mm}\n  %\\\\noindent\\\\AMCcode{num.etud}{8}\\\\hspace*{\\\\fill} % Pour la version \"verticale\"\n  %\\\\noindent\\\\AMCcodeH{num.etud}{8}\\t % version \"horizontale\"\n  \\\\begin{minipage}{7cm}\n  \\\\begin{center}\n    \\\\textbf{${matiere}}\n    \n    \\\\textbf{${titre}}\n  \\\\end{center}\n  \\\\end{minipage}\n  \\\\hfill\\n`\n  if (typeEntete === 'AMCassociation') {\n    enteteCopie += enteteTypePreremplie\n  } else if (typeEntete === 'AMCcodeGrid') {\n    enteteCopie += enteteTypeCodeGrid\n  } else {\n    enteteCopie += enteteTypeChampnomSimple\n  }\n  enteteCopie += `\\n{\\\\footnotesize REMPLIR avec un stylo NOIR la ou les cases pour chaque question. Si vous devez modifier un choix, NE PAS chercher  redessiner la case coche par erreur, mettez simplement un coup de \"blanc\" dessus.\n  \n  Les questions prcdes de \\\\multiSymbole peuvent avoir plusieurs rponses.\\\\\\\\ Les questions qui commencent par \\\\TT ne doivent pas tre faites par les lves disposant d'un tiers temps.\n  \n   Il est fortement conseill de faire les calculs dans sa tte ou sur la partie blanche de la feuille sans regarder les solutions proposes avant de remplir la bonne case plutt que d'essayer de choisir entre les propositions (ce qui demande de toutes les examiner et prend donc plus de temps) }\n  \n  `\n\n  // Ici On ajoute les commandes pour insrer les questions issues des groupes en quantit selon le nb_question[i]\n  // nb_question est un tableau pass en paramtre  la fonction creerDocumentAmc pour dterminer le nombre de questions  restituer par groupe.\n  // si ce nombre est 0, on restitue toutes les questions du groupe\n  let contenuCopie = ''\n  if (typeEntete === 'AMCcodeGrid') {\n    contenuCopie += '\\t \\\\def\\\\AMCchoiceLabel##1{}'\n  }\n  for (const g of groupeDeQuestions) {\n    const i = groupeDeQuestions.indexOf(g)\n    contenuCopie += `\n  \\\\begin{center}\n    \\\\hrule\n    \\\\vspace{2mm}\n    \\\\bf\\\\Large ${titreQuestion[i]}\n    \\\\vspace{1mm}\n    \\\\hrule\n  \\\\end{center}\\n`\n    if (!melangeQuestion[i]) {\n      contenuCopie += `\\\\setgroupmode{${g}}{cyclic}\\n\\n`\n    }\n    // contenuCopie += `\\\\melangegroupe{${g}}\\n` // Pour Eric, ne pas effacer\n    if (nbQuestions[i] > 0) {\n      contenuCopie += `\\\\restituegroupe[${nbQuestions[i]}]{${g}}\\n\\n`\n    } else {\n      contenuCopie += `\\\\restituegroupe{${g}}\\n\\n`\n    }\n  }\n  if (format === 'A3') {\n    contenuCopie += '\\\\end{multicols}\\n'\n  }\n  if (typeEntete === 'AMCassociation') {\n    contenuCopie += `\\\\AMCassociation{\\\\id}\\n\n    }\n  }\\n`\n  } else {\n    contenuCopie += '}\\n'\n  }\n\n  // On assemble les diffrents morceaux et on retourne le rsultat\n  codeLatex =\n    preambule + '\\n' + debutDocument + '\\n' + enteteCopie + contenuCopie\n  if (typeEntete === 'AMCassociation') {\n    codeLatex +=\n      '\\n \\n \\\\csvreader[head to column names]{liste.csv}{}{\\\\sujet}\\n'\n  }\n  codeLatex += '\\\\end{document}\\n'\n  return codeLatex\n}\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  type FlexOrientation = 'col' | 'row'\n\n  export let title: string\n  export let valueSelected: string | number\n  export let labelsValues: {\n    label: string\n    value: string | number\n    isDisabled?: boolean\n  }[] = []\n  export let isDisabled: boolean = false\n  export let orientation: FlexOrientation = 'col'\n  export let bgColor: string = 'bg-coopmaths-canvas'\n\n  const name =\n    title !== undefined\n      ? title\n          .replaceAll(' ', '')\n          .normalize('NFD')\n          .replace(/[\\u0300-\\u036f]/g, '')\n      : Math.round(new Date().getTime()).toString()\n  const dispatch = createEventDispatcher()\n  function valueHasChanged() {\n    dispatch('newvalue')\n  }\n</script>\n\n<!--\n  @component\n  Formulaire avec boutons radios\n\n  ### Action :\n\n  `newvalue` est dispatch lorsque la valeur du groupe de question a chang\n\n  ### Paramtres :\n\n  * `title` :  titre du groupe de boutons\n  * `isDisabled`: boolen servant  dsactiver le groupe\n\n  ### Exemple :\n\n    ```tsx\n  <FormRadio\n      isDisabled={maVariable2 === 0}\n      bind:valueSelected={maVariable}\n      labelsValues={[\n          { label: 'Titre du label 1', value: '1' },\n          { label: 'Titre du label 2', value: '2', isDisabled: true }\n      ]}\n      on:newvalue={() => {do_something}}\n  />\n  ```\n -->\n\n<div class=\"flex flex-{orientation} justify-start items-start mt-1\">\n  {#each labelsValues as labelValue, i}\n    <div class=\"form-check flex flex-row ml-4 items-center\">\n      <input\n        class=\"form-check-input rounded-full h-4 w-4 mt-1 mr-2\n          transition duration-200\n          text-coopmaths-action dark:text-coopmathsdark-action\n          {bgColor} dark:bg-coopmathsdark-canvas-dark\n          border\n          border-coopmaths-action dark:border-coopmathsdark-action\n          checked:border-coopmaths-action dark:checked:border-coopmathsdark-action\n          active:border-coopmaths-action dark:active:border-coopmathsdark-action\n          focus:outline-0 focus:ring-0 focus:border-1\n          focus:border-coopmaths-action dark:focus:border-coopmathsdark-action\n          checked:bg-coopmaths-action dark:checked:bg-coopmathsdark-action\n          checked:disabled:bg-opacity-10 checked:disabled:border-opacity-10\n          {isDisabled || labelValue.isDisabled\n          ? `border-opacity-10 dark:border-opacity-10\n              bg-opacity-10 dark:bg-opacity-10\n              checked:disabled:opacity-10 dark:checked:disabled:opacity-10`\n          : 'cursor-pointer'}\"\n        type=\"radio\"\n        {name}\n        id=\"{name + i.toString()}\"\n        bind:group=\"{valueSelected}\"\n        value=\"{labelValue.value}\"\n        disabled=\"{isDisabled || labelValue.isDisabled}\"\n        on:change=\"{valueHasChanged}\"\n      />\n      <label\n        class=\"form-check-label inline-block text-sm\n          text-coopmaths-corpus dark:text-coopmathsdark-corpus\n          {valueSelected === labelValue.value ? 'font-semibold' : 'font-light'}\n          {isDisabled || labelValue.isDisabled\n          ? 'text-opacity-10'\n          : 'text-opacity-70 cursor-pointer'}\"\n        for=\"{name + i.toString()}\"\n      >\n        {labelValue.label}\n      </label>\n    </div>\n  {/each}\n</div>\n","<script lang=\"ts\">\n  import { creerDocumentAmc } from '../../../lib/amc/creerDocumentAmc.js'\n  import { context } from '../../../modules/context.js'\n  import {\n    mathaleaGetExercicesFromParams,\n    mathaleaHandleExerciceSimple,\n    mathaleaUpdateExercicesParamsFromUrl,\n    mathaleaGenerateSeed,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../lib/mathalea.js'\n  import Footer from '../../Footer.svelte'\n  import {\n    darkMode,\n    exercicesParams,\n  } from '../../../lib/stores/generalStore.js'\n  import type TypeExercice from '../../../exercices/Exercice'\n  import FormRadio from '../../shared/forms/FormRadio.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import seedrandom from 'seedrandom'\n  import { onMount } from 'svelte'\n  import { referentielLocale } from '../../../lib/stores/languagesStore.js'\n  import ButtonTextAction from '../../shared/forms/ButtonTextAction.svelte'\n  import ButtonActionInfo from '../../shared/forms/ButtonActionInfo.svelte'\n  import BasicClassicModal from '../../shared/modal/BasicClassicModal.svelte'\n\n  const isSettingsVisible: boolean[] = []\n  let exercices: TypeExercice[] = []\n  let content = ''\n  let entete = 'AMCcodeGrid'\n  let format = 'A4'\n  let matiere = ''\n  let titre = ''\n  const nbQuestionsModif: number[] = []\n  const exercicesARetirer: string[] = []\n  let refsExercicesARetirer: string[]\n  $: refsExercicesARetirer = []\n\n  type NbQuestionsIndexees = {\n    indexExercice: number\n    nombre: number\n  }\n\n  let nbQuestions: Array<NbQuestionsIndexees> = []\n  let nbExemplaires = 1\n  let textForOverleaf: HTMLInputElement\n  let isNonAMCModaleDisplayed = false\n  let isOverleafModalDisplayed = false\n\n  async function initExercices() {\n    exercicesARetirer.length = 0\n    await mathaleaUpdateExercicesParamsFromUrl()\n    exercices = await mathaleaGetExercicesFromParams($exercicesParams)\n    for (const exercice of exercices) {\n      isSettingsVisible.push(false)\n      context.isHtml = false\n      context.isAmc = true\n      seedrandom(exercice.seed, { global: true })\n      if (exercice.typeExercice === 'simple') {\n        mathaleaHandleExerciceSimple(exercice, false)\n      } else {\n        if (exercice.nouvelleVersionWrapper != null)\n          exercice.nouvelleVersionWrapper()\n      }\n      if (exercice.amcType == null) {\n        // l'exercice n'est pas disponible AMC\n        exercicesARetirer.push(exercice.uuid)\n        if (exercice.id != null) {\n          refsExercicesARetirer.push(exercice.id)\n        } else {\n          const proprietes: string[] = Object.values(exercice)\n          proprietes.shift()\n          refsExercicesARetirer.push(proprietes.join(' '))\n        }\n      }\n    }\n    exercices = exercices.filter(\n      (exercice) => !exercicesARetirer.includes(exercice.uuid),\n    )\n\n    refsExercicesARetirer = refsExercicesARetirer\n    // afficher le modal pour les exercices non AMC ?\n    isNonAMCModaleDisplayed = refsExercicesARetirer.length !== 0\n  }\n\n  initExercices()\n\n  $: {\n    // ToDo vrifier la saisie utilisateur\n    // Si les copies sont prremplies, c'est un seul exemplaire pour ne pas avoir plusieurs sujets avec le mme nom\n    if (entete === 'AMCassociation') nbExemplaires = 1\n    // On rcupre les nombres de questions par groupe index sur l'index d'exercice dans exercices\n    // la ligne suivante lve une erreur\n    // nbQuestions = nbQuestionsModif.map((elt, i) => {\n    //   if (elt !== null) return { indexExercice: i, nombre: elt }\n    // })\n    // on la remplace par une boucle classique\n    nbQuestions.length = 0\n    for (let i = 0; i < nbQuestionsModif.length; i++) {\n      nbQuestions.push({ indexExercice: i, nombre: nbQuestionsModif[i] })\n    }\n    nbQuestions = nbQuestions\n    // on blinde le nbExemplaires qui ne peut tre 0 ou undefined\n    if (nbExemplaires == null) nbExemplaires = 1\n    for (let i = 0; i < exercices.length; i++) {\n      const exo = exercices[i]\n      const nbQ = nbQuestions.find((elt, i) => elt.indexExercice === i)\n      if (nbQ != null) {\n        if (exo.nbQuestions < nbQ.nombre) {\n          exo.nbQuestions = nbQ.nombre * nbExemplaires\n          context.isHtml = false\n          context.isAmc = true\n          seedrandom(exo.seed, { global: true })\n          if (exo.typeExercice === 'simple') {\n            mathaleaHandleExerciceSimple(exo, false)\n          } else {\n            if (exo.nouvelleVersionWrapper != null) exo.nouvelleVersionWrapper()\n          }\n        }\n      }\n    }\n    content = creerDocumentAmc({\n      exercices,\n      typeEntete: entete,\n      format,\n      matiere,\n      titre,\n      nbQuestions: nbQuestions.map((elt) => elt.nombre),\n      nbExemplaires,\n    })\n  }\n\n  /* =======================================================\n   *\n   * Mcanismes de gestion du modal d'infos sur OverLeaf\n   *\n   */\n  let overleafForm: HTMLFormElement\n  // $: isNonAmcModal Visible = false\n  onMount(async () => {\n    overleafForm = document.getElementById('overleaf-form') as HTMLFormElement\n  })\n\n  /**\n   * Grer le POST pour Overleaf\n   */\n  function handleOverLeaf() {\n    textForOverleaf.value =\n      'data:text/plain;base64,' + btoa(unescape(encodeURIComponent(content)))\n    overleafForm.submit()\n    isOverleafModalDisplayed = false\n  }\n\n  // =======================================================\n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\"AMC\"\n    subtitleType=\"export\"\n    handleLanguage=\"{() => {}}\"\n    locale=\"{$referentielLocale}\"\n  />\n\n  <section class=\"px-10 py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\">\n    <div\n      class=\"flex flex-col md:flex-row justify-start items-start my-4 space-y-5 md:space-y-0 md:space-x-10\"\n    >\n      <div>\n        <div\n          class=\"pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n        >\n          Type d'entte\n        </div>\n        <FormRadio\n          bind:valueSelected=\"{entete}\"\n          labelsValues=\"{[\n            { label: 'Grille de codage', value: 'AMCcodeGrid' },\n            { label: 'Copies pr-remplies', value: 'AMCassociation' },\n            { label: 'Noms et prnoms manuscrits', value: 'manuscrits' },\n          ]}\"\n          title=\"entete\"\n        />\n      </div>\n      <div>\n        <div\n          class=\"pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n        >\n          Format\n        </div>\n        <FormRadio\n          bind:valueSelected=\"{format}\"\n          labelsValues=\"{[\n            { label: 'Format A4 portrait', value: 'A4' },\n            { label: 'Format A3 paysage 2 colonnes', value: 'A3' },\n          ]}\"\n          title=\"format\"\n        />\n      </div>\n    </div>\n    <div\n      class=\"flex flex-col md:flex-row justify-start items-start my-4 space-y-5 md:space-y-0 md:space-x-10\"\n    >\n      <div>\n        <div\n          class=\"pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n        >\n          Matire\n        </div>\n        <input\n          bind:value=\"{matiere}\"\n          id=\"amc-export-matiere-input\"\n          class=\"ml-4 md:ml-0 border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          type=\"text\"\n        />\n      </div>\n      <div>\n        <div\n          class=\"pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n        >\n          Titre\n        </div>\n        <input\n          bind:value=\"{titre}\"\n          id=\"amc-export-titre-input\"\n          class=\"ml-4 md:ml-0 border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          type=\"text\"\n        />\n      </div>\n      <div>\n        <div\n          class=\"pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n        >\n          Nombre de questions par groupe\n        </div>\n        {#each exercices as exercice, i}\n          <div>\n            {exercice.id}{exercice.sup\n              ? `-S:${exercice.sup}`\n              : ''}{exercice.sup2 ? `-S2:${exercice.sup2}` : ''}{exercice.sup3\n              ? `-S3:${exercice.sup3}`\n              : ''}\n            <input\n              type=\"text\"\n              id=\"amc-export-nb-questions-gr{i}-input\"\n              class=\"ml-4 md:ml-0 border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n              placeholder=\"{exercice.nbQuestions.toString()}\"\n              bind:value=\"{nbQuestionsModif[i]}\"\n            />\n            <span>{exercice.amcType ? exercice.amcType : 'not amcReady'}</span>\n            <button\n              class=\"mx-2 tooltip tooltip-left\"\n              data-tip=\"Nouvel nonc\"\n              id=\"amc-export-new-enonce-button\"\n              type=\"button\"\n              on:click=\"{() => {\n                exercice.seed = mathaleaGenerateSeed()\n                seedrandom(exercice.seed, { global: true })\n                if (exercice.nouvelleVersionWrapper != null)\n                  exercice.nouvelleVersionWrapper()\n                $exercicesParams[i].alea = exercice.seed\n                mathaleaUpdateUrlFromExercicesParams()\n              }}\"\n              ><i\n                class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-refresh\"\n              ></i>\n            </button>\n            <!-- <button\n               class=\"tooltip tooltip-left tooltip-neutral\"\n               data-tip=\"Changer les paramtres de l'exercice\"\n               type=\"button\"\n               on:click={() => {\n    isSettingsVisible[i] = !isSettingsVisible[i]\n  }}\n             >\n               <i\n                 class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx {isSettingsVisible\n        ? 'bxs-cog'\n        : 'bx-cog'}\"\n               />\n             </button>\n            <div class=\"{isSettingsVisible[i] ? 'flex': 'hidden'} flex-col ...\">\n              <SettingsAmc {exercice}/>\n            </div>\n                         -->\n          </div>\n        {/each}\n        <div>\n          <BasicClassicModal\n            bind:isDisplayed=\"{isNonAMCModaleDisplayed}\"\n            icon=\"bxs-error\"\n          >\n            <span slot=\"header\"></span>\n            <div slot=\"content\" class=\"text-justify\">\n              Les exercices suivants n'ayant pas de version AMC, ils ont t\n              retirs de la liste.\n              <ul class=\"list-inside list-disc text-left text-base mt-1\">\n                {#each refsExercicesARetirer as reference}\n                  <li>{reference}</li>\n                {/each}\n              </ul>\n            </div>\n          </BasicClassicModal>\n        </div>\n      </div>\n      <div>\n        <div\n          class=\"pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n        >\n          Nombre d'exemplaires distincts\n        </div>\n        <input\n          bind:value=\"{nbExemplaires}\"\n          class=\"ml-4 md:ml-0 border-1 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          min=\"1\"\n          type=\"number\"\n        />\n      </div>\n    </div>\n\n    <div\n      class=\"flex flex-col md:flex-row justify-start items-start my-4 space-y-5 md:space-y-0 md:space-x-10 mt-8\"\n    >\n      <ButtonActionInfo\n        action=\"copy\"\n        textToCopy=\"{content}\"\n        tooltip=\"Copier le code LaTeX dans le presse-papier\"\n        text=\"Copier le code LaTeX\"\n        inverted=\"{false}\"\n        successMessage=\"Le code LaTeX a t copi dans le presse-papier\"\n        errorMessage=\"Impossible de copier le code dans le presse-papier !\"\n        displayDuration=\"{3000}\"\n        class=\"px-2 py-1 rounded-md\"\n      />\n      <ButtonTextAction\n        class=\"px-2 py-1 rounded-md\"\n        id=\"open-btn\"\n        on:click=\"{() => {\n          isOverleafModalDisplayed = true\n        }}\"\n        text=\"Compiler sur OverLeaf\"\n      />\n    </div>\n    <pre\n      class=\"my-10 shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus dark:text-coopmathsdark-corpus p-4 w-full overflow-auto\">\n      {content}\n    </pre>\n  </section>\n  <!-- Message avant envoi sur Overleaf -->\n  <BasicClassicModal\n    bind:isDisplayed=\"{isOverleafModalDisplayed}\"\n    icon=\"bxs-error\"\n  >\n    <span slot=\"header\">Attention !</span>\n    <ul class=\"list-inside list-disc text-left text-base\" slot=\"content\">\n      <li>Le fichier sorti d'Overleaf ne constitue qu'un aperu.</li>\n      <li>\n        Le fichier doit tre compil sous AMC imprativement pour que le fichier\n        soit fonctionnel.\n      </li>\n    </ul>\n    <div slot=\"footer\">\n      <ButtonTextAction\n        text=\"Compiler sur OverLeaf\"\n        on:click=\"{handleOverLeaf}\"\n      />\n    </div>\n  </BasicClassicModal>\n  <!-- Formulaire pour Overleaf -->\n  <form\n    action=\"https://www.overleaf.com/docs\"\n    id=\"overleaf-form\"\n    method=\"POST\"\n    target=\"_blank\"\n  >\n    <input\n      type=\"hidden\"\n      name=\"snip_uri[]\"\n      value=\"https://coopmaths.fr/alea/static/amc/automultiplechoice.sty\"\n      autocomplete=\"off\"\n    />\n    <input\n      type=\"hidden\"\n      name=\"snip_name[]\"\n      value=\"automultiplechoice.sty\"\n      autocomplete=\"off\"\n    />\n    <input\n      autocomplete=\"off\"\n      bind:this=\"{textForOverleaf}\"\n      name=\"snip_uri[]\"\n      type=\"hidden\"\n      value=\"\"\n    />\n    <input\n      autocomplete=\"off\"\n      name=\"snip_name[]\"\n      type=\"hidden\"\n      value=\"coopmaths.tex\"\n    />\n    <input autocomplete=\"off\" name=\"engine\" type=\"hidden\" value=\"lualatex\" />\n  </form>\n  <Footer />\n</main>\n","<script lang=\"ts\">\n  import type TypeExercice from '../../../exercices/Exercice'\n  import {\n      mathaleaGetExercicesFromParams,\n      mathaleaUpdateExercicesParamsFromUrl,\n  } from '../../../lib/mathalea.js'\n  import { darkMode, exercicesParams } from '../../../lib/stores/generalStore'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import Footer from '../../Footer.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n\n  type TypeNote = {\n    deckName: string\n    modelName: string\n    fields: {\n      Titre: string\n      url: string\n    },\n    options?: {\n      allowDuplicate?: boolean\n    }\n  }\n  const notes: TypeNote[] = []\n  let exercices: TypeExercice[]\n\n  let chargement = true\n\n  async function initExercices() {\n    mathaleaUpdateExercicesParamsFromUrl()\n    exercices = await mathaleaGetExercicesFromParams($exercicesParams)\n    let i = 0\n    for (const param of $exercicesParams) {\n      let paramUrl = ''\n      for (const key of Object.keys(param)) {\n        if (key === 'sup') {\n          paramUrl += `s=${param[key]}&`\n        } else if (key === 'sup2') {\n          paramUrl += `s2=${param[key]}&`\n        } else if (key === 'sup3') {\n          paramUrl += `s3=${param[key]}&`\n        } else if (key === 'nbQuestions') {\n          paramUrl += `n=${param[key]}&`\n        } else if (key !== 'alea' && key !== 'id') {\n          paramUrl += `${key}=${param[key]}&`\n        }\n      }\n      paramUrl = paramUrl.slice(0, -1)\n\n      notes.push({\n        deckName: 'MathALA',\n        modelName: 'MathALEA',\n        fields: {\n          Titre: exercices[i].titre,\n          url: 'https://coopmaths.fr/alea/?' + paramUrl,\n        },\n      })\n      i++\n    }\n    chargement = false\n  }\n\n  initExercices()\n\n  let logs = ''\n\n  const ANKI_API_URL = new URL('http://127.0.0.1:8765')\n  // hostname // port\n\n  function ankiConnect(action: string, params = {}) {\n    console.info('ankiConnect:', action, '...')\n    return fetch(ANKI_API_URL, {\n      method: 'POST',\n      body: JSON.stringify({\n        action,\n        version: 6,\n        params,\n      }),\n    })\n      .then((r) => r.json())\n      .then((r) => {\n        if (r.error) {\n          throw new Error(r.error)\n        }\n        console.info('ankiConnect:', action, '... russi !')\n        return r.result\n      })\n      .catch((e) => {\n        console.error('ankiConnect:', action, '... chou !')\n        throw e\n      })\n  }\n\n  function importer() {\n    logs = ''\n\n    ankiConnect('requestPermission')\n      .then((r) => {\n        if (r.permission === 'granted') {\n          return ankiConnect('modelNames')\n        } else {\n          throw new Error('Permission not granted')\n        }\n      })\n      .then((r) => {\n        logs += 'Connexion  Anki russie\\n'\n        if (!r.includes('MathALEA')) {\n          logs += 'Cration du model MathALEA\\n'\n          return ankiConnect('createModel', {\n            modelName: 'MathALEA',\n            inOrderFields: ['Titre', 'url'],\n            css: '/*\\n  Author: Guillaume Valmont\\n  Date : November 5, 2023\\n  Licence: CC-BY-SA 4.0\\n  https://forge.apps.education.fr/anki-templates/mathalea\\n*/\\n\\n.loader-container {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  height: 75vh;\\n}\\n\\n.loader {\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  width: 100%;\\n  max-width: 15rem;\\n}\\n\\n.loading-text {\\n  position: absolute;\\n  color: #f15929;\\n  font-size: 1.5rem;\\n}\\n\\n.loader:before,\\n.loader:after {\\n  content: \"\";\\n  position: absolute;\\n  border-radius: 50%;\\n  animation: pulsOut 1.8s ease-in-out infinite;\\n  filter: drop-shadow(0 0 1rem rgba(241, 89, 41, 0.75));\\n  backface-visibility: hidden;\\n}\\n\\n.loader:before {\\n  width: 100%;\\n  padding-bottom: 100%;\\n  box-shadow: inset 0 0 0 1rem #f15929;\\n  animation-name: pulsIn;\\n}\\n\\n.loader:after {\\n  width: calc(100% - 2rem);\\n  padding-bottom: calc(100% - 2rem);\\n  box-shadow: 0 0 0 0 #f15929;\\n}\\n\\n@keyframes pulsIn {\\n  0% {\\n    box-shadow: inset 0 0 0 1rem #f15929;\\n    opacity: 1;\\n  }\\n  50%, 100% {\\n    box-shadow: inset 0 0 0 0 #f15929;\\n    opacity: 0;\\n  }\\n}\\n\\n@keyframes pulsOut {\\n  0%, 50% {\\n    box-shadow: 0 0 0 0 #f15929;\\n    opacity: 0;\\n  }\\n  100% {\\n    box-shadow: 0 0 0 1rem #f15929;\\n    opacity: 1;\\n  }\\n}\\n',\n            // \"isCloze\": false,\n            cardTemplates: [\n              {\n                Name: 'Card 1',\n                Front:\n                  '\\x3C!-- \\n  Author: Guillaume Valmont\\n  Date : November 15, 2023\\n  Licence: CC-BY-SA 4.0\\n  https://forge.apps.education.fr/anki-templates/mathalea\\n-->\\n\\n<link rel=\"stylesheet\" href=\"https://coopmaths.fr/alea/anki/mathalea-anki-style.css\">\\n\\n<div id=\\'recto-iframe-container\\'>\\n  <div class=\"loader-container\">\\n    <div class=\"loader\">\\n      <span class=\"loading-text\">Chargement</span>\\n    </div>\\n  </div>\\n</div>\\n\\n\\x3Cscript src=\"https://coopmaths.fr/alea/anki/mathalea-anki-script.js\" onload=\"executeIframeUpdate()\">\\x3C/script>\\n\\n\\x3Cscript>\\n  function executeIframeUpdate() {\\n    rectoIframeUpdate((function () {/* {{url}} */ }).toString())\\n  }\\n\\x3C/script>\\n',\n                Back: '\\x3C!-- \\n  Author: Guillaume Valmont\\n  Date : November 15, 2023\\n  Licence: CC-BY-SA 4.0\\n  https://forge.apps.education.fr/anki-templates/mathalea\\n-->\\n\\n<link rel=\"stylesheet\" href=\"https://coopmaths.fr/alea/anki/mathalea-anki-style.css\">\\n\\n<div id=\\'verso-iframe-container\\'>\\n  <div class=\"loader-container\">\\n    <div class=\"loader\">\\n      <span class=\"loading-text\">Chargement</span>\\n    </div>\\n  </div>\\n</div>\\n\\n\\x3Cscript src=\"https://coopmaths.fr/alea/anki/mathalea-anki-script.js\" onload=\"executeIframeUpdate()\">\\x3C/script>\\n\\n\\x3Cscript>\\n  function executeIframeUpdate() {\\n    versoIframeUpdate((function () {/* {{url}} */ }).toString())\\n  }\\n\\x3C/script>\\n',\n              },\n            ],\n          })\n        }\n      })\n      .then(() => {\n        // Le deck ne sera cr que s'il n'existe pas\n        return ankiConnect('createDeck', {\n          deck: 'MathALA',\n        })\n      })\n      .then(() => {\n        return ankiConnect('canAddNotes', {\n          notes,\n        })\n      })\n      .then((can) => {\n        return ankiConnect('addNotes', {\n          notes: notes.filter((note, i) => can[i]), // On n'ajoute que les notes qui peuvent l'tre (vite les doublons)\n        })\n      })\n      .then((r) => {\n        const nbExos = r.length\n        const nbExosDejaPresent = notes.length - r.length\n        logs += `${nbExos} ${nbExos > 1 ? 'exercices imports' : 'exercice import'} ${nbExosDejaPresent ? `(dont ${nbExosDejaPresent} dj prsent${nbExosDejaPresent > 1 ? 's' : ''}) ` : ''}dans Anki avec succs !\\n`\n      })\n      .catch((e) => {\n        logs += \"ERREUR, L'IMPORTATION N'A PAS RUSSI :\\n\\t\" + e + '\\n'\n        logs += 'Veuillez vrifier que :\\n'\n        logs += '- Anki est bien install sur votre ordinateur\\n'\n        logs += '- Le plugin AnkiConnect est bien install et activ\\n'\n        logs += '- Anki est bien actuellement lanc\\n'\n      })\n  }\n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\"Anki\"\n    subtitleType=\"export\"\n    handleLanguage=\"{() => {}}\"\n    locale=\"{$referentielLocale}\"\n  />\n\n  <section\n    class=\"px-4 py-0 md:py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  >\n    <h1\n      class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n    >\n      Comment l'utiliser ?\n    </h1>\n\n    <p\n      class=\"text-coopmaths-corpus dark:text-coopmathsdark-corpus text-lg md:text-xl\"\n    >\n      MathALA vous permet d'importer automatiquement les exercices slectionn\n      dans Anki.<br />\n      Cette interface ncessite que\n      <a\n        href=\"https://apps.ankiweb.net/\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        class=\"text-coopmaths-action dark:text-coopmathsdark-action\">Anki</a\n      >\n      soit install sur votre ordinateur avec le plugin\n      <a\n        href=\"https://ankiweb.net/shared/info/2055492159\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        class=\"text-coopmaths-action dark:text-coopmathsdark-action\"\n        >AnkiConnect</a\n      >\n      et que Anki soit <strong>actuellement lanc</strong> sur votre ordinateur.<br\n      />Veuillez consulter la\n      <a\n        href=\"https://forge.apps.education.fr/coopmaths/mathalea/-/wikis/Utilisation-de-Mathalea-avec-Anki\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n        class=\"text-coopmaths-action dark:text-coopmathsdark-action\"\n        >documentation</a\n      > pour plus d'information.\n    </p>\n    <h1\n      class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n    >\n      Importation\n    </h1>\n\n    <div\n      class=\"flex flex-row w-full justify-center md:justify-start items-center\"\n    >\n      {#if !chargement}\n        <button\n          type=\"submit\"\n          on:click=\"{importer}\"\n          class=\"p-2 rounded-xl text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n        >\n          <i class=\"bx bx-download mr-2\"></i>Importer les exercices dans Anki\n        </button>\n      {/if}\n    </div>\n    <div\n      class=\"flex flex-row w-full justify-center md:justify-start items-center\"\n    >\n      {#if logs}\n        <pre\n          class=\"my-10 shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus dark:text-coopmathsdark-corpus p-4 w-full overflow-auto\">{logs}</pre>\n      {/if}\n    </div>\n  </section>\n  <footer>\n    <Footer />\n  </footer>\n</main>\n\n<style>\n  footer {\n    margin-top: auto;\n  }\n</style>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import { getUniqueStringBasedOnTimeStamp } from '../../../lib/components/time'\n\n  export let title: string\n  export let explanations = [\"Text when it's on\", \"Text when it's off\"]\n  export let value: boolean = true\n  export let isDisabled: boolean = false\n  export let inLine: boolean = false\n  export let id = ['toggle-', getUniqueStringBasedOnTimeStamp()].join('')\n  const dispatch = createEventDispatcher()\n\n  function toggle() {\n    value = !value\n    dispatch('toggle')\n  }\n</script>\n\n<div\n  {id}\n  class=\"flex justify-start {$$props.class} {inLine\n    ? 'flex-row items-center'\n    : 'flex-col items-start'}\"\n>\n  <div class=\"flex flex-row items-center space-x-1\">\n    <input\n      class=\"mr-2 mt-[0.3rem] h-3 w-8 appearance-none rounded-[0.4375rem] bg-coopmaths-canvas border-coopmaths-action dark:border-coopmathsdark-action disabled:border-opacity-10 dark:disabled:border-opacity-10 before:pointer-events-none before:absolute before:h-3 before:w-3 before:rounded-full before:bg-transparent before:content-[''] after:absolute after:z-[2] after:-mt-[0.1875rem] after:h-4 after:w-4 after:rounded-full after:border after:disabled:border-opacity-10 dark:after:disabled:border-opacity-0 after:border-coopmaths-action dark:after:border-coopmathsdark-action after:bg-coopmaths-canvas-darkest after:shadow-[0_0px_3px_0_rgb(0_0_0_/_7%),_0_2px_2px_0_rgb(0_0_0_/_4%)] after:transition-[background-color_0.2s,transform_0.2s] after:content-[''] checked:bg-coopmaths-action checked:after:absolute checked:after:z-[2] checked:after:-mt-[3px] checked:after:ml-[1.0625rem] checked:after:h-4 checked:after:w-4 checked:after:rounded-full checked:after:border-none checked:after:bg-coopmaths-action checked:after:transition-[background-color_0.2s,transform_0.2s] checked:after:content-[''] hover:cursor-pointer focus:outline-none focus:ring-0 focus:before:scale-100 focus:before:opacity-[0.12] focus:before:transition-[box-shadow_0.2s,transform_0.2s] focus:after:absolute focus:after:z-[1] focus:after:block focus:after:h-4 focus:after:w-4 focus:after:rounded-full focus:after:content-[''] checked:focus:border-coopmaths-action checked:focus:bg-coopmaths-action checked:focus:before:ml-[1.0625rem] checked:focus:before:scale-100 dark:bg-coopmathsdark-canvas dark:after:bg-coopmathsdark-canvas-darkest dark:checked:bg-coopmathsdark-action dark:checked:after:bg-coopmathsdark-action\"\n      type=\"checkbox\"\n      role=\"switch\"\n      id=\"input-{id}\"\n      disabled=\"{isDisabled}\"\n      on:change=\"{toggle}\"\n      checked=\"{value}\"\n    />\n    <label\n      class=\"inline-block pl-[0.15rem] hover:cursor-pointer text-coopmaths-corpus dark:text-coopmathsdark-corpus text-sm\n      {value ? 'font-semibold' : 'font-light'}\n      {isDisabled\n        ? 'text-opacity-10 dark:text-opacity-10'\n        : 'text-opacity-70 dark:text-opacity-70'}\"\n      for=\"input-{id}\"\n    >\n      {title}\n    </label>\n  </div>\n  <div\n    class=\"flex flex-row font-light text-xs text-coopmaths-corpus dark:text-coopmathsdark-corpus\n    {isDisabled\n      ? 'text-opacity-10 dark:text-opacity-10'\n      : 'text-opacity-70 dark:text-opacity-70'}\n    {inLine ? 'px-2 mt-[0.1125rem]' : 'p-2'}\"\n  >\n    {#if value}\n      {explanations[0]}\n    {:else}\n      {explanations[1]}\n    {/if}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import {\n    getBlobFromImageElement,\n    copyBlobToClipboard,\n    canCopyImagesToClipboard,\n  } from 'copy-image-clipboard'\n  import BasicClassicModal from '../modal/BasicClassicModal.svelte'\n  import ButtonIconTooltip from './ButtonIconTooltip.svelte'\n  import BasicInfoModal from '../modal/BasicInfoModal.svelte'\n  import QRCode from 'qrcode'\n  import { notify } from '../../../bugsnag'\n  import { mathaleaGenerateSeed } from '../../../lib/mathalea'\n  import { buildMathAleaURL } from '../../../lib/components/urls'\n\n  export let customUrl: string = ''\n  export let icon: string = 'bx-qr text-2xl'\n  export let cornerIcon: string = ''\n  export let cornerIconClass: string = ''\n  export let tooltip: string = ''\n  export let useCurrentUrl: boolean = false\n  export let removeSeed: boolean = false\n\n  const imageId: string = mathaleaGenerateSeed()\n\n  const QRCodeOptions = {\n    errorCorrectionLevel: 'M',\n    type: 'image/png',\n    quality: 0.9,\n    margin: 1,\n    scale: 2,\n    width: 400,\n    color: {\n      dark: '#000',\n      light: '#fff',\n    },\n  }\n\n  let isDisplayed = false\n  let QRCodeCopyState: 'success' | 'error' | 'none' = 'none'\n\n  async function updateQRCodeImage() {\n    const url = useCurrentUrl\n      ? buildMathAleaURL({ removeSeed }).toString()\n      : customUrl\n    QRCode.toDataURL(url, QRCodeOptions, (error: Error, url: string) => {\n      const imageElement = document.getElementById(imageId)\n      if (!imageElement || !(imageElement instanceof HTMLImageElement)) {\n        notify('QR-Code image element not found', { imageId })\n        return\n      }\n      if (error) {\n        notify('Error generating QR-Code', { error })\n        return\n      }\n      imageElement.setAttribute('src', url)\n    })\n  }\n\n  async function copyQRCodeImageToClipboard() {\n    updateQRCodeImage()\n    const imageElement = document.getElementById(imageId)\n    if (!imageElement || !(imageElement instanceof HTMLImageElement)) {\n      notify(`ImageElement with ID: ${imageId} not found.`, {})\n      QRCodeCopyState = 'error'\n      return\n    }\n\n    if (!canCopyImagesToClipboard()) {\n      console.error('Copying images to clipboard is not supported.')\n      QRCodeCopyState = 'error'\n      return\n    }\n\n    try {\n      const blob = await getBlobFromImageElement(imageElement)\n      await copyBlobToClipboard(blob)\n      QRCodeCopyState = 'success'\n    } catch (error) {\n      notify('Error copying QR Code to clipboard:', { error })\n      QRCodeCopyState = 'error'\n    }\n  }\n\n  async function downloadQRCodeImage() {\n    updateQRCodeImage()\n    const timestamp = new Date().toISOString().slice(0, 10).replace(/-/g, '')\n\n    const imageElement = document.getElementById(imageId)\n    if (!imageElement || !(imageElement instanceof HTMLImageElement)) {\n      notify('QR-Code image element not found', { imageId, imageElement })\n      return\n    }\n\n    const imageSrc = imageElement.getAttribute('src')\n    if (!imageSrc) {\n      notify(`Image with ID: ${imageId} has no attribute \"src\".`, {})\n      return\n    }\n\n    try {\n      const response = await fetch(imageSrc)\n      const blob = await response.blob()\n      const url = window.URL.createObjectURL(blob)\n\n      // Creating virtual link for download\n      const downloadLink = document.createElement('a')\n      downloadLink.style.display = 'none'\n      downloadLink.href = url\n      downloadLink.download = `qrcode_coopmaths_${timestamp}.png`\n      document.body.appendChild(downloadLink)\n      downloadLink.click()\n      window.URL.revokeObjectURL(url)\n    } catch (error) {\n      notify('Error downloading the QR Code image:', { error })\n    }\n  }\n</script>\n\n<ButtonIconTooltip\n  {icon}\n  {cornerIcon}\n  {cornerIconClass}\n  {tooltip}\n  on:click=\"{() => {\n    updateQRCodeImage()\n    isDisplayed = !isDisplayed\n  }}\"\n/>\n\n<BasicClassicModal bind:isDisplayed>\n  <h3 slot=\"header\">QR-Code</h3>\n  <div slot=\"content\" class=\"flex flex-col items-center\">\n    <div class=\"flex flex-col justify-center\">\n      <div class=\"flex flex-row justify-center p-4\">\n        <img id=\"{imageId}\" alt=\"QR-Code\" width=\"200px\" />\n      </div>\n    </div>\n  </div>\n  <div slot=\"footer\">\n    <div class=\"flex flex-row justify-center\">\n      <ButtonIconTooltip\n        icon=\"bx-copy-alt text-[30px] mx-3\"\n        tooltip=\"Copier le QR-Code\"\n        on:click=\"{copyQRCodeImageToClipboard}\"\n      />\n      <ButtonIconTooltip\n        icon=\"bx-download text-[30px] mx-3\"\n        tooltip=\"Tlcharger le QR-Code\"\n        on:click=\"{downloadQRCodeImage}\"\n      />\n    </div>\n  </div>\n</BasicClassicModal>\n\n<BasicInfoModal\n  bind:contentDisplayed=\"{QRCodeCopyState}\"\n  successMessage=\"Le QR-Code est copi dans le presse-papier !\"\n  errorMessage=\"Impossible de copier le QR-Code dans ce navigateur !<br /> Vrifier les permissions.\"\n/>\n","<script lang=\"ts\">\n  import {\n    exercicesParams,\n    darkMode,\n    globalOptions,\n  } from '../../../lib/stores/generalStore'\n  import { canOptions } from '../../../lib/stores/canStore'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import {\n    mathaleaGenerateSeed,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../lib/mathalea.js'\n  import Footer from '../../Footer.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import FormRadio from '../../shared/forms/FormRadio.svelte'\n  import { onMount } from 'svelte'\n  import ButtonToggleAlt from '../../shared/forms/ButtonToggleAlt.svelte'\n  import ButtonQRCode from '../../shared/forms/ButtonQRCode.svelte'\n  import { buildMathAleaURL } from '../../../lib/components/urls'\n  // pour les tabs\n  import { Tab, initTE } from 'tw-elements'\n  import ButtonTextAction from '../../shared/forms/ButtonTextAction.svelte'\n  import ButtonActionInfo from '../../shared/forms/ButtonActionInfo.svelte'\n\n  onMount(() => {\n    initTE({ Tab })\n    // mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n    handleSeed()\n    const btnElementId = $canOptions.isChoosen\n      ? 'tabs-pres-can-btn'\n      : 'tabs-pres-classic-btn'\n    const tabElementId = $canOptions.isChoosen\n      ? 'tabs-pres-can'\n      : 'tabs-pres-classic'\n    const btnElement = document.getElementById(btnElementId)\n    const tabElement = document.getElementById(tabElementId)\n    btnElement?.setAttribute('data-te-nav-active', '')\n    tabElement?.setAttribute('data-te-tab-active', '')\n  })\n\n  const availableLinkFormats = {\n    clear: {\n      toolTipsMessage: 'En clair',\n      icon: 'bx-glasses-alt',\n      isShort: false,\n      isEncrypted: false,\n    },\n    short: {\n      toolTipsMessage: 'Raccourci',\n      icon: 'bx-move-horizontal',\n      isShort: true,\n      isEncrypted: false,\n    },\n    crypt: {\n      toolTipsMessage: 'Crypt',\n      icon: 'bx-lock',\n      isShort: false,\n      isEncrypted: true,\n    },\n  }\n  $: $canOptions.isInteractive = $globalOptions.setInteractive === '1'\n  type LinkFormat = keyof typeof availableLinkFormats\n  let currentLinkFormat: LinkFormat = 'clear'\n  let setInteractive: string = $globalOptions.setInteractive ?? '2'\n  let presMode:\n    | 'liste_exos'\n    | 'un_exo_par_page'\n    | 'une_question_par_page'\n    | 'recto'\n    | 'verso' = $globalOptions.presMode ?? 'liste_exos'\n\n  /**\n   * Construit l'URL correspondant aux choix de la page de configuration et bascule sur cette page\n   */\n  function handleVueSetUp() {\n    const nextView = $canOptions.isChoosen ? 'can' : 'eleve'\n    const url = buildMathAleaURL({\n      view: nextView,\n      isEncrypted: availableLinkFormats[currentLinkFormat].isEncrypted,\n      removeSeed: isDataRandom,\n    })\n    window.open(url, '_blank')?.focus()\n  }\n\n  // Gestion de la graine\n  let isDataRandom: boolean = false\n  function handleSeed() {\n    for (const param of $exercicesParams) {\n      if (!isDataRandom && param.alea === undefined) {\n        param.alea = mathaleaGenerateSeed()\n      } else if (isDataRandom) {\n        param.alea = undefined\n      }\n    }\n    mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n  }\n\n  function toggleCan() {\n    if ($canOptions.isChoosen) {\n      $globalOptions.setInteractive = '1'\n    }\n  }\n</script>\n\n<main\n  class=\" {$darkMode.isActive\n    ? 'dark'\n    : ''} mb-auto flex flex-col min-h-screen justify-start bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n>\n  <NavBar\n    subtitle=\"La page lve\"\n    subtitleType=\"export\"\n    handleLanguage=\"{() => {}}\"\n    locale=\"{$referentielLocale}\"\n  />\n  <div\n    class=\"flex flex-col h-full w-full bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n  >\n    <div\n      class=\"h-full w-full md:w-2/3 lg:w-3/5 flex flex-col px-4 pb-4 md:py-10 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark mx-auto\"\n    >\n      <div\n        class=\"flex flex-col md:flex-row justify-start px-4 py-4 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n      >\n        <h3\n          class=\"font-bold text-2xl text-coopmaths-struct dark:text-coopmathsdark-struct bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n        >\n          Rglages\n        </h3>\n      </div>\n      <!-- Tabulations pour la prsentation -->\n      <ul\n        class=\"flex list-none flex-row flex-wrap border-b-0 pl-0 pt-0 bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas\"\n        role=\"tablist\"\n        data-te-nav-ref\n      >\n        <li role=\"presentation\" class=\"flex-grow basis-0 text-center\">\n          <a\n            id=\"tabs-pres-classic-btn\"\n            href=\"#tabs-pres-classic\"\n            class=\"relative block font-extrabold px-7 pb-3.5 pt-4 text-base uppercase leading-tight text-coopmaths-action bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas-darkest hover:isolate hover:bg-coopmaths-action focus:isolate data-[te-nav-active]:bg-coopmaths-canvas data-[te-nav-active]:text-coopmaths-struct dark:text-coopmathsdark-action dark:hover:bg-coopmathsdark-action dark:hover:bg-opacity-20 dark:data-[te-nav-active]:bg-coopmathsdark-canvas dark:data-[te-nav-active]:text-coopmathsdark-struct\n            {$canOptions.isChoosen\n              ? ' hover:bg-opacity-10'\n              : ' hover:bg-opacity-0'}\"\n            data-te-toggle=\"pill\"\n            data-te-target=\"#tabs-pres-classic\"\n            role=\"tab\"\n            aria-controls=\"tabs-pres-classic\"\n            aria-selected=\"true\"\n            on:click=\"{() => {\n              $canOptions.isChoosen = false\n            }}\"\n          >\n            Prsentation classique\n          </a>\n        </li>\n        <li role=\"presentation\" class=\"flex-grow basis-0 text-center\">\n          <a\n            id=\"tabs-pres-can-btn\"\n            href=\"#tabs-pres-can\"\n            class=\"relative block font-extrabold px-7 pb-3.5 pt-4 text-base uppercase leading-tight text-coopmaths-action bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas-darkest hover:isolate hover:bg-coopmaths-action focus:isolate data-[te-nav-active]:bg-coopmaths-canvas data-[te-nav-active]:text-coopmaths-struct dark:text-coopmathsdark-action dark:hover:bg-coopmathsdark-action dark:hover:bg-opacity-20 dark:data-[te-nav-active]:bg-coopmathsdark-canvas dark:data-[te-nav-active]:text-coopmathsdark-struct\n            {$canOptions.isChoosen\n              ? ' hover:bg-opacity-0'\n              : ' hover:bg-opacity-10'}\"\n            data-te-toggle=\"pill\"\n            data-te-target=\"#tabs-pres-can\"\n            role=\"tab\"\n            aria-controls=\"tabs-pres-can\"\n            aria-selected=\"false\"\n            on:click=\"{() => {\n              $canOptions.isChoosen = true\n              toggleCan()\n            }}\"\n          >\n            Course aux nombres\n          </a>\n        </li>\n      </ul>\n      <!-- Pages des rglages -->\n      <div class=\"pb-6 pt-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\">\n        <div\n          class=\"hidden opacity-100 transition-opacity duration-150 ease-linear data-[te-tab-active]:block\"\n          id=\"tabs-pres-classic\"\n          role=\"tabpanel\"\n          aria-labelledby=\"tabs-pres-classic\"\n        >\n          <!-- Prsentation classique -->\n          <div\n            class=\"flex px-6 py-2 font-light text-lg text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          >\n            Les exercices seront poss suivant les rglages ci-dessous.\n          </div>\n          <div class=\"pt-2 px-4 grid grid-flow-row md:grid-cols-3 gap-4\">\n            <div class=\"pb-2 w-full flex flex-col\">\n              <div\n                class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n              >\n                Prsentation\n              </div>\n              <div\n                class=\"pl-4 pb-4 w-full flex flex-row justify-start items-center space-x-2\"\n              >\n                <div\n                  class=\"text-sm font-light w-1/4 text-coopmaths-corpus dark:text-coopmathsdark-corpus text-opacity-70 dark:text-opacity-70\"\n                >\n                  Titre :\n                </div>\n                <input\n                  type=\"text\"\n                  id=\"config-eleve-titre-input\"\n                  class=\"w-1/2 h-6 text-sm bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-corpus dark:text-coopmathsdark-corpus border disabled:border-opacity-10 dark:disabled:border-opacity-10 border-coopmaths-action dark:border-coopmathsdark-action font-light focus:border focus:border-coopmaths-action dark:focus:border-coopmathsdark-action focus:outline-0 focus:ring-0\"\n                  bind:value=\"{$globalOptions.title}\"\n                />\n                <div\n                  class=\"mt-1 text-coopmaths-corpus font-light italic text-xs {$globalOptions.title &&\n                  $globalOptions.title.length === 0\n                    ? ''\n                    : 'invisible'}\"\n                >\n                  Pas de bandeau si laiss vide.\n                </div>\n              </div>\n              <FormRadio\n                title=\"prsentation\"\n                bind:valueSelected=\"{presMode}\"\n                on:newvalue=\"{() => ($globalOptions.presMode = presMode)}\"\n                labelsValues=\"{[\n                  {\n                    label: 'Tous les exercices sur une page',\n                    value: 'liste_exos',\n                  },\n                  {\n                    label: 'Une page par exercice',\n                    value: 'un_exo_par_page',\n                    isDisabled: $exercicesParams.length === 1,\n                  },\n                  {\n                    label: 'Une page par question',\n                    value: 'une_question_par_page',\n                  },\n                  // { label: 'Cartes', value: 'cartes' }\n                ]}\"\n              />\n              <div class=\"pl-4 pt-4\">\n                <ButtonToggleAlt\n                  title=\"{'Deux colonnes'}\"\n                  isDisabled=\"{$globalOptions.presMode === 'un_exo_par_page' ||\n                    $globalOptions.presMode === 'une_question_par_page'}\"\n                  bind:value=\"{$globalOptions.twoColumns}\"\n                  id=\"{'config-eleve-nb-colonnes-toggle'}\"\n                  explanations=\"{[\n                    'Les exercices seront prsents sur deux colonnes.',\n                    'Les exercices seront prsents sur une seule colonne.',\n                  ]}\"\n                />\n              </div>\n            </div>\n\n            <div class=\"pb-2\">\n              <div\n                class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n              >\n                Interactivit\n              </div>\n              <FormRadio\n                title=\"Interactif\"\n                bind:valueSelected=\"{setInteractive}\"\n                on:newvalue=\"{() =>\n                  ($globalOptions.setInteractive = setInteractive)}\"\n                labelsValues=\"{[\n                  { label: 'Laisser tel quel', value: '2' },\n                  { label: 'Tout interactif', value: '1' },\n                  { label: \"Pas d'interactivit\", value: '0' },\n                ]}\"\n              />\n              <div class=\"pl-2 pt-4\">\n                <ButtonToggleAlt\n                  title=\"{\"Modifier l'interactivit\"}\"\n                  bind:value=\"{$globalOptions.isInteractiveFree}\"\n                  id=\"{'config-eleve-interactif-permis-toggle'}\"\n                  explanations=\"{[\n                    \"Les lves peuvent rendre l'exercice interactif ou pas.\",\n                    \"Les lves ne pourront pas changer le status de l'interactivit.\",\n                  ]}\"\n                />\n              </div>\n              <div class=\"pl-2 pt-2\">\n                <ButtonToggleAlt\n                  title=\"{'Une seule rponse'}\"\n                  isDisabled=\"{$globalOptions.setInteractive === '0'}\"\n                  bind:value=\"{$globalOptions.oneShot}\"\n                  id=\"{'config-eleve-refaire-toggle'}\"\n                  explanations=\"{[\n                    \"Les lves n'auront qu'une seule possibilit pour rpondre aux exercices.\",\n                    \"Les lves pourront refaire les exercices autant de fois qu'ils le souhaitent.\",\n                  ]}\"\n                  on:toggle=\"{handleSeed}\"\n                />\n              </div>\n            </div>\n            <div class=\"pb-2\">\n              <div\n                class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n              >\n                Correction\n              </div>\n              <div class=\"flex flex-row justify-start items-center px-4\">\n                <ButtonToggleAlt\n                  title=\"{'Accs aux corrections'}\"\n                  bind:value=\"{$globalOptions.isSolutionAccessible}\"\n                  id=\"{'config-eleve-acces-corrections-toggle'}\"\n                  explanations=\"{[\n                    'Les lves pourront accder aux corrections en cliquant sur un bouton.',\n                    \"Les lves n'auront aucun moyen de voir la correction.\",\n                  ]}\"\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n        <div\n          class=\"hidden opacity-100 transition-opacity duration-150 ease-linear data-[te-tab-active]:block\"\n          id=\"tabs-pres-can\"\n          role=\"tabpanel\"\n          aria-labelledby=\"tabs-pres-can\"\n        >\n          <!-- Can -->\n          <div\n            class=\"flex px-6 py-2 font-light text-lg text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          >\n            Les questions seront poses les unes  la suite des autres en temps\n            limit.\n          </div>\n          <div class=\"pt-2 px-4 grid grid-flow-row md:grid-cols-2 gap-4\">\n            <div class=\"pb-2 w-full flex flex-col\">\n              <div\n                class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n              >\n                Prsentation\n              </div>\n              <div\n                class=\"flex flex-col items-start justify-start space-y-2 px-4\"\n              >\n                <div class=\"flex justify-start flex-row items-center space-x-2\">\n                  <div\n                    class=\"text-coopmaths-corpus-light dark:text-coopmathsdark-corpus text-sm font-light {$canOptions.isChoosen\n                      ? 'text-opacity-100 dark:text-opacity-100'\n                      : 'text-opacity-10 dark:text-opacity-10'}\"\n                  >\n                    Dure :\n                  </div>\n                  <input\n                    type=\"number\"\n                    id=\"config-eleve-can-duration-input\"\n                    class=\"w-1/5 h-6 text-sm bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-corpus dark:text-coopmathsdark-corpus border border-coopmaths-action dark:border-coopmathsdark-action font-light focus:border focus:border-coopmaths-action dark:focus:border-coopmathsdark-action focus:outline-0 focus:ring-0 disabled:border-opacity-10 disabled:text-opacity-10 dark:disabled:border-opacity-10 dark:disabled:text-opacity-10\"\n                    bind:value=\"{$canOptions.durationInMinutes}\"\n                    disabled=\"{!$canOptions.isChoosen}\"\n                  />\n                  <div\n                    class=\"text-coopmaths-corpus-light dark:text-coopmathsdark-corpus text-sm font-light {$canOptions.isChoosen\n                      ? 'text-opacity-100 dark:text-opacity-100'\n                      : 'text-opacity-10 dark:text-opacity-10'}\"\n                  >\n                    minute{$canOptions.durationInMinutes !== undefined &&\n                    $canOptions.durationInMinutes > 1\n                      ? 's'\n                      : ''}.\n                  </div>\n                </div>\n                <div class=\"flex justify-start flex-row items-center space-x-2\">\n                  <div\n                    class=\"text-coopmaths-corpus-light dark:text-coopmathsdark-corpus text-sm font-light {$canOptions.isChoosen\n                      ? 'text-opacity-100 dark:text-opacity-100'\n                      : 'text-opacity-10 dark:text-opacity-10'}\"\n                  >\n                    Sous-titre :\n                  </div>\n                  <input\n                    type=\"text\"\n                    id=\"config-eleve-can-duration-input\"\n                    class=\"w-1/2 h-6 text-sm bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-coopmaths-corpus dark:text-coopmathsdark-corpus border border-coopmaths-action dark:border-coopmathsdark-action font-light focus:border focus:border-coopmaths-action dark:focus:border-coopmathsdark-action focus:outline-0 focus:ring-0 disabled:border-opacity-10 disabled:text-opacity-10 dark:disabled:border-opacity-10 dark:disabled:text-opacity-10\"\n                    bind:value=\"{$canOptions.subTitle}\"\n                    disabled=\"{!$canOptions.isChoosen}\"\n                  />\n                </div>\n              </div>\n            </div>\n            <div class=\"pb-2\">\n              <div\n                class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n              >\n                Solutions\n              </div>\n              <div\n                class=\"flex flex-col items-start justify-start space-y-2 px-4\"\n              >\n                <ButtonToggleAlt\n                  title=\"{'Accs aux solutions'}\"\n                  id=\"{'config-eleve-solutions-can-toggle'}\"\n                  bind:value=\"{$canOptions.solutionsAccess}\"\n                  isDisabled=\"{!$canOptions.isChoosen}\"\n                  explanations=\"{[\n                    'Les lves auront accs aux solutions dans le format dfini ci-dessous.',\n                    \"Les lves n'auront pas accs aux solutions.\",\n                  ]}\"\n                />\n                <FormRadio\n                  title=\"can-solutions-config\"\n                  bind:valueSelected=\"{$canOptions.solutionsMode}\"\n                  isDisabled=\"{!$canOptions.isChoosen ||\n                    !$canOptions.solutionsAccess}\"\n                  labelsValues=\"{[\n                    {\n                      label: 'Solutions rassembles  la fin.',\n                      value: 'gathered',\n                    },\n                    {\n                      label: 'Solutions avec les questions.',\n                      value: 'split',\n                    },\n                  ]}\"\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div\n        class=\"pt-2 pl-2 grid grid-flow-row md:grid-cols-2 gap-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n      >\n        <div class=\"pb-2\">\n          <div\n            class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n          >\n            Donnes\n          </div>\n          <div class=\"flex flex-row justify-start items-center px-4\">\n            <ButtonToggleAlt\n              title=\"{'Donnes diffrentes'}\"\n              bind:value=\"{isDataRandom}\"\n              id=\"{'config-eleve-donnes-differentes-toggle'}\"\n              explanations=\"{[\n                \"Chaque lve aura des pages avec des donnes diffrentes d'un autre lve.\",\n                'Tous les lves auront des pages identiques.',\n              ]}\"\n            />\n          </div>\n        </div>\n        <div class=\"pb-2\">\n          <div\n            class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n          >\n            Affichage du titre de l'exercice\n          </div>\n          <div class=\"flex flex-row justify-start items-center px-4\">\n            <ButtonToggleAlt\n              title=\"{\"Titre de l'exercice\"}\"\n              bind:value=\"{$globalOptions.isTitleDisplayed}\"\n              id=\"{'config-eleve-title-displayed-toggle'}\"\n              explanations=\"{[\n                'Les titres sont affichs',\n                'Les titres sont masqus.',\n              ]}\"\n              on:toggle=\"{handleSeed}\"\n            />\n          </div>\n        </div>\n      </div>\n      <div\n        class=\"pt-4 pb-8 px-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n      >\n        <ButtonTextAction\n          on:click=\"{handleVueSetUp}\"\n          class=\"px-2 py-1 rounded-md\"\n          text=\"Visualiser\"\n        />\n      </div>\n      <div\n        class=\"flex flex-row justify-start px-4 pt-4 pb-2 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n      >\n        <h3\n          class=\"font-bold text-2xl text-coopmaths-struct dark:text-coopmathsdark-struct\"\n        >\n          Utilisation\n        </h3>\n      </div>\n      <div class=\"py-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\">\n        <div\n          class=\"flex flex-col md:flex-row justify-start space-x-10 items-start md:items-center px-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n        >\n          <div\n            class=\"text-coopmaths-struct-light dark:text-coopmathsdark-struct-light font-semibold\"\n          >\n            Format de l'URL\n          </div>\n          <div class=\"flex\">\n            <FormRadio\n              title=\"linkFormat\"\n              bind:valueSelected=\"{currentLinkFormat}\"\n              labelsValues=\"{[\n                { label: 'En clair', value: 'clear' },\n                { label: 'Crypt', value: 'crypt' },\n                { label: 'Raccourci', value: 'short', isDisabled: true },\n              ]}\"\n              orientation=\"row\"\n            />\n          </div>\n        </div>\n        <div\n          class=\"flex flex-row justify-start items-start space-x-10 pt-3 pl-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n        >\n          <div class=\"flex flex-col items-center px-2\">\n            <div\n              class=\"text-coopmaths-struct-lightest dark:text-coopmathsdark-struct-light font-semibold\"\n            >\n              Lien\n            </div>\n            <div class=\"my-1\">\n              <ButtonActionInfo\n                action=\"copy\"\n                textToCopy=\"{buildMathAleaURL({\n                  view: $canOptions.isChoosen ? 'can' : 'eleve',\n                  isEncrypted:\n                    availableLinkFormats[currentLinkFormat].isEncrypted,\n                  removeSeed: isDataRandom,\n                }).toString()}\"\n                tooltip=\"{'Lien ' +\n                  availableLinkFormats[currentLinkFormat].toolTipsMessage}\"\n                icon=\"{'bx-link text-2xl'}\"\n                cornerIcon=\"{availableLinkFormats[currentLinkFormat].icon}\"\n                messageSuccess=\"Le lien de la fiche lve est copi dans le presse-papier !\"\n                messageError=\"Impossible de copier le lien dans le presse-papier !\"\n              />\n            </div>\n          </div>\n          <div class=\"flex flex-col justify-center items-center px-2\">\n            <div\n              class=\"font-semibold\n              text-coopmaths-struct-lightest dark:text-coopmathsdark-struct-lightest\"\n            >\n              QR-Code\n            </div>\n            <div class=\"my-1\">\n              <ButtonQRCode\n                tooltip=\"{'QR-code (lien ' +\n                  availableLinkFormats[currentLinkFormat].toolTipsMessage +\n                  ')'}\"\n                customUrl=\"{buildMathAleaURL({\n                  view: $canOptions.isChoosen ? 'can' : 'eleve',\n                  isEncrypted:\n                    availableLinkFormats[currentLinkFormat].isEncrypted,\n                  removeSeed: isDataRandom,\n                }).toString()}\"\n                cornerIcon=\"{availableLinkFormats[currentLinkFormat].icon}\"\n              />\n            </div>\n          </div>\n          <div class=\"flex flex-col justify-center items-center px-2\">\n            <div\n              class=\"text-coopmaths-struct-lightest dark:text-coopmathsdark-struct-light font-semibold\"\n            >\n              Embarqu\n            </div>\n            <div class=\"my-1\">\n              <ButtonActionInfo\n                action=\"copy\"\n                textToCopy=\"{`<iframe src=\"${buildMathAleaURL({\n                  view: $canOptions.isChoosen ? 'can' : 'eleve',\n                  isEncrypted:\n                    availableLinkFormats[currentLinkFormat].isEncrypted,\n                  removeSeed: isDataRandom,\n                }).toString()}\" width=\"100%\" height=\"100%\" frameborder=\"0\" allowfullscreen></iframe>`}\"\n                tooltip=\"{'Code (lien ' +\n                  availableLinkFormats[currentLinkFormat].toolTipsMessage +\n                  ')'}\"\n                icon=\"{'bx-code-alt text-2xl'}\"\n                cornerIcon=\"{availableLinkFormats[currentLinkFormat].icon}\"\n                messageSuccess=\"Le code de la fiche lve est copi dans le presse-papier !\"\n                messageError=\"Impossible de copier le code dans le presse-papier !\"\n              />\n            </div>\n          </div>\n          <div class=\"flex flex-col justify-center items-center px-2\">\n            <div\n              class=\"text-coopmaths-struct-lightest dark:text-coopmathsdark-struct-light font-semibold\"\n            >\n              Fichier\n            </div>\n            <div class=\"my-1\">\n              <ButtonActionInfo\n                action=\"download\"\n                urlToDownload=\"{buildMathAleaURL({\n                  view: $canOptions.isChoosen ? 'can' : 'eleve',\n                  isEncrypted:\n                    availableLinkFormats[currentLinkFormat].isEncrypted,\n                  removeSeed: isDataRandom,\n                }).toString()}\"\n                fileName=\"{$globalOptions.title\n                  ? $globalOptions.title\n                  : 'mathAlea'}\"\n                successMessage=\"Le tlchargement va dbut dans quelques instants.\"\n                errorMessage=\"Impossible de tlcharger le fichier.\"\n                tooltip=\"{'Fichier de redirection (lien ' +\n                  availableLinkFormats[currentLinkFormat].toolTipsMessage +\n                  ')'}\"\n                icon=\"{'bxs-file-export text-2xl'}\"\n                cornerIcon=\"{availableLinkFormats[currentLinkFormat].icon}\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <Footer />\n</main>\n","<script lang=\"ts\">\n  export let isQuestionsVisible: boolean | undefined\n  export let isCorrectionVisible: boolean | undefined\n  export let currentVue: number\n  export let nbOfVues: 0 | 1 | 2 | 3 | 4\n  export let setCurrentVue: (value: number) => void\n  export let setQuestionsVisible: (value: boolean) => void\n  export let setCorrectionVisible: (value: boolean) => void\n  export let handleCorrectionsStepsClick: (\n    button: 'backward' | 'forward',\n  ) => void\n  export let newDataForAll: () => void\n  export let backToSettings: () => void\n</script>\n\n<div\n  class=\"flex flex-col items-center w-14 min-h-screen py-4\n  bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\n  text-coopmaths-struct dark:text-coopmathsdark-struct\"\n>\n  <button\n    type=\"button\"\n    class=\"pb-8\n      text-coopmaths-action dark:text-coopmathsdark-action\n      hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n    on:click=\"{backToSettings}\"\n  >\n    <i class=\"bx bx-sm bx-arrow-back\"></i>\n  </button>\n  <button\n    type=\"button\"\n    class=\"pb-8\n      text-coopmaths-action dark:text-coopmathsdark-action\n      hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n    on:click=\"{newDataForAll}\"\n  >\n    <i class=\"bx bx-sm bx-refresh\"></i>\n  </button>\n\n  <span\n    class=\"text-xs\n    {isQuestionsVisible ? 'font-bold' : 'font-light'}\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Questions\n  </span>\n  <button\n    type=\"button\"\n    on:click=\"{() => setQuestionsVisible(!isQuestionsVisible)}\"\n  >\n    <i\n      class=\"bx bx-sm cursor-pointer\n      {isQuestionsVisible ? 'bx-toggle-right' : 'bx-toggle-left'}\n      text-coopmaths-action dark:text-coopmathsdark-action\n      hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n    ></i>\n  </button>\n  <span\n    class=\"text-xs pt-2\n    {isCorrectionVisible ? 'font-bold' : 'font-light'}\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Rponses\n  </span>\n  <button\n    type=\"button\"\n    on:click=\"{() => setCorrectionVisible(!isCorrectionVisible)}\"\n  >\n    <i\n      class=\"mb-8 bx bx-sm cursor-pointer\n      {isCorrectionVisible ? 'bx-toggle-right' : 'bx-toggle-left'}\n      text-coopmaths-action dark:text-coopmathsdark-action\n      hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n    ></i>\n  </button>\n  <span\n    class=\"text-xs font-bold pt-2\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Pas  pas\n  </span>\n  <div\n    class=\"flex flex-row justify-center items-center mb-8\n    text-coopmaths-action dark:text-coopmathsdark-action\n    hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n  >\n    <button\n      type=\"button\"\n      on:click=\"{() => handleCorrectionsStepsClick('backward')}\"\n    >\n      <i class=\"bx bxs-left-arrow mr-2 cursor-pointer\"></i>\n    </button>\n    <button\n      type=\"button\"\n      on:click=\"{() => handleCorrectionsStepsClick('forward')}\"\n    >\n      <i class=\"bx bxs-right-arrow cursor-pointer\"></i>\n    </button>\n  </div>\n\n  <!-- Onglets Sries -->\n  {#if nbOfVues > 1}\n    {#each [...Array(nbOfVues).keys()] as i}\n      <input\n        type=\"radio\"\n        id=\"tab{i + 1}\"\n        value=\"{i}\"\n        bind:group=\"{currentVue}\"\n        on:change=\"{() => setCurrentVue(i)}\"\n        class=\"peer/tab{i + 1} items-center justify-center hidden\"\n      />\n      <label\n        class=\"flex flex-row justify-center items-center text-center\n          w-14 h-14 rounded-l-lg border-y border-l\n          cursor-pointer peer-checked/tab{i + 1}:cursor-default\n          border-coopmaths-struct dark:border-coopmathsdark-struct\n          bg-coopmaths-canvas-dark font-bold dark:bg-coopmathsdark-canvas-dark\n          text-coopmaths-action dark:text-coopmathsdark-action\n          hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\n          peer-checked/tab{i + 1}:bg-coopmaths-canvas dark:peer-checked/tab{i +\n          1}:bg-coopmathsdark-canvas\n          peer-checked/tab{i +\n          1}:text-coopmaths-struct dark:peer-checked/tab{i +\n          1}:text-coopmathsdark-struct\"\n        for=\"tab{i + 1}\"\n      >\n        {i + 1}\n      </label>\n    {/each}\n    <input\n      type=\"radio\"\n      id=\"tab5\"\n      value=\"{4}\"\n      bind:group=\"{currentVue}\"\n      on:change=\"{() => setCurrentVue(4)}\"\n      class=\"hidden peer/tab5 items-center justify-center\"\n    />\n    <label\n      class=\"flex flex-row rounded-l-lg border-y border-l border-coopmaths-struct dark:border-coopmathsdark-struct w-14 h-14 justify-center items-center text-center cursor-pointer bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark font-bold text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest peer-checked/tab5:bg-coopmaths-canvas dark:peer-checked/tab5:bg-coopmathsdark-canvas peer-checked/tab5:text-coopmaths-struct dark:peer-checked/tab5:text-coopmathsdark-struct peer-checked/tab5:cursor-default\"\n      for=\"tab5\"\n    >\n      Tout\n    </label>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import type { Serie } from '../../../types'\n  import { mathaleaFormatExercice } from '../../../../../../lib/mathalea'\n\n  export let isQuestionsVisible: boolean | undefined\n  export let isCorrectionVisible: boolean | undefined\n  export let seriesIndex: number\n  export let order: number[]\n  export let series: Serie[]\n  export let correctionsSteps: number[]\n</script>\n\n<div\n  class=\"p-6 pb-2 text-3xl font-black\n  text-coopmaths-struct dark:text-coopmathsdark-struct\"\n>\n  {#if series.length > 1}\n    Srie {seriesIndex + 1}\n  {:else}\n    {isQuestionsVisible ? 'Questions' : ''}\n    {isCorrectionVisible && isQuestionsVisible ? ' / ' : ''}\n    {isCorrectionVisible ? 'Rponses' : ''}\n  {/if}\n</div>\n<div\n  class=\"mt-2\n  mx-2 lg:mx-6\"\n>\n  {#each order as i, index}\n    <div class=\"flex flex-row my-4\">\n      <div class=\"pr-2\">\n        <span\n          class=\"font-black\n          text-coopmaths-struct dark:text-coopmathsdark-struct\"\n        >\n          {index + 1})\n        </span>\n      </div>\n      <div class=\"flex flex-col justify-start items-start\">\n        {#if isQuestionsVisible}\n          <div>\n            <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n            {@html mathaleaFormatExercice(series[seriesIndex].questions[i])}\n          </div>\n        {/if}\n        {#if isCorrectionVisible || correctionsSteps.includes(i)}\n          <div\n            class=\"relative self-start max-w-full border-l-[3px] mt-6 py-2 pl-6\n              border-l-coopmaths-struct dark:border-l-coopmathsdark-struct\n              text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n          >\n            <div class=\"container overflow-x-auto overflow-y-hidden\">\n              <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n              {@html mathaleaFormatExercice(series[seriesIndex].corrections[i])}\n            </div>\n            <div\n              class=\"absolute -left-[3px] -top-[15px] py-[1.5px] px-3 rounded-t-md\n                font-semibold text-xs\n                bg-coopmaths-struct dark:bg-coopmathsdark-struct\n                text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n            >\n              Correction\n            </div>\n            <div\n              class=\"absolute bottom-0 left-0 border-b-[3px] w-4\n                border-coopmaths-struct dark:border-coopmathsdark-struct\"\n            ></div>\n          </div>\n        {/if}\n      </div>\n    </div>\n  {/each}\n</div>\n","<script lang=\"ts\">\n  import type { Serie } from '../../../types'\n  import SlideshowOverviewSeries from './SlideshowOverviewSerie.svelte'\n\n  export let isQuestionsVisible: boolean | undefined\n  export let isCorrectionVisible: boolean | undefined\n  export let currentSeriesIndex: number\n  export let order: number[]\n  export let series: Serie[]\n  export let correctionsSteps: number[]\n</script>\n\n{#each Array(series.length).keys() as seriesId}\n  <div\n    class=\"{currentSeriesIndex === 4 || currentSeriesIndex === seriesId\n      ? ''\n      : 'hidden'}\"\n  >\n    <SlideshowOverviewSeries\n      {isQuestionsVisible}\n      {isCorrectionVisible}\n      seriesIndex=\"{seriesId}\"\n      {order}\n      {series}\n      {correctionsSteps}\n    />\n  </div>\n{/each}\n","<script lang=\"ts\">\n  import ButtonIconTooltip from '../../../../../../shared/forms/ButtonIconTooltip.svelte'\n\n  export let zoomUpdate: (plusMinus: '+' | '-') => void\n</script>\n\n<ButtonIconTooltip\n  icon=\"bx-zoom-out text-3xl\"\n  tooltip=\"Rduire la taille du texte\"\n  on:click=\"{() => zoomUpdate('-')}\"\n/>\n<ButtonIconTooltip\n  icon=\"bx-zoom-in text-3xl\"\n  tooltip=\"Augmenter la taille du texte\"\n  on:click=\"{() => zoomUpdate('+')}\"\n/>\n","<script lang=\"ts\">\n  import type Exercice from '../../../../exercices/Exercice'\n  import type { InterfaceParams } from '../../../../lib/types'\n  import type { Serie, Slideshow } from '../types'\n  import SlideshowOverviewLeftPanel from './presentationalComponent/SlideshowOverviewLeftPanel.svelte'\n  import SlideshowOverviewMainPanel from './presentationalComponent/mainPanel/SlideshowOverviewMainPanel.svelte'\n  import ZoomButtons from '../../start/presentationalComponents/header/headerButtons/setupButtons/ZoomButtons.svelte'\n  import { tick } from 'svelte'\n  import {\n    mathaleaGenerateSeed,\n    mathaleaRenderDiv,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../../lib/mathalea'\n  import {\n    globalOptions,\n    darkMode,\n    exercicesParams,\n  } from '../../../../lib/stores/generalStore'\n  import { isIntegerInRange0to4 } from '../../../../lib/types/integerInRange'\n\n  export let exercises: Exercice[] = []\n  export let slideshow: Slideshow\n  export let updateExercises: (\n    updateSlidesContent?: boolean,\n    updateParamsFromUrl?: boolean,\n  ) => void\n  export let backToSettings: () => void\n\n  let currentSeriesIndex: 0 | 1 | 2 | 3 | 4 = 0\n  let isCorrectionVisible = false\n  let isQuestionsVisible = true\n  let divExercice: HTMLElement\n  let correctionsSteps: number[] = []\n\n  let nbVues: 0 | 1 | 2 | 3 | 4\n  $: {\n    const nbVuesCandidate = slideshow.slides[0].vues.length\n    if (isIntegerInRange0to4(nbVuesCandidate)) {\n      nbVues = nbVuesCandidate\n    }\n  }\n\n  let order: number[]\n  $: {\n    const questionsNb =\n      slideshow.selectedQuestionsNumber || slideshow.slides.length\n    order =\n      $globalOptions.order === undefined || $globalOptions.order.length === 0\n        ? [...Array(questionsNb).keys()]\n        : $globalOptions.order\n  }\n\n  let series: Serie[] = []\n  $: {\n    series = []\n    for (let i = 0; i < nbVues; i++) {\n      const serie: Serie = {\n        consignes: [],\n        questions: [],\n        corrections: [],\n      }\n      for (const slide of slideshow.slides) {\n        serie.consignes.push(slide.vues[i].consigne)\n        serie.questions.push(slide.vues[i].question)\n        serie.corrections.push(slide.vues[i].correction)\n      }\n      series.push(serie)\n    }\n  }\n\n  $: if (\n    (isQuestionsVisible ||\n      isCorrectionVisible ||\n      correctionsSteps.length > 0) &&\n    currentSeriesIndex !== undefined\n  ) {\n    tick().then(() => mathaleaRenderDiv(divExercice))\n  }\n\n  function setCorrectionVisible(correctionVisibility: boolean) {\n    isCorrectionVisible = correctionVisibility\n    if (!isCorrectionVisible) {\n      setQuestionsVisible(true)\n    }\n  }\n\n  function setCurrentVue(vue: number) {\n    if (isIntegerInRange0to4(vue)) {\n      currentSeriesIndex = vue\n    }\n  }\n\n  function setQuestionsVisible(questionsVisibility: boolean) {\n    isQuestionsVisible = questionsVisibility\n    if (!isQuestionsVisible) {\n      setCorrectionVisible(true)\n    }\n  }\n\n  function newDataForAll() {\n    const newParams: InterfaceParams[] = []\n    for (const exercice of exercises) {\n      exercice.seed = mathaleaGenerateSeed()\n      newParams.push({\n        uuid: exercice.uuid,\n        id: exercice.id,\n        alea: exercice.seed.substring(0, 4),\n        nbQuestions: exercice.nbQuestions,\n        duration: exercice.duration,\n      })\n    }\n    exercicesParams.set(newParams)\n    updateExercises(true)\n    mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n    isQuestionsVisible = true\n    isCorrectionVisible = false\n    correctionsSteps = []\n  }\n\n  /**\n   * Gestion du pas  pas pour l'affichage des corrections\n   * @param {string} button chane correspondant  la direction du pas  pas (\"backward\" ou \"forward\")\n   */\n  function handleCorrectionsStepsClick(button: 'backward' | 'forward') {\n    if (button === 'backward') {\n      if (correctionsSteps.length !== 0) {\n        correctionsSteps.pop()\n        correctionsSteps = correctionsSteps\n      }\n    }\n    if (button === 'forward') {\n      if (correctionsSteps.length < order.length) {\n        correctionsSteps.push(order[correctionsSteps.length])\n      }\n      correctionsSteps = correctionsSteps\n    }\n  }\n\n  function zoomUpdate(plusMinus: '+' | '-') {\n    const oldZoom = Number($globalOptions.z || 1)\n    const newZoom = Number(\n      (plusMinus === '+' ? oldZoom + 0.1 : oldZoom - 0.1).toFixed(1),\n    )\n    $globalOptions.z = newZoom.toString()\n    const main = document.querySelector('main')\n    tick().then(() => mathaleaRenderDiv(main))\n    mathaleaUpdateUrlFromExercicesParams()\n  }\n</script>\n\n<div class=\"{$darkMode.isActive ? 'dark' : ''}\">\n  <div\n    class=\"fixed z-20 rounded-b-full rounded-t-full bg-opacity-80\n    bottom-2 lg:bottom-6\n    right-2 lg:right-6\n    bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  >\n    <div\n      class=\"flex flex-col space-y-2\n      scale-75 lg:scale-100\"\n    >\n      <ZoomButtons {zoomUpdate} />\n    </div>\n  </div>\n  <div\n    class=\"flex\n    bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  >\n    <aside class=\"h-screen sticky top-0\">\n      <SlideshowOverviewLeftPanel\n        {isQuestionsVisible}\n        {isCorrectionVisible}\n        currentVue=\"{currentSeriesIndex}\"\n        nbOfVues=\"{nbVues}\"\n        {setCurrentVue}\n        {setQuestionsVisible}\n        {setCorrectionVisible}\n        {handleCorrectionsStepsClick}\n        {newDataForAll}\n        {backToSettings}\n      />\n    </aside>\n    <main\n      class=\"flex flex-row p-2\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\n      text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n      bind:this=\"{divExercice}\"\n    >\n      <SlideshowOverviewMainPanel\n        {isQuestionsVisible}\n        {isCorrectionVisible}\n        {currentSeriesIndex}\n        {order}\n        {series}\n        {correctionsSteps}\n      />\n    </main>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import type { Vue } from '../../../types'\n\n  export let slideView: Vue\n</script>\n\n<div>\n  <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n  {@html slideView.correction}\n</div>\n","<script lang=\"ts\">\n  import type { Vue } from '../../../types'\n\n  export let slideView: Vue\n</script>\n\n<div>\n  <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n  {@html slideView.correctionText}\n</div>\n<div>\n  {#each slideView.correctionSvgs as correctionSvg}\n    <div>\n      <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n      {@html correctionSvg}\n    </div>\n  {/each}\n</div>\n","<script lang=\"ts\">\n  import type { Vue } from '../../../types'\n\n  export let slideView: Vue\n</script>\n\n<div class=\"flex flex-col\">\n  <div>\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    {@html slideView.consigne}\n  </div>\n  <div>\n    <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n    {@html slideView.question}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import type { Vue } from '../../../types'\n\n  export let slideView: Vue\n</script>\n\n<div class=\"flex flex-row\">\n  <div>\n    {#each slideView.consigneSvgs as consigneSvg}\n      <div>\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html consigneSvg}\n      </div>\n    {/each}\n  </div>\n  <div>\n    <div>\n      <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n      {@html slideView.consigneText}\n    </div>\n    <div>\n      <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n      {@html slideView.questionText}\n    </div>\n  </div>\n  <div class=\"flex flex-row\">\n    {#each slideView.questionSvgs as questionSvg}\n      <div>\n        <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n        {@html questionSvg}\n      </div>\n    {/each}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import type { Slide } from '../../../types'\n  import CorrectionWithImagesInside from './CorrectionWithImagesInside.svelte'\n  import CorrectionWithImagesOnSides from './CorrectionWithImagesOnSides.svelte'\n  import QuestionWithImagesInside from './QuestionWithImagesInside.svelte'\n  import QuestionWithImagesOnSides from './QuestionWithImagesOnSides.svelte'\n\n  export let divQuestion: HTMLDivElement[]\n  export let isQuestionVisible: boolean\n  export let isCorrectionVisible: boolean\n  export let currentSlide: Slide\n  export let currentQuestion: number\n  export let selectedQuestionsNumber: number\n  export let isImagesOnSides: boolean\n\n  let nbVues\n  $: nbVues = currentSlide?.vues.length || 1\n</script>\n\n<div\n  class=\"place-content-stretch justify-items-center w-full h-full grid\n  {nbVues > 1 ? 'grid-cols-2 gap-4 auto-rows-fr' : 'grid-cols-1'}\"\n>\n  {#each [...Array(nbVues).keys()] as i}\n    <div\n      class=\"relative flex flex-col justify-center justify-self-stretch place-items-stretch\n      min-h-[100%] max-h-[100%] p-2 text-center\n      {nbVues > 1\n        ? 'bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark'\n        : ''}\"\n    >\n      {#if nbVues > 1}\n        <div\n          class=\"absolute -top-1 -left-1 rounded-tl-2xl w-1/12 h-1/12 font-black text-4xl\n          bg-coopmaths-struct dark:bg-coopmathsdark-struct\n          text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n        >\n          {i + 1}\n        </div>\n      {/if}\n      <div\n        id=\"exerciseContainer{i}\"\n        bind:this=\"{divQuestion[i]}\"\n        class=\"flex flex-col justify-center items-center px-4 w-full min-h-[100%] max-h-[100%]\"\n      >\n        {#if isQuestionVisible && currentSlide.vues[i]}\n          <div class=\"py-4 flex items-center\" id=\"question{i}\">\n            {#if isImagesOnSides}\n              <QuestionWithImagesOnSides slideView=\"{currentSlide.vues[i]}\" />\n            {:else}\n              <QuestionWithImagesInside slideView=\"{currentSlide.vues[i]}\" />\n            {/if}\n          </div>\n        {/if}\n        {#if isCorrectionVisible && currentSlide.vues[i]}\n          <div\n            id=\"correction{i}\"\n            class=\"flex items-center my-10\n              bg-opacity-30 dark:bg-opacity-30\n              bg-coopmaths-warn-light dark:bg-coopmathsdark-warn-light\"\n          >\n            {#if isImagesOnSides}\n              <CorrectionWithImagesOnSides slideView=\"{currentSlide.vues[i]}\" />\n            {:else}\n              <CorrectionWithImagesInside slideView=\"{currentSlide.vues[i]}\" />\n            {/if}\n          </div>\n        {/if}\n      </div>\n    </div>\n  {/each}\n</div>\n<dialog\n  id=\"transition\"\n  class=\"absolute top-0 left-0 min-w-full w-full min-h-full h-full\n    text-[150px] font-extralight\n    bg-coopmaths-struct dark:bg-coopmathsdark-struct\n    text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n>\n  <div class=\"flex justify-center items-center w-full min-h-full h-full\">\n    <div\n      class=\"radial-progress\"\n      style=\"--value:{((currentQuestion + 1) / selectedQuestionsNumber) * 100};\"\n    >\n      {currentQuestion + 1} / {selectedQuestionsNumber}\n    </div>\n  </div>\n</dialog>\n\n<style>\n  dialog::backdrop {\n    backdrop-filter: blur(4px);\n  }\n  .radial-progress {\n    font-size: 20vw;\n    --size: 60vw;\n    --thickness: 3vw;\n  }\n\n  @media (min-aspect-ratio: 1/1) {\n    .radial-progress {\n      font-size: 20vh;\n      --size: 60vh;\n      --thickness: 3vh;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { showDialogForLimitedTime } from '../../../../../../../lib/components/dialogs'\n  import TwoStatesIcon from '../../../../../../../components/shared/icons/TwoStatesIcon.svelte'\n  import { onMount, onDestroy } from 'svelte'\n\n  export let callback: (isFullScreen: boolean) => void = () => {}\n\n  type FullscreenRequestEnabled = {\n    requestFullscreen?(): Promise<void>\n    mozRequestFullScreen?(): Promise<void>\n    webkitRequestFullscreen?(): Promise<void>\n    msRequestFullscreen?(): Promise<void>\n  }\n\n  const isFullscreenRequestEnabled = (\n    element: HTMLElement,\n  ): element is HTMLElement & FullscreenRequestEnabled => {\n    return (\n      'requestFullscreen' in element ||\n      'mozRequestFullScreen' in element ||\n      'webkitRequestFullscreen' in element ||\n      'msRequestFullscreen' in element\n    )\n  }\n\n  type FullscreenExitEnabled = {\n    exitFullscreen?(): Promise<void>\n    mozCancelFullScreen?(): Promise<void>\n    webkitExitFullscreen?(): Promise<void>\n    msExitFullscreen?(): Promise<void>\n  }\n\n  const isFullscreenExitEnabled = (\n    doc: Document,\n  ): doc is Document & FullscreenExitEnabled => {\n    return (\n      'exitFullscreen' in doc ||\n      'mozCancelFullScreen' in doc ||\n      'webkitExitFullscreen' in doc ||\n      'msExitFullscreen' in doc\n    )\n  }\n\n  const appId = 'appComponent'\n  let isFullScreen = false\n\n  onMount(() => {\n    document.addEventListener('fullscreenchange', handleFullscreenChange)\n  })\n\n  onDestroy(() => {\n    document.removeEventListener('fullscreenchange', handleFullscreenChange)\n  })\n\n  const handleFullscreenChange = () => {\n    const isInFullScreen = document.fullscreenElement != null\n    isFullScreen = isInFullScreen\n    callback?.(isFullScreen)\n  }\n\n  const switchFullScreen = async () => {\n    const element = document.getElementById(appId)\n    if (!element) {\n      handleFullScreenError(new Error(`#${appId} non trouv`))\n      return\n    }\n\n    isFullScreen = !isFullScreen\n\n    const isInFullScreen = document.fullscreenElement != null\n    if (isFullScreen && !isInFullScreen) {\n      if (isFullscreenRequestEnabled(element)) {\n        try {\n          await requestFullScreen(element)\n        } catch (error) {\n          console.error('Erreur lors de la requte de plein cran.')\n        }\n      } else {\n        handleFullScreenError(new Error('Plein cran non disponible'))\n      }\n    }\n    if (!isFullScreen && isInFullScreen) {\n      if (isFullscreenExitEnabled(document)) {\n        try {\n          await exitFullScreen()\n        } catch (error) {\n          console.error('Erreur lors de la sortie du plein cran.')\n        }\n      } else {\n        handleFullScreenError(new Error('Sortie du plein cran non disponible'))\n      }\n    }\n    callback?.(isFullScreen)\n  }\n\n  const requestFullScreen = async (\n    element: HTMLElement & FullscreenRequestEnabled,\n  ) => {\n    if (\n      !(element instanceof HTMLElement) ||\n      !isFullscreenRequestEnabled(element)\n    ) {\n      handleFullScreenError(new Error(\"Le plein cran n'est plus disponible\"))\n      return\n    }\n    const method =\n      element.requestFullscreen ||\n      element.mozRequestFullScreen ||\n      element.webkitRequestFullscreen ||\n      element.msRequestFullscreen\n    if (method) {\n      try {\n        await method.call(element)\n      } catch (error) {\n        handleFullScreenError(new Error('Requte de plein cran refuse'))\n      }\n    } else {\n      handleFullScreenError(new Error('Plein cran non disponible'))\n    }\n  }\n\n  const exitFullScreen = async () => {\n    if (!isFullscreenExitEnabled(document)) {\n      handleFullScreenError(new Error(\"Le plein cran n'est plus disponible\"))\n      return\n    }\n    const method =\n      document.exitFullscreen ||\n      document.mozCancelFullScreen ||\n      document.webkitExitFullscreen ||\n      document.msExitFullscreen\n    if (method) {\n      await method.call(document)\n    } else {\n      handleFullScreenError(new Error('Sortie du plein cran non disponible'))\n    }\n  }\n\n  const handleFullScreenError = (error: Error) => {\n    console.error(error)\n    showDialogForLimitedTime('notifDialog', 2000, 'Accs au plein cran refus')\n  }\n</script>\n\n<button\n  type=\"button\"\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"{isFullScreen ? 'Quitter le plein cran' : 'Plein cran'}\"\n  on:click=\"{switchFullScreen}\"\n>\n  <div class=\"px-2\">\n    <TwoStatesIcon isOnStateActive=\"{isFullScreen}\">\n      <i\n        slot=\"icon_to_switch_on\"\n        class=\"bx bx-fullscreen text-3xl\n          text-coopmaths-action dark:text-coopmathsdark-action\n          hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n      ></i>\n      <i\n        slot=\"icon_to_switch_off\"\n        class=\"bx bx-exit-fullscreen text-3xl\n        text-coopmaths-action dark:text-coopmathsdark-action\n        hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n      ></i>\n    </TwoStatesIcon>\n  </div>\n</button>\n","<script lang=\"ts\">\n  import ButtonIcon from '../../../../../shared/forms/ButtonIcon.svelte'\n  import FullscreenButton from '../../../../start/presentationalComponents/header/headerButtons/setupButtons/FullscreenButton.svelte'\n\n  export let zoomPlus: () => void\n  export let zoomMinus: () => void\n  export let BUTTONS_CLASS: string\n</script>\n\n<FullscreenButton />\n<ButtonIcon\n  icon=\"bx-plus {BUTTONS_CLASS}\"\n  title=\"Raccourci clavier : +\"\n  on:click=\"{zoomPlus}\"\n/>\n<ButtonIcon\n  icon=\"bx-minus {BUTTONS_CLASS}\"\n  title=\"Raccourci clavier : -\"\n  on:click=\"{zoomMinus}\"\n/>\n","<script lang=\"ts\">\n  import ButtonIcon from '../../../../../shared/forms/ButtonIcon.svelte'\n\n  export let isPause: boolean\n  export let isManualModeActive: boolean | undefined\n  export let prevQuestion: () => void\n  export let nextQuestion: () => void\n  export let switchPause: (isUserAction?: boolean) => void\n  export let BUTTONS_CLASS: string\n</script>\n\n<ButtonIcon\n  icon=\"bx-skip-previous {BUTTONS_CLASS}\"\n  title=\"Raccourci clavier : flche gauche\"\n  on:click=\"{prevQuestion}\"\n/>\n<ButtonIcon\n  icon=\"{isPause ? 'bx-play' : 'bx-pause'} {BUTTONS_CLASS} {isManualModeActive\n    ? 'invisible'\n    : ''}\"\n  title=\"Raccourci clavier : espace\"\n  on:click=\"{() => switchPause(true)}\"\n/>\n<ButtonIcon\n  icon=\"bx-skip-next {BUTTONS_CLASS}\"\n  title=\"Raccourci clavier : flche droite\"\n  on:click=\"{nextQuestion}\"\n/>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import { setPhraseDuree } from '../../../lib/components/time'\n\n  let cursorTimeValue = 10\n\n  let messageDuree: string\n  $: messageDuree = setPhraseDuree(cursorTimeValue)\n\n  const dispatch = createEventDispatcher()\n</script>\n\n<div class=\"flex flex-col\">\n  <input\n    class=\"py-3\"\n    type=\"range\"\n    max=\"30\"\n    min=\"0\"\n    name=\"duration\"\n    id=\"duration\"\n    bind:value=\"{cursorTimeValue}\"\n    on:change=\"{() => dispatch('change', cursorTimeValue)}\"\n  />\n  <label\n    class=\"\n      text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n    for=\"duration\"\n  >\n    {messageDuree}\n  </label>\n</div>\n\n<style lang=\"scss\">\n  // Styling Cross-Browser Compatible Range Inputs with Sass\n  // Github: https://github.com/darlanrod/input-range-sass\n  // Author: Darlan Rod https://github.com/darlanrod\n  // Version 1.5.3\n  // MIT License\n\n  @use 'sass:math';\n  @use 'sass:color';\n\n  $track-color: white !default;\n  $track-color-dark-mode: #1a202c !default;\n  $thumb-color: default !default; // coopmaths-action\n\n  $thumb-radius: 999px !default;\n  $thumb-height: 18px !default;\n  $thumb-width: 18px !default;\n  $thumb-shadow-size: 2px !default;\n  $thumb-shadow-blur: 2px !default;\n  $thumb-shadow-color: rgba(0, 0, 0, 0.2) !default;\n  $thumb-border-width: 2px !default;\n  $thumb-border-color: #eceff1 !default;\n\n  $track-width: 100% !default;\n  $track-height: 5px !default;\n  $track-shadow-size: 0px !default;\n  $track-shadow-blur: 1px !default;\n  $track-shadow-color: rgba(0, 0, 0, 0.2) !default;\n  $track-border-width: 1px !default;\n  $track-border-color: #cfd8dc !default;\n  $track-radius: 5px !default;\n\n  $contrast: 5% !default;\n  $ie-bottom-track-color: color.adjust(\n    $track-color,\n    $lightness: -$contrast\n  ) !default;\n\n  @mixin shadow($shadow-size, $shadow-blur, $shadow-color) {\n    box-shadow:\n      $shadow-size $shadow-size $shadow-blur $shadow-color,\n      0 0 $shadow-size color.adjust($shadow-color, $lightness: $contrast);\n  }\n\n  @mixin track {\n    cursor: default;\n    height: $track-height;\n    transition: all 0.2s ease;\n    width: $track-width;\n  }\n\n  @mixin thumb {\n    @include shadow(\n      $thumb-shadow-size,\n      $thumb-shadow-blur,\n      $thumb-shadow-color\n    );\n    background: $thumb-color;\n    border: $thumb-border-width solid $thumb-border-color;\n    border-radius: $thumb-radius;\n    box-sizing: border-box;\n    cursor: default;\n    height: $thumb-height;\n    width: $thumb-width;\n  }\n\n  [type='range'] {\n    -webkit-appearance: none;\n    appearance: none;\n    background: transparent;\n    margin: math.div($thumb-height, 2) 0;\n    width: $track-width;\n\n    &::-moz-focus-outer {\n      border: 0;\n    }\n\n    &:focus {\n      outline: 0;\n\n      &::-webkit-slider-runnable-track {\n        background: color.adjust($track-color, $lightness: $contrast);\n      }\n\n      &::-ms-fill-lower {\n        background: $track-color;\n      }\n\n      &::-ms-fill-upper {\n        background: color.adjust($track-color, $lightness: $contrast);\n      }\n    }\n\n    &::-webkit-slider-runnable-track {\n      @include track;\n      @include shadow(\n        $track-shadow-size,\n        $track-shadow-blur,\n        $track-shadow-color\n      );\n      background: $track-color;\n      border: $track-border-width solid $track-border-color;\n      border-radius: $track-radius;\n    }\n\n    &::-webkit-slider-thumb {\n      @include thumb;\n      -webkit-appearance: none;\n      margin-top: (\n        math.div((-$track-border-width * 2 + $track-height), 2) - math.div(\n            $thumb-height,\n            2\n          )\n      );\n    }\n\n    &::-moz-range-track {\n      @include shadow(\n        $track-shadow-size,\n        $track-shadow-blur,\n        $track-shadow-color\n      );\n      @include track;\n      background: $track-color;\n      border: $track-border-width solid $track-border-color;\n      border-radius: $track-radius;\n      height: math.div($track-height, 2);\n    }\n\n    &::-moz-range-thumb {\n      @include thumb;\n    }\n\n    &::-ms-track {\n      @include track;\n      background: transparent;\n      border-color: transparent;\n      border-width: math.div($thumb-height, 2) 0;\n      color: transparent;\n    }\n\n    &::-ms-fill-lower {\n      @include shadow(\n        $track-shadow-size,\n        $track-shadow-blur,\n        $track-shadow-color\n      );\n      background: $ie-bottom-track-color;\n      border: $track-border-width solid $track-border-color;\n      border-radius: ($track-radius * 2);\n    }\n\n    &::-ms-fill-upper {\n      @include shadow(\n        $track-shadow-size,\n        $track-shadow-blur,\n        $track-shadow-color\n      );\n      background: $track-color;\n      border: $track-border-width solid $track-border-color;\n      border-radius: ($track-radius * 2);\n    }\n\n    &::-ms-thumb {\n      @include thumb;\n      margin-top: math.div($track-height, 4);\n    }\n\n    &:disabled {\n      &::-webkit-slider-thumb,\n      &::-moz-range-thumb,\n      &::-ms-thumb,\n      &::-webkit-slider-runnable-track,\n      &::-ms-fill-lower,\n      &::-ms-fill-upper {\n        cursor: not-allowed;\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import RangeSlider from '../../../../../shared/forms/RangeSlider.svelte'\n  import BasicClassicModal from '../../../../../shared/modal/BasicClassicModal.svelte'\n\n  export let handleTimerChange: (cursorTimeValue: number) => void\n  export let isTimerSettingsModalDisplayed: boolean\n</script>\n\n<BasicClassicModal\n  bind:isDisplayed=\"{isTimerSettingsModalDisplayed}\"\n  icon=\"bx-stopwatch\"\n>\n  <h3\n    slot=\"header\"\n    class=\"font-bold text-lg\n    text-coopmaths-struc dark:text-coopmathsdark-struct\"\n  >\n    <p>Temps par question</p>\n  </h3>\n  <div slot=\"content\" class=\"flex flex-col justify-center items-center\">\n    <p\n      class=\"\n      text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n    >\n      Rgler la dure de projection en secondes\n    </p>\n    <div class=\"flex justify-center w-full md:w-3/4 xl:w-2/3\">\n      <RangeSlider\n        on:change=\"{(e) => {\n          const cursorTimeValue = e.detail\n          handleTimerChange(cursorTimeValue)\n        }}\"\n      />\n    </div>\n  </div>\n</BasicClassicModal>\n","<script lang=\"ts\">\n  import ButtonIcon from '../../../../../shared/forms/ButtonIcon.svelte'\n  import SlideshowPlayTimerSettingsModal from './SlideshowPlayTimerSettingsModal.svelte'\n\n  export let handleTimerChange: (cursorTimeValue: number) => void\n  export let switchDisplayMode: () => void\n  export let backToSettings: (event: Event) => void\n  export let pause: () => void\n  export let play: (isUserAction: boolean) => void\n  export let isManualModeActive: boolean | undefined\n  export let isQuestionVisible: boolean\n  export let isCorrectionVisible: boolean\n  export let currentSlideDuration: number\n  export let BUTTONS_CLASS: string\n\n  let isTimerSettingsModalDisplayedOnce = false\n\n  $: getDisplayMode = () => {\n    if (isQuestionVisible && !isCorrectionVisible) {\n      return 'Q'\n    }\n    if (isQuestionVisible && isCorrectionVisible) {\n      return 'Q+C'\n    }\n    if (!isQuestionVisible && isCorrectionVisible) {\n      return 'C'\n    }\n    return ''\n  }\n\n  let isTimerSettingsModalDisplayed = false\n  function displayTimerSettingsModal() {\n    isTimerSettingsModalDisplayed = true\n  }\n\n  $: if (isTimerSettingsModalDisplayed) {\n    pause()\n    isTimerSettingsModalDisplayedOnce = true\n  } else if (isTimerSettingsModalDisplayedOnce) {\n    play(true)\n  }\n</script>\n\n<ButtonIcon\n  icon=\"bx-stopwatch {BUTTONS_CLASS}\"\n  title=\"Rgler la dure de chaque question\"\n  floatUnderText=\"{isManualModeActive ? 'Manuel' : currentSlideDuration + 's'}\"\n  on:click=\"{displayTimerSettingsModal}\"\n/>\n<ButtonIcon\n  icon=\"bx-show {BUTTONS_CLASS}\"\n  title=\"Raccourci clavier : Entre\"\n  floatUnderText=\"{getDisplayMode()}\"\n  on:click=\"{switchDisplayMode}\"\n/>\n<ButtonIcon\n  icon=\"bx-power-off {BUTTONS_CLASS}\"\n  title=\"Retour au paramtrage\"\n  on:click=\"{backToSettings}\"\n/>\n<SlideshowPlayTimerSettingsModal\n  bind:isTimerSettingsModalDisplayed\n  {handleTimerChange}\n/>\n","<script lang=\"ts\">\n  import SlideshowPlayDisplaySettings from './SlideshowPlayDisplaySettings.svelte'\n  import SlideshowPlayControlSettings from './SlideshowPlayControlSettings.svelte'\n  import SlideshowPlayOtherSettings from './SlideshowPlayOtherSettings.svelte'\n\n  export let isManualModeActive: boolean | undefined\n  export let isQuestionVisible: boolean\n  export let isCorrectionVisible: boolean\n  export let handleTimerChange: (cursorTimeValue: number) => void\n  export let backToSettings: (event: Event) => void\n  export let isPause: boolean\n  export let nextQuestion: () => void\n  export let prevQuestion: () => void\n  export let switchDisplayMode: () => void\n  export let switchPause: (isUserAction?: boolean) => void\n  export let zoomMinus: () => void\n  export let zoomPlus: () => void\n  export let pause: () => void\n  export let play: (isUserAction?: boolean) => void\n  export let currentSlideDuration: number\n\n  const BUTTONS_CLASS = 'mx-1.5 bx-sm md:bx-lg'\n</script>\n\n<div class=\"flex flex-row justify-start items-center ml-7 w-[33%]\">\n  <SlideshowPlayDisplaySettings {BUTTONS_CLASS} {zoomPlus} {zoomMinus} />\n</div>\n<div class=\"flex flex-row justify-center items-center w-[33%]\">\n  <SlideshowPlayControlSettings\n    {BUTTONS_CLASS}\n    {isPause}\n    {isManualModeActive}\n    {prevQuestion}\n    {nextQuestion}\n    {switchPause}\n  />\n</div>\n<div class=\"flex flex-row justify-end items-baseline mr-7 w-[33%]\">\n  <SlideshowPlayOtherSettings\n    {BUTTONS_CLASS}\n    {pause}\n    {play}\n    {handleTimerChange}\n    {switchDisplayMode}\n    {backToSettings}\n    {isManualModeActive}\n    {isQuestionVisible}\n    {isCorrectionVisible}\n    {currentSlideDuration}\n  />\n</div>\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n\n  export let isManualModeActive: boolean | undefined\n  export let currentQuestionNumber: number\n  export let totalQuestionsNumber: number\n  export let goToQuestion: (index: number) => void\n  export let ratioTime: number\n  export let currentSlideDuration: number\n\n  let stepsUl: HTMLElement | null\n  onMount(() => {\n    stepsUl = document.getElementById('stepsUl')\n  })\n\n  $: {\n    if (stepsUl) {\n      const steps = stepsUl.querySelectorAll('button')\n      if (steps[currentQuestionNumber])\n        steps[currentQuestionNumber].scrollIntoView()\n      if (steps[currentQuestionNumber + 5])\n        steps[currentQuestionNumber + 5].scrollIntoView()\n      if (steps[currentQuestionNumber - 5])\n        steps[currentQuestionNumber - 5].scrollIntoView()\n      const diapoProgressContainer = document.getElementById(\n        'diapoProgressContainer',\n      )\n      if (diapoProgressContainer) diapoProgressContainer.scrollIntoView()\n    }\n  }\n</script>\n\n<div\n  id=\"diapoProgressContainer\"\n  class:invisible=\"{isManualModeActive}\"\n  class=\"flex flex-row flex-shrink-0 h-6 border\n    border-coopmaths-warn dark:border-coopmathsdark-warn\"\n>\n  <div\n    class=\"bg-coopmaths-warn dark:bg-coopmathsdark-warn\"\n    style=\"width: {ratioTime}%; transition: width {currentSlideDuration /\n      100}s linear\"\n  ></div>\n</div>\n<ul id=\"stepsUl\" class=\"steps w-full mt-3\">\n  {#each [...Array(totalQuestionsNumber).keys()] as i}\n    <button\n      on:click=\"{() => goToQuestion(i)}\"\n      class=\"cursor-pointer\n        step dark:step-info\n        {currentQuestionNumber === i ? 'step-current' : ''}\n        {currentQuestionNumber >= i ? 'step-primary' : ''}\"\n    >\n    </button>\n  {/each}\n</ul>\n\n<style>\n  @keyframes pulse {\n    0%,\n    100% {\n      transform: scale(1);\n    }\n    50% {\n      transform: scale(1.1);\n    }\n  }\n  .step::after {\n    color: white;\n  }\n  .step-current::after {\n    animation: pulse 1s infinite ease-in-out;\n  }\n</style>\n","<script lang=\"ts\">\n  import { buildMathAleaURL } from '../../../../../lib/components/urls'\n  import ButtonQRCode from '../../../../shared/forms/ButtonQRCode.svelte'\n  import ButtonActionInfo from '../../../../shared/forms/ButtonActionInfo.svelte'\n  import ButtonIconTooltip from '../../../../shared/forms/ButtonIconTooltip.svelte'\n\n  export let returnToStart: () => void\n  export let backToSettings: () => void\n  export let goToOverview: () => void\n</script>\n\n<div class=\"flex flex-row items-baseline justify-center w-full my-4\">\n  <ButtonIconTooltip\n    icon=\"bx-arrow-back mx-[3vw] my-2 text-[6vw]\"\n    tooltip=\"Dbut du Diaporama\"\n    on:click=\"{returnToStart}\"\n  />\n  <ButtonIconTooltip\n    icon=\"bx-detail mx-[3vw] my-2 text-[6vw]\"\n    tooltip=\"Questions + Rponses\"\n    on:click=\"{goToOverview}\"\n  />\n  <ButtonActionInfo\n    action=\"copy\"\n    textToCopy=\"{buildMathAleaURL({ view: 'diaporama' }).toString()}\"\n    icon=\"bx-link text-[6vw] mx-[3vw] my-2\"\n    tooltip=\"Lien du Diaporama\"\n    successMessage=\"Le lien est copi dans le presse-papier !\"\n    errorMessage=\"Impossible de copier le lien dans le presse-papier.\"\n  />\n  <ButtonQRCode\n    icon=\"bx-qr text-[6vw] mx-[3vw] my-2\"\n    tooltip=\"QR-code du diaporama\"\n    customUrl=\"{document.URL}\"\n  />\n  <ButtonIconTooltip\n    icon=\"bx-home-alt-2 text-[6vw] mx-[3vw] my-2\"\n    tooltip=\"Sortir du diaporama\"\n    on:click=\"{backToSettings}\"\n  />\n</div>\n","<script lang=\"ts\">\n  import type { Slide, Slideshow } from '../types'\n  import SlideshowPlayQuestion from './presentationalComponents/slideshowPlayQuestion/SlideshowPlayQuestion.svelte'\n  import SlideshowPlaySettings from './presentationalComponents/slideshowPlaySettings/SlideshowPlaySettings.svelte'\n  import SlideshowPlaySteps from './presentationalComponents/SlideshowPlaySteps.svelte'\n  import SlideshowPlayEndButtons from './presentationalComponents/SlideshowPlayEndButtons.svelte'\n  import { onDestroy, tick } from 'svelte'\n  import { showDialogForLimitedTime } from '../../../../lib/components/dialogs'\n  import { mathaleaRenderDiv } from '../../../../lib/mathalea'\n  import { globalOptions } from '../../../../lib/stores/generalStore'\n\n  export let slideshow: Slideshow\n  export let transitionSounds: Record<string, HTMLAudioElement>\n  export let backToSettings: () => void\n  export let goToOverview: () => void\n\n  const divQuestion: HTMLDivElement[] = []\n  const exercicesAffiches = new window.Event('exercicesAffiches', {\n    bubbles: true,\n  })\n  let isCorrectionVisible = false\n  let isPause = false\n  let isManualPause = false\n  let isQuestionVisible = true\n  let advanceRatioTimeInterval: number\n  let ratioTime = 0 // Pourcentage du temps coul (entre 1 et 100)\n  let userZoom = 1\n  let optimalZoom = 1\n\n  let flow: 'Q->Q' | 'Q->R->Q' | 'Q->(Q+R)->Q'\n  $: {\n    switch ($globalOptions.flow) {\n      case 0:\n        flow = 'Q->Q'\n        break\n      case 1:\n        flow = 'Q->R->Q'\n        break\n      case 2:\n        flow = 'Q->(Q+R)->Q'\n        break\n    }\n  }\n\n  let order: number[] = []\n  $: {\n    const questionsNb =\n      slideshow.selectedQuestionsNumber || slideshow.slides.length\n    order = $globalOptions.order || [...Array(questionsNb).keys()]\n  }\n\n  let nbVues: 1 | 2 | 3 | 4\n  $: nbVues = $globalOptions.nbVues ?? 1\n\n  let currentSlide: Slide\n  $: currentSlide = slideshow.slides[order[slideshow.currentQuestion]]\n\n  let currentSlideDuration: number\n  $: currentSlideDuration =\n    $globalOptions.durationGlobal ||\n    (currentSlide && currentSlide.exercise.duration) ||\n    10\n\n  $: if (slideshow.currentQuestion > -1) {\n    playCurrentQuestion()\n  }\n\n  onDestroy(() => {\n    pause()\n  })\n\n  function prevQuestion() {\n    if (slideshow.currentQuestion === 0) {\n      pause()\n      backToSettings()\n      return\n    }\n    if (isManualPause) {\n      slideshow.currentQuestion--\n      return\n    }\n    isQuestionVisible = true\n    isCorrectionVisible = false\n    ratioTime = 0\n    slideshow.currentQuestion--\n  }\n\n  function nextQuestion() {\n    if (isManualPause) {\n      slideshow.currentQuestion++\n      return\n    }\n    if (flow === 'Q->Q' || isCorrectionVisible) {\n      isQuestionVisible = true\n      isCorrectionVisible = false\n      ratioTime = 0\n      slideshow.currentQuestion++\n      return\n    }\n    isQuestionVisible = flow === 'Q->(Q+R)->Q'\n    isCorrectionVisible = true\n    pause()\n    renderAllViews()\n  }\n\n  async function playCurrentQuestion() {\n    const isEndScreen =\n      slideshow.currentQuestion === slideshow.selectedQuestionsNumber\n    if (isEndScreen) {\n      return\n    }\n    await renderAllViews()\n    if (isManualPause) {\n      ratioTime = 0\n      return\n    }\n    if ($globalOptions.sound !== undefined && $globalOptions.sound > 0) {\n      try {\n        await transitionSounds[$globalOptions.sound - 1].play()\n      } catch (error) {\n        if (error instanceof Error) {\n          if (error.name === 'NotAllowedError') {\n            console.error(\n              'Audio playback was not allowed. Please interact with the page to enable audio.',\n            )\n          } else {\n            console.error(\n              'An error occurred while trying to play the audio:',\n              error,\n            )\n          }\n        } else {\n          console.error('An unknown error occurred:', error)\n        }\n      }\n    }\n    if ($globalOptions.screenBetweenSlides)\n      await showDialogForLimitedTime('transition', 1000)\n    play(false)\n  }\n\n  async function renderAllViews(optimalZoomUpdate: boolean = true) {\n    if (optimalZoomUpdate) {\n      optimalZoom = await findOptimalZoom()\n    }\n    for (let vueIndex = 0; vueIndex < nbVues; vueIndex++) {\n      const exerciseContainerDiv = document.getElementById(\n        'exerciseContainer' + vueIndex,\n      )\n      mathaleaRenderDiv(exerciseContainerDiv, optimalZoom * userZoom)\n    }\n    document.dispatchEvent(exercicesAffiches)\n  }\n\n  async function findOptimalZoom() {\n    await tick()\n    const optimalZoomForViews = new Array(nbVues).fill(0)\n    for (let vueIndex = 0; vueIndex < nbVues; vueIndex++) {\n      optimalZoomForViews[vueIndex] = findOptimalZoomForView(vueIndex)\n    }\n    return Math.min(...optimalZoomForViews)\n  }\n\n  function findOptimalZoomForView(vueIndex: number) {\n    const MIN_ZOOM = 0.5\n    const exerciseContainerDiv = document.getElementById(\n      'exerciseContainer' + vueIndex,\n    )\n    const questionDiv = document.getElementById('question' + vueIndex)\n    const correctionDiv = document.getElementById('correction' + vueIndex)\n    if (!exerciseContainerDiv) return\n    const svgContainers =\n      exerciseContainerDiv.getElementsByClassName('svgContainer') ?? []\n    for (const svgContainer of svgContainers) {\n      svgContainer.classList.add('flex')\n      svgContainer.classList.add('justify-center')\n      svgContainer\n        .querySelectorAll<HTMLElement>('[id^=\"M2D\"]')\n        .forEach((item) => {\n          item.style.display = 'inline-block'\n        })\n    }\n    mathaleaRenderDiv(exerciseContainerDiv, 1)\n    const { height: questionHeight, width: questionWidth } =\n      getSizes(questionDiv)\n    const { height: correctionHeight, width: correctionWidth } =\n      getSizes(correctionDiv)\n    const containerWidth = exerciseContainerDiv.clientWidth\n    const containerHeight = exerciseContainerDiv.clientHeight\n    const questionWidthOptimalZoom = containerWidth / questionWidth\n    const correctionWidthOptimalZoom = containerWidth / correctionWidth\n    const questionCorrectionHeightOptimalZoom =\n      containerHeight / (questionHeight + correctionHeight)\n    return Math.max(\n      Math.min(\n        questionWidthOptimalZoom,\n        correctionWidthOptimalZoom,\n        questionCorrectionHeightOptimalZoom,\n      ),\n      MIN_ZOOM,\n    )\n  }\n\n  function getSizes(element: HTMLElement | null) {\n    if (element === null) {\n      return { height: 0, width: 0 }\n    } else {\n      return {\n        height:\n          element.scrollHeight > element.clientHeight\n            ? element.scrollHeight\n            : element.clientHeight,\n        width:\n          element.scrollWidth > element.clientWidth\n            ? element.scrollWidth\n            : element.clientWidth,\n      }\n    }\n  }\n\n  window.onresize = () => {\n    renderAllViews()\n  }\n\n  function handleShortcut(e: KeyboardEvent) {\n    if (e.key === '+' && !e.metaKey && !e.ctrlKey) {\n      e.preventDefault()\n      zoomPlus()\n    }\n    if (e.key === '-' && !e.metaKey && !e.ctrlKey) {\n      e.preventDefault()\n      zoomMinus()\n    }\n    if (e.key === 'ArrowLeft') {\n      e.preventDefault()\n      prevQuestion()\n    }\n    if (e.key === 'ArrowRight') {\n      e.preventDefault()\n      nextQuestion()\n    }\n    if (e.key === ' ') {\n      e.preventDefault()\n      switchPause(true)\n    }\n    if (e.key === 'Enter') {\n      e.preventDefault()\n      switchDisplayMode()\n    }\n  }\n\n  function handleTimerChange(cursorTimeValue: number) {\n    const durationGlobal = cursorTimeValue || undefined\n    $globalOptions.manualMode = !durationGlobal\n    $globalOptions.durationGlobal = durationGlobal\n    pause(true)\n  }\n\n  function zoomPlus() {\n    userZoom += 0.05\n    renderAllViews(false)\n  }\n\n  function zoomMinus() {\n    if (userZoom > 0.5) {\n      userZoom -= 0.05\n    }\n    renderAllViews(false)\n  }\n  async function switchDisplayMode() {\n    pause()\n    if (isQuestionVisible && !isCorrectionVisible) {\n      isQuestionVisible = false\n      isCorrectionVisible = true\n    } else if (isQuestionVisible && isCorrectionVisible) {\n      isQuestionVisible = true\n      isCorrectionVisible = false\n    } else if (!isQuestionVisible && isCorrectionVisible) {\n      isQuestionVisible = true\n      isCorrectionVisible = true\n    }\n    await tick()\n    renderAllViews()\n  }\n\n  function play(isUserAction: boolean = false) {\n    if (ratioTime >= 100) {\n      nextQuestion()\n    }\n    if (isUserAction) isManualPause = false\n    if (isManualPause) {\n      return\n    }\n    isPause = false\n    if (ratioTime === 0) {\n      // Permet de ne pas sauter une question si la correction est affiche et qu'on se dplace en cliquant sur les steps\n      isQuestionVisible = true\n      isCorrectionVisible = false\n      renderAllViews()\n    }\n    if ($globalOptions.manualMode) {\n      return\n    }\n    if (isCorrectionVisible) {\n      nextQuestion()\n      return\n    }\n    clearInterval(advanceRatioTimeInterval)\n    advanceRatioTimeInterval = window.setInterval(() => {\n      ratioTime++\n      if (ratioTime >= 100) {\n        clearInterval(advanceRatioTimeInterval)\n        if (!$globalOptions.pauseAfterEachQuestion) {\n          nextQuestion()\n        }\n      }\n    }, currentSlideDuration * 10)\n  }\n\n  function pause(isUserAction: boolean = false) {\n    if ($globalOptions.manualMode) {\n      return\n    }\n    clearInterval(advanceRatioTimeInterval)\n    isPause = true\n    if (isUserAction) isManualPause = true\n  }\n\n  function switchPause(isUserAction: boolean = false) {\n    if ($globalOptions.manualMode) {\n      return\n    }\n    if (isPause || ratioTime >= 100) {\n      play(isUserAction)\n    } else {\n      pause(isUserAction)\n    }\n  }\n\n  function goToQuestion(questionNumber: number) {\n    if (\n      questionNumber < 0 ||\n      questionNumber > slideshow.selectedQuestionsNumber\n    ) {\n      return\n    }\n    slideshow.currentQuestion = questionNumber\n    ratioTime = 0\n  }\n\n  function returnToStart() {\n    isQuestionVisible = true\n    isCorrectionVisible = false\n    pause(true)\n    goToQuestion(0)\n  }\n</script>\n\n<svelte:window on:keydown=\"{handleShortcut}\" />\n\n{#if slideshow.currentQuestion < slideshow.selectedQuestionsNumber && slideshow.currentQuestion > -1}\n  <div\n    id=\"diap\"\n    class=\"flex flex-col h-screen scrollbar-hide\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n    data-theme=\"daisytheme\"\n  >\n    <header\n      class=\"flex flex-col pb-1 w-full\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n    >\n      <SlideshowPlaySteps\n        currentQuestionNumber=\"{slideshow.currentQuestion}\"\n        isManualModeActive=\"{$globalOptions.manualMode}\"\n        totalQuestionsNumber=\"{slideshow.selectedQuestionsNumber}\"\n        {ratioTime}\n        {currentSlideDuration}\n        {goToQuestion}\n      />\n    </header>\n    <main\n      class=\"h-[80%]\n      text-coopmaths-corpus dark:text-coopmathsdark-corpus\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n    >\n      <SlideshowPlayQuestion\n        {divQuestion}\n        {isQuestionVisible}\n        {isCorrectionVisible}\n        {currentSlide}\n        currentQuestion=\"{slideshow.currentQuestion}\"\n        selectedQuestionsNumber=\"{slideshow.selectedQuestionsNumber}\"\n        isImagesOnSides=\"{!!$globalOptions.isImagesOnSides}\"\n      />\n    </main>\n    <footer\n      class=\"sticky flex flex-row justify-between w-full py-1 bottom-0 opacity-100\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n    >\n      <SlideshowPlaySettings\n        isManualModeActive=\"{$globalOptions.manualMode}\"\n        {isQuestionVisible}\n        {isCorrectionVisible}\n        {currentSlideDuration}\n        {handleTimerChange}\n        {backToSettings}\n        {isPause}\n        {prevQuestion}\n        {nextQuestion}\n        {switchDisplayMode}\n        {switchPause}\n        {play}\n        {pause}\n        {zoomPlus}\n        {zoomMinus}\n      />\n    </footer>\n  </div>\n{:else}\n  <div\n    id=\"end\"\n    class=\"flex flex-col h-screen scrollbar-hide justify-center\n      text-coopmaths-struct dark:text-coopmathsdark-struct\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n    data-theme=\"daisytheme\"\n  >\n    <div\n      class=\"flex flex-row items-center justify-center w-full text-[20vw] font-extrabold\"\n    >\n      Fin !\n    </div>\n    <SlideshowPlayEndButtons {returnToStart} {backToSettings} {goToOverview} />\n  </div>\n{/if}\n","<script lang=\"ts\">\n  import ButtonIconTooltip from '../../../../shared/forms/ButtonIconTooltip.svelte'\n  import FullscreenButton from '../../../start/presentationalComponents/header/headerButtons/setupButtons/FullscreenButton.svelte'\n\n  export let goToOverview: () => void\n</script>\n\n<div class=\"flex flex-row justify-start items-center pb-6\">\n  <div\n    class=\"flex text-lg font-bold\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Aperu\n  </div>\n  <div class=\"pl-4\">\n    <ButtonIconTooltip\n      icon=\"bx-detail text-2xl\"\n      tooltip=\"Aperu des questions/rponses\"\n      on:click=\"{goToOverview}\"\n    />\n  </div>\n  <div class=\"pl-4\">\n    <FullscreenButton />\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  export let id: string\n  export let min: number = 1\n  export let max: number = 100\n  export let value: number\n  export let isDisabled: boolean = false\n\n  const dispatch = createEventDispatcher()\n</script>\n\n<span class=\"flex justify-center\">\n  <input\n    type=\"number\"\n    {id}\n    {min}\n    {max}\n    step=\"{$$props.step || 1}\"\n    bind:value\n    on:change=\"{() => dispatch('change', value)}\"\n    class=\"{$$props.class} ml-3 w-16 h-8\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\n      border-1\n      border-coopmaths-action dark:border-coopmathsdark-action\n      focus:border-1 focus:outline-0 focus:ring-0\n      focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest\n      disabled:opacity-30\"\n    disabled=\"{isDisabled}\"\n  />\n</span>\n","<script lang=\"ts\">\n  import type Exercice from '../../../../../exercices/Exercice'\n  import NumberInput from '../../../../shared/forms/InputNumber.svelte'\n  import { formattedTimeStamp } from '../../../../../lib/components/time'\n  import { exercicesParams } from '../../../../../lib/stores/generalStore'\n\n  export let exercises: Exercice[]\n  export let selectedExercisesIndexes: number[]\n  export let isManualModeActive: boolean\n  export let updateExercises: (updateSlidesContent?: boolean) => void\n  export let durationGlobal: number | undefined\n  export let remove: (exerciseIndex: number) => void\n  let stringDureeTotale = '0'\n\n  $: getTotalNbOfQuestions = () => {\n    let sum = 0\n    for (const [i, exercice] of exercises.entries()) {\n      if (selectedExercisesIndexes.length > 0) {\n        if (selectedExercisesIndexes.includes(i)) {\n          sum += exercice.nbQuestions\n        }\n      } else {\n        sum += exercice.nbQuestions\n      }\n    }\n    return sum\n  }\n\n  $: if (exercises && exercises.length > 0) {\n    stringDureeTotale = formattedTimeStamp(getTotalDuration())\n  }\n\n  function getTotalDuration() {\n    let sum = 0\n    for (const [i, exercice] of exercises.entries()) {\n      if (\n        selectedExercisesIndexes !== undefined &&\n        selectedExercisesIndexes.length > 0\n      ) {\n        if (selectedExercisesIndexes.includes(i)) {\n          sum +=\n            (durationGlobal || exercice.duration || 10) * exercice.nbQuestions\n        }\n      } else {\n        sum +=\n          (durationGlobal || exercice.duration || 10) * exercice.nbQuestions\n      }\n    }\n    return sum\n  }\n\n  function updateQuestionsNb(i: number, value: number) {\n    exercises[i].nbQuestions = value\n    exercicesParams.update((params) => {\n      params[i].nbQuestions = value\n      return params\n    })\n    updateExercises()\n  }\n\n  function updateDuration(i: number, value: number) {\n    exercises[i].duration = value\n    exercicesParams.update((params) => {\n      params[i].duration = value\n      return params\n    })\n    updateExercises()\n  }\n</script>\n\n<div\n  class=\"table-wrp block shadow ring-1 rounded-lg\n  ring-opacity-10 dark:ring-opacity-20\n  ring-coopmaths-struct dark:ring-coopmathsdark-struct\"\n>\n  <table\n    class=\"table-fixed min-w-full\n    divide-y\n    divide-opacity-10 dark:divide-opacity-20\n    divide-coopmaths-struct dark:divide-coopmathsdark-struct\"\n  >\n    <thead\n      class=\"sticky top-0\n      bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n    >\n      <tr>\n        <th\n          scope=\"col\"\n          class=\"py-3.5 pl-4 pr-3 w-4/6\n            text-left text-sm font-semibold\n            text-coopmaths-struct dark:text-coopmathsdark-struct\"\n        >\n          Exercices\n          <span\n            class=\"pl-1 font-light text-xs\n            text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\n            {selectedExercisesIndexes.length > 0 ? '' : 'invisible'}\"\n          >\n            ({selectedExercisesIndexes.length} parmi {exercises.length})\n          </span>\n        </th>\n        <th\n          scope=\"col\"\n          class=\"py-3.5 pl-4 pr-3 w-1/6\n            text-center text-sm font-semibold\n            text-coopmaths-struct dark:text-coopmathsdark-struct\"\n        >\n          <div class=\"{isManualModeActive ? 'opacity-20' : ''}\">\n            Dure par question\n          </div>\n          <div\n            class=\"font-light text-xs\n            text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n          >\n            {#if !isManualModeActive}\n              Dure diapo :<span class=\"font-light ml-1\"\n                >{stringDureeTotale}</span\n              >\n            {:else}\n              <span class=\"font-light ml-1\"></span>\n            {/if}\n          </div>\n        </th>\n        <th\n          scope=\"col\"\n          class=\"py-3.5 pl-4 pr-3 w-1/6\n            text-center text-sm font-semibold\n            text-coopmaths-struct dark:text-coopmathsdark-struct\"\n        >\n          <div>Nombres de questions</div>\n          <div\n            class=\"font-light text-xs\n            text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n          >\n            Total :<span class=\"font-light ml-1\">{getTotalNbOfQuestions()}</span\n            >\n          </div>\n        </th>\n        <th></th>\n      </tr>\n    </thead>\n    <tbody class=\"overflow-y-auto\" id=\"exercisesList\">\n      {#each exercises as exercise, i}\n        <tr>\n          <td\n            class=\"whitespace-normal px-3 py-4 text-sm text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n          >\n            <span\n              class=\"{selectedExercisesIndexes.length > 0 &&\n              selectedExercisesIndexes.length < exercises.length &&\n              selectedExercisesIndexes.includes(i)\n                ? ''\n                : 'invisible'} pr-2\"\n            >\n              <i\n                class=\"bx text-xs bxs-circle text-coopmaths-warn-lightest dark:text-coopmathsdark-warn-lightest\"\n              ></i>\n            </span>\n            {exercise.id} - {exercise.titre}\n          </td>\n          <td class=\"whitespace-normal px-3 py-4 text-sm\">\n            <NumberInput\n              id=\"diaporama-exo-duration-{i}\"\n              value=\"{exercise.duration || 10}\"\n              isDisabled=\"{!!durationGlobal || isManualModeActive}\"\n              on:change=\"{(e) => {\n                const duration = e.detail\n                updateDuration(i, duration)\n              }}\"\n            />\n          </td>\n          <td class=\"whitespace-normal px-3 py-4 text-sm\">\n            <NumberInput\n              id=\"diaporama-exo-nb-questions-{i}\"\n              value=\"{exercise.nbQuestions}\"\n              on:change=\"{(e) => {\n                const nbQuestions = e.detail\n                updateQuestionsNb(i, nbQuestions)\n              }}\"\n            />\n          </td>\n          <td>\n            <button\n              class=\"mx-2 tooltip tooltip-left tooltip-neutral\"\n              data-tip=\"Supprimer l'exercice\"\n              type=\"button\"\n              on:click=\"{() => remove(i)}\"\n            >\n              <i\n                class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-trash\"\n              ></i>\n            </button>\n          </td>\n        </tr>\n      {/each}\n    </tbody>\n  </table>\n</div>\n\n<style>\n  .table-wrp {\n    max-height: 60%;\n    overflow-y: auto;\n    display: block;\n  }\n  thead {\n    position: sticky;\n    top: 0;\n  }\n</style>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  export let id: string\n  export let isChecked: boolean\n  export let isDisabled: boolean = false\n  export let label: string\n\n  const dispatch = createEventDispatcher()\n</script>\n\n<div class=\"flex flex-row justify-start items-center px-4 mt-1\">\n  <input\n    {id}\n    aria-describedby=\"{id}\"\n    type=\"checkbox\"\n    class=\"w-4 h-4 rounded\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\n      {isDisabled\n      ? 'border-opacity-20 dark:border-opacity-20'\n      : 'cursor-pointer'}\n      border-coopmaths-action dark:border-coopmathsdark-action\n      text-coopmaths-action dark:text-coopmathsdark-action\n      focus:ring-3\n      focus:ring-coopmaths-action dark:focus:ring-coopmathsdark-action\"\n    bind:checked=\"{isChecked}\"\n    on:change=\"{() => dispatch('change', isChecked)}\"\n    disabled=\"{isDisabled}\"\n  />\n  <label\n    for=\"{id}\"\n    class=\"ml-3 text-sm\n      text-coopmaths-corpus dark:text-coopmathsdark-corpus\n      {isDisabled\n      ? 'text-opacity-20 dark:text-opacity-20'\n      : 'text-opacity-70 dark:text-opacity-70 cursor-pointer'}\n      {isChecked ? 'font-semibold' : 'font-light'}\"\n  >\n    {label}\n  </label>\n</div>\n","<script lang=\"ts\">\n  import type Exercice from '../../../../../exercices/Exercice'\n  import CheckboxWithLabel from '../../../../shared/forms/CheckboxWithLabel.svelte'\n  import NumberInput from '../../../../shared/forms/InputNumber.svelte'\n\n  export let exercises: Exercice[]\n  export let isManualModeActive: boolean\n  export let updateManualMode: (isManualModeActive: boolean) => void\n  export let durationGlobal: number | undefined\n  export let updateDurationGlobal: (durationGlobal: number | undefined) => void\n\n  let previousDurationGlobal = durationGlobal || 10\n  let isSameDurationForAll = !!durationGlobal\n  function handleChangeIsSameDurationForAll(newIsSameDurationForAll: boolean) {\n    isSameDurationForAll = newIsSameDurationForAll\n    if (isSameDurationForAll) {\n      updateDurationGlobal(previousDurationGlobal)\n    } else {\n      updateDurationGlobal(undefined)\n    }\n  }\n\n  function updatePreviousDurationGlobal(newDurationGlobal: number) {\n    previousDurationGlobal = newDurationGlobal\n    updateDurationGlobal(newDurationGlobal)\n  }\n</script>\n\n<div\n  class=\"flex flex-col lg:flex-row px-4 pb-4 w-full\n  justify-start lg:justify-between\n  items-start lg:items-center\"\n>\n  <div\n    class=\"flex text-lg font-bold\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Dures et nombres de questions\n  </div>\n  <div class=\"flex items-center\">\n    <CheckboxWithLabel\n      id=\"slideshow-manual-mode-checkbox\"\n      isChecked=\"{isManualModeActive}\"\n      label=\"Dfilement manuel\"\n      on:change=\"{(e) => {\n        const isChecked = e.detail\n        updateManualMode(isChecked)\n      }}\"\n    />\n    <CheckboxWithLabel\n      id=\"slideshow-same-duration-checkbox\"\n      isChecked=\"{isSameDurationForAll}\"\n      isDisabled=\"{exercises.length === 1 || isManualModeActive}\"\n      label=\"Mme dure pour toutes les questions\"\n      on:change=\"{(e) => {\n        const isChecked = e.detail\n        handleChangeIsSameDurationForAll(isChecked)\n      }}\"\n    />\n    <NumberInput\n      id=\"diaporama-same-duration-input\"\n      value=\"{previousDurationGlobal}\"\n      isDisabled=\"{!isSameDurationForAll || isManualModeActive}\"\n      on:change=\"{(e) => {\n        const previousDurationGlobal = e.detail\n        updatePreviousDurationGlobal(previousDurationGlobal)\n      }}\"\n    />\n  </div>\n</div>\n","<script lang=\"ts\">\n  import ButtonQRCode from '../../../../shared/forms/ButtonQRCode.svelte'\n  import ButtonActionInfo from '../../../../shared/forms/ButtonActionInfo.svelte'\n  import CheckboxWithLabel from '../../../../shared/forms/CheckboxWithLabel.svelte'\n\n  let isSameData: boolean = false\n</script>\n\n<div>\n  <div\n    class=\"flex text-lg font-bold pb-2\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Liens\n  </div>\n  <div>\n    <CheckboxWithLabel\n      id=\"slideshow-links-same-data-checkbox\"\n      bind:isChecked=\"{isSameData}\"\n      label=\"Mmes valeurs d'une session  l'autre\"\n    />\n  </div>\n  <div class=\"flex flex-row pl-4 space-x-2 font-normal\">\n    <ButtonActionInfo\n      action=\"copy\"\n      icon=\"{'bx-link text-2xl'}\"\n      useCurrentUrl=\"{true}\"\n      removeSeed=\"{!isSameData}\"\n      tooltip=\"Lien du Diaporama\"\n      successMessage=\"Le lien du diaporama est copi dans le presse-papier !\"\n      errorMessage=\"Impossible de copier le lien du diaporama dans le presse-papier.\"\n    />\n    <ButtonQRCode\n      tooltip=\"{'QR-code du diaporama'}\"\n      useCurrentUrl=\"{true}\"\n      removeSeed=\"{!isSameData}\"\n    />\n  </div>\n</div>\n","<script lang=\"ts\">\n  import type { NumberRange } from '../../../../../lib/types'\n  import CheckboxWithLabel from '../../../../shared/forms/CheckboxWithLabel.svelte'\n  import FormRadio from '../../../../shared/forms/FormRadio.svelte'\n\n  export let nbOfViews: NumberRange<1, 4>\n  export let updateNbOfViews: (nbOfViews: NumberRange<1, 4>) => void\n  export let isImagesOnSides: boolean\n  export let updateIsImagesOnSides: (isImagesOnSides: boolean) => void\n\n  const labelsForMultivue = [\n    { label: 'Pas de multivue', value: 1 },\n    { label: 'Deux vues', value: 2 },\n    { label: 'Trois vues', value: 3 },\n    { label: 'Quatre vues', value: 4 },\n  ]\n</script>\n\n<div\n  class=\"flex text-lg font-bold mb-2\n  text-coopmaths-struct dark:text-coopmathsdark-struct\"\n>\n  Affichage\n</div>\n<div class=\"flex flex-col px-4 pb-8\">\n  <FormRadio\n    bind:valueSelected=\"{nbOfViews}\"\n    on:newvalue=\"{() => updateNbOfViews(nbOfViews)}\"\n    title=\"multivue\"\n    labelsValues=\"{labelsForMultivue}\"\n  />\n  <CheckboxWithLabel\n    id=\"slideshow-view-images-on-sides-checkbox\"\n    isChecked=\"{isImagesOnSides}\"\n    label=\"Afficher les images sur les cts\"\n    on:change=\"{(e) => {\n      const isChecked = e.detail\n      updateIsImagesOnSides(isChecked)\n    }}\"\n  />\n</div>\n","<script lang=\"ts\">\n  import CheckboxWithLabel from '../../../../shared/forms/CheckboxWithLabel.svelte'\n\n  export let isQuestionsOrdered: boolean\n  export let updateQuestionsOrder: (isQuestionsOrdered: boolean) => void\n</script>\n\n<div class=\"pb-6\">\n  <div\n    class=\"flex text-lg font-bold mb-1\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Ordre\n  </div>\n  <CheckboxWithLabel\n    id=\"slideshow-order-checkbox\"\n    isChecked=\"{isQuestionsOrdered}\"\n    label=\"Questions dans l'ordre\"\n    on:change=\"{(e) => {\n      const isChecked = e.detail\n      updateQuestionsOrder(isChecked)\n    }}\"\n  />\n</div>\n","<script lang=\"ts\">\n  import type Exercice from '../../../../../exercices/Exercice'\n  import CheckboxWithLabel from '../../../../shared/forms/CheckboxWithLabel.svelte'\n  import NumberInput from '../../../../shared/forms/InputNumber.svelte'\n\n  export let exercises: Exercice[]\n  export let selectedExercisesIndexes: number[]\n  export let applyRandomSelectionOfExercises: (\n    numberOfSelectedExercises: number,\n  ) => void\n\n  const isSelectedExercises: boolean = selectedExercisesIndexes.length > 0\n  let selectedExercisesCount: number = selectedExercisesIndexes.length\n</script>\n\n<div class=\"pb-6\">\n  <div\n    class=\"flex text-lg font-bold mb-1\n      text-coopmaths-struct dark:text-coopmathsdark-struct\n      {exercises.length === 1 ? 'text-opacity-20' : 'text-opacity-100'}\"\n  >\n    Slection alatoire d'exercices\n  </div>\n  <CheckboxWithLabel\n    id=\"slideshow-selected-exercises-checkbox\"\n    isChecked=\"{isSelectedExercises}\"\n    isDisabled=\"{exercises.length === 1}\"\n    label=\"Seulement certains exercices de la liste\"\n    on:change=\"{(e) => {\n      const isChecked = e.detail\n      selectedExercisesCount = isChecked ? exercises.length - 1 : 0\n      applyRandomSelectionOfExercises(selectedExercisesCount)\n    }}\"\n  />\n  <div class=\"pl-8 mt-1 flex\">\n    <NumberInput\n      id=\"slideshow-selected-exercises-count-input\"\n      max=\"{exercises.length - 1}\"\n      value=\"{selectedExercisesCount}\"\n      isDisabled=\"{!selectedExercisesCount}\"\n      on:change=\"{(e) => {\n        const selectedExercisesCount = e.detail\n        applyRandomSelectionOfExercises(selectedExercisesCount)\n      }}\"\n    />\n    <span\n      class=\"ml-2 my-auto\n        text-coopmaths-corpus dark:text-coopmathsdark-corpus\n        {selectedExercisesCount\n        ? 'text-opacity-100 dark:text-opacity-100'\n        : 'text-opacity-10 dark:text-opacity-10'}\"\n    >\n      parmi {exercises.length}\n    </span>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { isIntegerInRange0to3 } from '../../../../../lib/types/integerInRange'\n  import CheckboxWithLabel from '../../../../shared/forms/CheckboxWithLabel.svelte'\n  import FormRadio from '../../../../shared/forms/FormRadio.svelte'\n\n  export let transitionSounds: {\n    0: HTMLAudioElement\n    1: HTMLAudioElement\n    2: HTMLAudioElement\n    3: HTMLAudioElement\n  }\n  export let screenBetweenSlides: boolean\n  export let sound: 0 | 1 | 2 | 3 | 4\n  export let updateFlow: (flow: 0 | 1 | 2) => void\n  export let updateScreenBetweenSlides: (screenBetweenSlides: boolean) => void\n  export let updateTune: (tune: -1 | 0 | 1 | 2 | 3) => void\n  export let updatePauseAfterEachQuestion: (\n    pauseAfterEachQuestion: boolean,\n  ) => void\n  export let questionThenCorrectionToggle: boolean\n  export let questionWithCorrectionToggle: boolean\n  export let pauseAfterEachQuestion: boolean\n\n  const labelsForSounds = [\n    { label: 'Son 1', value: 0 },\n    { label: 'Son 2', value: 1 },\n    { label: 'Son 3', value: 2 },\n    { label: 'Son 4', value: 3 },\n  ]\n\n  let soundToggle = sound > 0\n  $: soundToggle = sound > 0\n\n  const tuneCandidate = Math.max(sound - 1, 0)\n  let tune: 0 | 1 | 2 | 3 = isIntegerInRange0to3(tuneCandidate)\n    ? tuneCandidate\n    : 0\n</script>\n\n<div class=\"pb-8\">\n  <div\n    class=\"flex text-lg font-bold mb-1\n    text-coopmaths-struct dark:text-coopmathsdark-struct\"\n  >\n    Transitions\n  </div>\n  <CheckboxWithLabel\n    id=\"slideshow-transition-alternate-checkbox\"\n    isChecked=\"{questionThenCorrectionToggle}\"\n    label=\"Alterner questions et corrections\"\n    on:change=\"{(e) => {\n      const isChecked = e.detail\n      updateFlow(isChecked ? 1 : 0)\n    }}\"\n  />\n  <div class=\"ml-3\">\n    <CheckboxWithLabel\n      id=\"slideshow-transition-with-question-checkbox\"\n      isChecked=\"{questionWithCorrectionToggle}\"\n      isDisabled=\"{!questionThenCorrectionToggle}\"\n      label=\"En gardant les questions affiches\"\n      on:change=\"{(e) => {\n        const isChecked = e.detail\n        updateFlow(isChecked ? 2 : 1)\n      }}\"\n    />\n  </div>\n  <CheckboxWithLabel\n    id=\"slideshow-transition-screen-between-checkbox\"\n    isChecked=\"{screenBetweenSlides}\"\n    label=\"Avec des cartons entre les questions\"\n    on:change=\"{(e) => {\n      const isChecked = e.detail\n      updateScreenBetweenSlides(isChecked)\n    }}\"\n  />\n  <CheckboxWithLabel\n    id=\"slideshow-transition-sound-checkbox\"\n    isChecked=\"{soundToggle}\"\n    label=\"Jouer un son entre les questions\"\n    on:change=\"{(e) => {\n      const isChecked = e.detail\n      if (isChecked) {\n        transitionSounds[tune].play()\n        updateTune(tune)\n      } else {\n        updateTune(-1)\n      }\n    }}\"\n  />\n  <FormRadio\n    title=\"son\"\n    isDisabled=\"{!soundToggle}\"\n    bind:valueSelected=\"{tune}\"\n    labelsValues=\"{labelsForSounds}\"\n    orientation=\"row\"\n    on:newvalue=\"{() => {\n      transitionSounds[tune].play()\n      updateTune(tune)\n    }}\"\n  />\n  <CheckboxWithLabel\n    id=\"slideshow-pause-after-each-question-checkbox\"\n    isChecked=\"{pauseAfterEachQuestion}\"\n    label=\"Avec une pause aprs chaque question\"\n    on:change=\"{(e) => {\n      const isChecked = e.detail\n      updatePauseAfterEachQuestion(isChecked)\n    }}\"\n  />\n</div>\n","<script lang=\"ts\">\n  import type Exercice from '../../../../exercices/Exercice'\n  import { type NumberRange } from '../../../../lib/types'\n  import DisplaySettings from './presentationalComponents/DisplaySettings.svelte'\n  import ExercisesSettings from './presentationalComponents/ExercisesSettings.svelte'\n  import GlobalDurationSettings from './presentationalComponents/GlobalDurationSettings.svelte'\n  import LinksSettings from './presentationalComponents/LinksSettings.svelte'\n  import ViewSettings from './presentationalComponents/ViewSettings.svelte'\n  import OrderSettings from './presentationalComponents/OrderSettings.svelte'\n  import SelectedExercisesSettings from './presentationalComponents/SelectedExercisesSettings.svelte'\n  import TransitionSettings from './presentationalComponents/TransitionSettings.svelte'\n  import NavBar from '../../../shared/header/NavBar.svelte'\n  import { mathaleaRenderDiv } from '../../../../lib/mathalea'\n  import { globalOptions } from '../../../../lib/stores/generalStore'\n  import { referentielLocale } from '../../../../lib/stores/languagesStore'\n  import { isIntegerInRange0to4 } from '../../../../lib/types/integerInRange'\n  import { listOfRandomIndexes } from '../../../../lib/outils/arrayOutils'\n\n  export let exercises: Exercice[]\n  export let updateExercises: (updateSlidesContent?: boolean) => void\n  export let transitionSounds: {\n    0: HTMLAudioElement\n    1: HTMLAudioElement\n    2: HTMLAudioElement\n    3: HTMLAudioElement\n  }\n  export let startSlideshow: () => void\n  export let goToOverview: () => void\n  export let goToHome: () => void\n\n  let divTableDurationsQuestions: HTMLDivElement\n  let previousNumberOfSelectedExercises: number\n\n  $: if (divTableDurationsQuestions) {\n    mathaleaRenderDiv(divTableDurationsQuestions)\n  }\n\n  function applyRandomSelectionOfExercises(numberOfSelectedExercises: number) {\n    let selection: number[] | undefined\n    if (\n      numberOfSelectedExercises > 0 &&\n      numberOfSelectedExercises < exercises.length\n    ) {\n      selection = [\n        ...listOfRandomIndexes(exercises.length, numberOfSelectedExercises),\n      ].sort((a, b) => a - b)\n    }\n    previousNumberOfSelectedExercises = numberOfSelectedExercises\n    updateSelect(selection)\n  }\n\n  function updateNbOfViews(nbVues: NumberRange<1, 4>) {\n    $globalOptions.nbVues = nbVues\n  }\n\n  function updateFlow(flow: 0 | 1 | 2) {\n    $globalOptions.flow = flow\n  }\n\n  function updateScreenBetweenSlides(screenBetweenSlides: boolean) {\n    $globalOptions.screenBetweenSlides = screenBetweenSlides\n  }\n\n  function updatePauseAfterEachQuestion(pauseAfterEachQuestion: boolean) {\n    $globalOptions.pauseAfterEachQuestion = pauseAfterEachQuestion\n  }\n\n  function updateTune(tune: -1 | 0 | 1 | 2 | 3) {\n    const soundCandidate = tune + 1\n    if (isIntegerInRange0to4(soundCandidate)) {\n      $globalOptions.sound = soundCandidate\n    }\n  }\n\n  function updateQuestionsOrder(isQuestionsOrdered: boolean) {\n    $globalOptions.shuffle = !isQuestionsOrdered\n    updateExercises()\n  }\n\n  function updateSelect(selectedExercisesIndexes: number[] | undefined) {\n    $globalOptions.select = selectedExercisesIndexes\n    updateExercises()\n  }\n\n  function updateManualMode(isManualModeActive: boolean) {\n    $globalOptions.manualMode = isManualModeActive\n  }\n\n  function updateDurationGlobal(durationGlobal: number | undefined) {\n    $globalOptions.durationGlobal = durationGlobal\n  }\n\n  function updateIsImagesOnSides(isImagesOnSides: boolean) {\n    $globalOptions.isImagesOnSides = isImagesOnSides\n  }\n\n  function remove(exerciseIndex: number) {\n    exercises.splice(exerciseIndex, 1)\n    if (exercises.length === 0) {\n      goToHome()\n    }\n    applyRandomSelectionOfExercises(previousNumberOfSelectedExercises)\n    updateExercises()\n    exercises = exercises // to refresh ExercisesSettings component\n  }\n</script>\n\n<div\n  id=\"start\"\n  class=\"flex flex-col h-screen scrollbar-hide\n    bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\n    text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n>\n  <NavBar\n    subtitle=\"Rglages du diaporama\"\n    subtitleType=\"export\"\n    handleLanguage=\"{() => {}}\"\n    locale=\"{$referentielLocale}\"\n  />\n  <div\n    class=\"flex justify-end items-start mt-10\n    flex-col md:flex-row\"\n  >\n    <!-- Left Side -->\n    <div class=\"flex flex-col justify-start ml-4\">\n      <DisplaySettings {goToOverview} />\n      <ViewSettings\n        nbOfViews=\"{$globalOptions.nbVues ?? 1}\"\n        {updateNbOfViews}\n        isImagesOnSides=\"{!!$globalOptions.isImagesOnSides}\"\n        {updateIsImagesOnSides}\n      />\n      <TransitionSettings\n        {transitionSounds}\n        screenBetweenSlides=\"{!!$globalOptions.screenBetweenSlides}\"\n        sound=\"{$globalOptions.sound ?? 0}\"\n        {updateFlow}\n        {updateScreenBetweenSlides}\n        {updateTune}\n        {updatePauseAfterEachQuestion}\n        questionThenCorrectionToggle=\"{$globalOptions.flow === 1 ||\n          $globalOptions.flow === 2}\"\n        questionWithCorrectionToggle=\"{$globalOptions.flow === 2}\"\n        pauseAfterEachQuestion=\"{!!$globalOptions.pauseAfterEachQuestion}\"\n      />\n      <OrderSettings\n        isQuestionsOrdered=\"{!$globalOptions.shuffle}\"\n        {updateQuestionsOrder}\n      />\n      <SelectedExercisesSettings\n        {exercises}\n        selectedExercisesIndexes=\"{$globalOptions.select ?? []}\"\n        {applyRandomSelectionOfExercises}\n      />\n      <LinksSettings />\n    </div>\n    <!-- Right Side -->\n    <div\n      class=\"flex flex-col justify-start\n      md:w-4/6\n      mr-0 md:mr-4\"\n    >\n      <GlobalDurationSettings\n        {exercises}\n        isManualModeActive=\"{!!$globalOptions.manualMode}\"\n        {updateManualMode}\n        durationGlobal=\"{$globalOptions.durationGlobal}\"\n        {updateDurationGlobal}\n      />\n      <div\n        class=\"flex flex-col align-middle min-w-full h-[100vh] px-4\"\n        bind:this=\"{divTableDurationsQuestions}\"\n      >\n        <ExercisesSettings\n          {exercises}\n          isManualModeActive=\"{!!$globalOptions.manualMode}\"\n          {updateExercises}\n          durationGlobal=\"{$globalOptions.durationGlobal}\"\n          selectedExercisesIndexes=\"{$globalOptions.select ?? []}\"\n          {remove}\n        />\n        <div class=\"flex flex-row items-center justify-end w-full my-4\">\n          <button\n            type=\"button\"\n            id=\"diaporama-play-button\"\n            class=\"animate-pulse inline-flex items-center justify-center shadow-2xl rounded-lg p-4 pr-2\n              font-extrabold text-3xl\n              bg-coopmaths-action dark:bg-coopmathsdark-action\n              hover:bg-coopmaths-action-lightest dark:hover:bg-coopmathsdark-action-lightest\n              text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n            on:click=\"{startSlideshow}\"\n            on:keydown=\"{startSlideshow}\"\n          >\n            Play<i class=\"bx bx-play\"></i>\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import seedrandom from 'seedrandom'\n  import { onDestroy, onMount } from 'svelte'\n  import { get } from 'svelte/store'\n  import { notify } from '../../../bugsnag'\n  import type Exercice from '../../../exercices/Exercice'\n  import {\n    getExercisesFromExercicesParams,\n    mathaleaFormatExercice,\n    mathaleaGenerateSeed,\n    mathaleaHandleExerciceSimple,\n    mathaleaHandleSup,\n    mathaleaUpdateExercicesParamsFromUrl,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../lib/mathalea'\n  import { shuffle } from '../../../lib/outils/arrayOutils'\n  import {\n    darkMode,\n    exercicesParams,\n    globalOptions,\n    previousView,\n  } from '../../../lib/stores/generalStore'\n  import type { InterfaceParams } from '../../../lib/types'\n  import type { CanState } from '../../../lib/types/can'\n  import { isIntegerInRange0to3 } from '../../../lib/types/integerInRange'\n  import { context } from '../../../modules/context.js'\n  import CountDown from '../../display/can/presentationalComponents/CountDown.svelte'\n  import KickOff from '../../display/can/presentationalComponents/KickOff.svelte'\n  import ButtonText from '../../shared/forms/ButtonText.svelte'\n  import SlideshowOverview from './slideshowOverview/SlideshowOverview.svelte'\n  import SlideshowPlay from './slideshowPlay/SlideshowPlay.svelte'\n  import SlideshowSettings from './slideshowSettings/SlideshowSettings.svelte'\n  import type { Slide, Slideshow } from './types'\n\n  const transitionSounds = {\n    0: new Audio('assets/sounds/transition_sound_01.mp3'),\n    1: new Audio('assets/sounds/transition_sound_02.mp3'),\n    2: new Audio('assets/sounds/transition_sound_03.mp3'),\n    3: new Audio('assets/sounds/transition_sound_04.mp3'),\n  }\n\n  let state: CanState = 'end'\n  let exercises: Exercice[] = []\n  let slideshow: Slideshow = {\n    slides: [],\n    currentQuestion: -1,\n    selectedQuestionsNumber: 0,\n  }\n\n  $: if ($globalOptions.v === 'overview' && exercises.length > 0)\n    updateExercises(true)\n  $: if (state === 'race') startSlideshow()\n\n  onMount(async () => {\n    if ($previousView === undefined) state = 'start'\n    context.vue = 'diap'\n    document.addEventListener('updateAsyncEx', forceUpdate)\n    exercises = await getExercisesFromExercicesParams()\n    updateExercises(false, true)\n  })\n\n  onDestroy(() => {\n    document.removeEventListener('updateAsyncEx', forceUpdate)\n  })\n\n  async function forceUpdate() {\n    updateExercises(true)\n  }\n\n  async function updateExercises(\n    updateSlidesContent = false,\n    updateParamsFromUrl = false,\n  ) {\n    if (updateSlidesContent) setSlidesContent(exercises)\n    if ($globalOptions.v !== 'overview') adjustQuestionsOrder()\n    updateParamsFromUrl\n      ? mathaleaUpdateExercicesParamsFromUrl()\n      : updateExerciseParams(exercises)\n    mathaleaUpdateUrlFromExercicesParams($exercicesParams)\n  }\n\n  function setSlidesContent(newExercises: Exercice[]) {\n    const slides = []\n    const nbOfVues = $globalOptions.nbVues || 1\n    let selectedQuestionsNumber = 0\n    for (const [k, exercise] of [...newExercises].entries()) {\n      reroll(exercise)\n      const isSelected = $globalOptions.select?.includes(k) ?? true\n      if (isSelected) selectedQuestionsNumber += exercise.listeQuestions.length\n      for (let i = 0; i < exercise.listeQuestions.length; i++) {\n        const slide: Slide = {\n          exercise,\n          isSelected,\n          vues: [],\n        }\n        for (let idVue = 0; idVue < nbOfVues; idVue++) {\n          if (isIntegerInRange0to3(idVue)) {\n            reroll(exercise, idVue)\n          } else {\n            notify(`idVue ${idVue} is not an integer in range 0 to 3`, {})\n          }\n          const consigne = mathaleaFormatExercice(\n            exercise.consigne + exercise.introduction\n              ? '\\n' + exercise.consigne + exercise.introduction\n              : '',\n          )\n          const question = mathaleaFormatExercice(exercise.listeQuestions[i])\n          const correction = mathaleaFormatExercice(\n            exercise.listeCorrections[i],\n          )\n          const { svgs: questionSvgs, text: questionText } =\n            splitSvgFromText(question)\n          const { svgs: consigneSvgs, text: consigneText } =\n            splitSvgFromText(consigne)\n          const { svgs: correctionSvgs, text: correctionText } =\n            splitSvgFromText(correction)\n          slide.vues.push({\n            consigne,\n            question,\n            correction,\n            consigneSvgs,\n            consigneText,\n            questionSvgs,\n            questionText,\n            correctionSvgs,\n            correctionText,\n          })\n        }\n        slides.push(slide)\n      }\n    }\n    slideshow = {\n      slides,\n      currentQuestion: -1,\n      selectedQuestionsNumber: selectedQuestionsNumber || slides.length,\n    }\n  }\n\n  function reroll(exercise: Exercice, idVue?: 0 | 1 | 2 | 3) {\n    if (exercise.seed === undefined) exercise.seed = mathaleaGenerateSeed()\n    const originalSeed = exercise.seed\n    if (idVue !== undefined && idVue > 0)\n      exercise.seed = exercise.seed + String(idVue)\n    if (exercise.typeExercice === 'simple') {\n      mathaleaHandleExerciceSimple(exercise, false)\n    } else {\n      seedrandom(exercise.seed, { global: true })\n      exercise.nouvelleVersionWrapper?.()\n    }\n    exercise.seed = originalSeed\n  }\n\n  function splitSvgFromText(sourceText: string) {\n    const parser = new DOMParser()\n    const doc = parser.parseFromString(sourceText, 'text/html')\n    const mathalea2dContainers = doc.querySelectorAll('div.svgContainer')\n    const scratchContainers = doc.querySelectorAll('pre.blocks')\n    const svgContainers = [...mathalea2dContainers, ...scratchContainers]\n    const svgs = Array.from(svgContainers).map(\n      (container) => container.outerHTML,\n    )\n    const text = removeSvgContainers(doc.body.innerHTML, svgs)\n    return {\n      svgs,\n      text,\n    }\n  }\n\n  function removeSvgContainers(wholeQuestion: string, svgContainers: string[]) {\n    let questionWithoutSvgContainers = wholeQuestion\n    svgContainers.forEach((svgContainer) => {\n      questionWithoutSvgContainers = questionWithoutSvgContainers.replace(\n        svgContainer,\n        '',\n      )\n    })\n    return questionWithoutSvgContainers\n  }\n\n  function adjustQuestionsOrder() {\n    const areSomeExercisesSelected =\n      $globalOptions.select && $globalOptions.select.length > 0\n    const selectedIndexes = areSomeExercisesSelected\n      ? getSelectedQuestionsIndexes()\n      : [...Array(slideshow.slides.length).keys()]\n    let order = undefined\n    if ($globalOptions.order && $globalOptions.order.length > 0) {\n      order = $globalOptions.order.slice(0, selectedIndexes.length)\n    }\n    if (\n      ($globalOptions.select && $globalOptions.select.length > 0) ||\n      ($globalOptions.order &&\n        $globalOptions.order.length < selectedIndexes.length)\n    ) {\n      order = selectedIndexes\n    }\n    if ($globalOptions.shuffle) {\n      if (\n        !$globalOptions.order ||\n        $globalOptions.order.length === 0 ||\n        isSameArray($globalOptions.order, selectedIndexes)\n      ) {\n        order = shuffle(selectedIndexes)\n      } else {\n        if ($globalOptions.order.length >= selectedIndexes.length) {\n          order = $globalOptions.order.slice(0, selectedIndexes.length)\n        } else {\n          order = shuffle(selectedIndexes)\n        }\n      }\n    }\n    $globalOptions.order = order\n  }\n\n  function isSameArray(a: number[], b: number[]) {\n    if (a.length !== b.length) return false\n    for (let i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false\n    }\n    return true\n  }\n\n  function getSelectedQuestionsIndexes() {\n    const indexes = []\n    for (const [i, slide] of [...slideshow.slides].entries()) {\n      if (slide.isSelected) {\n        indexes.push(i)\n      }\n    }\n    return indexes\n  }\n\n  function updateExerciseParams(newExercises: Exercice[]) {\n    if (newExercises.length === get(exercicesParams).length) {\n      // Update si ncessaire\n      exercicesParams.update((params: InterfaceParams[]) => {\n        params.forEach((param, i) => {\n          if (\n            param.alea &&\n            param.alea !== newExercises[i].seed?.substring(0, 4)\n          )\n            param.alea = newExercises[i].seed?.substring(0, 4)\n        })\n        return params\n      })\n    } else {\n      // MGU : on remet tout mais j'aime PAS , ancien code, ne devrait pas tre utilis\n      const newParams: InterfaceParams[] = []\n      for (const exercice of newExercises) {\n        newParams.push({\n          cd: exercice.correctionDetaillee ? '1' : '0',\n          uuid: exercice.uuid,\n          id: exercice.id,\n          alea: exercice.seed?.substring(0, 4),\n          nbQuestions: exercice.nbQuestions,\n          duration: exercice.duration,\n          sup: mathaleaHandleSup(exercice.sup),\n          sup2: mathaleaHandleSup(exercice.sup2),\n          sup3: mathaleaHandleSup(exercice.sup3),\n          sup4: mathaleaHandleSup(exercice.sup4),\n          sup5: mathaleaHandleSup(exercice.sup5),\n        })\n      }\n      exercicesParams.set(newParams)\n    }\n  }\n\n  function startSlideshow() {\n    updateExercises(true)\n    $globalOptions.v = 'diaporama'\n    slideshow.currentQuestion = 0\n  }\n\n  function backToSettings() {\n    $globalOptions.v = 'diaporama'\n    slideshow.currentQuestion = -1\n  }\n\n  function goToHome() {\n    $globalOptions.v = ''\n  }\n\n  function goToOverview() {\n    $globalOptions.v = 'overview'\n  }\n</script>\n\n<div id=\"diaporama\" class=\"h-screen {$darkMode.isActive ? 'dark' : ''}\">\n  {#if $globalOptions.v === 'overview' && slideshow.slides.length > 0}\n    <SlideshowOverview\n      {exercises}\n      {slideshow}\n      {updateExercises}\n      {backToSettings}\n    />\n  {:else}\n    {#if slideshow.currentQuestion === -1}\n      {#if state === 'start'}\n        <KickOff title=\"Diaporama\" subTitle=\"\" bind:state>\n          <ButtonText\n            class=\"mt-8 py-3 px-6 text-3xl rounded-xl font-bold border-2\n              border-coopmaths-struct-light dark:border-coopmathsdark-struct-light\n              text-coopmaths-canvas dark:text-coopmathsdark-canvas\n              bg-coopmaths-struct dark:bg-coopmathsdark-struct\n              hover:bg-coopmaths-struct-light dark:hover:bg-coopmathsdark-struct-lightest\"\n            text=\"Paramtres\"\n            on:click=\"{() => {\n              state = 'end'\n            }}\"\n          />\n        </KickOff>\n      {:else if state === 'countdown'}\n        <CountDown bind:state />\n      {:else}\n        <SlideshowSettings\n          {exercises}\n          {updateExercises}\n          {transitionSounds}\n          {startSlideshow}\n          {goToOverview}\n          {goToHome}\n        />\n      {/if}\n    {/if}\n    {#if slideshow.currentQuestion > -1}\n      <SlideshowPlay\n        {slideshow}\n        {transitionSounds}\n        {backToSettings}\n        {goToOverview}\n      />\n    {/if}\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { onMount, afterUpdate } from 'svelte'\n  import type TypeExercice from '../../../exercices/Exercice'\n  import {\n    mathaleaGetExercicesFromParams,\n    mathaleaUpdateExercicesParamsFromUrl,\n    mathaleaRenderDiv,\n    mathaleaFormatExercice,\n  } from '../../../lib/mathalea'\n  import { darkMode, exercicesParams } from '../../../lib/stores/generalStore'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import Footer from '../../Footer.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import katex from 'katex'\n  import 'katex/dist/katex.min.css'\n\n  let exercices: TypeExercice[] = []\n  let chargement = true\n  let sectionElement: HTMLElement\n\n  // Structure pour stocker les comptences et points par exercice/question\n  type QuestionEval = {\n    questionIndex: number\n    competences: string[]\n    points: number\n    enonce: string  // nonc de la question (HTML format)\n    correction?: string  // Correction de la question (HTML format)\n  }\n\n  type ExerciceEval = {\n    exerciceIndex: number\n    titre: string\n    uuid: string\n    competencesExercice: string[] // Comptences au niveau de l'exercice\n    detailParQuestion: boolean // true = comptences par question\n    questions: QuestionEval[]\n    totalPoints: number\n    exerciceComplet?: boolean // true si l'exercice est affich en un seul bloc\n  }\n\n  let evaluationData: ExerciceEval[] = []\n  let competencesDisponibles: string[] = [\n    'Chercher',\n    'Modliser',\n    'Reprsenter',\n    'Raisonner',\n    'Calculer',\n    'Communiquer',\n  ]\n\n  // Configuration de l'valuation\n  type ModeEvaluation = 'notes' | 'competences' | 'mixte'\n  let modeEvaluation: ModeEvaluation = 'mixte'\n  let seuilTBM = 90  // Trs Bonne Matrise :  90%\n  let seuilMS = 70   // Matrise Satisfaisante :  70%\n  let seuilMF = 30   // Matrise Fragile :  30%\n  // MI (Matrise Insuffisante) : < 30%\n  // Le total sera calcul automatiquement  partir des points des questions\n\n  // Fonction pour calculer le total automatiquement\n  $: totalCalcul = evaluationData.reduce((total, exercice) => {\n    return total + exercice.questions.reduce((pointsExercice, question) => {\n      return pointsExercice + (question.points || 0)\n    }, 0)\n  }, 0)\n\n  // Convertir le LaTeX simple en HTML (le LaTeX complexe a dj t nettoy)\n  function latexToHtml(latex: string, exerciceUuid?: string): string {\n    let html = latex\n    \n    // Commandes LaTeX simples  HTML\n    html = html.replace(/\\\\textbf\\{([^}]*)\\}/g, '<strong>$1</strong>')\n    html = html.replace(/\\\\textit\\{([^}]*)\\}/g, '<em>$1</em>')\n    html = html.replace(/\\\\emph\\{([^}]*)\\}/g, '<em>$1</em>')\n    html = html.replace(/\\\\og\\{\\}/g, '')\n    html = html.replace(/\\\\fg\\{\\}/g, '')\n    html = html.replace(/\\\\medskip/gi, '<br>')\n    html = html.replace(/\\\\bigskip/gi, '<br><br>')\n    html = html.replace(/\\\\smallskip/gi, '<br>')\n    html = html.replace(/\\\\no\\s+/g, 'n')\n    html = html.replace(/\\\\np\\{([^}]*)\\}/g, '$1')\n    html = html.replace(/\\\\text\\{([^}]*)\\}/g, '$1')\n    html = html.replace(/\\\\hfill/g, ' ')\n    html = html.replace(/\\\\degres/g, '')\n    html = html.replace(/\\\\,/g, ' ')  // Espace fine\n    html = html.replace(/~/g, ' ')    // Espace inscable\n    html = html.replace(/\\\\\\s+/g, ' ') // Backslash + espace\n    html = html.replace(/\\\\%/g, '%')   // Pourcentage chapp\n    \n    // Nettoyer\n    html = html.replace(/\\n\\s*\\n/g, '<br>')\n    html = html.trim()\n    \n    return html\n  }\n\n  function parseLatexQuestions(latexContent: string, latexCorrection: string, exerciceUuid?: string): { enonces: string[], corrections: string[] } | null {\n    // Vrifier si le contenu est du HTML (erreur 404)\n    if (latexContent.trim().toLowerCase().startsWith('<!doctype') || latexContent.trim().toLowerCase().startsWith('<html')) {\n      console.warn(' Fichier LaTeX non disponible (erreur 404)')\n      return null\n    }\n    \n    if (latexCorrection.trim().toLowerCase().startsWith('<!doctype') || latexCorrection.trim().toLowerCase().startsWith('<html')) {\n      console.warn(' Fichier LaTeX de correction non disponible (erreur 404)')\n      return null\n    }\n    \n    const enonces: string[] = []\n    const corrections: string[] = []\n    \n    // Fonction helper pour extraire UNIQUEMENT le texte simple des items\n    function extractItems(content: string, isEnonce: boolean): string[] {\n      const items: string[] = []\n      \n      // Trouver le bloc enumerate\n      const enumerateMatch = content.match(/\\\\begin\\{enumerate\\}(?:\\[[^\\]]*\\])?([\\s\\S]*?)\\\\end\\{enumerate\\}/i)\n      if (!enumerateMatch) {\n        // Pas de enumerate, afficher un lien vers l'exercice complet\n        if (exerciceUuid) {\n          const mathaleaUrl = `https://coopmaths.fr/alea/?uuid=${exerciceUuid}`\n          return [`<div class=\"my-3 p-4 bg-gradient-to-r from-blue-50 to-purple-50 border-2 border-blue-300 rounded-lg shadow-sm\">\n            <div class=\"flex items-start gap-3\">\n              <div class=\"text-3xl\"></div>\n              <div class=\"flex-1\">\n                <p class=\"font-semibold text-gray-800 mb-2\">${isEnonce ? 'nonc' : 'Correction'} complet</p>\n                <p class=\"text-sm text-gray-600 mb-3\">Exercice avec lments graphiques complexes.</p>\n                <a href=\"${mathaleaUrl}\" target=\"_blank\" rel=\"noopener\" \n                   class=\"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors shadow-sm\">\n                  <span> Voir sur MathALA </span>\n                </a>\n              </div>\n            </div>\n          </div>`]\n        }\n        return ['Exercice non structur (voir nonc original)']\n      }\n      \n      const enumerateContent = enumerateMatch[1]\n      \n      // Dcouper par \\item\n      const parts = enumerateContent.split(/\\\\item[\\s\\n\\r\\t]*/)\n      \n      // Ignorer le premier lment (avant le premier \\item)\n      for (let i = 1; i < parts.length; i++) {\n        let itemContent = parts[i].trim()\n        if (itemContent) {\n          // SOLUTION RADICALE : Nettoyer TOUT le LaTeX complexe avant conversion\n          itemContent = cleanComplexLatex(itemContent, exerciceUuid)\n          items.push(latexToHtml(itemContent, exerciceUuid))\n        }\n      }\n      \n      return items\n    }\n    \n    // Extraire les noncs\n    const enonceItems = extractItems(latexContent, true)\n    \n    // Extraire les corrections\n    const correctionItems = extractItems(latexCorrection, false)\n    \n    console.log(` DNB Parser: ${enonceItems.length} question(s) dtecte(s)`)\n    \n    // Retourner les rsultats\n    return {\n      enonces: enonceItems,\n      corrections: correctionItems\n    }\n  }\n  \n  // Fonction pour nettoyer le LaTeX complexe AVANT le parsing\n  function cleanComplexLatex(latex: string, exerciceUuid?: string): string {\n    let cleaned = latex\n    \n    // Badge HTML simple pour lments complexes (pas de lien, juste indication)\n    const badge = (emoji: string, label: string) => \n      `<span class=\"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 border border-blue-300 rounded text-xs text-blue-700 font-medium\">\n        <span>${emoji}</span>\n        <span>${label}</span>\n      </span>`\n    \n    // Supprimer TOUS les environnements complexes et les remplacer par des badges\n    cleaned = cleaned.replace(/\\\\begin\\{center\\}[\\s\\S]*?\\\\end\\{center\\}/gi, '')\n    cleaned = cleaned.replace(/\\\\begin\\{pspicture\\}[\\s\\S]*?\\\\end\\{pspicture\\}/gi, badge('', 'Figure'))\n    cleaned = cleaned.replace(/\\\\begin\\{tabular[x]?\\}[\\s\\S]*?\\\\end\\{tabular[x]?\\}/gi, badge('', 'Tableau'))\n    cleaned = cleaned.replace(/\\\\pstree[\\s\\S]*?(?=\\\\item|\\\\end|$)/gi, badge('', 'Arbre'))\n    cleaned = cleaned.replace(/\\\\psset\\{[^}]*\\}/gi, '')\n    cleaned = cleaned.replace(/\\\\ps[a-z]+(\\[[^\\]]*\\])?(\\([^\\)]*\\))?(\\{[^}]*\\})?/gi, '')\n    cleaned = cleaned.replace(/\\\\parbox[\\s\\S]*?\\{[\\s\\S]*?\\}/gi, '')\n    cleaned = cleaned.replace(/\\\\rput[\\s\\S]*?\\{[^}]*\\}/gi, '')\n    cleaned = cleaned.replace(/\\\\uput[\\s\\S]*?\\{[^}]*\\}/gi, '')\n    \n    // Supprimer les commentaires LaTeX\n    cleaned = cleaned.replace(/%[^\\n]*/g, '')\n    \n    // Nettoyer les espaces LaTeX spciaux\n    cleaned = cleaned.replace(/\\\\,/g, ' ')\n    cleaned = cleaned.replace(/~+/g, ' ')\n    cleaned = cleaned.replace(/\\\\\\s+/g, ' ')\n    \n    return cleaned\n  }\n\n  // Fonction pour obtenir l'icne d'une comptence\n  function getCompetenceIcon(competenceName: string): string {\n    const name = competenceName.toLowerCase()\n    \n    // Comptences mathmatiques courantes avec leurs icnes\n    if (name.includes('calcul') || name.includes('calculer')) {\n      return ''\n    }\n    if (name.includes('reprsenter') || name.includes('reprsentation')) {\n      return ''\n    }\n    if (name.includes('raisonner') || name.includes('raisonnement')) {\n      return ''\n    }\n    if (name.includes('chercher') || name.includes('recherche')) {\n      return ''\n    }\n    if (name.includes('modliser') || name.includes('modlisation')) {\n      return ''\n    }\n    if (name.includes('communiquer') || name.includes('communication')) {\n      return ''\n    }\n    if (name.includes('gomtrie') || name.includes('espace') || name.includes('figure')) {\n      return ''\n    }\n    if (name.includes('algbre') || name.includes('quation')) {\n      return ''\n    }\n    if (name.includes('statistique') || name.includes('donnes')) {\n      return ''\n    }\n    if (name.includes('fonction') || name.includes('graphique')) {\n      return ''\n    }\n    if (name.includes('mesure') || name.includes('longueur')) {\n      return ''\n    }\n    if (name.includes('rsolution') || name.includes('problme')) {\n      return ''\n    }\n    \n    // Icne par dfaut\n    return ''\n  }\n\n  async function initExercices() {\n    mathaleaUpdateExercicesParamsFromUrl()\n    exercices = await mathaleaGetExercicesFromParams($exercicesParams)\n    \n    // Gnrer les questions pour chaque exercice\n    for (const ex of exercices) {\n      if (typeof ex.nouvelleVersion === 'function') {\n        ex.nouvelleVersion()\n      }\n    }\n    \n    // Initialiser les donnes d'valuation\n    evaluationData = exercices.map((ex, i) => {\n      // Grer les exercices statiques (DNB, BAC, E3C, CRPE)\n      const estExerciceStatique = ex.typeExercice === 'statique'\n      \n      let nbQuestionsReelles = 1\n      let titre = ex.titre || `Exercice ${i + 1}`\n      let questionsParsees: { enonces: string[], corrections: string[] } | null = null\n      \n      if (estExerciceStatique) {\n        // Pour les exercices statiques, construire un titre descriptif\n        const examen = (ex as any).examen || ''\n        const mois = (ex as any).mois || ''\n        const annee = (ex as any).annee || ''\n        const lieu = (ex as any).lieu || ''\n        const numeroInitial = (ex as any).numeroInitial || ''\n        \n        titre = `${examen} ${mois} ${annee} ${lieu} Ex ${numeroInitial}`.trim()\n        \n        // Parser le LaTeX pour dtecter les sous-questions\n        if ((ex as any).content && (ex as any).contentCorr) {\n          questionsParsees = parseLatexQuestions((ex as any).content, (ex as any).contentCorr, ex.uuid)\n          \n          if (questionsParsees) {\n            nbQuestionsReelles = questionsParsees.enonces.length\n            console.log(` ${titre}: ${nbQuestionsReelles} sous-question(s) dtecte(s)`)\n          } else {\n            // Fichier LaTeX non disponible (404)\n            console.warn(` ${titre}: Fichiers LaTeX non disponibles, trait comme 1 bloc`)\n            nbQuestionsReelles = 1\n          }\n        } else {\n          // Pas de contenu LaTeX charg - Afficher lien direct vers MathALA\n          console.warn(` ${titre}: Contenu LaTeX non charg (fichiers .tex manquants)`)\n          nbQuestionsReelles = 1\n          \n          // Intgrer l'exercice complet en iframe\n          const mathaleaUrl = `/alea/?uuid=${ex.uuid}&v=eleve&es=0211001`\n          questionsParsees = {\n            enonces: [`<div class=\"my-4 border-2 border-blue-300 rounded-lg overflow-hidden bg-white shadow-lg\">\n              <div class=\"bg-gradient-to-r from-blue-500 to-blue-600 px-4 py-2 text-white font-semibold flex items-center gap-2\">\n                <span></span>\n                <span>nonc complet MathALA</span>\n              </div>\n              <iframe \n                src=\"${mathaleaUrl}\" \n                class=\"w-full border-0\" \n                style=\"height: 600px; min-height: 400px;\"\n                title=\"Exercice MathALA\"\n                sandbox=\"allow-scripts allow-same-origin\"\n              ></iframe>\n            </div>`],\n            corrections: [`<div class=\"text-sm text-gray-600 italic p-3 bg-gray-50 rounded border border-gray-200\">\n               La correction est visible dans l'nonc MathALA ci-dessus\n            </div>`]\n          }\n        }\n      } else {\n        // Pour les exercices normaux, utiliser listeQuestions\n        const aQuestionsSeparees = ex.listeQuestions && ex.listeQuestions.length > 0\n        if (aQuestionsSeparees) {\n          nbQuestionsReelles = ex.listeQuestions.length\n        } else if (ex.nbQuestions) {\n          nbQuestionsReelles = ex.nbQuestions\n        }\n      }\n      \n      return {\n        exerciceIndex: i,\n        titre: titre,\n        uuid: ex.uuid,\n        competencesExercice: [], // Comptences au niveau de l'exercice par dfaut\n        detailParQuestion: false, // Par dfaut, comptences au niveau de l'exercice\n        questions: Array.from({ length: nbQuestionsReelles }, (_, j) => {\n          let enonce = `Question ${j + 1}`\n          let correction = undefined\n          \n          if (estExerciceStatique) {\n            // Pour les exercices statiques avec parsing LaTeX\n            if (questionsParsees && questionsParsees.enonces.length > j) {\n              enonce = questionsParsees.enonces[j]\n              if (questionsParsees.corrections && questionsParsees.corrections.length > j) {\n                correction = questionsParsees.corrections[j]\n              }\n              console.log(`    Question ${j + 1}: nonc (${enonce.substring(0, 50)}...) et correction parss`)\n            } else {\n              // Fallback : exercice complet\n              enonce = `Exercice complet (voir contenu LaTeX)`\n            }\n          } else {\n            // Rcuprer l'nonc depuis listeQuestions\n            if (ex.listeQuestions && ex.listeQuestions[j]) {\n              enonce = ex.listeQuestions[j]\n            }\n            \n            // Rcuprer la correction si disponible\n            if (ex.listeCorrections && ex.listeCorrections[j]) {\n              correction = ex.listeCorrections[j]\n            } else if (j === 0 && ex.correction) {\n              correction = ex.correction\n            } else if (j === 0 && ex.contenuCorrection) {\n              correction = ex.contenuCorrection\n            }\n          }\n          \n          return {\n            questionIndex: j,\n            competences: [],\n            points: 1,\n            enonce: enonce,\n            correction: correction\n          }\n        }),\n        totalPoints: nbQuestionsReelles,\n        exerciceComplet: estExerciceStatique, // Les exercices statiques sont des blocs complets\n        typeExercice: ex.typeExercice\n      }\n    })\n    \n    console.log('valuation initialise:', evaluationData)\n    console.log(' Exercices bruts:', exercices.map(ex => ({\n      uuid: ex.uuid,\n      typeExercice: (ex as any).typeExercice,\n      hasContent: !!((ex as any).content),\n      hasContentCorr: !!((ex as any).contentCorr),\n      contentPreview: ((ex as any).content || '').substring(0, 100)\n    })))\n\n    chargement = false\n  }\n\n  afterUpdate(() => {\n    if (sectionElement && !chargement) {\n      // Attendre que le HTML soit insr avant de rendre le LaTeX\n      setTimeout(() => {\n        mathaleaRenderDiv(sectionElement)\n      }, 100)\n    }\n  })\n\n  function toggleCompetenceExercice(exIndex: number, comp: string) {\n    const exercice = evaluationData[exIndex]\n    const index = exercice.competencesExercice.indexOf(comp)\n    if (index > -1) {\n      exercice.competencesExercice.splice(index, 1)\n    } else {\n      exercice.competencesExercice.push(comp)\n    }\n    evaluationData = evaluationData // Trigger reactivity\n  }\n\n  function toggleCompetence(exIndex: number, qIndex: number, comp: string) {\n    const question = evaluationData[exIndex].questions[qIndex]\n    const index = question.competences.indexOf(comp)\n    if (index > -1) {\n      question.competences.splice(index, 1)\n    } else {\n      question.competences.push(comp)\n    }\n    evaluationData = evaluationData // Trigger reactivity\n  }\n\n  function toggleDetailParQuestion(exIndex: number) {\n    evaluationData[exIndex].detailParQuestion = !evaluationData[exIndex].detailParQuestion\n    evaluationData = evaluationData // Trigger reactivity\n  }\n\n  function updatePoints(exIndex: number, qIndex: number, points: number) {\n    evaluationData[exIndex].questions[qIndex].points = points\n    // Recalculer le total\n    evaluationData[exIndex].totalPoints = evaluationData[exIndex].questions.reduce(\n      (sum, q) => sum + q.points,\n      0\n    )\n    evaluationData = evaluationData // Trigger reactivity\n  }\n\n  function supprimerQuestion(exIndex: number, qIndex: number) {\n    if (confirm('tes-vous sr de vouloir supprimer cette question ?')) {\n      evaluationData[exIndex].questions.splice(qIndex, 1)\n      // Recalculer le total\n      evaluationData[exIndex].totalPoints = evaluationData[exIndex].questions.reduce(\n        (sum, q) => sum + q.points,\n        0\n      )\n      evaluationData = evaluationData // Trigger reactivity\n    }\n  }\n\n  function ouvrirCorrection() {\n    // Sauvegarder les donnes dans localStorage\n    localStorage.setItem('evaluationData', JSON.stringify(evaluationData))\n    localStorage.setItem('evaluationExercices', JSON.stringify({\n      uuids: exercices.map(ex => ex.uuid),\n      seeds: exercices.map(ex => ex.seed),\n      params: $exercicesParams\n    }))\n    localStorage.setItem('evaluationConfig', JSON.stringify({\n      modeEvaluation,\n      seuilTBM,\n      seuilMS,\n      seuilMF,\n      totalCalcul\n    }))\n    \n    // Rediriger vers la page de correction\n    window.location.href = window.location.origin + window.location.pathname + '?v=correction'\n  }\n\n  onMount(() => {\n    initExercices()\n  })\n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\"valuation\"\n    subtitleType=\"export\"\n    handleLanguage={() => {}}\n    locale={$referentielLocale}\n  />\n\n  <section bind:this={sectionElement} class=\"px-4 py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\">\n    <h1\n      class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n    >\n      Configuration de l'valuation\n    </h1>\n\n    <p\n      class=\"text-coopmaths-corpus dark:text-coopmathsdark-corpus text-lg md:text-xl mb-8\"\n    >\n      Configurez les comptences  valuer et les points pour chaque question.\n    </p>\n\n    <!-- Configuration de l'valuation -->\n    <div class=\"bg-white dark:bg-coopmathsdark-canvas-dark rounded-lg shadow-lg p-6 mb-8\">\n      <h2 class=\"text-xl font-bold text-coopmaths-struct dark:text-coopmathsdark-struct mb-4\">\n        Paramtres d'valuation\n      </h2>\n      \n      <div class=\"grid md:grid-cols-2 gap-6\">\n        <!-- Mode d'valuation -->\n        <div>\n          <label class=\"block text-sm font-medium text-coopmaths-corpus dark:text-coopmathsdark-corpus mb-2\">\n            Mode d'valuation\n          </label>\n          <select \n            bind:value={modeEvaluation}\n            class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n          >\n            <option value=\"notes\">Notes uniquement</option>\n            <option value=\"competences\">Comptences uniquement</option>\n            <option value=\"mixte\">Notes + Comptences (mixte)</option>\n          </select>\n        </div>\n\n        <!-- Total calcul automatiquement -->\n        <div>\n          <label class=\"block text-sm font-medium text-coopmaths-corpus dark:text-coopmathsdark-corpus mb-2\">\n            Total calcul\n          </label>\n          <div class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-coopmaths-corpus dark:text-coopmathsdark-corpus font-semibold\">\n            {totalCalcul} points\n          </div>\n          <p class=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n            Calcul automatiquement  partir des points des questions\n          </p>\n        </div>\n      </div>\n\n      {#if modeEvaluation !== 'notes'}\n        <!-- Seuils de matrise -->\n        <div class=\"mt-6\">\n          <h3 class=\"text-lg font-semibold text-coopmaths-struct dark:text-coopmathsdark-struct mb-3\">\n            Seuils de matrise (en pourcentage)\n          </h3>\n          <div class=\"grid md:grid-cols-3 gap-4\">\n            <div>\n              <label class=\"block text-sm font-medium mb-2\" style=\"color: #4caf50;\">\n                TBM - Trs Bonne Matrise ()\n              </label>\n              <input \n                type=\"number\"\n                bind:value={seuilTBM}\n                min=\"0\"\n                max=\"100\"\n                step=\"5\"\n                class=\"w-full px-3 py-2 border border-green-300 rounded-md bg-green-50 dark:bg-green-900/20\"\n              />\n              <span class=\"text-xs text-gray-500\">%</span>\n            </div>\n            <div>\n              <label class=\"block text-sm font-medium mb-2\" style=\"color: #2196f3;\">\n                MS - Matrise Satisfaisante ()\n              </label>\n              <input \n                type=\"number\"\n                bind:value={seuilMS}\n                min=\"0\"\n                max=\"100\"\n                step=\"5\"\n                class=\"w-full px-3 py-2 border border-blue-300 rounded-md bg-blue-50 dark:bg-blue-900/20\"\n              />\n              <span class=\"text-xs text-gray-500\">%</span>\n            </div>\n            <div>\n              <label class=\"block text-sm font-medium mb-2\" style=\"color: #ff9800;\">\n                MF - Matrise Fragile ()\n              </label>\n              <input \n                type=\"number\"\n                bind:value={seuilMF}\n                min=\"0\"\n                max=\"100\"\n                step=\"5\"\n                class=\"w-full px-3 py-2 border border-orange-300 rounded-md bg-orange-50 dark:bg-orange-900/20\"\n              />\n              <span class=\"text-xs text-gray-500\">%</span>\n            </div>\n          </div>\n          <p class=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n            MI - Matrise Insuffisante : &lt; {seuilMF}%\n          </p>\n        </div>\n      {/if}\n    </div>\n\n    {#if chargement}\n      <div class=\"text-center py-8\">\n        <p class=\"text-coopmaths-corpus dark:text-coopmathsdark-corpus\">\n          Chargement des exercices...\n        </p>\n      </div>\n    {:else if exercices.length === 0}\n      <div\n        class=\"bg-orange-100 dark:bg-orange-900 border-l-4 border-orange-500 text-orange-700 dark:text-orange-200 p-4 mb-4\"\n        role=\"alert\"\n      >\n        <p class=\"font-bold\">Aucun exercice slectionn</p>\n        <p>\n          Veuillez retourner  la page d'accueil et slectionner des exercices.\n        </p>\n      </div>\n    {:else}\n      <!-- Liste des exercices avec configuration -->\n      <div class=\"space-y-6\">\n        {#each evaluationData as exData, exIndex}\n          {@const exercice = exercices[exIndex]}\n          <div\n            class=\"bg-white dark:bg-coopmathsdark-canvas-dark rounded-lg shadow-lg p-6\"\n          >\n            <h2\n              class=\"text-xl font-bold text-coopmaths-struct dark:text-coopmathsdark-struct mb-4\"\n            >\n              {exData.titre} ({exData.totalPoints || 0} points)\n            </h2>\n\n            <!-- nonc de l'exercice -->\n            {#if exercice.introduction}\n              <div class=\"mb-4 p-3 bg-blue-50 dark:bg-blue-900 rounded-lg\">\n                <p class=\"text-sm text-blue-900 dark:text-blue-100\">\n                  {@html mathaleaFormatExercice(exercice.introduction)}\n                </p>\n              </div>\n            {/if}\n\n            <!-- Affichage des exercices statiques (DNB, BAC, E3C) -->\n            {#if exercice.typeExercice === 'statique'}\n              <div class=\"mb-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border\">\n                <h3 class=\"text-lg font-semibold mb-3 text-gray-800 dark:text-gray-200\">\n                   nonc de l'exercice\n                </h3>\n                <div class=\"text-center\">\n                  <p class=\"text-sm text-gray-600 dark:text-gray-400 mb-2\">\n                    Exercice statique - Image de l'nonc\n                  </p>\n                  <div class=\"bg-white dark:bg-gray-900 p-4 rounded border-2 border-dashed border-gray-300 dark:border-gray-600\">\n                    <p class=\"text-gray-500 dark:text-gray-400\">\n                       L'image de l'exercice sera affiche ici lors de la correction\n                    </p>\n                    <p class=\"text-xs text-gray-400 mt-2\">\n                      UUID: {exercice.uuid}\n                    </p>\n                  </div>\n                </div>\n              </div>\n            {/if}\n\n            {#if exercice.consigne}\n              <div class=\"mb-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg\">\n                <p class=\"font-semibold text-sm\">\n                  {@html mathaleaFormatExercice(exercice.consigne)}\n                </p>\n              </div>\n            {/if}\n\n            <!-- Comptences au niveau de l'exercice -->\n            {#if modeEvaluation !== 'notes'}\n              <div class=\"mb-4 p-4 bg-yellow-50 dark:bg-yellow-900 rounded-lg\">\n                <div class=\"flex justify-between items-center mb-2\">\n                  <p class=\"text-sm font-semibold\">Comptences pour tout l'exercice :</p>\n                  <button\n                    on:click={() => toggleDetailParQuestion(exIndex)}\n                    class=\"text-xs px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600\"\n                  >\n                    {exData.detailParQuestion ? ' Mode global' : ' Dtailler par question'}\n                  </button>\n                </div>\n                <div class=\"flex flex-wrap gap-2\">\n                  {#each competencesDisponibles as comp}\n                    <button\n                      on:click={() => toggleCompetenceExercice(exIndex, comp)}\n                      class=\"px-3 py-1 rounded-full text-sm font-medium transition-colors flex items-center gap-1 {exData.competencesExercice.includes(\n                        comp\n                      )\n                        ? 'bg-coopmaths-action text-white'\n                        : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}\"\n                    >\n                      <span class=\"text-base\">{getCompetenceIcon(comp)}</span>\n                      <span>{comp}</span>\n                    </button>\n                  {/each}\n                </div>\n              </div>\n            {/if}\n\n            <!-- Questions de l'exercice -->\n            <div class=\"space-y-4\">\n              {#each exData.questions as question, qIndex}\n                <div\n                  class=\"border border-coopmaths-struct-lightest dark:border-coopmathsdark-struct p-4 rounded\"\n                >\n                  <div class=\"flex justify-between items-start mb-3\">\n                    <div class=\"flex-1\">\n                      <div class=\"flex justify-between items-center mb-2\">\n                        <h3\n                          class=\"font-semibold text-coopmaths-struct dark:text-coopmathsdark-struct\"\n                        >\n                          Question {qIndex + 1}\n                        </h3>\n                        <button\n                          on:click={() => supprimerQuestion(exIndex, qIndex)}\n                          class=\"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 text-sm px-2 py-1 rounded hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors\"\n                          title=\"Supprimer cette question\"\n                        >\n                           Supprimer\n                        </button>\n                      </div>\n                      {#if exercice.listeQuestions && exercice.listeQuestions[qIndex]}\n                        <div class=\"text-sm text-coopmaths-corpus dark:text-coopmathsdark-corpus mb-2\">\n                          {@html mathaleaFormatExercice(exercice.listeQuestions[qIndex])}\n                        </div>\n                      {/if}\n                    </div>\n                    <div class=\"flex items-center gap-2 ml-4\">\n                      <label class=\"text-sm whitespace-nowrap\">Points :</label>\n                      <input\n                        type=\"number\"\n                        min=\"0\"\n                        step=\"0.5\"\n                        value={question.points}\n                        on:input={(e) =>\n                          updatePoints(exIndex, qIndex, parseFloat(e.currentTarget.value))}\n                        class=\"w-20 px-2 py-1 border rounded text-center\"\n                      />\n                    </div>\n                  </div>\n\n                  <!-- Slection des comptences par question (si activ) -->\n                  {#if modeEvaluation !== 'notes' && exData.detailParQuestion}\n                    <div class=\"mt-2\">\n                      <p class=\"text-sm mb-2\">Comptences spcifiques  cette question :</p>\n                      <div class=\"flex flex-wrap gap-2\">\n                        {#each competencesDisponibles as comp}\n                          <button\n                            on:click={() => toggleCompetence(exIndex, qIndex, comp)}\n                            class=\"px-3 py-1 rounded-full text-sm font-medium transition-colors flex items-center gap-1 {question.competences.includes(\n                              comp\n                            )\n                              ? 'bg-coopmaths-action text-white'\n                              : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}\"\n                          >\n                            <span class=\"text-base\">{getCompetenceIcon(comp)}</span>\n                            <span>{comp}</span>\n                          </button>\n                        {/each}\n                      </div>\n                    </div>\n                  {/if}\n                </div>\n              {/each}\n            </div>\n          </div>\n        {/each}\n      </div>\n\n      <!-- Bouton pour ouvrir la correction -->\n      <div class=\"mt-8 flex flex-col gap-4 items-center\">\n        <button\n          on:click={ouvrirCorrection}\n          class=\"px-8 py-4 bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600 text-white rounded-lg font-bold text-xl transition-colors shadow-lg\"\n        >\n           Commencer la correction\n        </button>\n        <p class=\"text-sm text-gray-600 dark:text-gray-400\">\n          Vous serez redirig vers l'interface de correction pour importer votre fichier CSV d'lves\n        </p>\n      </div>\n    {/if}\n  </section>\n\n  <footer>\n    <Footer />\n  </footer>\n</main>\n\n<style>\n  footer {\n    margin-top: auto;\n  }\n</style>\n\n","<script lang=\"ts\">\n  import { onMount, afterUpdate, tick } from 'svelte'\n  import { darkMode } from '../../../lib/stores/generalStore'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import { mathaleaRenderDiv } from '../../../lib/mathalea'\n  import Footer from '../../Footer.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import toast, { Toaster } from 'svelte-french-toast'\n\n  // Types pour les donnes d'valuation\n  type QuestionEval = {\n    questionIndex: number\n    competences: string[]\n    points: number\n    enonce: string  // nonc de la question (HTML format)\n    correction?: string  // Solution dtaille (HTML/LaTeX)\n    correctionDisponible?: boolean  // Flag pour savoir si correction existe\n  }\n\n  type ExerciceEval = {\n    exerciceIndex: number\n    titre: string\n    uuid: string\n    competencesExercice: string[]\n    detailParQuestion: boolean\n    questions: QuestionEval[]\n    totalPoints: number\n    seed?: string  // Seed/alea pour reproduire les mmes questions\n    sup?: string   // Paramtres supplmentaires de l'exercice\n    sup2?: string\n    sup3?: string\n    nbQuestions?: number\n  }\n\n  type Student = {\n    id: string\n    nom: string\n    prenom: string\n    sexe?: string\n  }\n\ntype StudentCorrection = {\n  commentaire?: string\n  [exerciceIndex: number]: {\n    [questionIndex: number]: {\n      status: 'TB' | 'TF' | 'NR' | 'NE' | null\n    }\n  }\n}\n\n  let evaluationData: ExerciceEval[] = []\n  let students: Student[] = []\n  let currentStudentIndex = 0\n  let currentExerciceIndex = 0\n  let corrections: { [studentId: string]: StudentCorrection } = {}\n  let csvInput: HTMLInputElement\n  let correctionSection: HTMLElement\n\n  // Page actuelle (setup, overview, correction)\n  let currentPage: 'setup' | 'overview' | 'correction' = 'setup'\n  \n  // Comptences personnalises (modifiables par le correcteur)\n  let competencesPersonnalisees: string[] = []\n  let competencesActivees: { [competence: string]: boolean } = {}\n  let showCompetenceEditor = false\n\n  // Configuration de l'valuation\n  type ModeEvaluation = 'notes' | 'competences' | 'mixte'\n  let modeEvaluation: ModeEvaluation = 'mixte'\n  let seuilTBM = 90  // Trs Bonne Matrise :  90%\n  let seuilMS = 70   // Matrise Satisfaisante :  70%\n  let seuilMF = 30   // Matrise Fragile :  30%\n  // MI (Matrise Insuffisante) : < 30%\n  let totalCalcul = 0\n\n  // Variables ractives pour l'affichage\n  let studentScoreData = { correct: 0, total: 0 }\n  let niveauMaitrise = { niveau: 'Non valu', couleur: '#bdbdbd', bgColor: '#f5f5f5', pourcentage: 0 }\n  let competences: { [competence: string]: { niveau: string, correct: number, total: number, pourcentage: number } } = {}\n  let totalQuestions = 0\n  let toutesQuestionsEvaluees = false\n  \n  // Modal de rsum\n  let showSummaryModal = false\n  let showAutoNextMessage = false\n  \n  // Commentaire global pour l'lve\n  let commentaireGlobal = ''\n  \n  // Variables pour la dicte vocale (reconnaissance vocale)\n  let isListening = false\n  let recognition: any | null = null\n  let dictatedText = ''\n  \n  // Variable ractive pour forcer la mise  jour des badges\n  let badgeUpdateTrigger = 0\n\n  // Variables ractives pour les badges d'exercices\n  $: exercicesBadges = evaluationData.map((ex, exIndex) => {\n    if (students.length === 0) return { niveau: 'NE', couleur: '#bdbdbd', bgColor: '#f5f5f5' }\n    badgeUpdateTrigger // Force la ractivit\n    return getExerciceNiveau(students[currentStudentIndex].id, exIndex)\n  })\n\n  // Variables ractives pour les badges de la vue d'ensemble\n  $: overviewBadges = students.map(student => \n    evaluationData.map((ex, exIndex) => {\n      badgeUpdateTrigger // Force la ractivit\n      return getExerciceNiveau(student.id, exIndex)\n    })\n  )\n\n  // Mode d'affichage des cartes (classique ou DNB)\n  let modeAffichageCartes: 'classique' | 'dnb' = 'classique'\n  \n  // Recherche intelligente\n  let searchQuery = ''\n  let filteredStudents: typeof students = []\n  \n  // Modale de confirmation personnalise\n  let showConfirmModal = false\n  let confirmModalData = {\n    title: '',\n    message: '',\n    onConfirm: () => {},\n    onCancel: null as (() => void) | null,\n    confirmText: 'Confirmer',\n    cancelText: 'Annuler'\n  }\n  \n  // Systme d'affichage des corrections\n  let modeCorrectionsActive = false  // Activ si l'utilisateur le souhaite\n  let showCorrections = true  // Visible par dfaut si mode actif\n  let loadingCorrections = false  // Indicateur de chargement des corrections\n\n  // Fonction pour dterminer la couleur base sur le sexe\n  function getGenreColor(sexe: string | undefined): string {\n    if (!sexe) return 'text-gray-800 dark:text-gray-200' // Gris par dfaut si pas de sexe\n    \n    const sexeLower = sexe.toLowerCase().trim()\n    \n    if (sexeLower === 'f' || sexeLower === 'femme' || sexeLower === 'fille' || sexeLower === 'fminin') {\n      return 'text-pink-600 dark:text-pink-400' // Rose pour les filles\n    } else if (sexeLower === 'm' || sexeLower === 'homme' || sexeLower === 'garon' || sexeLower === 'masculin') {\n      return 'text-blue-600 dark:text-blue-400' // Bleu pour les garons\n    } else {\n      return 'text-gray-800 dark:text-gray-200' // Gris par dfaut\n    }\n  }\n\n  // Fonction de recherche intelligente\n  function performSearch() {\n    if (!searchQuery.trim()) {\n      filteredStudents = students\n      return\n    }\n    \n    const query = searchQuery.toLowerCase().trim()\n    filteredStudents = students.filter(student => {\n      // Recherche dans le nom et prnom\n      const fullName = `${student.nom} ${student.prenom}`.toLowerCase()\n      if (fullName.includes(query)) return true\n      \n      // Recherche dans le sexe\n      if (student.sexe && student.sexe.toLowerCase().includes(query)) return true\n      \n      // Recherche par initiales (ex: \"JD\" pour \"Jean Dupont\")\n      const initials = `${student.prenom.charAt(0)}${student.nom.charAt(0)}`.toLowerCase()\n      if (initials.includes(query)) return true\n      \n      // Recherche par prnom seul\n      if (student.prenom.toLowerCase().includes(query)) return true\n      \n      // Recherche par nom seul\n      if (student.nom.toLowerCase().includes(query)) return true\n      \n      return false\n    })\n  }\n\n  // Ractivit pour la recherche\n  $: if (searchQuery !== undefined) {\n    performSearch()\n  }\n\n  // Calculer les statistiques globales de la classe\n  function calculateClassStats() {\n    if (students.length === 0) {\n      return {\n        moyenneClasse: 0,\n        totalPoints: 0,\n        pointsObtenus: 0,\n        pourcentageReussite: 0,\n        noteMin: 0,\n        noteMax: 0,\n        mediane: 0,\n        nbTermines: 0,\n        nbEnCours: 0,\n        nbNonCommences: 0,\n        nbCopiesCorrigees: 0,\n        competencesStats: {}\n      }\n    }\n\n    let totalPointsClasse = 0\n    let pointsObtenusClasse = 0\n    let nbTermines = 0\n    let nbEnCours = 0\n    let nbNonCommences = 0\n    const competencesGlobales: Record<string, { total: number, correct: number }> = {}\n    const notesCorrigees: number[] = [] // Seulement les copies corriges\n    \n    // Calculer le barme total (une seule fois, c'est le mme pour tous)\n    const baremeTotal = getTotalPoints()\n\n    students.forEach(student => {\n      const score = calculateStudentScore(student.id)\n      const totalQuestions = evaluationData.reduce((sum, ex) => sum + ex.questions.length, 0)\n      const correctedQuestions = countCorrectedQuestions(student.id)\n      \n      pointsObtenusClasse += score.correct\n\n      // Compter les statuts\n      if (correctedQuestions === totalQuestions && totalQuestions > 0) {\n        nbTermines++\n      } else if (correctedQuestions > 0) {\n        nbEnCours++\n      } else {\n        nbNonCommences++\n      }\n\n      // Stocker la note UNIQUEMENT si la copie est corrige (au moins une question)\n      if (correctedQuestions > 0 && score.total > 0) {\n        // Calculer la note (points obtenus)\n        notesCorrigees.push(score.correct)\n      }\n\n      // Agrger les comptences\n      if (modeEvaluation !== 'notes') {\n        const competencesStudent = calculateCompetences(student.id)\n        Object.entries(competencesStudent).forEach(([comp, data]) => {\n          if (!competencesGlobales[comp]) {\n            competencesGlobales[comp] = { total: 0, correct: 0 }\n          }\n          competencesGlobales[comp].total += data.total\n          competencesGlobales[comp].correct += data.correct\n        })\n      }\n    })\n\n    // Calculer UNIQUEMENT sur les copies corriges\n    const nbCopiesCorrigees = notesCorrigees.length\n    \n    // Moyenne des notes corriges\n    const moyenneClasse = nbCopiesCorrigees > 0 \n      ? notesCorrigees.reduce((sum, note) => sum + note, 0) / nbCopiesCorrigees\n      : 0\n\n    // Calculer Min, Max et Mdiane sur les notes corriges\n    const notesSorted = [...notesCorrigees].sort((a, b) => a - b)\n    const noteMin = notesSorted.length > 0 ? notesSorted[0] : 0\n    const noteMax = notesSorted.length > 0 ? notesSorted[notesSorted.length - 1] : 0\n    \n    let mediane = 0\n    if (notesSorted.length > 0) {\n      const middle = Math.floor(notesSorted.length / 2)\n      if (notesSorted.length % 2 === 0) {\n        // Nombre pair : moyenne des 2 valeurs centrales\n        mediane = (notesSorted[middle - 1] + notesSorted[middle]) / 2\n      } else {\n        // Nombre impair : valeur centrale\n        mediane = notesSorted[middle]\n      }\n    }\n    \n    // Calculer les niveaux de matrise pour chaque comptence\n    const competencesStats: Record<string, { niveau: string, couleur: string, pourcentage: number }> = {}\n    Object.entries(competencesGlobales).forEach(([comp, data]) => {\n      const pourcentage = data.total > 0 ? (data.correct / data.total * 100) : 0\n      let niveau = 'MI'\n      let couleur = '#f44336'\n      \n      if (pourcentage >= 90) {\n        niveau = 'TBM'\n        couleur = '#4caf50'\n      } else if (pourcentage >= 75) {\n        niveau = 'MS'\n        couleur = '#2196f3'\n      } else if (pourcentage >= 50) {\n        niveau = 'MF'\n        couleur = '#ff9800'\n      }\n      \n      competencesStats[comp] = { niveau, couleur, pourcentage }\n    })\n\n    return {\n      moyenneClasse,\n      totalPoints: baremeTotal, // Barme d'une copie (ex: 10 points)\n      pointsObtenus: pointsObtenusClasse,\n      pourcentageReussite: moyenneClasse,\n      noteMin,\n      noteMax,\n      mediane,\n      nbTermines,\n      nbEnCours,\n      nbNonCommences,\n      nbCopiesCorrigees,\n      competencesStats\n    }\n  }\n\n  // Compter le nombre de questions corriges pour un lve (exclut le commentaire)\n  function countCorrectedQuestions(studentId: string): number {\n    const studentCorrections = corrections[studentId]\n    if (!studentCorrections) return 0\n    \n    let count = 0\n    Object.entries(studentCorrections).forEach(([key, value]) => {\n      // Ignorer le champ 'commentaire' qui n'est pas un exercice\n      if (key !== 'commentaire' && typeof value === 'object') {\n        count += Object.keys(value).length\n      }\n    })\n    return count\n  }\n\n  // Afficher une modale de confirmation personnalise\n  function showConfirm(title: string, message: string, onConfirm: () => void, confirmText = 'Confirmer', cancelText = 'Annuler', onCancel: (() => void) | null = null) {\n    confirmModalData = { title, message, onConfirm, onCancel, confirmText, cancelText }\n    showConfirmModal = true\n  }\n\n\n  // Formater un nombre en supprimant les zros inutiles aprs la virgule\n  function formatNote(note: number): string {\n    const rounded = Math.round(note * 10) / 10\n    return rounded % 1 === 0 ? rounded.toFixed(0) : rounded.toFixed(1)\n  }\n\n  // Exporter toutes les donnes en JSON\n  function exportJSON() {\n    const exportData = {\n      evaluationData,\n      students,\n      corrections,\n      competencesPersonnalisees,\n      competencesActivees,\n      modeEvaluation,\n      dateExport: new Date().toISOString(),\n      statistiquesClasse: calculateClassStats()\n    }\n\n    const dataStr = JSON.stringify(exportData, null, 2)\n    const dataBlob = new Blob([dataStr], { type: 'application/json' })\n    const url = URL.createObjectURL(dataBlob)\n    const link = document.createElement('a')\n    link.href = url\n    link.download = `correction-evaluation-${new Date().toISOString().split('T')[0]}.json`\n    link.click()\n    URL.revokeObjectURL(url)\n  }\n\n  // Imprimer le bilan de la classe\n  function imprimerBilanClasse() {\n    const classStats = calculateClassStats()\n    const printWindow = window.open('', '_blank')\n    if (!printWindow) return\n\n    const html = `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <title>Bilan de la classe</title>\n        <style>\n          body { font-family: Arial, sans-serif; padding: 20px; }\n          h1 { color: #2563eb; border-bottom: 3px solid #2563eb; padding-bottom: 10px; }\n          .section { margin: 20px 0; }\n          .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin: 20px 0; }\n          .stat-box { border: 2px solid #e5e7eb; border-radius: 8px; padding: 15px; }\n          .stat-label { font-size: 12px; color: #6b7280; text-transform: uppercase; }\n          .stat-value { font-size: 28px; font-weight: bold; color: #1f2937; }\n          .competences { margin: 20px 0; }\n          .competence-item { display: inline-block; margin: 5px; padding: 8px 15px; border-radius: 6px; color: white; font-weight: bold; }\n          table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n          th, td { border: 1px solid #e5e7eb; padding: 10px; text-align: left; }\n          th { background: #f3f4f6; font-weight: bold; }\n          @media print { .no-print { display: none; } }\n        </style>\n      </head>\n      <body>\n        <button class=\"no-print\" onclick=\"window.print()\" style=\"padding: 10px 20px; background: #2563eb; color: white; border: none; border-radius: 5px; cursor: pointer; margin-bottom: 20px;\"> Imprimer</button>\n        \n        <h1>Bilan de la classe - ${students.length} lve(s)</h1>\n        <p><strong>Date :</strong> ${new Date().toLocaleDateString('fr-FR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</p>\n        \n        <div class=\"section\">\n          <h2>Statistiques gnrales</h2>\n          <p style=\"color: #6b7280; margin-bottom: 15px;\"><em>Calcules sur ${classStats.nbCopiesCorrigees} copie(s) corrige(s)</em></p>\n          <div class=\"stats-grid\">\n            <div class=\"stat-box\">\n              <div class=\"stat-label\">Moyenne</div>\n              <div class=\"stat-value\">${formatNote(classStats.moyenneClasse)}/${formatNote(classStats.totalPoints)}</div>\n            </div>\n            <div class=\"stat-box\">\n              <div class=\"stat-label\">Minimum</div>\n              <div class=\"stat-value\" style=\"color: #dc2626;\">${formatNote(classStats.noteMin)}</div>\n            </div>\n            <div class=\"stat-box\">\n              <div class=\"stat-label\">Mdiane</div>\n              <div class=\"stat-value\" style=\"color: #2563eb;\">${formatNote(classStats.mediane)}</div>\n            </div>\n            <div class=\"stat-box\">\n              <div class=\"stat-label\">Maximum</div>\n              <div class=\"stat-value\" style=\"color: #16a34a;\">${formatNote(classStats.noteMax)}</div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"section\">\n          <h2>Progression des corrections</h2>\n          <p> <strong>${classStats.nbTermines}</strong> copie(s) termine(s)</p>\n          <p> <strong>${classStats.nbEnCours}</strong> copie(s) en cours</p>\n          <p> <strong>${classStats.nbNonCommences}</strong> copie(s) non commence(s)</p>\n        </div>\n\n        ${modeEvaluation !== 'notes' && Object.keys(classStats.competencesStats).length > 0 ? `\n          <div class=\"section\">\n            <h2>Comptences</h2>\n            <div class=\"competences\">\n              ${Object.entries(classStats.competencesStats).map(([comp, data]) => `\n                <span class=\"competence-item\" style=\"background: ${data.couleur};\">\n                  ${comp}: ${data.pourcentage.toFixed(0)}% (${data.niveau})\n                </span>\n              `).join('')}\n            </div>\n          </div>\n        ` : ''}\n\n        <div class=\"section\">\n          <h2>Dtail par lve</h2>\n          <table>\n            <thead>\n              <tr>\n                <th>Nom</th>\n                <th>Prnom</th>\n                <th>Note</th>\n                <th>Niveau</th>\n                <th>Statut</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${students.map(student => {\n                const score = calculateStudentScore(student.id)\n                const correctedQuestions = countCorrectedQuestions(student.id)\n                const totalQuestions = evaluationData.reduce((sum, ex) => sum + ex.questions.length, 0)\n                const niveauGlobal = getNiveauMaitriseAvecNonCorrige(score.correct, score.total, correctedQuestions)\n                const isFullyCorrected = correctedQuestions === totalQuestions && totalQuestions > 0\n                const statut = isFullyCorrected ? 'Termin' : correctedQuestions > 0 ? 'En cours' : 'Non commenc'\n                \n                return `\n                  <tr>\n                    <td>${student.nom}</td>\n                    <td>${student.prenom}</td>\n                    <td><strong>${formatNote(score.correct)}/${formatNote(score.total)}</strong></td>\n                    <td style=\"color: ${niveauGlobal.couleur}; font-weight: bold;\">${niveauGlobal.niveau}</td>\n                    <td>${statut}</td>\n                  </tr>\n                `\n              }).join('')}\n            </tbody>\n          </table>\n        </div>\n      </body>\n      </html>\n    `\n\n    printWindow.document.write(html)\n    printWindow.document.close()\n  }\n\n  // Imprimer tous les bilans individuels\n  function imprimerBilansIndividuels() {\n    const printWindow = window.open('', '_blank')\n    if (!printWindow) return\n\n    const html = `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <title>Bilans individuels</title>\n        <script src=\"https://polyfill.io/v3/polyfill.min.js?features=es6\"><\\/script>\n        <script id=\"MathJax-script\" async src=\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"><\\/script>\n        <script>\n          window.MathJax = {\n            tex: {\n              inlineMath: [['$', '$']],\n              displayMath: [['$$', '$$']]\n            },\n            startup: {\n              ready: () => {\n                MathJax.startup.defaultReady();\n                MathJax.startup.promise.then(() => {\n                  console.log('MathJax charg');\n                });\n              }\n            }\n          };\n        <\\/script>\n        <style>\n          body { font-family: Arial, sans-serif; font-size: 9px; margin: 0; padding: 0; line-height: 1.3; }\n          .page-break { page-break-after: always; }\n          .bilan { padding: 10px; max-width: 100%; }\n          h1 { color: #2563eb; border-bottom: 2px solid #2563eb; padding-bottom: 3px; margin: 0 0 6px 0; font-size: 16px; }\n          h2 { color: #1f2937; margin: 6px 0 3px 0; font-size: 11px; font-weight: bold; }\n          .header-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 8px; margin-bottom: 6px; }\n          .student-info { background: #f3f4f6; padding: 5px 8px; border-radius: 4px; }\n          .student-info h2 { margin: 0; font-size: 13px; }\n          .student-info p { margin: 2px 0 0 0; color: #6b7280; font-size: 8px; }\n          .score-box { background: linear-gradient(135deg, #2563eb, #4f46e5); color: white; padding: 8px; border-radius: 6px; text-align: center; }\n          .score-value { font-size: 18px; font-weight: bold; margin: 2px 0; line-height: 1; }\n          .score-label { font-size: 8px; opacity: 0.9; }\n          .exercices-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 5px; margin-bottom: 6px; }\n          .exercice { margin: 0; padding: 5px; border: 1px solid #e5e7eb; border-radius: 4px; background: #fafafa; break-inside: avoid; }\n          .exercice.correct { border-color: #16a34a; background: #f0fdf4; }\n          .exercice-header { background: #2563eb; color: white; padding: 3px 5px; margin: -5px -5px 4px -5px; border-radius: 3px 3px 0 0; font-weight: bold; font-size: 9px; }\n          .question { margin: 3px 0; padding: 3px 5px; background: white; border-left: 2px solid #d1d5db; border-radius: 2px; }\n          .question strong { font-size: 8px; font-weight: bold; }\n          .question-enonce { margin: 2px 0; line-height: 1.3; font-size: 8px; }\n          .question-enonce img, .question-enonce svg { max-width: 100%; height: auto; max-height: 50px; }\n          .question-status { display: inline-block; padding: 1px 4px; border-radius: 2px; font-size: 7px; font-weight: bold; margin-top: 2px; }\n          .status-TB { background: #16a34a; color: white; }\n          .status-TF { background: #f59e0b; color: white; }\n          .status-NR { background: #6b7280; color: white; }\n          .status-NE { background: #9333ea; color: white; }\n          .eval-note { margin: 4px 0; padding: 4px; background: #e0f2fe; border-left: 2px solid #0284c7; border-radius: 2px; font-size: 8px; }\n          .bottom-section { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; margin-top: 6px; }\n          .competences-box { background: #f9fafb; padding: 5px; border-radius: 4px; border: 1px solid #e5e7eb; }\n          .competences-box h2 { margin-top: 0; font-size: 10px; }\n          .competence-item { display: inline-block; margin: 2px; padding: 2px 5px; border-radius: 3px; color: white; font-weight: bold; font-size: 7px; }\n          .commentaire-box { background: #f9fafb; padding: 5px; border-radius: 4px; border: 1px solid #e5e7eb; }\n          .commentaire-box h2 { margin-top: 0; font-size: 10px; }\n          .commentaire { background: #fef3c7; border-left: 2px solid #f59e0b; padding: 4px; border-radius: 2px; font-size: 8px; line-height: 1.3; }\n          @media print { \n            .no-print { display: none; }\n            .page-break { page-break-after: always; }\n            body { font-size: 8px; }\n            .question-enonce img, .question-enonce svg { max-height: 40px; }\n          }\n        </style>\n      </head>\n      <body>\n        <button class=\"no-print\" onclick=\"window.print()\" style=\"position: fixed; top: 20px; right: 20px; padding: 10px 20px; background: #2563eb; color: white; border: none; border-radius: 5px; cursor: pointer; z-index: 1000;\"> Imprimer</button>\n        \n        ${students.map((student, index) => {\n          const score = calculateStudentScore(student.id)\n          const correctedQuestions = countCorrectedQuestions(student.id)\n          const niveauGlobal = getNiveauMaitriseAvecNonCorrige(score.correct, score.total, correctedQuestions)\n          const competencesStudent = calculateCompetences(student.id)\n          const commentaire = corrections[student.id]?.commentaire || ''\n\n          return `\n            <div class=\"bilan ${index < students.length - 1 ? 'page-break' : ''}\">\n              <h1>Bilan individuel</h1>\n              \n              <div class=\"header-grid\">\n                <div class=\"student-info\">\n                  <h2>${student.nom} ${student.prenom}</h2>\n                  <p>Date: ${new Date().toLocaleDateString('fr-FR')}</p>\n                </div>\n\n                <div class=\"score-box\">\n                  <div class=\"score-label\">Note globale</div>\n                  <div class=\"score-value\">${formatNote(score.correct)}/${formatNote(score.total)}</div>\n                  <div class=\"score-label\">Niveau: ${niveauGlobal.niveau}</div>\n                </div>\n              </div>\n\n              <h2>Dtail par exercice</h2>\n              <div class=\"exercices-grid\">\n              ${evaluationData.map((ex, exIndex) => {\n                const exercicePoints = calculateExercicePoints(student.id, exIndex)\n                const exerciceNiveau = getExerciceNiveau(student.id, exIndex)\n                const studentCorrections = corrections[student.id]\n                \n                return `\n                  <div class=\"exercice ${exercicePoints.obtenus === exercicePoints.totaux ? 'correct' : ''}\">\n                    <div class=\"exercice-header\">\n                      Exercice ${exIndex + 1}: ${ex.titre || `Exercice ${exIndex + 1}`}\n                      <span style=\"float: right;\">\n                        ${exercicePoints.obtenus}/${exercicePoints.totaux} points - ${exerciceNiveau.niveau}\n                      </span>\n                    </div>\n                    \n                    ${ex.competencesExercice && ex.competencesExercice.length > 0 ? `\n                      <div style=\"padding: 3px 5px; background: #f0f9ff; border-left: 2px solid #0284c7; margin-bottom: 4px; font-size: 7px; color: #0369a1;\">\n                        <strong>Comptences values :</strong> ${ex.competencesExercice.map(comp => getCompetenceIcon(comp) + ' ' + comp).join(', ')}\n                      </div>\n                    ` : ''}\n                    \n                    ${ex.questions.map((question, qIndex) => {\n                      const correction = studentCorrections?.[exIndex]?.[qIndex]\n                      const status = correction?.status || 'NE'\n                      const statusInfo = {\n                        'TB': { label: ' Trs Bien', detail: 'Rponse correcte - Points obtenus', color: '#16a34a' },\n                        'TF': { label: '~  revoir', detail: 'Rponse partiellement correcte', color: '#f59e0b' },\n                        'NR': { label: ' Non rendu', detail: 'Question non traite', color: '#6b7280' },\n                        'NE': { label: ' Non valu', detail: 'En attente de correction', color: '#9333ea' }\n                      }\n                      const info = statusInfo[status] || { label: status, detail: '', color: '#9ca3af' }\n                      \n                      return `\n                        <div class=\"question\">\n                          <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 2px;\">\n                            <div>\n                              <strong>Question ${qIndex + 1}</strong> (${question.points} point${question.points > 1 ? 's' : ''})\n                              ${question.competences && question.competences.length > 0 ? `\n                                <span style=\"font-size: 7px; color: #6b7280; margin-left: 3px;\">\n                                  [${question.competences.map(c => getCompetenceIcon(c)).join(' ')}]\n                                </span>\n                              ` : ''}\n                            </div>\n                            ${ex.detailParQuestion ? `\n                              <span class=\"question-status status-${status}\" title=\"${info.detail}\">\n                                ${info.label}\n                              </span>\n                            ` : ''}\n                          </div>\n                          <div class=\"question-enonce\">${question.enonce}</div>\n                          ${ex.detailParQuestion && status !== 'NE' ? `\n                            <div style=\"margin-top: 3px; padding: 3px 5px; background: ${status === 'TB' ? '#f0fdf4' : status === 'TF' ? '#fffbeb' : '#f9fafb'}; border-radius: 2px; font-size: 7px; color: ${info.color}; font-style: italic;\">\n                              ${status === 'TB' ? ' Excellente matrise' : status === 'TF' ? ' Besoin de renforcement' : status === 'NR' ? ' Travail non remis' : ''}\n                            </div>\n                          ` : ''}\n                        </div>\n                      `\n                    }).join('')}\n                    ${ex.detailParQuestion ? `\n                      <div class=\"eval-note\" style=\"background: ${exercicePoints.obtenus === exercicePoints.totaux ? '#f0fdf4' : exercicePoints.obtenus > 0 ? '#fffbeb' : '#fef2f2'}; border-left-color: ${exerciceNiveau.couleur};\">\n                        <strong>Rsultat :</strong> ${exercicePoints.obtenus}/${exercicePoints.totaux} pts \n                        ${exercicePoints.obtenus === exercicePoints.totaux ? '- Objectif atteint ' : \n                          exercicePoints.obtenus > 0 ? '- En progression' : \n                          '-  retravailler'}\n                      </div>\n                    ` : `\n                      <div class=\"eval-note\">\n                        <strong>Note :</strong> valuation globale - ${exercicePoints.obtenus}/${exercicePoints.totaux} pts\n                      </div>\n                    `}\n                  </div>\n                `\n              }).join('')}\n              </div>\n\n              ${(modeEvaluation !== 'notes' && Object.keys(competencesStudent).length > 0) || commentaire ? `\n                <div class=\"bottom-section\">\n                  ${modeEvaluation !== 'notes' && Object.keys(competencesStudent).length > 0 ? `\n                    <div class=\"competences-box\">\n                      <h2>Comptences</h2>\n                      ${Object.entries(competencesStudent).map(([comp, compData]) => {\n                        const colorInfo = compData.niveau === 'tbm' ? { couleur: '#4caf50', label: 'TBM' } :\n                                         compData.niveau === 'ms' ? { couleur: '#2196f3', label: 'MS' } :\n                                         compData.niveau === 'mf' ? { couleur: '#ff9800', label: 'MF' } :\n                                         compData.niveau === 'mi' ? { couleur: '#f44336', label: 'MI' } :\n                                         { couleur: '#9c27b0', label: 'NE' }\n                        return `\n                          <span class=\"competence-item\" style=\"background: ${colorInfo.couleur};\">\n                            ${comp}: ${compData.correct}/${compData.total}\n                          </span>\n                        `\n                      }).join('')}\n                    </div>\n                  ` : '<div></div>'}\n                  \n                  ${commentaire ? `\n                    <div class=\"commentaire-box\">\n                      <h2>Commentaire</h2>\n                      <div class=\"commentaire\">\n                        ${commentaire.replace(/\\n/g, '<br>')}\n                      </div>\n                    </div>\n                  ` : '<div></div>'}\n                </div>\n              ` : ''}\n            </div>\n          `\n        }).join('')}\n      </body>\n      </html>\n    `\n\n    printWindow.document.write(html)\n    printWindow.document.close()\n  }\n\n  // Fonction pour obtenir l'icne d'un exercice\n  function getExerciceIcon(exerciceIndex: number): string {\n    return '' // Icne uniforme pour tous les exercices\n  }\n\n  // Fonction pour obtenir l'icne d'une comptence\n  function getCompetenceIcon(competenceName: string): string {\n    const name = competenceName.toLowerCase()\n    \n    // Comptences mathmatiques courantes avec leurs icnes\n    if (name.includes('calcul') || name.includes('arithmtique') || name.includes('nombres')) {\n      return ''\n    }\n    if (name.includes('gomtrie') || name.includes('espace') || name.includes('figure') || name.includes('triangle') || name.includes('cercle')) {\n      return ''\n    }\n    if (name.includes('algbre') || name.includes('quation') || name.includes('expression')) {\n      return ''\n    }\n    if (name.includes('statistique') || name.includes('probabilit') || name.includes('donnes')) {\n      return ''\n    }\n    if (name.includes('fonction') || name.includes('graphique') || name.includes('courbe')) {\n      return ''\n    }\n    if (name.includes('mesure') || name.includes('longueur') || name.includes('aire') || name.includes('volume')) {\n      return ''\n    }\n    if (name.includes('logique') || name.includes('raisonnement') || name.includes('dduction') || name.includes('raisonner')) {\n      return ''\n    }\n    if (name.includes('rsolution') || name.includes('problme') || name.includes('situation')) {\n      return ''\n    }\n    if (name.includes('communication') || name.includes('explication') || name.includes('justification')) {\n      return ''\n    }\n    if (name.includes('recherche') || name.includes('investigation') || name.includes('exploration')) {\n      return ''\n    }\n    if (name.includes('technologie') || name.includes('outil') || name.includes('informatique')) {\n      return ''\n    }\n    if (name.includes('reprsentation') || name.includes('schma') || name.includes('dessin')) {\n      return ''\n    }\n    if (name.includes('modlisation') || name.includes('simulation')) {\n      return ''\n    }\n    if (name.includes('analyse') || name.includes('interprtation')) {\n      return ''\n    }\n    if (name.includes('conjecture') || name.includes('hypothse')) {\n      return ''\n    }\n    if (name.includes('vrification') || name.includes('contrle') || name.includes('validation')) {\n      return ''\n    }\n    if (name.includes('calculatrice') || name.includes('calculer')) {\n      return ''\n    }\n    if (name.includes('fraction') || name.includes('dcimale') || name.includes('pourcentage')) {\n      return ''\n    }\n    if (name.includes('transformation') || name.includes('symtrie') || name.includes('translation')) {\n      return ''\n    }\n    if (name.includes('angle') || name.includes('droite') || name.includes('parallle')) {\n      return ''\n    }\n    if (name.includes('thorme') || name.includes('proprit') || name.includes('dmonstration')) {\n      return ''\n    }\n    \n    // Icne par dfaut si aucune correspondance\n    return ''\n  }\n\n  // Normaliser les libells de comptences pour regrouper les synonymes\n  function normalizeCompetenceName(competenceName: string): string {\n    const name = competenceName.trim().toLowerCase()\n    if (name.includes('raisonner') || name.includes('raisonnement') || name.includes('logique') || name.includes('dduction')) {\n      return 'Raisonner'\n    }\n    if (name.includes('calcul') || name.includes('calculer') || name.includes('arithmtique')) {\n      return 'Calculer'\n    }\n    if (name.includes('reprsenter') || name.includes('schmatiser')) {\n      return 'Reprsenter'\n    }\n    if (name.includes('modliser')) {\n      return 'Modliser'\n    }\n    if (name.includes('communiquer')) {\n      return 'Communiquer'\n    }\n    // Mettre la premire lettre en majuscule pour une prsentation propre\n    const trimmedName = competenceName.trim()\n    return trimmedName.charAt(0).toUpperCase() + trimmedName.slice(1)\n  }\n\n  // Compter les questions NR et NE pour un lve\n  function countQuestionsNRNE(studentId: string): { nr: number, ne: number, total: number } {\n    const studentCorrections = corrections[studentId]\n    if (!studentCorrections) return { nr: 0, ne: 0, total: 0 }\n\n    let questionsNR = 0\n    let questionsNE = 0\n    let totalQuestions = 0\n\n    evaluationData.forEach(ex => {\n      ex.questions.forEach(q => {\n        totalQuestions++\n        const correction = studentCorrections[ex.exerciceIndex]?.[q.questionIndex]\n        const status = correction?.status\n        \n        if (status === 'NR') {\n          questionsNR++\n        } else if (status === 'NE') {\n          questionsNE++\n        }\n      })\n    })\n\n    return { nr: questionsNR, ne: questionsNE, total: totalQuestions }\n  }\n\n  // Charger les donnes d'valuation depuis localStorage\n  function loadEvaluationData() {\n    const evalDataStr = localStorage.getItem('evaluationData')\n    const configStr = localStorage.getItem('evaluationConfig')\n    const competencesStr = localStorage.getItem('competencesPersonnalisees')\n    const studentsStr = localStorage.getItem('studentsList')\n    const evalExercicesStr = localStorage.getItem('evaluationExercices')\n    \n    // Charger la prfrence d'affichage des corrections\n    const preferenceCorrections = localStorage.getItem('preferenceCorrections')\n    if (preferenceCorrections !== null) {\n      modeCorrectionsActive = preferenceCorrections === 'true'\n      showCorrections = localStorage.getItem('showCorrections') !== 'false'\n    }\n    \n    // Charger la liste des lves si disponible\n    if (studentsStr) {\n      try {\n        students = JSON.parse(studentsStr)\n        filteredStudents = students // Initialiser la liste filtre\n        console.log('Liste des lves charge:', students.length, 'lves')\n        \n        // Si des lves sont chargs et qu'on a des donnes d'valuation, passer  la vue d'ensemble\n        if (students.length > 0 && localStorage.getItem('evaluationData')) {\n          currentPage = 'overview'\n        }\n      } catch (e) {\n        console.error('Erreur lors du chargement de la liste des lves', e)\n      }\n    }\n    \n    if (evalDataStr) {\n      try {\n        console.log('Donnes brutes du localStorage:', evalDataStr.substring(0, 500) + '...')\n        evaluationData = JSON.parse(evalDataStr)\n        \n        // Enrichir avec les seeds et paramtres depuis evaluationExercices\n        if (evalExercicesStr) {\n          try {\n            const evalExercices = JSON.parse(evalExercicesStr)\n            console.log(' Donnes exercices trouves:', evalExercices)\n            \n            if (evalExercices.seeds && evalExercices.params) {\n              evaluationData.forEach((ex, i) => {\n                // Rcuprer le seed correspondant\n                if (evalExercices.seeds[i]) {\n                  ex.seed = evalExercices.seeds[i]\n                }\n                \n                // Rcuprer les paramtres correspondants\n                const params = evalExercices.params?.[i]\n                if (params) {\n                  ex.sup = params.sup\n                  ex.sup2 = params.sup2\n                  ex.sup3 = params.sup3\n                  ex.nbQuestions = params.nbQuestions\n                }\n              })\n            }\n          } catch (e) {\n            console.warn(' Impossible de charger les paramtres des exercices:', e)\n          }\n        }\n        \n        // Vrifier si les seeds sont prsents\n        console.log(' Vrification des seeds aprs enrichissement:')\n        evaluationData.forEach((ex, i) => {\n          console.log(`   Exercice ${i + 1} (${ex.uuid}):`, {\n            seed: ex.seed || 'MANQUANT',\n            sup: ex.sup || '-',\n            nbQuestions: ex.nbQuestions || '-'\n          })\n        })\n\n        // Normaliser les comptences ds le chargement\n        evaluationData.forEach(ex => {\n          ex.competencesExercice = ex.competencesExercice.map(comp => normalizeCompetenceName(comp))\n          if (ex.detailParQuestion) {\n            ex.questions.forEach(q => {\n              q.competences = q.competences.map(comp => normalizeCompetenceName(comp))\n            })\n          }\n        })\n        \n        console.log('Donnes valuation charges et normalises:', evaluationData.map(ex => ({ \n          titre: ex.titre, \n          uuid: ex.uuid, \n          seed: ex.seed,\n          questions: ex.questions.length \n        })))\n      } catch (e) {\n        console.error('Erreur lors du chargement des donnes d\\'valuation', e)\n        toast.error('Donnes d\\'valuation invalides', {\n          duration: 4000,\n          position: 'top-center'\n        })\n      }\n    } else {\n      toast.error('Aucune donnes d\\'valuation trouves. Veuillez d\\'abord configurer une valuation.', {\n        duration: 4000,\n        position: 'top-center'\n      })\n    }\n    \n    // Mettre  jour l'affichage initial\n    updateDisplay()\n\n    if (competencesStr) {\n      try {\n        competencesPersonnalisees = JSON.parse(competencesStr)\n        const competencesActiveesStr = localStorage.getItem('competencesActivees')\n        if (competencesActiveesStr) {\n          competencesActivees = JSON.parse(competencesActiveesStr)\n        } else {\n          // Initialiser toutes les comptences comme actives\n          competencesActivees = {}\n          competencesPersonnalisees.forEach(comp => {\n            competencesActivees[comp] = true\n          })\n        }\n      } catch (e) {\n        console.error('Erreur lors du chargement des comptences personnalises', e)\n        initializeCompetencesFromEvaluation()\n      }\n    } else {\n      initializeCompetencesFromEvaluation()\n    }\n\n    if (configStr) {\n      try {\n        const config = JSON.parse(configStr)\n        modeEvaluation = config.modeEvaluation || 'mixte'\n        seuilTBM = config.seuilTBM || 90\n        seuilMS = config.seuilMS || 70\n        seuilMF = config.seuilMF || 30\n        totalCalcul = config.totalCalcul || 0\n      } catch (e) {\n        console.error('Erreur lors du chargement de la configuration', e)\n      }\n    }\n\n    // Charger les corrections existantes et initialiser pour les nouveaux lves\n    const storedCorrections = localStorage.getItem('studentCorrections')\n    if (storedCorrections) {\n      try {\n        corrections = JSON.parse(storedCorrections)\n      } catch (e) {\n        console.error('Erreur lors du chargement des corrections', e)\n        corrections = {}\n      }\n    }\n\n    // Initialiser les corrections pour tous les lves\n    students.forEach(student => {\n      if (!corrections[student.id]) {\n        corrections[student.id] = {}\n      }\n    })\n  }\n  \n  // Initialiser les comptences  partir de l'valuation\n  function initializeCompetencesFromEvaluation() {\n    const allCompetences = new Set<string>()\n    \n    // Rcuprer TOUTES les comptences de TOUS les exercices de l'valuation\n    evaluationData.forEach(ex => {\n      ex.competencesExercice.forEach(comp => allCompetences.add(normalizeCompetenceName(comp)))\n      if (ex.detailParQuestion) {\n        ex.questions.forEach(q => q.competences.forEach(comp => allCompetences.add(normalizeCompetenceName(comp))))\n      }\n    })\n    \n    competencesPersonnalisees = Array.from(allCompetences)\n    \n    // Initialiser toutes les comptences comme actives par dfaut\n    competencesActivees = {}\n    competencesPersonnalisees.forEach(comp => {\n      competencesActivees[comp] = true\n    })\n    \n    saveCompetencesPersonnalisees()\n    console.log('Comptences initialises:', competencesPersonnalisees)\n  }\n  \n  // Sauvegarder les comptences personnalises\n  function saveCompetencesPersonnalisees() {\n    localStorage.setItem('competencesPersonnalisees', JSON.stringify(competencesPersonnalisees))\n    localStorage.setItem('competencesActivees', JSON.stringify(competencesActivees))\n  }\n  \n  // Modifier les comptences\n  function modifierCompetences() {\n    showCompetenceEditor = true\n  }\n  \n  // Toggle une comptence\n  function toggleCompetence(competence: string) {\n    competencesActivees[competence] = !competencesActivees[competence]\n    saveCompetencesPersonnalisees()\n  }\n  \n  // Rinitialiser les comptences\n  function reinitialiserCompetences() {\n    if (confirm('Rinitialiser les comptences avec toutes celles de l\\'valuation ?')) {\n      initializeCompetencesFromEvaluation()\n    }\n  }\n\n  // Fermer la modale de rsum\n  function closeSummaryModal() {\n    showSummaryModal = false\n  }\n\n  // Dmarrer la dicte vocale (reconnaissance vocale)\n  function startListening() {\n    if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {\n      toast('La reconnaissance vocale n\\'est pas supporte par votre navigateur.', {\n        icon: '',\n        duration: 4000,\n        position: 'top-center'\n      })\n      return\n    }\n\n    const SpeechRecognition = (window as any).SpeechRecognition || (window as any).webkitSpeechRecognition\n    recognition = new SpeechRecognition()\n    \n    recognition.lang = 'fr-FR'\n    recognition.continuous = true\n    recognition.interimResults = false\n    \n    recognition.onstart = () => {\n      isListening = true\n    }\n    \n    recognition.onresult = (event: any) => {\n      let transcript = ''\n      for (let i = event.resultIndex; i < event.results.length; i++) {\n        transcript += event.results[i][0].transcript\n      }\n      \n      // Formatage automatique : premire lettre en majuscule et ajout de ponctuation\n      const formattedText = formatText(transcript.trim())\n      dictatedText += (dictatedText ? ' ' : '') + formattedText\n      \n      // Ajouter le texte dict au commentaire global\n      if (commentaireGlobal) {\n        commentaireGlobal += ' ' + formattedText\n      } else {\n        commentaireGlobal = formattedText\n      }\n    }\n    \n    recognition.onerror = (event: any) => {\n      console.error('Erreur de reconnaissance vocale:', event.error)\n      isListening = false\n    }\n    \n    recognition.onend = () => {\n      isListening = false\n    }\n    \n    recognition.start()\n  }\n\n  // Arrter la dicte vocale\n  function stopListening() {\n    if (recognition && isListening) {\n      recognition.stop()\n      isListening = false\n    }\n  }\n\n  // Fonction pour formater le texte automatiquement\n  function formatText(text: string): string {\n    if (!text) return text\n    \n    // Premire lettre en majuscule\n    let formatted = text.charAt(0).toUpperCase() + text.slice(1).toLowerCase()\n    \n    // Ajouter un point  la fin si pas de ponctuation\n    if (!/[.!?]$/.test(formatted)) {\n      formatted += '.'\n    }\n    \n    return formatted\n  }\n\n\n\n  // Sauvegarder le commentaire de l'lve actuel\n  function saveCurrentStudentComment() {\n    if (students.length > 0) {\n      const currentStudentId = students[currentStudentIndex].id\n      if (!corrections[currentStudentId]) {\n        corrections[currentStudentId] = {}\n      }\n      \n      // Sauvegarder le commentaire (ou le supprimer s'il est vide)\n      if (commentaireGlobal.trim()) {\n        corrections[currentStudentId].commentaire = commentaireGlobal.trim()\n      } else {\n        delete corrections[currentStudentId].commentaire\n      }\n      \n      // Sauvegarder dans localStorage\n      localStorage.setItem('studentCorrections', JSON.stringify(corrections))\n    }\n  }\n\n  // Charger le commentaire de l'lve actuel\n  function loadCurrentStudentComment() {\n    if (students.length > 0) {\n      const currentStudentId = students[currentStudentIndex].id\n      const studentCorrections = corrections[currentStudentId]\n      \n      // Charger le commentaire s'il existe\n      commentaireGlobal = studentCorrections?.commentaire || ''\n      dictatedText = ''\n    }\n  }\n\n  // Passer  l'lve suivant\n  function nextStudent() {\n    if (currentStudentIndex < students.length - 1) {\n      // Sauvegarder le commentaire de l'lve actuel\n      saveCurrentStudentComment()\n      \n      showSummaryModal = false\n      currentStudentIndex++\n      currentExerciceIndex = 0 // Retourner  l'exercice 1 pour le nouvel lve\n      \n      // Charger le commentaire du nouvel lve\n      loadCurrentStudentComment()\n      \n      updateDisplay()\n      // Scroll vers le haut pour voir le dbut de la correction\n      window.scrollTo({ top: 0, behavior: 'smooth' })\n    }\n  }\n\n  // Passer  l'lve prcdent\n  function previousStudent() {\n    if (currentStudentIndex > 0) {\n      // Sauvegarder le commentaire de l'lve actuel\n      saveCurrentStudentComment()\n      \n      showSummaryModal = false\n      currentStudentIndex--\n      currentExerciceIndex = 0 // Retourner  l'exercice 1 pour le nouvel lve\n      \n      // Charger le commentaire du nouvel lve\n      loadCurrentStudentComment()\n      \n      updateDisplay()\n      // Scroll vers le haut pour voir le dbut de la correction\n      window.scrollTo({ top: 0, behavior: 'smooth' })\n    }\n  }\n\n  // Fonction pour mettre  jour l'affichage\n  function updateDisplay() {\n    if (students.length > 0) {\n      const studentId = students[currentStudentIndex].id\n      studentScoreData = calculateStudentScore(studentId)\n      niveauMaitrise = getNiveauMaitrise(studentScoreData.correct, studentScoreData.total)\n      competences = calculateCompetences(studentId)\n      totalQuestions = evaluationData.reduce((sum, ex) => sum + ex.questions.length, 0)\n      \n      // Calculer le nombre de questions values (avec n'importe quel statut)\n      const studentCorrections = corrections[studentId]\n      let questionsEvaluees = 0\n      if (studentCorrections) {\n        evaluationData.forEach(ex => {\n          ex.questions.forEach(q => {\n            const correction = studentCorrections[ex.exerciceIndex]?.[q.questionIndex]\n            if (correction?.status) {\n              questionsEvaluees++\n            }\n          })\n        })\n      }\n      \n      const previousState = toutesQuestionsEvaluees\n      toutesQuestionsEvaluees = questionsEvaluees === totalQuestions\n      \n      // Ouverture automatique de la modale quand toutes les questions sont values pour la premire fois\n      if (!previousState && toutesQuestionsEvaluees) {\n        console.log(' Toutes les questions sont maintenant values - Ouverture automatique de la modale')\n        showSummaryModal = true\n      }\n      \n      console.log(`Questions values: ${questionsEvaluees}/${totalQuestions}, Toutes values: ${toutesQuestionsEvaluees}`)\n      console.log(' DEBUG - toutesQuestionsEvaluees:', toutesQuestionsEvaluees)\n    }\n  }\n\n  // Import CSV\n  function handleFileUpload(event: Event) {\n    const target = event.target as HTMLInputElement\n    const file = target.files?.[0]\n    if (!file) return\n\n    const reader = new FileReader()\n    reader.onload = (e) => {\n      const text = e.target?.result as string\n      parseCSV(text)\n    }\n    reader.readAsText(file)\n  }\n\n  function parseCSV(csvText: string) {\n    const lines = csvText.trim().split('\\n')\n    // Ignorer la premire ligne (en-ttes)\n    const dataLines = lines.slice(1)\n    \n    students = dataLines.map((line, index) => {\n      const [nom, prenom, sexe] = line.split(',').map(s => s.trim())\n      return {\n        id: `student_${index}`,\n        nom: nom || '',\n        prenom: prenom || '',\n        sexe: sexe || '',\n      }\n    })\n\n    // Initialiser les corrections pour chaque lve\n    students.forEach(student => {\n      corrections[student.id] = {}\n    })\n\n    // Initialiser la liste filtre\n    filteredStudents = students\n\n    // Sauvegarder la liste des lves dans localStorage\n    localStorage.setItem('studentsList', JSON.stringify(students))\n\n    if (students.length > 0) {\n      currentPage = 'overview'\n    }\n  }\n\n  // Rinitialiser la liste des lves\n  function resetStudentsList() {\n    showConfirm(\n      ' Rinitialisation complte',\n      `Voulez-vous vraiment supprimer la liste des ${students.length} lve(s) et toutes leurs corrections ?\\n\\nToutes les donnes seront dfinitivement perdues.`,\n      () => {\n      students = []\n        filteredStudents = []\n      corrections = {}\n      localStorage.removeItem('studentsList')\n      localStorage.removeItem('studentCorrections')\n      currentPage = 'setup'\n      console.log('Liste des lves rinitialise')\n      },\n      'Oui, tout supprimer',\n      'Non, annuler'\n    )\n  }\n\n  // Rinitialiser les corrections d'un lve spcifique\n  async function resetStudentCorrection(studentId: string) {\n    const student = students.find(s => s.id === studentId)\n    const studentName = student ? `${student.prenom} ${student.nom}` : \"cet lve\"\n    \n    showConfirm(\n      ' Rinitialisation complte',\n      `Voulez-vous vraiment rinitialiser TOUTES les corrections de ${studentName} ?\\n\\n Notes et valuations\\n Commentaires\\n Comptences values\\n\\nCette action est irrversible.`,\n      async () => {\n        // 1. Si on rinitialise l'lve en cours, retourner  l'overview d'abord\n        const isCurrentStudent = students[currentStudentIndex]?.id === studentId\n        if (isCurrentStudent) {\n          currentPage = 'overview'\n          commentaireGlobal = ''\n          dictatedText = ''\n          currentExerciceIndex = 0\n          await tick() // Attendre que Svelte applique le changement de page\n        }\n        \n        // 2. Crer un NOUVEL objet corrections compltement indpendant\n        const newCorrections: Record<string, StudentCorrection> = {}\n        Object.keys(corrections).forEach(id => {\n          if (id === studentId) {\n            newCorrections[id] = { commentaire: '' }\n          } else {\n            newCorrections[id] = corrections[id]\n          }\n        })\n        corrections = newCorrections\n        \n        // 3. Nettoyer localStorage\n        const competencesKey = `competences_${studentId}`\n        localStorage.removeItem(competencesKey)\n        localStorage.setItem('studentCorrections', JSON.stringify(corrections))\n        \n        // 4. Incrmenter le trigger AVANT de forcer les arrays\n        badgeUpdateTrigger++\n        await tick() // Attendre que le recalcul des badges ractifs se fasse\n        \n        // 5. Forcer la ractivit des arrays\n        students = [...students]\n        evaluationData = [...evaluationData]\n        await tick() // Attendre que Svelte applique les changements\n        \n        // 6. Appeler updateDisplay\n        updateDisplay()\n        await tick() // Attendre le dernier cycle\n        \n        // 7. Notification\n        toast.success(`Correction de ${studentName} rinitialise avec succs !${isCurrentStudent ? ' Vous avez t redirig vers la vue d\\'ensemble.' : ''}`, {\n          duration: 4000,\n          position: 'top-center'\n        })\n      },\n      'Oui, rinitialiser',\n      'Non, annuler'\n    )\n  }\n\n  // Commencer la correction d'un lve\n  function startCorrection(studentIndex: number) {\n    // Vrifier si c'est la premire fois qu'on dmarre une correction\n    const preferenceCorrections = localStorage.getItem('preferenceCorrections')\n    \n    // Si premire fois, demander la prfrence d'affichage des corrections\n    if (preferenceCorrections === null) {\n      showConfirm(\n        ' Affichage des corrections',\n        'Souhaitez-vous afficher les corrections des exercices MathALA pendant la correction ?\\n\\nCela vous aidera  valuer plus rapidement.\\n\\nVous pourrez les masquer/afficher  tout moment avec un bouton.',\n        () => {\n          // L'utilisateur veut les corrections\n          modeCorrectionsActive = true\n          showCorrections = true\n          localStorage.setItem('preferenceCorrections', 'true')\n          localStorage.setItem('showCorrections', 'true')\n          proceedToCorrection(studentIndex)\n        },\n        'Oui, afficher les corrections',\n        'Non, mode classique',\n        () => {\n          // L'utilisateur refuse - mode classique\n          modeCorrectionsActive = false\n          showCorrections = false\n          localStorage.setItem('preferenceCorrections', 'false')\n          localStorage.setItem('showCorrections', 'false')\n          proceedToCorrection(studentIndex)\n        }\n      )\n      return\n    }\n    \n    proceedToCorrection(studentIndex)\n  }\n  \n  // Fonction helper pour procder  la correction\n  async function proceedToCorrection(studentIndex: number) {\n    // Sauvegarder le commentaire de l'lve actuel si on change d'lve\n    if (currentStudentIndex !== studentIndex) {\n      saveCurrentStudentComment()\n    }\n    \n    currentStudentIndex = studentIndex\n    currentExerciceIndex = 0 // Retourner automatiquement  l'exercice 1 pour chaque nouvel lve\n    currentPage = 'correction'\n    \n    // Charger le commentaire du nouvel lve\n    loadCurrentStudentComment()\n    \n    // Charger les corrections si le mode est actif et pas dj charges\n    if (modeCorrectionsActive) {\n      await loadCorrectionsForEvaluation()\n    }\n    \n    updateDisplay()\n  }\n  \n  // Vrifier les corrections disponibles dans les donnes\n  async function loadCorrectionsForEvaluation() {\n    loadingCorrections = true\n    console.log(' Vrification des corrections...')\n    \n    let correctionsPresentes = 0\n    let totalQuestions = 0\n    \n    evaluationData.forEach(ex => {\n      ex.questions.forEach(q => {\n        totalQuestions++\n        if (q.correction) {\n          q.correctionDisponible = true\n          correctionsPresentes++\n        } else {\n          q.correctionDisponible = false\n        }\n      })\n    })\n    \n    loadingCorrections = false\n    console.log(` Corrections prsentes: ${correctionsPresentes}/${totalQuestions} questions`)\n    \n    if (correctionsPresentes === 0) {\n      console.warn(' Aucune correction sauvegarde dans l\\'valuation.')\n      console.warn(' Astuce: Recrez l\\'valuation depuis le module valuation pour sauvegarder les corrections.')\n    }\n  }\n\n  // Retour  la vue d'ensemble\n  function backToOverview() {\n    currentPage = 'overview'\n  }\n\n  // Mettre  jour le statut d'une question\n  function updateQuestionStatus(exerciceIndex: number, questionIndex: number, status: 'TB' | 'TF' | 'NR' | 'NE') {\n    if (students.length === 0) return\n    \n    const studentId = students[currentStudentIndex].id\n    \n    // Crer une copie complte de l'objet corrections pour forcer la ractivit\n    const newCorrections = { ...corrections }\n    \n    if (!newCorrections[studentId]) {\n      newCorrections[studentId] = {}\n    }\n    if (!newCorrections[studentId][exerciceIndex]) {\n      newCorrections[studentId][exerciceIndex] = {}\n    }\n    \n    newCorrections[studentId][exerciceIndex][questionIndex] = { status }\n    \n    // Rassigner compltement l'objet pour forcer la ractivit Svelte\n    corrections = newCorrections\n    localStorage.setItem('studentCorrections', JSON.stringify(corrections))\n    \n    // Forcer la mise  jour des badges\n    badgeUpdateTrigger++\n    \n    updateDisplay()\n    \n    // Vrifier si l'exercice est compltement corrig et passer au suivant\n    checkAndMoveToNextExercise(exerciceIndex)\n  }\n\n  // Vrifier si un exercice est compltement corrig et passer au suivant\n  function checkAndMoveToNextExercise(exerciceIndex: number) {\n    const studentId = students[currentStudentIndex].id\n    const exercice = evaluationData[exerciceIndex]\n    const studentCorrections = corrections[studentId]\n    \n    // Vrifier si toutes les questions de cet exercice sont values\n    let toutesQuestionsEvaluees = true\n    exercice.questions.forEach((q, qIndex) => {\n      const correction = studentCorrections?.[exerciceIndex]?.[q.questionIndex]\n      const status = correction?.status || 'Non valu'\n      \n      if (status === 'Non valu') {\n        toutesQuestionsEvaluees = false\n      }\n    })\n    \n    // Si toutes les questions sont values et ce n'est pas le dernier exercice\n    if (toutesQuestionsEvaluees && exerciceIndex < evaluationData.length - 1) {\n      showAutoNextMessage = true\n      setTimeout(() => {\n        currentExerciceIndex = exerciceIndex + 1\n        showAutoNextMessage = false\n      }, 1000)\n    }\n  }\n\n  // Mettre  jour le statut de toutes les questions d'un exercice\n  function updateAllQuestionsStatus(exerciceIndex: number, status: 'TB' | 'TF' | 'NR' | 'NE') {\n    if (students.length === 0) return\n    \n    const studentId = students[currentStudentIndex].id\n    const exercice = evaluationData[exerciceIndex]\n    if (!exercice) return\n    \n    // Crer une copie complte de l'objet corrections pour forcer la ractivit\n    const newCorrections = { ...corrections }\n    \n    if (!newCorrections[studentId]) {\n      newCorrections[studentId] = {}\n    }\n    if (!newCorrections[studentId][exerciceIndex]) {\n      newCorrections[studentId][exerciceIndex] = {}\n    }\n    \n    // Appliquer le statut  toutes les questions de l'exercice\n    exercice.questions.forEach((_, questionIndex) => {\n      newCorrections[studentId][exerciceIndex][questionIndex] = { status }\n    })\n    \n    // Rassigner compltement l'objet pour forcer la ractivit Svelte\n    corrections = newCorrections\n    localStorage.setItem('studentCorrections', JSON.stringify(corrections))\n    \n    // Forcer la mise  jour des badges\n    badgeUpdateTrigger++\n    updateDisplay()\n    \n    // Passer automatiquement  l'exercice suivant si ce n'est pas le dernier\n    if (exerciceIndex < evaluationData.length - 1) {\n      setTimeout(() => {\n        currentExerciceIndex = exerciceIndex + 1\n      }, 500) // Dlai de 500ms pour que l'utilisateur voie la mise  jour\n    }\n  }\n\n  // Calculer le niveau de matrise avec gestion des copies non corriges\n  function getNiveauMaitriseAvecNonCorrige(pointsObtenus: number, pointsTotaux: number, correctedQuestions: number): { niveau: string, couleur: string, bgColor: string, pourcentage: number } {\n    if (pointsTotaux === 0) {\n      return { niveau: 'Non valu', couleur: '#bdbdbd', bgColor: '#f5f5f5', pourcentage: 0 }\n    }\n    \n    // Si aucune question n'a t corrige, afficher \"Non corrige\"\n    if (correctedQuestions === 0) {\n      return { niveau: 'Non corrige', couleur: '#9e9e9e', bgColor: '#f5f5f5', pourcentage: 0 }\n    }\n    \n    // Calculer le pourcentage bas sur les points\n    const pourcentage = (pointsObtenus / pointsTotaux) * 100\n    \n    if (pourcentage >= seuilTBM) {  // TBM :  seuil configur\n      return { \n        niveau: 'TBM - Trs Bonne Matrise', \n        couleur: '#4caf50', \n        bgColor: '#e8f5e9',\n        pourcentage\n      }\n    } else if (pourcentage >= seuilMS) {  // MS :  seuil configur\n      return { \n        niveau: 'MS - Matrise Satisfaisante', \n        couleur: '#2196f3', \n        bgColor: '#e3f2fd',\n        pourcentage\n      }\n    } else if (pourcentage >= seuilMF) {  // MF :  seuil configur\n      return { \n        niveau: 'MF - Matrise Fragile', \n        couleur: '#ff9800', \n        bgColor: '#fff3e0',\n        pourcentage\n      }\n    } else {  // MI : < seuil configur\n      return { \n        niveau: 'MI - Matrise Insuffisante', \n        couleur: '#f44336', \n        bgColor: '#ffebee',\n        pourcentage\n      }\n    }\n  }\n\n  // Calculer le score d'un lve (nombre de rponses correctes)\n  function calculateStudentScore(studentId: string): { correct: number, total: number } {\n    const studentCorrections = corrections[studentId]\n    if (!studentCorrections) return { correct: 0, total: 0 }\n\n    let pointsObtenus = 0\n    let pointsTotaux = 0\n    \n    evaluationData.forEach(ex => {\n      ex.questions.forEach(q => {\n        const correction = studentCorrections[ex.exerciceIndex]?.[q.questionIndex]\n        const status = correction?.status\n        \n        // Compter tous les points disponibles\n        pointsTotaux += q.points\n        \n        // Ajouter les points obtenus seulement si la question est correcte\n        if (status === 'TB') {\n          pointsObtenus += q.points\n        }\n      })\n    })\n\n    return { correct: pointsObtenus, total: pointsTotaux }\n  }\n\n  // Calculer le total de points possible\n  function getTotalPoints(): number {\n    return evaluationData.reduce((sum, ex) => sum + ex.totalPoints, 0)\n  }\n\n  // Calculer les points par exercice\n  function calculateExercicePoints(studentId: string, exerciceIndex: number): { obtenus: number, totaux: number } {\n    const studentCorrections = corrections[studentId]\n    const ex = evaluationData[exerciceIndex]\n    if (!studentCorrections || !ex) return { obtenus: 0, totaux: 0 }\n\n    let pointsObtenus = 0\n    let pointsTotaux = 0\n\n    ex.questions.forEach(q => {\n      const correction = studentCorrections[exerciceIndex]?.[q.questionIndex]\n      const status = correction?.status\n      \n      pointsTotaux += q.points\n      if (status === 'TB') {\n        pointsObtenus += q.points\n      }\n    })\n\n    return { obtenus: pointsObtenus, totaux: pointsTotaux }\n  }\n\n  // Calculer le niveau de russite d'un exercice\n  function getExerciceNiveau(studentId: string, exerciceIndex: number): { niveau: string, couleur: string, bgColor: string, icon?: string } {\n    // Utiliser la variable ractive pour forcer la mise  jour\n    badgeUpdateTrigger // Cette ligne force Svelte  ragir aux changements\n    \n    const studentCorrections = corrections[studentId]\n    const ex = evaluationData[exerciceIndex]\n    if (!studentCorrections || !ex) {\n      return { niveau: 'Non corrige', couleur: '#9e9e9e', bgColor: '#f5f5f5' }\n    }\n\n\n\n    // Vrifier si toutes les questions sont values\n    let toutesQuestionsEvaluees = true\n    let questionsNR = 0\n    let questionsNEExplicites = 0\n    let questionsNonCorrigees = 0\n    \n    ex.questions.forEach((q, qIndex) => {\n      const correction = studentCorrections[exerciceIndex]?.[q.questionIndex]\n      const status = correction?.status || 'Non valu'\n      \n      if (!status || status === 'Non valu') {\n        toutesQuestionsEvaluees = false\n        questionsNonCorrigees++\n      } else if (status === 'NR') {\n        questionsNR++\n      } else if (status === 'NE') {\n        questionsNEExplicites++\n      }\n    })\n\n    // Si toutes les questions ne sont pas corriges (jamais touches), afficher \"Non corrige\"\n    if (!toutesQuestionsEvaluees && questionsNonCorrigees === ex.questions.length) {\n      return { niveau: 'Non corrige', couleur: '#9e9e9e', bgColor: '#f5f5f5', icon: '' }\n    }\n\n    // Si il y a un mlange de questions non corriges et d'autres statuts, afficher \"En cours\"\n    if (!toutesQuestionsEvaluees) {\n      return { niveau: 'En cours', couleur: '#757575', bgColor: '#f5f5f5', icon: '' }\n    }\n\n    // Si toutes les questions sont NE explicites, afficher \"NE\"\n    if (questionsNEExplicites === ex.questions.length) {\n      return { niveau: 'NE', couleur: '#9c27b0', bgColor: '#f3e5f5' }\n    }\n\n    // Si toutes les questions sont NR, afficher \"NR\"\n    if (questionsNR === ex.questions.length) {\n      return { niveau: 'NR', couleur: '#757575', bgColor: '#f5f5f5' }\n    }\n\n    // Calculer le niveau bas sur les points obtenus\n    const exercicePoints = calculateExercicePoints(studentId, exerciceIndex)\n    \n    if (exercicePoints.totaux === 0) {\n      return { niveau: 'NE', couleur: '#9c27b0', bgColor: '#f3e5f5' }\n    }\n    \n    const pourcentage = (exercicePoints.obtenus / exercicePoints.totaux) * 100\n    \n    if (pourcentage >= seuilTBM) {\n      return { niveau: 'TBM', couleur: '#4caf50', bgColor: '#e8f5e9' }\n    } else if (pourcentage >= seuilMS) {\n      return { niveau: 'MS', couleur: '#2196f3', bgColor: '#e3f2fd' }\n    } else if (pourcentage >= seuilMF) {\n      return { niveau: 'MF', couleur: '#ff9800', bgColor: '#fff3e0' }\n    } else {\n      return { niveau: 'MI', couleur: '#f44336', bgColor: '#ffebee' }\n    }\n  }\n\n  // Calculer le niveau de matrise (en pourcentage)\n  function getNiveauMaitrise(pointsObtenus: number, pointsTotaux: number): { niveau: string, couleur: string, bgColor: string, pourcentage: number } {\n    if (pointsTotaux === 0) {\n      return { niveau: 'Non valu', couleur: '#bdbdbd', bgColor: '#f5f5f5', pourcentage: 0 }\n    }\n    \n    // Calculer le pourcentage bas sur les points\n    const pourcentage = (pointsObtenus / pointsTotaux) * 100\n    \n    if (pourcentage >= seuilTBM) {  // TBM :  seuil configur\n      return { \n        niveau: 'TBM - Trs Bonne Matrise', \n        couleur: '#4caf50', \n        bgColor: '#e8f5e9',\n        pourcentage\n      }\n    } else if (pourcentage >= seuilMS) {  // MS :  seuil configur\n      return { \n        niveau: 'MS - Matrise Satisfaisante', \n        couleur: '#2196f3', \n        bgColor: '#e3f2fd',\n        pourcentage\n      }\n    } else if (pourcentage >= seuilMF) {  // MF :  seuil configur\n      return { \n        niveau: 'MF - Matrise Fragile', \n        couleur: '#ff9800', \n        bgColor: '#fff3e0',\n        pourcentage\n      }\n    } else {  // MI : < seuil configur\n      return { \n        niveau: 'MI - Matrise Insuffisante', \n        couleur: '#f44336', \n        bgColor: '#ffebee',\n        pourcentage\n      }\n    }\n  }\n\n  // Calculer les comptences d'un lve (retourne le niveau avec pourcentage)\n  function calculateCompetences(studentId: string): { [competence: string]: { niveau: string, correct: number, total: number, pourcentage: number } } {\n    const studentCorrections = corrections[studentId]\n    \n    // Initialiser uniquement les comptences qui seront utilises\n    const competences: { [competence: string]: { correct: number, total: number } } = {}\n\n    // Ensuite, compter les rponses\n    if (studentCorrections) {\n      evaluationData.forEach(ex => {\n        ex.questions.forEach(q => {\n          const correction = studentCorrections[ex.exerciceIndex]?.[q.questionIndex]\n          const status = correction?.status\n          \n          // Compter toutes les questions avec un statut (TB, TF, NR, NE)\n          if (status) {\n            // Utiliser les comptences de l'exercice si pas de dtail par question\n            const comps = ex.detailParQuestion ? q.competences : ex.competencesExercice\n            \n            console.log('Question value:', q.questionIndex, 'Status:', status, 'Comptences:', comps)\n            console.log('Exercice comptences:', ex.competencesExercice)\n            console.log('Question comptences:', q.competences)\n            console.log('Detail par question:', ex.detailParQuestion)\n            \n            comps.forEach(comp => {\n              const normalizedComp = normalizeCompetenceName(comp)\n              // Crer la comptence si elle n'existe pas\n              if (!competences[normalizedComp]) {\n                competences[normalizedComp] = { correct: 0, total: 0 }\n              }\n              // Compter toutes les questions values (y compris NR/NE)\n                competences[normalizedComp].total++\n                if (status === 'TB') {\n                  competences[normalizedComp].correct++\n                }\n                console.log(`Comptence ${normalizedComp}: ${competences[normalizedComp].correct}/${competences[normalizedComp].total}`)\n            })\n          }\n        })\n      })\n    }\n\n    const result: { [competence: string]: { niveau: string, correct: number, total: number, pourcentage: number } } = {}\n    Object.keys(competences).forEach(comp => {\n      const correct = competences[comp].correct\n      const total = competences[comp].total\n      \n      // Ne retourner que les comptences qui ont t values (total > 0)\n      if (total > 0) {\n        const pourcentage = (correct / total) * 100\n        \n        let niveau = 'mi'\n        if (pourcentage >= 90) {\n          niveau = 'tbm'\n        } else if (pourcentage >= 70) {\n          niveau = 'ms'\n        } else if (pourcentage >= 30) {\n          niveau = 'mf'\n      }\n      \n      result[comp] = { niveau, correct, total, pourcentage }\n      }\n    })\n    return result\n  }\n\n\n  onMount(() => {\n    loadEvaluationData()\n  })\n\n  afterUpdate(() => {\n    if (correctionSection && currentPage === 'correction') {\n      setTimeout(() => {\n        mathaleaRenderDiv(correctionSection)\n      }, 100)\n    }\n  })\n</script>\n\n<main\n  class=\"min-h-screen bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\"Correction\"\n    subtitleType=\"export\"\n    handleLanguage={() => {}}\n    locale={$referentielLocale}\n  />\n  \n  <!-- Systme de notifications toast -->\n  <Toaster />\n\n  <section class=\"px-2 py-2 md:px-4 md:py-3\">\n    {#if currentPage === 'setup'}\n      <!-- PAGE D'IMPORT CSV -->\n      <div class=\"max-w-4xl mx-auto\">\n        <h1\n          class=\"mt-4 mb-4 text-center text-coopmaths-struct dark:text-coopmathsdark-struct text-3xl font-bold\"\n        >\n          Import des lves\n        </h1>\n\n        <div\n          class=\"bg-white dark:bg-coopmathsdark-canvas-dark rounded-lg shadow-lg p-8 mt-8\"\n        >\n          <div class=\"text-center mb-6\">\n            <p class=\"text-coopmaths-corpus dark:text-coopmathsdark-corpus mb-4\">\n              Importez un fichier CSV avec les colonnes : <strong>Nom, Prnom, Sexe</strong>\n            </p>\n            \n            <div class=\"mb-4 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n              <p class=\"text-sm text-green-700 dark:text-green-300\">\n                 <strong>Note :</strong> La liste des lves sera automatiquement sauvegarde et recharge lors de vos prochaines sessions.\n              </p>\n            </div>\n            \n            <div class=\"space-y-4\">\n              <label\n                class=\"inline-block bg-coopmaths-action hover:bg-coopmaths-action-lightest text-white font-bold py-3 px-6 rounded-lg cursor-pointer transition-colors\"\n              >\n                 Choisir un fichier CSV\n                <input\n                  bind:this={csvInput}\n                  type=\"file\"\n                  accept=\".csv\"\n                  on:change={handleFileUpload}\n                  class=\"hidden\"\n                />\n              </label>\n              \n              {#if students.length > 0}\n                <div class=\"mt-4\">\n                  <p class=\"text-sm text-coopmaths-corpus dark:text-coopmathsdark-corpus mb-2\">\n                     {students.length} lve(s) en mmoire\n                  </p>\n                  <button\n                    on:click={resetStudentsList}\n                    class=\"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-colors\"\n                  >\n                     Rinitialiser la liste\n                  </button>\n                </div>\n              {/if}\n            </div>\n          </div>\n\n          {#if evaluationData.length > 0}\n            <div class=\"mt-6 p-4 bg-blue-50 dark:bg-blue-900 rounded-lg\">\n              <p class=\"font-bold mb-2 text-blue-800 dark:text-blue-200\">\n                 valuation charge :\n              </p>\n              <ul class=\"text-sm text-blue-700 dark:text-blue-300 space-y-1\">\n                <li> {evaluationData.length} exercice(s)</li>\n                <li> Total : {getTotalPoints()} points</li>\n              </ul>\n            </div>\n          {/if}\n        </div>\n      </div>\n\n    {:else if currentPage === 'overview'}\n      <!-- VUE D'ENSEMBLE DES LVES -->\n      <div class=\"w-full px-4\">\n        <div class=\"flex justify-between items-center mb-6\">\n          <h1\n            class=\"text-center text-coopmaths-struct dark:text-coopmathsdark-struct text-3xl font-bold\"\n          >\n            Vue d'ensemble - {students.length} lve(s)\n          </h1>\n          <div class=\"flex gap-3\">\n            <!-- Bouton de basculement des modes d'affichage -->\n            <div class=\"flex items-center gap-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-800\">\n              <span class=\"text-sm font-semibold text-blue-700 dark:text-blue-300\">Mode:</span>\n              <button\n                on:click={() => modeAffichageCartes = 'classique'}\n                class=\"px-3 py-1 rounded-md text-sm font-semibold transition-all {modeAffichageCartes === 'classique' \n                  ? 'bg-blue-500 text-white shadow-md' \n                  : 'bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600'}\"\n              >\n                 Classique\n              </button>\n              <button\n                on:click={() => modeAffichageCartes = 'dnb'}\n                class=\"px-3 py-1 rounded-md text-sm font-semibold transition-all {modeAffichageCartes === 'dnb' \n                  ? 'bg-blue-500 text-white shadow-md' \n                  : 'bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600'}\"\n              >\n                 DNB\n              </button>\n            </div>\n          <button\n            on:click={resetStudentsList}\n            class=\"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-colors\"\n            title=\"Rinitialiser la liste des lves\"\n          >\n             Rinitialiser\n          </button>\n          </div>\n        </div>\n\n        <!-- Bilan de la classe -->\n        {#if students.length > 0}\n          {@const classStats = calculateClassStats()}\n          <div class=\"mb-6 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl shadow-lg border border-blue-200 dark:border-blue-800 p-4\">\n            <div class=\"flex flex-wrap items-center justify-between gap-4\">\n              <!-- Statistiques des notes -->\n              <div class=\"flex items-center gap-6\">\n                <div class=\"flex items-center gap-2\">\n                  <div class=\"flex flex-col items-center justify-center bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg px-4 py-2 text-white shadow-md\">\n                    <div class=\"text-sm font-medium opacity-90\">Moyenne</div>\n                    <div class=\"text-3xl font-bold\">{formatNote(classStats.moyenneClasse)}</div>\n                    <div class=\"text-sm opacity-75\">/{formatNote(classStats.totalPoints)}</div>\n                    {#if classStats.nbCopiesCorrigees > 0}\n                      <div class=\"text-xs opacity-60\">({classStats.nbCopiesCorrigees} copie{classStats.nbCopiesCorrigees > 1 ? 's' : ''} corrige{classStats.nbCopiesCorrigees > 1 ? 's' : ''})</div>\n                    {/if}\n                  </div>\n                </div>\n                \n                <div class=\"flex flex-col gap-1\">\n                  <div class=\"flex items-center gap-3 text-sm\">\n                    <span class=\"text-gray-600 dark:text-gray-400 w-12 font-medium\">Min:</span>\n                    <span class=\"font-bold text-red-600 dark:text-red-400 text-lg\">{formatNote(classStats.noteMin)}</span>\n                  </div>\n                  <div class=\"flex items-center gap-3 text-sm\">\n                    <span class=\"text-gray-600 dark:text-gray-400 w-12 font-medium\">Md:</span>\n                    <span class=\"font-bold text-blue-600 dark:text-blue-400 text-lg\">{formatNote(classStats.mediane)}</span>\n                  </div>\n                  <div class=\"flex items-center gap-3 text-sm\">\n                    <span class=\"text-gray-600 dark:text-gray-400 w-12 font-medium\">Max:</span>\n                    <span class=\"font-bold text-green-600 dark:text-green-400 text-lg\">{formatNote(classStats.noteMax)}</span>\n                  </div>\n                </div>\n                \n                <div class=\"h-10 w-px bg-gray-300 dark:bg-gray-600\"></div>\n                \n                <div class=\"flex items-center gap-4\">\n                  <div class=\"flex items-center gap-1.5\">\n                    <div class=\"w-4 h-4 rounded-full bg-green-500\"></div>\n                    <span class=\"text-lg font-bold text-gray-700 dark:text-gray-300\">{classStats.nbTermines}</span>\n                    <span class=\"text-sm text-gray-500 dark:text-gray-400 font-medium\">termin(s)</span>\n                  </div>\n                  <div class=\"flex items-center gap-1.5\">\n                    <div class=\"w-4 h-4 rounded-full bg-orange-500\"></div>\n                    <span class=\"text-lg font-bold text-gray-700 dark:text-gray-300\">{classStats.nbEnCours}</span>\n                    <span class=\"text-sm text-gray-500 dark:text-gray-400 font-medium\">en cours</span>\n                  </div>\n                  <div class=\"flex items-center gap-1.5\">\n                    <div class=\"w-4 h-4 rounded-full bg-gray-400\"></div>\n                    <span class=\"text-lg font-bold text-gray-700 dark:text-gray-300\">{classStats.nbNonCommences}</span>\n                    <span class=\"text-sm text-gray-500 dark:text-gray-400 font-medium\">non commenc(s)</span>\n                  </div>\n                </div>\n              </div>\n              \n              <!-- Statistiques des comptences -->\n              {#if modeEvaluation !== 'notes' && Object.keys(classStats.competencesStats).length > 0}\n                <div class=\"h-10 w-px bg-gray-300 dark:bg-gray-600 hidden lg:block\"></div>\n                \n                <div class=\"flex items-center gap-3 flex-wrap\">\n                  <span class=\"text-sm font-bold text-gray-600 dark:text-gray-400\">Comptences:</span>\n                  {#each Object.entries(classStats.competencesStats).slice(0, 4) as [comp, data]}\n                    <div \n                      class=\"px-3 py-1.5 rounded-lg text-sm font-bold text-white flex items-center gap-1.5 shadow-sm\"\n                      style=\"background: {data.couleur};\"\n                      title=\"{comp}: {data.pourcentage.toFixed(0)}% - {data.niveau}\"\n                    >\n                      <span class=\"text-base\">{getCompetenceIcon(comp)}</span>\n                      <span>{comp.length > 8 ? comp.substring(0, 8) + '...' : comp}</span>\n                      <span class=\"opacity-90 text-base\">{data.pourcentage.toFixed(0)}%</span>\n                    </div>\n                  {/each}\n                  {#if Object.keys(classStats.competencesStats).length > 4}\n                    <span class=\"text-sm font-medium text-gray-500 dark:text-gray-400\">+{Object.keys(classStats.competencesStats).length - 4}</span>\n                  {/if}\n                </div>\n              {/if}\n            </div>\n          </div>\n        {/if}\n\n        <!-- Boutons d'export et impression -->\n        {#if students.length > 0}\n          <div class=\"mb-6 flex gap-3 justify-center\">\n            <button\n              on:click={imprimerBilanClasse}\n              class=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md transition-colors flex items-center gap-2\"\n              title=\"Imprimer le bilan de la classe\"\n            >\n               Imprimer bilan classe\n            </button>\n            <button\n              on:click={imprimerBilansIndividuels}\n              class=\"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-semibold rounded-lg shadow-md transition-colors flex items-center gap-2\"\n              title=\"Imprimer tous les bilans individuels\"\n            >\n               Imprimer bilans individuels\n            </button>\n            <button\n              on:click={exportJSON}\n              class=\"px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg shadow-md transition-colors flex items-center gap-2\"\n              title=\"Exporter toutes les donnes en JSON\"\n            >\n               Exporter JSON\n            </button>\n          </div>\n        {/if}\n\n        <!-- Barre de recherche intelligente -->\n        <div class=\"mb-6\">\n          <div class=\"relative max-w-md mx-auto\">\n            <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n              <svg class=\"h-5 w-5 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"></path>\n              </svg>\n            </div>\n            <input\n              type=\"text\"\n              bind:value={searchQuery}\n              placeholder=\"Rechercher un lve (nom, prnom, initiales, sexe...)\"\n              class=\"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all\"\n            />\n            {#if searchQuery}\n              <button\n                on:click={() => searchQuery = ''}\n                class=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors\"\n                title=\"Effacer la recherche\"\n              >\n                <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"></path>\n                </svg>\n              </button>\n            {/if}\n          </div>\n          {#if searchQuery}\n            <p class=\"text-center text-sm text-gray-600 dark:text-gray-400 mt-2\">\n              {filteredStudents.length} lve(s) trouv(s) sur {students.length}\n            </p>\n          {/if}\n        </div>\n\n        <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-4\">\n          {#each filteredStudents as student, index (student.id)}\n            {@const studentIndex = students.findIndex(s => s.id === student.id)}\n            {@const score = calculateStudentScore(student.id)}\n            {@const totalPoints = getTotalPoints()}\n            {@const competencesStudent = calculateCompetences(student.id)}\n            {@const statsNRNE = countQuestionsNRNE(student.id)}\n            {@const totalQuestions = evaluationData.reduce((sum, ex) => sum + ex.questions.length, 0)}\n            {@const correctedQuestions = countCorrectedQuestions(student.id)}\n            {@const niveauGlobal = getNiveauMaitriseAvecNonCorrige(score.correct, score.total, correctedQuestions)}\n            {@const isFullyCorrected = correctedQuestions === totalQuestions && totalQuestions > 0}\n            {@const hasComments = !!(corrections[student.id]?.commentaire?.trim()?.length)}\n            \n            {#if modeAffichageCartes === 'classique'}\n            <!-- Carte simple et fonctionnelle (MODE CLASSIQUE) -->\n            <div class=\"relative bg-white dark:bg-coopmathsdark-canvas-dark rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-200 dark:border-gray-600 overflow-hidden\">\n              \n              <!-- Point de statut en bas  droite -->\n              <div \n                class=\"absolute bottom-2 right-2 w-3 h-3 rounded-full z-10 {isFullyCorrected ? 'bg-green-500' : correctedQuestions > 0 ? 'bg-orange-500' : 'bg-gray-400'}\"\n                title=\"{isFullyCorrected ? 'Termin' : correctedQuestions > 0 ? 'En cours' : 'Non commenc'}\"\n              ></div>\n\n              <button\n                on:click={() => startCorrection(index)}\n                class=\"w-full p-3 text-left hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors\"\n              >\n                <!-- En-tte avec nom et score -->\n                <div class=\"flex justify-between items-start mb-2\">\n                  <div class=\"pl-8\">\n                    <h3 class=\"text-lg font-bold text-gray-800 dark:text-white\">\n                      {student.nom}\n                  </h3>\n                    <p class=\"text-base font-semibold {getGenreColor(student.sexe)}\">\n                      {student.prenom}\n                    </p>\n                  </div>\n                  \n                  <!-- Score principal -->\n                  <div \n                    class=\"px-2 py-1 rounded-lg font-bold text-sm\"\n                    style=\"color: {niveauGlobal.couleur}; background: {niveauGlobal.bgColor};\"\n                  >\n                    {score.correct}/{score.total}\n                  </div>\n                </div>\n\n                <!-- Badges des exercices en ligne -->\n                 <div class=\"flex flex-wrap gap-1 mb-2\">\n                   {#each evaluationData as ex, exIndex}\n                     {@const exerciceNiveau = overviewBadges[studentIndex] ? overviewBadges[studentIndex][exIndex] : { niveau: 'NE', couleur: '#bdbdbd', bgColor: '#f5f5f5' }}\n                     {@const exercicePoints = calculateExercicePoints(student.id, exIndex)}\n                     <div \n                       class=\"px-2 py-1 rounded text-xs font-bold text-white flex items-center gap-1\"\n                       style=\"background: {exerciceNiveau.couleur};\"\n                       title=\"Exercice {exIndex + 1}: {exercicePoints.obtenus}/{exercicePoints.totaux} points - {exerciceNiveau.niveau}\"\n                     >\n                       <span class=\"text-xs\">{getExerciceIcon(exIndex)}</span>\n                       <span>Ex{exIndex + 1}: {exercicePoints.obtenus}/{exercicePoints.totaux}</span>\n                     </div>\n                   {/each}\n                </div>\n\n                <!-- Comptences (si mode comptence) -->\n                {#if modeEvaluation !== 'notes' && Object.keys(competencesStudent).length > 0}\n                  <div class=\"grid grid-cols-2 gap-1 mb-2\">\n                    {#each Object.entries(competencesStudent) as [comp, compData]}\n                      {@const colorInfo = compData.niveau === 'tbm' ? { couleur: '#4caf50', label: 'TBM', fullLabel: 'Trs Bonne Matrise' } :\n                                         compData.niveau === 'ms' ? { couleur: '#2196f3', label: 'MS', fullLabel: 'Matrise Satisfaisante' } :\n                                         compData.niveau === 'mf' ? { couleur: '#ff9800', label: 'MF', fullLabel: 'Matrise Fragile' } :\n                                         compData.niveau === 'mi' ? { couleur: '#f44336', label: 'MI', fullLabel: 'Matrise Insuffisante' } :\n                                         { couleur: '#9c27b0', label: 'NE', fullLabel: 'Non valu' }}\n                      <div class=\"flex items-center gap-1 px-1 py-1 rounded-lg bg-gray-100 dark:bg-gray-700 text-xs\">\n                        <div \n                          class=\"px-2 py-1 rounded-full flex items-center justify-center font-bold text-xs text-white flex-shrink-0\"\n                          style=\"background: {colorInfo.couleur};\"\n                          title=\"{comp}: {compData.correct}/{compData.total} - {colorInfo.fullLabel}\"\n                        >\n                          {colorInfo.label}\n                        </div>\n                        <span class=\"text-sm\">{getCompetenceIcon(comp)}</span>\n                        <span class=\"text-xs text-gray-700 dark:text-gray-300 font-medium truncate\">{comp.length > 6 ? comp.substring(0, 6) + '...' : comp}</span>\n                        <span class=\"text-xs text-gray-500 dark:text-gray-400\">({compData.correct}/{compData.total})</span>\n                      </div>\n                    {/each}\n                  </div>\n                {/if}\n\n                <!-- Footer avec compteur -->\n                <div class=\"text-center text-xs text-gray-500 dark:text-gray-400\">\n                  {correctedQuestions}/{totalQuestions} questions\n                </div>\n              </button>\n\n              <!-- Icne commentaire en haut  gauche -->\n              {#if hasComments}\n                <div \n                  class=\"absolute top-1 left-1 w-5 h-5 bg-blue-500 hover:bg-blue-600 rounded-full flex items-center justify-center text-white cursor-help text-xs z-10 transition-colors group\"\n                  title={corrections[student.id].commentaire}\n                  data-tooltip={corrections[student.id].commentaire}\n                >\n                  \n                  <!-- Tooltip personnalis -->\n                  <div class=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-20 max-w-xs\">\n                    <div class=\"whitespace-pre-wrap\">{corrections[student.id].commentaire}</div>\n                    <!-- Flche du tooltip -->\n                    <div class=\"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900\"></div>\n                  </div>\n                </div>\n              {/if}\n\n              <!-- Bouton reset en bas  gauche -->\n              <button\n                on:click|stopPropagation={() => resetStudentCorrection(student.id)}\n                class=\"absolute bottom-2 left-2 w-6 h-6 bg-red-500 hover:bg-red-600 text-white rounded-full text-xs transition-colors z-10 flex items-center justify-center\"\n                title=\"Rinitialiser\"\n              >\n                \n              </button>\n            </div>\n\n            {:else}\n            <!-- Carte style DNB (MODE DNB - TEST) -->\n            <div class=\"relative bg-gradient-to-br from-white to-gray-50 dark:from-coopmathsdark-canvas-dark dark:to-gray-900 rounded-xl shadow-xl hover:shadow-2xl transition-all duration-300 border-2 border-gray-300 dark:border-gray-600 overflow-hidden\">\n              \n              <!-- Bande colore en haut selon le niveau global -->\n              <div \n                class=\"h-2 w-full\"\n                style=\"background: {niveauGlobal.couleur};\"\n              ></div>\n\n              <button\n                on:click={() => startCorrection(index)}\n                class=\"w-full p-4 text-left hover:bg-white/50 dark:hover:bg-gray-800/50 transition-colors\"\n              >\n                <!-- En-tte avec nom et statut -->\n                <div class=\"flex justify-between items-center mb-3\">\n                  <div class=\"flex-1\">\n                    <h3 class=\"text-xl font-bold text-gray-900 dark:text-white mb-0.5\">\n                      {student.nom}\n                    </h3>\n                    <p class=\"text-base font-semibold {getGenreColor(student.sexe)}\">\n                      {student.prenom}\n                    </p>\n                  </div>\n                  \n                  <!-- Indicateur de progression circulaire -->\n                  <div class=\"relative w-16 h-16 flex-shrink-0\">\n                    <svg class=\"w-16 h-16 transform -rotate-90\" viewBox=\"0 0 36 36\">\n                      <!-- Cercle de fond -->\n                      <circle \n                        cx=\"18\" \n                        cy=\"18\" \n                        r=\"15.5\" \n                        fill=\"none\" \n                        stroke=\"currentColor\" \n                        stroke-width=\"2.5\" \n                        class=\"text-gray-200 dark:text-gray-700\"\n                      />\n                      <!-- Cercle de progression -->\n                      <circle \n                        cx=\"18\" \n                        cy=\"18\" \n                        r=\"15.5\" \n                        fill=\"none\" \n                        stroke=\"{niveauGlobal.couleur}\" \n                        stroke-width=\"2.5\" \n                        stroke-dasharray=\"{(score.correct / score.total * 97.4).toFixed(1)}, 97.4\"\n                        stroke-linecap=\"round\"\n                      />\n                    </svg>\n                    <!-- Score au centre - Centr verticalement -->\n                    <div class=\"absolute inset-0 flex items-center justify-center\">\n                      <div class=\"text-center\">\n                        <div class=\"text-lg font-bold\" style=\"color: {niveauGlobal.couleur};\">\n                          {score.correct}\n                        </div>\n                        <div class=\"text-sm text-gray-600 dark:text-gray-400 font-semibold\">/{score.total}</div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <!-- Badge du niveau de matrise -->\n                <div class=\"mb-3 flex justify-center\">\n                  <div \n                    class=\"px-4 py-1.5 rounded-full font-bold text-sm text-white shadow-md\"\n                    style=\"background: {niveauGlobal.couleur};\"\n                  >\n                    {niveauGlobal.niveau}\n                  </div>\n                </div>\n\n                <!-- Badges des exercices -->\n                <div class=\"flex flex-wrap gap-1 mb-3 justify-center\">\n                  {#each evaluationData as ex, exIndex}\n                    {@const exerciceNiveau = overviewBadges[studentIndex] ? overviewBadges[studentIndex][exIndex] : { niveau: 'NE', couleur: '#bdbdbd', bgColor: '#f5f5f5' }}\n                    {@const exercicePoints = calculateExercicePoints(student.id, exIndex)}\n                    <div \n                      class=\"px-2 py-1 rounded-lg text-xs font-bold text-white flex items-center gap-1 shadow-sm\"\n                      style=\"background: {exerciceNiveau.couleur};\"\n                      title=\"Exercice {exIndex + 1}: {exercicePoints.obtenus}/{exercicePoints.totaux} points - {exerciceNiveau.niveau}\"\n                    >\n                      <span class=\"text-xs\">{getExerciceIcon(exIndex)}</span>\n                      <span>Ex{exIndex + 1}: {exercicePoints.obtenus}/{exercicePoints.totaux}</span>\n            </div>\n          {/each}\n        </div>\n\n                <!-- Comptences en grille 2 colonnes (si mode comptence) -->\n                {#if modeEvaluation !== 'notes' && Object.keys(competencesStudent).length > 0}\n                  <div class=\"grid grid-cols-2 gap-1.5 mb-3\">\n                    {#each Object.entries(competencesStudent).slice(0, 4) as [comp, compData]}\n                      {@const colorInfo = compData.niveau === 'tbm' ? { couleur: '#4caf50', label: 'TBM', fullLabel: 'Trs Bonne Matrise' } :\n                                         compData.niveau === 'ms' ? { couleur: '#2196f3', label: 'MS', fullLabel: 'Matrise Satisfaisante' } :\n                                         compData.niveau === 'mf' ? { couleur: '#ff9800', label: 'MF', fullLabel: 'Matrise Fragile' } :\n                                         compData.niveau === 'mi' ? { couleur: '#f44336', label: 'MI', fullLabel: 'Matrise Insuffisante' } :\n                                         { couleur: '#9c27b0', label: 'NE', fullLabel: 'Non valu' }}\n                      <div class=\"flex items-center gap-1.5 p-1.5 rounded-lg bg-white/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700\">\n                        <div \n                          class=\"px-1.5 py-0.5 rounded-full flex items-center justify-center font-bold text-white text-xs flex-shrink-0 shadow-sm\"\n                          style=\"background: {colorInfo.couleur};\"\n                          title=\"{colorInfo.fullLabel}\"\n                        >\n                          {colorInfo.label}\n                        </div>\n                        <div class=\"flex-1 min-w-0\">\n                          <div class=\"flex items-center gap-1\">\n                            <span class=\"text-xs\">{getCompetenceIcon(comp)}</span>\n                            <span class=\"text-xs font-semibold text-gray-800 dark:text-gray-200 truncate\">{comp.length > 12 ? comp.substring(0, 12) + '...' : comp}</span>\n                          </div>\n                        </div>\n                        <div class=\"text-xs font-bold\" style=\"color: {colorInfo.couleur};\">\n                          {compData.correct}/{compData.total}\n                        </div>\n                      </div>\n                    {/each}\n                    {#if Object.keys(competencesStudent).length > 4}\n                      <div class=\"col-span-2 text-center\">\n                        <p class=\"text-xs text-gray-500 dark:text-gray-400\">\n                          +{Object.keys(competencesStudent).length - 4} autre(s)\n                        </p>\n                      </div>\n                    {/if}\n                  </div>\n                {/if}\n\n                <!-- Statistiques intgres en bas -->\n                <div class=\"flex justify-center items-center mt-3 pt-2 border-t border-gray-200 dark:border-gray-700\">\n                  <div class=\"text-xs text-gray-600 dark:text-gray-400\">\n                    <span class=\"font-semibold\">{correctedQuestions}</span>/{totalQuestions} questions\n                  </div>\n                </div>\n              </button>\n              \n              <!-- Point de statut discret - Position fixe en bas  droite -->\n              <div \n                class=\"absolute bottom-2 right-2 w-3 h-3 rounded-full z-10 {isFullyCorrected ? 'bg-green-500' : correctedQuestions > 0 ? 'bg-orange-500' : 'bg-gray-400'}\"\n                title=\"{isFullyCorrected ? 'Termin' : correctedQuestions > 0 ? 'En cours' : 'Non commenc'}\"\n              ></div>\n\n              <!-- Icne commentaire (si prsent) - Position ajuste -->\n              {#if hasComments}\n                <div \n                  class=\"absolute top-2 left-2 w-6 h-6 bg-blue-500 hover:bg-blue-600 rounded-full flex items-center justify-center text-white cursor-help text-xs z-10 transition-all shadow-lg group\"\n                  title={corrections[student.id].commentaire}\n                >\n                  \n                  <!-- Tooltip -->\n                  <div class=\"absolute bottom-full left-0 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-20 max-w-xs whitespace-pre-wrap\">\n                    {corrections[student.id].commentaire}\n                    <div class=\"absolute top-full left-4 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900\"></div>\n                  </div>\n                </div>\n              {/if}\n\n              <!-- Bouton reset en bas  gauche -->\n              <button\n                on:click|stopPropagation={() => resetStudentCorrection(student.id)}\n                class=\"absolute bottom-2 left-2 w-6 h-6 bg-red-500 hover:bg-red-600 text-white rounded-full text-xs transition-all shadow-md z-10 flex items-center justify-center hover:scale-110\"\n                title=\"Rinitialiser la correction\"\n              >\n                \n              </button>\n            </div>\n            {/if}\n          {/each}\n        </div>\n      </div>\n\n    {:else if currentPage === 'correction'}\n      <!-- INTERFACE DE CORRECTION AVEC ONGLETS -->\n      {@const currentStudent = students[currentStudentIndex]}\n      \n      <div bind:this={correctionSection} class=\"w-full min-h-[calc(100vh-70px)] pb-4 px-6 xl:px-12\">\n        <!-- En-tte avec navigation -->\n        <div class=\"flex justify-between items-center mb-1\">\n          <button\n            on:click={backToOverview}\n            class=\"px-3 py-1 bg-gray-500 hover:bg-gray-600 text-white rounded text-sm\"\n          >\n             Retour  la liste\n          </button>\n          \n          <div class=\"flex gap-2\">\n            <button\n              on:click={modifierCompetences}\n              class=\"px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded text-sm\"\n            >\n               Modifier les comptences\n            </button>\n            <button\n              on:click={reinitialiserCompetences}\n              class=\"px-3 py-1 bg-green-500 hover:bg-green-600 text-white rounded text-sm\"\n            >\n               Rinitialiser\n            </button>\n            {#if toutesQuestionsEvaluees}\n              <button\n                on:click={() => showSummaryModal = true}\n                class=\"px-3 py-1 bg-purple-500 hover:bg-purple-600 text-white rounded font-semibold text-sm\"\n              >\n                 Valider la correction\n              </button>\n            {/if}\n          </div>\n          \n          <div class=\"text-center\">\n            <h1\n              class=\"text-xl font-bold text-coopmaths-struct dark:text-coopmathsdark-struct\"\n            >\n              {currentStudent.nom} {currentStudent.prenom}\n            </h1>\n            <div class=\"flex items-center justify-center gap-3 mt-1\">\n              <!-- Note X/Y -->\n              {#if toutesQuestionsEvaluees}\n                <div \n                  class=\"px-3 py-1 rounded-lg font-bold text-base\"\n                  style=\"color: {niveauMaitrise.couleur}; background: {niveauMaitrise.bgColor};\"\n                >\n                  {studentScoreData.correct}/{studentScoreData.total} ({niveauMaitrise.pourcentage.toFixed(0)}%) - {niveauMaitrise.niveau}\n                </div>\n              {:else if studentScoreData.total > 0}\n                <div class=\"px-3 py-1 rounded-lg bg-blue-50 text-blue-700 text-sm font-semibold\">\n                  {studentScoreData.correct}/{studentScoreData.total} ({niveauMaitrise.pourcentage.toFixed(0)}%)\n                </div>\n              {:else}\n                <div class=\"px-3 py-1 rounded-lg bg-gray-100 text-gray-600 text-sm\">\n                  Aucune question value\n                </div>\n              {/if}\n\n              <!-- Comptences en haut -->\n              {#if modeEvaluation !== 'notes' && Object.keys(competences).length > 0}\n                <div class=\"flex flex-wrap gap-1\">\n                  {#each Object.entries(competences) as [comp, compData]}\n                    {@const colorInfo = compData.niveau === 'tbm' ? { couleur: '#4caf50', bgColor: '#e8f5e9', label: 'TBM', fullLabel: 'Trs Bonne Matrise' } :\n                                       compData.niveau === 'ms' ? { couleur: '#2196f3', bgColor: '#e3f2fd', label: 'MS', fullLabel: 'Matrise Satisfaisante' } :\n                                       compData.niveau === 'mf' ? { couleur: '#ff9800', bgColor: '#fff3e0', label: 'MF', fullLabel: 'Matrise Fragile' } :\n                                       compData.niveau === 'mi' ? { couleur: '#f44336', bgColor: '#ffebee', label: 'MI', fullLabel: 'Matrise Insuffisante' } :\n                                       { couleur: '#9c27b0', bgColor: '#f3e5f5', label: 'NE', fullLabel: 'Non valu' }}\n                    <div class=\"flex items-center gap-1\">\n                      <div \n                        class=\"px-2 py-1 rounded-full flex items-center justify-center font-bold text-xs text-white\"\n                        style=\"background: {colorInfo.couleur};\"\n                        title=\"{colorInfo.fullLabel}\"\n                      >\n                        {colorInfo.label}\n                      </div>\n                      <span class=\"text-xs\">{getCompetenceIcon(comp)}</span>\n                      <span class=\"text-xs font-medium\">{comp}</span>\n                    </div>\n                  {/each}\n                </div>\n              {/if}\n            </div>\n          </div>\n\n          <div class=\"text-right\">\n            <p class=\"text-sm text-gray-600\">lve {currentStudentIndex + 1} / {students.length}</p>\n          </div>\n        </div>\n\n        <!-- Onglets des exercices avec layout en colonnes -->\n        <div class=\"grid grid-cols-1 lg:grid-cols-5 gap-4 mb-3\">\n          <!-- Sidebar avec onglets -->\n          <div class=\"lg:col-span-1\">\n            <div class=\"bg-white dark:bg-coopmathsdark-canvas-dark rounded-lg shadow-lg p-3\">\n              <h3 class=\"font-semibold text-lg mb-2 text-coopmaths-struct dark:text-coopmathsdark-struct\">\n                  Exercices\n                </h3>\n                <nav class=\"space-y-1\" aria-label=\"Tabs\">\n                {#each evaluationData as ex, exIndex}\n                  {@const exerciceNiveau = exercicesBadges[exIndex] || { niveau: 'NE', couleur: '#bdbdbd', bgColor: '#f5f5f5' }}\n                  <button\n                    on:click={() => currentExerciceIndex = exIndex}\n                    class=\"w-full text-left py-2 px-3 rounded-lg font-medium text-sm transition-colors border-l-4 {\n                      exerciceNiveau.niveau === 'TBM' ? 'bg-green-100 hover:bg-green-200' \n                      : exerciceNiveau.niveau === 'MS' ? 'bg-blue-100 hover:bg-blue-200'\n                      : exerciceNiveau.niveau === 'MF' ? 'bg-orange-100 hover:bg-orange-200'\n                      : exerciceNiveau.niveau === 'MI' ? 'bg-red-100 hover:bg-red-200'\n                      : exerciceNiveau.niveau === 'NR' ? 'bg-gray-200 hover:bg-gray-300'\n                      : exerciceNiveau.niveau === 'NE' ? 'bg-purple-100 hover:bg-purple-200'\n                      : exerciceNiveau.niveau === ' corriger' ? 'bg-gray-100 hover:bg-gray-200'\n                      : exerciceNiveau.niveau === 'En cours' ? 'bg-gray-100 hover:bg-gray-200'\n                      : 'bg-gray-100 hover:bg-gray-200'\n                    } {currentExerciceIndex === exIndex ? 'ring-2 ring-blue-500 ring-inset font-bold' : ''}\"\n                    style=\"border-left-color: {exerciceNiveau.couleur};\"\n                  >\n                    <div class=\"flex items-center justify-between\">\n                      <div class=\"flex items-center gap-2\">\n                        <span class=\"font-bold text-lg\">#{exIndex + 1}</span>\n                        <div class=\"font-semibold\">{ex.titre}</div>\n                      </div>\n                      <span class=\"text-xs font-bold px-2 py-1 rounded-full text-white flex items-center gap-1\" style=\"background: {exerciceNiveau.couleur};\">\n                        {#if exerciceNiveau.icon}\n                          <span>{exerciceNiveau.icon}</span>\n                        {/if}\n                        {exerciceNiveau.niveau}\n                      </span>\n                    </div>\n                    <div class=\"text-xs mt-0.5 opacity-75\">\n                      {ex.questions.length}Q - {ex.totalPoints}pts\n                    </div>\n                  </button>\n                {/each}\n              </nav>\n            </div>\n          </div>\n\n          <!-- Contenu principal -->\n          <div class=\"lg:col-span-4\">\n            <div class=\"bg-white dark:bg-coopmathsdark-canvas-dark rounded-lg shadow-lg p-4\">\n            {#if evaluationData[currentExerciceIndex]}\n              {@const currentEx = evaluationData[currentExerciceIndex]}\n              \n              <!-- En-tte de l'exercice -->\n              <div class=\"mb-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg\">\n                <div class=\"flex items-center justify-between flex-wrap gap-3\">\n                <h2 class=\"text-lg font-bold text-coopmaths-struct dark:text-coopmathsdark-struct\">\n                  {currentEx.titre}\n                </h2>\n                  <div class=\"text-sm text-gray-600 dark:text-gray-400\">\n                    {currentEx.questions.length} question(s) - {currentEx.totalPoints} points\n                  </div>\n                  <div class=\"flex gap-2\">\n                    {#each currentEx.competencesExercice as comp}\n                      <span class=\"px-2 py-1 bg-coopmaths-action text-white text-xs rounded-full flex items-center gap-1\">\n                        <span class=\"text-sm\">{getCompetenceIcon(comp)}</span>\n                        <span>{comp}</span>\n                      </span>\n                    {/each}\n                  </div>\n                  \n                  <!-- Bouton toggle pour afficher/masquer les corrections -->\n                  {#if modeCorrectionsActive}\n                    <div class=\"flex items-center gap-2\">\n                      {#if loadingCorrections}\n                        <div class=\"px-3 py-1.5 bg-yellow-500 text-white rounded-lg text-sm font-semibold flex items-center gap-2\">\n                          <div class=\"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full\"></div>\n                          Chargement...\n                        </div>\n                      {/if}\n                      <button\n                        on:click={() => {\n                          showCorrections = !showCorrections\n                          localStorage.setItem('showCorrections', showCorrections.toString())\n                        }}\n                        class=\"px-3 py-1.5 {showCorrections ? 'bg-blue-500 hover:bg-blue-600' : 'bg-gray-500 hover:bg-gray-600'} text-white rounded-lg text-sm font-semibold transition-all flex items-center gap-2\"\n                        title={showCorrections ? 'Masquer les corrections' : 'Afficher les corrections'}\n                        disabled={loadingCorrections}\n                      >\n                        {showCorrections ? '' : ''}\n                        {showCorrections ? 'Masquer' : 'Afficher'} les corrections\n                      </button>\n                    </div>\n                  {/if}\n                </div>\n              </div>\n\n              <!-- Notification de passage automatique  l'exercice suivant -->\n              {#if showAutoNextMessage}\n                <div class=\"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded-lg text-center animate-pulse\">\n                  <span class=\"font-semibold\"> Passage automatique  l'exercice suivant...</span>\n                </div>\n              {/if}\n\n              <!-- Boutons globaux pour tout l'exercice -->\n              <div class=\"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800\">\n                <div class=\"flex items-center justify-between flex-wrap gap-3\">\n                <h4 class=\"text-sm font-semibold text-blue-800 dark:text-blue-200\">\n                   valuation rapide - Tout l'exercice\n                </h4>\n                <div class=\"flex flex-wrap gap-2\">\n                  <button\n                    on:click={() => updateAllQuestionsStatus(currentExerciceIndex, 'TB')}\n                    class=\"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded font-bold transition-all text-sm\"\n                    title=\"Marquer toutes les questions comme Tout Bon\"\n                  >\n                     TB - Tout Bon\n                  </button>\n                  <button\n                    on:click={() => updateAllQuestionsStatus(currentExerciceIndex, 'TF')}\n                    class=\"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded font-bold transition-all text-sm\"\n                    title=\"Marquer toutes les questions comme Tout Faux\"\n                  >\n                     TF - Tout Faux\n                  </button>\n                  <button\n                    on:click={() => updateAllQuestionsStatus(currentExerciceIndex, 'NR')}\n                    class=\"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded font-bold transition-all text-sm\"\n                    title=\"Marquer toutes les questions comme Non Rendu\"\n                  >\n                     NR - Non Rendu\n                  </button>\n                  <button\n                    on:click={() => updateAllQuestionsStatus(currentExerciceIndex, 'NE')}\n                    class=\"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded font-bold transition-all text-sm\"\n                    title=\"Marquer toutes les questions comme Non valu\"\n                  >\n                     NE - Non valu\n                  </button>\n                </div>\n                </div>\n              </div>\n\n              <!-- Questions de l'exercice -->\n              <div class=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n                {#each currentEx.questions as question, qIndex}\n                  {@const currentStatus = corrections[currentStudent.id]?.[currentExerciceIndex]?.[qIndex]?.status || null}\n                  <div class=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-white dark:bg-gray-800\">\n                    <div class=\"mb-3\">\n                      <h3 class=\"font-semibold text-base mb-3 text-coopmaths-struct dark:text-coopmathsdark-struct\">\n                        Question {question.questionIndex + 1}\n                      </h3>\n                      \n                      <!-- nonc de la question -->\n                      {#if question.enonce && question.enonce !== `Question ${qIndex + 1}`}\n                        <div class=\"mb-2 p-2 bg-gray-50 dark:bg-gray-800 rounded text-coopmaths-corpus dark:text-coopmathsdark-corpus\">\n                          <div class=\"mathalea-question\">{@html question.enonce}</div>\n                        </div>\n                      {:else}\n                        <div class=\"mb-2 p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded text-sm text-gray-600\">\n                          nonc non disponible - Question {question.questionIndex + 1}\n                        </div>\n                      {/if}\n                      \n                      {#if currentEx.detailParQuestion && question.competences.length > 0}\n                        <div class=\"flex gap-1 mb-2\">\n                          {#each question.competences as comp}\n                            <span class=\"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full flex items-center gap-1\">\n                              <span class=\"text-sm\">{getCompetenceIcon(comp)}</span>\n                              <span>{comp}</span>\n                            </span>\n                          {/each}\n                        </div>\n                      {/if}\n                      \n                      <!-- Section de correction (si disponible et mode actif) -->\n                      {#if modeCorrectionsActive && showCorrections && question.correction}\n                        <div class=\"mt-3 p-3 bg-green-50 dark:bg-green-900/20 border-l-4 border-green-500 rounded-r-lg\">\n                          <div class=\"text-sm font-semibold text-green-700 dark:text-green-400 mb-2 flex items-center gap-2\">\n                            <span></span>\n                            <span>Rponse attendue :</span>\n                          </div>\n                          <div class=\"text-sm text-gray-800 dark:text-gray-200 mathalea-question\">\n                            {@html question.correction}\n                          </div>\n                        </div>\n                      {/if}\n                    </div>\n                    \n                    <!-- Section valuation -->\n                    <div class=\"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                    <div class=\"flex justify-between items-center\">\n                      <div class=\"text-sm text-gray-600 dark:text-gray-400\">\n                        valuation :\n                      </div>\n                      <div class=\"flex items-center gap-2\">\n                        <!-- Boutons TB / TF / NR / NE -->\n                        <button\n                          on:click={() => updateQuestionStatus(currentExerciceIndex, qIndex, 'TB')}\n                          class=\"px-3 py-1 rounded text-sm font-bold transition-all {currentStatus === 'TB' ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-green-100'}\"\n                          title=\"Tout Bon\"\n                        >\n                          TB\n                        </button>\n                        <button\n                          on:click={() => updateQuestionStatus(currentExerciceIndex, qIndex, 'TF')}\n                          class=\"px-3 py-1 rounded text-sm font-bold transition-all {currentStatus === 'TF' ? 'bg-red-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-red-100'}\"\n                          title=\"Tout Faux\"\n                        >\n                          TF\n                        </button>\n                        <button\n                          on:click={() => updateQuestionStatus(currentExerciceIndex, qIndex, 'NR')}\n                          class=\"px-2 py-1 rounded text-sm font-bold transition-all {currentStatus === 'NR' ? 'bg-gray-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}\"\n                          title=\"Non Rendu\"\n                        >\n                          NR\n                        </button>\n                        <button\n                          on:click={() => updateQuestionStatus(currentExerciceIndex, qIndex, 'NE')}\n                          class=\"px-2 py-1 rounded text-sm font-bold transition-all {currentStatus === 'NE' ? 'bg-purple-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-purple-100'}\"\n                          title=\"Non valu\"\n                        >\n                          NE\n                        </button>\n                      </div>\n                      </div>\n                    </div>\n                  </div>\n                {/each}\n              </div>\n            {/if}\n            </div>\n          </div>\n        </div>\n\n        \n        <!-- diteur de comptences -->\n        {#if showCompetenceEditor}\n          <div class=\"bg-white dark:bg-coopmathsdark-canvas-dark rounded-lg shadow-lg p-6 mb-6\">\n            <h3 class=\"text-lg font-bold text-coopmaths-struct dark:text-coopmathsdark-struct mb-4\">\n              Activer/Dsactiver les comptences\n            </h3>\n            <div class=\"space-y-4\">\n              {#each competencesPersonnalisees as competence}\n                <div class=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg\">\n                  <span class=\"text-gray-700 dark:text-gray-300\">{competence}</span>\n                  <button\n                    on:click={() => toggleCompetence(competence)}\n                    class=\"px-4 py-2 rounded-lg text-sm font-semibold {competencesActivees[competence] \n                      ? 'bg-green-500 hover:bg-green-600 text-white' \n                      : 'bg-gray-300 hover:bg-gray-400 text-gray-700'}\"\n                  >\n                    {competencesActivees[competence] ? 'Active' : 'Dsactive'}\n                  </button>\n                </div>\n              {/each}\n              <div class=\"flex gap-2 pt-4\">\n                <button\n                  on:click={() => showCompetenceEditor = false}\n                  class=\"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg\"\n                >\n                  Valider\n                </button>\n                <button\n                  on:click={() => showCompetenceEditor = false}\n                  class=\"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg\"\n                >\n                  Annuler\n                </button>\n              </div>\n            </div>\n          </div>\n        {/if}\n\n        <!-- Navigation entre lves -->\n        <div class=\"flex justify-between\">\n          <button\n            on:click={() => startCorrection(Math.max(0, currentStudentIndex - 1))}\n            disabled={currentStudentIndex === 0}\n            class=\"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n             lve prcdent\n          </button>\n          \n          <button\n            on:click={() => startCorrection(Math.min(students.length - 1, currentStudentIndex + 1))}\n            disabled={currentStudentIndex === students.length - 1}\n            class=\"px-6 py-3 bg-coopmaths-action hover:bg-coopmaths-action-lightest text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            lve suivant \n          </button>\n        </div>\n      </div>\n    {/if}\n\n\n  </section>\n\n  <footer class=\"mt-auto\">\n    <Footer />\n  </footer>\n</main>\n\n\n\n<!-- Modal de rsum de l'lve -->\n{#if showSummaryModal}\n  <div class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n    <div class=\"bg-white dark:bg-coopmathsdark-canvas-dark rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto\">\n      <div class=\"p-6\">\n        <!-- En-tte de la modale -->\n        <div class=\"flex justify-between items-center mb-6\">\n          <h2 class=\"text-2xl font-bold text-coopmaths-struct dark:text-coopmathsdark-struct\">\n             Rsum de l'valuation - {students[currentStudentIndex]?.nom} {students[currentStudentIndex]?.prenom}\n          </h2>\n          <button\n            on:click={closeSummaryModal}\n            class=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-2xl\"\n          >\n            \n          </button>\n        </div>\n\n        <!-- Layout en 2 colonnes -->\n        <div class=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\n          \n          <!-- COLONNE GAUCHE - Score et niveau -->\n          <div class=\"lg:col-span-1\">\n            <!-- Score global compact -->\n            <div class=\"mb-4\">\n              <h3 class=\"text-sm font-semibold text-gray-600 dark:text-gray-400 mb-2\">\n                Note globale\n              </h3>\n              <div \n                class=\"px-4 py-3 rounded-lg text-center text-xl font-bold\"\n                style=\"color: {niveauMaitrise.couleur}; background: {niveauMaitrise.bgColor};\"\n              >\n                {studentScoreData.correct}/{studentScoreData.total}\n                <div class=\"text-sm mt-1\">\n                  {niveauMaitrise.pourcentage.toFixed(0)}%\n                </div>\n              </div>\n            </div>\n\n            <!-- Niveau de matrise -->\n            <div class=\"mb-4\">\n              <h3 class=\"text-sm font-semibold text-gray-600 dark:text-gray-400 mb-2\">\n                Niveau de matrise\n              </h3>\n              <div \n                class=\"px-3 py-2 rounded-lg text-center text-sm font-semibold\"\n                style=\"color: {niveauMaitrise.couleur}; background: {niveauMaitrise.bgColor};\"\n              >\n                {niveauMaitrise.niveau}\n              </div>\n            </div>\n            \n            <!-- Statistiques NR/NE compactes -->\n            {#if (() => {\n              const statsNRNE = countQuestionsNRNE(students[currentStudentIndex].id)\n              return statsNRNE.nr > 0 || statsNRNE.ne > 0\n            })()}\n              {@const statsNRNE = countQuestionsNRNE(students[currentStudentIndex].id)}\n              <div class=\"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800\">\n                <h5 class=\"text-xs font-semibold text-yellow-800 dark:text-yellow-200 mb-2\">\n                   Attention\n                </h5>\n                <div class=\"space-y-1 text-xs\">\n                  {#if statsNRNE.nr > 0}\n                    <div class=\"flex items-center gap-2\">\n                      <span class=\"px-2 py-1 bg-red-100 text-red-700 rounded-full font-semibold text-xs\">NR</span>\n                      <span class=\"text-gray-700 dark:text-gray-300\">\n                        {statsNRNE.nr} non rendue{statsNRNE.nr > 1 ? 's' : ''}\n                      </span>\n                    </div>\n                  {/if}\n                  {#if statsNRNE.ne > 0}\n                    <div class=\"flex items-center gap-2\">\n                      <span class=\"px-2 py-1 bg-blue-100 text-blue-700 rounded-full font-semibold text-xs\">NE</span>\n                      <span class=\"text-gray-700 dark:text-gray-300\">\n                        {statsNRNE.ne} non value{statsNRNE.ne > 1 ? 's' : ''}\n                      </span>\n                    </div>\n                  {/if}\n                </div>\n              </div>\n            {/if}\n\n            <!-- Comptences (si mode comptence) -->\n            {#if modeEvaluation !== 'notes' && Object.keys(competences).length > 0}\n              <div class=\"mt-4\">\n                <h3 class=\"text-sm font-semibold text-gray-600 dark:text-gray-400 mb-2\">\n                  Comptences\n                </h3>\n                <div class=\"space-y-2 max-h-60 overflow-y-auto\">\n                  {#each Object.entries(competences) as [comp, compData]}\n                    {@const colorInfo = compData.niveau === 'tbm' ? { couleur: '#4caf50', bgColor: '#e8f5e9', label: 'TBM', fullLabel: 'Trs Bonne Matrise' } :\n                                       compData.niveau === 'ms' ? { couleur: '#2196f3', bgColor: '#e3f2fd', label: 'MS', fullLabel: 'Matrise Satisfaisante' } :\n                                       compData.niveau === 'mf' ? { couleur: '#ff9800', bgColor: '#fff3e0', label: 'MF', fullLabel: 'Matrise Fragile' } :\n                                       compData.niveau === 'mi' ? { couleur: '#f44336', bgColor: '#ffebee', label: 'MI', fullLabel: 'Matrise Insuffisante' } :\n                                       { couleur: '#9c27b0', bgColor: '#f3e5f5', label: 'NE', fullLabel: 'Non valu' }}\n                    <div class=\"p-3 rounded-lg border-l-4\" style=\"background: {colorInfo.bgColor}; border-left-color: {colorInfo.couleur};\">\n                      <div class=\"flex items-center justify-between mb-1\">\n                        <div class=\"flex items-center gap-2\">\n                          <span class=\"text-sm\">{getCompetenceIcon(comp)}</span>\n                          <span class=\"text-sm font-semibold text-gray-800 dark:text-gray-200\">{comp}</span>\n                        </div>\n                        <div \n                          class=\"px-2 py-1 rounded-full text-xs font-bold text-white\"\n                        style=\"background: {colorInfo.couleur};\"\n                          title=\"{colorInfo.fullLabel}\"\n                      >\n                        {colorInfo.label}\n                      </div>\n                        </div>\n                      <div class=\"flex items-center justify-between\">\n                        <div \n                          class=\"text-sm font-bold\"\n                          style=\"color: {colorInfo.couleur};\"\n                        >\n                          {compData.correct}/{compData.total}\n                        </div>\n                        <div class=\"text-xs text-gray-600 dark:text-gray-400\">\n                          {compData.total > 0 ? `${compData.pourcentage.toFixed(0)}%` : 'Non valu'}\n                        </div>\n                      </div>\n                    </div>\n                  {/each}\n                </div>\n              </div>\n            {/if}\n          </div>\n\n          <!-- COLONNE DROITE - Dtail par exercice -->\n          <div class=\"lg:col-span-3\">\n            <h3 class=\"text-sm font-semibold text-gray-600 dark:text-gray-400 mb-3\">\n              Dtail par exercice\n            </h3>\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-[400px] overflow-y-auto pr-2\">\n              {#each evaluationData as ex, exIndex}\n                {@const exercicePoints = calculateExercicePoints(students[currentStudentIndex].id, exIndex)}\n                {@const exerciceNiveau = exercicesBadges[exIndex] || { niveau: 'NE', couleur: '#bdbdbd', bgColor: '#f5f5f5' }}\n                {@const studentCorrections = corrections[students[currentStudentIndex].id]}\n                {@const exerciceNRNE = ex.questions.reduce((acc, q) => {\n                  const correction = studentCorrections?.[exIndex]?.[q.questionIndex]\n                  const status = correction?.status\n                  if (status === 'NR') acc.nr++\n                  else if (status === 'NE') acc.ne++\n                  return acc\n                }, { nr: 0, ne: 0 })}\n                \n                <div class=\"p-2 rounded-lg border\" style=\"background: {exerciceNiveau.bgColor}; border-color: {exerciceNiveau.couleur};\">\n                  <div class=\"flex justify-between items-start mb-1\">\n                    <div class=\"flex items-start gap-1 flex-1 min-w-0\">\n                      <span class=\"font-bold text-xs flex-shrink-0\" style=\"color: {exerciceNiveau.couleur};\">#{exIndex + 1}</span>\n                      <span class=\"text-xs font-medium line-clamp-2 leading-tight\">{ex.titre}</span>\n                    </div>\n                    <div class=\"flex items-center gap-1 flex-shrink-0 ml-2\">\n                      <span class=\"text-xs font-bold px-1.5 py-0.5 rounded-full text-white\" style=\"background: {exerciceNiveau.couleur};\">\n                        {exerciceNiveau.niveau}\n                      </span>\n                    </div>\n                  </div>\n                  \n                  <div class=\"text-xs font-bold mb-1\" style=\"color: {exerciceNiveau.couleur};\">\n                    {exercicePoints.obtenus}/{exercicePoints.totaux}\n                    {exercicePoints.totaux > 0 ? `(${((exercicePoints.obtenus/exercicePoints.totaux)*100).toFixed(0)}%)` : ''}\n                  </div>\n                  \n                  <!-- Dtail NR/NE compact -->\n                  {#if exerciceNRNE.nr > 0 || exerciceNRNE.ne > 0}\n                    <div class=\"flex gap-1 text-xs\">\n                      {#if exerciceNRNE.nr > 0}\n                        <span class=\"px-1.5 py-0.5 bg-red-100 text-red-700 rounded-full font-semibold text-xs\">\n                          {exerciceNRNE.nr} NR\n                        </span>\n                      {/if}\n                      {#if exerciceNRNE.ne > 0}\n                        <span class=\"px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded-full font-semibold text-xs\">\n                          {exerciceNRNE.ne} NE\n                        </span>\n                      {/if}\n                    </div>\n                  {/if}\n                </div>\n              {/each}\n            </div>\n\n            <!-- Commentaire global -->\n            <div class=\"mt-4\">\n              <h3 class=\"text-sm font-semibold text-gray-600 dark:text-gray-400 mb-2\">\n                 Commentaire gnral\n              </h3>\n              <textarea\n                bind:value={commentaireGlobal}\n                placeholder=\"Votre commentaire global pour cet lve...\"\n                class=\"w-full p-3 text-sm rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 dark:text-white resize-none\"\n                rows=\"4\"\n              ></textarea>\n              \n              <!-- Dicte vocale -->\n              <div class=\"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800\">\n                <h4 class=\"text-sm font-semibold text-blue-800 dark:text-blue-200 mb-2 flex items-center gap-2\">\n                   Dicte vocale\n                </h4>\n                <div class=\"flex items-center gap-3\">\n                  {#if !isListening}\n                    <button\n                      on:click={startListening}\n                      class=\"px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold flex items-center gap-2 text-sm\"\n                    >\n                       Commencer la dicte\n                    </button>\n                  {:else}\n                    <button\n                      on:click={stopListening}\n                      class=\"px-3 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-semibold flex items-center gap-2 text-sm\"\n                    >\n                       Arrter\n                    </button>\n                    <span class=\"text-blue-500 font-semibold animate-pulse text-sm\"> coute en cours...</span>\n                  {/if}\n                  {#if dictatedText}\n                    <span class=\"text-green-600 font-semibold text-sm\"> Texte dict ajout</span>\n                  {/if}\n                </div>\n                {#if dictatedText}\n                  <div class=\"mt-2 p-2 bg-green-50 dark:bg-green-900/20 rounded border border-green-200 dark:border-green-800\">\n                    <p class=\"text-sm text-green-800 dark:text-green-200\">\n                      <strong>Texte dict :</strong> {dictatedText}\n                    </p>\n                  </div>\n                {/if}\n              </div>\n            </div>\n          </div>\n\n        </div>\n\n        <!-- Actions -->\n        <div class=\"flex justify-between items-center pt-6 border-t border-gray-200 dark:border-gray-700\">\n          <div class=\"text-sm text-gray-600 dark:text-gray-400\">\n            lve {currentStudentIndex + 1}/{students.length}\n          </div>\n          <div class=\"flex gap-3\">\n            <button\n              on:click={previousStudent}\n              disabled={currentStudentIndex === 0}\n              class=\"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n               lve prcdent\n            </button>\n            <button\n              on:click={() => { saveCurrentStudentComment(); closeSummaryModal(); backToOverview(); }}\n              class=\"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold\"\n            >\n               Valider et revenir  la liste\n            </button>\n            <button\n              on:click={nextStudent}\n              disabled={currentStudentIndex === students.length - 1}\n              class=\"px-4 py-2 bg-coopmaths-action hover:bg-coopmaths-action-lightest text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              lve suivant \n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n{/if}\n\n<!-- Modale de confirmation personnalise -->\n{#if showConfirmModal}\n  <div class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 backdrop-blur-sm\" on:click={() => showConfirmModal = false} role=\"dialog\" aria-modal=\"true\" on:keydown={(e) => e.key === 'Escape' && (showConfirmModal = false)}>\n    <div class=\"bg-white dark:bg-coopmathsdark-canvas-dark rounded-2xl shadow-2xl max-w-md w-full transform transition-all\" on:click|stopPropagation role=\"document\">\n      <!-- En-tte -->\n      <div class=\"bg-gradient-to-r from-orange-500 to-red-500 text-white px-6 py-4 rounded-t-2xl\">\n        <h3 class=\"text-xl font-bold\">{confirmModalData.title}</h3>\n      </div>\n      \n      <!-- Contenu -->\n      <div class=\"p-6\">\n        <p class=\"text-gray-700 dark:text-gray-300 text-base leading-relaxed whitespace-pre-line\">\n          {confirmModalData.message}\n        </p>\n      </div>\n      \n      <!-- Actions -->\n      <div class=\"flex gap-3 px-6 pb-6\">\n        <button\n          on:click={() => {\n            if (confirmModalData.onCancel) {\n              confirmModalData.onCancel()\n            }\n            showConfirmModal = false\n          }}\n          class=\"flex-1 px-4 py-3 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-white font-semibold rounded-lg transition-all\"\n        >\n          {confirmModalData.cancelText}\n        </button>\n        <button\n          on:click={() => {\n            confirmModalData.onConfirm()\n            showConfirmModal = false\n          }}\n          class=\"flex-1 px-4 py-3 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold rounded-lg transition-all shadow-lg\"\n        >\n          {confirmModalData.confirmText}\n        </button>\n      </div>\n    </div>\n  </div>\n{/if}\n\n","<script lang=\"ts\">\n  import * as ace from 'brace'\n  import 'brace/ext/searchbox'\n  import 'brace/mode/latex'\n  import 'brace/theme/monokai'\n\n  import { onDestroy, onMount, tick } from 'svelte'\n  import { tweened, type Tweened } from 'svelte/motion'\n  import type Latex from '../../../lib/Latex'\n  import {\n      buildImagesUrlsList,\n      doesLatexNeedsPics,\n      getExosContentList,\n      getPicsNames,\n      type LatexFileInfos,\n  } from '../../../lib/Latex'\n  import ButtonTextAction from './ButtonTextAction.svelte'\n\n  export let latex: Latex\n  export let latexFileInfos: LatexFileInfos\n  export let id: string\n\n  \n  let clockAbled: boolean = false\n\n  let idkey = id || '0'\n\n  const original = 1 * 60 // TYPE NUMBER OF SECONDS HERE\n  const timer: Tweened<number> = tweened(original)\n  const defaultengine = 'lualatex'\n  const defaultreturn = 'pdfjs'\n\n  onMount(() => {\n    window.addEventListener('keydown', handleKeyDown)\n  })\n  onDestroy(() => {\n    window.removeEventListener('keydown', handleKeyDown)\n  })\n  function handleKeyDown(event: KeyboardEvent) {\n    const isSaveShortcut = (event.ctrlKey || event.metaKey) && event.key === 's'\n    if (isSaveShortcut) {\n      event.preventDefault()\n      compileToPDF()\n    }\n  }\n\n  // ------ dont need to modify code below\n\n  function addinput(f: HTMLFormElement, n: string, v: string) {\n    const inp = document.createElement('input')\n    inp.setAttribute('type', 'text')\n    inp.setAttribute('name', n)\n    inp.value = encodeURIComponent(v)\n    f.appendChild(inp)\n  }\n\n  function addinputnoenc(f: HTMLFormElement, n: string, v: string) {\n    const inp = document.createElement('input')\n    inp.setAttribute('type', 'text')\n    inp.setAttribute('name', n)\n    inp.value = v\n    f.appendChild(inp)\n  }\n\n  function addtextarea(f: HTMLFormElement, n: string, v: string) {\n    const inp = document.createElement('textarea')\n    inp.setAttribute('type', 'text')\n    inp.setAttribute('name', n)\n    inp.textContent = v\n    f.appendChild(inp)\n  }\n\n  function submitFormToIframe(formData: FormData) {\n    const form = document.getElementById(`form${idkey}`) as HTMLFormElement\n    form.innerHTML = ''\n    form.action = 'https://texlive.net/cgi-bin/latexcgi'\n    form.method = 'POST'\n    form.target = `pre0ifr${idkey}`\n    form.enctype = 'multipart/form-data'\n\n    for (const [name, value] of formData.entries()) {\n      if (name === 'filecontents[]') {\n        addtextarea(form, name, value.toString())\n      } else if (name === 'filename[]') {\n        addinputnoenc(form, name, value.toString())\n      } else {\n        addinput(form, name, value.toString())\n      }\n    }\n    form.style.display = 'none'\n    form.submit()\n  }\n\n  function resetIframe(): HTMLElement {\n    const iframe = document.getElementById(`pre0ifr${idkey}`) as HTMLElement\n    const parent = iframe.parentElement\n    parent?.removeChild(iframe)\n    const iframe2 = document.createElement('iframe')\n    iframe2.setAttribute('title', 'output')\n    iframe2.setAttribute('width', '100%')\n    iframe2.setAttribute('height', '100%')\n    iframe2.setAttribute('id', `pre0ifr${idkey}`)\n    iframe2.setAttribute('name', `pre0ifr${idkey}`)\n    parent?.appendChild(iframe2)\n    return iframe2\n  }\n\n  async function compileToPDF() {\n    const editor = ace.edit(`editor${idkey}`)\n    const t = editor.getValue()\n\n    const iframe2 = resetIframe()\n\n    const formData = new FormData()\n    formData.append('filecontents[]', t)\n    formData.append('filename[]', 'document.tex')\n    formData.append('engine', defaultengine)\n    formData.append('return', defaultreturn)\n\n    const contents = await latex.getContents(latexFileInfos)\n    const picsWanted = doesLatexNeedsPics(contents)\n    const exosContentList = getExosContentList(latex.exercices)\n    const picsNames = getPicsNames(exosContentList)\n    const imagesUrls: string[] = picsWanted\n      ? buildImagesUrlsList(exosContentList, picsNames)\n      : []\n\n    for (let im = 0; im < imagesUrls.length; im++) {\n      const imaUrl = imagesUrls[im].replace(\n        'https://coopmaths.fr',\n        window.location.origin,\n      )\n      const visual = await fetch(imaUrl)\n      const blob = await visual.blob()\n      const stringfile = await blob.text()\n      formData.append('filecontents[]', stringfile)\n      formData.append('filename[]', imaUrl.split('/').slice(-1)[0])\n    }\n\n    timer.set(original)\n    clockAbled = true\n    const timeValue = setInterval(() => {\n      if ($timer > 0) {\n        $timer--\n      } else {\n        clearInterval(timeValue)\n      }\n    }, 1000)\n\n    iframe2.addEventListener('load', function (this) {\n      clockAbled = false\n      clearInterval(timeValue)\n      timer.set(original)\n    })\n\n    submitFormToIframe(formData)\n  }\n\n  /**\n   * Affiche ou ferme si dj ouvert le code Latex dans une boite de dialogue\n   */\n  async function dialogToDisplayToggle() {\n    const dialog = document.getElementById(`editorLatex${idkey}`) as HTMLDialogElement\n    if (dialog.open) {\n      clockAbled = false\n      dialog.close()\n    } else {\n      const contents = await latex.getContents(latexFileInfos)\n      const picsWanted = doesLatexNeedsPics(contents)\n      const exosContentList = getExosContentList(latex.exercices)\n      const picsNames = getPicsNames(exosContentList)\n      const imagesUrls: string[] = picsWanted\n        ? buildImagesUrlsList(exosContentList, picsNames)\n        : []\n\n      const { latexWithPreamble } = await latex.getFile(latexFileInfos)\n\n      const editor = ace.edit(`editor${idkey}`)\n      editor.getSession().setMode('ace/mode/latex')\n      editor.getSession().setNewLineMode('unix')\n      editor.setTheme('ace/theme/monokai')\n      // Ouvrir la searchbox avec Ctrl+F\n      editor.commands.addCommand({\n        name: \"showSearchBox\",\n        bindKey: { win: \"Ctrl-F\", mac: \"Command-F\" },\n        exec: function(edite: any) {\n          edite.execCommand(\"find\");\n        }\n      })\n      editor.setShowPrintMargin(false)\n      editor.setValue(latexWithPreamble)\n      editor.gotoLine(1)\n\n      resetIframe()\n\n      const imageLatex = document.getElementById('imagesLatex') as HTMLElement\n      imageLatex.innerHTML = \"Nombre d'images: \" + imagesUrls.length\n      dialog.showModal()\n      await tick()\n      compileToPDF()\n    }\n  }\n</script>\n\n<!--\n  @component\n  Bouton dclenchant l'exportation vers OverLeaf\n\n  ### Paramtres\n\n  * `latex` : code latex du document\n  * `latexFileInfos` : objet contenant les lments de mise en forme du fichier\n  * `disabled` : flag permettant de dsactiver le bouton\n\n  ### Exemple\n  ```tsx\n  <ButtonOverleaf\n    {latex}\n    latexFileInfos={{ title, reference, subtitle, style, nbVersions }}\n    disabled={false}\n  />\n  ```\n -->\n\n<form\n  class=\"{`${$$props.class || 'flex flex-col md:flex-row mx-4 pb-4 md:pb-8 md:space-x-4 space-y-3 justify-center md:justify-start items-center'}`}\"\n  target=\"_blank\"\n>\n  <button\n    id=\"btn_overleaf\"\n    type=\"submit\"\n    on:click|preventDefault=\"{dialogToDisplayToggle}\"\n    class=\"px-2 py-1 rounded-md text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n  >\n    Compiler et obtenir le PDF\n  </button>\n</form>\n\n<dialog\n  class=\"fixed rounded-xl p-6 bg-coopmaths-canvas text-coopmaths-corpus left-[2%] top-[2%] w-[96%] h-[96%] dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-corpus-light shadow-lg\"\n  id=\"editorLatex{idkey}\"\n>\n  <div class=\"mt-3 text-center\">\n    <div class=\"text-3xl font-medium text-coopmaths-warn-dark\">\n      <span class=\"header\">\n        <div class=\"absolute top-2 right-3\">\n          <button\n            type=\"button\"\n            on:click=\"{() => {\n              dialogToDisplayToggle()\n            }}\"\n          >\n            <i\n              class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest text-xl bx bx-x\"\n            ></i>\n          </button>\n        </div>\n      </span>\n    </div>\n    <div class=\"font-light\">\n      <div class=\"flex h-[80vh] flex-row max-md:portrait:flex-col\">\n        <div id=\"editor{idkey}\" class=\"flex flex-grow flex-1\"></div>\n        <div class=\"bg-gray-100 flex flex-grow flex-1\">\n          {#if clockAbled}\n            <div class=\"loader\">\n              <span\n                ><progress value=\"{$timer / original}\"\n                ></progress>{$timer.toFixed(0)}s</span\n              >\n            </div>\n          {/if}\n          <iframe\n            title=\"output\"\n            width=\"100%\"\n            height=\"100%\"\n            id=\"pre0ifr{idkey}\"\n            name=\"pre0ifr{idkey}\"\n          ></iframe>\n        </div>\n      </div>\n      <div id=\"imagesLatex\"></div>\n      <ButtonTextAction\n        disabled=\"{clockAbled}\"\n        class=\"px-2 py-1 rounded-md\"\n        text=\"Compiler en PDF\"\n        on:click=\"{compileToPDF}\"\n      />\n      <form id=\"form{idkey}\"></form>\n    </div>\n  </div>\n</dialog>\n","<script lang=\"ts\">\n  import { onDestroy } from \"svelte\"\n  export let blob: Blob | null = null;\n\n  let url: string | null = null;\n\n  //  chaque fois que le blob change, on rgnre lURL\n  $: if (blob) {\n    if (url) URL.revokeObjectURL(url); // nettoyer ancienne URL\n    url = URL.createObjectURL(blob);\n  }\n\n  // librer quand le composant est dtruit\n  onDestroy(() => {\n    if (url) URL.revokeObjectURL(url);\n  });\n</script>\n\n{#if url}\n  <iframe\n    src={url}\n    class=\"w-full h-full border-0 rounded\"\n    title=\"Aperu du PDF\"\n  />\n{:else}\n  <p class=\"text-gray-500\">Aucun PDF charg.</p>\n{/if}\n","<script lang=\"ts\">\n  import * as ace from 'brace'\n  import 'brace/ext/searchbox'\n  import 'brace/mode/latex'\n  import 'brace/theme/monokai'\n\n  import { onDestroy, onMount, tick } from 'svelte'\n  import { tweened, type Tweened } from 'svelte/motion'\n  import type Latex from '../../../lib/Latex'\n  import {\n      buildImagesUrlsList,\n      doesLatexNeedsPics,\n      getExosContentList,\n      getPicsNames,\n      type LatexFileInfos,\n  } from '../../../lib/Latex'\n  import ButtonTextAction from './ButtonTextAction.svelte'\n  import PdFviewer from './PDFviewer.svelte'\n\n  export let latex: Latex\n  export let latexFileInfos: LatexFileInfos\n  export let id: string\n\n  let pdfBlob: Blob | null = null;\n\n  let clockAbled: boolean = false\n\n  let downloadFilename: string | null = null;\n\n  let idkey = id || '0'\n\n  const original = 1 * 60 // TYPE NUMBER OF SECONDS HERE\n  const timer: Tweened<number> = tweened(original)\n\n  onMount(() => {\n    window.addEventListener('keydown', handleKeyDown)\n  })\n  onDestroy(() => {\n    window.removeEventListener('keydown', handleKeyDown)\n  })\n  function handleKeyDown(event: KeyboardEvent) {\n    const isSaveShortcut = (event.ctrlKey || event.metaKey) && event.key === 's'\n    if (isSaveShortcut) {\n      event.preventDefault()\n      compileToPDF()\n    }\n  }\n\n  async function downloadAndExtractPDF(blob: Blob, filename: string) {\n    pdfBlob = blob\n    // juste stocker blob + filename\n    downloadFilename = filename\n  }\n\t\n  function generateFilename(prefix = \"latex\", ext = \"pdf\") {\n    const now = new Date();\n    const pad = (n: number) => String(n).padStart(2, \"0\");\n    const date = `${now.getFullYear()}-${pad(now.getMonth() + 1)}-${pad(now.getDate())}`;\n    const time = `${pad(now.getHours())}${pad(now.getMinutes())}${pad(now.getSeconds())}`;\n    return `${prefix}_${date}_${time}.${ext}`;\n  }\n\n  async function compileToPDF() {\n    const editor = ace.edit(`editor${idkey}`)\n    const t = editor.getValue()\n\n    const formData = new FormData()\n    formData.append('name', 'document.tex')\n    formData.append('originalname', 'document.tex')\n    formData.append('file', new Blob([t]), 'document.tex')\n\n    const contents = await latex.getContents(latexFileInfos)\n    const picsWanted = doesLatexNeedsPics(contents)\n    const exosContentList = getExosContentList(latex.exercices)\n    const picsNames = getPicsNames(exosContentList)\n    const imagesUrls: string[] = picsWanted\n      ? buildImagesUrlsList(exosContentList, picsNames)\n      : []\n\n    for (let im = 0; im < imagesUrls.length; im++) {\n      const imaUrl = imagesUrls[im].replace(\n        'https://coopmaths.fr',\n        window.location.origin,\n      )\n      const visual = await fetch(imaUrl)\n      const blob = await visual.blob()\n      // const stringfile = await blob.text()\n      formData.append('name', imaUrl.split('/').slice(-1)[0])\n      formData.append('originalname', imaUrl.split('/').slice(-1)[0])\n      formData.append('file', blob, imaUrl.split('/').slice(-1)[0])\n    }\n\n    timer.set(original)\n    clockAbled = true\n    const timeValue = setInterval(() => {\n      if ($timer > 0) {\n        $timer--\n      } else {\n        clearInterval(timeValue)\n      }\n    }, 1000)\n\n  let resultReq = ''\n\n  await fetch('https://latexcompiler.duckdns.org/generate', {\n    method: 'POST',\n    body: formData,\n    signal: AbortSignal.timeout(60 * 1000)\n  }).then((res : Response) => {\n    if (res.status === 200) {\n      resultReq = 'OK'\n    } else {\n      resultReq = 'KO'\n    }\n    return res.blob()\n  }).then(blob => {\n    clockAbled = false\n    return downloadAndExtractPDF(blob, generateFilename(\"document\", \"pdf\"))\n  }).catch((err) => {\n    clockAbled = false\n    console.error('Error occured' + err)\n    resultReq = 'KO'\n  })\n  }\n\n  /**\n   * Affiche ou ferme si dj ouvert le code Latex dans une boite de dialogue\n   */\n  async function dialogToDisplayToggle() {\n    const dialog = document.getElementById(`editorLatex${idkey}`) as HTMLDialogElement\n    if (dialog.open) {\n      clockAbled = false\n      pdfBlob = null //  reset PDF quand on ferme\n      dialog.close()\n    } else {\n      const contents = await latex.getContents(latexFileInfos)\n      const picsWanted = doesLatexNeedsPics(contents)\n      const exosContentList = getExosContentList(latex.exercices)\n      const picsNames = getPicsNames(exosContentList)\n      const imagesUrls: string[] = picsWanted\n        ? buildImagesUrlsList(exosContentList, picsNames)\n        : []\n\n      const { latexWithPreamble } = await latex.getFile(latexFileInfos)\n\n      const editor = ace.edit(`editor${idkey}`)\n      editor.$blockScrolling = Infinity   //  dsactive le warning\n      editor.getSession().setMode('ace/mode/latex')\n      editor.getSession().setNewLineMode('unix')\n      editor.setTheme('ace/theme/monokai')\n      // Ouvrir la searchbox avec Ctrl+F\n      editor.commands.addCommand({\n        name: \"showSearchBox\",\n        bindKey: { win: \"Ctrl-F\", mac: \"Command-F\" },\n        exec: function(edite: any) {\n          edite.execCommand(\"find\");\n        }\n      })\n      editor.setShowPrintMargin(false)\n      editor.setValue(latexWithPreamble)\n      editor.gotoLine(1)\n\n      const imageLatex = document.getElementById('imagesLatex') as HTMLElement\n      imageLatex.innerHTML = \"Nombre d'images: \" + imagesUrls.length\n      dialog.showModal()\n      await tick()\n      compileToPDF()\n    }\n  }\n</script>\n\n<!--\n  @component\n  Bouton dclenchant l'exportation vers OverLeaf\n\n  ### Paramtres\n\n  * `latex` : code latex du document\n  * `latexFileInfos` : objet contenant les lments de mise en forme du fichier\n  * `disabled` : flag permettant de dsactiver le bouton\n\n  ### Exemple\n  ```tsx\n  <ButtonOverleaf\n    {latex}\n    latexFileInfos={{ title, reference, subtitle, style, nbVersions }}\n    disabled={false}\n  />\n  ```\n -->\n\n<form\n  class=\"{`${$$props.class || 'flex flex-col md:flex-row mx-4 pb-4 md:pb-8 md:space-x-4 space-y-3 justify-center md:justify-start items-center'}`}\"\n  target=\"_blank\"\n>\n  <button\n    id=\"btn_overleaf\"\n    type=\"submit\"\n    on:click|preventDefault=\"{dialogToDisplayToggle}\"\n    class=\"px-2 py-1 rounded-md text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n  >\n    Compiler et obtenir le PDF\n  </button>\n</form>\n\n<dialog\n  class=\"fixed rounded-xl p-6 bg-coopmaths-canvas text-coopmaths-corpus left-[2%] top-[2%] w-[96%] h-[96%] dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-corpus-light shadow-lg\"\n  id=\"editorLatex{idkey}\"\n>\n  <div class=\"mt-3 text-center\">\n    <div class=\"text-3xl font-medium text-coopmaths-warn-dark\">\n      <span class=\"header\">\n        <div class=\"absolute top-2 right-3\">\n          <button\n            type=\"button\"\n            on:click=\"{() => {\n              dialogToDisplayToggle()\n            }}\"\n          >\n            <i\n              class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest text-xl bx bx-x\"\n            ></i>\n          </button>\n        </div>\n      </span>\n    </div>\n    <div class=\"font-light\">\n      <div class=\"flex h-[80vh] flex-row max-md:portrait:flex-col\">\n        <div id=\"editor{idkey}\" class=\"flex flex-grow flex-1\"></div>\n        <div class=\"bg-gray-100 flex flex-grow flex-1\">\n          {#if clockAbled}\n            <div class=\"loader\">\n              <span\n                ><progress value=\"{$timer / original}\"\n                ></progress>{$timer.toFixed(0)}s</span\n              >\n            </div>\n          {/if}\n          <div class=\"bg-gray-100 flex flex-grow flex-1 flex-col\">\n            {#if pdfBlob}\n              <!-- Lien tlchargement sous le viewer -->\n              {#if downloadFilename}\n                <div class=\"m-2\">\n                  <a\n                    href={URL.createObjectURL(pdfBlob)}\n                    download={downloadFilename}\n                    class=\"px-3 py-1 rounded bg-coopmaths-action text-white hover:bg-coopmaths-action-lightest\"\n                  >\n                    Tlcharger {downloadFilename}\n                  </a>\n                </div>\n              {/if}\n\n              <!-- PDF viewer -->\n              <div class=\"flex-1 overflow-auto m-2\">\n                <PdFviewer blob={pdfBlob} />\n              </div>\n            {/if}\n          </div>\n        </div>\n      </div>\n      <div id=\"imagesLatex\"></div>\n      <ButtonTextAction\n        disabled=\"{clockAbled}\"\n        class=\"px-2 py-1 rounded-md\"\n        text=\"Compiler en PDF\"\n        on:click=\"{compileToPDF}\"\n      />\n      <form id=\"form{idkey}\"></form>\n    </div>\n  </div>\n</dialog>\n","export default \"% Author     : Christophe Poulain\\n% licence    : Released under the LaTeX Project Public License v1.3c\\n% or later, see http://www.latex-project.org/lppl.txtf\\n\\\\NeedsTeXFormat{LaTeX2e}%\\n\\\\def\\\\filedate{2024/10/21}%\\n\\\\let\\\\PfMfiledate\\\\filedate%\\n\\\\def\\\\fileversion{0.99-i}%\\n\\\\let\\\\PfMfileversion\\\\fileversion%\\n\\n\\\\ProvidesPackage{ProfMaquette}[\\\\filedate\\\\space v\\\\fileversion\\\\space Maquettage de documents]%\\n\\n\\\\newif\\\\if@Dyslexie \\\\@Dyslexiefalse\\n\\\\newif\\\\if@CAN \\\\@CANfalse\\n\\\\newif\\\\if@Revision \\\\@Revisionfalse\\n\\\\newif\\\\if@AssembleCorrections \\\\@AssembleCorrectionsfalse\\n\\\\newif\\\\if@Personnel \\\\@Personnelfalse\\n\\n\\\\DeclareOption{Dyslexie}{\\\\@Dyslexietrue}\\n\\\\DeclareOption{CAN}{\\\\@CANtrue}\\n\\\\DeclareOption{Revision}{\\\\@Revisiontrue}\\n\\\\DeclareOption{AssembleCorrections}{\\\\@AssembleCorrectionstrue}\\n\\\\DeclareOption{Personnel}{\\\\@Personneltrue}\\n\\\\ProcessOptions\\\\relax\\n\\n\\\\if@AssembleCorrections\\n  \\\\AddToHook{env/document/end}[AC]{\\\\PfMAffichageTousCorriges}%\\n\\\\fi\\n\\n% packages ncessaires\\n\\\\RequirePackage{verbatim}%\\n\\\\RequirePackage{xintexpr}\\n\\\\RequirePackage{calc}%\\n\\n\\\\RequirePackage{xlop}%\\n\\n\\\\RequirePackage{varwidth}%\\n\\n\\\\RequirePackage{tcolorbox}%\\n\\\\tcbuselibrary{breakable,external,fitting,hooks,magazine,poster,raster,skins,theorems,listings,listingsutf8}%\\n\\n\\\\RequirePackage{xinttools}%\\n\\n\\\\RequirePackage{listofitems}%\\n\\\\RequirePackage{array}%\\n\\\\RequirePackage{datatool}%\\n\\n\\\\RequirePackage{modulus}%\\n\\n\\\\RequirePackage{ragged2e}%\\n\\\\RequirePackage{fontawesome5}\\n\\\\makeatletter\\n\\\\gdef\\\\PfMFontSize{\\\\@ptsize}\\n%\\\\gdef\\\\PfMFontSize{\\\\f@size}\\n\\\\makeatother\\n%dfinition des cls\\n\\\\RequirePackage{simplekv}%\\n\\\\setKVdefault[Boulot]{PixelArt=false,AMC=false,IntroductionAMC=false,Graine=1,Dys=false,Taille=14,Cours=false,Base=false,BaseHTML=false,CAN=false,Fiche=false,DM=false,DS=false,IE=false,Kholle=false,RecapBrevet=false,PdT=false,Parcours=false,Contrat=false,FdR=false,ParcoursPerso=false,OlympiadesAPMEP=false,LivreHeros=false,CorrigeInverse=false,CorrigeSeul=false,CorrigeApres=false,CorrigeFin=false,CorrigeAll=false,Brevet=false,BaremeComplet=false,BaremeGlobal=false,CorrectionColonnes=false,EntrainementColonnes=false,Epaisseur=0pt,EEpaisseur=0pt,ESansSaut=false,VersSolution=false,AvecEntrainement=false,Small=false,Footnotesize=false,Scriptsize=false,AllDirect=false,AllPouce=false,Input=false}%\\n\\\\defKV[Boulot]{Colonnes=\\\\setKV[Boulot]{CorrectionColonnes}}%\\n\\\\defKV[Boulot]{EColonnes=\\\\setKV[Boulot]{EntrainementColonnes}}%\\n\\\\setKVdefault[PixelArt]{Aleatoire=false,Landscape=false,CoupureTableau=false,Fichier={},Lettres={},Largeur={},Hauteur={},ListeCouleurs={},Solution=false,Theme=Essai,Arcenciel=false,LargeurTab=40pt}%\\n\\\\defKV[PixelArt]{CoupeTableau=\\\\setKV[PixelArt]{CoupureTableau}}%\\n%\\\\defKV[PixelArt]{ListeNombres=\\\\setKV[PixelArt]{Aleatoire}\\\\setsepchar{,}\\\\ignoreemptyitems\\\\readlist*\\\\ListePourLesItems{#1}\\\\reademptyitems}\\n\\\\setKVdefault[AMC]{Date=\\\\today,Classe={},Niveau={},Code=\\\\jobname,NomExercice=Exercice,Theme=Numration,Calculatrice=false}%\\n\\\\setKVdefault[Cours]{Couleur=Crimson,Theme=Trace \\\\'ecrite,NomExercice=Exercice}%\\n\\\\setKVdefault[DM]{Numero=1,Date=\\\\today,Classe={},Niveau=3,Code=\\\\jobname}%\\n\\\\setKVdefault[DS]{Numero=1,Date=\\\\today,Classe={},Niveau=3,Code=\\\\jobname,Calculatrice=false,Sujet=A}%\\n\\\\setKVdefault[Beamer]{Theme=Les nombres d\\\\'ecimaux,SousTheme={},Date=\\\\today,Niveau=6,Classe={},Code={},NomExercice=Exercice,}%\\n\\\\setKVdefault[Fiche]{Theme=Les nombres d\\\\'ecimaux,Date=\\\\today,Niveau=6,Classe={},Code={},NomExercice=Exercice}%\\n\\\\setKVdefault[PdT]{Theme=Les nombres d\\\\'ecimaux,Date=\\\\today,Niveau=6,Classe={},Code={},NomExercice=Exercice}%\\n\\\\setKVdefault[FdR]{Theme=Les nombres d\\\\'ecimaux,Date=\\\\today,Niveau=6,Classe={},Code={},NomExercice=Exercice}%\\n\\\\setKVdefault[Parcours]{Theme=Les nombres d\\\\'ecimaux,Date=\\\\today,Niveau=6,Classe={},Code={},NomExercice=Exercice,Vertical=false,Plan=false,Court=false}%\\n\\\\setKVdefault[Contrat]{Theme=Les nombres d\\\\'ecimaux,Date=\\\\today,Niveau=6,Classe={},Code={},NomExercice=Exercice}%\\n\\\\setKVdefault[OlympiadesAPMEP]{Theme=Les nombres d\\\\'ecimaux,Bandeau=false}%\\n\\\\setKVdefault[ParcoursPerso]{Fichier={}}%\\n\\\\setKVdefault[IE]{Nom=\\\\'Evaluation,Sujets=false,Theme={},Numero=1,Date=\\\\today,Classe={},Niveau=3,Code=\\\\jobname,Calculatrice=false}%\\n\\\\defKV[IE]{Sujet=\\\\setKV[IE]{Sujets}}%\\n\\\\setKVdefault[RecapBrevet]{Theme=Les nombres d\\\\'ecimaux,Date=\\\\today,Code={},NomExercice=Exercice}%\\n\\\\setKVdefault[Kholle]{Sujet=1,Numero=1,Date=15,Niveau=TSI-1,Code=\\\\jobname,Lieu=Lyc\\\\'ee\\n  du Hainaut (Valenciennes),NomEleve=Albert Einstein,CR=false}%\\n\\\\setKVdefault[CAN]{Date=\\\\today,Niveau=6,Duree=9,CoefQ=0.4,CoefR=0.35,CoefJ=0.1}%\\n\\\\setKVdefault[ClesExercices]{Open,NbQuestions=1,PasTitre=false,AffichageSource=false,BaremeTotal,BaremeDetaille=false,MotPoint=point,AffichageTitre=false,Calculatrice=true,Oral=false,Difficulte=0,AffichageCompetence=false,PasCorrige=false,Direct=false,Pouce=false,Parcours=false,Contrat=false,FdR=false,Routes=false,Stops=false,Background=white,Cadre=gray!50,Numerote,Ligne=false,Doublespacing=false,Onehalfspacing=false,Cadres=false,Grilles=false,Cinq=false,Huit=false,TitreSol=false,NonUtilise=false,Profile=false,AEntretenir=false,Fragile=false,AvecIndications=false,ACompleter=false,Aide=0,Score=0,EchelleSeyes=8,Ajout={},TitreCorrige=Corrig de l'exercice,Interieur=false,NombreEleves=0,Categorie=0}%\\n%\\\\defKV[ClesExercices]{AMCReponses=\\\\ifboolKV[Boulot]{AMC}{\\\\setKV[ClesExercices]{Open=false}}{}}%\\n\\\\defKV[ClesExercices]{TitreSolution=\\\\setKV[ClesExercices]{TitreSol}}%\\n\\\\defKV[ClesExercices]{Source=\\\\setKV[ClesExercices]{AffichageSource}}%\\n\\\\defKV[ClesExercices]{Titre=\\\\setKV[ClesExercices]{AffichageTitre}}%\\n\\\\defKV[ClesExercices]{Competence=\\\\setKV[ClesExercices]{AffichageCompetence}}%\\n\\\\defKV[ClesExercices]{Trajet=\\\\setKV[ClesExercices]{Parcours}}%\\n\\\\defKV[ClesExercices]{Confiance=\\\\setKV[ClesExercices]{Contrat}}%\\n\\\\defKV[ClesExercices]{Route=\\\\setKV[ClesExercices]{Routes}}%\\n\\\\defKV[ClesExercices]{Stop=\\\\setKV[ClesExercices]{Stops}}%\\n\\\\defKV[ClesExercices]{Lignes=\\\\setKV[ClesExercices]{Ligne}}%\\n\\\\defKV[ClesExercices]{Encart=\\\\setKV[ClesExercices]{Cadres}}%\\n\\\\defKV[ClesExercices]{CinqCinq=\\\\setKV[ClesExercices]{Grilles}\\\\setKV[ClesExercices]{Cinq}}%\\n\\\\defKV[ClesExercices]{Seyes=\\\\setKV[ClesExercices]{Grilles}\\\\setKV[ClesExercices]{Huit}}%\\n\\\\def\\\\PfMTexteEncart{Indique ton travail ci-dessous.}%\\n\\\\setKVdefault[SchemaParcours]{Colonnes=100,Rayon=2.5mm,Largeur=7.5mm,Couleur=gray!70}%,Csv=false}%\\n\\\\setKVdefault[SchemaContrat]{Ecart=7mm,Rayon=2.5mm}%\\n\\\\setKVdefault[SchemaFdR]{Ecart=7mm,Colonnes=100,Rayon=2.5mm,Largeur=7.5mm,Hauteur=1cm,Couleur=gray!70}%,Csv=false}%\\n% Commande pour retenir le nombre d'exercices par maquette.Utile seulement pour la cl AssembleCorrection\\n\\\\xdef\\\\PfMRetiensLienExoMa{}%\\n\\\\xdef\\\\PfMRetiensLienDefMa{}%\\n% Commande pour passer des options  travers la cl Input. Elle remplace \\\\input :)\\n\\\\NewDocumentCommand\\\\Input{om}{%\\n  \\\\def\\\\Relecture{\\\\setKV[ClesExercices]{#1}}%\\n  \\\\input{#2}%\\n  \\\\def\\\\Relecture{}%\\n}%\\n% Sucres\\n\\\\makeatletter%\\n\\\\NewDocumentCommand\\\\PfMDotfill{}{%\\n\\\\leavevmode%\\n\\\\cleaders\\\\hb@xt@.44em{\\\\hss\\\\xleaders\\\\hrule width0.33em\\\\hss}\\\\hfill%\\n\\\\kern\\\\z@}%\\n\\\\makeatother%\\n%\\n\\\\NewDocumentCommand\\\\PfMpointilles{o}{%\\n  \\\\IfNoValueTF{#1}{\\\\PfMDotfill}{\\\\makebox[#1]{\\\\PfMDotfill}}%\\n}%\\n%\\n\\\\NewDocumentCommand\\\\PfMNbLignesRestantes{}{%\\n  \\\\edef\\\\measurepage{\\\\dimexpr\\\\pagegoal-\\\\pagetotal\\\\relax}%\\n  \\\\edef\\\\measurepagemax{\\\\dimexpr\\\\textheight\\\\relax}%\\n % \\\\edef\\\\measurepage{\\\\dimeval{\\\\pagegoal-\\\\pagetotal-\\\\baselineskip}}%\\n  \\\\xdef\\\\PfMResteLignes{\\\\fpeval{trunc((\\\\the\\\\measurepage)/(\\\\baselineskip),0)}}%\\n  \\\\xdef\\\\PfMResteLignesMax{\\\\fpeval{trunc((\\\\the\\\\measurepagemax)/(\\\\baselineskip),0)}}%\\n  \\\\ifnum\\\\PfMResteLignesMax<\\\\PfMResteLignes\\\\relax\\n    \\\\xdef\\\\PfMResteLignes{\\\\PfMResteLignesMax}\\n  \\\\fi\\n  %\\\\xdef\\\\PfMResteLignes{\\\\dimeval{trunc((\\\\the\\\\measurepage)/(\\\\baselineskip),0)}}%\\n  %Il reste \\\\PfMResteLignes{} lignes alors que le nombre maximal de lignes sur une page est \\\\PfMResteLignesMax{}.\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMLignesFinales{}{%\\n  \\\\PfMNbLignesRestantes%\\n  \\\\xintFor* ##1 in {\\\\xintSeq {1}{\\\\PfMResteLignes}}\\\\do{%\\n    \\\\PfMpointilles\\\\par%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMLignespointilles{sm}{%\\n  \\\\IfBooleanTF{#1}{%\\n    \\\\par\\\\PfMLignesFinales%\\n  }{%\\n    \\\\xintifboolexpr{\\\\fpeval{#2}>1}{%\\n      \\\\xintFor* ##1 in {\\\\xintSeq {1}{#2}}\\\\do{%\\n        \\\\PfMpointilles\\\\par%\\n      }%\\n    }{}%\\n  }%\\n}%\\n% Definition de longueurs\\n\\\\newlength\\\\PfMLargeurTableauPixelArt%\\n\\\\newlength\\\\PfMLargeurSchemaParcours%\\n\\\\newlength\\\\PfMRayonSchemaParcours%\\n\\\\newlength\\\\PfMLargeurSchemaContrat%\\n\\\\newlength\\\\PfMRayonSchemaContrat%\\n\\\\newlength\\\\PfMLargeurSchemaFdR%\\n\\\\newlength\\\\PfMRayonSchemaFdR%\\n\\\\newlength\\\\PfMHauteurSchemaFdR%\\n\\\\newlength\\\\PfMHauteurAppreciation%\\n\\\\newlength\\\\PfMHauteurRemarque%\\n\\\\newlength\\\\PfMLargeurQuestion%\\n\\\\newlength\\\\PfMLargeurReponse%\\n\\\\newlength\\\\PfMLargeurJury%\\n\\\\newlength\\\\PfMEspaceAvantLignes%\\n\\\\newlength\\\\PfMEspaceApresLignes%\\n\\\\newlength\\\\PfMLargeurComp%\\n\\\\newlength\\\\CRRHauteur%\\n\\\\newlength\\\\PfMEcartSupInterMots%\\n\\\\newlength\\\\PfMCoefcompetences%\\n\\\\def\\\\PfMCoefCompetences{0.85}%\\n\\\\setlength{\\\\CRRHauteur}{10cm}%\\n\\\\setlength{\\\\PfMHauteurAppreciation}{5cm}%\\n\\\\setlength{\\\\PfMHauteurRemarque}{5cm}%\\n\\\\setlength{\\\\PfMEspaceAvantLignes}{1em}%\\n\\\\setlength{\\\\PfMEspaceApresLignes}{1em}%\\n\\\\setlength{\\\\PfMEcartSupInterMots}{1pt}%\\n\\\\setlength{\\\\PfMCoefcompetences}{0.7\\\\linewidth}%\\n% dfinition des compteurs\\n\\\\newcounter{PfMMaquette}%Pour compter le nombres de \\\"travaux\\\"\\n\\\\setcounter{PfMMaquette}{0}%\\n\\\\newcounter{PfMMaquetteSol}[PfMMaquette]%Pour compter le nombres de \\\"travaux\\\" dans les corrections\\n\\\\setcounter{PfMMaquetteSol}{0}%\\n\\\\newcounter{PfMSection}%Pour le barme et ne pas faire obstruction  section\\n\\\\setcounter{PfMSection}{0}%\\n\\\\newcounter{PfMExo}[PfMMaquette]%Numro des exercices\\n\\\\setcounter{PfMExo}{0}%\\n%\\\\newcounter{PfMExoSolAlea}%Pour reprer les valeurs alatoires construites automatiquement dans la solution\\n%\\\\setcounter{PfMExoSolAlea}{0}%\\n\\\\newcounter{PfMExoSol}[PfMMaquette]%\\n\\\\setcounter{PfMExoSol}{0}%\\n\\\\newcounter{PfMExoEntrai}%Pour reprer les entrainements\\n\\\\setcounter{PfMExoEntrai}{0}%\\n\\\\newcounter{PfMCorrigeParcoursPerso}%affichage des solutions ou pas dans le cadre d'un parcours perso\\n\\\\setcounter{PfMCorrigeParcoursPerso}{0}%\\n\\\\newcounter{PfMRetiensMapourPP}%Pour retenir le numro de la maquette de rfrence pour les parcours perso\\n\\\\setcounter{PfMRetiensMapourPP}{0}%\\n\\\\newcounter{PfMSOS}%Numro des SOS dans les parcours flchs\\n\\\\setcounter{PfMSOS}{0}%\\n\\\\newcounter{PfMAlea}%Pour reprer les valeurs alatoires construites automatiquement\\n\\\\setcounter{PfMAlea}{0}%\\n%\\n\\\\newcounter{PfMNbListeReponsesAMC}%%Pour diffrencier les questions lors d'un exercice  plusieurs questions.\\n\\\\newcounter{PfMAMCOpen}%%Pour diffrencier les questions lors d'un exercice  plusieurs questions.\\n\\\\newcounter{RetiensSol}%Pour l'affichage des solutions\\n\\\\newcounter{RetiensRep}%Pour l'affichage des reponses.\\n\\\\newcounter{RetiensInd}%Pour l'affichage des indices.\\n\\\\newcounter{RetiensIndic}%Pour l'affichage des indications.\\n\\\\newcounter{PfMRetiensQr}%Pour l'affichage des entrainements\\n\\\\setcounter{RetiensSol}{0}%\\n\\\\setcounter{RetiensRep}{0}%\\n\\\\setcounter{RetiensInd}{0}%\\n\\\\setcounter{RetiensIndic}{0}%\\n\\\\setcounter{PfMRetiensQr}{0}%\\n\\\\newcounter{PfMNbLogo}%Pour dcaler les logos sur la ligne haute de tcolorbox\\n\\\\setcounter{PfMNbLogo}{0}%\\n\\\\newcount\\\\Orientation%Pour le schma des parcours\\n\\\\newcount\\\\TotalParcoursTikz%Pour le total des exos  utiliser dans l'affichage des parcours tikz\\n\\\\newcounter{PfMCNNumQ}%\\n\\n\\\\newcounter{Nbcolonnes}\\n\\n\\\\newbox\\\\PfMSauvegardeBox%\\n\\n\\\\newif\\\\ifPfMDeuxColonnes\\n\\\\newif\\\\ifPfMRectoVerso\\n\\\\newif\\\\ifPfMRevision\\n\\n\\\\makeatletter\\n\\\\if@twocolumn\\n  \\\\PfMDeuxColonnestrue\\n  \\\\setcounter{Nbcolonnes}{2}\\n\\\\else\\n  \\\\PfMDeuxColonnesfalse\\n  \\\\setcounter{Nbcolonnes}{4}\\n\\\\fi\\n\\\\if@twoside\\n  \\\\PfMRectoVersotrue\\n\\\\else\\n  \\\\PfMRectoVersofalse\\n\\\\fi\\n\\\\if@Revision\\n  \\\\PfMRevisiontrue\\n\\\\else\\n  \\\\PfMRevisionfalse\\n\\\\fi\\n\\\\makeatother\\n\\n% couleurs\\n\\\\colorlet{PfMColCpt}{gray!50}%\\n\\\\colorlet{PfMColSrc}{gray!50}%\\n\\\\colorlet{PfMCadreEncart}{gray!50}\\n\\\\colorlet{PfMCadreDM}{gray!85}%\\n\\\\colorlet{PfMCadreParcours}{gray!50}%\\n\\\\colorlet{PfMCadreContrat}{gray!50}%\\n\\\\colorlet{PfMColbackFdR}{white}%\\n\\\\colorlet{PfMCadreFdR}{gray!50}%\\n\\\\colorlet{PfMFondEncart}{white}%\\n% Dfinitions de commandes\\n\\\\newcommand\\\\PfMIENom{\\\\dotfill}%\\n\\\\newcommand\\\\PfMIEPrenom{\\\\dotfill}%\\n\\\\newcommand\\\\PfMIEClasse{\\\\dotfill}%\\n\\\\newcommand\\\\PfMCompNA{NA}%\\n\\\\newcommand\\\\PfMCompECA{ECA}%\\n\\\\newcommand\\\\PfMCompA{A}%\\n\\n\\\\NewDocumentCommand\\\\TournerPage{O{\\\\faShare}}{%\\n  \\\\par\\\\vfill\\\\par\\\\hfill{\\\\em Tourner la page #1}\\\\clearpage\\n}%\\n\\n\\\\tcbset{%\\n  consignes/.style={\\n    empty,\\n    right=0pt,\\n    left=0mm,\\n    top=0pt,\\n    bottom=0pt,\\n    frame engine=path,\\n    colframe=Crimson!10,\\n    notitle,\\n    sharp corners=west,\\n    borderline west={3pt}{0pt}{Crimson!50}\\n  }\\n}\\n\\n\\\\NewDocumentEnvironment{Consignes}{b}{%\\n  \\\\ifboolKV[Boulot]{CAN}{}{%\\n  \\\\begin{tcolorbox}[consignes]%\\n    \\\\small\\\\sffamily\\n    #1\\n  }%\\n}{%\\n\\\\ifboolKV[Boulot]{CAN}{}{\\\\end{tcolorbox}}%\\n}%\\n\\n\\\\tcbset{%\\n  indications/.style={\\n    empty,\\n    right=0pt,\\n    left=0mm,\\n    top=0pt,\\n    bottom=0pt,\\n    frame engine=path,\\n    % colframe=Crimson!10,\\n    frame hidden,\\n    notitle,\\n    sharp corners=west,\\n    borderline west={3pt}{0pt}{black!50}\\n  }\\n}\\n\\n%% Option french pour les mathmatiques\\n% By CT\\n\\\\NewDocumentCommand\\\\TypoMathFrance{}{%\\n  \\\\unless\\\\ifdefined\\\\countletters\\\\newcount\\\\countletters\\\\fi\\n  \\\\countletters=`A\\n  \\\\loop\\n  \\\\unless\\\\ifnum\\\\countletters>`Z\\n    \\\\begingroup\\\\lccode`!=\\\\countletters\\n    \\\\lowercase{\\\\endgroup\\\\DeclareMathSymbol{!}{\\\\mathalpha}{operators}{`!}}%\\n    \\\\advance\\\\countletters 1\\n    \\\\repeat\\n}%\\n\\n% On bloque la graine de fabrication des nombres alatoires.\\n\\\\ExplSyntaxOn\\n\\\\cs_new_eq:NN \\\\PfMGraineAlea \\\\sys_gset_rand_seed:n\\n\\\\ExplSyntaxOff\\n\\n\\\\ExplSyntaxOn\\n\\\\cs_new_eq:NN \\\\PfMChoisisGraineAlea \\\\int_rand:n\\n\\\\ExplSyntaxOff\\n\\n%% Gestion de l'affichage ou pas des item (Pour lves PAP) par exemple\\n% Code by egreg : https://tex.stackexchange.com/questions/627250/hide-specific-item-in-a-list\\n\\\\ExplSyntaxOn\\n\\n\\\\NewDocumentCommand{\\\\cacheitem}{}\\n {\\n  \\\\PfMitem_hide:\\n }\\n\\n\\\\NewDocumentCommand{\\\\PfMhideitems}{}\\n {\\n  \\\\bool_set_true:N \\\\l_PfMitem_hide_bool\\n }\\n\\\\NewDocumentCommand{\\\\PfMshowitems}{}\\n {\\n  \\\\bool_set_false:N \\\\l_PfMitem_hide_bool\\n }\\n\\n\\\\bool_new:N \\\\l_PfMitem_hide_bool\\n\\n\\\\cs_new_protected:Nn \\\\PfMitem_hide:\\n {\\n  \\\\bool_if:NT \\\\l_PfMitem_hide_bool\\n   {\\n    \\\\peek_regex_replace_once:nn\\n     % search \\\\item followed by anything until finding\\n     % \\\\item or \\\\hideit or \\\\end{<current environment>}\\n     { \\\\c{item}.*?(\\\\c{item}|\\\\c{cacheitem}|\\\\c{end}\\\\{\\\\u{@currenvir}\\\\}) }\\n     % replace by the matching item\\n     { \\\\1 }\\n   }\\n }\\n\\n\\\\ExplSyntaxOff\\n\\n\\\\definecolor{SLCP}{HTML}{00B51A}%\\n\\\\colorlet{Evidence}{SLCP}%\\n\\n\\\\NewDocumentCommand\\\\RepartirEffectifTotal{mmm}{%\\n  % #1 valeur de l'effectif total\\n  % #2 nombre de valeurs  obtenir\\n  % #3 cart acceptable :) autour de la moyenne\\n  \\\\xdef\\\\PfCSLEffectifs{}%\\n  \\\\xdef\\\\PfCValeurMoyenneTemp{\\\\fpeval{floor(#1/#2)}}%\\n  \\\\xdef\\\\PfCRetiensRETSomme{}%\\n  \\\\xdef\\\\PfCRetiensRETSommeTotale{0}%\\n  \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\fpeval{#2-1}}}\\\\do{%\\n    \\\\xdef\\\\PfCSLDelta{\\\\fpeval{randint(0,#3)}}%\\n    \\\\ifodd##1\\\\relax%\\n      \\\\xdef\\\\PfCSLEffectifs{\\\\PfCSLEffectifs \\\\fpeval{\\\\PfCValeurMoyenneTemp+\\\\PfCSLDelta},}%\\n      \\\\xdef\\\\PfCRetiensRETSomme{\\\\PfCRetiensRETSomme-\\\\fpeval{\\\\PfCValeurMoyenneTemp+\\\\PfCSLDelta}}%\\n      \\\\xdef\\\\PfCRetiensRETSommeTotale{\\\\PfCRetiensRETSommeTotale+\\\\fpeval{\\\\PfCValeurMoyenneTemp+\\\\PfCSLDelta}}%\\n    \\\\else%\\n      \\\\xdef\\\\PfCSLEffectifs{\\\\PfCSLEffectifs \\\\fpeval{\\\\PfCValeurMoyenneTemp-\\\\PfCSLDelta},}%\\n      \\\\xdef\\\\PfCRetiensRETSomme{\\\\PfCRetiensRETSomme-\\\\fpeval{\\\\PfCValeurMoyenneTemp-\\\\PfCSLDelta}}%\\n      \\\\xdef\\\\PfCRetiensRETSommeTotale{\\\\PfCRetiensRETSommeTotale+\\\\fpeval{\\\\PfCValeurMoyenneTemp-\\\\PfCSLDelta}}%\\n    \\\\fi%\\n  }%\\n  % On rectifie sur la dernire valeur :)\\n  \\\\xdef\\\\PfCSLEffectifs{\\\\PfCSLEffectifs \\\\fpeval{#1+\\\\PfCRetiensRETSomme}}%\\n  \\\\xdef\\\\PfCRetiensRETSommeTotale{\\\\PfCRetiensRETSommeTotale+\\\\fpeval{#1+\\\\PfCRetiensRETSomme}}%\\n%  On voulait un effectif fixe  #1 en #2 valeurs avec un cart de #3 par rapport  la moyenne.\\\\\\\\\\n  %Les choix : \\\\PfCSLEffectifs.\\\\\\\\\\n  % Somme totale : \\\\fpeval{\\\\PfCRetiensRETSommeTotale}\\\\\\\\\\n}\\n\\n\\\\NewDocumentCommand\\\\RepartirEffectifTotalB{mmm}{%\\n  % #1 valeur de l'effectif total\\n  % #2 nombre de valeurs  obtenir\\n  % #3 le scale de la valeur de base pour calculer le delta\\n  \\\\xdef\\\\PfCCPEffectifs{}%\\n  \\\\xdef\\\\PfCValeurMoyenneTemp{\\\\fpeval{floor(#1/#2)}}%\\n  \\\\xdef\\\\PfCRetiensRETSomme{#1}%\\n  \\\\xdef\\\\PfCRetiensRETSommeTotale{0}%\\n  \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\fpeval{#2-1}}}\\\\do{%\\n    %La valeur moyenne ##1 est \\\\PfCValeurMoyenneTemp\\\\\\\\\\n    %On cherche entre \\\\fpeval{-\\\\PfCValeurMoyenneTemp+1} et \\\\fpeval{\\\\PfCValeurMoyenneTemp-1}\\\\\\\\\\n    \\\\xdef\\\\PfCCPDelta{\\\\fpeval{randint(-floor(#3*\\\\PfCValeurMoyenneTemp)+1,floor(#3*\\\\PfCValeurMoyenneTemp)-1)}}%\\n    %Le delta ##1 est \\\\PfCCPDelta\\\\\\\\\\n    \\\\xdef\\\\PfCCPValeurRetenue{\\\\fpeval{\\\\PfCValeurMoyenneTemp+\\\\PfCCPDelta}}%\\n    %La valeur retenue ##1 est \\\\PfCCPValeurRetenue\\\\\\\\\\n    \\\\xdef\\\\PfCCPEffectifs{\\\\PfCCPEffectifs \\\\PfCCPValeurRetenue,}%\\n    \\\\xdef\\\\PfCRetiensRETSomme{\\\\fpeval{\\\\PfCRetiensRETSomme-\\\\PfCCPValeurRetenue}}%\\n    \\\\xdef\\\\PfCValeurMoyenneTemp{\\\\fpeval{floor(\\\\PfCRetiensRETSomme/(#2-##1))}}%\\n    \\\\xdef\\\\PfCRetiensRETSommeTotale{\\\\PfCRetiensRETSommeTotale+\\\\PfCCPValeurRetenue}%\\n    %La somme totale ##1 est \\\\fpeval{\\\\PfCRetiensRETSommeTotale}\\\\\\\\\\n  }%\\n%  % On rectifie sur la dernire valeur :)\\n  \\\\xdef\\\\PfCCPEffectifs{\\\\PfCCPEffectifs \\\\fpeval{#1-\\\\fpeval{\\\\PfCRetiensRETSommeTotale}}}%\\n  %Les choix : \\\\PfCCPEffectifs.\\\\\\\\\\n  %% Somme totale : \\\\fpeval{\\\\PfCRetiensRETSommeTotale}\\\\\\\\\\n}\\n\\n% Pour la gestion de l'alatoire\\n% afin de permettre d'utiliser le mme exercice.\\n% Extraire des sommets\\n\\\\newcounter{PfMSommetcount}%\\n\\\\newcommand\\\\ChoixSommet[2]{%\\n  % #1 le nombre de sommets\\n  % #2 le nom de base des commandes qui sauvegarde les noms\\n  % aprs chgt\\n  \\\\stepcounter{PfMAlea}%\\n  % fin chgt\\n  \\\\xdef\\\\CANSGFoo{A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z}%\\n  \\\\MelangeListe{\\\\CANSGFoo}{#1}%\\n  \\\\ignoreemptyitems%\\n  \\\\readlist*\\\\PfMSommet{\\\\faa}%\\n  \\\\reademptyitems%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{1}{#1}}\\\\do{%\\n    \\\\setcounter{PfMSommetcount}{##1}%\\n    \\\\expandafter\\\\xdef\\\\csname p\\\\Alph{PfMSommetcount}\\\\endcsname{\\\\PfMSommet[##1]}%\\n    % avant chgt\\n    % \\\\expandafter\\\\xdef\\\\csname #2\\\\Roman{PfMExo}\\\\alph{PfMSommetcount}\\\\endcsname{\\\\PfMSommet[##1]}%\\n    % aprs chgt\\n    \\\\expandafter\\\\xdef\\\\csname #2\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\alph{PfMSommetcount}\\\\endcsname{\\\\PfMSommet[##1]}%\\n  }%\\n}%\\n%%%\\n\\n\\\\NewDocumentCommand\\\\RestoreSommet{mm}{%\\n  % #1 le nombre de sommets\\n  % #2 le nom de base utilis lors de la cration des sommets\\n  \\\\stepcounter{PfMAlea}%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{1}{#1}}\\\\do{%\\n    \\\\setcounter{PfMSommetcount}{##1}%\\n    \\\\expandafter\\\\xdef\\\\csname p\\\\Alph{PfMSommetcount}\\\\endcsname{\\\\csname #2\\\\Roman{PfMExoSol}\\\\roman{PfMAlea}\\\\alph{PfMSommetcount}\\\\endcsname}%\\n  }%\\n}%\\n\\n\\\\ifdef{\\\\VariableAlea}{%\\n  \\\\RenewDocumentCommand\\\\VariableAlea{s m m}{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\stepcounter{PfMAlea}%\\n      \\\\expandafter\\\\xdef\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{\\\\fpeval{#3}}%\\n      \\\\expandafter\\\\xdef\\\\csname #2\\\\endcsname{\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n    }{%\\n      \\\\xdef#2{\\\\fpeval{#3}}%\\n    }%\\n  }%\\n}{%\\n  \\\\NewDocumentCommand\\\\VariableAlea{s m m}{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\stepcounter{PfMAlea}%\\n      \\\\expandafter\\\\xdef\\\\csname valeur\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{\\\\fpeval{#3}}%\\n      \\\\expandafter\\\\xdef\\\\csname #2\\\\endcsname{\\\\csname valeur\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n    }{%\\n      \\\\xdef#2{\\\\fpeval{#3}}%\\n    }%\\n  }%\\n}%\\n\\n\\\\ifdef{\\\\ChoixAlea}{%\\n  \\\\RenewDocumentCommand\\\\ChoixAlea{s o m m m}{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\stepcounter{PfMAlea}%\\n      \\\\IfNoValueTF{#2}{%\\n        \\\\expandafter\\\\xdef\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{\\\\fpeval{randint(#3,#4)}}%\\n        \\\\expandafter\\\\xdef\\\\csname #5\\\\endcsname{\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n      }{%\\n        \\\\expandafter\\\\xdef\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{\\\\fpeval{round(randint(#3,#4)+rand(),#2)}}%\\n        \\\\expandafter\\\\xdef\\\\csname #5\\\\endcsname{\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n      }%\\n    }{%\\n      \\\\IfNoValueTF{#2}{%\\n        \\\\xdef#5{\\\\fpeval{randint(#3,#4)}}%\\n      }{%\\n        \\\\xdef#5{\\\\fpeval{round(randint(#3,#4)+rand(),#2)}}%\\n      }%\\n    }%\\n  }%\\n}{%\\n  \\\\NewDocumentCommand\\\\ChoixAlea{s o m m m}{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\stepcounter{PfMAlea}%\\n      \\\\IfNoValueTF{#2}{%\\n        \\\\expandafter\\\\xdef\\\\csname valeur\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{\\\\fpeval{randint(#3,#4)}}%\\n        \\\\expandafter\\\\xdef\\\\csname #5\\\\endcsname{\\\\csname valeur\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n      }{%\\n        \\\\expandafter\\\\xdef\\\\csname valeur\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{\\\\fpeval{round(randint(#3,#4)+rand(),#2)}}%\\n        \\\\expandafter\\\\xdef\\\\csname #5\\\\endcsname{\\\\csname valeur\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n      }%\\n    }{%\\n      \\\\IfNoValueTF{#2}{%\\n        \\\\xdef#5{\\\\fpeval{randint(#3,#4)}}%\\n      }{%\\n        \\\\xdef#5{\\\\fpeval{round(randint(#3,#4)+rand(),#2)}}%\\n      }%\\n    }%\\n  }%\\n}% \\n\\n\\\\NewDocumentCommand\\\\ChoixAleaMultiMix{mmmmm}{%\\n  % #1 nombre de valeurs  choisir\\n  % #2 valeur minimale\\n  % #3 valeur maximale\\n  % #4 valeur(s) exclue(s)\\n  % #5 Nom de la liste qui rcupre les donnes.\\n  \\\\ifx\\\\bla#4\\\\bla%\\n    \\\\PackageWarning{ProfMaquette}{Il faut dfinir au moins une valeur  exclure.}%\\n  \\\\else%\\n    \\\\xdef\\\\PfMMixFoo{#2}%\\n    \\\\setsepchar{,}\\\\ignoreemptyitems%\\n    \\\\xdef\\\\PfMMixFooEx{#4}%\\n    \\\\readlist*\\\\ListeValeursExclues{\\\\PfMMixFooEx}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{\\\\fpeval{#2+1}}{#3}}\\\\do{%\\n      \\\\xdef\\\\PfMMixFoo{\\\\PfMMixFoo,##1}%\\n    }%\\n    \\\\readlist*\\\\ListeValeursRetenues{\\\\PfMMixFoo}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeValeursExclueslen}}\\\\do{%\\n      \\\\xdef\\\\PfMMixFoo{}%\\n      \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\ListeValeursRetenueslen}}\\\\do{%\\n        \\\\xintifboolexpr{\\\\ListeValeursRetenues[##2]==\\\\ListeValeursExclues[##1]}{}{%\\n          \\\\xdef\\\\PfMMixFoo{\\\\PfMMixFoo,\\\\ListeValeursRetenues[##2]}%\\n        }%\\n      }%\\n      \\\\ignoreemptyitems%\\n      \\\\readlist*\\\\ListeValeursRetenues{\\\\PfMMixFoo}%\\n    }%\\n    \\\\ifnum\\\\ListeValeursRetenueslen=1\\\\relax%\\n      \\\\xdef#5{\\\\PfMMixFoo}%\\n    \\\\else%\\n      \\\\MelangeListe{\\\\PfMMixFoo}{#1}%\\n      \\\\xdef#5{\\\\faa}%\\n    \\\\fi%\\n  \\\\fi%\\n}%\\n\\n\\\\NewDocumentCommand\\\\ChoixAleaMultiMixListe{mmmm}{%\\n  % #1 nombre de valeurs  choisir\\n  % #2 Liste  parcourir\\n  % #3 valeur(s) exclue(s)\\n  % #4 Nom de la liste qui rcupre les donnes.\\n  \\\\ifx\\\\bla#3\\\\bla%\\n    \\\\PackageWarning{ProfMaquette}{Il faut dfinir au moins une valeur  exclure.}%\\n  \\\\else%\\n    \\\\setsepchar{,}\\\\ignoreemptyitems%\\n    \\\\readlist*\\\\ListeValeursExclues{#3}%\\n    \\\\readlist*\\\\ListeValeursRetenues{#2}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeValeursExclueslen}}\\\\do{%\\n      \\\\xdef\\\\PfMMixFoo{}%\\n      \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\ListeValeursRetenueslen}}\\\\do{%\\n        \\\\xintifboolexpr{\\\\ListeValeursRetenues[##2]==\\\\ListeValeursExclues[##1]}{}{%\\n          \\\\xdef\\\\PfMMixFoo{\\\\PfMMixFoo,\\\\ListeValeursRetenues[##2]}%\\n        }%\\n      }%\\n      \\\\setsepchar{,}\\\\ignoreemptyitems%\\n      \\\\readlist*\\\\ListeValeursRetenues{\\\\PfMMixFoo}%\\n    }%\\n    \\\\ifnum\\\\ListeValeursRetenueslen>1\\\\relax%\\n      \\\\MelangeListe{\\\\PfMMixFoo}{#1}%\\n      \\\\xdef#4{\\\\faa}%\\n    \\\\else%\\n      \\\\xdef#4{\\\\PfMMixFoo}%\\n    \\\\fi%\\n  \\\\fi%\\n}%\\n\\n\\\\NewDocumentCommand\\\\ChoixAleaListe{ommmm}{%\\n  % Il n'y a pas de rptitions des lments.\\n  % #1 prcision des dcimaux\\n  % #2 nombre d'lments\\n  % #3 valeur entire minimale\\n  % #4 valeur entire maximale\\n  % #5 nom de la liste rcuprant les nombres choisis.\\n  % 1ere valeur\\n  \\\\IfNoValueTF{#1}{\\\\xdef\\\\ListeNombresAlea{\\\\fpeval{randint(#3,#4)}}}{\\\\xdef\\\\ListeNombresAlea{\\\\fpeval{round(randint(#3,#4-1)+rand(),#1)}}}%\\n  \\\\setsepchar{,}%\\n  \\\\readlist*\\\\ListeARenvoyer{\\\\ListeNombresAlea}%\\n  \\\\whiledo{\\\\ListeARenvoyerlen<#2}{%\\n    \\\\IfNoValueTF{#1}{\\\\xdef\\\\SuivantNombreAlea{\\\\fpeval{randint(#3,#4)}}}{\\\\xdef\\\\SuivantNombreAlea{\\\\fpeval{round(randint(#3,#4-1)+rand(),#1)}}}%\\n    \\\\def\\\\Unique{0}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeARenvoyerlen}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\fpeval{\\\\SuivantNombreAlea}==\\\\fpeval{\\\\ListeARenvoyer[##1]}}{%\\n        \\\\def\\\\Unique{1}%\\n        \\\\xintBreakFor%\\n      }{}%\\n    }%\\n    \\\\ifnum\\\\fpeval{\\\\Unique}=0\\\\relax%\\n      \\\\xdef\\\\ListeNombresAlea{\\\\ListeNombresAlea,\\\\SuivantNombreAlea}%\\n      \\\\readlist*\\\\ListeARenvoyer{\\\\ListeNombresAlea}%\\n    \\\\fi%\\n  }%\\n  \\\\xdef#5{\\\\ListeNombresAlea}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\ChoixAleaListeold{mmmm}{%\\n  % Il n'y a pas de rptitions des lments.\\n  % #1 nombre d'lments\\n  % #2 valeur entire minimale\\n  % #3 valeur entire maximale\\n  % #4 nom de la liste rcuprant les nombres choisis.\\n  % 1ere valeur\\n  \\\\xdef\\\\ListeNombresAlea{\\\\fpeval{randint(#2,#3)}}\\n  \\\\setsepchar{,}\\\\ignoreemptyitems\\n  \\\\readlist*\\\\ListeARenvoyer{\\\\ListeNombresAlea}%\\n  \\\\whiledo{\\\\ListeARenvoyerlen<#1}{%\\n    \\\\xdef\\\\SuivantNombreAlea{\\\\fpeval{randint(#2,#3)}}%\\n    \\\\def\\\\Unique{0}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeARenvoyerlen}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\fpeval{\\\\SuivantNombreAlea}==\\\\fpeval{\\\\ListeARenvoyer[##1]}}{%\\n        \\\\def\\\\Unique{1}%\\n        \\\\xintBreakFor%\\n      }{}%\\n    }%\\n    \\\\ifnum\\\\fpeval{\\\\Unique}=0\\\\relax%\\n      \\\\xdef\\\\ListeNombresAlea{\\\\ListeNombresAlea,\\\\SuivantNombreAlea}%\\n      \\\\readlist*\\\\ListeARenvoyer{\\\\ListeNombresAlea}%\\n    \\\\fi%\\n  }%\\n  \\\\xdef#4{\\\\ListeNombresAlea}%\\n}\\n\\n\\\\NewDocumentCommand\\\\ChoixAleaListeMix{mmmmm}{%\\n  % ide by reddit : I need a randomly ordered list...\\n  % Il n'y a pas de rptitions des lments.\\n  % #1 nombre d'lments\\n  % #2 valeur entire minimale\\n  % #3 valeur entire maximale\\n  % #4 Liste des valeurs  exclure  \\n  % #5 nom de la liste rcuprant les nombres choisis.\\n  \\\\xdef\\\\Toto{#4}%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeValeursExclues{\\\\Toto}%\\n  % 1ere valeur\\n  \\\\xdef\\\\PfMNbCoups{0}%\\n  \\\\whiledo{\\\\fpeval{\\\\PfMNbCoups}<\\\\ListeValeursExclueslen}{%\\n    \\\\xdef\\\\ListeNombresAlea{\\\\fpeval{randint(#2,#3)}}%\\n    \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\ListeValeursExclueslen}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\fpeval{\\\\ListeNombresAlea}==\\\\fpeval{\\\\ListeValeursExclues[##1]}}{%\\n        \\\\xdef\\\\PfMNbCoups{0}%\\n        \\\\xintBreakFor%\\n      }{\\\\xdef\\\\PfMNbCoups{\\\\fpeval{\\\\PfMNbCoups+1}}}%\\n    }%\\n  }%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeARenvoyer{\\\\ListeNombresAlea}%\\n  \\\\whiledo{\\\\ListeARenvoyerlen<#1}{%\\n    \\\\xdef\\\\SuivantNombreAlea{\\\\fpeval{randint(#2,#3)}}%\\n    \\\\def\\\\Unique{0}%\\n    \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\ListeValeursExclueslen}}\\\\do{\\n      \\\\xintifboolexpr{\\\\fpeval{\\\\SuivantNombreAlea}==\\\\fpeval{\\\\ListeValeursExclues[##1]}}{%\\n        \\\\def\\\\Unique{1}%\\n        \\\\xintBreakFor%\\n      }{}%\\n    }%\\n    \\\\ifnum\\\\fpeval{\\\\Unique}=0\\\\relax%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeARenvoyerlen}}\\\\do{%\\n        \\\\xintifboolexpr{\\\\fpeval{\\\\SuivantNombreAlea}==\\\\fpeval{\\\\ListeARenvoyer[##1]}}{%\\n          \\\\def\\\\Unique{1}%\\n          \\\\xintBreakFor%\\n        }{}%\\n      }%\\n    \\\\fi%\\n    \\\\ifnum\\\\fpeval{\\\\Unique}=0\\\\relax%\\n      \\\\xdef\\\\ListeNombresAlea{\\\\ListeNombresAlea,\\\\SuivantNombreAlea}%\\n      \\\\readlist*\\\\ListeARenvoyer{\\\\ListeNombresAlea}%\\n    \\\\fi%\\n  }%\\n  \\\\xdef#5{\\\\ListeNombresAlea}%\\n}\\n\\n\\\\NewDocumentCommand\\\\ChoixAleaMulti{mmmm}{%\\n  % #1 nombre de valeurs  choisir qui peut tre suprieur au nombre de valeurs entires disponibles\\n  % #2 valeur minimale\\n  % #3 valeur maximale\\n  % #4 Nom de la liste qui rcupre les donnes.\\n  \\\\xdef\\\\PfMMixFoo{\\\\fpeval{randint(#2,#3)}}%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{#1-1}}}\\\\do{%\\n    \\\\xdef\\\\PfMMixFoo{\\\\PfMMixFoo,\\\\fpeval{randint(#2,#3)}}%\\n  }%\\n  \\\\xdef#4{\\\\PfMMixFoo}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\ChoixAleaMultiMixRep{mmmmm}{%\\n  % #1 nombre de valeurs  choisir\\n  % #2 valeur minimale\\n  % #3 valeur maximale\\n  % #4 valeur  exclure\\n  % #5 Nom de la liste qui rcupre les donnes.\\n  \\\\xdef\\\\PfCRetiensRetenues{}%\\n  \\\\xdef\\\\PfMMixFoo{#2,#3}%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\xdef\\\\PfMMixFooExclues{#4}%\\n  \\\\readlist*\\\\ListeValeursExclues{\\\\PfMMixFooExclues}%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{\\\\fpeval{#2+1}}{\\\\fpeval{#3-1}}}\\\\do{%\\n    \\\\xdef\\\\PfCRetiensExclues{0}%\\n    \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\ListeValeursExclueslen}}\\\\do{%\\n      \\\\xintifboolexpr{##1==\\\\ListeValeursExclues[##2]}{\\\\xdef\\\\PfCRetiensExclues{\\\\fpeval{\\\\PfCRetiensExclues+1}}}{}%\\n    }%\\n    \\\\ifnum\\\\fpeval{\\\\PfCRetiensExclues}=0\\\\relax%\\n      \\\\xdef\\\\PfMMixFoo{\\\\PfMMixFoo,##1}%\\n    \\\\fi%\\n  }%\\n  \\\\xintFor* ##1 in {\\\\xintSeq{1}{#1}}\\\\do{%\\n    \\\\MelangeListe{\\\\PfMMixFoo}{1}%\\n    \\\\xdef\\\\PfCRetiensRetenues{\\\\PfCRetiensRetenues\\\\faa}%\\n  }%\\n  \\\\xdef#5{\\\\PfCRetiensRetenues}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\MelangeNomFonction{mm}{%\\n  % #1 Nombre d'lments  conserver\\n  % #2 Nom de la commande qui conserve\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeInter{f,g,h,k,\\\\ell,m,p,q,r,s,u,v,w}%%\\n  \\\\xdef\\\\faa{}% Liste construite\\n  \\\\xdef\\\\fii{}% Liste dtruite\\n  \\\\xintFor* ##1 in {\\\\xintSeq{1}{#1}}\\\\do{%\\n    \\\\xintifboolexpr{#1==1}{%\\n      \\\\xdef\\\\Alea{\\\\fpeval{randint(\\\\ListeInterlen)}}%\\n      \\\\xdef\\\\faa{\\\\faa\\\\ListeInter[\\\\Alea]}%\\n    }{%\\n      \\\\xintifboolexpr{\\\\ListeInterlen>1}{%\\n        \\\\xdef\\\\Alea{\\\\fpeval{randint(\\\\ListeInterlen)}}%\\n        \\\\xdef\\\\faa{\\\\faa\\\\ListeInter[\\\\Alea],}%\\n        \\\\xdef\\\\fii{}%\\n        \\\\xintFor* ##2 in {\\\\xintSeq{1}{\\\\ListeInterlen}}\\\\do{%\\n          \\\\xintifboolexpr{##2 == \\\\Alea}{%\\n          }{%\\n            \\\\xdef\\\\fii{\\\\fii \\\\ListeInter[##2],}%\\n          }%\\n        }%\\n      }{%\\n        \\\\xdef\\\\faa{\\\\faa\\\\ListeInter[1]}%\\n      }%\\n      \\\\readlist*\\\\ListeInter{\\\\fii}%\\n    }%\\n  }%\\n  \\\\xdef#2{\\\\faa}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\MelangeNomVariable{mm}{%\\n  % #1 Nombre d'lments  conserver\\n  % #2 Nom de la commande qui conserve\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeInter{a,b,n,t,x,y,z}%\\n  \\\\xdef\\\\faa{}% Liste construite\\n  \\\\xdef\\\\fii{}% Liste dtruite\\n  \\\\xintFor* ##1 in {\\\\xintSeq{1}{#1}}\\\\do{%\\n    \\\\xintifboolexpr{#1==1}{%\\n      \\\\xdef\\\\Alea{\\\\fpeval{randint(\\\\ListeInterlen)}}%\\n      \\\\xdef\\\\faa{\\\\faa\\\\ListeInter[\\\\Alea]}%\\n    }{%\\n      \\\\xintifboolexpr{\\\\ListeInterlen>1}{%\\n        \\\\xdef\\\\Alea{\\\\fpeval{randint(\\\\ListeInterlen)}}%\\n        \\\\xdef\\\\faa{\\\\faa\\\\ListeInter[\\\\Alea],}%\\n        \\\\xdef\\\\fii{}%\\n        \\\\xintFor* ##2 in {\\\\xintSeq{1}{\\\\ListeInterlen}}\\\\do{%\\n          \\\\xintifboolexpr{##2 == \\\\Alea}{%\\n          }{%\\n            \\\\xdef\\\\fii{\\\\fii \\\\ListeInter[##2],}%\\n          }%\\n        }%\\n      }{%\\n        \\\\xdef\\\\faa{\\\\faa\\\\ListeInter[1]}%\\n      }%\\n      \\\\readlist*\\\\ListeInter{\\\\fii}%\\n    }%\\n  }%\\n  \\\\xdef#2{\\\\faa}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\AffSigne{smm}{%\\n  \\\\ifnum#2=0\\\\relax{}\\n  \\\\else\\n  \\\\ifnum#3=0\\\\relax{}\\n  \\\\else\\n  \\\\ifnum#3>0\\\\relax{}\\n  +\\n  \\\\fi\\n  \\\\fi\\n  \\\\fi\\n}%\\n\\n\\\\NewDocumentCommand\\\\AffPoly{O{x}m}{%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems\\n  \\\\readlist*\\\\ListeCoeff{#2}\\n  \\\\ensuremath{\\n    \\\\ifnum\\\\ListeCoeff[1]=0\\\\relax\\n    \\\\Affichage{\\\\ListeCoeff[2]}{\\\\ListeCoeff[3]}{\\\\ListeCoeff[4]}%\\n    \\\\else\\n    \\\\ifnum\\\\ListeCoeff[1]=1\\\\relax\\n    #1^3%\\n    \\\\else\\\\ifnum\\\\ListeCoeff[1]=-1\\\\relax\\n    -#1^3\\n    \\\\else\\\\num{\\\\ListeCoeff[1]}#1^3\\n    \\\\fi\\n    \\\\fi\\n    \\\\ifnum\\\\ListeCoeff[2]=0\\\\relax\\n    \\\\ifnum\\\\ListeCoeff[3]=0\\\\relax\\n    \\\\ifnum\\\\ListeCoeff[4]=0\\\\relax\\n    \\\\else\\n    \\\\ifnum\\\\ListeCoeff[4]>0\\n    +\\\\Affichage[Lettre=#1]{0}{0}{\\\\ListeCoeff[4]}\\n    \\\\else\\n    \\\\Affichage[Lettre=#1]{0}{0}{\\\\ListeCoeff[4]}\\n    \\\\fi\\n    \\\\fi\\n    \\\\else\\n    \\\\ifnum\\\\ListeCoeff[3]>0\\\\relax\\n    +\\\\Affichage[Lettre=#1]{0}{\\\\ListeCoeff[3]}{\\\\ListeCoeff[4]}\\n    \\\\else\\n    \\\\Affichage[Lettre=#1]{0}{\\\\ListeCoeff[3]}{\\\\ListeCoeff[4]}\\n    \\\\fi\\n    \\\\fi\\n    \\\\else\\n    \\\\ifnum\\\\ListeCoeff[2]>0\\\\relax\\n    +\\\\Affichage[Lettre=#1]{\\\\ListeCoeff[2]}{\\\\ListeCoeff[3]}{\\\\ListeCoeff[4]}%\\\\num{\\\\ListeCoeff[2]}x^2\\n    \\\\else\\n    \\\\Affichage[Lettre=#1]{\\\\ListeCoeff[2]}{\\\\ListeCoeff[3]}{\\\\ListeCoeff[4]}%\\\\num{\\\\ListeCoeff[2]}x^2\\n    \\\\fi\\n    \\\\fi\\n    \\\\fi\\n  }\\n}\\n\\n\\\\newcounter{PfCenumi}\\n\\n\\\\NewDocumentCommand\\\\RestoreChoixAlea{m}{%\\n  \\\\stepcounter{PfMAlea}%\\n  %Je restaure la valeur \\\\thePfMExoSol-\\\\thePfMAlea\\n  \\\\expandafter\\\\xdef\\\\csname #1\\\\endcsname{\\\\csname valeur\\\\Roman{PfMMaquette}\\\\Roman{PfMExoSol}\\\\roman{PfMAlea}\\\\endcsname}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\ExporteListe{mm}{%\\n  %#1 le nom de la liste\\n  %#2 le contenu de la liste.\\n  \\\\stepcounter{PfMAlea}%\\n  \\\\expandafter\\\\xdef\\\\csname Liste\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname{#2}%\\n  \\\\expandafter\\\\xdef\\\\csname #1\\\\endcsname{\\\\csname Liste\\\\Roman{PfMMaquette}\\\\Roman{PfMExo}\\\\roman{PfMAlea}\\\\endcsname}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\RestoreListe{m}{%\\n  %#1 le nom de la liste  restaurer\\n  \\\\stepcounter{PfMAlea}%\\n  \\\\expandafter\\\\xdef\\\\csname #1\\\\endcsname{\\\\csname Liste\\\\Roman{PfMMaquette}\\\\Roman{PfMExoSol}\\\\roman{PfMAlea}\\\\endcsname}%\\n}%\\n\\n%%\\n\\\\newcounter{Melquestions}%\\n\\\\newcounter{Comptequestions}%\\n%\\n\\\\NewDocumentEnvironment{Enumelange}{o+b}{%\\n  \\\\setcounter{Melquestions}{0}%\\n  \\\\setsepchar{\\\\item}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeTest{#2}%\\n  \\\\reademptyitems\\n % La liste des lments retenus est \\\\showitems*\\\\ListeTest[]\\\\par\\n  \\\\IfNoValueTF{#1}{%\\n    \\\\ChoixAleaMultiMix{\\\\ListeTestlen}{1}{\\\\ListeTestlen}{0}{\\\\ListeShuffleA}%\\n    \\\\xdef\\\\MelangeValeurTotale{\\\\ListeTestlen}%\\n  }{%\\n    \\\\ChoixAleaMultiMix{#1}{1}{\\\\ListeTestlen}{0}{\\\\ListeShuffleA}%\\n    \\\\xdef\\\\MelangeValeurTotale{#1}%\\n  }%\\n  \\\\ExporteListe{ListeShuffle}{\\\\ListeShuffleA}%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeNumQ{\\\\ListeShuffleA}%\\n  \\\\reademptyitems\\n % L'ordre des questions est \\\\ListeNumQ[]\\n  \\\\setcounter{Comptequestions}{1}%\\n  \\\\begin{enumerate}\\n    \\\\loop%\\n    \\\\setcounter{Melquestions}{\\\\ListeNumQ[\\\\theComptequestions]}%\\n  \\\\item \\\\ListeTest[\\\\theMelquestions]%\\n    \\\\stepcounter{Comptequestions}%\\n    \\\\ifnum\\\\theComptequestions<\\\\numexpr\\\\MelangeValeurTotale+1%\\n      \\\\repeat%\\n  \\\\end{enumerate}\\n}{}%\\n\\n\\\\NewDocumentEnvironment{Enumelangesol}{b}{%\\n  \\\\setcounter{Melquestions}{0}%\\n  \\\\setsepchar{\\\\item}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeTest{#1}%\\n  \\\\reademptyitems\\n  \\\\RestoreListe{ListeShuffle}%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeNumQ{\\\\ListeShuffle}%\\n  \\\\reademptyitems\\n%  la liste des lments retenus est \\\\showitems*\\\\ListeTest[]\\\\par\\n%  L'ordre des questions est \\\\ListeNumQ[]\\\\par\\n  \\\\setcounter{Comptequestions}{1}%\\n  \\\\begin{enumerate}\\n    \\\\loop%\\n    \\\\setcounter{Melquestions}{\\\\ListeNumQ[\\\\theComptequestions]}%\\n  \\\\item \\\\ListeTest[\\\\theMelquestions]%\\n    \\\\stepcounter{Comptequestions}%\\n    \\\\ifnum\\\\theComptequestions<\\\\numexpr\\\\ListeNumQlen+1%\\n      \\\\repeat%\\n  \\\\end{enumerate}\\n}{}%\\n\\n\\\\newcount\\\\PfManp%\\n\\\\newcount\\\\PfMbnp%\\n\\\\newcount\\\\PfMcnp%\\n\\\\newcount\\\\PfMdnp%\\n\\n\\\\NewDocumentCommand\\\\DeterminerNonPremiersEntreEuxInf{m}{%#1 : le nombre entier \\\\`a tester\\n  \\\\xdef\\\\RetiensNonPremiersEntreEuxInf{}%\\n  \\\\xdef\\\\RetiensPremiersEntreEuxInf{}%\\n  \\\\PfManp=#1%\\n  \\\\PfMbnp=2%\\n  \\\\PfMcnp=0%\\n  \\\\PfMdnp=0%\\n  \\\\whiledo{\\\\PfMbnp<\\\\PfManp}{%\\n    \\\\PGCD{\\\\the\\\\PfManp}{\\\\the\\\\PfMbnp}{}%\\n    \\\\ifnum\\\\pgcd>1\\\\relax\\n      \\\\PfMcnp=\\\\numexpr\\\\PfMcnp+1\\\\relax\\n      \\\\ifnum\\\\PfMcnp=1\\\\relax\\n        \\\\xdef\\\\RetiensNonPremiersEntreEuxInf{\\\\the\\\\PfMbnp}%\\n      \\\\else%\\n        \\\\xdef\\\\RetiensNonPremiersEntreEuxInf{\\\\RetiensNonPremiersEntreEuxInf,\\\\the\\\\PfMbnp}%\\n      \\\\fi%\\n    \\\\else\\n      \\\\PfMdnp=\\\\numexpr\\\\PfMdnp+1\\\\relax\\n      \\\\ifnum\\\\PfMdnp=1\\\\relax\\n        \\\\xdef\\\\RetiensPremiersEntreEuxInf{\\\\the\\\\PfMbnp}%\\n      \\\\else%\\n        \\\\xdef\\\\RetiensPremiersEntreEuxInf{\\\\RetiensPremiersEntreEuxInf,\\\\the\\\\PfMbnp}%\\n      \\\\fi%\\n    \\\\fi%\\n    \\\\PfMbnp=\\\\numexpr\\\\PfMbnp+1%\\n  }%\\n  \\\\ifnum\\\\PfMcnp=0\\\\relax%\\n    \\\\xdef\\\\RetiensNonPremiersEntreEuxInf{1}%\\n  \\\\fi%\\n  \\\\ifnum\\\\PfMdnp=0\\\\relax%\\n    \\\\xdef\\\\RetiensPremiersEntreEuxInf{1}%\\n  \\\\fi%\\n}%\\n\\n% Dfinitions pour les comptences\\n\\\\NewDocumentCommand\\\\Competences{O{3}m}{%\\n  \\\\setsepchar[*]{/}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeCompetence{#2}\\n  \\\\ifnum#1=3\\\\relax\\n  \\\\buildtabcompetences%\\n  \\\\else\\n  \\\\Buildtabcompetences{#1}{\\\\ListeCompetencelen}%\\n  \\\\fi\\n}\\n\\n\\\\def\\\\buildtabcompetences{%\\n  \\\\[\\\\begin{tabular}{|p{\\\\PfMCoefcompetences}|*{3}{>{\\\\centering\\\\arraybackslash}p{0.05\\\\linewidth}|}}\\n      \\\\cline{2-4}\\n      \\\\multicolumn{1}{c|}{}&\\\\PfMCompNA&\\\\PfMCompECA&\\\\PfMCompA\\\\\\\\\\n      \\\\hline\\n      \\\\xintFor* ##1 in {\\\\xintSeq {1}{\\\\ListeCompetencelen}}\\\\do{\\\\ListeCompetence[##1]&&&\\\\\\\\\\\\hline}\\n    \\\\end{tabular}\\n  \\\\]\\n}%\\n\\n\\\\def\\\\Buildtabcompetences#1#2{%\\n  \\\\setlength{\\\\PfMLargeurComp}{\\\\fpeval{\\\\PfMCoefCompetences-0.05*#1}\\\\linewidth-\\\\fpeval{2*(#1-3)}\\\\tabcolsep}%\\n  \\\\[\\\\begin{tabular}{|p{\\\\PfMLargeurComp}|*{#1}{>{\\\\centering\\\\arraybackslash}p{0.05\\\\linewidth}|}}%\\n      \\\\cline{2-\\\\fpeval{1+#1}}%\\n      \\\\multicolumn{1}{c|}{}\\\\xintFor* ##1 in{\\\\xintSeq{1}{#1}}\\\\do{%\\n      &\\\\ListeCompetence[##1]}\\\\\\\\%\\n      \\\\hline%\\n      \\\\xintFor* ##1 in {\\\\xintSeq {\\\\fpeval{#1+1}}{\\\\ListeCompetencelen}}\\\\do{\\\\ListeCompetence[##1]%\\n      \\\\xintFor* ##2 in {\\\\xintSeq{1}{#1}}\\\\do{&}%\\n      \\\\\\\\\\\\hline%\\n      }%\\n    \\\\end{tabular}%\\n  \\\\]%\\n}%\\n%\\n%\\n%%% Dfinitions des environnements pour la correction\\n\\\\makeatletter\\n\\\\newwrite\\\\verbatim@out\\n\\n\\\\def\\\\SolutionWrite{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\@bsphack%\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\thePfMExo.sol\\\"%\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials%\\n  \\\\catcode`\\\\^^M\\\\active%\\n  \\\\def\\\\verbatim@processline{%\\n    \\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}%\\n\\\\def\\\\endSolutionWrite{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}%\\n\\n\\\\def\\\\SolutionWritePP{%\\n  \\\\@bsphack\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-PPEx\\\\thePfMExo.sol\\\" %\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials\\n  \\\\catcode`\\\\^^M\\\\active\\n  \\\\def\\\\verbatim@processline{%\\n    \\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}\\n\\\\def\\\\endSolutionWritePP{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}\\n\\n\\\\def\\\\ReponseWrite{%\\n  \\\\@bsphack\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\thePfMExo.rep\\\" %\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials\\n  \\\\catcode`\\\\^^M\\\\active\\n  \\\\def\\\\verbatim@processline{%\\n    \\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}\\n\\\\def\\\\endReponseWrite{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}\\n\\n\\\\def\\\\IndiceWrite{%\\n  \\\\@bsphack\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\thePfMExo.cdp\\\" %coup de pouce\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials\\n  \\\\catcode`\\\\^^M\\\\active\\n  \\\\def\\\\verbatim@processline{%\\n    \\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}\\n\\\\def\\\\endIndiceWrite{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}\\n\\\\makeatother\\n\\n\\\\def\\\\SolutionNow{\\\\textbf{\\\\csname PfMTNomSol\\\\Roman{PfMExo}\\\\endcsname~--}\\\\par\\\\nopagebreak\\\\setcounter{PfMExoSol}{\\\\thePfMExo}\\\\setcounter{PfMAlea}{0}\\\\PfMAffichageHideItemSolution}%\\\\setcounter{PfMExoSolAlea}{\\\\thePfMExo}\\n\\\\def\\\\endSolutionNow{\\\\par\\\\goodbreak\\\\PfMshowitems}\\n\\n\\\\def\\\\ReponseNow{\\\\textbf{Rponse(s) de l'exercice --}\\\\par\\\\nopagebreak\\\\PfMAffichageHideItemSolution}\\n\\\\def\\\\endReponseNow{\\\\par\\\\goodbreak\\\\PfMshowitems}\\n\\n\\\\def\\\\IndiceNow{\\\\textbf{Indice(s) --}\\\\par\\\\nopagebreak\\\\PfMAffichageHideItemSolution}\\n\\\\def\\\\endIndiceNow{\\\\par\\\\goodbreak\\\\PfMshowitems}\\n\\n\\\\NewDocumentEnvironment{Solution}{}{}{}%\\n\\\\NewDocumentEnvironment{Reponse}{}{}{}%\\n\\\\NewDocumentEnvironment{Indice}{}{}{}%\\n\\\\NewDocumentEnvironment{PfMHide}{+b}{}{}%\\n\\\\NewDocumentEnvironment{PfMSeek}{+b}{#1}{}%\\n\\n\\\\NewDocumentEnvironment{AideA}{+b}{%\\n  \\\\ifnum\\\\fpeval{\\\\useKV[ClesExercices]{Aide}}>0\\\\relax%\\n    \\\\begin{PfMSeek}%\\n      #1\\n    \\\\end{PfMSeek}%\\n  \\\\else%\\n    \\\\begin{PfMHide}%\\n      #1\\n    \\\\end{PfMHide}\\n  \\\\fi%\\n}{%\\n}%\\n\\n\\\\NewDocumentEnvironment{AideB}{+b}{%\\n  \\\\ifnum\\\\fpeval{\\\\useKV[ClesExercices]{Aide}}>1\\\\relax%\\n    \\\\begin{PfMSeek}%\\n      #1\\n    \\\\end{PfMSeek}\\n  \\\\else%\\n    \\\\begin{PfMHide}%\\n      #1\\n    \\\\end{PfMHide}\\n  \\\\fi%\\n}{%\\n}%\\n  \\n\\\\NewDocumentEnvironment{Indications}{+b}{%\\n  \\\\ifnum\\\\theRetiensIndic=1\\\\relax%\\n    \\\\textbf{\\\\PfMTexteDesIndications :}\\\\par%\\n      #1\\n  \\\\fi%\\n}{%\\n}%\\n\\n\\\\makeatletter\\n\\\\NewDocumentCommand\\\\PfMChoixAffichageCorrection{}{%\\n  \\\\if@AssembleCorrections\\n    \\\\let\\\\Solution\\\\SolutionWrite\\\\let\\\\endSolution\\\\endSolutionWrite\\n  \\\\fi\\n  \\\\ifboolKV[Boulot]{CorrigeAll}{%\\n    \\\\let\\\\Solution\\\\SolutionWrite\\\\let\\\\endSolution\\\\endSolutionWrite\\n    \\\\let\\\\Reponse\\\\ReponseWrite\\\\let\\\\endReponse\\\\endReponseWrite\\n    \\\\let\\\\Indice\\\\IndiceWrite\\\\let\\\\endIndice\\\\endIndiceWrite\\n  }{%\\n  \\\\ifboolKV[Boulot]{ParcoursPerso}{%\\n    \\\\let\\\\Solution\\\\SolutionWritePP\\\\let\\\\endSolution\\\\endSolutionWritePP\\n  }{%\\n    \\\\ifnum\\\\theRetiensSol=1\\\\relax\\n    \\\\let\\\\Reponse\\\\comment\\\\let\\\\endReponse\\\\endcomment\\n    \\\\let\\\\Indice\\\\comment\\\\let\\\\endIndice\\\\endcomment\\n    \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n      \\\\let\\\\Solution\\\\SolutionWrite\\\\let\\\\endSolution\\\\endSolutionWrite\\n    }{\\\\ifboolKV[Boulot]{CorrigeApres}{%\\n        \\\\let\\\\Solution\\\\SolutionNow\\\\let\\\\endSolution\\\\endSolutionNow\\n      }{}%\\n    }%\\n    \\\\else\\n    \\\\let\\\\Solution\\\\comment\\\\let\\\\endSolution\\\\endcomment\\n    \\\\let\\\\Indice\\\\comment\\\\let\\\\endIndice\\\\endcomment\\n    \\\\ifnum\\\\theRetiensRep=1\\\\relax\\n    \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n      \\\\let\\\\Reponse\\\\ReponseWrite\\\\let\\\\endReponse\\\\endReponseWrite\\n    }{\\\\ifboolKV[Boulot]{CorrigeApres}{%\\n        \\\\let\\\\Reponse\\\\ReponseNow\\\\let\\\\endReponse\\\\endReponseNow\\n      }{}%\\n    }%\\n    \\\\else\\n    \\\\let\\\\Solution\\\\comment\\\\let\\\\endSolution\\\\endcomment\\n    \\\\let\\\\Reponse\\\\comment\\\\let\\\\endReponse\\\\endcomment\\n    \\\\ifnum\\\\theRetiensInd=1\\\\relax\\n    \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n      \\\\let\\\\Indice\\\\IndiceWrite\\\\let\\\\endIndice\\\\endIndiceWrite\\n    }{\\\\ifboolKV[Boulot]{CorrigeApres}{%\\n        \\\\let\\\\Indice\\\\IndiceNow\\\\let\\\\endIndice\\\\endIndiceNow\\n      }{}%\\n    }%\\n    \\\\fi\\n    \\\\fi\\n    \\\\fi\\n  }%\\n  }%\\n}%\\n\\\\makeatother\\n\\n\\\\makeatletter\\n\\\\NewDocumentCommand\\\\PfMChoixCorrection{}{%\\n  \\\\setcounter{RetiensSol}{0}%\\n  \\\\setcounter{RetiensRep}{0}%\\n  \\\\setcounter{RetiensInd}{0}%\\n  \\\\if@AssembleCorrections\\n    \\\\setcounter{RetiensSol}{1}%\\n  \\\\else\\n  \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n%    \\\\ifboolKV[Boulot]{CorrigeAll}{%\\n%      \\\\setcounter{RetiensSol}{1}%\\n%      \\\\setcounter{RetiensRep}{1}%\\n%      \\\\setcounter{RetiensInd}{1}%\\n%    }{%\\n      \\\\setcounter{RetiensSol}{1}%\\n      \\\\setcounter{RetiensRep}{0}%\\n      \\\\setcounter{RetiensInd}{0}%\\n%    }%\\n  }{\\\\ifboolKV[Boulot]{CorrigeApres}{%\\n      \\\\setcounter{RetiensSol}{1}%\\n      \\\\setcounter{RetiensRep}{0}%\\n      \\\\setcounter{RetiensInd}{0}%\\n    }{}%\\n  }%\\n  \\\\fi\\n  \\\\ifboolKV[ClesExercices]{PasCorrige}{%\\n    \\\\setcounter{RetiensSol}{0}%\\n    \\\\setcounter{RetiensRep}{0}%\\n    \\\\setcounter{RetiensInd}{0}%\\n  }{%\\n    \\\\ifboolKV[ClesExercices]{Direct}{%\\n      \\\\setcounter{RetiensSol}{0}%\\n      \\\\setcounter{RetiensRep}{1}%\\n      \\\\setcounter{RetiensInd}{0}%\\n    }{%\\n      \\\\ifboolKV[ClesExercices]{Pouce}{%\\n        \\\\setcounter{RetiensSol}{0}%\\n        \\\\setcounter{RetiensRep}{0}%\\n        \\\\setcounter{RetiensInd}{1}%\\n      }{}%\\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n\\n\\\\NewDocumentCommand\\\\PfMChoixEntrainement{}{%\\n  \\\\setcounter{PfMRetiensQr}{0}%\\n  \\\\ifboolKV[ClesExercices]{AEntretenir}{\\\\setcounter{PfMRetiensQr}{1}}{}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMChoixAffichageEntrainement{}{%\\n  \\\\ifnum\\\\thePfMRetiensQr=1\\\\relax%\\n    \\\\let\\\\Entrainement\\\\EntrainementWrite\\\\let\\\\endEntrainement\\\\endEntrainementWrite%\\n  \\\\else%\\n    \\\\let\\\\Entrainement\\\\comment\\\\let\\\\endEntrainement\\\\endcomment\\n  \\\\fi%\\n}%\\n\\n\\\\def\\\\PfMTexteDuCorrige{Corrig de l'exercice}%\\n\\\\def\\\\PfMTexteDeLEntrainement{Automatisme(s) li(s)  l'exercice}%\\n\\\\def\\\\PfMTexteDesIndications{Indications}%\\n\\n\\\\NewDocumentCommand\\\\PfMAffichageCorrige{}{%\\n  \\\\ifboolKV[Boulot]{CAN}{%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\PfMCANTotalExo}}\\\\do{%\\n      \\\\setcounter{PfMExoSol}{##1}%\\n      \\\\setcounter{PfMAlea}{0}%\\n      \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.sol}{\\\\textbf{Question\\\\ifnum\\\\PfMCANTotalExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{TestCAN-##1}}:\\\\fi}~\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.sol}\\\\par\\\\goodbreak}{}%\\n    }%\\n  }{%\\n    \\\\setcounter{PfMExoSol}{0}%\\n    %\\\\setcounter{PfMExoSolAlea}{0}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\thePfMExo}}\\\\do{%\\n      \\\\refstepcounter{PfMExoSol}%\\n      %\\\\stepcounter{PfMExoSolAlea}%\\n      \\\\label{pagesol-\\\\thePfMMaquette-\\\\thePfMExoSol}%\\n      \\\\setcounter{PfMAlea}{0}%\\n      \\\\def\\\\PfMTexteDuCorrige{\\\\csname PfMTNomSol\\\\Roman{PfMExoSol}\\\\endcsname}%\\n      \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.sol}{\\\\PfMAffichageHideItemSolution\\\\textbf{\\\\PfMTexteDuCorrige\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{page-\\\\thePfMMaquette-##1}}\\\\fi\\\\PfMAffichageTitreSolution}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.sol}\\\\par\\\\goodbreak}{\\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.rep}{\\\\PfMAffichageHideItemSolution\\\\textbf{Rponse(s) seule(s) de l'exercice\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{page-\\\\thePfMMaquette-##1}}\\\\fi}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.rep}\\\\par\\\\goodbreak}{%\\n          \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.cdp}{\\\\PfMAffichageHideItemSolution\\\\textbf{Indice(s) pour l'exercice\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{page-\\\\thePfMMaquette-##1}}\\\\fi}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.cdp}\\\\par\\\\goodbreak}{}%\\n        }%\\n      }%\\n      \\\\PfMshowitems%\\n    }%\\n  }%\\n}%\\n\\n% Tous les corrigs\\n\\\\NewDocumentCommand\\\\PfMAffichageTousCorriges{}{%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeNombreExoMq{\\\\PfMRetiensLienExoMa}%\\n  \\\\reademptyitems%\\n  \\\\xdef\\\\Tototaltal{\\\\thePfMMaquette}%\\n  \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\Tototaltal}}\\\\do{%\\n    \\\\refstepcounter{PfMMaquetteSol}%\\n    \\\\setcounter{PfMMaquette}{##2}%\\n    \\\\setcounter{PfMExoSol}{0}%\\n    %\\\\setcounter{PfMExoSolAlea}{0}%\\n    \\\\ifPfMRectoVerso%\\n      \\\\cleardoublepage%\\n    \\\\else%\\n      \\\\clearpage%\\n    \\\\fi%\\n    \\\\input{\\\\jobname-DefiMq-\\\\thePfMMaquette}%\\n    \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeNombreExoMq[##2]}}\\\\do{%\\n      \\\\stepcounter{PfMExoSol}%\\n      %\\\\stepcounter{PfMExoSolAlea}%\\n      \\\\label{pagesol-\\\\thePfMMaquetteSol-\\\\thePfMExoSol}%\\n      \\\\setcounter{PfMAlea}{0}%\\n      \\\\IfFileExists{\\\\jobname-Ma##2-Ex##1.sol}{\\\\PfMAffichageHideItemSolution\\\\textbf{\\\\PfMTexteDuCorrige\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{page-##2-##1}}\\\\fi\\\\PfMAffichageTitreSolution}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma##2-Ex##1.sol}\\\\par\\\\goodbreak}{\\\\IfFileExists{\\\\jobname-Ma##2-Ex##1.rep}{\\\\PfMAffichageHideItemSolution\\\\textbf{Rponse(s) seule(s) de l'exercice\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{page-##2-##1}}\\\\fi}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma##2-Ex##1.rep}\\\\par\\\\goodbreak}{%\\n          \\\\IfFileExists{\\\\jobname-Ma##2-Ex##1.cdp}{\\\\PfMAffichageHideItemSolution\\\\textbf{Indice(s) pour l'exercice\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ifboolKV[Boulot]{CorrigeSeul}{##1}{\\\\ref{page-##2-##1}}\\\\fi}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma##2-Ex##1.cdp}\\\\par\\\\goodbreak}{}%\\n        }%\\n      }%\\n      \\\\PfMshowitems%\\n    }%\\n    \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n  }%\\n}%\\n\\n\\\\NewDocumentEnvironment{Entrainement}{}{}{}%\\n\\n\\\\makeatletter\\n\\\\def\\\\EntrainementWrite{%\\n  \\\\@bsphack%\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\thePfMExo.qrc\\\"%\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials%\\n  \\\\catcode`\\\\^^M\\\\active%\\n  \\\\def\\\\verbatim@processline{%\\n    \\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}%\\n\\\\def\\\\endEntrainementWrite{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}%\\n\\\\makeatother\\n\\n\\\\NewDocumentCommand\\\\PfMAffichageEntrainement{}{%\\n  \\\\ifboolKV[Boulot]{ESansSaut}{\\\\vfill}{%\\n    \\\\ifPfMDeuxColonnes\\n      \\\\newpage\\n    \\\\else\\n      \\\\ifPfMRectoVerso\\n        \\\\cleardoublepage\\n      \\\\else\\n        \\\\clearpage\\n      \\\\fi\\n    \\\\fi\\n  }%\\n  \\\\TikzAutomatismes\\n  \\\\setlength{\\\\columnseprule}{\\\\useKV[Boulot]{EEpaisseur}}%\\n  \\\\ifboolKV[Boulot]{EntrainementColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{EColonnes}}}{}%\\n  \\\\setcounter{PfMExoEntrai}{0}%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\thePfMExo}}\\\\do{%\\n    \\\\refstepcounter{PfMExoEntrai}%\\n    \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.qrc}{%\\n      \\\\begin{center}\\n        \\\\label{pageentrai-\\\\thePfMMaquette-\\\\thePfMExoEntrai}%\\n        \\\\textbf{\\\\PfMTexteDeLEntrainement\\\\ifnum\\\\thePfMExo=1\\\\relax\\\\else~\\\\ref{page-\\\\thePfMMaquette-##1}\\\\fi}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.qrc}\\\\end{center}%\\n    }{}%\\n  }%\\n  \\\\ifboolKV[Boulot]{EntrainementColonnes}{\\\\end{multicols}}{}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzAutomatismes{}{%\\n  \\\\begin{tcolorbox}\\n    \\\\begin{center}\\n      \\\\Large\\\\sffamily Automatismes%\\n    \\\\end{center}\\n  \\\\end{tcolorbox}%\\n}%\\n\\n%%%%%%%% BAREME %%%%%%%%%%%\\n%% Bareme\\n\\\\newlength{\\\\brouillon}\\n\\n\\\\newcommand*\\\\FranPt[1]{%\\n%  \\\\ifboolKV[ClesExercices]{BaremeDetaille}{%\\n    \\\\color{gray!75}(\\\\num{#1})%\\n%  }{}\\n}\\n\\n\\\\makeatletter\\n\\\\newcommand\\\\BaremeEspace@Marge{18pt}\\n\\\\newcommand\\\\BaremeEspace@MargeCorrection{0pt}\\n%\\\\f@size est la taille par dfaut de la fonte.\\n\\n\\\\newcommand*\\\\brm[1]{%\\n  \\\\ifboolKV[Boulot]{Fiche}{}{%\\n    \\\\ifboolKV[Boulot]{FdR}{}{%\\n      \\\\ifboolKV[Boulot]{Contrat}{}{%\\n        \\\\ifboolKV[Boulot]{Parcours}{}{%\\n          \\\\immediate\\\\write\\\\@auxout{%\\n            \\\\string\\\\opadd*{#1}%\\n            {total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n            {total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n            \\\\string\\\\opcopy{\\\\thePfMExo}{TotalExo}%\\n          }%\\n          \\\\ifboolKV[ClesExercices]{BaremeDetaille}{%\\n            \\\\setlength{\\\\brouillon}{\\\\BaremeEspace@Marge-\\\\linewidth+\\\\textwidth}%\\n            \\\\makebox[0pt][r]{\\\\footnotesize\\\\FranPt{#1}\\\\hspace*{\\\\brouillon}}%\\n            \\\\ignorespaces%\\n          }{}%\\n        }%\\n      }%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\BRM{som}{%\\n  \\\\ifboolKV[Boulot]{Fiche}{}{%\\n    \\\\immediate\\\\write\\\\@auxout{%\\n      \\\\string\\\\opadd*{#3}%\\n      {total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n      {total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n      \\\\string\\\\opcopy{\\\\thePfMExo}{TotalExo}%\\n    }%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\ifboolKV[ClesExercices]{BaremeDetaille}{%\\n        \\\\setlength{\\\\brouillon}{\\\\fpeval{\\\\BaremeEspace@Marge-#2}pt}%\\n        \\\\makebox[0pt][r]{\\\\footnotesize\\\\FranPt{#3}\\\\hspace*{\\\\brouillon}}%\\n        \\\\ignorespaces%\\n      }{}%\\n    }{%\\n      \\\\ifboolKV[ClesExercices]{BaremeDetaille}{%\\n        \\\\setlength{\\\\brouillon}{\\\\BaremeEspace@Marge-\\\\linewidth+\\\\textwidth}%\\n        \\\\makebox[0pt][r]{\\\\footnotesize\\\\FranPt{#3}\\\\hspace*{\\\\brouillon}}%\\n        \\\\ignorespaces%\\n      }{}%\\n    }%\\n  }%\\n}%\\n\\n\\\\newcommand*{\\\\Brm}[1]{%\\n  \\\\ifboolKV[Boulot]{Fiche}{}{%\\n    \\\\setlength{\\\\brouillon}{\\\\BaremeEspace@MargeCorrection-\\\\linewidth+\\\\textwidth}%\\n    \\\\makebox[0pt][r]{\\\\footnotesize\\\\color{gray!75}(\\\\opprint{#1})\\\\hspace*{\\\\brouillon}}%\\n    \\\\ignorespaces%\\n  }%\\n}%\\n\\n\\\\newcommand\\\\total[1]{%\\n  \\\\@ifundefined{Op@total#1}{recompilez}%\\n  {%\\n    \\\\opunzero{total#1}% on ne sait jamais\\n    \\\\opset{decimalsepsymbol={,}}%\\n    \\\\opprint{total#1}~%\\n    \\\\opset{decimalsepsymbol={.}}%\\n    \\\\useKV[ClesExercices]{MotPoint}%\\n    \\\\opcmp{total#1}{2}%\\n    \\\\ifopge s\\\\fi%\\n  }%\\n}\\n\\n\\\\newcommand\\\\ScoreMaximal{%\\n  \\\\@ifundefined{Op@ScoreTotal\\\\thePfMMaquette}{recompilez}%\\n  {%\\n    \\\\opunzero{ScoreTotal\\\\thePfMMaquette}% on ne sait jamais\\n    \\\\opset{decimalsepsymbol={,}}%\\n    \\\\opprint{ScoreTotal\\\\thePfMMaquette}~%\\n    \\\\opset{decimalsepsymbol={.}}%\\n    \\\\useKV[ClesExercices]{MotPoint}%\\n    \\\\opcmp{ScoreTotal\\\\thePfMMaquette}{2}%\\n    \\\\ifopge s\\\\fi%\\n  }%\\n}\\n\\n\\\\newcommand\\\\NoteFinale{%\\n  \\\\@ifundefined{Op@TotalExo}{Recompilez}%\\n  {%\\n    \\\\opexport{TotalExo}{\\\\TotalExo}%Le total d'exercices est \\\\TotalExo.\\n    \\\\xdef\\\\NoteTotale{0}%\\n    \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\TotalExo}}\\\\do{%\\n     \\\\opexport{total##1-##1}{\\\\totalUn}%\\n     \\\\xdef\\\\NoteTotale{\\\\fpeval{\\\\NoteTotale+\\\\totalUn}}%\\n   }%\\n   \\\\NoteTotale%\\n  }%\\n}%\\n\\n\\\\def\\\\TexteDevantPointParExercice{}%\\n\\n\\\\newcommand\\\\TableauRecapitulatif{%\\n  \\\\@ifundefined{Op@TotalExo}{Recompilez}%\\n  {%\\n    \\\\opexport{TotalExo}{\\\\TotalExo}%\\n    \\\\begin{tabular}{|c|c|}\\n      \\\\hline\\n      \\\\multicolumn{2}{|c|}{Barme rcapitulatif}\\\\\\\\\\n      \\\\hline\\n      \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\TotalExo}}\\\\do{\\n      Exercice ##1&\\\\TexteDevantPointParExercice\\\\total{##1-##1}\\\\\\\\\\n      }\\n      \\\\hline\\n    \\\\end{tabular}\\n  }\\n}%\\n\\\\makeatother\\n%%%%%%%% FIN BAREME %%%%%%%%%%%%%%%%\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\n%%% Commandes pour les affichages optionnels dans les cadres\\n\\\\NewDocumentCommand{\\\\PfMAffichageLogos}{}{%\\n  \\\\ifboolKV[ClesExercices]{Calculatrice}{}{\\\\node[fill=white,anchor=west,xshift=(\\\\thePfMNbLogo*2.5+(\\\\thePfMNbLogo-1)*20)*1pt] at (A.east) {\\\\cancel{\\\\faCalculator}};\\\\stepcounter{PfMNbLogo}}%\\n  \\\\ifboolKV[ClesExercices]{Oral}{\\\\node[fill=white,anchor=west,xshift=(\\\\thePfMNbLogo*2.5+(\\\\thePfMNbLogo-1)*20)*1pt] at (A.east) {\\\\faBullhorn};\\\\stepcounter{PfMNbLogo}}{}\\n  % \\n  \\\\ifnum\\\\fpeval{\\\\useKV[ClesExercices]{NombreEleves}}=1\\\\relax\\n    \\\\node[colLogo,fill=white,anchor=west,xshift=(\\\\thePfMNbLogo*2.5+(\\\\thePfMNbLogo-1)*20)*1pt] at (A.east) {\\\\faUser};\\\\stepcounter{PfMNbLogo}\\n  \\\\else%\\n    \\\\ifnum\\\\fpeval{\\\\useKV[ClesExercices]{NombreEleves}}>1\\\\relax\\n      \\\\node[colLogo,fill=white,anchor=west,xshift=(\\\\thePfMNbLogo*2.5+(\\\\thePfMNbLogo-1)*20)*1pt] at (A.east) {\\\\faUsers};\\\\stepcounter{PfMNbLogo}%\\n    \\\\fi%\\n  \\\\fi%\\n}\\n%\\n\\\\NewDocumentCommand{\\\\PfMAffichageCompetencesTravaillees}{}{%\\n  \\\\ifboolKV[ClesExercices]{AffichageCompetence}{%\\n     \\\\node[%\\n     fill=white,%\\n     anchor=east,%\\n     xshift=-10pt,%\\n     text=PfMColCpt,%\\n     ]\\n     at (frame.north east)\\n     {\\\\itshape\\\\scriptsize\\\\sffamily Comptence(s) dominante(s) : \\\\useKV[ClesExercices]{Competence}};\\n   }{}%\\n }%\\n%\\n\\\\NewDocumentCommand{\\\\PfMLienVersSolution}{}{%\\n  \\\\ifboolKV[Boulot]{VersSolution}{%\\n    \\\\ifboolKV[ClesExercices]{PasCorrige}{}{%\\n      \\\\node[%\\n      fill=tcbcolback,%\\n      anchor=center,%\\n      ] at ($(frame.north east)!0.25!(frame.south east)$){\\\\hyperref[pagesol-\\\\thePfMMaquette-\\\\thePfMExo]{\\\\faKey}};%\\n    }%\\n  }{}%\\n}%\\n\\n\\\\NewDocumentCommand{\\\\PfMLienVersEntrainement}{}{%\\n  \\\\ifboolKV[Boulot]{AvecEntrainement}{%\\n    \\\\ifboolKV[ClesExercices]{AEntretenir}{%\\n      \\\\node[%\\n      fill=tcbcolback,%\\n      anchor=center,rotate=45%\\n      ] at ($(frame.north east)!0.75!(frame.south east)$){\\\\hyperref[pageentrai-\\\\thePfMMaquette-\\\\thePfMExo]{\\\\faDumbbell}};%\\n    }{}%\\n  }{}%\\n}%\\n\\n\\\\makeatletter\\n\\\\NewDocumentCommand{\\\\PfMAffichageSource}{}{%\\n  \\\\ifboolKV[ClesExercices]{AffichageSource}{%\\n    \\\\node[%\\n    fill=tcbcolback,\\n    anchor=east,\\n    yshift=0.5pt,\\n    xshift=-\\\\kvtcb@rightlower,%-10pt,\\n    text=PfMColSrc,\\n    ]\\n    at (frame.south east)\\n    {\\\\scriptsize\\\\sffamily \\\\useKV[ClesExercices]{Source}};\\n  }{}%\\n}%\\n\\\\makeatother\\n%%%%%%%%%%%%%%%%%%%%%%%%\\n%\\n%\\n%%%Style des diffrents documents\\n\\\\tcbset{%\\n  tikzbase/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    bicolor,\\n    colback=LightSteelBlue,\\n    colbacklower=white,\\n    frame hidden,\\n    overlay=\\\\useKV[ClesExercices]{Ajout}%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  tikzbasehtml/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    fonttitle=\\\\bfseries\\\\sffamily,\\n    title=\\\\ifboolKV[ClesExercices]{AffichageTitre}{\\\\useKV[ClesExercices]{Titre}}{},%\\n    coltitle=black,\\n    frame hidden,\\n    overlay=\\\\useKV[ClesExercices]{Ajout}%\\n  }\\n}\\n\\n\\\\makeatletter\\n%%% Base des exercices DM\\n\\\\tcbset{%\\n  tikzdm/.style={%\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=PfMCadreDM,\\n    fonttitle=\\\\bfseries\\\\sffamily,\\n    title=Exercice\\\\ifboolKV[ClesExercices]{Numerote}{ \\\\thePfMExo}{}\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{},\\n    attach boxed title to top left={xshift=0.2mm},\\n    boxed title size=standard,\\n    boxed title style={%\\n      empty,\\n      rounded corners=north, \\n      boxrule=0pt,\\n      bottom=0pt\\n    },\\n    underlay boxed title={%\\n      \\\\filldraw[rounded corners, gray!85, line width=.5mm]\\n      (title.south east)--++(90:\\\\tcboxedtitleheight)--++(183:\\\\tcboxedtitlewidth)--++(-90:\\\\tcboxedtitleheight)|-cycle;\\n    },%\\n    overlay unbroken and first={%\\n      %\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %\\n      \\\\PfMAffichageSource%\\n      %\\n      \\\\ifboolKV[ClesExercices]{BaremeTotal}{%\\n        \\\\node[\\n        fill=white,\\n        anchor=east,\\n        xshift=-10pt,\\n        text=black,\\n        font=\\\\bfseries\\n        ]\\n        at (frame.north east)\\n        {\\\\footnotesize\\\\sffamily \\\\total{\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}};\\n      }{}%\\n      \\\\PfMLienVersSolution%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentEnvironment{exerciceDM}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n  \\\\IfBooleanTF{#1}{%\\n    \\\\setKV[ClesExercices]{Numerote=false}%\\n  }{}%\\n  \\\\PfMAvantLesExercices%\\n  \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\immediate\\\\write\\\\@auxout{%\\n    \\\\string\\\\opcopy{\\\\thePfMExo}{TotalExo}%\\n  }%\\n  \\\\ifboolKV[ClesExercices]{BaremeTotal}{%\\n    \\\\immediate\\\\write\\\\@auxout{%\\n      \\\\string\\\\opcopy{0}{total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n    }}{}%\\n  \\\\begin{tcolorbox}[%\\n  tikzdm,%\\n  label is label,%\\n  label=page-\\\\thePfMMaquette-\\\\thePfMExo,%\\n  ]%\\n  \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n}%\\n}%\\n}{%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n  \\\\end{tcolorbox}%\\n  \\\\PfMApresLesExercices%\\n}%\\n}%\\n}%\\n\\n%%Contrat\\n\\n%\\\\makeatletter\\n\\\\NewDocumentCommand\\\\AfficheContrat{o}{%\\n  \\\\useKVdefault[SchemaContrat]%\\n  \\\\setKV[SchemaContrat]{#1}%\\n  \\\\setlength{\\\\PfMLargeurSchemaContrat}{\\\\useKV[SchemaContrat]{Ecart}}%\\n  \\\\setlength{\\\\PfMRayonSchemaContrat}{\\\\useKV[SchemaContrat]{Rayon}}%\\n  %\\\\colorlet{PfMCouleurSP}{\\\\useKV[SchemaContrat]{Couleur}}%\\n  \\\\@ifundefined{Op@\\\\Roman{PfMMaquette}-ContratTotalExo}{Recompilez pour obtenir le contrat.}%\\n  {%\\n    \\\\opexport{\\\\Roman{PfMMaquette}-ContratTotalExo}{\\\\ContratTotalExo}%\\n%    % Total Exo : \\\\ContratTotalExo\\n    \\\\setsepchar{,}\\\\ignoreemptyitems%\\n    \\\\xdef\\\\PfCFooListeA{\\\\csname \\\\Roman{PfMMaquette}Contrata\\\\endcsname}%\\n    \\\\xdef\\\\PfCFooListeB{\\\\csname \\\\Roman{PfMMaquette}Contratb\\\\endcsname}%\\n    \\\\readlist*\\\\ListeA{\\\\PfCFooListeA}%\\n    \\\\readlist*\\\\ListeB{\\\\PfCFooListeB}%\\n%    Liste A : \\\\showitems\\\\ListeA[]\\\\par\\n%    Liste B : \\\\showitems\\\\ListeB[]\\\\par\\n%    % On crit en supposant que la liste A est la plus longue\\n    \\\\xdef\\\\LongueurA{\\\\ListeAlen}%\\n    \\\\xdef\\\\LongueurB{\\\\ListeBlen}%\\n    \\\\xdef\\\\Foo{}%\\n    \\\\xdef\\\\Decalage{0}%\\n    % On change la liste B en ajoutant des 0 o il manque des lments.\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\LongueurB}}\\\\do{%\\n      \\\\xdef\\\\Test{0}%\\n      \\\\xintFor * ##2 in {\\\\xintSeq{1}{\\\\LongueurA}}\\\\do{%\\n        % ListeA vaut \\\\ListeA[##2] et ListeB vaut \\\\ListeB[##1]\\\\par\\n        \\\\IfStrEq{\\\\ListeA[##2]}{\\\\ListeB[##1]}{\\\\xdef\\\\Test{\\\\fpeval{\\\\Test+1}}\\\\xdef\\\\Position{##2}}{}%\\n      }%\\n      \\\\xintifboolexpr{\\\\Test==0}{%pas prsent\\n        \\\\xdef\\\\Foo{\\\\Foo,\\\\ListeB[##1]}\\n      }{%prsent\\n        \\\\xintifboolexpr{\\\\Position>\\\\fpeval{##1+\\\\Decalage}}{%\\n          \\\\xintFor* ##3 in{\\\\xintSeq{\\\\fpeval{##1+\\\\Decalage}}{\\\\fpeval{\\\\Position-1}}}\\\\do{%\\n            \\\\xdef\\\\Foo{\\\\Foo,0}%\\n          }\\n          \\\\xdef\\\\Decalage{\\\\fpeval{\\\\Position-##1-\\\\Decalage}}\\n        }{}\\n        \\\\xdef\\\\Foo{\\\\Foo,\\\\ListeB[##1]}\\n      }%\\n    }%\\n    % on vrifie qu'on n'a pas oubli des 0 :)\\n    \\\\readlist*\\\\ListeB{\\\\Foo}%\\n    \\\\ifnum\\\\ListeAlen>\\\\ListeBlen\\\\relax\\n      \\\\xintFor* ##4 in{\\\\xintSeq{1}{\\\\fpeval{\\\\ListeAlen-\\\\ListeBlen}}}\\\\do{\\n        \\\\xdef\\\\Foo{\\\\Foo,0}\\n      }\\n    \\\\fi\\n%    La liste A est \\\\showitems\\\\ListeA[]\\\\par\\n    \\\\readlist*\\\\ListeB{\\\\Foo}%\\n%    La liste B modifie est \\\\showitems\\\\ListeB[]\\\\par\\n    \\\\xdef\\\\FooNoeuds{}%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeA{%\\n      \\\\xdef\\\\FooNoeuds{\\\\FooNoeuds,\\\\ListeA[\\\\compteurcnt]/\\\\ListeB[\\\\compteurcnt]}%\\n    }%\\n    \\\\BuildConfianceTikz{\\\\FooNoeuds}%\\n  }%\\n}%\\n%\\\\makeatother\\n\\n\\\\NewDocumentCommand\\\\BuildConfianceTikz{m}{%\\n  \\\\setsepchar[*]{,*/}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\Noeuds{#1}%\\n  \\\\begin{tikzpicture}\\n    \\\\coordinate (C-0) at (-\\\\PfMLargeurSchemaContrat,0);%\\n    \\\\coordinate (A-0) at (-\\\\PfMLargeurSchemaContrat,-\\\\PfMLargeurSchemaContrat+\\\\PfMRayonSchemaContrat);%\\n    \\\\coordinate (B-0) at (-\\\\PfMLargeurSchemaContrat,\\\\PfMLargeurSchemaContrat-\\\\PfMRayonSchemaContrat);%\\n    \\\\xintFor*##1 in{\\\\xintSeq{1}{\\\\fpeval{\\\\Noeudslen+1}}}\\\\do{%\\n      \\\\coordinate[xshift=\\\\PfMLargeurSchemaContrat] (C-##1) at (C-\\\\fpeval{##1-1});%\\n      \\\\coordinate[xshift=\\\\PfMLargeurSchemaContrat] (A-##1) at (A-\\\\fpeval{##1-1});%\\n      \\\\coordinate[xshift=\\\\PfMLargeurSchemaContrat] (B-##1) at (B-\\\\fpeval{##1-1});%\\n    }%\\n    % On place les points\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\Noeudslen}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\Noeuds[##1,1]==\\\\Noeuds[##1,2]}{%\\n        \\\\coordinate (A-##1) at (C-##1);%\\n        \\\\coordinate (B-##1) at (C-##1);%\\n      }{}%\\n    }%\\n    % on trace\\n    \\\\xintifboolexpr{\\\\Noeuds[1,1]==\\\\Noeuds[1,2]}{\\\\draw[line width=1pt,->] (C-0)--(C-1);%\\n    }{%\\n      \\\\draw[line width=1pt,->] (A-0)--(A-1);\\n      \\\\draw[line width=1pt,->] (B-0)--(B-1);\\n    }%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\Noeudslen}}\\\\do{%\\n      \\\\draw[line width=1pt] (A-\\\\fpeval{##1-1})--(A-##1);%\\n      \\\\draw[line width=1pt] (B-\\\\fpeval{##1-1})--(B-##1);%\\n    }%\\n    \\\\xintifboolexpr{\\\\Noeuds[\\\\Noeudslen,1]==\\\\Noeuds[\\\\Noeudslen,2]}{\\\\draw[line width=1pt,->] (C-\\\\Noeudslen)--(C-\\\\fpeval{\\\\Noeudslen+1});%\\n    }{%\\n      \\\\draw[line width=1pt,->] (A-\\\\Noeudslen)--(A-\\\\fpeval{\\\\Noeudslen+1});\\n      \\\\draw[line width=1pt,->] (B-\\\\Noeudslen)--(B-\\\\fpeval{\\\\Noeudslen+1});\\n    }%\\n    % on dessine les cercles\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\Noeudslen}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\Noeuds[##1,1]==\\\\Noeuds[##1,2]}{%\\n        \\\\draw[fill=white] (C-##1) circle (\\\\PfMRayonSchemaContrat) node{\\\\ref{page-\\\\thePfMMaquette-\\\\Noeuds[##1,1]}};%\\n      }{%\\n        \\\\draw[fill=white] (A-##1) circle (\\\\PfMRayonSchemaContrat) node{\\\\ref{page-\\\\thePfMMaquette-\\\\Noeuds[##1,1]}};%\\n        \\\\xintifboolexpr{\\\\Noeuds[##1,2]==0}{}{\\\\draw[fill=white] (B-##1) circle (\\\\PfMRayonSchemaContrat) node{\\\\ref{page-\\\\thePfMMaquette-\\\\Noeuds[##1,2]}};}%\\n      }%\\n    }%\\n  \\\\end{tikzpicture}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\RemplisContrat{m}{%\\n  \\\\ifcsname \\\\Roman{PfMMaquette}confiance#1\\\\endcsname\\n  \\\\expandafter\\\\xdef\\\\csname \\\\Roman{PfMMaquette}confiance#1\\\\endcsname{\\\\csname \\\\Roman{PfMMaquette}confiance#1\\\\endcsname,\\\\thePfMExo}%\\n%  Yes !\\n  \\\\else\\n%  No !\\n  \\\\expandafter\\\\xdef\\\\csname \\\\Roman{PfMMaquette}confiance#1\\\\endcsname{\\\\thePfMExo}%\\n  \\\\fi\\n  \\\\immediate\\\\write\\\\@auxout{\\\\noexpand\\\\expandafter\\\\gdef\\\\noexpand\\\\csname \\\\Roman{PfMMaquette}Contrat#1\\\\endcsname{\\\\csname \\\\Roman{PfMMaquette}confiance#1\\\\endcsname}}%\\n}%\\n\\n\\\\NewDocumentEnvironment{exerciceContrat}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n  \\\\IfBooleanTF{#1}{%\\n    \\\\setKV[ClesExercices]{Numerote=false}%\\n  }{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n  \\\\PfMAvantLesExercices%\\n  \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\immediate\\\\write\\\\@auxout{\\\\string\\\\opcopy{\\\\thePfMExo}{\\\\Roman{PfMMaquette}-ContratTotalExo}}%\\n  % Creation des parcours\\n  \\\\ifboolKV[ClesExercices]{Contrat}{%\\n    % Remise  zro de conteneurs des parcours\\n    \\\\setsepchar{,}%\\n    \\\\xdef\\\\PfMFooListeContrat{\\\\useKV[ClesExercices]{Confiance}}\\n    \\\\readlist*\\\\ListeContrat{\\\\PfMFooListeContrat}%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeContrat{%\\n      \\\\RemplisContrat{\\\\ListeContrat[\\\\compteurcnt]}%\\n    }%\\n  }{}%\\n  %\\n  \\\\begin{tcolorbox}[%\\n    tikzcontrat,\\n    label is label,\\n    label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n    ]\\n    \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n  }%\\n  }%\\n}{%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n    \\\\end{tcolorbox}\\n    \\\\PfMApresLesExercices%\\n  }%\\n  }%\\n}%\\n%%% Contrat %%%\\n\\\\tcbset{%\\n  usercontrat/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  usercontratcor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzContrat{}{%\\n  \\\\begin{tcolorbox}[usercontrat]%\\n    \\\\Large\\\\sffamily \\\\useKV[Contrat]{Theme}\\\\hfill\\\\useKV[Contrat]{Niveau} \\\\useKV[Contrat]{Classe}%\\n    \\\\par{\\\\tiny\\\\useKV[Contrat]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Contrat]{Date}}%\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzContratCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\clearpage\\n  \\\\setKV[Contrat]{#1}%\\n  \\\\begin{tcolorbox}[usercontratcor]%\\n    \\\\Large\\\\sffamily \\\\useKV[Contrat]{Theme} (Correction) \\\\hfill\\\\useKV[Contrat]{Niveau} \\\\useKV[Contrat]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[Contrat]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Contrat]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\tcbset{%\\n  tikzcontrat/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=PfMCadreContrat,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      fill=white,\\n      anchor=west,\\n      xshift=10pt,\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily \\\\useKV[Contrat]{NomExercice} \\\\thePfMExo\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{}};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %%\\n      \\\\PfMAffichageLogos%\\n      %%\\n      \\\\PfMAffichageCompetencesTravaillees%\\n      %%\\n      \\\\PfMAffichageSource%\\n      %\\n      \\\\PfMLienVersSolution%\\n      %\\n      \\\\PfMLienVersEntrainement%\\n    }%\\n  }%\\n}%\\n%% Fin Contrat %%%\\n\\n%%FdR\\n\\\\NewDocumentCommand\\\\AfficheFdR{o}{%\\n  \\\\useKVdefault[SchemaFdR]%\\n  \\\\setKV[SchemaFdR]{#1}%\\n  \\\\setlength{\\\\PfMLargeurSchemaFdR}{\\\\useKV[SchemaFdR]{Ecart}}%\\n  \\\\setlength{\\\\PfMRayonSchemaFdR}{\\\\useKV[SchemaFdR]{Rayon}}%\\n  \\\\setlength{\\\\PfMHauteurSchemaFdR}{\\\\useKV[SchemaFdR]{Hauteur}}%\\n  \\\\colorlet{PfMCouleurFdR}{\\\\useKV[SchemaFdR]{Couleur}}%\\n  \\\\@ifundefined{Op@\\\\Roman{PfMMaquette}-FdRTotalExo}{Recompilez pour obtenir la feuille de route.}%\\n  {%\\n    \\\\opexport{\\\\Roman{PfMMaquette}-FdRTotalExo}{\\\\FdRTotalExo}%\\n    \\\\xdef\\\\PfMListeExerciceFdR{\\\\csname \\\\Roman{PfMMaquette}FdRtrue\\\\endcsname}%\\n    \\\\ifcsname \\\\Roman{PfMMaquette}FdRstop\\\\endcsname%\\n      \\\\xdef\\\\PfMListeExerciceFdRStop{\\\\csname \\\\Roman{PfMMaquette}FdRstop\\\\endcsname}%\\n    \\\\else%\\n      \\\\xdef\\\\PfMListeExerciceFdRStop{}%\\n    \\\\fi%\\n    % On ajoute un stop au dernier exercice\\n    \\\\xdef\\\\PfMListeExerciceFdRStop{\\\\PfMListeExerciceFdRStop,\\\\FdRTotalExo}%\\n    %Liste Exos : \\\\PfMListeExerciceFdR\\\\\\\\\\n    %Liste Stop : \\\\PfMListeExerciceFdRStop\\\\\\\\\\n    \\\\BuildRouteTikz{\\\\FdRTotalExo}{\\\\PfMListeExerciceFdR}{\\\\PfMListeExerciceFdRStop}%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\BuildRouteTikz{mmm}{%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeRetiensExo{#2}%\\n  \\\\readlist*\\\\ListeRetiensStop{#3}%\\n  \\\\reademptyitems%\\n  %Les exos retenus : \\\\showitems\\\\ListeRetiensExo[]\\\\\\\\\\n  %Les exos stop : \\\\showitems\\\\ListeRetiensStop[]\\\\\\\\\\n  \\\\xdef\\\\LongueurA{\\\\ListeRetiensExolen}%\\n  \\\\xdef\\\\LongueurB{\\\\fpeval{\\\\ListeRetiensStoplen-1}}%\\n  \\\\xdef\\\\PfMFooExoIncrustes{}%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{1}{#1}}\\\\do{%\\n    \\\\xdef\\\\RetiensExclus{0}%\\n    \\\\xintFor* ##2 in {\\\\xintSeq{1}{\\\\LongueurA}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\ListeRetiensExo[##2]==##1}{\\\\xdef\\\\RetiensExclus{1}}{}%\\n    }%\\n    \\\\xintifboolexpr{\\\\RetiensExclus>0}{}{\\\\xdef\\\\PfMFooExoIncrustes{\\\\PfMFooExoIncrustes,##1}}%\\n  }%\\n  %%%%%%%%%%\\n  %PfMFooExoIncrustes : \\\\PfMFooExoIncrustes\\\\\\\\%\\n  \\\\ifx\\\\bla\\\\PfMFooExoIncrustes\\\\bla%\\n    \\\\xdef\\\\LongueurC{0}%\\n  \\\\else%\\n    \\\\setsepchar{,}\\\\ignoreemptyitems%\\n    \\\\readlist*\\\\ListeRetiensExclus{\\\\PfMFooExoIncrustes}%\\n    \\\\xdef\\\\LongueurC{\\\\ListeRetiensExcluslen}%\\n  \\\\fi%\\n  %%%%%%%%%%%%%%%%%%%%\\n  % portion 1\\n  % Portion 1 :\\\\\\\\\\n  \\\\xdef\\\\ListeRoute{}%\\n  \\\\xdef\\\\ListeRouteExclus{}%\\n  \\\\xdef\\\\NBExo{0}\\\\xdef\\\\NBExoSup{0}%\\n  \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\LongueurA}}\\\\do{%\\n    \\\\xintifboolexpr{\\\\ListeRetiensExo[##1]>\\\\ListeRetiensStop[1]}{%\\n      %\\n    }{%\\n      \\\\xdef\\\\NBExo{\\\\fpeval{\\\\NBExo+1}}\\\\xdef\\\\ListeRoute{\\\\ListeRoute,\\\\ListeRetiensExo[##1]}%\\n    }%\\n  }%\\n  \\\\ifnum\\\\LongueurC=0\\\\relax%\\n  \\\\else%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\LongueurC}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\ListeRetiensExclus[##1]>\\\\ListeRetiensStop[1]}{}{\\\\xdef\\\\NBExoSup{\\\\fpeval{\\\\NBExoSup+1}}\\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,\\\\ListeRetiensExclus[##1]}}%\\n    }%\\n  \\\\fi%\\n  \\\\xintifboolexpr{\\\\NBExoSup==\\\\NBExo}{}{%\\n    \\\\xintifboolexpr{\\\\NBExoSup>\\\\NBExo}{%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{\\\\NBExoSup-\\\\NBExo}}}\\\\do{%\\n        \\\\xdef\\\\ListeRoute{\\\\ListeRoute,-1}%0 pour l'cart\\n      }%\\n    }{%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{\\\\NBExo-\\\\NBExoSup}}}\\\\do{%\\n        \\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,-1}%0 pour l'cart\\n      }%\\n    }%\\n  }%\\n  \\\\xdef\\\\ListeRoute{\\\\ListeRoute,0}%0 pour le symbole stop\\n  \\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,0}%0 pour le symbole stop\\n   %Route Basse P1 : \\\\ListeRoute\\\\\\\\\\n   %Route Haute P1 : \\\\ListeRouteExclus\\\\\\\\\\n  % portions centrales\\n  % Portions centrales :\\\\\\\\\\n   \\\\xintifboolexpr{\\\\ListeRetiensStoplen>2}{%\\n     \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{\\\\LongueurB-1}}}\\\\do{%\\n       \\\\xdef\\\\NBExo{0}\\\\xdef\\\\NBExoSup{0}%\\n       \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\LongueurA}}\\\\do{%\\n         \\\\xintifboolexpr{\\\\ListeRetiensExo[##2]<\\\\fpeval{\\\\ListeRetiensStop[##1]+1} || \\\\ListeRetiensExo[##2]>\\\\ListeRetiensStop[\\\\fpeval{##1+1}]}{}{\\\\xdef\\\\NBExo{\\\\fpeval{\\\\NBExo+1}}\\\\xdef\\\\ListeRoute{\\\\ListeRoute,\\\\ListeRetiensExo[##2]}%\\n         }%\\n       }%\\n       \\\\ifnum\\\\LongueurC=0\\\\relax%\\n       \\\\else%\\n         \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\LongueurC}}\\\\do{%\\n           \\\\xintifboolexpr{\\\\ListeRetiensExclus[##2]<\\\\fpeval{\\\\ListeRetiensStop[##1]+1} || \\\\ListeRetiensExclus[##2]>\\\\ListeRetiensStop[\\\\fpeval{##1+1}]}{}{\\\\xdef\\\\NBExoSup{\\\\fpeval{\\\\NBExoSup+1}}\\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,\\\\ListeRetiensExclus[##2]}%\\n           }%%\\n         }%\\n       \\\\fi%\\n      \\\\xintifboolexpr{\\\\NBExoSup==\\\\NBExo}{}{%\\n        \\\\xintifboolexpr{\\\\NBExoSup>\\\\NBExo}{%\\n          \\\\xintFor* ##3 in{\\\\xintSeq{1}{\\\\fpeval{\\\\NBExoSup-\\\\NBExo}}}\\\\do{%\\n            \\\\xdef\\\\ListeRoute{\\\\ListeRoute,-1}%0 pour l'cart\\n          }%\\n        }{%\\n          \\\\xintFor* ##3 in{\\\\xintSeq{1}{\\\\fpeval{\\\\NBExo-\\\\NBExoSup}}}\\\\do{%\\n            \\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,-1}%0 pour l'cart\\n          }%\\n        }%\\n      }%\\n      \\\\xdef\\\\ListeRoute{\\\\ListeRoute,0}\\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,0}%\\n    }%\\n   }{}%\\n   %Route Basse P2 : \\\\ListeRoute\\\\\\\\\\n   %Route Haute P2 : \\\\ListeRouteExclus\\\\\\\\\\n  % portion finale\\n  % Portion fin \\\\\\\\\\n   \\\\xintifboolexpr{\\\\ListeRetiensStoplen>1}{%\\n     \\\\xdef\\\\NBExo{0}\\\\xdef\\\\NBExoSup{0}%\\n     \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\LongueurA}}\\\\do{%\\n       \\\\xintifboolexpr{\\\\fpeval{\\\\ListeRetiensExo[##1]}>\\\\fpeval{\\\\ListeRetiensStop[\\\\ListeRetiensStoplen-1]}}{\\\\xdef\\\\NBExo{\\\\fpeval{\\\\NBExo+1}}\\\\xdef\\\\ListeRoute{\\\\ListeRoute,\\\\ListeRetiensExo[##1]}}{}%\\n     }%\\n     \\\\ifnum\\\\LongueurC=0\\\\relax%\\n     \\\\else%\\n     \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\LongueurC}}\\\\do{%\\n       \\\\xintifboolexpr{\\\\ListeRetiensExclus[##1]>\\\\fpeval{\\\\ListeRetiensStop[\\\\ListeRetiensStoplen-1]}}{\\\\xdef\\\\NBExoSup{\\\\fpeval{\\\\NBExoSup+1}}\\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,\\\\ListeRetiensExclus[##1]}}{}%\\n     }%\\n     \\\\fi%\\n     \\\\xintifboolexpr{\\\\NBExoSup==\\\\NBExo}{}{%\\n       \\\\xintifboolexpr{\\\\NBExoSup>\\\\NBExo}{%\\n         \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{\\\\NBExoSup-\\\\NBExo}}}\\\\do{%\\n           \\\\xdef\\\\ListeRoute{\\\\ListeRoute,-1}%0 pour l'cart\\n         }%\\n       }{%\\n         \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{\\\\NBExo-\\\\NBExoSup}}}\\\\do{%\\n           \\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,-1}%0 pour l'cart\\n         }%\\n       }%\\n     }%\\n     \\\\xdef\\\\ListeRoute{\\\\ListeRoute,0}%0 pour le symbole stop\\n     \\\\xdef\\\\ListeRouteExclus{\\\\ListeRouteExclus,0}%0 pour le symbole stop\\n   }{}%\\n  %Route Basse P3 : \\\\ListeRoute\\\\\\\\\\n  %Route Haute P3 : \\\\ListeRouteExclus\\\\\\\\\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeRouteBasse{\\\\ListeRoute}%\\n  \\\\readlist*\\\\ListeRouteHaute{\\\\ListeRouteExclus}%\\n  %Liste Route : \\\\showitems\\\\ListeRouteBasse[]\\\\\\\\\\n  %Liste Exclus : \\\\showitems\\\\ListeRouteHaute[]\\\\\\\\\\n  \\\\begin{tikzpicture}\\n    \\\\coordinate (A-0) at (-\\\\PfMLargeurSchemaFdR,0);\\n    \\\\coordinate (A-1) at (0,0);%\\n    \\\\coordinate (B-1) at (0,\\\\PfMHauteurSchemaFdR);%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\ListeRouteBasselen}}\\\\do{%\\n      \\\\coordinate[xshift=\\\\PfMLargeurSchemaFdR] (A-##1) at (A-\\\\fpeval{##1-1});%\\n      \\\\coordinate[xshift=\\\\PfMLargeurSchemaFdR] (B-##1) at (B-\\\\fpeval{##1-1});%\\n    }%\\n   \\\\coordinate[xshift=\\\\PfMLargeurSchemaFdR] (A-\\\\fpeval{\\\\ListeRouteBasselen+1}) at (A-\\\\ListeRouteBasselen);%\\n   % Route haute\\n   % Correct !\\n   %\\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeRouteHautelen}}\\\\do{%\\n   %  \\\\xintifboolexpr{\\\\ListeRouteHaute[##1]<0}{%\\n   %    \\\\draw[red] (B-##1) to (B-\\\\fpeval{##1+1});\\n   %  }{%\\n   %    \\\\xintifboolexpr{\\\\ListeRouteHaute[##1]==0}{%\\n   %      \\\\draw (B-##1) to (A-##1);%\\n   %    }{%\\n   %      \\\\draw[blue] (B-##1) to (B-\\\\fpeval{##1+1});\\n   %      \\\\draw[fill=white](B-##1) circle (\\\\PfMRayonSchemaFdR) node{\\\\ref{page-\\\\thePfMMaquette-\\\\ListeRouteHaute[##1]}};\\n   %    }%\\n   %  }%\\n   %}%\\n   %% Fin Correct !\\n   \\\\xdef\\\\RetiensLesZeros{0}%\\n   \\\\xdef\\\\RetiensLeDepart{0}%\\n   \\\\xdef\\\\RetiensLesReponses{0}%\\n   \\\\xdef\\\\RetiensNonAffichees{0}%\\n   \\\\xdef\\\\RetiensEtage{0}%\\n   \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeRouteHautelen}}\\\\do{%\\n     \\\\xintifboolexpr{\\\\ListeRouteHaute[##1]==0}{%\\n       \\\\xdef\\\\RetiensEtage{\\\\fpeval{\\\\RetiensEtage+1}}%\\n       \\\\xdef\\\\RetiensLesReponses{\\\\fpeval{\\\\RetiensLesReponses+1}}%\\n       \\\\xintFor* ##2 in{\\\\xintSeq{\\\\fpeval{\\\\RetiensLeDepart+1}}{\\\\fpeval{\\\\RetiensLeDepart+\\\\RetiensLesReponses}}}\\\\do{%\\n         \\\\xintifboolexpr{\\\\ListeRouteHaute[##2]<0}{%\\n           \\\\xdef\\\\RetiensNonAffichees{\\\\fpeval{\\\\RetiensNonAffichees+1}}%\\n         }{}%\\n       }%\\n       %\\\\node at (0,\\\\RetiensEtage) {Il y a \\\\RetiensNonAffichees fois le nombre -1.};\\n       % On affiche\\n       \\\\xintifboolexpr{\\\\fpeval{\\\\RetiensLesReponses-1}==\\\\RetiensNonAffichees}{%\\n%         %\\n       }{%\\n         \\\\xintFor* ##2 in{\\\\xintSeq{\\\\fpeval{\\\\RetiensLeDepart+1}}{\\\\fpeval{\\\\RetiensLeDepart+\\\\RetiensLesReponses}}}\\\\do{%\\n           \\\\xintifboolexpr{\\\\ListeRouteHaute[##2]<0}{%\\n             \\\\draw (B-##2) to (B-\\\\fpeval{##2+1});%\\n           }{%\\n             \\\\xintifboolexpr{\\\\ListeRouteHaute[##2]==0}{%\\n               %\\\\xintifboolexpr{\\\\fpeval{\\\\RetiensLesReponses-1}==\\\\RetiensNonAffichees}{}{\\n                 \\\\draw (B-##2) to (A-##2);%\\n               %}\\n             }{%\\n               \\\\draw[] (B-##2) to (B-\\\\fpeval{##2+1});%\\n               \\\\draw[fill=white](B-##2) circle (\\\\PfMRayonSchemaFdR) node{\\\\ref{page-\\\\thePfMMaquette-\\\\ListeRouteHaute[##2]}};%\\n             }%\\n           }%    \\n         }%\\n       }%\\n       %\\n       \\\\xdef\\\\RetiensLeDepart{\\\\fpeval{\\\\RetiensLeDepart+\\\\RetiensLesReponses}}%\\n       \\\\xdef\\\\RetiensLesReponses{0}%\\n       \\\\xdef\\\\RetiensNonAffichees{0}%\\n     }{\\\\xdef\\\\RetiensLesReponses{\\\\fpeval{\\\\RetiensLesReponses+1}}%\\n     }%\\n   }%\\n   % Route basse\\n    \\\\foreach\\\\i in{1,...,\\\\fpeval{\\\\ListeRouteBasselen}}{%\\n      \\\\draw[line width=1pt] (A-\\\\fpeval{\\\\i-1}) -- (A-\\\\i);%\\n    }%\\n    \\\\draw[line width=1pt,>=latex,->] (A-\\\\ListeRouteBasselen) to (A-\\\\fpeval{\\\\ListeRouteBasselen+1});%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeRouteBasselen}}\\\\do{%\\n      \\\\xintifboolexpr{\\\\ListeRouteBasse[##1]<0}{}{%\\n        \\\\xintifboolexpr{\\\\ListeRouteBasse[##1]==0}{%\\n          \\\\draw[fill=white,draw=white](A-##1) circle (\\\\PfMRayonSchemaFdR) node{\\\\faCheck};%\\n        }{%\\n          \\\\draw[fill=PfMCouleurFdR](A-##1) circle (\\\\PfMRayonSchemaFdR) node{\\\\ref{page-\\\\thePfMMaquette-\\\\ListeRouteBasse[##1]}};%\\n        }%\\n      }%\\n    }%\\n  \\\\end{tikzpicture}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\RemplisFdR{m}{%\\n  \\\\ifcsname \\\\Roman{PfMMaquette}route#1\\\\endcsname\\n  \\\\expandafter\\\\xdef\\\\csname \\\\Roman{PfMMaquette}route#1\\\\endcsname{\\\\csname \\\\Roman{PfMMaquette}route#1\\\\endcsname,\\\\thePfMExo}%\\n%  Yes !\\n  \\\\else\\n%  No !\\n  \\\\expandafter\\\\xdef\\\\csname \\\\Roman{PfMMaquette}route#1\\\\endcsname{\\\\thePfMExo}%\\n  \\\\fi\\n  \\\\immediate\\\\write\\\\@auxout{\\\\noexpand\\\\expandafter\\\\gdef\\\\noexpand\\\\csname \\\\Roman{PfMMaquette}FdR#1\\\\endcsname{\\\\csname \\\\Roman{PfMMaquette}route#1\\\\endcsname}}%\\n}%\\n\\n\\\\def\\\\Relecture{}%\\n\\n\\\\NewDocumentEnvironment{exerciceFdR}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n  \\\\IfBooleanTF{#1}{%\\n    \\\\setKV[ClesExercices]{Numerote=false}%\\n  }{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n  \\\\PfMAvantLesExercices%\\n  \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\immediate\\\\write\\\\@auxout{\\\\string\\\\opcopy{\\\\thePfMExo}{\\\\Roman{PfMMaquette}-FdRTotalExo}}%\\n  % Creation des parcours\\n  \\\\ifboolKV[ClesExercices]{Routes}{%\\n    \\\\colorlet{PfMCadreFdR}{black}\\n    % Remise  zro de conteneurs des parcours\\n    \\\\setsepchar{,}%\\n    % \\\\ifboolKV[ClesExercices]{Stop}{\\\\xdef\\\\PfMFooListeFdR{\\\\useKV[ClesExercices]{Route},0}}{\\n    \\\\xdef\\\\PfMFooListeFdR{\\\\useKV[ClesExercices]{Route}}\\n %   % }%\\n    \\\\readlist*\\\\ListeFdR{\\\\PfMFooListeFdR}%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeFdR{%\\n      \\\\RemplisFdR{\\\\ListeFdR[\\\\compteurcnt]}%\\n    }%\\n  }{\\\\colorlet{PfMCadreFdR}{gray!15}}\\n  \\\\ifboolKV[ClesExercices]{Stops}{%\\n    \\\\setsepchar{,}%\\n    % \\\\ifboolKV[ClesExercices]{Stop}{\\\\xdef\\\\PfMFooListeFdR{\\\\useKV[ClesExercices]{Route},0}}{\\n    \\\\xdef\\\\PfMFooListeFdR{stop}%\\n    % }%\\n    \\\\readlist*\\\\ListeFdR{\\\\PfMFooListeFdR}%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeFdR{%\\n      \\\\RemplisFdR{\\\\ListeFdR[\\\\compteurcnt]}%\\n    }%\\n  }{}%\\n  %\\n  \\\\begin{tcolorbox}[%\\n    tikzFdR,\\n    label is label,\\n    label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n    ]\\n    \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n  }%\\n  }%\\n}{%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n  \\\\end{tcolorbox}\\n  \\\\PfMApresLesExercices%\\n}%\\n}%\\n}%\\n\\n%CAN\\n\\\\setsepchar[*]{,*/}%\\n\\\\readlist*\\\\ListeNoms{Aude/Elle/d'Aude/qu'Aude/elle,Bernard/Il/de Bernard/que Bernard/il,Cline/Elle/de Cline/que Cline/elle,Daniel/Il/de Daniel/que Daniel/il,\\\\'Elise/Elle/d'\\\\'Elise/qu'\\\\'Elise/elle,Fabien/Il/de Fabien/que Fabien/il,Grard/Il/de Grard/que Grard/il,Hlne/Elle/d'Hlne/qu'Hlne/elle,Ilies/Il/d'Ilies/qu'Ilies/il,Jasmine/Elle/de Jasmine/que Jasmine/elle,Kylian/Il/de Kylian/que Kylian/il,Laurent/Il/de Laurent/que Laurent/il,Mathilde/Elle/de Mathilde/que Mathilde/elle,Nina/Elle/de Nina/que Nina/elle,Octave/Il/d'Octave/qu'Octave/il,Philippe/Il/de Philippe/que Philippe/il,Joachim/Il/de Joachim/que Joachim/il,Thrse/Elle/de Thrse/que Thrse/elle,Nawel/Elle/de Nawel/que Nawel/elle,Alexandre/Il/d'Alexandre/qu'Alexandre/il,Maxence/Il/de Maxence/que Maxence/il,Sophie/Elle/de Sophie/que Sophie/elle,Christophe/Il/de Christophe/que Christophe/il,Myriam/Elle/de Myriam/que Myriam/elle,Nathalie/Elle/de Nathalie/que Nathalie/elle,Sbastien/Il/de Sbastion/que Sbastien/il}%\\n\\\\readlist*\\\\ListeChersObjets{montre/une,collier/un,bague/une,pendentif/un}%\\n\\\\readlist*\\\\ListeSport{Football/du football/le football,Tennis/du tennis/le tennis,Basket/du basket/le basket,Athltisme/de l'athltisme/l'athltisme,Natation/de la natation/la natation,Hand-ball/du hand-ball/le hand-ball,Volley-ball/du volley-ball/le volley-ball}\\n\\\\setsepchar{,}%\\n\\\\readlist*\\\\ListePetitsObjets{bonbons,billes,biscuits,gommes,clous,vis,cahiers,trousses}%\\n\\\\readlist*\\\\ListeFruits{pommes,poires,abricots,cerises,fraises,framboises,noix,pches,nectarines,myrtilles,oranges,mandarines,kiwis}%\\n\\\\readlist*\\\\ListeVariables{a,b,c,\\\\ell,m,n,p,r,s,t,x,y,z}%\\n\\n\\\\makeatletter\\n\\\\def\\\\ExoCANWrite{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\PfMChoixCorrection%\\n  \\\\stepcounter{PfMExo}%\\n  \\\\immediate\\\\write\\\\@auxout{%\\n    \\\\string\\\\opcopy{\\\\thePfMExo}{TotalExo}%\\n  }%\\n  \\\\@bsphack%\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\thePfMExo.can\\\"%\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials%\\n  \\\\catcode`\\\\^^M\\\\active%\\n  \\\\def\\\\verbatim@processline{\\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}%\\n\\\\def\\\\endExoCANWrite{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}%\\n\\\\makeatother\\n\\n\\\\NewDocumentCommand\\\\Complement{+m}{%\\n  \\\\ifboolKV[Boulot]{CAN}{%\\n    \\\\expandafter\\\\xdef\\\\csname CNReponse\\\\endcsname{\\\\noexpand #1}%\\n  }{%\\n    \\\\begin{center}\\n      #1%\\n    \\\\end{center}\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\EcartComplement{m}{%\\n  \\\\rule{0mm}{#1}%\\n}%\\n\\n\\\\tcbset{%\\n  usercan/.style={%\\n    enhanced,\\n    frame hidden,\\n    colback=white,\\n    middle=24pt,\\n    overlay={% unbroken and first={%\\n      \\\\draw[line width=2pt] (frame.north west)--(frame.north east);\\n      \\\\draw[line width=2pt] (frame.south west)--(frame.south east);\\n    }\\n  }%\\n}%\\n\\\\tcbset{%\\n  usercancor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\newlength\\\\PfMEspaceItemPGCAN\\n\\\\newlength\\\\PfMEspaceTitreSujetPGCAN\\n\\\\setlength{\\\\PfMEspaceItemPGCAN}{0.5em}\\n\\\\setlength{\\\\PfMEspaceTitreSujetPGCAN}{12pt}\\n\\n\\\\makeatletter\\n\\\\NewDocumentCommand\\\\TikzCAN{}{%\\n  \\\\begin{tcolorbox}[usercan]%\\n    {\\\\sc Nom :} \\\\PfCTBstrut\\\\pointilles[0.35\\\\linewidth]\\\\hfill\\\\textbf{\\\\sc Prnom :} \\\\pointilles[0.35\\\\linewidth]\\n    \\\\par\\\\bigskip\\\\par\\n    \\\\textbf{\\\\sc Classe :} \\\\pointilles[0.35\\\\linewidth]\\\\hfill\\n    \\\\begin{minipage}{0.3\\\\linewidth}\\n      \\\\begin{tcolorbox}\\n        \\\\textbf{\\\\sc Score :} \\\\hfill\\\\textbf{/\\\\@ifundefined{Op@TotalExo}{Recompilez}{\\\\opexport{TotalExo}{\\\\TotalExo}\\\\TotalExo}}\\n      \\\\end{tcolorbox}\\n    \\\\end{minipage}\\n    \\\\tcblower\\n    \\\\begin{itemize}\\n    \\\\item[\\\\faCheck] \\\\textbf{Dure : \\\\useKV[CAN]{Duree} minutes.}\\\\\\\\[\\\\PfMEspaceItemPGCAN]\\n    \\\\item[\\\\faCheck] \\\\textit{L'preuve comporte \\\\@ifundefined{Op@TotalExo}{Recompilez}{\\\\opexport{TotalExo}{\\\\TotalExo}\\\\TotalExo{} question\\\\ifnum\\\\TotalExo=1\\\\else\\\\relax s\\\\fi.}}\\\\\\\\[\\\\PfMEspaceItemPGCAN]\\n    \\\\item[\\\\faCheck] \\\\textit{L'usage de la calculatrice et du brouillon sont interdits. Il n'est pas permis d'crire des calculs intermdiaires.} \\n    \\\\end{itemize}\\n    \\\\vspace*{\\\\PfMEspaceTitreSujetPGCAN}\\n  \\\\end{tcolorbox}%\\n  \\\\begin{center}\\n    \\\\Large Sujet \\\\useKV[CAN]{Niveau}\\\\hspace{0.15\\\\linewidth}\\\\useKV[CAN]{Date}\\n  \\\\end{center}\\n  \\\\clearpage%\\n}%\\n%\\\\makeatother\\n\\n%\\\\makeatletter\\n\\\\NewDocumentCommand\\\\TikzCANCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[CAN]{#1}%\\n  \\\\begin{tcolorbox}[usercancor]%\\n    \\\\begin{center}\\n      \\\\Large\\\\sffamily Course aux nombres (Correction)\\n    \\\\end{center}\\n    \\\\hfill\\\\useKV[CAN]{Niveau}%\\n  \\\\end{tcolorbox}%\\n}\\n%%% FdR %%%\\n\\\\tcbset{%\\n  userfdr/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userfdrcor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzFdR{}{%\\n  \\\\begin{tcolorbox}[userfdr]%\\n    \\\\Large\\\\sffamily \\\\useKV[FdR]{Theme}\\\\hfill\\\\useKV[FdR]{Niveau} \\\\useKV[FdR]{Classe}%\\n    \\\\par{\\\\tiny\\\\useKV[FdR]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[FdR]{Date}}%\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzFdRCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[FdR]{#1}%\\n  \\\\begin{tcolorbox}[userfdrcor]%\\n    \\\\Large\\\\sffamily \\\\useKV[FdR]{Theme} (Correction) \\\\hfill\\\\useKV[FdR]{Niveau} \\\\useKV[FdR]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[FdR]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[FdR]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\tcbset{%\\n  tikzFdR/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=PfMColbackFdR,\\n    colframe=PfMCadreFdR,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      fill=white,\\n      anchor=west,\\n      xshift=10pt,\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily \\\\useKV[FdR]{NomExercice} \\\\thePfMExo\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{}};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %%\\n      \\\\PfMAffichageLogos\\n      %%\\n      \\\\PfMAffichageCompetencesTravaillees%\\n      %%\\n      \\\\PfMAffichageSource%\\n      %\\n      \\\\PfMLienVersSolution%\\n      %\\n      \\\\PfMLienVersEntrainement%\\n    }%\\n  }%\\n}%\\n%% Fin FdR %%%\\n\\n%% Parcours\\n\\n%\\\\makeatletter\\n\\\\NewDocumentCommand\\\\AfficheParcours{om}{%\\n  \\\\useKVdefault[SchemaParcours]%\\n  \\\\setKV[SchemaParcours]{#1}%\\n  \\\\setlength{\\\\PfMLargeurSchemaParcours}{\\\\useKV[SchemaParcours]{Largeur}}%\\n  \\\\colorlet{PfMCouleurSP}{\\\\useKV[SchemaParcours]{Couleur}}%\\n  \\\\@ifundefined{Op@\\\\Roman{PfMMaquette}-ParcoursTotalExo}{Recompilez pour obtenir le parcours.}%\\n  {%\\n    \\\\opexport{\\\\Roman{PfMMaquette}-ParcoursTotalExo}{\\\\ParcoursTotalExo}%\\n%    Total Exo : \\\\ParcoursTotalExo\\n    \\\\setsepchar{,}\\\\ignoreemptyitems%\\n    \\\\readlist*\\\\ListeExercicesPA{\\\\csname \\\\Roman{PfMMaquette}Parcours#2\\\\endcsname}\\n    \\\\reademptyitems%\\n    \\\\xdef\\\\PfMFooTestA{\\\\ListeExercicesPA[1]}%\\n    \\\\ifnum\\\\ListeExercicesPAlen>1\\\\relax%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\ListeExercicesPAlen}}\\\\do{%\\n        \\\\xdef\\\\PfMFooTestA{\\\\PfMFooTestA,\\\\ListeExercicesPA[##1]}%\\n      }%\\n    \\\\fi%\\n    \\\\ifboolKV[Parcours]{Plan}{%\\n      \\\\BuildParcoursPlan{\\\\ParcoursTotalExo}{\\\\PfMFooTestA}%\\n    }{%\\n      \\\\ifboolKV[Parcours]{Vertical}{%\\n        \\\\BuildParcoursTikzV{\\\\ParcoursTotalExo}{\\\\PfMFooTestA}%\\n      }{%\\n        \\\\BuildParcoursTikz{\\\\ParcoursTotalExo}{\\\\PfMFooTestA}%\\n      }%\\n    }%\\n  }%\\n}%\\n%\\\\makeatother\\n\\n\\\\NewDocumentCommand\\\\BuildParcoursPlan{mm}{%\\n  \\\\setsepchar{,}%\\n  \\\\readlist*\\\\ListeRetiens{#2}%\\n  \\\\begin{enumerate}\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeRetiens{%\\n    \\\\item[$\\\\square$] Exercice \\\\ref{page-\\\\thePfMMaquette-\\\\ListeRetiens[\\\\compteurcnt]}%\\n    }%\\n  \\\\end{enumerate}\\n}%\\n\\n\\\\NewDocumentCommand\\\\BuildParcoursTikzV{mm}{%\\n  \\\\setsepchar{,}%\\n  \\\\readlist*\\\\ListeRetiens{#2}%\\n    \\\\begin{tikzpicture}[remember picture,overlay]\\n      % On place les points%anchor=base,baseline[xshift=-1cm,yshift=-4cm]\\n      \\\\coordinate (A-1) at (0,0);%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{2}{#1}}\\\\do{%\\n        \\\\coordinate[yshift=-1cm] (A-##1) at (A-\\\\fpeval{##1-1});%\\n      }%\\n      \\\\foreach\\\\i in{2,...,#1}{%\\n        \\\\draw[line width=1pt] (A-\\\\fpeval{\\\\i-1}) -- (A-\\\\i);%\\n      }%\\n      %\\n      \\\\draw[line width=1pt,>=latex,->] (A-#1)--(A-\\\\fpeval{#1+1});\\n      %\\n      \\\\xintFor* ##1 in{\\\\xintSeq{1}{#1}}\\\\do{%\\n        \\\\draw[fill=white,dashed](A-##1) circle (2.5mm) node{##1};%\\n      }%\\n      \\\\foreachitem\\\\compteur\\\\in\\\\ListeRetiens{%\\n        \\\\draw[fill=PfMCouleurSP](A-\\\\ListeRetiens[\\\\compteurcnt]) circle (2.5mm) node{\\\\ref{page-\\\\thePfMMaquette-\\\\ListeRetiens[\\\\compteurcnt]}};%\\n      }%\\n    \\\\end{tikzpicture}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\BuildParcoursTikz{mm}{%\\n  \\\\setsepchar{,}%\\n  \\\\readlist*\\\\ListeRetiens{#2}%\\n  \\\\begin{tikzpicture}[anchor=center,baseline=-1.25mm]\\n    % On place les points\\n    \\\\Orientation=1\\\\relax\\n    \\\\ifboolKV[Parcours]{Court}{%\\n      \\\\TotalParcoursTikz=\\\\ListeRetienslen%\\n    }{%\\n      \\\\TotalParcoursTikz=#1%\\n    }%\\n    \\\\coordinate[anchor=base,baseline=-1.25mm] (A-1) at (0,0);%\\n    \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\fpeval{\\\\the\\\\TotalParcoursTikz+1}}}\\\\do{%\\n      \\\\modulo{##1}{\\\\useKV[SchemaParcours]{Colonnes}}%\\n      \\\\ifnum\\\\remainder=0\\\\relax%\\n      \\\\Orientation=\\\\numexpr\\\\Orientation*(-1)\\\\relax%\\n      \\\\coordinate[yshift=-1cm] (A-##1) at (A-\\\\fpeval{##1-1});%\\n      \\\\else%\\n      \\\\coordinate[xshift=\\\\the\\\\Orientation*\\\\PfMLargeurSchemaParcours] (A-##1) at (A-\\\\fpeval{##1-1});%\\n      \\\\fi%\\n    }%\\n    \\\\foreach\\\\i in{1,...,\\\\the\\\\TotalParcoursTikz}{%\\n      \\\\draw[line width=1pt] (A-\\\\i) -- (A-\\\\fpeval{\\\\i+1});%\\n    }%\\n%    %\\n    \\\\draw[line width=1pt,>=latex,->] (A-\\\\the\\\\TotalParcoursTikz)--(A-\\\\fpeval{\\\\the\\\\TotalParcoursTikz+1});\\n%    %\\n    \\\\ifboolKV[Parcours]{Court}{%\\n      \\\\foreachitem\\\\compteur\\\\in\\\\ListeRetiens{%\\n        \\\\draw[fill=PfMCouleurSP](A-\\\\compteurcnt) circle (2.5mm) node{\\\\ref{page-\\\\thePfMMaquette-\\\\ListeRetiens[\\\\compteurcnt]}};%\\n      }%\\n    }{%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\the\\\\TotalParcoursTikz}}\\\\do{%\\n        \\\\draw[fill=white,dashed](A-##1) circle (2.5mm) node{##1};%\\n      }%\\n      \\\\foreachitem\\\\compteur\\\\in\\\\ListeRetiens{%\\n        \\\\draw[fill=PfMCouleurSP](A-\\\\ListeRetiens[\\\\compteurcnt]) circle (2.5mm) node{\\\\ref{page-\\\\thePfMMaquette-\\\\ListeRetiens[\\\\compteurcnt]}};%\\n      }%\\n    }%\\n  \\\\end{tikzpicture}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\RemplisParcours{m}{%\\n  \\\\ifcsname \\\\Roman{PfMMaquette}trajet#1\\\\endcsname\\n  \\\\expandafter\\\\xdef\\\\csname \\\\Roman{PfMMaquette}trajet#1\\\\endcsname{\\\\csname \\\\Roman{PfMMaquette}trajet#1\\\\endcsname,\\\\thePfMExo}%\\n%  Yes !\\n  \\\\else\\n%  No !\\n  \\\\expandafter\\\\xdef\\\\csname \\\\Roman{PfMMaquette}trajet#1\\\\endcsname{\\\\thePfMExo}%\\n  \\\\fi\\n  \\\\immediate\\\\write\\\\@auxout{\\\\noexpand\\\\expandafter\\\\gdef\\\\noexpand\\\\csname \\\\Roman{PfMMaquette}Parcours#1\\\\endcsname{\\\\csname \\\\Roman{PfMMaquette}trajet#1\\\\endcsname}}%\\n}%\\n\\n\\\\def\\\\exerciceParcoursPerso{%\\n  \\\\stepcounter{PfMExo}%\\n  \\\\PfMChoixCorrection%\\n  \\\\@bsphack%\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-PPEx\\\\thePfMExo.tex\\\" %\\n  \\\\immediate\\\\write\\\\verbatim@out{\\\\string\\\\begin{exercice}}\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials%\\n  \\\\catcode`\\\\^^M\\\\active%\\n  \\\\def\\\\verbatim@processline{%\\n    \\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}%\\n\\n\\\\def\\\\endexerciceParcoursPerso{\\\\immediate\\\\write\\\\verbatim@out{\\\\string\\\\end{exercice}}\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}%\\n  \\n\\\\NewDocumentEnvironment{exerciceParcours}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n  \\\\IfBooleanTF{#1}{%\\n    \\\\setKV[ClesExercices]{Numerote=false}%\\n  }{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n  \\\\PfMAvantLesExercices%\\n  \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\immediate\\\\write\\\\@auxout{\\\\string\\\\opcopy{\\\\thePfMExo}{\\\\Roman{PfMMaquette}-ParcoursTotalExo}}%\\n  % Creation des parcours\\n  \\\\ifboolKV[ClesExercices]{Parcours}{%\\n      % Remise  zro de conteneurs des parcours\\n      \\\\setsepchar{,}%\\n    \\\\xdef\\\\PfMFooListeParcours{\\\\useKV[ClesExercices]{Trajet}}\\n    \\\\readlist*\\\\ListeParcours{\\\\PfMFooListeParcours}%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeParcours{%\\n      \\\\RemplisParcours{\\\\ListeParcours[\\\\compteurcnt]}%\\n    }%\\n  }{}%\\n  %\\n  \\\\begin{tcolorbox}[%\\n    tikzparcours,\\n    label is label,\\n    label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n    ]\\n    \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n  }%\\n  }%\\n}{%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n  \\\\end{tcolorbox}\\n  \\\\PfMApresLesExercices%\\n}%\\n}%\\n}%\\n\\n%%%%%%%%%%%%%%%%%%%%%%%\\n% Pour encart\\n%%%%%%%%%%%%%%%%%%%%%%\\n\\n\\\\newtcolorbox{PfMtcbEncart}{%\\n  before skip=1em,\\n    enhanced,\\n    breakable,\\n    frame hidden,\\n    height=\\\\useKV[ClesExercices]{Encart},\\n    colback=PfMFondEncart,\\n    left=10pt,\\n%    % colframe=PfMCadreEncart,\\n    overlay unbroken and first={%\\n      \\\\coordinate[xshift=10*\\\\kvtcb@leftlower] (B) at (frame.north west);\\n      \\\\coordinate[xshift=-10*\\\\kvtcb@leftlower] (C) at (frame.south east);\\n      \\\\draw[PfMCadreEncart,line width=1pt] (frame.south east)--(frame.south west)--(frame.north west)--(B);\\n      \\\\node[%\\n      name=A,\\n      fill=PfMFondEncart,\\n      anchor=west,\\n      xshift=\\\\kvtcb@leftlower,\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily\\\\PfMTexteEncart};\\n      %% \\n    }%\\n  }%\\n\\n% From setspace.sty\\n\\\\NewDocumentCommand\\\\PfMSetStretch{}{%\\n  \\\\ifboolKV[ClesExercices]{Doublespacing}{%\\n    \\\\setstretch {1.667}%  default\\n    \\\\ifx\\\\@ptsize\\\\@undefined\\\\else\\n      \\\\ifcase \\\\@ptsize \\\\relax% 10pt\\n        \\\\setstretch {1.667}%\\n      \\\\or % 11pt\\n        \\\\setstretch {1.618}%\\n      \\\\or % 12pt\\n        \\\\setstretch {1.655}%\\n      \\\\fi\\n    \\\\fi\\n  }{%\\n    \\\\ifboolKV[ClesExercices]{Onehalfspacing}{%\\n      \\\\setstretch{1.25}%  default\\n      \\\\ifx\\\\@ptsize\\\\@undefined\\\\else\\n        \\\\ifcase \\\\@ptsize \\\\relax % 10pt\\n          \\\\setstretch {1.25}%\\n        \\\\or % 11pt\\n          \\\\setstretch {1.213}%\\n        \\\\or % 12pt\\n          \\\\setstretch {1.241}%\\n        \\\\fi%\\n      \\\\fi%\\n    }{}%\\n  }%\\n}%\\n\\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\\n\\\\NewDocumentCommand\\\\PfMScore{m}{%\\n  \\\\immediate\\\\write\\\\@auxout{%\\n    \\\\string\\\\opadd*{#1}{ScoreTotal\\\\thePfMMaquette}{ScoreTotal\\\\thePfMMaquette}%\\n  }%\\n  \\\\num{#1} pt\\\\xintifboolexpr{#1>2 || #1==2}{s}{}%\\n}%\\n\\n\\\\def\\\\PfMMPGrilleCode{%\\n  PapierLargeur=floor(\\\\mpdim{\\\\linewidth}/(5mm));\\n  color PapierCouleur;\\n  PapierCouleur=0.8white;\\n  %\\n  vardef Papier(expr nb,score)=\\n    path horizon,verticon;\\n    horizon=(0,0)--(PapierLargeur*5mm,0);\\n    verticon=(0,0)--(0,abs(nb)*5mm);\\n    picture Papiers;\\n    Papiers=image(\\n      drawoptions(withcolor PapierCouleur);\\n      for k=0 upto PapierLargeur:\\n        draw verticon shifted((k*5mm,0));\\n      endfor;\\n      for k=0 upto abs(nb):\\n        draw horizon shifted((0,k*5mm));\\n      endfor;\\n      drawoptions();\\n      if nb<0:\\n        path cc,cd,ce;\\n        cd=(unitsquare xscaled (3*5mm) yscaled (abs(nb)*5mm)) shifted(5mm*(PapierLargeur-3,0));\\n        ce=(unitsquare scaled (2*5mm)) shifted(5mm*(PapierLargeur-2.5,1));\\n        cc=(unitsquare xscaled (6*5mm) yscaled (2*5mm)) shifted(5mm*(PapierLargeur-10,1));\\n        fill cd withcolor PapierCouleur;\\n        fill ce withcolor white;\\n        fill cc withcolor white;\\n        %drawoptions(withpen pencircle scaled 1);\\n        draw ce;\\n        draw cc;\\n        draw cd;\\n        draw polygone((0,0),(PapierLargeur*5mm,0),5mm*(PapierLargeur,abs(nb)),5mm*(0,abs(nb)));\\n        if score>0:\\n          label.bot(TEX(\\\"\\\\PfMScore{\\\"&decimal(score)&\\\"}\\\"),5mm*(PapierLargeur-1.5,1));\\n        fi;\\n      fi;\\n    );\\n    Papiers\\n  enddef;\\n}%\\n\\n\\\\def\\\\PfMPapierCinqCinq#1#2{%\\n  \\\\begin{center}\\n  \\\\ifluatex%\\n    \\\\mplibforcehmode%\\n    \\\\begin{mplibcode}%\\n      \\\\PfMMPGrilleCode\\n      trace Papier(#1,#2);\\n    \\\\end{mplibcode}%\\n  \\\\else%\\n    \\\\begin{mpost}[mpsettings={\\\\PfMMPGrilleCode}]\\n      trace Papier(#1,#2);\\n    \\\\end{mpost}%\\n  \\\\fi%\\n  \\\\end{center}\\n}%\\n\\n\\\\def\\\\PfMMPSeyesCode{%\\n  u:=\\\\useKV[ClesExercices]{EchelleSeyes}*1mm;\\n  PapierLargeur=floor(\\\\mpdim{\\\\linewidth}/(u));\\n  color PapierCouleur;\\n  PapierCouleur=0.8white;%\\\\useKV[Papiers]{Couleur};\\n  vardef Seyes(expr nb,score)=\\n    path horizon,verticon;\\n    horizon=(0,0)--u*(PapierLargeur,0);\\n    verticon=(0,0)--u*(0,abs(nb));\\n    picture PapierSeyes;\\n    PapierSeyes=image(\\n      drawoptions(withcolor PapierCouleur);\\n      for k=0 upto (PapierLargeur):\\n        draw verticon shifted((k*u,0));\\n      endfor;\\n      for k=0 step 0.25 until abs(nb):\\n        draw horizon shifted((0,k*u)) withpen pencircle scaled 0.5;\\n      endfor;\\n      for k=0 upto abs(nb):\\n        draw horizon shifted((0,k*u)) withpen pencircle scaled 1.25;\\n      endfor;\\n      drawoptions();\\n      if nb<0:\\n        path cc,cd,ce;\\n        cd=(unitsquare xscaled (2*u) yscaled (abs(nb)*u)) shifted(u*(PapierLargeur-2,0));\\n        ce=(unitsquare scaled (1*u)) shifted(u*(PapierLargeur-1.5,1));\\n        cc=(unitsquare xscaled (4*u) yscaled (1*u)) shifted(u*(PapierLargeur-7,1));\\n        fill cd withcolor PapierCouleur;\\n        fill ce withcolor white;\\n        fill cc withcolor white;\\n        draw cc;\\n        draw cd;\\n        draw ce;\\n        draw polygone((0,0),(PapierLargeur*u,0),u*(PapierLargeur,abs(nb)),u*(0,abs(nb)));\\n        if score>0:\\n          label.bot(TEX(\\\"\\\\PfMScore{\\\"&decimal(score)&\\\"}\\\"),u*(PapierLargeur-1,1));\\n        fi;\\n      fi;  \\n    );\\n    PapierSeyes\\n  enddef;\\n}%\\n\\n\\\\def\\\\PfMPapierSeyes#1#2{%\\n  \\\\begin{center}\\n    \\\\ifluatex%\\n      \\\\mplibforcehmode%\\n      \\\\begin{mplibcode}%\\n        \\\\PfMMPSeyesCode\\n        trace Seyes(#1,#2);\\n      \\\\end{mplibcode}%\\n    \\\\else%\\n      \\\\begin{mpost}[mpsettings={\\\\PfMMPSeyesCode}]%\\n        trace Seyes(#1,#2);\\n      \\\\end{mpost}\\n    \\\\fi%\\n  \\\\end{center}\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMJusteAvantLaFinDesExercices{}{%\\n  \\\\ifboolKV[ClesExercices]{Interieur}{%\\n    \\\\ifboolKV[ClesExercices]{Ligne}{%\\n      \\\\vspace*{\\\\PfMEspaceAvantLignes}\\\\par%\\n      \\\\PfMSetStretch%\\n      \\\\PfMLignespointilles{\\\\useKV[ClesExercices]{Lignes}}%\\n      \\\\par\\\\vspace*{\\\\PfMEspaceApresLignes}\\\\par%\\n    }{}%\\n    \\\\par%\\n    \\\\ifboolKV[ClesExercices]{Cadres}{%\\n      \\\\begin{PfMtcbEncart}%\\n        % \\n      \\\\end{PfMtcbEncart}%\\n    }{}%\\n    \\\\ifboolKV[ClesExercices]{Grilles}{%\\n      \\\\ifboolKV[ClesExercices]{Cinq}{%\\n        \\\\PfMPapierCinqCinq{\\\\useKV[ClesExercices]{CinqCinq}}{\\\\useKV[ClesExercices]{Score}}%\\n      }{}%\\n      \\\\ifboolKV[ClesExercices]{Huit}{%\\n        \\\\PfMPapierSeyes{\\\\useKV[ClesExercices]{Seyes}}{\\\\useKV[ClesExercices]{Score}}%\\n      }{}%\\n    }{}%\\n  }{}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMApresLesExercices{}{%\\n    \\\\ifboolKV[ClesExercices]{Interieur}{}{%\\n    \\\\ifboolKV[ClesExercices]{Ligne}{%\\n      \\\\vspace*{\\\\PfMEspaceAvantLignes}%\\n      \\\\PfMSetStretch\\\\PfMLignespointilles{\\\\useKV[ClesExercices]{Lignes}}%\\n      \\\\par\\\\vspace*{\\\\PfMEspaceApresLignes}\\\\par%\\n    }{}%\\n    \\\\par%\\n    \\\\ifboolKV[ClesExercices]{Cadres}{%\\n      \\\\begin{PfMtcbEncart}%\\n        % \\n      \\\\end{PfMtcbEncart}%\\n    }{}%\\n    \\\\ifboolKV[ClesExercices]{Grilles}{%\\n      \\\\ifboolKV[ClesExercices]{Cinq}{%\\n        \\\\PfMPapierCinqCinq{\\\\useKV[ClesExercices]{CinqCinq}}{\\\\useKV[ClesExercices]{Score}}%\\n      }{}%\\n      \\\\ifboolKV[ClesExercices]{Huit}{%\\n        \\\\PfMPapierSeyes{\\\\useKV[ClesExercices]{Seyes}}{\\\\useKV[ClesExercices]{Score}}%\\n      }{}%\\n    }{}\\n  }%\\n  \\\\ifboolKV[ClesExercices]{Profile}{\\\\PfMshowitems}{}%\\n  \\\\ifboolKV[ClesExercices]{ACompleter}{%\\n    \\\\IfHookExistsTF{env/center/begin}{\\\\RemoveFromHook{env/center/begin}[*]}{}%\\n    \\\\IfHookExistsTF{env/center/end}{\\\\RemoveFromHook{env/center/end}[*]}{}%\\n    \\\\IfHookExistsTF{env/itemize/begin}{\\\\RemoveFromHook{env/itemize/begin}[*]}{}%\\n    \\\\IfHookExistsTF{env/itemize/end}{\\\\RemoveFromHook{env/itemize/end}[*]}{}%\\n    \\\\IfHookExistsTF{env/description/begin}{\\\\RemoveFromHook{env/description/begin}[*]}{}%\\n    \\\\IfHookExistsTF{env/description/end}{\\\\RemoveFromHook{env/description/end}[*]}{}%\\n  }{}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMAffichageTitreSolution{}{%\\n  %Affichage du titre de la solution :) Le compteur PfMExoSol vaut \\\\thePfMExoSol\\n  \\\\expandafter\\\\xdef\\\\csname PfMEcrireTitreSol\\\\endcsname{\\\\csname PfMTSol\\\\Roman{PfMExoSol}\\\\endcsname}%\\n  \\\\ifx\\\\bla\\\\PfMEcrireTitreSol\\\\bla%\\n  \\\\else\\n    ~:~\\\\PfMEcrireTitreSol%\\n  \\\\fi%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMChoixTitreSolution{}{%\\n  \\\\ifboolKV[ClesExercices]{TitreSol}{%\\n    %J'ai un titre  mettre  la solution.\\\\par LE compteur PfMExo vaut \\\\thePfMExo\\n    \\\\expandafter\\\\xdef\\\\csname PfMTSol\\\\Roman{PfMExo}\\\\endcsname{\\\\useKV[ClesExercices]{TitreSolution}}}{%\\n    %Je n'ai pas de titre  mettre  la solution.\\\\par%\\n    \\\\expandafter\\\\xdef\\\\csname PfMTSol\\\\Roman{PfMExo}\\\\endcsname{}%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMChoixNomCorrection{}{%\\n  \\\\expandafter\\\\xdef\\\\csname PfMTNomSol\\\\Roman{PfMExo}\\\\endcsname{\\\\useKV[ClesExercices]{TitreCorrige}}\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMChoixHideItemSolution{}{%\\n  \\\\ifboolKV[ClesExercices]{Profile}{%\\n %   J'ai un lve  profil : Je dois me souvenir que la correction doit tre profile. Le compteur PfMExo vaut \\\\thePfMExo\\n    \\\\expandafter\\\\xdef\\\\csname PfMHideSol\\\\Roman{PfMExo}\\\\endcsname{A}}{%\\n    %Je n'ai pas d'lve  profil\\n    \\\\expandafter\\\\xdef\\\\csname PfMHideSol\\\\Roman{PfMExo}\\\\endcsname{}%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMAffichageHideItemSolution{}{%\\n  \\\\expandafter\\\\xdef\\\\csname PfMEcrireHideItemSol\\\\endcsname{\\\\csname PfMHideSol\\\\Roman{PfMExoSol}\\\\endcsname}%\\n  \\\\ifx\\\\bla\\\\PfMEcrireHideItemSol\\\\bla%\\n%    \\\\textcolor{blue}{Normalement, pas de hide car cl profile pas active.}\\n  \\\\else\\n%    \\\\textcolor{red}{Hide Item dans les solutions}\\n    \\\\PfMhideitems%\\n  \\\\fi%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMAvantLesExercices{}{%\\n  \\\\ifboolKV[ClesExercices]{AvecIndications}{\\\\setcounter{RetiensIndic}{1}}{}%\\n  \\\\ifboolKV[ClesExercices]{Profile}{\\\\PfMhideitems}{}%\\n  \\\\refstepcounter{PfMSection}%\\n  \\\\PfMChoixCorrection%\\n  \\\\PfMChoixEntrainement%\\n  \\\\refstepcounter{PfMExo}%\\n  \\\\PfMChoixNomCorrection%\\n  \\\\ifboolKV[ClesExercices]{ACompleter}{%\\n    \\\\let\\\\oldenumerate\\\\enumerate%\\n    \\\\let\\\\oldendenumerate\\\\endenumerate%\\n    \\\\let\\\\enumerate\\\\autoenumerate%\\n    \\\\let\\\\endenumerate\\\\endautoenumerate%\\n    \\\\AddToHook{env/center/begin}[Bcenter]{\\\\let\\\\item\\\\olditem}%\\n    \\\\AddToHook{env/center/end}[Ecenter]{\\\\let\\\\item\\\\litem}%\\n    \\\\AddToHook{env/description/begin}[Bdescription]{\\\\let\\\\item\\\\olditem}%\\n    \\\\AddToHook{env/description/end}[Edescription]{\\\\let\\\\item\\\\litem}%\\n    \\\\AddToHook{env/itemize/begin}[Bitemize]{\\\\let\\\\item\\\\olditem}%\\n    \\\\AddToHook{env/itemize/end}[Eitemize]{\\\\let\\\\item\\\\litem}%\\n  }{}%\\n}%\\n\\n\\\\NewDocumentEnvironment{exerciceFiche}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\setKV[ClesExercices]{Numerote=false}%\\n    }{}%\\n    \\\\colorlet{ColExoFiche}{\\\\useKV[ClesExercices]{Background}}%\\n    \\\\colorlet{PfMCadreFiche}{\\\\useKV[ClesExercices]{Cadre}}%\\n    \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n    \\\\PfMAvantLesExercices%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n      \\\\PfMChoixTitreSolution%\\n      \\\\PfMChoixHideItemSolution%\\n      \\\\begin{tcolorbox}[%\\n        tikzfiche,\\n        label is label,\\n        label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n        ]\\n        \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n      }%\\n    }%\\n  }{%\\n    \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n      \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n        \\\\end{tcolorbox}%\\n        \\\\PfMApresLesExercices%\\n      }%\\n    }%\\n}%\\n\\n% \\\\makeatletter\\n\\\\NewDocumentCommand\\\\TikzOlympiadesAPMEP{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[OlympiadesAPMEP]{#1}%\\n  \\\\begin{tcolorbox}[colback=colLogo]\\n    \\\\begin{Dispo}*{\\\\normalsize\\\\logoapmep{\\\\scale@logo}}\\n      \\\\Large\\\\sffamily \\\\useKV[OlympiadesAPMEP]{Theme}\\n    \\\\end{Dispo}\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzOlympiadesAPMEPCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[OlympiadesAPMEP]{#1}%\\n  \\\\begin{tcolorbox}[colback=colLogo]\\n    \\\\begin{Dispo}*{\\\\normalsize\\\\logoapmep{\\\\scale@logo}}\\n      \\\\Large\\\\sffamily \\\\useKV[OlympiadesAPMEP]{Theme}\\n\\n      (Correction)%\\n    \\\\end{Dispo}\\n  \\\\end{tcolorbox}%\\n}%\\n%\\\\makeatother\\n\\n\\\\NewDocumentEnvironment{exerciceOlympiadesAPMEP}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\setKV[ClesExercices]{Numerote=false}%\\n    }{}%\\n    \\\\colorlet{ColExoFiche}{\\\\useKV[ClesExercices]{Background}}%\\n    \\\\PfMAvantLesExercices%\\n%    \\\\refstepcounter{PfMSection}%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n    \\\\PfMChoixTitreSolution%\\n    \\\\PfMChoixHideItemSolution%\\n    \\\\begin{tcolorbox}[%\\n      tikzOlympiadesAPMEP,\\n      label is label,\\n      label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n      ]\\n      \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n      }%\\n    }%\\n  }{%\\n    \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n      \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n        \\\\end{tcolorbox}%\\n        \\\\PfMApresLesExercices%\\n      }%\\n    }%\\n}%\\n\\n\\\\NewDocumentEnvironment{exerciceDS}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\setKV[ClesExercices]{Numerote=false}%\\n    }{}%\\n    \\\\PfMAvantLesExercices\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n      \\\\PfMChoixTitreSolution%\\n      \\\\immediate\\\\write\\\\@auxout{%\\n        \\\\string\\\\opcopy{\\\\thePfMExo}{TotalExo}%\\n      }\\n      \\\\ifboolKV[ClesExercices]{BaremeTotal}{%\\n        \\\\immediate\\\\write\\\\@auxout{%\\n          \\\\string\\\\opcopy{0}{total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n        }}{}\\n      \\\\begin{tcolorbox}[%\\n        tikzds,\\n        label is label,\\n        label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n        ]\\n        \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n      }%\\n    }%\\n}{%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n        \\\\PfMJusteAvantLaFinDesExercices%\\n      \\\\end{tcolorbox}%\\n      \\\\PfMApresLesExercices%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentEnvironment{ExerciceRecapBrevet}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\IfBooleanTF{#1}{%\\n    \\\\setKV[ClesExercices]{Numerote=false}%\\n  }{}%\\n  \\\\colorlet{ColExoFiche}{\\\\useKV[ClesExercices]{Background}}%\\n  \\\\colorlet{PfMCadreFiche}{\\\\useKV[ClesExercices]{Cadre}}%\\n  \\\\refstepcounter{PfMSection}%\\n  \\\\PfMChoixCorrection%\\n  \\\\refstepcounter{PfMExo}%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\ifboolKV[ClesExercices]{BaremeTotal}{%\\n    \\\\immediate\\\\write\\\\@auxout{%\\n      \\\\string\\\\opcopy{0}{total\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}%\\n    }%\\n  }{}%\\n  \\\\begin{tcolorbox}[%\\n  tikzrecapbrevet,\\n  label is label,\\n  label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n  ]\\n  \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n  }{%\\n    \\\\PfMJusteAvantLaFinDesExercices%\\n  \\\\end{tcolorbox}\\n  \\\\PfMApresLesExercices%\\n}%\\n\\n\\\\makeatother\\n\\n%%% Recap Brevet\\n%%% Style Brevet\\n\\\\tcbset{%\\n  userbrevet/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userbrevetcor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n% Fiche Exercice Brevet\\n\\\\newcommand\\\\TikzRecapBrevet{%\\n\\\\begin{tcolorbox}[userbrevet]%\\n  \\\\Large\\\\sffamily \\\\useKV[RecapBrevet]{Theme}%\\n  \\\\par{\\\\tiny\\\\useKV[RecapBrevet]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[RecapBrevet]{Date}}%\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\newcommand\\\\TikzRecapBrevetCor[1]{%\\n  \\\\clearpage\\n  \\\\setKV[RecapBrevet]{#1}%\\n  \\\\begin{tcolorbox}[userbrevetcor]%\\n    \\\\Large\\\\sffamily \\\\useKV[RecapBrevet]{Theme} (Correction)\\n    \\\\par{\\\\tiny\\\\useKV[RecapBrevet]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[RecapBrevet]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\makeatletter\\n\\\\tcbset{%\\n  tikzrecapbrevet/.style={%\\n    before skip=1em,%\\n    enhanced,%\\n    breakable,%\\n    colback=white,%\\n    colframe=PfMCadreFiche,%\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,%\\n      fill=white,%\\n      anchor=west,%\\n      xshift=10pt,%\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily \\\\useKV[Fiche]{NomExercice} \\\\thePfMExo\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{}};%\\n      %%\\n      \\\\ifboolKV[ClesExercices]{BaremeTotal}{\\\\node[%\\n      fill=white,%\\n      anchor=east,%\\n      xshift=-10pt,%\\n      text=black,%\\n      font=\\\\bfseries%\\n      ]\\n      at (frame.north east)%\\n      {\\\\footnotesize\\\\sffamily \\\\total{\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}};%\\n      }{}%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n%% PDT\\n\\\\tcbset{%\\n  tikzpdt/.style={%\\n    top=\\\\ifboolKV[ClesExercices]{PasTitre}{0mm}{2mm},bottom=0mm,left=0mm,right=0mm,%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=blue!50,\\n    remember,\\n    overlay unbroken and first={%\\n      \\\\coordinate[xshift=2pt,yshift=-2pt] (NO-\\\\thePfMExo) at (frame.north west);%\\n      \\\\coordinate[xshift=-2pt,yshift=-2pt] (NE-\\\\thePfMExo) at (frame.north east);%\\n      \\\\coordinate[xshift=-2pt,yshift=2pt] (SE-\\\\thePfMExo) at (frame.south east);%\\n      \\\\coordinate[xshift=2pt,yshift=2pt] (SO-\\\\thePfMExo) at (frame.south west);%\\n      \\\\coordinate (N-\\\\thePfMExo) at (frame.north);\\n      \\\\coordinate (S-\\\\thePfMExo) at (frame.south);\\n      \\\\coordinate (E-\\\\thePfMExo) at (frame.east);\\n      \\\\coordinate (O-\\\\thePfMExo) at (frame.west);\\n      \\\\ifboolKV[ClesExercices]{PasTitre}{%\\n        \\\\coordinate[xshift=10pt] (A) at (frame.north west);\\n      }{%\\n        \\\\node[%\\n        name=A,\\n        fill=white,\\n        anchor=west,\\n        xshift=10pt,\\n        ] at (frame.north west){\\\\bfseries\\\\sffamily \\\\useKV[PdT]{NomExercice} \\\\thePfMExo\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{}};\\n      }\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %% \\n      \\\\PfMAffichageLogos%\\n      %\\n      \\\\PfMAffichageCompetencesTravaillees%\\n      %\\n      \\\\PfMAffichageSource%\\n      %\\n      \\\\PfMLienVersSolution%\\n    }%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userpdt/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userpdtcor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzPdT{}{%\\n  \\\\begin{tcolorbox}[userpdt]%\\n    \\\\Large\\\\sffamily \\\\useKV[PdT]{Theme}\\\\hfill\\\\useKV[PdT]{Niveau} \\\\useKV[PdT]{Classe}%\\n    \\\\par{\\\\tiny\\\\useKV[PdT]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[PdT]{Date}}%\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzPdTCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[PdT]{#1}%\\n  \\\\begin{tcolorbox}[userpdtcor]%\\n    \\\\Large\\\\sffamily \\\\useKV[PdT]{Theme} (Correction) \\\\hfill\\\\useKV[PdT]{Niveau} \\\\useKV[PdT]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[PdT]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[PdT]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\newenvironment{exercicePdT}[1][]{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#1}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n  \\\\refstepcounter{PfMSection}%\\n  \\\\PfMChoixCorrection%\\n  \\\\refstepcounter{PfMExo}%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\tcolorbox[%\\n  tikzpdt,\\n  label is label,\\n  label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n  ]%\\n  \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n}{\\\\endtcolorbox%\\n}\\n\\n\\\\newenvironment{SOS}[1][]{%\\n  \\\\stepcounter{PfMSOS}%\\n  \\\\tcolorbox[%\\n  enhanced,\\n  remember,%\\n  tikzsos,\\n  overlay unbroken and first={%\\n    \\\\coordinate[xshift=2pt,yshift=-2pt] (SOS-NO-\\\\thePfMSOS) at (frame.north west);%\\n    \\\\coordinate[xshift=-2pt,yshift=-2pt] (SOS-NE-\\\\thePfMSOS) at (frame.north east);%\\n    \\\\coordinate[xshift=-2pt,yshift=2pt] (SOS-SE-\\\\thePfMSOS) at (frame.south east);%\\n    \\\\coordinate[xshift=2pt,yshift=2pt] (SOS-SO-\\\\thePfMSOS) at (frame.south west);%\\n    \\\\coordinate (SOS-N-\\\\thePfMSOS) at (frame.north);\\n    \\\\coordinate (SOS-S-\\\\thePfMSOS) at (frame.south);\\n    \\\\coordinate (SOS-E-\\\\thePfMSOS) at (frame.east);\\n    \\\\coordinate (SOS-O-\\\\thePfMSOS) at (frame.west);\\n  }%\\n  ]%\\n}{\\\\endtcolorbox%\\n}\\n\\n\\\\tikzstyle{cheminPdT}=[-stealth]\\n\\n\\\\NewDocumentCommand\\\\CheminVrai{m}{%\\n  \\\\setsepchar[*]{,*/}%\\n  \\\\readlist*\\\\ListeCheminVrai{#1}%\\n  \\\\setsepchar{,}%\\n  \\\\begin{tikzpicture}[remember picture,overlay]%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeCheminVrai{%\\n      \\\\draw[cheminPdT] (\\\\ListeCheminVrai[\\\\compteurcnt,1]) to node[midway]{\\\\Large \\\\RKbigsmile}(\\\\ListeCheminVrai[\\\\compteurcnt,2]);%\\n    }%\\n  \\\\end{tikzpicture}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\CheminNeutre{m}{%\\n  \\\\setsepchar[*]{,*/}%\\n  \\\\readlist*\\\\ListeCheminVrai{#1}%\\n  \\\\setsepchar{,}%\\n  \\\\begin{tikzpicture}[remember picture,overlay]%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeCheminVrai{%\\n      \\\\draw[cheminPdT] (\\\\ListeCheminVrai[\\\\compteurcnt,1]) to (\\\\ListeCheminVrai[\\\\compteurcnt,2]);%\\n    }%\\n  \\\\end{tikzpicture}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\CheminFaux{m}{%\\n  \\\\setsepchar[*]{,*/}%\\n  \\\\readlist*\\\\ListeCheminVrai{#1}%\\n  \\\\setsepchar{,}%\\n  \\\\begin{tikzpicture}[remember picture,overlay]%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListeCheminVrai{%\\n      \\\\draw[cheminPdT] (\\\\ListeCheminVrai[\\\\compteurcnt,1]) to node[midway]{\\\\Large \\\\RKdevilish}(\\\\ListeCheminVrai[\\\\compteurcnt,2]);%\\n    }%\\n  \\\\end{tikzpicture}%\\n}%\\n\\n\\\\tcbset{%\\n  tikzsos/.style={%\\n    left=0pt,right=0pt,top=0pt,bottom=0pt,%\\n    colback=Crimson!15,%\\n    colframe=Crimson!50,%\\n  }%\\n}%\\n\\n%% Kholle\\n\\\\tcbset{%\\n  tikzkholle/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=gray!50,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      fill=white,\\n      anchor=west,\\n      xshift=10pt,\\n      ] at (frame.north west){\\\\ifboolKV[ClesExercices]{AffichageTitre}{%\\n          {\\\\bfseries\\\\sffamily\\\\useKV[ClesExercices]{Titre}}%\\n        }{\\\\bfseries\\\\sffamily Exercice \\\\thePfMExo}%\\n        \\\\xintifboolexpr{\\\\useKV[ClesExercices]{Difficulte}<1}{}{%\\n          ~(\\\\foreach \\\\s in {1,...,\\\\useKV[ClesExercices]{Difficulte}}{%\\n            $\\\\star$%\\n          })%\\n        }\\n      }\\n      ;\\n      %%\\n      \\\\PfMAffichageSource%\\n    }%\\n  }%\\n}%\\n\\n\\\\newenvironment{CRNote}{%\\n  \\\\tcolorbox[colback=white,height=2cm,title=NOTE,fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white,enhanced,%\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      anchor=east,\\n      yshift=-8pt,\\n      xshift=-10pt,\\n      text=black,\\n      ]\\n      at (frame.north east)\\n      {\\\\sffamily\\\\bfseries \\\\useKV[Kholle]{NomEleve}};\\n      \\\\node[%\\n      anchor=center,\\n      yshift=-8pt,\\n      text=black,\\n      ]\\n      at (frame.north)\\n      {\\\\sffamily\\\\bfseries \\\\useKV[Kholle]{Date}};\\n    }\\n    ]%\\n  }{%\\n  \\\\endtcolorbox%\\n}\\n\\n\\\\newenvironment{CRRemarque}{%\\n  \\\\tcolorbox[colback=white,height=\\\\CRRHauteur,title=REMARQUE(S),fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white%\\n  ]}\\n{%\\n  \\\\endtcolorbox%\\n}%\\n\\n\\\\NewDocumentEnvironment{exerciceKholle}{o}{%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#1}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n  \\\\PfMChoixCorrection%\\n  \\\\refstepcounter{PfMExo}%\\n  \\\\PfMChoixTitreSolution%\\n  \\\\tcolorbox[%\\n  tikzkholle,\\n  label is label,\\n  label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n  ]\\n  \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n}{\\\\endtcolorbox%\\n}\\n\\n\\\\newenvironment{exerciceBase}[1][]{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]\\n  \\\\setKV[ClesExercices]{#1}\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}\\n  \\\\refstepcounter{PfMExo}\\n  \\\\tcolorbox[%\\n  tikzbase\\n  ]\\n}{\\\\endtcolorbox%\\n}\\n\\n\\\\newenvironment{exerciceBaseHTML}[1][]{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]\\n  \\\\setKV[ClesExercices]{#1}\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}\\n  \\\\refstepcounter{PfMExo}\\n  \\\\tcolorbox[%\\n  standard jigsaw, opacityback=0,\\n  lowerbox=ignored,\\n  tikzbasehtml\\n  ]\\n}{\\\\endtcolorbox%\\n}\\n\\n%Alias pour tous les exercices.\\n\\\\NewDocumentEnvironment{exercice}{}{}{}%\\n\\\\NewDocumentEnvironment{Exercice}{}{}{}%\\n\\n%%%%%%%%% STyle Kholle%%%%%%%%%%\\n% Kholle\\n\\\\tcbset{%\\n  userkholle/.style={%\\n    frame hidden,colback=white,enhanced,%\\n    borderline north={3pt}{0pt}{gray!85},\\n    borderline north={2pt}{0.5pt}{gray!15},\\n    borderline south={3pt}{0pt}{gray!85},\\n    borderline south={2pt}{0.5pt}{gray!15}\\n  }%\\n}%\\n\\n\\\\newcommand\\\\TikzKholle{%\\n  \\\\clearpage\\n  \\\\begin{tcolorbox}[userkholle]%\\n    \\\\sffamily Interrogation Orale \\\\useKV[Kholle]{Numero}\\\\hfill\\n    \\\\ifboolKV[Kholle]{CR}{}{Sujet \\\\useKV[Kholle]{Sujet}\\\\hfill}\\\\useKV[Kholle]{Niveau}%\\n    \\\\par\\\\useKV[Kholle]{Lieu}\\\\hfill Le \\\\useKV[Kholle]{Date}%\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\newcommand\\\\TikzKholleCor[1]{%\\n  \\\\clearpage\\n  \\\\setKV[Kholle]{#1}\\n  \\\\begin{tcolorbox}[colback=white,height=2cm,title=NOTE,fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white,enhanced,%\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      anchor=east,\\n      yshift=-8pt,\\n      xshift=-10pt,\\n      text=black,\\n      ]\\n      at (frame.north east)\\n      {\\\\sffamily\\\\bfseries Nom : \\\\hbox to5cm{}};\\n      \\\\node[%\\n      anchor=center,\\n      yshift=-8pt,\\n      text=black,\\n      ]\\n      at (frame.north)\\n      {\\\\sffamily\\\\bfseries \\\\useKV[Kholle]{Date}};\\n    }\\n    ]%\\n  \\\\end{tcolorbox}%\\n  \\\\begin{tcolorbox}[colback=white,height=2cm,title=EXERCICE(S),fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white%\\n    ]%\\n  \\\\end{tcolorbox}%\\n  \\\\begin{tcolorbox}[colback=white,height=\\\\textheight-5cm,title=REMARQUE(S),fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white%\\n    ]%\\n  \\\\end{tcolorbox}%\\n}\\n\\n%%%%%%%%%% Style DM%%%%%%%%%%%%%\\n\\\\tcbset{%\\n  userdm/.style={%\\n    frame hidden,colback=white,enhanced,%\\n    borderline north={3pt}{0pt}{gray!85},%\\n    borderline north={2pt}{0.5pt}{gray!15},%\\n    borderline south={3pt}{0pt}{gray!85},%\\n    borderline south={2pt}{0.5pt}{gray!15}%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userdmcor/.style={%\\n    colback=gray!5%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzDM{}{%\\n  \\\\clearpage%\\n  \\\\begin{tcolorbox}[userdm]%\\n    \\\\sffamily Devoir en temps libre \\\\useKV[DM]{Numero}\\\\hfill\\\\useKV[DM]{Niveau} \\\\useKV[DM]{Classe}%\\\\no\\n    \\\\par{\\\\tiny\\\\useKV[DM]{Code}}\\\\hfill{\\\\scriptsize Pour le \\\\useKV[DM]{Date}}%\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzDMCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[DM]{#1}%\\n  \\\\begin{tcolorbox}[colback=white,height=\\\\PfMHauteurAppreciation,title=APPR\\\\'ECIATION,fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white,enhanced,%\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      inner sep=0pt,\\n      fill=white,\\n      anchor=east,\\n      yshift=-9pt,\\n      xshift=-10pt,\\n      text=black,\\n      ]\\n      at (frame.north east)\\n      {\\\\scriptsize\\\\sffamily\\\\bfseries \\\\useKV[DM]{Code}};\\n    }\\n    ]%\\n  \\\\end{tcolorbox}%\\n  \\\\begin{tcolorbox}[colback=white,height=\\\\PfMHauteurRemarque,title=CONSEIL(S) / REMARQUE(S),fonttitle=\\\\color{black}\\\\bfseries\\\\sffamily,colbacktitle=white%\\n    ]%\\n  \\\\end{tcolorbox}%\\n}\\n%%% Style Cours\\n\\\\tcbset{\\n  usercours/.style={\\n    enhanced,\\n  skin=enhancedlast jigsaw,\\n  attach boxed title to top left={xshift=-4mm,yshift=-0.5mm},\\n  fonttitle=\\\\bfseries\\\\sffamily,\\n  colbacktitle=blue!45,\\n  colframe=red!50!black,\\n  interior style={\\n    top color=blue!10,\\n    bottom color=red!10\\n  },\\n  boxed title style={\\n    empty,\\n    arc=0pt,\\n    outer arc=0pt,\\n    boxrule=0pt\\n  },\\n  underlay boxed title={\\n    \\\\fill[blue!45!white] \\n      (title.north west) -- \\n      (title.north east) -- \\n      +(\\\\tcboxedtitleheight-1mm,-\\\\tcboxedtitleheight+1mm) -- \\n      ([xshift=4mm,yshift=0.5mm]frame.north east) -- \\n      +(0mm,-1mm) -- \\n      (title.south west) -- cycle;\\n    \\\\fill[blue!45!white!50!black] \\n      ([yshift=-0.5mm]frame.north west) -- \\n      +(-0.4,0) -- \\n      +(0,-0.3) -- cycle;\\n    \\\\fill[blue!45!white!50!black] \\n      ([yshift=-0.5mm]frame.north east) -- \\n      +(0,-0.3) -- \\n      +(0.4,0) -- cycle; \\n  },\\n  title={\\\\useKV[Cours]{Theme}},\\n}\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzCours{}{%\\n  \\\\begin{tcolorbox}[usercours]%\\n%    \\\\Large\\\\sffamily\\\\bfseries  Cours : \\\\useKV[Fiche]{Theme}%\\n%    \\\\useKV[Fiche]{Niveau}~\\\\useKV[Fiche]{Classe}\\\\hfill{\\\\scriptsize\\\\useKV[Fiche]{Date}}%\\n  \\\\end{tcolorbox}%\\n}\\n\\n%%%%%% Style Fiche\\n\\\\tcbset{%\\n  userfiche/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userfichecor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzFiche{}{%\\n  \\\\begin{tcolorbox}[userfiche]%\\n    \\\\Large\\\\sffamily \\\\useKV[Fiche]{Theme}\\\\hfill\\\\useKV[Fiche]{Niveau} \\\\useKV[Fiche]{Classe}%\\n    \\\\par{\\\\tiny\\\\useKV[Fiche]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Fiche]{Date}}%\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzFicheCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[Fiche]{#1}%\\n  \\\\begin{tcolorbox}[userfichecor]%\\n    \\\\Large\\\\sffamily \\\\useKV[Fiche]{Theme} (Correction) \\\\hfill\\\\useKV[Fiche]{Niveau} \\\\useKV[Fiche]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[Fiche]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Fiche]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzFicheCorRep{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[Fiche]{#1}%\\n  \\\\begin{tcolorbox}[userfichecor]%\\n    \\\\Large\\\\sffamily \\\\useKV[Fiche]{Theme} (Rponses) \\\\hfill\\\\useKV[Fiche]{Niveau} \\\\useKV[Fiche]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[Fiche]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Fiche]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzFicheCorInd{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[Fiche]{#1}%\\n  \\\\begin{tcolorbox}[userfichecor]%\\n    \\\\Large\\\\sffamily \\\\useKV[Fiche]{Theme} (Indices) \\\\hfill\\\\useKV[Fiche]{Niveau} \\\\useKV[Fiche]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[Fiche]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Fiche]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\makeatletter\\n\\\\tcbset{%\\n  tikzfiche/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=ColExoFiche,\\n    colframe=PfMCadreFiche,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      fill=ColExoFiche,\\n      anchor=west,\\n      xshift=\\\\kvtcb@leftlower,\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily\\\\useKV[Fiche]{NomExercice}\\\\ifboolKV[ClesExercices]{Numerote}{ \\\\thePfMExo}{}\\\\ifboolKV[ClesExercices]{AffichageTitre}{\\\\ifboolKV[ClesExercices]{Numerote}{~:~}{\\\\xdef\\\\PfMTitiLgNE{\\\\useKV[Fiche]{NomExercice}}\\\\IfStrEq{\\\\PfMTitiLgNE}{}{}{~:~}}\\\\useKV[ClesExercices]{Titre}}{}};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %% \\n      \\\\PfMAffichageLogos%\\n      %\\n      \\\\PfMAffichageCompetencesTravaillees%\\n      %\\n      \\\\PfMAffichageSource%\\n      % Lien vers la solution\\n      \\\\PfMLienVersSolution\\n      % Lien vers les entrainements\\n      \\\\PfMLienVersEntrainement\\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n\\n\\\\makeatletter\\n\\\\tcbset{%\\n  tikzOlympiadesAPMEP/.style={%\\n    top=10pt,\\n    left=0mm,right=0mm,\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=ColExoFiche,\\n    frame hidden,\\n    overlay unbroken and first={%\\n      \\\\draw[colLogo,line width=1pt] ([yshift=-12pt]frame.north west)--([yshift=-12pt]frame.north east);\\n      \\\\node[%\\n      name=A,\\n      fill=ColExoFiche,\\n      anchor=west,\\n      xshift=\\\\kvtcb@leftlower,\\n      ] at (frame.north west){\\\\color{colLogo}\\\\resizebox{1em}{!}{\\\\carreEntoure{}}~\\\\Large\\\\bfseries\\\\sffamily\\\\useKV[Fiche]{NomExercice}\\\\ifboolKV[ClesExercices]{Numerote}{ \\\\thePfMExo}{}\\\\ifboolKV[ClesExercices]{AffichageTitre}{\\\\ifboolKV[ClesExercices]{Numerote}{.~}{\\\\xdef\\\\PfMTitiLgNE{\\\\useKV[Fiche]{NomExercice}}\\\\IfStrEq{\\\\PfMTitiLgNE}{}{}{.~}}\\\\useKV[ClesExercices]{Titre}}{}};\\n      \\\\node[%\\n      name=B,\\n      fill=ColExoFiche,\\n      anchor=east,\\n      xshift=-\\\\kvtcb@leftlower,\\n      ] at (frame.north east){\\\\color{colLogo}\\\\Large\\\\bfseries\\\\sffamily\\\\ifnum\\\\fpeval{\\\\useKV[ClesExercices]{Categorie}}=1\\\\relax\\n          Spcialistes%\\n        \\\\else\\n          \\\\ifnum\\\\fpeval{\\\\useKV[ClesExercices]{Categorie}}=2\\\\relax\\n            Non spcialistes\\n          \\\\fi\\n        \\\\fi};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %%\\n      \\\\PfMAffichageLogos%\\n      %\\n      \\\\PfMAffichageCompetencesTravaillees%\\n      %\\n      \\\\PfMAffichageSource%\\n      % Lien vers la solution\\n      \\\\PfMLienVersSolution\\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n%%% Parcours %%%\\n\\\\tcbset{%\\n  userparcours/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userparcourscor/.style={%\\n    spread upwards=-1cm,colback=gray!5%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzParcours{}{%\\n  \\\\begin{tcolorbox}[userparcours]%\\n    \\\\Large\\\\sffamily \\\\useKV[Parcours]{Theme}\\\\hfill\\\\useKV[Parcours]{Niveau} \\\\useKV[Parcours]{Classe}%\\n    \\\\par{\\\\tiny\\\\useKV[Parcours]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Parcours]{Date}}%\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\NewDocumentCommand\\\\TikzParcoursCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[Parcours]{#1}%\\n  \\\\begin{tcolorbox}[userparcourscor]%\\n    \\\\Large\\\\sffamily \\\\useKV[Parcours]{Theme} (Correction) \\\\hfill\\\\useKV[Parcours]{Niveau} \\\\useKV[Parcours]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[Parcours]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[Parcours]{Date}}\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\tcbset{%\\n  tikzparcours/.style={%\\n    before skip=1em,\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    colframe=PfMCadreParcours,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      fill=white,\\n      anchor=west,\\n      xshift=10pt,\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily \\\\useKV[Parcours]{NomExercice} \\\\thePfMExo\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{}};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %%\\n      \\\\PfMAffichageLogos%\\n      %%\\n      \\\\PfMAffichageCompetencesTravaillees%\\n      %%\\n      \\\\PfMAffichageSource%\\n      %\\n      \\\\PfMLienVersSolution%\\n      %\\n      \\\\PfMLienVersEntrainement%\\n    }%\\n  }%\\n}%\\n%% Fin Parcours %%%\\n%%% DS %%%\\n\\\\tcbset{%\\n  userds/.style={%\\n    colback=gray!5,%\\n    enhanced,%\\n    overlay unbroken and first={%\\n      \\\\node[yshift=1em] at (frame.south) {\\\\scriptsize\\\\sffamily-- Calculatrice \\\\ifboolKV[DS]{Calculatrice}{autorise}{interdite} --};\\n    }%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  userdscor/.style={%\\n    colback=gray!5%\\n  }%\\n}%\\n\\n\\n\\\\newcommand\\\\TikzDS{%\\n  \\\\clearpage\\n  \\\\begin{tcolorbox}[userds]%\\n    \\\\sffamily Devoir surveill \\\\useKV[DS]{Numero} (Sujet \\\\useKV[DS]{Sujet})\\\\hfill\\\\useKV[DS]{Niveau} \\\\useKV[DS]{Classe}\\n    \\\\par{\\\\tiny\\\\useKV[DS]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[DS]{Date}}\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzDSCor{m}{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[DS]{#1}%\\n  \\\\begin{tcolorbox}[userdscor]%\\n    \\\\sffamily Devoir surveill \\\\useKV[DS]{Numero} (Sujet \\\\useKV[DS]{Sujet})\\\\hfill\\\\useKV[DS]{Niveau} \\\\useKV[DS]{Classe}%\\n    \\\\par Correction%\\n  \\\\end{tcolorbox}%\\n}\\n\\n\\\\makeatletter\\n\\\\tcbset{%\\n  tikzds/.style={%\\n    enhanced,\\n    breakable,\\n    before skip=2mm,after skip=2mm,\\n    colback=white,\\n    attach boxed title to top left={xshift=1cm,yshift*=1mm-\\\\tcboxedtitleheight},\\n    varwidth boxed title*=-3cm,\\n    boxed title style={frame code={\\n        \\\\path[fill=tcbcolback!30!black]\\n        ([yshift=-1mm,xshift=-1mm]frame.north west)\\n        arc[start angle=0,end angle=180,radius=1mm]\\n        ([yshift=-1mm,xshift=1mm]frame.north east)\\n        arc[start angle=180,end angle=0,radius=1mm];\\n        \\\\path[left color=tcbcolback!60!black,right color=tcbcolback!60!black,\\n        middle color=tcbcolback!80!black]\\n        ([xshift=-2mm]frame.north west) -- ([xshift=2mm]frame.north east)\\n        [rounded corners=1mm]-- ([xshift=1mm,yshift=-1mm]frame.north east)\\n        -- (frame.south east) -- (frame.south west)\\n        -- ([xshift=-1mm,yshift=-1mm]frame.north west)\\n        [sharp corners]-- cycle;\\n      },interior engine=empty,\\n    },\\n    fonttitle=\\\\bfseries\\\\sffamily,\\n    title=Exercice\\\\ifboolKV[ClesExercices]{Numerote}{ \\\\thePfMExo}{}\\\\ifboolKV[ClesExercices]{AffichageTitre}{ : \\\\useKV[ClesExercices]{Titre}}{},\\n    overlay unbroken and first={%\\n      %\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %\\n      \\\\PfMAffichageSource%\\n      %\\n      \\\\ifboolKV[ClesExercices]{BaremeTotal}{%\\n        \\\\node[\\n        fill=white,\\n        anchor=east,\\n        xshift=-10pt,\\n        text=black,\\n        font=\\\\bfseries\\n        ]\\n        at (frame.north east)\\n        {\\\\footnotesize\\\\sffamily \\\\total{\\\\the\\\\c@PfMSection-\\\\the\\\\c@PfMExo}};\\n      }{}\\n      \\\\PfMLienVersSolution%\\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n% Interrogations crites\\n\\\\tcbset{%\\n  userie/.style={%\\n  colback=gray!5,\\n  enhanced,%\\n  overlay unbroken and first={%\\n    \\\\node[yshift=1em] at (frame.south) {\\\\scriptsize\\\\sffamily-- Calculatrice \\\\ifboolKV[IE]{Calculatrice}{autorise}{interdite} --};\\n    }%\\n  }%\\n}%\\n\\n\\\\tcbset{%\\n  useriecor/.style={%\\n  colback=gray!5,\\n  enhanced,%\\n  overlay unbroken and first={%\\n    \\\\node[yshift=1em] at (frame.south) {\\n      \\\\scriptsize\\\\sffamily-- Calculatrice \\\\ifboolKV[IE]{Calculatrice}{autorise}{interdite} --\\n      };%\\n    }%\\n  }%\\n}%\\n\\\\newcommand\\\\TikzIE{%\\n  \\\\clearpage\\n  \\\\begin{minipage}{0.6\\\\linewidth}\\n    \\\\begin{tcolorbox}[userie]%\\n      \\\\sffamily \\\\useKV[IE]{Nom} \\\\useKV[IE]{Numero} : \\\\useKV[IE]{Theme} \\\\ifboolKV[IE]{Sujets}{{\\\\scriptsize(Sujet \\\\useKV[IE]{Sujet})}}{}\\n      \\\\vspace{1em}\\n      \\\\par{\\\\tiny\\\\useKV[IE]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[IE]{Date}}\\n    \\\\end{tcolorbox}%\\n  \\\\end{minipage}\\\\hfill\\\\begin{minipage}{0.35\\\\linewidth}\\n    Nom : \\\\PfMIENom\\\\\\\\[0.5em]\\n    Prnom : \\\\PfMIEPrenom\\\\\\\\[0.5em]\\n    Classe : \\\\PfMIEClasse%\\n  \\\\end{minipage}%\\n  \\\\par\\\\bigskip%\\n}%\\n\\n\\\\newcommand\\\\TikzIECor[1]{%\\n  \\\\ifPfMRectoVerso%\\n    \\\\cleardoublepage%\\n  \\\\else%\\n    \\\\clearpage%\\n  \\\\fi%\\n  \\\\setKV[IE]{#1}%\\n  \\\\begin{tcolorbox}[useriecor]%\\n    \\\\sffamily \\\\useKV[IE]{Nom} \\\\useKV[IE]{Numero} : \\\\useKV[IE]{Theme} \\\\ifboolKV[IE]{Sujets}{\\\\scriptsize(Sujet \\\\useKV[IE]{Sujet})}{}\\\\hfill Correction%\\n    \\\\par{\\\\tiny\\\\useKV[IE]{Code}}\\\\hfill{\\\\scriptsize\\\\useKV[IE]{Date}}%\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMRecapitulatif{mm}{%\\n  \\\\setKV[Boulot]{#1}%\\n  \\\\setcounter{PfMRetiensMapourPP}{\\\\thePfMMaquette}%\\n  \\\\DTLforeach*{dataperso}{\\\\Prenom=PrenomEleve,\\\\Nom=NomEleve,\\\\RecapListeExo=ListeExo}{%\\n    \\\\ifboolKV[Boulot]{Dys}{%\\n      \\\\begin{Maquette}[Fiche,Dys]{#2,Code=\\\\normalsize\\\\Prenom~\\\\Nom}%\\n    }{%\\n      \\\\begin{Maquette}[Fiche]{#2,Code=\\\\normalsize\\\\Prenom~\\\\Nom}%\\n    }%\\n    \\\\readlist*\\\\ListeExercices{\\\\RecapListeExo}%\\n    \\\\ifnum\\\\fpeval{\\\\ListeExerciceslen}=1\\\\relax{}\\n      \\\\setKVdefault[ClesExercices]{Numerote=false}\\n      \\\\input{\\\\jobname-Ma\\\\thePfMRetiensMapourPP-PPEx\\\\ListeExercices[1].tex}%\\n      \\\\setKVdefault[ClesExercices]{Numerote}\\n    \\\\else\\n      \\\\foreach\\\\i in{1,...,\\\\ListeExerciceslen}{%\\n        \\\\input{\\\\jobname-Ma\\\\thePfMRetiensMapourPP-PPEx\\\\ListeExercices[\\\\i].tex}%\\n      }\\n    \\\\fi\\n    \\\\ifnum\\\\thePfMCorrigeParcoursPerso=1\\\\relax%\\n      % \\\\RecapitulatifCorrection{#2}%\\n      \\\\clearpage\\n      \\\\TikzFicheCor{#1,Code=\\\\normalsize\\\\Prenom~\\\\Nom}%\\n      \\\\readlist*\\\\ListeExercices{\\\\RecapListeExo}%\\n      \\\\ifnum\\\\fpeval{\\\\ListeExerciceslen}=1\\\\relax{}\\n        \\\\textbf{Corrig de l'exercice} : \\\\input{\\\\jobname-Ma\\\\thePfMMaquette-PPEx\\\\ListeExercices[1].sol}\\\\par\\\\goodbreak%\\n      \\\\else\\n        \\\\foreach\\\\i in{1,...,\\\\ListeExerciceslen}{%\\n          \\\\textbf{Corrig de l'exercice \\\\i} : \\\\input{\\\\jobname-Ma\\\\thePfMMaquette-PPEx\\\\ListeExercices[\\\\i].sol}\\\\par\\\\goodbreak%\\n        }%\\n      \\\\fi%\\n    \\\\fi%\\n  \\\\end{Maquette}%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\RecapitulatifCorrection{m}{%\\n  \\\\DTLforeach*{dataperso}{\\\\Prenom=PrenomEleve,\\\\Nom=NomEleve,\\\\RecapListeExo=ListeExo}{%\\n    \\\\clearpage\\n    \\\\TikzFicheCor{#1,Code=\\\\normalsize\\\\Prenom~\\\\Nom}%\\n    \\\\readlist*\\\\ListeExercices{\\\\RecapListeExo}%\\n    \\\\foreach\\\\i in{1,...,\\\\ListeExerciceslen}{%\\n      \\\\IfFileExists{\\\\jobname-PPEx\\\\ListeExercices[\\\\i].sol}{\\\\textbf{Corrig de l'exercice \\\\i} : \\\\input{\\\\jobname-Ma\\\\thePfMMaquette-PPEx\\\\ListeExercices[\\\\i].sol}\\\\par\\\\goodbreak}{}%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMFontDys{}{}%\\n\\\\NewDocumentCommand\\\\PfMFontNonDys{}{}%\\n\\n\\\\NewDocumentCommand\\\\PfMBasculeDys{}{%\\n  \\\\ifboolKV[Boulot]{Dys}{%\\n      % d'aprs \\\\url{https://culturedys.com/quelle-est-la-meilleure-police-pour-les-dyslexiques/}\\n    \\\\xdef\\\\PfMTaillePointDys{\\\\useKV[Boulot]{Taille}}%\\n    \\\\fontsize{\\\\PfMTaillePointDys}{\\\\fpeval{\\\\PfMTaillePointDys*1.2*1.5}}\\\\selectfont%\\n    \\\\raggedright%\\n    \\\\setlength{\\\\spaceskip}{\\\\PfMEcartSupInterMots+\\\\fontdimen2\\\\font}%\\n    \\\\PfMFontDys%\\n  }{%\\n    \\\\ifnum\\\\thePfMMaquette=1\\\\relax%\\n    \\\\else%\\n      \\\\fontsize{\\\\fpeval{10+\\\\PfMFontSize}}{\\\\fpeval{1.2*(10+\\\\PfMFontSize)}}%\\n      \\\\selectfont%\\n      \\\\renewcommand{\\\\JustifyingParindent}{\\\\parindent}\\n      \\\\justifying%\\n    \\\\fi%\\n    \\\\PfMFontNonDys%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMChangerTailleCorrection{}{%\\n  \\\\ifboolKV[Boulot]{Small}{%\\n    \\\\small%\\n  }{%\\n    \\\\ifboolKV[Boulot]{Footnotesize}{%\\n      \\\\footnotesize\\n    }{%\\n      \\\\ifboolKV[Boulot]{Scriptsize}{%\\n        \\\\scriptsize\\n      }{}%\\n    }%\\n  }%\\n}%\\n\\n%% Pour factoriser l'appel aux corrections dans l'environnement Maquette\\n\\\\makeatletter\\n\\\\NewDocumentCommand\\\\PfMPrepareCorrection{m}{%\\n  \\\\useKVdefault[Boulot]%\\n  \\\\setKV[Boulot]{#1}%\\n  \\\\if@CAN\\n    \\\\ifnum\\\\thepage<5\\\\relax\\n      \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\fpeval{5-\\\\thepage}}}\\\\do{%\\n        ~\\\\clearpage%\\n      }%\\n    \\\\fi%\\n  \\\\fi%\\n  \\\\if@Dyslexie%\\n    \\\\setKV[Boulot]{Dys}%\\n  \\\\fi%\\n  \\\\PfMBasculeDys%\\n  \\\\setlength{\\\\columnseprule}{\\\\useKV[Boulot]{Epaisseur}}%\\n  \\\\PfMChangerTailleCorrection%\\n}%\\n\\\\makeatother\\n\\n\\\\NewDocumentCommand\\\\PfMAffichageCorrectionColonnes{}{%\\n  \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n  \\\\PfMAffichageCorrige%\\n  \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMAffichageEntrainementColonnes{}{%\\n  \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n  \\\\PfMAffichageEntrainement%\\n  \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n}%\\n\\n% GameBook\\n\\\\tcbset{%\\n  userlivreheros/.style={%\\n    spread upwards=-1cm,colback=Ivory,colframe=black!25!Ivory%\\n  }%\\n}%\\n\\n\\\\setKVdefault[LivreHeros]{Theme=Les nombres d\\\\'ecimaux}\\n\\n\\\\NewDocumentCommand\\\\vaen{m}{\\\\ref{#1}}%\\n\\n\\\\NewDocumentCommand\\\\TikzLivreHeros{}{%\\n  \\\\begin{tcolorbox}[userlivreheros]%\\n    \\\\begin{center}\\n      \\\\Large\\\\sffamily \\\\useKV[LivreHeros]{Theme}\\n      \\\\end{center}\\n  \\\\end{tcolorbox}%\\n}%\\n\\n\\\\tcbset{%\\n  tikzLH/.style={%\\n    before skip=1em,\\n    enhanced,\\n    coltitle=black,\\n    colbacktitle=black!10!Ivory,\\n    colframe=white,\\n    colback=white,\\n    attach boxed title to top center={yshift=-2mm},\\n    label is label\\n  }%\\n}%\\n\\n\\\\newcounter{PfMGameBook}[PfMMaquette]\\n\\\\setcounter{PfMGameBook}{0}\\n\\n\\\\makeatletter\\n\\\\def\\\\ExoGBWrite{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\PfMChoixCorrection%\\n  \\\\stepcounter{PfMExo}%\\n  \\\\immediate\\\\write\\\\@auxout{%\\n    \\\\string\\\\opcopy{\\\\thePfMExo}{TotalExo}%\\n  }%\\n  \\\\@bsphack%\\n  \\\\immediate\\\\openout \\\\verbatim@out \\\"\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\thePfMExo.gb\\\"%\\n  \\\\let\\\\do\\\\@makeother\\\\dospecials%\\n  \\\\catcode`\\\\^^M\\\\active%\\n  \\\\def\\\\verbatim@processline{\\\\immediate\\\\write\\\\verbatim@out{\\\\the\\\\verbatim@line}}%\\n  \\\\verbatim@start}%\\n\\\\def\\\\endExoGBWrite{\\\\immediate\\\\closeout\\\\verbatim@out\\\\@esphack}%\\n\\\\makeatother\\n%%%%\\n\\n\\\\NewDocumentEnvironment{exerciceBeamer}{so}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#2}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\ifboolKV[ClesExercices]{NonUtilise}{%\\n    % Mettre la correction hors-jeu\\n    \\\\setKV[ClesExercices]{PasCorrige}%\\n    \\\\PfMChoixCorrection%\\n    \\\\begin{PfMHide}\\n  }{%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\setKV[ClesExercices]{Numerote=false}%\\n    }{}%\\n    \\\\colorlet{ColExoFiche}{\\\\useKV[ClesExercices]{Background}}%\\n    \\\\colorlet{PfMCadreFiche}{\\\\useKV[ClesExercices]{Cadre}}%\\n    \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n    \\\\PfMAvantLesExercices%\\n    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n      \\\\PfMChoixTitreSolution%\\n      \\\\PfMChoixHideItemSolution%\\n      \\\\begin{tcolorbox}[%\\n        tikzbeamer,\\n        label is label,\\n        label=page-\\\\thePfMMaquette-\\\\thePfMExo\\n        ]\\n        \\\\ifboolKV[Boulot]{Dys}{\\\\raggedright}{}%\\n      }%\\n    }%\\n  }{%\\n    \\\\ifboolKV[ClesExercices]{NonUtilise}{\\\\end{PfMHide}}{%\\n      \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n          \\\\PfMJusteAvantLaFinDesExercices%\\n        \\\\end{tcolorbox}%\\n        % \\\\ifboolKV[ClesExercices]{Profile}{\\\\PfMshowitems}{}%\\n        \\\\PfMApresLesExercices%\\n      }%\\n    }%\\n}%\\n\\n\\\\makeatletter\\n\\\\tcbset{%\\n  tikzbeamer/.style={%\\n    before skip=0.5em,\\n    enhanced,\\n    breakable,\\n    colback=white,%ColExoFiche,\\n    frame hidden,\\n    %colframe=PfMCadreFiche,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      anchor=center,\\n      xshift=8*\\\\kvtcb@leftlower/10,\\n      yshift=-10*\\\\kvtcb@leftlower/9,\\n      ] at (frame.north west){\\\\thePfMExo};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n      %% \\n      \\\\PfMAffichageSource%\\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n\\n%%%%%%%%%%%%%%%%% AMC\\n\\n\\\\def\\\\PfMTexteAMC{\\\\scriptsize Pour chaque question, remplir avec un stylo {\\\\em noir} la case associe  {\\\\em l'unique} rponse correcte.\\\\par En cas d'erreur, {\\\\em ne redessiner pas} la case coche par erreur, mettez simplement un coup de  blanc  dessus.}\\n\\n\\\\newcommand\\\\TikzAMC{%\\n  \\\\begin{tcolorbox}[%\\n    colback=LightGray!10,\\n    colframe=LightGray,\\n    enhanced,%\\n    overlay unbroken and first={%\\n      \\\\ifboolKV[AMC]{Calculatrice}{\\\\node[yshift=1em] at (frame.south) {\\\\scriptsize\\\\sffamily-- Calculatrice autorise --};}{}%\\n    }%\\n    ]%\\n    \\\\sffamily \\\\useKV[AMC]{Theme}\\n    \\\\vspace{1em}\\n    \\\\par\\\\hfill{\\\\scriptsize\\\\useKV[AMC]{Date}}\\n  \\\\end{tcolorbox}%\\n  \\\\ifboolKV[Boulot]{IntroductionAMC}{\\\\PfMTexteAMC}{}%\\n  \\\\par\\\\bigskip%\\n}%\\n\\n\\\\newlength\\\\PfMAMCBarreFraction\\n\\\\makeatletter\\n\\n\\n\\\\setKVdefault[ListeReponses]{Lettre=x,Unites=false}\\n\\\\defKV[ListeReponses]{Unite=\\\\setKV[ListeReponses]{Unites}\\\\DeclareSIUnit{\\\\TempoAMC}{#1}}\\n\\n\\\\NewDocumentCommand\\\\ListeReponses{som}{%\\n  \\\\ifboolKV[Boulot]{AMC}{%\\n    \\\\useKVdefault[ListeReponses]%\\n    \\\\setKV[ListeReponses]{#2}%\\n    \\\\setsepchar{,}\\\\ignoreemptyitems%\\n    \\\\readlist*\\\\ListeAMCRep{#3}%\\n    \\\\reademptyitems%\\n%    \\\\showitems\\\\ListeAMCRep[]\\n    \\\\setcounter{PfMAMCOpen}{1}%\\n    \\\\stepcounter{PfMNbListeReponsesAMC}%\\n    \\\\par\\n    \\\\ifnum\\\\fpeval{\\\\ListeAMCReplen}=1\\\\relax%\\n      % On teste la prsence de ! pour les fractions, de : pour l'criture ax+b, de ! pour une criture du style $a^p$ et de | pour les critures scientifiques.\\n      \\\\StrCount{\\\\ListeAMCRep[1]}{/}[\\\\PfMAMCPresenceFraction]%\\n      \\\\StrCount{\\\\ListeAMCRep[1]}{:}[\\\\PfMAMCPresenceLitteral]%\\n      \\\\StrCount{\\\\ListeAMCRep[1]}{!}[\\\\PfMAMCPresencePuissances]%\\n      \\\\StrCount{\\\\ListeAMCRep[1]}{|}[\\\\PfMAMCPresencePuissancesDix]%\\n      \\\\ifnum\\\\fpeval{\\\\PfMAMCPresenceFraction+\\\\PfMAMCPresenceLitteral+\\\\PfMAMCPresencePuissances+\\\\PfMAMCPresencePuissancesDix}=0\\\\relax\\n        \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\n          \\\\IfInteger{\\\\ListeAMCRep[1]}{%\\n            \\\\itemtomacro\\\\ListeAMCRep[1]\\\\Toto%\\n            \\\\StrLen{\\\\fpeval{abs(\\\\Toto)}}[\\\\PfMLongueurCaseAMC]%\\n            \\\\IfBooleanTF{#1}{%\\n              \\\\AMCnumericChoices{\\\\fpeval{\\\\ListeAMCRep[1]}}{digits=\\\\PfMLongueurCaseAMC,sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n            }{%\\n              \\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n                \\\\AMCnumericChoices{\\\\fpeval{\\\\ListeAMCRep[1]}}{digits=\\\\PfMLongueurCaseAMC,sign=false,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\n              \\\\end{minipage}\\\\ifboolKV[ListeReponses]{Unites}{~~~\\\\si[per-mode=symbol]{\\\\TempoAMC}}{}%\\n            }%\\n          }{%\\n            \\\\itemtomacro\\\\ListeAMCRep[1]\\\\Toto%\\n            \\\\StrCut{\\\\Toto}{.}{\\\\TotoAv}{\\\\TotoAp}%\\n            \\\\StrLen{\\\\fpeval{abs(\\\\TotoAv)}}[\\\\PfMLongueurCaseAMCAv]%\\n            \\\\StrLen{\\\\TotoAp}[\\\\PfMLongueurCaseAMCAp]%\\n            \\\\IfBooleanTF{#1}{%\\n              \\\\AMCnumericChoices{\\\\fpeval{\\\\ListeAMCRep[1]}}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCAv+\\\\PfMLongueurCaseAMCAp},decimals=\\\\PfMLongueurCaseAMCAp,sign,Tpoint={,},borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n            }{%\\n              \\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n                \\\\AMCnumericChoices{\\\\fpeval{\\\\ListeAMCRep[1]}}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCAv+\\\\PfMLongueurCaseAMCAp},decimals=\\\\PfMLongueurCaseAMCAp,sign=false,Tpoint={,},borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n              \\\\end{minipage}\\\\ifboolKV[ListeReponses]{Unites}{~~~\\\\si[per-mode=symbol]{\\\\TempoAMC}}{}%\\n            }%\\n          }%\\n        \\\\end{questionmultx}\\n      \\\\else\\n        %Fraction\\n        \\\\ifnum\\\\PfMAMCPresenceFraction=1\\\\relax%\\n          \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\n          \\\\itemtomacro\\\\ListeAMCRep[1]\\\\Toto%\\n          \\\\StrCut{\\\\Toto}{/}{\\\\TotoAv}{\\\\TotoAp}%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoAv)}}[\\\\PfMLongueurCaseAMCNum]%\\n          \\\\StrLen{\\\\TotoAp}[\\\\PfMLongueurCaseAMCDeno]%\\n          \\\\IfBooleanTF{#1}{%\\n            \\\\AMCnumericChoices{\\\\TotoAv.\\\\TotoAp}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCNum+\\\\PfMLongueurCaseAMCDeno},decimals=\\\\PfMLongueurCaseAMCDeno,sign,Tpoint={\\\\raisebox{0.25\\\\AMC@boxedheight}{\\\\rule{\\\\PfMAMCBarreFraction}{1pt}}},borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n          }{%\\n            \\\\AMCnumericChoices{\\\\TotoAv.\\\\TotoAp}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCNum+\\\\PfMLongueurCaseAMCDeno},decimals=\\\\PfMLongueurCaseAMCDeno,sign=false,Tpoint={\\\\raisebox{0.25\\\\AMC@boxedheight}{\\\\rule{\\\\PfMAMCBarreFraction}{1pt}}},borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n          }%\\n          \\\\end{questionmultx}\\n        \\\\fi\\n        % Puissances\\n        \\\\ifnum\\\\PfMAMCPresencePuissances=1\\\\relax%\\n          \\\\itemtomacro\\\\ListeAMCRep[1]\\\\Toto%\\n          \\\\StrCut{\\\\Toto}{!}{\\\\TotoAv}{\\\\TotoAp}%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoAv)}}[\\\\PfMLongueurCaseAMCMant]%\\n          \\\\StrLen{\\\\TotoAp}[\\\\PfMLongueurCaseAMCPuis]%\\n          \\\\IfBooleanTF{#1}{%\\n            $\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n              \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAv}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCMant},sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\\\end{questionmultx}\\n              \\\\end{minipage}^{~\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n                \\\\scriptsize\\\\stepcounter{PfMNbListeReponsesAMC}\\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAp}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCPuis},sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\\\end{questionmultx}\\n              \\\\end{minipage}}$\\n          }{%\\n            $\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n              \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAv}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCMant},sign=false,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\\\end{questionmultx}\\n              \\\\end{minipage}^{~\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n                \\\\scriptsize\\\\stepcounter{PfMNbListeReponsesAMC}\\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAp}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCPuis},sign=false,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\\\end{questionmultx}\\n              \\\\end{minipage}}$\\n          }%\\n        \\\\fi\\n        % PuissancesDix\\n        \\\\ifnum\\\\PfMAMCPresencePuissancesDix=1\\\\relax%\\n          \\\\itemtomacro\\\\ListeAMCRep[1]\\\\Toto%\\n          \\\\StrCut{\\\\Toto}{|}{\\\\TotoAv}{\\\\TotoAp}%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoAv)}}[\\\\PfMLongueurCaseAMCMant]%\\n          \\\\StrLen{\\\\TotoAp}[\\\\PfMLongueurCaseAMCPuis]%\\n          \\\\StrCut{\\\\TotoAv}{.}{\\\\TotoAva}{\\\\TotoApa}%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoAva)}}[\\\\PfMLongueurCaseAMCManta]%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoApa)}}[\\\\PfMLongueurCaseAMCMantb]%\\n          \\\\IfBooleanTF{#1}{%\\n            $\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n              \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAv}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCManta+\\\\PfMLongueurCaseAMCMantb},Tpoint={,},decimals=\\\\PfMLongueurCaseAMCMantb,sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\n              \\\\end{questionmultx}\\n            \\\\end{minipage}\\\\quad\\\\times10^{~\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n             \\\\scriptsize\\\\stepcounter{PfMNbListeReponsesAMC}\\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAp}{digits=\\\\PfMLongueurCaseAMCPuis,sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\\\end{questionmultx}\\n              \\\\end{minipage}}\\n            $\\n          }{%\\n            $\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n              \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAv}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCManta+\\\\PfMLongueurCaseAMCMantb},Tpoint={,},decimals=\\\\PfMLongueurCaseAMCMantb,sign=false,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\n              \\\\end{questionmultx}\\n            \\\\end{minipage}\\\\quad\\\\times10^{~\\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n             \\\\scriptsize\\\\stepcounter{PfMNbListeReponsesAMC}\\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\\\AMCnumericChoices{\\\\TotoAp}{digits=\\\\PfMLongueurCaseAMCPuis,sign=false,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}\\\\end{questionmultx}\\n              \\\\end{minipage}}\\n            $\\n          }%\\n        \\\\fi\\n        % Litteral\\n        \\\\ifnum\\\\PfMAMCPresenceLitteral=1\\n          \\\\itemtomacro\\\\ListeAMCRep[1]\\\\Toto%\\n          \\\\StrCut{\\\\Toto}{:}{\\\\TotoAv}{\\\\TotoAp}%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoAv)}}[\\\\PfMLongueurCaseAMCMono]%\\n          \\\\StrLen{\\\\fpeval{abs(\\\\TotoAp)}}[\\\\PfMLongueurCaseAMCConst]%\\n          $\\n          \\\\begin{minipage}{\\\\PfMAMCBarreFraction}\\n            \\\\footnotesize%\\n            \\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}%\\n              \\\\AMCnumericChoices{\\\\TotoAv}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCMono},sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n            \\\\end{questionmultx}%\\n          \\\\end{minipage}\\n          \\\\qquad\\\\useKV[ListeReponses]{Lettre}\\\\quad\\n          \\\\begin{minipage}{\\\\PfMAMCBarreFraction}%\\n            \\\\stepcounter{PfMNbListeReponsesAMC}\\\\footnotesize\\\\begin{questionmultx}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}%\\n              \\\\AMCnumericChoices{\\\\TotoAp}{digits=\\\\fpeval{\\\\PfMLongueurCaseAMCConst},sign,borderwidth=0pt,backgroundcol=gray!20,scoreexact=1,hspace=0.25em,vspace=0ex}%\\n            \\\\end{questionmultx}%\\n          \\\\end{minipage}\\n          $\\n        \\\\fi\\n      \\\\fi\\n    \\\\else%\\n      \\\\begin{question}{\\\\Roman{PfMExo}\\\\roman{PfMNbListeReponsesAMC}}\\n        \\\\ifPfMDeuxColonnes\\n          \\\\begin{reponses}%\\n            \\\\bonne{\\\\ListeAMCRep[1]}%\\n            \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\ListeAMCReplen}}\\\\do{%\\n              \\\\mauvaise{\\\\ListeAMCRep[##1]}%\\n            }%\\n          \\\\end{reponses}%\\n        \\\\else\\n          \\\\begin{reponseshoriz}%\\n            \\\\bonne{\\\\ListeAMCRep[1]}%\\n            \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\ListeAMCReplen}}\\\\do{%\\n              \\\\mauvaise{\\\\ListeAMCRep[##1]}%\\n            }%\\n          \\\\end{reponseshoriz}%\\n        \\\\fi\\n        \\\\end{question}\\n      \\\\fi\\n  }{}%\\n}%\\n\\\\makeatother\\n\\n\\\\makeatletter\\n\\\\tcbset{%\\n  tikzamc/.style={%\\n    before skip=0em,\\n    bottom=0pt,\\n    enhanced,\\n    breakable,\\n    colback=white,\\n    frame hidden,\\n    overlay unbroken and first={%\\n      \\\\node[%\\n      name=A,\\n      fill=white,\\n      anchor=west,\\n      %xshift=\\\\kvtcb@leftlower,\\n      ] at (frame.north west){\\\\bfseries\\\\sffamily\\\\useKV[AMC]{NomExercice}\\\\ifboolKV[ClesExercices]{Numerote}{ \\\\thePfMExo}{}\\\\ifboolKV[ClesExercices]{AffichageTitre}{\\\\ifboolKV[ClesExercices]{Numerote}{~:~}{\\\\xdef\\\\PfMTitiLgNE{\\\\useKV[Fiche]{NomExercice}}\\\\IfStrEq{\\\\PfMTitiLgNE}{}{}{~:~}}\\\\useKV[ClesExercices]{Titre}}{}};\\n      %%\\n      \\\\useKV[ClesExercices]{Ajout}%\\n%      %% \\n    }%\\n  }%\\n}%\\n\\\\makeatother\\n\\n\\\\def\\\\PfMScoreA{5}%\\n\\\\def\\\\PfMScoreB{3}%\\n\\\\def\\\\PfMScoreC{1}%\\n\\\\def\\\\PfMScoreD{0.1}%\\n\\n\\\\NewDocumentEnvironment{exerciceAmc}{o}{%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  \\\\setcounter{PfMAMCOpen}{0}%\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#1}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\PfMAvantLesExercices%\\n  \\\\begin{tcolorbox}[tikzamc]%\\n  }{%\\n    \\\\ifnum\\\\thePfMAMCOpen=0\\\\relax\\n      \\\\PfMApresLesExercices\\n      \\\\par\\n      \\\\begin{question}{\\\\Roman{PfMExo}}\\n        \\\\AMCOpen{lineup=true,lineuptext=~,dots=false,backgroundcol=gray!20}{\\\\mauvaise[RR]{RR}\\\\scoring{\\\\PfMScoreD}\\\\mauvaise[R]{R}\\\\scoring{\\\\PfMScoreC}\\\\mauvaise[V]{V}\\\\scoring{\\\\PfMScoreB}\\\\bonne[VV]{VV}\\\\scoring{\\\\PfMScoreA}}%gray!15\\n      \\\\end{question}%\\n    \\\\fi\\n  \\\\end{tcolorbox}%\\n}%\\n\\n%%%%%%%%%%%%%%%%% Fin AMC\\n\\n%%% PixelArt\\n\\\\newtoks\\\\ToksPXTheme%\\n\\\\newtoks\\\\ToksPXNiveau%\\n\\\\def\\\\UpdateToksPXNiveau#1\\\\nil{\\\\addtotok\\\\ToksPXNiveau{#1}}%\\n\\\\def\\\\UpdateToksPXTheme#1\\\\nil{\\\\addtotok\\\\ToksPXTheme{#1}}%\\n\\n\\\\NewDocumentCommand\\\\PfMPXCount{}{%\\n  \\\\stepcounter{PfMLettresPixelArt}%\\n  \\\\xdef\\\\PfMCountPX{\\\\csname p\\\\Alph{PfMLettresPixelArt}\\\\endcsname}%\\n  \\\\PfMCountPX%\\n}%\\n\\n\\\\newcounter{PfMLettresPixelArt}\\n\\n\\\\NewDocumentCommand\\\\MPPixelArt{mm}{\\n  \\\\mplibforcehmode\\n  \\\\begin{mplibcode}\\n    path carre[];\\n\\n    u:=0.5mm;\\n\\n    color ColorEntier[],ColFond;\\n\\n    vardef BlocAffichage=\\n      for k=0 upto 34:\\n        carre[k]:=(unitsquare scaled u) shifted(u*(k mod 5,5-(k div 5)));\\n      endfor;\\n    enddef;\\n    \\n    vardef Affichage(expr decomp)=\\n      save $;\\n      picture $;\\n      drawoptions(withpen pensquare scaled0.1);\\n      $=image(%\\n        for k=0 upto 34:\\n          if (substring(k,k+1) of decomp)=\\\"1\\\":\\n            fill carre[k] withcolor ColFond;\\n          fi;\\n        endfor;\\n      );\\n      drawoptions();\\n      $\\n      enddef;\\n\\n      nblignes:=1;\\n\\n      decahoriz:=0;\\n\\n      vardef Test(expr cptk)(text cptnt)=\\n        pair Decalage;\\n        Decalage=u*(decahoriz,-8*(nblignes-1));\\n        decahoriz:=decahoriz+6;\\n        if substring(cptk,cptk+1) of cptnt=\\\"A\\\":draw Affichage(\\\"01110100011000110001111111000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"B\\\":draw Affichage(\\\"11110100011000111110100011000111110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"C\\\":draw Affichage(\\\"01110100011000010000100001000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"D\\\":draw Affichage(\\\"11100100101000110001100011001011100\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"E\\\":draw Affichage(\\\"11111100001000011111100001000011111\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"F\\\":draw Affichage(\\\"11111100001000011111100001000010000\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"G\\\":draw Affichage(\\\"01110100011000010111100011000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"H\\\":draw Affichage(\\\"10001100011000111111100011000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"I\\\":draw Affichage(\\\"01110001000010000100001000010001110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"J\\\":draw Affichage(\\\"00111000100001000010000101001001100\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"K\\\":draw Affichage(\\\"10001100101010011000101001001010001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"L\\\":draw Affichage(\\\"10000100001000010000100001000011111\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"M\\\":draw Affichage(\\\"10001110111010110101100011000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"N\\\":draw Affichage(\\\"10001100011100110101100111000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"O\\\":draw Affichage(\\\"01110100011000110001100011000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"P\\\":draw Affichage(\\\"11110100011000111110100001000010000\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"Q\\\":draw Affichage(\\\"01110100011000110001101011001001101\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"R\\\":draw Affichage(\\\"11110100011000111110101001001010001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"S\\\":draw Affichage(\\\"01111100001000001110000010000111110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"T\\\":draw Affichage(\\\"11111001000010000100001000010000100\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"U\\\":draw Affichage(\\\"10001100011000110001100011000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"V\\\":draw Affichage(\\\"10001100011000110001100010101000100\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"W\\\":draw Affichage(\\\"10101101011010110101101011010101010\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"X\\\":draw Affichage(\\\"10001100010101000100010101000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"Y\\\":draw Affichage(\\\"10001100011000101010001000010000100\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"Z\\\":draw Affichage(\\\"11111000010001000100010001000011111\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"a\\\":draw Affichage(\\\"00000000000111100001011111000101111\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"b\\\":draw Affichage(\\\"10000100001011011001100011000111110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"c\\\":draw Affichage(\\\"00000000000111010000100001000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"d\\\":draw Affichage(\\\"00001000010110110011100011000101111\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"e\\\":draw Affichage(\\\"00000000000111010001111111000001110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"f\\\":draw Affichage(\\\"00110010010100011100010000100001000\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"g\\\":draw Affichage(\\\"00000011111000110001011110000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"h\\\":draw Affichage(\\\"10000100001011011001100011000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"i\\\":draw Affichage(\\\"00100000000110000100001000010001110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"j\\\":draw Affichage(\\\"00010000000011000010000101001001100\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"k\\\":draw Affichage(\\\"10000100001001010100110001010010010\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"l\\\":draw Affichage(\\\"01100001000010000100001000010001110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"m\\\":draw Affichage(\\\"00000000001101010101101011000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"n\\\":draw Affichage(\\\"00000000001011011001100011000110001\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"o\\\":draw Affichage(\\\"00000000000111010001100011000101110\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"p\\\":draw Affichage(\\\"00000000001111010001111101000010000\\\") shifted(Decalage);\\n        elseif substring(cptk,cptk+1) of cptnt=\\\"q\\\":draw Affichage(\\\"00000000000110110011011110000100001\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"r\\\":draw Affichage(\\\"00000000001011011001100001000010000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"s\\\":draw Affichage(\\\"00000000000111010000011100000111110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"t\\\":draw Affichage(\\\"01000010001110001000010000100100110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"u\\\":draw Affichage(\\\"00000000001000110001100011001101101\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"v\\\":draw Affichage(\\\"00000000001000110001100010111000100\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"w\\\":draw Affichage(\\\"00000000001010110101101011010101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"x\\\":draw Affichage(\\\"00000000001000101010001000101010001\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"y\\\":draw Affichage(\\\"00000000001000110001011110000101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"z\\\":draw Affichage(\\\"00000000001111100010001000100011111\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"0\\\":draw Affichage(\\\"01110100011001110101110011000101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"1\\\":draw Affichage(\\\"00100011000010000100001000010001110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"2\\\":draw Affichage(\\\"01110100010000100010001000100011111\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"3\\\":draw Affichage(\\\"11111000100010000010000011000101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"4\\\":draw Affichage(\\\"00010001100101010010111110001000010\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"5\\\":draw Affichage(\\\"11111100001111000001000011000101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"6\\\":draw Affichage(\\\"00110010001000011110100011000101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"7\\\":draw Affichage(\\\"11111000010001000100010000100001000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"8\\\":draw Affichage(\\\"01110100011000101110100011000101110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"9\\\":draw Affichage(\\\"01110100011000101111000010001001100\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"!\\\":draw Affichage(\\\"00100001000010000100000000000000100\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"'\\\":draw Affichage(\\\"01100001000100000000000000000000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"(\\\":draw Affichage(\\\"00010001000100001000010000010000010\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\")\\\":draw Affichage(\\\"01000001000001000010000100010001000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"*\\\":draw Affichage(\\\"00000001001010101110101010010000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"+\\\":draw Affichage(\\\"00000001000010011111001000010000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"-\\\":draw Affichage(\\\"00000000000000011111000000000000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\".\\\":draw Affichage(\\\"00000000000000000000000000110001100\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\":\\\":draw Affichage(\\\"00000011000110000000011000110000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\";\\\":draw Affichage(\\\"00000011000110000000011000010001000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"<\\\":draw Affichage(\\\"00010001000100010000010000010000010\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"=\\\":draw Affichage(\\\"00000000001111100000111110000000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\">\\\":draw Affichage(\\\"10000010000010000010001000100010000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"?\\\":draw Affichage(\\\"01110100010000100010001000000000100\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"[\\\":draw Affichage(\\\"01110010000100001000010000100001110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"]\\\":draw Affichage(\\\"01110000100001000010000100001001110\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"`\\\":draw Affichage(\\\"01000001000001000000000000000000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"|\\\":draw Affichage(\\\"00100001000010000100001000010000100\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\" \\\":draw Affichage(\\\"00000000000000000000000000000000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"&\\\":draw Affichage(\\\"00000100001100011100110001000000000\\\") shifted(Decalage);\\n%    elseif substring(cptk,cptk+1) of cptnt=\\\"$\\\":draw Affichage(\\\"00000000000000100001000010000111111\\\") shifted(Decalage);\\n%    elseif substring(cptk,cptk+1) of cptnt=\\\"^\\\":draw Affichage(\\\"00100010101000100000000000000000000\\\") shifted(Decalage);\\n    elseif substring(cptk,cptk+1) of cptnt=\\\"_\\\":draw Affichage(\\\"00000000000000000000000000000000000\\\") shifted(Decalage);\\n%    elseif substring(cptk,cptk+1) of cptnt=\\\"~\\\":draw Affichage(\\\"01000010000111001000010000100001000\\\") shifted(Decalage);\\n    fi;\\nenddef;\\n\\nvardef LCDSeul(text nt)=\\n  decahoriz:=0;\\n  ColFond:=black;\\n    if length(nt)>0:\\n    for k=0 upto length(nt)-1:\\n    BlocAffichage;\\n    Test(k,nt);\\n    endfor;\\n    fi;\\n    enddef;\\n    \\n    picture TestLCD;\\n    TestLCD=image(\\n    LCDSeul(#1);\\n    );\\n    bboxmargin:=3u;\\n    maxlarg=abs(lrcorner bbox TestLCD - llcorner bbox TestLCD)/u;\\n    maxhaut=abs(urcorner bbox TestLCD - lrcorner bbox TestLCD)/u;\\n    for k=0 upto maxlarg-1:\\n      for l=0 upto maxhaut-1:\\n        draw (unitsquare scaled u) shifted(llcorner bbox TestLCD+u*(k,l)) withcolor 0.8white;\\n      endfor;\\n    endfor;\\n    draw bbox TestLCD;\\n    \\n    draw TestLCD;\\n    picture Retiens;\\n    Retiens=currentpicture;\\n    currentpicture:=nullpicture;\\n    draw Retiens scaled 2;\\n  \\\\end{mplibcode}\\n}%\\n\\n\\\\NewDocumentCommand\\\\TikzPixelArt{}{%\\n  \\\\ToksPXNiveau{}%\\n  \\\\xdef\\\\Titi{\\\"Classe de \\\\useKV[PixelArt]{Niveau}\\\"}%\\n  \\\\expandafter\\\\UpdateToksPXNiveau\\\\Titi\\\\nil%\\n  \\\\ToksPXTheme{}%\\n  \\\\xdef\\\\Toto{\\\"\\\\useKV[PixelArt]{Theme}\\\"}%\\n  \\\\expandafter\\\\UpdateToksPXTheme\\\\Toto\\\\nil%\\n  \\\\xdef\\\\ListeAvantCouleurs{\\\\useKV[PixelArt]{ListeCouleurs}}%\\n  \\\\begin{center}\\n    \\\\MPPixelArt{\\\\the\\\\ToksPXTheme}{\\\\ListeAvantCouleurs}%\\n  \\\\end{center}\\n}%\\n\\n\\\\newcounter{PfMPX}[PfMMaquette]\\n\\\\setcounter{PfMPX}{0}\\n\\n\\\\NewDocumentCommand\\\\PfMSolPixelArt{m}{%\\n  \\\\ifboolKV[Boulot]{PixelArt}{%\\n    \\\\stepcounter{PfMLettresPixelArt}%\\n    \\\\ifboolKV[PixelArt]{Aleatoire}{%\\n         \\\\hfill\\\\textbf{Lettre~\\\\ListePourLesItems[\\\\fpeval{\\\\thePfMLettresPixelArt+1}]}%\\n        %Num Lettre = \\\\thePfMLettresPixelArt\\n    }{%\\n      \\\\hfill\\\\textbf{Lettre~\\\\Alph{PfMLettresPixelArt}}%\\n    }%\\n    \\\\ifdef{\\\\ListeSolAv}{%\\n      \\\\xdef\\\\ListeSolAv{\\\\ListeSolAv,#1}%\\n    }{%\\n      \\\\xdef\\\\ListeSolAv{#1}%\\n    }%\\n  }{}%\\n}%\\n\\n\\\\NewDocumentEnvironment{exercicePX}{o}{%\\n  \\\\setcounter{PfMAlea}{0}%\\n  \\\\setcounter{PfMNbLogo}{1}%\\n  % Mettre les indications hors-jeu\\n  \\\\setcounter{RetiensIndic}{0}%\\n  \\\\useKVdefault[ClesExercices]%\\n  \\\\setKV[ClesExercices]{#1}%\\n  \\\\ifboolKV[Boulot]{Input}{\\\\Relecture}{}%\\n  \\\\setKV[ClesExercices]{BaremeTotal=false,BaremeDetaille=false}%\\n  \\\\refstepcounter{PfMExo}%\\n}{}\\n%%% Fin PixelArt\\n\\n\\\\def\\\\PfMLogoBeamer{}\\n\\n%%%%%%%%%%%%%%% Debut Maquette %%%%%%%\\n% Environnement englobant le tout.\\n\\\\makeatletter\\n\\\\newwrite\\\\PfMfile@out%\\n\\n\\\\IfClassLoadedTF{beamer}{%\\n  %-> tex.stackexchange.com/questions/605282/beamer-custom-frame-environment-with-options\\n  \\\\NewDocumentEnvironment{Maquette}{om}{%\\n    \\\\ifcsname PfMGraineBeamer\\\\endcsname%\\n      \\\\setKVdefault[Boulot]{Graine=\\\\fpeval{\\\\PfMGraineBeamer+\\\\thePfMMaquette}}%\\n    \\\\else%\\n      \\\\def\\\\PfMGraineBeamer{\\\\fpeval{randint(1000)}}%\\n    \\\\fi%\\n    \\\\immediate\\\\write\\\\@auxout{\\\\noexpand\\\\expandafter\\\\gdef\\\\noexpand\\\\csname PfMGraineBeamer\\\\endcsname{\\\\csname PfMGraineBeamer\\\\endcsname}}%\\n    %\\n    \\\\setcounter{RetiensSol}{0}%\\n    \\\\setcounter{RetiensRep}{0}%\\n    \\\\setcounter{RetiensInd}{0}%\\n    % on remet  zro le compteur des exercices\\n    % \\\\setcounter{PfMExo}{0}%\\n    \\\\setcounter{PfMSOS}{0}%\\n    % nouvelles valeurs.\\n    \\\\stepcounter{PfMMaquette}%\\n    \\\\IfHookExistsTF{env/exercice/after}{\\\\RemoveFromHook{env/exercice/after}[*]\\\\AddToHook{env/exercice/after}[ChoixExo]{\\\\PfMChoixAffichageCorrection\\\\PfMChoixAffichageEntrainement}}{\\\\AddToHook{env/exercice/after}[ChoixExo]{\\\\PfMChoixAffichageCorrection\\\\PfMChoixAffichageEntrainement}}%\\n    \\\\useKVdefault[Boulot]%\\n    \\\\setKV[Boulot]{#1}%\\n    \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n        \\\\AtEndDocument{%\\n          \\\\PfMPrepareCorrection{#1}%\\n          \\\\begin{frame}\\n            \\\\frametitle{\\\\useKV[Beamer]{Theme}\\\\hfill\\\\raisebox{-0.25\\\\height}{%\\n                \\\\PfMLogoBeamer}~\\\\phantom{t}}%\\n            \\\\PfMAffichageCorrige%\\n          \\\\end{frame}\\n        }%\\n      }{}%\\n    \\\\useKVdefault[Beamer]%\\n    \\\\setKV[Beamer]{#2}%\\n    \\\\let\\\\exercice\\\\exerciceBeamer\\\\let\\\\endexercice\\\\endexerciceBeamer%\\n    \\\\begin{frame}[environment=Maquette,fragile]\\n      \\\\setcounter{PfMExo}{0}%\\n      \\\\PfCGraineAlea{\\\\useKV[Boulot]{Graine}}%\\n      \\\\frametitle{\\\\useKV[Beamer]{Theme}\\\\hfill\\\\raisebox{-0.25\\\\height}{%\\n        \\\\PfMLogoBeamer}~\\\\phantom{t}}%\\n    }{%\\n    \\\\end{frame}\\n  }%\\n}{%\\n\\\\NewDocumentEnvironment{Maquette}{om}{%\\n  % on remet  zro les compteurs de solutions : inutile ?\\n  \\\\setcounter{RetiensSol}{0}%\\n  \\\\setcounter{RetiensRep}{0}%\\n  \\\\setcounter{RetiensInd}{0}%\\n  % on remet  zro le compteur des exercices\\n  %\\\\setcounter{PfMExo}{0}%\\n  \\\\setcounter{PfMSOS}{0}%\\n  % nouvelles valeurs.\\n  \\\\stepcounter{PfMMaquette}%\\n  \\\\immediate\\\\write\\\\@auxout{%\\n    \\\\string\\\\opcopy{0}{ScoreTotal\\\\thePfMMaquette}\\n  }%\\n  %% \\\\opadd*{#1}{ScoreTotal\\\\thePfMMaquette}{ScoreTotal\\\\thePfMMaquette}%\\n  \\\\useKVdefault[Boulot]%\\n  \\\\setKV[Boulot]{#1}%\\n  \\\\if@AssembleCorrections\\n  \\\\immediate\\\\openout\\\\PfMfile@out \\\\jobname-DefiMq-\\\\thePfMMaquette.tex%\\n  \\\\immediate\\\\write\\\\PfMfile@out{\\\\unexpanded{\\\\useKVdefault[Boulot]}}%\\n  \\\\immediate\\\\write\\\\PfMfile@out{\\\\unexpanded{\\\\setKV[Boulot]{#1}}}%\\n  \\\\ifboolKV[Boulot]{Fiche}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzFicheCor{\\\\unexpanded{#2}}}}{}%\\n  \\\\ifboolKV[Boulot]{DS}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzDSCor{\\\\unexpanded{#2}}}}{}%\\n  \\\\ifboolKV[Boulot]{DM}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzDMCor{\\\\unexpanded{#2}}}}{}%\\n  \\\\ifboolKV[Boulot]{IE}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzIECor{\\\\unexpanded{#2}}}}{}%\\n  \\\\ifboolKV[Boulot]{FdR}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzFdRCor{\\\\unexpanded{#2}}}}{}%\\n  \\\\ifboolKV[Boulot]{Contrat}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzContratCor{\\\\unexpanded{#2}}}}{}%\\n  \\\\ifboolKV[Boulot]{Parcours}{\\\\immediate\\\\write\\\\PfMfile@out{\\\\TikzParcoursCor{\\\\unexpanded{#2}}}}{}%\\n  \\\\immediate\\\\closeout\\\\PfMfile@out%\\n  \\\\fi\\n  % options de boulot\\n  \\\\IfHookExistsTF{env/Maquette/after}{\\\\RemoveFromHook{env/Maquette/after}[*]}{}%\\n  \\\\AddToHook{env/Maquette/after}[RetiensExo]{\\\\xdef\\\\PfMRetiensLienExoMa{\\\\PfMRetiensLienExoMa,\\\\thePfMExo}}\\n    %--------------\\n%  \\\\useKVdefault[Boulot]%\\n%  \\\\setKV[Boulot]{#1}%\\n  \\\\ifboolKV[Boulot]{CorrigeSeul}{\\\\setKV[Boulot]{CorrigeFin}}{}%\\n  \\\\if@Dyslexie%\\n    \\\\setKV[Boulot]{Dys}%\\n  \\\\fi%\\n  \\\\PfMBasculeDys%\\n  \\\\IfHookExistsTF{env/exercice/after}{\\\\RemoveFromHook{env/exercice/after}[*]\\\\AddToHook{env/exercice/after}[ChoixExo]{\\\\PfMChoixAffichageCorrection\\\\PfMChoixAffichageEntrainement}}{\\\\AddToHook{env/exercice/after}[ChoixExo]{\\\\PfMChoixAffichageCorrection\\\\PfMChoixAffichageEntrainement}}%\\n  % Test\\n  \\\\IfHookExistsTF{env/exercice/begin}{\\\\RemoveFromHook{env/exercice/begin}[*]}{}%\\n  \\\\IfHookExistsTF{env/Maquette/end}{\\\\RemoveFromHook{env/Maquette/end}[*]}{}%\\n  \\\\ifboolKV[Boulot]{AMC}{%\\n      \\\\setcounter{PfMNbListeReponsesAMC}{0}%\\n      \\\\setKV[AMC]{#2}%\\n      \\\\let\\\\exercice\\\\exerciceAmc\\\\let\\\\endexercice\\\\endexerciceAmc%\\n      \\\\TikzAMC%\\n    }{%\\n  \\\\ifboolKV[Boulot]{OlympiadesAPMEP}{%\\n    \\\\setKV[OlympiadesAPMEP]{#2}%\\\\TikzOlympiadesAPMEP%\\n    \\\\let\\\\exercice\\\\exerciceOlympiadesAPMEP\\\\let\\\\endexercice\\\\endexerciceOlympiadesAPMEP%\\n    \\\\ifboolKV[OlympiadesAPMEP]{Bandeau}{%\\n        \\\\TikzOlympiadesAPMEP{#2}%\\n        \\\\bigskip\\n    }{%\\n      \\\\xdef\\\\PfMTitreAPMEP{\\\\useKV[OlympiadesAPMEP]{Theme}}\\n      \\\\chapter{\\\\PfMTitreAPMEP}\\n    }\\n    \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n      \\\\AddToHook{env/Maquette/after}[Correction]{%\\n        \\\\PfMPrepareCorrection{#1}%\\n        \\\\TikzOlympiadesAPMEPCor{#2}%\\n        \\\\PfMAffichageCorrectionColonnes%\\n      }%\\n    }{}%\\n  }{%\\n    \\\\ifboolKV[Boulot]{CAN}{%\\n      \\\\setKV[CAN]{#2}%\\n      \\\\setcounter{PfMCNNumQ}{0}%\\n      \\\\setlength{\\\\PfMLargeurQuestion}{\\\\useKV[CAN]{CoefQ}\\\\linewidth}\\\\setlength{\\\\PfMLargeurReponse}{\\\\useKV[CAN]{CoefR}\\\\linewidth}\\\\setlength{\\\\PfMLargeurJury}{\\\\useKV[CAN]{CoefJ}\\\\linewidth}%\\n      \\\\let\\\\exercice\\\\ExoCANWrite\\\\let\\\\endexercice\\\\endExoCANWrite%\\n      \\\\AddToHook{env/exercice/begin}{\\\\setcounter{PfMAlea}{0}}%\\n      \\\\AddToHook{env/Maquette/end}{%\\n        \\\\xdef\\\\PfMAncienneGraine{\\\\PfMChoisisGraineAlea{123456789}}%\\n        \\\\xdef\\\\PfMCANTotalExo{\\\\thePfMExo}%\\n        \\\\setbox\\\\PfMSauvegardeBox\\\\vbox{%\\n          \\\\PfMGraineAlea{\\\\thePfMMaquette}%\\n          \\\\setcounter{PfMExo}{0}%\\n          \\\\renewcommand{\\\\arraystretch}{2}%\\n          \\\\begin{longtable}{|c|m{\\\\PfMLargeurQuestion}|>{\\\\centering\\\\arraybackslash}m{\\\\PfMLargeurReponse}|m{\\\\PfMLargeurJury}|}%\\n            \\\\hhline{~---}%\\n            \\\\multicolumn{1}{c|}{}&\\\\cellcolor{gray!15}\\\\centering Question&\\\\cellcolor{gray!15}\\\\centering Rponse&\\\\cellcolor{gray!15}\\\\centering\\\\arraybackslash Jury\\\\\\\\%\\n            \\\\hline%\\n            \\\\endhead%\\n            \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\PfMCANTotalExo}}\\\\do{%\\n              \\\\refstepcounter{PfMCNNumQ}\\\\ttfamily{\\\\thePfMCNNumQ}\\\\label{TestCAN-\\\\thePfMCNNumQ}&\\\\Complement{}\\\\stepcounter{PfMExo}\\\\setcounter{PfMAlea}{0}\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.can}&\\\\CNReponse&\\\\\\\\\\n              \\\\hline%\\n            }%\\n          \\\\end{longtable}%\\n          \\\\renewcommand{\\\\arraystretch}{1}%\\n        }%\\n        \\\\ifboolKV[Boulot]{CorrigeInverse}{%\\n          \\\\PfMPrepareCorrection{#1}%\\n          \\\\TikzCANCor{#2}%\\n          \\\\PfMAffichageCorrectionColonnes%\\n          \\\\clearpage\\n          \\\\normalsize%\\n          \\\\TikzCAN%\\n          \\\\PfMGraineAlea{\\\\thePfMMaquette}%\\n          \\\\setcounter{PfMCNNumQ}{0}%\\n          \\\\setcounter{PfMExo}{0}%\\n          \\\\renewcommand{\\\\arraystretch}{2}%\\n          \\\\begin{longtable}{|c|m{\\\\PfMLargeurQuestion}|>{\\\\centering\\\\arraybackslash}m{\\\\PfMLargeurReponse}|m{\\\\PfMLargeurJury}|}%\\n            \\\\hhline{~---}%\\n            \\\\multicolumn{1}{c|}{}&\\\\cellcolor{gray!15}\\\\centering Question&\\\\cellcolor{gray!15}\\\\centering Rponse&\\\\cellcolor{gray!15}\\\\centering\\\\arraybackslash Jury\\\\\\\\%\\n            \\\\hline%\\n            \\\\endhead%\\n            \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\PfMCANTotalExo}}\\\\do{%\\n              \\\\refstepcounter{PfMCNNumQ}\\\\ttfamily{\\\\thePfMCNNumQ}\\\\label{TestCAN-\\\\thePfMCNNumQ}&\\\\Complement{}\\\\stepcounter{PfMExo}\\\\setcounter{PfMAlea}{0}\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.can}&\\\\CNReponse&\\\\\\\\\\n              \\\\hline%\\n            }%\\n          \\\\end{longtable}%\\n          \\\\renewcommand{\\\\arraystretch}{1}%\\n        }{%\\n          \\\\PfMGraineAlea{\\\\PfMAncienneGraine}%\\n          \\\\TikzCAN%\\n          \\\\setcounter{PfMCNNumQ}{0}%\\n          \\\\setcounter{PfMExo}{0}%\\n          \\\\renewcommand{\\\\arraystretch}{2}%\\n          \\\\begin{longtable}{|c|m{\\\\PfMLargeurQuestion}|>{\\\\centering\\\\arraybackslash}m{\\\\PfMLargeurReponse}|m{\\\\PfMLargeurJury}|}%\\n            \\\\hhline{~---}%\\n            \\\\multicolumn{1}{c|}{}&\\\\cellcolor{gray!15}\\\\centering Question&\\\\cellcolor{gray!15}\\\\centering Rponse&\\\\cellcolor{gray!15}\\\\centering\\\\arraybackslash Jury\\\\\\\\%\\n            \\\\hline%\\n            \\\\endhead%\\n            \\\\xintFor* ##1 in {\\\\xintSeq{1}{\\\\PfMCANTotalExo}}\\\\do{%\\n              \\\\refstepcounter{PfMCNNumQ}\\\\ttfamily{\\\\thePfMCNNumQ}\\\\label{TestCAN-\\\\thePfMCNNumQ}&\\\\Complement{}\\\\stepcounter{PfMExo}\\\\setcounter{PfMAlea}{0}\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.can}&\\\\CNReponse&\\\\\\\\\\n              \\\\hline%\\n            }%\\n          \\\\end{longtable}%\\n          \\\\renewcommand{\\\\arraystretch}{1}%\\n          \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n            \\\\ifboolKV[Boulot]{CorrigeInverse}{}{%\\n              \\\\clearpage\\n              \\\\PfMPrepareCorrection{#1}%\\n              \\\\TikzCANCor{#2}%\\n              \\\\PfMAffichageCorrectionColonnes%\\n            }%\\n          }{}%\\n        }%\\n      }%\\n    }{%\\n      \\\\ifboolKV[Boulot]{FdR}{%\\n        % \\\\input{PfMMaquetteFdR.tex}%\\n        \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n          \\\\setKV[FdR]{#2}\\\\TikzFdR%\\n        }%\\n        \\\\let\\\\exercice\\\\exerciceFdR\\\\let\\\\endexercice\\\\endexerciceFdR%\\n        \\\\ifboolKV[Boulot]{AvecEntrainement}{%\\n          \\\\AddToHook{env/Maquette/end}[Haltere]{%\\n            \\\\PfMAffichageEntrainementColonnes%\\n          }%\\n        }{}%\\n        \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n          \\\\AddToHook{env/Maquette/after}[Correction]{%\\n            \\\\PfMPrepareCorrection{#1}%\\n            \\\\TikzFdRCor{#2}%\\n            \\\\PfMAffichageCorrectionColonnes%\\n          }%\\n        }{}%\\n      }{%\\n        \\\\ifboolKV[Boulot]{Contrat}{%\\n          % \\\\input{PfMMaquetteContrat.tex}%\\n          \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n            \\\\setKV[Contrat]{#2}\\\\TikzContrat%\\n          }%\\n          \\\\let\\\\exercice\\\\exerciceContrat\\\\let\\\\endexercice\\\\endexerciceContrat%\\n          \\\\ifboolKV[Boulot]{AvecEntrainement}{%\\n            \\\\AddToHook{env/Maquette/end}[Haltere]{%\\n              \\\\PfMAffichageEntrainementColonnes%\\n            }%\\n          }{}%\\n          \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n            \\\\AddToHook{env/Maquette/after}[Correction]{%\\n              \\\\PfMPrepareCorrection{#1}%\\n              \\\\TikzContratCor{#2}%\\n              \\\\PfMAffichageCorrectionColonnes%\\n            }%\\n          }{}%\\n        }{%\\n          \\\\ifboolKV[Boulot]{Cours}{%\\n            % \\\\input{PfMMaquetteCours.tex}%\\n            \\\\setKV[Cours]{#2}%\\n            \\\\TikzCours%\\n            \\\\let\\\\exercice\\\\exerciceFiche\\\\let\\\\endexercice\\\\endexerciceFiche%\\n            \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n              \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                \\\\PfMPrepareCorrection{#1}%\\n                \\\\TikzFicheCor{#2}%\\n                \\\\PfMAffichageCorrectionColonnes%\\n              }%\\n            }{}%\\n          }{%\\n            \\\\ifboolKV[Boulot]{RecapBrevet}{%\\n              % \\\\input{PfMMaquetteRecapBrevet.tex}%\\n              \\\\setKV[RecapBrevet]{#2}%\\n              \\\\TikzRecapBrevet%\\n              \\\\let\\\\exercice\\\\ExerciceRecapBrevet\\\\let\\\\endexercice\\\\endExerciceRecapBrevet%\\n              \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                  \\\\PfMPrepareCorrection{#1}%\\n                  \\\\TikzRecapBrevetCor{#2}%\\n                  \\\\PfMAffichageCorrectionColonnes%\\n                }%\\n              }{}%\\n            }{%\\n              \\\\ifboolKV[Boulot]{ParcoursPerso}{%\\n                % \\\\input{PfMMaquetteParcoursPerso.tex}%\\n                \\\\setKV[ParcoursPerso]{#2}%\\n                \\\\DTLloaddb[noheader,keys={PrenomEleve,NomEleve,ListeExo}]{dataperso}{\\\\useKV[ParcoursPerso]{Fichier}.csv}%\\n                \\\\let\\\\exercice\\\\exerciceParcoursPerso\\\\let\\\\endexercice\\\\endexerciceParcoursPerso%\\n                \\\\ifboolKV[Boulot]{CorrigeFin}{\\\\setcounter{PfMCorrigeParcoursPerso}{1}}{}%\\n                \\\\setcounter{PfMExo}{0}%\\n                \\\\AtEndDocument{%\\n                  \\\\PfMRecapitulatif{#1}{#2}%\\n                }%\\n              }{%\\n                \\\\ifboolKV[Boulot]{Parcours}{%\\n                  % \\\\input{PfMMaquetteParcours.tex}%\\n                  \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n                    \\\\setKV[Parcours]{#2}\\\\TikzParcours%\\n                  }%\\n                  \\\\let\\\\exercice\\\\exerciceParcours\\\\let\\\\endexercice\\\\endexerciceParcours%\\n                  \\\\ifboolKV[Boulot]{AvecEntrainement}{%\\n                    \\\\AddToHook{env/Maquette/end}[Haltere]{%\\n                      \\\\PfMAffichageEntrainementColonnes%\\n                    }%\\n                  }{}%\\n                  \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                    \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                      \\\\PfMPrepareCorrection{#1}%\\n                      \\\\TikzParcoursCor{#2}%\\n                      \\\\PfMAffichageCorrectionColonnes%\\n                    }%\\n                  }{}%\\n                }{%\\n                  \\\\ifboolKV[Boulot]{PdT}{%\\n                    % \\\\input{PfMMaquettePdT.tex}%\\n                    \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n                      \\\\setKV[PdT]{#2}\\\\TikzPdT%\\n                    }%\\n                    \\\\let\\\\exercice\\\\exercicePdT\\\\let\\\\endexercice\\\\endexercicePdT%\\n                    \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                      \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                        \\\\PfMPrepareCorrection{#1}%\\n                        \\\\TikzPdTCor{#2}%\\n                        \\\\PfMAffichageCorrectionColonnes%\\n                      }%\\n                    }{}%\\n                  }{%\\n                    \\\\ifboolKV[Boulot]{DM}{%\\n                      % \\\\input{PfMMaquetteDM.tex}%\\n                      \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n                        \\\\setKV[DM]{#2}\\\\TikzDM%\\n                      }%\\n                      \\\\let\\\\exercice\\\\exerciceDM\\\\let\\\\endexercice\\\\endexerciceDM%\\n                      \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                        \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                          \\\\PfMPrepareCorrection{#1}%\\n                          \\\\TikzDMCor{#2}%\\n                          \\\\PfMAffichageCorrectionColonnes%\\n                        }%\\n                      }{}%\\n                    }{%\\n                      \\\\ifboolKV[Boulot]{Fiche}{%\\n                        \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n                          \\\\setKV[Fiche]{#2}%\\n                          \\\\TikzFiche%\\n                        }%\\n                        \\\\let\\\\exercice\\\\exerciceFiche\\\\let\\\\endexercice\\\\endexerciceFiche%\\n                        \\\\ifboolKV[Boulot]{AvecEntrainement}{%\\n                          \\\\AddToHook{env/Maquette/end}[Haltere]{%\\n                            \\\\PfMAffichageEntrainementColonnes%\\n                          }%\\n                        }{}%\\n                        \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                          \\\\ifboolKV[Boulot]{CorrigeAll}{%\\n                            \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                              \\\\PfMPrepareCorrection{#1}%\\n                              \\\\TikzFicheCor{#2}%\\n                              \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n                              \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\thePfMExo}}\\\\do{%\\n                                \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.sol}{\\\\textbf{Corrig de l'exercice ##1}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.sol}\\\\par\\\\goodbreak}{}%\\n                              }%\\n                              \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n                              \\\\TikzFicheCorRep{#2}%\\n                              \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n                              \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\thePfMExo}}\\\\do{%\\n                                \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.rep}{\\\\textbf{Rponse(s) de l'exercice ##1}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.rep}\\\\par\\\\goodbreak}{}%\\n                              }%\\n                              \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n                              \\\\TikzFicheCorInd{#2}%\\n                              \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n                              \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\thePfMExo}}\\\\do{%\\n                                \\\\IfFileExists{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.cdp}{\\\\textbf{Indice(s) pour l'exercice ##1}\\\\par\\\\nopagebreak\\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex##1.cdp}\\\\par\\\\goodbreak}{}%\\n                              }% \\n                              \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n                            }%\\n                          }{%\\n                            \\\\AddToHook{env/Maquette/after}[Correction]{%\\n%                              \\\\useKVdefault[Boulot]%\\n%                              \\\\setKV[Boulot]{#1}%\\n%                              %%\\n%                              \\\\if@Dyslexie\\n%                                \\\\setKV[Boulot]{Dys}%\\n%                              \\\\fi\\n%                              \\\\PfMBasculeDys%\\n%                              \\\\setlength{\\\\columnseprule}{\\\\useKV[Boulot]{Epaisseur}}%\\n                              \\\\if@AssembleCorrections\\n                              \\\\else\\n                                \\\\PfMPrepareCorrection{#1}%\\n                                \\\\TikzFicheCor{#2}%\\n                                \\\\PfMAffichageCorrectionColonnes%\\n                              \\\\fi%\\n                            }%\\n                          }%\\n                        }{}%\\n                      }{%\\n                        \\\\ifboolKV[Boulot]{DS}{%\\n                          % \\\\input{PfMMaquetteDS.tex}%\\n                          \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n                            \\\\setKV[DS]{#2}\\\\TikzDS%\\n                          }%\\n                          \\\\let\\\\exercice\\\\exerciceDS\\\\let\\\\endexercice\\\\endexerciceDS%\\n                          \\\\ifboolKV[Boulot]{BaremeComplet}{%\\n                            \\\\begin{center}\\n                              \\\\TableauRecapitulatif\\n                            \\\\end{center}\\n                          }{}%\\n                          \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                            \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                              \\\\if@AssembleCorrections\\n                              \\\\else\\n                                \\\\PfMPrepareCorrection{#1}%\\n                                \\\\TikzDSCor{#2}%\\n                                \\\\PfMAffichageCorrectionColonnes%\\n                              \\\\fi%\\n                            }%\\n                          }{}%\\n                        }{%\\n                          \\\\ifboolKV[Boulot]{IE}{%\\n                            % \\\\input{PfMMaquetteIE.tex}%\\n                            \\\\ifboolKV[Boulot]{CorrigeSeul}{}{%\\n                              \\\\setKV[IE]{#2}\\\\TikzIE%\\n                            }%\\n                            \\\\let\\\\exercice\\\\exerciceDS\\\\let\\\\endexercice\\\\endexerciceDS%On garde exerciceDS\\n                            \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                              \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                                \\\\PfMPrepareCorrection{#1}%\\n                                \\\\TikzIECor{#2}%\\n                                \\\\PfMAffichageCorrectionColonnes%\\n                              }%\\n                            }{}%\\n                          }{%\\n                            \\\\ifboolKV[Boulot]{Kholle}{%\\n                              % \\\\input{PfMMaquetteKholle.tex}%\\n                              \\\\setKV[Kholle]{#2}%\\n                              \\\\TikzKholle%\\n                              \\\\let\\\\exercice\\\\exerciceKholle\\\\let\\\\endexercice\\\\endexerciceKholle%\\n                              \\\\ifboolKV[Kholle]{CR}{}{%\\n                                \\\\ifboolKV[Boulot]{CorrigeFin}{%\\n                                  \\\\AddToHook{env/Maquette/after}[Correction]{%\\n                                    \\\\TikzKholleCor{#2}%\\n                                    \\\\TikzKholleCor{#2}%\\n                                    \\\\TikzKholleCor{#2}%\\n                                    \\\\PfMAffichageCorrige%\\n                                  }%\\n                                }{}%\\n                              }%\\n                            }{%\\n                              \\\\ifboolKV[Boulot]{LivreHeros}{%\\n                                \\\\setKV[LivreHeros]{#2}%\\n                                \\\\TikzLivreHeros%\\n                                \\\\let\\\\exercice\\\\ExoGBWrite\\\\let\\\\endexercice\\\\endExoGBWrite%\\n                                \\\\AddToHook{env/Maquette/end}{%\\n                                  \\\\xdef\\\\PfMListeExoGB{}%\\n                                  \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\thePfMExo}}\\\\do{%\\n                                    \\\\xdef\\\\PfMListeExoGB{\\\\PfMListeExoGB,##1}%\\n                                  }%\\n                                  \\\\MelangeListe{\\\\PfMListeExoGB}{\\\\fpeval{\\\\thePfMExo-1}}%\\n                                  \\\\xdef\\\\PfMFooMelange{1,\\\\faa}%\\n                                  \\\\setsepchar{,}\\\\ignoreemptyitems\\\\readlist*\\\\ListePerm{\\\\PfMFooMelange}\\\\reademptyitems%\\n                                  \\\\phantomsection{}\\n                                  \\\\addcontentsline{toc}{section}{\\\\useKV[LivreHeros]{Theme}}%\\n                                  \\\\setlength{\\\\columnseprule}{\\\\useKV[Boulot]{Epaisseur}}%\\n                                  \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\begin{multicols}{\\\\useKV[Boulot]{Colonnes}}}{}%\\n                                  \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\thePfMExo}}\\\\do{%\\n                                    \\\\itemtomacro\\\\ListePerm[##1]\\\\PfMPermute%\\n                                    \\\\begin{tcolorbox}[tikzLH,title=##1]%\\n                                      \\\\refstepcounter{PfMGameBook}%\\n                                      \\\\input{\\\\jobname-Ma\\\\thePfMMaquette-Ex\\\\PfMPermute.gb}%\\n                                    \\\\end{tcolorbox}%\\n                                  }%\\n                                  \\\\ifboolKV[Boulot]{CorrectionColonnes}{\\\\end{multicols}}{}%\\n                                }%\\n                              }{%\\n                                \\\\ifboolKV[Boulot]{PixelArt}{%\\n                                    \\\\setcounter{PfMLettresPixelArt}{0}\\n                                  \\\\xdef\\\\ListeSolAv{}%\\n                                  \\\\setKV[PixelArt]{#2}%\\n                                  \\\\setlength{\\\\PfMLargeurTableauPixelArt}{\\\\useKV[PixelArt]{LargeurTab}}%\\n                                  \\\\ifboolKV[PixelArt]{Aleatoire}{%\\n                                      \\\\setcounter{PfMLettresPixelArt}{1}%\\n                                      \\\\StrLen{\\\\useKV[PixelArt]{Lettres}}[\\\\PfMNbLettres]%\\n                                      \\\\ChoixSommet{\\\\PfMNbLettres}{S}%\\n                                      \\\\xdef\\\\ListePourLesItemsAv{\\\\pA}%\\n                                      \\\\xintFor* ##1 in{\\\\xintSeq{2}{\\\\PfMNbLettres}}\\\\do{%\\n                                        \\\\stepcounter{PfMLettresPixelArt}%\\n                                        \\\\xdef\\\\ListePourLesItemsAv{\\\\ListePourLesItemsAv,\\\\csname p\\\\Alph{PfMLettresPixelArt}\\\\endcsname}%\\n                                      }%\\n                                      \\\\setsepchar{,}\\\\ignoreemptyitems\\\\readlist*\\\\ListePourLesItems{\\\\ListePourLesItemsAv}\\\\reademptyitems%\\n                                      \\\\setcounter{PfMLettresPixelArt}{-1}%\\n                                      \\\\setKVdefault[PfMPixelArt]{ListeNombres={\\\\ListePourLesItemsAv}}%\\n                                    }{}%\\n                                  \\\\TikzPixelArt%\\n                                  \\\\let\\\\exercice\\\\exercicePX\\\\let\\\\endexercice\\\\endexercicePX%\\n                                  \\\\AddToHook{env/Maquette/end}{%\\n                                    \\\\StrLen{\\\\useKV[PixelArt]{Lettres}}[\\\\PfMNbLettres]\\n                                    \\\\setsepchar{,}\\\\ignoreemptyitems\\n                                    \\\\readlist*\\\\ListeSolPX{\\\\ListeSolAv}%\\n                                    \\\\reademptyitems\\n                                    \\\\ifnum\\\\fpeval{\\\\ListeSolPXlen}=\\\\fpeval{\\\\PfMNbLettres}\\\\relax\\n                                      \\\\xdef\\\\PfMListeExoPX{}%\\n                                      \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeSolPXlen}}\\\\do{%\\n                                        \\\\xdef\\\\PfMListeExoPX{\\\\PfMListeExoPX,##1}%\\n                                      }%\\n                                      \\\\MelangeListe{\\\\PfMListeExoPX}{\\\\ListeSolPXlen}%\\n                                      \\\\xdef\\\\PfMFooMelange{\\\\faa}%\\n                                      \\\\xdef\\\\PfMListeCouleursAv{\\\\useKV[PixelArt]{ListeCouleurs}}%\\n                                      \\\\setsepchar{,}\\\\ignoreemptyitems%\\n                                      \\\\readlist*\\\\ListePerm{\\\\PfMFooMelange}%\\n                                      \\\\readlist*\\\\ListeCouleursPX{\\\\PfMListeCouleursAv}%\\n                                      \\\\reademptyitems%\\n%                                      Le nombre de couleurs est \\\\ListeCouleursPXlen.\\\\\\\\\\n%                                      Le nombre de lettres est \\\\PfMNbLettres\\\\\\\\\\n                                      \\\\ifnum\\\\fpeval{\\\\ListeCouleursPXlen}=\\\\fpeval{\\\\PfMNbLettres}\\\\relax\\n                                        \\\\ifboolKV[PixelArt]{CoupureTableau}{%\\n                                          \\\\begin{center}\\n                                            \\\\quotient{\\\\ListeSolPXlen}{\\\\useKV[PixelArt]{CoupeTableau}}%\\n                                            \\\\modulo{\\\\ListeSolPXlen}{\\\\useKV[PixelArt]{CoupeTableau}}%\\n                                            \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\the\\\\intquotient}}\\\\do{%\\n                                              \\\\begin{tabular}{|*{\\\\useKV[PixelArt]{CoupeTableau}}{>{\\\\centering\\\\arraybackslash}m{\\\\PfMLargeurTableauPixelArt}|}}%\\n                                                \\\\hline%\\n                                                \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\useKV[PixelArt]{CoupeTableau}}}\\\\do{%\\n                                                \\\\itemtomacro\\\\ListePerm[\\\\fpeval{\\\\useKV[PixelArt]{CoupeTableau}*(##1-1)+##2}]\\\\PfMPermute%\\n                                                \\\\itemtomacro\\\\ListeCouleursPX[\\\\PfMPermute]\\\\Toto%\\n                                                \\\\xdef\\\\Titi{\\\\Toto}%\\n                                                \\\\cellcolor{\\\\Titi}\\\\xintifForLast{}{&}%\\\\Titi\\n                                                                                    }\\\\\\\\\\n                                                \\\\hline%\\n                                                \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\useKV[PixelArt]{CoupeTableau}}}\\\\do{%\\n                                                \\\\itemtomacro\\\\ListePerm[\\\\fpeval{\\\\useKV[PixelArt]{CoupeTableau}*(##1-1)+##2}]\\\\PfMPermute%\\n                                                \\\\itemtomacro\\\\ListeSolPX[\\\\PfMPermute]\\\\Toto%\\n                                                \\\\Toto\\\\xintifForLast{}{&}%\\\\Toto\\n                                                                        }\\\\\\\\\\n                                                \\\\hline\\n                                              \\\\end{tabular}\\\\par%\\n                                            }%\\n                                            \\\\ifnum\\\\remainder>0\\\\relax\\n                                            \\\\begin{tabular}{|*{\\\\the\\\\remainder}{>{\\\\centering\\\\arraybackslash}m{\\\\PfMLargeurTableauPixelArt}|}}%\\n                                              \\\\hline\\n                                              \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\the\\\\remainder}}\\\\do{%\\n                                              \\\\itemtomacro\\\\ListePerm[\\\\fpeval{\\\\useKV[PixelArt]{CoupeTableau}*\\\\the\\\\intquotient+##2}]\\\\PfMPermute%\\n                                              \\\\itemtomacro\\\\ListeCouleursPX[\\\\PfMPermute]\\\\Toto%\\n                                              \\\\xdef\\\\Titi{\\\\Toto}%\\n                                              \\\\cellcolor{\\\\Titi}\\\\xintifForLast{}{&}%\\\\Titi\\n                                                                                  }\\\\\\\\\\n                                              \\\\hline\\n                                              \\\\xintFor* ##2 in{\\\\xintSeq{1}{\\\\the\\\\remainder}}\\\\do{%\\n                                              \\\\itemtomacro\\\\ListePerm[\\\\fpeval{\\\\useKV[PixelArt]{CoupeTableau}*\\\\the\\\\intquotient+##2}]\\\\PfMPermute%\\n                                              \\\\itemtomacro\\\\ListeSolPX[\\\\PfMPermute]\\\\Toto%\\n                                              \\\\Toto\\\\xintifForLast{}{&}%\\\\Toto\\n                                                                      }\\\\\\\\\\n                                              \\\\hline\\n                                            \\\\end{tabular}\\n                                            \\\\fi\\n                                          \\\\end{center}\\n                                        }{%\\n                                          \\\\begin{center}\\n                                            \\\\begin{tabular}{|*{\\\\ListeSolPXlen}{>{\\\\centering\\\\arraybackslash}m{\\\\PfMLargeurTableauPixelArt}|}}\\n                                              \\\\hline%\\n                                              \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeSolPXlen}}\\\\do{%\\n                                              \\\\itemtomacro\\\\ListePerm[##1]\\\\PfMPermute%\\n                                              \\\\itemtomacro\\\\ListeCouleursPX[\\\\PfMPermute]\\\\Toto%\\n                                              \\\\xdef\\\\Titi{\\\\Toto}%\\n                                              \\\\cellcolor{\\\\Titi}\\\\xintifForLast{}{&}\\n                                                                                  }\\\\\\\\\\n                                              \\\\hline\\n                                              \\\\xintFor* ##1 in{\\\\xintSeq{1}{\\\\ListeSolPXlen}}\\\\do{%\\n                                              \\\\itemtomacro\\\\ListePerm[##1]\\\\PfMPermute%\\n                                              \\\\itemtomacro\\\\ListeSolPX[\\\\PfMPermute]\\\\Toto%\\n                                              \\\\Toto\\\\xintifForLast{}{&}\\n                                                                      }\\\\\\\\\\n                                              \\\\hline\\n                                            \\\\end{tabular}\\n                                          \\\\end{center}%\\n                                        }\\n                                        \\\\begin{center}\\n                                          \\\\PfMPixelArt[#2]{\\\\useKV[PixelArt]{Fichier}}%\\n                                        \\\\end{center}\\n                                      \\\\else\\n                                        Le nombre de couleurs et le nombre de lettres ne correspondent pas.\\n                                      \\\\fi\\n                                    \\\\else\\n                                      \\\\ifnum\\\\fpeval{\\\\ListeSolPXlen}<\\\\fpeval{\\\\PfMNbLettres}\\\\relax\\n                                        Il manque des lments de solutions.\\n                                      \\\\else\\n                                        Il y a trop d'lments de solutions.\\n                                      \\\\fi\\n                                    \\\\fi\\n                                  }%\\n                                }{}%\\n                              }%\\n                            }%\\n                          }%\\n                        }%\\n                      }%\\n                    }%\\n                  }%\\n                }%\\n              }%\\n            }%\\n          }%\\n        }%\\n      }%\\n    }%\\n  }%\\n}%\\n}%\\n}{}%\\n\\\\makeatother\\n%D'aprs JCC\\n% Package pour grer les nombres pseudo-alatoires\\n\\\\makeatletter\\n\\\\input{random}\\n\\n% Pour toutes les macros de liste, le premier paramtre est le nom de\\n% la macro reprsentant la liste.\\n\\n% macro pour tester si une liste est vide\\n\\\\def\\\\empty@list{}\\n\\n% Macro pour dfinir une nouvelle liste\\n\\\\newcommand\\\\PfMdefinelist[2]{\\\\def#1{#2}}\\n\\n% Macro pour ajouter un lment en fin de liste\\n\\\\newcommand\\\\push[2]{%\\n  \\\\ifx\\\\\\\\#2\\\\\\\\%\\n    \\\\PackageError{randomlist}\\n                 {You can't push an empty value.}\\n                 {Arg 2 of \\\\string\\\\pushlist is empty.}%\\n  \\\\else\\n    \\\\ifx#1\\\\empty@list\\n      \\\\def#1{#2}%\\n    \\\\else\\n      \\\\edef#1{#1,#2}%\\n    \\\\fi\\n  \\\\fi\\n}\\n\\n% Macro pour retirer le premier lment d'une liste\\n\\\\newcommand\\\\pop[2]{%\\n  \\\\getwidth{#1}{\\\\RL@temp}%\\n  \\\\ifnum\\\\RL@temp = 0\\n    % cas de la liste vide\\n    \\\\PackageError{randomlist}\\n                 {You can't pop an empty list.}\\n                 {There is no value to pull in list #1.}%\\n  \\\\else\\\\ifnum\\\\RL@temp = 1\\n    % cas de la liste avec un seul lment\\n    \\\\edef#2{#1}%\\n    \\\\def#1{}%\\n  \\\\else\\n    % cas de la liste avec au moins deux lments\\n    \\\\expandafter\\\\@@poplist#1,\\\\@nil#1#2%\\n  \\\\fi\\\\fi\\n}\\n\\\\def\\\\@@poplist#1,#2,\\\\@nil#3#4{%\\n  \\\\def#4{#1}%\\n  \\\\def#3{#2}%\\n}\\n\\n% Macro comptant le nombre d'lment d'une liste.\\n\\\\newcount\\\\RL@cnta\\n\\\\newcommand\\\\getwidth[2]{%\\n  \\\\RL@cnta \\\\z@\\n  \\\\unless\\\\ifx#1\\\\empty@list\\n    \\\\expandafter\\\\@countlist#1,\\\\@nil,%\\n  \\\\fi\\n  \\\\edef#2{\\\\the\\\\RL@cnta}%\\n}\\n\\\\def\\\\@countlist#1,{%\\n  \\\\def\\\\RL@arg{#1}%\\n  \\\\unless\\\\ifx\\\\RL@arg\\\\@nnil\\n    \\\\advance\\\\RL@cnta \\\\@ne\\n    \\\\expandafter\\\\@countlist\\n  \\\\fi\\n}\\n\\n% Macro d'extraction de la nieme valeur\\n\\\\newcommand\\\\extract[3]{%\\n  % #1 = liste\\n  % #2 = indice\\n  % #3 = macro de retour de la nieme valeur\\n  % On vrifie si la longueur de la liste est suffisante\\n  \\\\getwidth{#1}{\\\\RL@temp}%\\n  \\\\ifnum#2>\\\\RL@temp\\n    \\\\PackageError{randomlist}\\n                 {Value number #2 doesn't exist in list #1}\\n                 {List #1 has only \\\\RL@temp\\\\ values}%\\n  \\\\else\\n    \\\\RL@cnta #2\\n    % On initialise une liste temporaire qui se remplira avec les\\n    % lments non extraits\\n    \\\\def\\\\RL@temp{}%\\n    % Lancement de la lecture rcursive de la liste\\n    \\\\expandafter\\\\RL@extract#1,\\\\@nil,%\\n    % On met la valeur extraite dans la macro prvue\\n    \\\\edef#3{\\\\RL@return}%cp a remplac edef par xdef\\n    % La liste est celle sans l'lment extrait\\n    \\\\let#1\\\\RL@temp\\n  \\\\fi\\n}\\n\\\\def\\\\RL@extract#1,{%\\n  % Dans cette tape, on ne peut pas atteindre la fin de la liste, il\\n  % faut juste reprer l'lment  extraire\\n  \\\\advance\\\\RL@cnta \\\\m@ne\\n  \\\\ifnum\\\\RL@cnta = 0\\n    % L'lment est atteint, on le sauvegarde\\n    \\\\def\\\\RL@return{#1}%\\n    % et on appelle la macro rcursive de fin de lecture.\\n    \\\\expandafter\\\\RL@@extract\\n  \\\\else\\n    % L'lment n'est pas atteint, on augmente la liste temporaire\\n    % on protge d'ventuelles virgule avec des accolades\\n    \\\\edef\\\\RL@temp{\\\\RL@temp,{#1}}%\\n    % et on ralise l'appel rcursif\\n    \\\\expandafter\\\\RL@extract\\n  \\\\fi\\n}\\n\\\\def\\\\RL@@extract#1,{%\\n  % L'lment a t extrait, on lit le reste de la liste pour mettre \\n  % jour la liste temporaire\\n  \\\\def\\\\RL@arg{#1}%\\n  \\\\ifx\\\\RL@arg\\\\@nnil\\n    % Si la liste est vide, on place une virgule\\n    \\\\ifx\\\\RL@temp\\\\empty\\n      \\\\def\\\\RL@temp{,}%\\n    \\\\fi\\n    % La fin de la liste est atteinte, il faut supprimer la virgule\\n    % initiale de la liste temporaire\\n    \\\\expandafter\\\\RL@@@extract\\\\RL@temp\\\\@nil\\n  \\\\else\\n    % On n'a pas atteint la fin de liste, on augmente la liste\\n    % temporaire avec l'lment lu et on ralise l'appel rcursif\\n    % l'lment ajout est protg avec des accolades au cas o il\\n    % contiendrait des virgules.\\n    \\\\edef\\\\RL@temp{\\\\RL@temp,{#1}}%\\n    \\\\expandafter\\\\RL@@extract\\n  \\\\fi\\n}\\n\\\\def\\\\RL@@@extract,#1\\\\@nil{\\\\def\\\\RL@temp{#1}}\\n\\n% Extraction de l'lment <n> de la liste. Le choix de <n> tant\\n% alatoire\\n\\\\newcount\\\\RL@cntb\\n\\\\newcommand\\\\randomextract[2]{%\\n  % Le choix alatoire se fait dans l'intervalle [1,max de la liste]\\n  % donc on commence par rcuprer l'indice maximum de la liste.\\n  \\\\getwidth{#1}{\\\\RL@temp}%\\n  % Nombre alatoire dans le compteur \\\\RL@cntb\\n  \\\\setrannum{\\\\RL@cntb}{1}{\\\\RL@temp}%\\n  % Appel de la macro d'extraction\\n  \\\\extract{#1}{\\\\the\\\\RL@cntb}{#2}%\\n}\\n%\\n% Initialisation du germe en gardant la mme valeur toutes les #2\\n% compilations. Lors de la premire compilation, c'est #1 qui sera le\\n% germe (si valeur vide, on laisse faire random)\\n\\\\newcommand\\\\initrandomlist[2][]{%\\n  \\\\ifdefined\\\\randomlistseed\\n    % Si le germe existe, c'est qu'il a t dclar dans le\\n    % fichier .aux avec le compteur de compilation. Le germe et le\\n    % compteur de compilation existent et sont  jour.\\n  \\\\else\\n    % Si le fichier aux n'a pas dclar de compteur \\\\randomlistseed\\n    % on considre qu'on est  la premire compilation donc qu'on\\n    % compile avec un nouveau germe et un compteur de compilation \\n    % un. Dans ce cas particulier, on laisse random.tex choisir le\\n    % germe.\\n    \\\\newcount\\\\randomlistseed\\n    \\\\ifx\\\\\\\\#1\\\\\\\\\\n      % si l'argument optionnel est vide, on laisse faire random\\n      \\\\nextrandom\\n      \\\\randomlistseed \\\\randomi\\n    \\\\else\\n      % sinon, on prend cet argument comme germe initial\\n      \\\\randomlistseed #1\\n    \\\\fi\\n    \\\\newcount\\\\randomlistcompile\\n    \\\\randomlistcompile \\\\@ne\\n  \\\\fi\\n  % Utilisation du germe adquat pour la compilation en cours.\\n  \\\\randomi\\\\randomlistseed\\n  % Prparation de la compilation suivante (dans le fichier .aux)\\n  % On regarde si le nombre de compilations est gale   zro modulo #2 \\n  \\\\ifnum\\\\numexpr(\\\\randomlistcompile/#2)*#2-\\\\randomlistcompile=0\\n    % Si le nombre de compilations avec le mme germe est atteint\\n    % on changera le germe  la prochaine compilation.\\n    \\\\immediate\\\\write\\\\@mainaux{%\\n      \\\\string\\\\newcount\\\\string\\\\randomlistseed\\n    }%\\n    % modification du germe (sans laisser faire random sinon cela ne\\n    % change pas au cours de chaque minute)\\n    \\\\ifnum\\\\randomlistseed>2147483646\\n      \\\\randomlistseed \\\\z@\\n    \\\\else\\n      \\\\advance\\\\randomlistseed \\\\@ne\\n    \\\\fi\\n    \\\\immediate\\\\write\\\\@mainaux{%\\n      \\\\string\\\\global\\\\string\\\\randomlistseed=\\\\the\\\\randomlistseed\\n    }%\\n  \\\\else\\n    % Il faut faire encore des compilations avec le mme germe, on\\n    % sauvegarde le germe et le compteur de compilation dans le\\n    % fichier .aux.\\n    \\\\immediate\\\\write\\\\@mainaux{%\\n      \\\\string\\\\newcount\\\\string\\\\randomlistseed\\n    }%\\n    \\\\immediate\\\\write\\\\@mainaux{%\\n      \\\\string\\\\global\\\\string\\\\randomlistseed=\\\\the\\\\randomlistseed\\n    }%\\n  \\\\fi\\n  % Dans tous les cas, on augmente le compteur de compilation\\n    \\\\immediate\\\\write\\\\@mainaux{%\\n      \\\\string\\\\newcount\\\\string\\\\randomlistcompile\\n    }%\\n    \\\\advance\\\\randomlistcompile \\\\@ne\\n    \\\\immediate\\\\write\\\\@mainaux{%\\n      \\\\string\\\\global\\\\string\\\\randomlistcompile=\\\\the\\\\randomlistcompile\\n    }%\\n}\\n\\\\makeatother\\n\\\\newcommand\\\\initEnsemblede{%\\n  \\\\PfMdefinelist{\\\\EnsembleDe}{%\\n    {2,4,6,8,10,12},%\\n    {1,3,5,7,9,11},%\\n    {2,3,5,7,11,13},%\\n  }\\n}\\n\\n\\\\newcommand\\\\GetValeurDe[1]{%\\n  \\\\extract{\\\\EnsembleDe}{#1}{\\\\DeChoisi}%\\n  \\\\randomextract{\\\\DeChoisi}{\\\\NbDeChoisi}%\\n}\\n\\n\\\\def\\\\PfMListeNombresPremiers{2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97}\\n  \\n\\n\\\\newcommand\\\\initpremiers{%\\n  \\\\PfMdefinelist{\\\\listpremiers}{13,17,19,23,29,31,37,41,43,47}%\\n}\\n\\n\\\\newcommand\\\\initPremiers{%\\n  \\\\PfMdefinelist{\\\\listPremiers}{71,73,79,83,89,97,101,103,107,109,113,127,131,137,139}%\\n}\\n\\n\\\\newcommand\\\\getpremier{%\\n  \\\\randomextract{\\\\listpremiers}{\\\\NbPremier}\\n}%\\n\\n\\\\newcommand\\\\getPremier{%\\n  \\\\randomextract{\\\\listPremiers}{\\\\NBPremier}\\n}%\\n\\n\\\\newcommand\\\\getpytha{%\\n  \\\\randomextract{\\\\tripletspythaentier}{\\\\triplet}%\\n  \\\\extract{\\\\triplet}{3}{\\\\grand}% le troisime et le plus grand\\n  \\\\randomextract{\\\\triplet}{\\\\cote}%\\n  \\\\randomextract{\\\\triplet}{\\\\autre}%\\n}\\n\\n\\\\newcommand\\\\initalpha{%\\n  \\\\PfMdefinelist{\\\\alphas}{b,c,d,e,f}\\n}\\n\\\\newcommand\\\\getalpha{%\\n  \\\\randomextract{\\\\alphas}{\\\\alphaA}%\\n}%\\n\\n\\\\newcommand\\\\initsommet{%\\n  \\\\PfMdefinelist{\\\\sommets}{A,B,C,D,E,F,G,H,I,J,K,L,M,% pas d'espace ?\\n                        N,O,P,Q,R,S,T,U,V,W,X,Y,Z}%\\n}\\n\\n\\\\newcommand\\\\initsommetrep{%\\n  \\\\PfMdefinelist{\\\\sommets}{A,B,C,D,E,F,G,H,I,J,K,L,M,% pas d'espace ?\\n                        N,P,Q,R,S,T,U,V,W,X,Y,Z}%\\n}\\n\\n\\\\newcommand\\\\gettri{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n}\\n\\n\\\\newcommand\\\\getquad{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n}\\n\\n\\\\newcommand\\\\getpenta{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n  \\\\randomextract{\\\\sommets}{\\\\pE}%\\n}\\n\\n\\\\newcommand\\\\gethexa{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n  \\\\randomextract{\\\\sommets}{\\\\pE}%\\n  \\\\randomextract{\\\\sommets}{\\\\pF}%\\n}\\n\\n\\\\newcommand\\\\gethepta{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n  \\\\randomextract{\\\\sommets}{\\\\pE}%\\n  \\\\randomextract{\\\\sommets}{\\\\pF}%\\n  \\\\randomextract{\\\\sommets}{\\\\pG}%\\n}\\n\\n\\\\newcommand\\\\getocto{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n  \\\\randomextract{\\\\sommets}{\\\\pE}%\\n  \\\\randomextract{\\\\sommets}{\\\\pF}%\\n  \\\\randomextract{\\\\sommets}{\\\\pG}%\\n  \\\\randomextract{\\\\sommets}{\\\\pH}%\\n}\\n\\n\\\\newcommand\\\\getnonna{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n  \\\\randomextract{\\\\sommets}{\\\\pE}%\\n  \\\\randomextract{\\\\sommets}{\\\\pF}%\\n  \\\\randomextract{\\\\sommets}{\\\\pG}%\\n  \\\\randomextract{\\\\sommets}{\\\\pH}%\\n  \\\\randomextract{\\\\sommets}{\\\\pI}%\\n}\\n\\n\\\\newcommand\\\\gettreize{%\\n  \\\\randomextract{\\\\sommets}{\\\\pA}%\\n  \\\\randomextract{\\\\sommets}{\\\\pB}%\\n  \\\\randomextract{\\\\sommets}{\\\\pC}%\\n  \\\\randomextract{\\\\sommets}{\\\\pD}%\\n  \\\\randomextract{\\\\sommets}{\\\\pE}%\\n  \\\\randomextract{\\\\sommets}{\\\\pF}%\\n  \\\\randomextract{\\\\sommets}{\\\\pG}%\\n  \\\\randomextract{\\\\sommets}{\\\\pH}%\\n  \\\\randomextract{\\\\sommets}{\\\\pI}%\\n  \\\\randomextract{\\\\sommets}{\\\\pJ}%\\n  \\\\randomextract{\\\\sommets}{\\\\pK}%\\n  \\\\randomextract{\\\\sommets}{\\\\pL}%\\n  \\\\randomextract{\\\\sommets}{\\\\pM}%\\n}\\n\\n\\\\PfMdefinelist{\\\\quadruplets}{%\\n{2{,}8,9{,}6,6,8},%10\\n{3{,}2,12{,}6,5,12},%13\\n{6{,}6,11{,}2,5,12},%13\\n{7{,}8,10{,}4,5,12},%13\\n{3{,}2,12{,}6,6{,}6,11{,}2},%13\\n{3{,}2,12{,}6,7{,}8,10{,}4},%13\\n{6{,}6,11{,}2,7{,}8,10{,}4},%13\\n{7{,}8,10{,}4,6{,}6,11{,}2},%13\\n{4{,}2,14{,}4,9,12},%15\\n{2{,}6,16{,}8,7{,}2,15{,}4},%17\\n{8,15,10{,}2,13{,}6},%17\\n{2{,}6,16{,}8,8,15},%17\\n{2{,}6,16{,}8,10{,}2,13{,}6},%17\\n{5{,}6,19{,}2,12,16},%20\\n{12,16,5{,}6,19{,}2},%20\\n{7,24,8{,}8,23{,}4},%25\\n{7,24,15,20},%25\\n{8{,}8,23{,}4,15,20},%25\\n{6{,}4,25{,}2,10,24},%26\\n{6{,}4,25{,}2,13{,}2,22{,}4},%26\\n{10,24,13{,}2,22{,}4},%26\\n{10,24,15{,}6,20{,}8},%26\\n{13{,}2,22{,}4,15{,}6,20{,}8},%26\\n{9,40,16{,}8,37{,}4},%41\\n{24{,}6,32{,}8,26{,}6,31{,}2},%41\\n{9,40,26{,}6,31{,}2},%41\\n{24{,}6,32{,}8,16{,}8,37{,}4}%41\\n}%\\n\\n\\\\PfMdefinelist{\\\\Quadruplets}{%pour un fonctionnement avec \\\\fpeval\\n{2.8,9.6,6,8},%10\\n{3.2,12.6,5,12},%13\\n{6.6,11.2,5,12},%13\\n{7.8,10.4,5,12},%13\\n{3.2,12.6,6.6,11.2},%13\\n{3.2,12.6,7.8,10.4},%13\\n{6.6,11.2,7.8,10.4},%13\\n{7.8,10.4,6.6,11.2},%13\\n{4.2,14.4,9,12},%15\\n{2.6,16.8,7.2,15.4},%17\\n{8,15,10.2,13.6},%17\\n{2.6,16.8,8,15},%17\\n{2.6,16.8,10.2,13.6},%17\\n{5.6,19.2,12,16},%20\\n{12,16,5.6,19.2},%20\\n{7,24,8.8,23.4},%25\\n{7,24,15,20},%25\\n{8.8,23.4,15,20},%25\\n{6.4,25.2,10,24},%26\\n{6.4,25.2,13.2,22.4},%26\\n{10,24,13.2,22.4},%26\\n{10,24,15.6,20.8},%26\\n{13.2,22.4,15.6,20.8},%26\\n{9,40,16.8,37.4},%41\\n{24.6,32.8,26.6,31.2},%41\\n{9,40,26.6,31.2},%41\\n{24.6,32.8,16.8,37.4}%41\\n}%\\n\\n\\\\PfMdefinelist{\\\\tripletspytha}{{2{,}8,9{,}6,10},{6,8,10},%10\\n{3{,}2,12{,}6,13},{5,12,13},%13\\n{6{,}6,11{,}2,13},{7{,}8,10{,}4,13},%13\\n{4{,}2,14{,}4,15},{9,12,15},%15\\n{2{,}6,16{,}8,17},{7{,}2,15{,}4,17},%17\\n{8,15,17},{10{,}2,13{,}6,17},%17\\n{5{,}6,19{,}2,20},{12,16,20},%20\\n{7,24,25},{8{,}8,23{,}4,25},%25\\n{15,20,25},%25\\n{8{,}8,23{,}4,25},%25\\n{6{,}4,25{,}2,26},{10,24,26},%26\\n{13{,}2,22{,}4,26},%26\\n{15{,}6,20{,}8,26},%26\\n{9,40,41},{16{,}8,37{,}4,41},%41\\n{24{,}6,32{,}8,41},{26{,}6,31{,}2,41}%41\\n}%\\n\\n\\\\PfMdefinelist{\\\\tripletspythaentier}{%\\n{3,4,5},{5,12,13},{6,8,10},{7,24,25},{8,15,17},{9,12,15},{9,40,41},{10,24,26},{11,60,61},{12,16,20},{12,35,37},{13,84,85},{14,48,50},{15,20,25},{15,36,39},{16,30,34},{16,63,65},{18,24,30},{18,80,82},{20,21,29},{20,48,52},{21,28,35},{21,72,75},{24,32,40},{24,45,51},{24,70,74},{25,60,65},{27,36,45},{28,45,53},{28,96,100},{30,40,50},{30,72,78},{32,60,68},{33,44,55},{33,56,65},{35,84,91},{36,48,60},{36,77,85},{39,52,65},{39,80,89},{40,42,58},{40,75,85},{42,56,70},{45,60,75},{48,55,73},{48,64,80},{51,68,85},{54,72,90},{57,76,95},{60,63,87},{60,80,100},{65,72,97}}%%d'aprs villement.gerard.free.fr\\n\\n\\n\\\\newcommand\\\\initcarre{%\\n  \\\\PfMdefinelist{\\\\carres}{4,9,16,25,36,49,64,81,100}%\\n}\\n\\\\newcommand\\\\getcarre{%\\n  \\\\randomextract{\\\\carres}{\\\\carreA}\\n}\\n\\n%2009-2018\\n  % Source https://ec.europa.eu/eurostat/databrowser/view/ENV_AIR_GGE__custom_743354/default/table?lang=en\\n\\\\PfMdefinelist{\\\\GazSerreEu}{%\\n  {{la },Belgique,131038.46,123642.9},%\\n  {{la },Bulgarie,58617.88,58595.07},%\\n  {{le },Danemark,65734.85,51299.75},%\\n  {{l'},Allemagne,934202.04,888718.56},%\\n  {{l'},Irlande,63985.03,64241.55},%\\n  {{la },Grce,127381.2,96113.19},%\\n  {{l'},Espagne,385211.04,352208.55},%\\n  {{la },France,521519.73,462798.66},%\\n  {{l'},Italie,510950.49,439263.95},%\\n  {{les },{Pays Bas},212360.67,200458.52},%\\n  {{la },Pologne,395464.33,415858.2},%\\n  {{la },Norvge,54280.59,53769.04},%\\n  {{la },Suisse,57276.22,52099.15}%\\n}\\n\\n\\\\newcommand\\\\getGazSerre{%\\n  \\\\randomextract{\\\\GazSerreEu}{\\\\GazSerrePays}%\\n  \\\\extract{\\\\GazSerrePays}{1}{\\\\ArticlePaysGS}%\\n  \\\\extract{\\\\GazSerrePays}{1}{\\\\NomPaysGS}%\\n  \\\\extract{\\\\GazSerrePays}{1}{\\\\ConsoAPaysGS}%\\n  \\\\extract{\\\\GazSerrePays}{1}{\\\\ConsoBPaysGS}%\\n}\\n\\n  \\\\PfMdefinelist{\\\\VehiculesINSEE}{%\\n    {2012,13132,22264,8111,15242},%\\n    {2013,12853,22712,8028,15020},%\\n    {2014,12778,23134,8049,14905},%\\n    {2015,12874,23460,8144,14813},%\\n    {2016,13144,23634,8308,14813},%\\n    {2017,13580,23645,8437,14629},%\\n    {2018,14140,23293,8652,14453},%\\n    {2019,14756,22636,8920,14392}%\\n  }%\\n  \\\\newcommand\\\\getVehiculesINSEE{%\\n    \\\\randomextract{\\\\VehiculesINSEE}{\\\\NbVehiculesINSEE}%\\n    \\\\extract{\\\\NbVehiculesINSEE}{1}{\\\\AnneeVehiculesINSEE}%\\n    \\\\extract{\\\\NbVehiculesINSEE}{1}{\\\\EssenceVehiculesINSEE}%\\n    \\\\extract{\\\\NbVehiculesINSEE}{1}{\\\\DieselVehiculesINSEE}%\\n    \\\\extract{\\\\NbVehiculesINSEE}{1}{\\\\KmEssenceVehiculesINSEE}%\\n    \\\\extract{\\\\NbVehiculesINSEE}{1}{\\\\KmDieselVehiculesINSEE}%\\n  }\\n\\n  % On met Christ7  la fin :)\\n  \\\\newcommand{\\\\vecteur}[1]{\\\\overrightarrow{\\\\strut #1}}\\n  \\n  \\\\newlength{\\\\ltxt}\\n  \\n  \\\\newcommand\\\\compo[4]{%\\n    \\\\setlength{\\\\ltxt}{\\\\linewidth}\\n    \\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2.#1}}\\n    \\\\addtolength{\\\\ltxt}{-\\\\wd#1}\\n    \\\\addtolength{\\\\ltxt}{-10pt}\\n    \\\\begin{minipage}{\\\\wd#1}\\n      \\\\includegraphics[scale=#3]{#2.#1}\\n    \\\\end{minipage}\\n    \\\\hfill\\n    \\\\begin{minipage}{\\\\ltxt}\\n      #4\\n    \\\\end{minipage}\\n  }%\\n\\n\\\\newlength{\\\\lntxt}\\n\\\\newcommand{\\\\Compo}[4]{\\n\\\\setlength{\\\\lntxt}{\\\\linewidth}\\n\\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2}}\\n\\\\addtolength{\\\\lntxt}{-\\\\wd#1}\\n\\\\addtolength{\\\\lntxt}{-10pt}\\n\\\\begin{minipage}{\\\\wd#1}\\n\\\\includegraphics[scale=#3]{#2}\\n\\\\end{minipage}\\n\\\\hfill\\n\\\\begin{minipage}{\\\\lntxt}\\n#4\\n\\\\end{minipage}\\n}\\n\\n\\\\newcommand{\\\\Compog}[4]{\\n\\\\setlength{\\\\lntxt}{\\\\linewidth}\\n\\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2}}\\n\\\\addtolength{\\\\lntxt}{-\\\\wd#1}\\n\\\\addtolength{\\\\lntxt}{-10pt}\\n\\\\begin{minipage}{\\\\lntxt}\\n#4\\n\\\\end{minipage}\\n\\\\hfill\\n\\\\begin{minipage}{\\\\wd#1}\\n\\\\includegraphics[scale=#3]{#2}\\n\\\\end{minipage}\\n}\\n\\n\\\\newlength{\\\\ecart}\\n\\\\setlength{\\\\ecart}{-20pt}\\n\\n\\\\newcommand{\\\\compog}[4]{%\\n\\\\setlength{\\\\ltxt}{\\\\linewidth}\\n\\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2.#1}}\\n\\\\addtolength{\\\\ltxt}{-\\\\wd#1}\\n\\\\addtolength{\\\\ltxt}{\\\\ecart}\\n\\\\begin{minipage}{\\\\ltxt}\\n#4\\n\\\\end{minipage}\\n\\\\hfill\\n\\\\begin{minipage}{\\\\wd#1}\\n\\\\includegraphics[scale=#3]{#2.#1}\\n\\\\end{minipage}\\n}\\n\\n\\\\newlength{\\\\appui}\\n\\\\setlength{\\\\appui}{20pt}\\n\\n\\\\newlength{\\\\lnttxt}\\n\\\\newcommand\\\\dispo[3]{%\\n\\\\setlength{\\\\lnttxt}{\\\\linewidth}\\n\\\\setbox#1=\\\\hbox{#2}\\n\\\\addtolength{\\\\lnttxt}{-\\\\wd#1}\\n\\\\addtolength{\\\\lnttxt}{-\\\\appui}\\n\\\\begin{minipage}{\\\\wd#1}\\n#2\\n\\\\end{minipage}\\n\\\\hfill\\n\\\\begin{minipage}{\\\\lnttxt}\\n#3\\n\\\\end{minipage}\\n}\\n\\n\\\\newcommand\\\\dispog[3]{%\\n\\\\setlength{\\\\lnttxt}{\\\\linewidth}%\\n\\\\setbox#1=\\\\hbox{#2}%\\n\\\\addtolength{\\\\lnttxt}{-\\\\wd#1}%\\n\\\\addtolength{\\\\lnttxt}{-\\\\appui}%\\n\\\\begin{minipage}{\\\\lnttxt}%\\n#3\\n\\\\end{minipage}%\\n\\\\hfill%\\n\\\\begin{minipage}{\\\\wd#1}%\\n#2\\n\\\\end{minipage}%\\n}%\\n\\n\\\\newcommand\\\\compoxe[4][1]{%\\n  \\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2.pdf}}%\\n  \\\\setlength{\\\\lnttxt}{\\\\linewidth-\\\\wd#1-\\\\appui}%\\n  \\\\begin{minipage}{\\\\wd#1}%\\n    \\\\usebox#1%\\n  \\\\end{minipage}%\\n  \\\\hfill%\\n  \\\\begin{minipage}{\\\\lnttxt}%\\n    #4%\\n  \\\\end{minipage}%\\n}%\\n\\n\\\\newcommand\\\\compogxe[4][1]{%\\n  \\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2.pdf}}%\\n  \\\\setlength{\\\\lnttxt}{\\\\linewidth-\\\\wd#1-\\\\appui}%\\n  \\\\begin{minipage}{\\\\lnttxt}%\\n    #4\\n  \\\\end{minipage}%\\n  \\\\hfill%\\n  \\\\begin{minipage}{\\\\wd#1}%\\n    \\\\usebox#1\\n  \\\\end{minipage}%\\n}%\\n\\n\\\\newcommand{\\\\compogb}[4]{%\\n\\\\setlength{\\\\ltxt}{\\\\linewidth}\\n\\\\BaremeEspaceMarge{-20pt-82pt-\\\\wd#1}\\n\\\\setbox#1=\\\\hbox{\\\\includegraphics[scale=#3]{#2.#1}}\\n\\\\addtolength{\\\\ltxt}{-\\\\wd#1}\\n\\\\addtolength{\\\\ltxt}{-20pt}\\n\\\\begin{minipage}{\\\\ltxt}\\n#4\\n\\\\end{minipage}\\n\\\\hfill\\n\\\\begin{minipage}{\\\\wd#1}\\n\\\\includegraphics[scale=#3]{#2.#1}\\n\\\\end{minipage}\\n\\\\BaremeEspaceMarge{-82pt}\\n}\\n\\n\\\\newcommand{\\\\dispogb}[3]{\\n\\\\setlength{\\\\ltxt}{\\\\linewidth}\\n\\\\BaremeEspaceMarge{-20pt-82pt-\\\\wd#1}\\n\\\\setbox#1=\\\\hbox{#2}\\n\\\\addtolength{\\\\ltxt}{-\\\\wd#1}\\n\\\\addtolength{\\\\ltxt}{-\\\\appui}\\n\\\\begin{minipage}{\\\\ltxt}\\n#3\\n\\\\end{minipage}\\n\\\\hfill\\n\\\\begin{minipage}{\\\\wd#1}\\n#2\\n\\\\end{minipage}\\n\\\\BaremeEspaceMarge{-82pt}\\n}\\n\\n%\\\\AddToHook{env/multicols/begin}{\\\\setcounter{Nbcolonnes}{2}}%\\n%\\\\AddToHook{env/multicols/after}{\\\\setcounter{Nbcolonnes}{4}}%\\n\\n\\\\NewDocumentCommand\\\\Cicontre{s}{%\\n  \\\\ifPfMDeuxColonnes\\n    \\\\IfBooleanTF{#1}{ci-dessous}{ci-dessus}%\\n  \\\\else\\n    ci-contre%\\n  \\\\fi\\n}%\\n\\n\\\\NewDocumentEnvironment{Dispo}{sm+b}{%\\n  \\\\ifPfMDeuxColonnes\\n    \\\\IfBooleanTF{#1}{%\\n      #3\\n      \\\\begin{center}\\n        #2\\n      \\\\end{center}\\n    }{%\\n      \\\\begin{center}\\n        #2\\n      \\\\end{center}\\n      #3\\n    }%\\n  \\\\else%\\n    \\\\IfBooleanTF{#1}{%\\n      \\\\dispog{1}{#2}{#3}\\n    }{%\\n      \\\\dispo{1}{#2}{#3}\\n    }%\\n  \\\\fi%\\n}{}%\\n\\n\\\\NewDocumentEnvironment{CALign}{O{&=\\\\dots&}O{&=\\\\dots}mb}{%\\n  % #1 sparateur gnraliste\\n  % #2 sparateur dernire colonne\\n  % #3 nombre de colonnes souhaites\\n  % #4 environnement\\n  \\\\xdef\\\\Foo{#4}%\\n  \\\\setsepchar{}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeTest{\\\\Foo}%\\n  \\\\reademptyitems%\\n  \\\\quotient{\\\\ListeTestlen}{#3}%\\n  \\\\modulo{\\\\ListeTestlen}{#3}%\\n  \\\\begin{align*}\\n    \\\\ifnum\\\\intquotient>0\\\\relax\\n    \\\\xintFor* ##9 in{\\\\xintSeq{0}{\\\\fpeval{\\\\the\\\\intquotient-1}}}\\\\do{%\\n    \\\\xintFor* ##8 in{\\\\xintSeq{1}{#3}}\\\\do{\\n    \\\\ListeTest[\\\\fpeval{##9*#3+##8}]\\\\xintifForLast{#2}{#1}\\n    }\\\\ifnum##9<\\\\fpeval{\\\\the\\\\intquotient-1}\\\\relax\\\\\\\\\\\\fi\\n    }\\n    \\\\fi\\n    \\\\ifnum\\\\remainder>0\\\\relax\\n    \\\\ifnum\\\\intquotient>0\\\\relax\\\\\\\\\\\\fi\\n    \\\\xintFor* ##8 in{\\\\xintSeq{1}{\\\\the\\\\remainder}}\\\\do{\\n    \\\\ListeTest[\\\\fpeval{\\\\the\\\\intquotient*#3+##8}]\\\\xintifForLast{#2}{#1}\\n    }\\n    \\\\fi\\n  \\\\end{align*}\\n}{}%\\n\\n\\\\NewDocumentEnvironment{CALignAv}{O{A&=}mb}{%\\n  % #1 sparateur gnraliste\\n  % #2 nombre de colonnes souhaites\\n  % #3 environnement\\n  \\\\xdef\\\\Foo{#3}%\\n  \\\\setsepchar{}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListeTest{\\\\Foo}%\\n  \\\\reademptyitems%\\n  \\\\quotient{\\\\ListeTestlen}{#2}%\\n  \\\\modulo{\\\\ListeTestlen}{#2}%\\n  \\\\begin{align*}\\n    \\\\ifnum\\\\intquotient>0\\\\relax\\n    \\\\xintFor* ##9 in{\\\\xintSeq{0}{\\\\fpeval{\\\\the\\\\intquotient-1}}}\\\\do{%\\n    \\\\xintFor* ##8 in{\\\\xintSeq{1}{#2}}\\\\do{%\\n    #1\\\\ListeTest[\\\\fpeval{##9*#2+##8}]\\\\ifnum##8<#2\\\\relax\\\\uppercase{&}\\\\fi\\n                                                        }\\\\ifnum##9<\\\\fpeval{\\\\the\\\\intquotient-1}\\\\relax{}\\\\\\\\\\\\fi\\n    }%\\n    \\\\fi%\\n    \\\\ifnum\\\\remainder>0\\\\relax%\\n    \\\\ifnum\\\\intquotient>0\\\\relax\\\\\\\\\\\\fi\\n    \\\\xintFor* ##8 in{\\\\xintSeq{1}{\\\\the\\\\remainder}}\\\\do{%\\n    #1\\\\ListeTest[\\\\fpeval{\\\\the\\\\intquotient*#2+##8}]\\\\ifnum##8<\\\\remainder\\\\relax\\\\uppercase{&}\\\\fi\\n                                                                                 }%\\n    \\\\fi%\\n  \\\\end{align*}\\n}{}%\\n\\n\\\\def\\\\RetiensEchelle{1cm}\\n\\\\def\\\\ChoixNbQuestions{5}\\n\\n\\\\NewDocumentCommand\\\\QuestionBoulotold{}{%\\n  \\\\ifboolKV[Boulot]{CAN}{\\\\setKV[ClesExercices]{NbQuestions=1}}{%\\n    \\\\ifboolKV[Boulot]{AMC}{\\\\setKV[ClesExercices]{NbQuestions=1}}{%\\n      \\\\setKV[ClesExercices]{NbQuestions=\\\\ChoixNbQuestions}%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\QuestionBoulot{O{\\\\ChoixNbQuestions}}{%\\n  \\\\ifboolKV[Boulot]{CAN}{%\\n    \\\\setKV[ClesExercices]{NbQuestions=1}%\\n  }{%\\n    \\\\setKV[ClesExercices]{NbQuestions=#1}%\\n  }%\\n}%\\n\\\\makeatletter\\n\\\\if@CAN\\n  \\\\AddToHook{env/document/before}{%\\n    \\\\ProvidesPackage{ProfMaquette}[Mode CAN (CP)]%\\n    \\\\RequirePackage{pgfmorepages}\\n    \\\\pgfmorepagesloadextralayouts\\n    \\\\pgfpagesuselayout{4 on 2, book format}[a4paper,landscape]\\n  }\\n\\\\fi\\n\\n\\\\if@Revision\\n  \\\\AddToHook{env/document/before}{%\\n    \\\\ProvidesPackage{ProfMaquette}[Mode Revision (CP)]%\\n    \\\\setcounter{Nbcolonnes}{2}%\\n    \\\\def\\\\RetiensEchelle{0.5cm}\\n    \\\\RequirePackage{pgfmorepages}\\n    \\\\pgfmorepagesloadextralayouts\\n    \\\\pgfpagesuselayout{4 on 2, book format}[a4paper]\\n  }\\n\\\\fi\\n\\n\\\\if@Personnel\\n  \\\\input{PfMPerso.cfg}\\n\\\\fi\\n\\\\makeatother\\n\\n\\\\IfClassLoadedTF{beamer}{}{%\\n  % enumitem obligatoire ^^\\n% mais pas compatible beamer\\n\\\\RequirePackage{enumitem}\\n% d'aprs https://tex.stackexchange.com/questions/164613/adding-code-at-the-end-of-each-list-item\\n\\\\newif\\\\iffirstlegal\\\\firstlegalfalse% We need a toggle to track whether the item is first in the list or not\\n\\n\\\\newlist{Test}{enumerate}{3}\\n\\n\\\\def\\\\PfMPar{\\\\par}\\n\\n\\\\NewDocumentCommand\\\\litem{}{}\\n\\n\\\\let\\\\olditem\\\\item% save the standard definition of \\\\item in a macro, \\\\olditem\\n\\n\\\\setlist[Test,1]{%\\n  leftmargin=*,\\n  label=\\\\arabic*.,\\n  before={%\\n    \\\\setcounter{PfMProfondeur}{1}%\\n    \\\\setcounter{PfMNbLignesFinitem}{0}\\n    \\\\firstlegaltrue% set the toggle for first item in the list to true\\n    \\\\def\\\\Primeitem{\\\\iffirstlegal\\\\olditem\\\\stepcounter{PfMNbLignesFinitem}%\\n        \\\\firstlegalfalse\\n      \\\\else\\n        \\\\ifnum\\\\PfMListeDesAjoutsdeLignes[\\\\thePfMNbLignesFinitem]>1\\\\relax\\\\PfMPar\\\\Lignespointilles{\\\\PfMListeDesAjoutsdeLignes[\\\\thePfMNbLignesFinitem]}\\\\else\\\\ifnum\\\\PfMListeDesAjoutsdeLignes[\\\\thePfMNbLignesFinitem]=1\\\\relax\\\\PfMPar\\\\pointilles\\\\fi\\\\fi%\\n        \\\\olditem\\\\stepcounter{PfMNbLignesFinitem}%\\n      \\\\fi\\n    }% new, temporary defition of \\\\item\\n    \\\\let\\\\litem\\\\Primeitem\\n    \\\\let\\\\item\\\\litem\\n  },\\n  after={%\\n    \\\\ifnum\\\\PfMListeDesAjoutsdeLignes[\\\\thePfMNbLignesFinitem]>0\\\\relax\\\\PfMPar\\\\Lignespointilles{\\\\PfMListeDesAjoutsdeLignes[\\\\thePfMNbLignesFinitem]}\\\\else\\\\ifnum\\\\PfMListeDesAjoutsdeLignes[\\\\thePfMNbLignesFinitem]=1\\\\relax\\\\PfMPar\\\\pointilles\\\\fi\\\\fi%\\n    % fill for final item in list\\n    \\\\let\\\\litem\\\\olditem% restore standard definition of \\\\item\\n    \\\\let\\\\item\\\\olditem\\n    \\\\setcounter{PfMProfondeur}{0}%\\n  }%\\n}%\\n\\n\\\\setlist[Test,2]{%\\n  leftmargin=*,\\n  label=(\\\\alph*),\\n  before={%\\n    \\\\setcounter{PfMProfondeur}{2}%\\n    \\\\setcounter{PfMNbLignesFinitemi}{0}\\n    \\\\firstlegaltrue%\\n    \\\\def\\\\Seconditem{\\\\iffirstlegal\\\\olditem\\\\stepcounter{PfMNbLignesFinitemi}\\\\firstlegalfalse\\\\else%\\n        \\\\ifnum\\\\PfMListeDesAjoutsdeLignesi[\\\\thePfMNbLignesFinitemi]>1\\\\relax\\\\PfMPar\\\\Lignespointilles{\\\\PfMListeDesAjoutsdeLignesi[\\\\thePfMNbLignesFinitemi]}\\\\else\\\\ifnum\\\\PfMListeDesAjoutsdeLignesi[\\\\thePfMNbLignesFinitemi]=1\\\\relax\\\\PfMPar\\\\pointilles\\\\fi\\n      \\\\fi%\\n        \\\\olditem\\\\stepcounter{PfMNbLignesFinitemi}\\n      \\\\fi\\n    }% new, temporary defition of \\\\item\\n    \\\\let\\\\litem\\\\Seconditem\\n    \\\\let\\\\item\\\\litem\\n  },\\n  after={%\\n    \\\\ifnum\\\\PfMListeDesAjoutsdeLignesi[\\\\thePfMNbLignesFinitemi]>1\\\\relax\\\\PfMPar\\\\Lignespointilles{\\\\PfMListeDesAjoutsdeLignesi[\\\\thePfMNbLignesFinitemi]}\\\\else\\\\ifnum\\\\PfMListeDesAjoutsdeLignesi[\\\\thePfMNbLignesFinitemi]=1\\\\relax\\\\PfMPar\\\\pointilles\\\\fi\\n    \\\\fi%\\n%    % fill for final item in list\\n    \\\\let\\\\litem\\\\Primeitem%\\n    \\\\let\\\\item\\\\litem\\n    \\\\setcounter{PfMProfondeur}{1}%\\n  }%\\n}\\n\\n\\\\newcounter{PfMNbLignesFinitem}\\n\\\\newcounter{PfMNbLignesFinitemi}\\n\\\\newcounter{PfMProfondeur}\\n\\\\setcounter{PfMProfondeur}{0}%\\n\\n\\\\NewDocumentEnvironment{autoenumerate}{O{}m +b}{%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\ifnum\\\\thePfMProfondeur=0\\\\relax%\\n    \\\\readlist*\\\\PfMListeDesAjoutsdeLignes{#2}%\\n  \\\\else%\\n    \\\\readlist*\\\\PfMListeDesAjoutsdeLignesi{#2}%\\n  \\\\fi%\\n  \\\\begin{Test}[#1]%\\n    #3\\n  \\\\end{Test}%\\n}{}%\\n}%\\n\\n%%%\\n% PixelArt\\n%%%\\n\\\\newtoks\\\\toklistePfMPANombre%\\n\\\\newtoks\\\\tokPfMPXNomCouleur%\\n\\\\def\\\\UpdatetoksPfMPANombre#1\\\\nil{\\\\addtotok\\\\toklistePfMPANombre{\\\"#1\\\",}}%\\n\\\\def\\\\UpdatetoksPfMPXNomCouleur#1\\\\nil{\\\\addtotok\\\\tokPfMPXNomCouleur{\\\"#1\\\",}}%\\n\\n\\\\setKVdefault[PfMPixelArt]{Largeur=29,Hauteur=29,Solution=false,Lettres=ABCDEFGHIJK,Nombres=false,ListeCouleurs={},Unite=5mm,Geant=false,HauteurD=1,LargeurD=1,Complet=false,Numero=1,Separations=false,Deforme=false,Coefx=0.25,Coefy=0.25,Borne=false,Graines=false}%\\n\\\\defKV[PfMPixelArt]{ListeNombres=\\\\setKV[PfMPixelArt]{Nombres}}%\\n\\\\defKV[PfMPixelArt]{Graine=\\\\setKV[PfMPixelArt]{Graines}}%\\n\\n%\\\"mario1.txt\\\"\\n\\n\\\\NewDocumentCommand\\\\PfMPixelArt{o m}{%\\n  \\\\toklistePfMPANombre{}%\\n  \\\\tokPfMPXNomCouleur{}%\\n  \\\\useKVdefault[PfMPixelArt]%\\n  \\\\setKV[PfMPixelArt]{#1}%\\n%  \\\\expandafter\\\\UpdatetoksPfMPXNomFichier\\\\useKV[PixelArt]{Fichier}\\\\nil%\\n%  Le tok fichier est \\\\the\\\\tokPfMPXNomFichier\\n  \\\\xdef\\\\ListeAvantCouleurs{\\\\useKV[PfMPixelArt]{ListeCouleurs}}%\\n  \\\\setsepchar{,}\\\\ignoreemptyitems%\\n  \\\\readlist*\\\\ListePACouleur{\\\\ListeAvantCouleurs}%\\n  \\\\reademptyitems%\\n  \\\\foreachitem\\\\compteur\\\\in\\\\ListePACouleur{\\\\expandafter\\\\UpdatetoksPfMPXNomCouleur\\\\compteur\\\\nil}%\\n  \\\\ifboolKV[PfMPixelArt]{Nombres}{%\\n    \\\\xdef\\\\ListeAvantNombres{\\\\useKV[PfMPixelArt]{ListeNombres}}%\\n    \\\\setsepchar{,}%\\n    \\\\readlist*\\\\ListePANombre{\\\\ListeAvantNombres}%\\n    \\\\foreachitem\\\\compteur\\\\in\\\\ListePANombre{\\\\expandafter\\\\UpdatetoksPfMPANombre\\\\compteur\\\\nil}%\\n  }{}\\n  \\\\ifboolKV[PfMPixelArt]{Geant}{%\\n    % Dcoupe en hauteur : \\\\fpeval{\\\\useKV[PfMPixelArt]{Hauteur}/\\\\useKV[PfMPixelArt]{HauteurD}}\\\\\\\\\\n    % Dcoupe en largeur : \\\\fpeval{\\\\useKV[PfMPixelArt]{Largeur}/\\\\useKV[PfMPixelArt]{LargeurD}-1}}\\\\par\\n    \\\\ifboolKV[PfMPixelArt]{Complet}{%\\n      \\\\xintFor* ##1 in{\\\\xintSeq{0}{\\\\fpeval{\\\\useKV[PfMPixelArt]{Hauteur}/\\\\useKV[PfMPixelArt]{HauteurD}-1}}}\\\\do{%\\n        \\\\xintFor* ##2 in{\\\\xintSeq{0}{\\\\fpeval{\\\\useKV[PfMPixelArt]{Largeur}/\\\\useKV[PfMPixelArt]{LargeurD}-1}}}\\\\do{%\\n          \\\\fpeval{##1*\\\\useKV[PfMPixelArt]{Hauteur}/\\\\useKV[PfMPixelArt]{HauteurD}+##2} : \\\\PfMBuildPixelArtGeant{#2}{\\\\useKV[PfMPixelArt]{Lettres}}{\\\\ListeAvantCouleurs}{\\\\the\\\\toklistePfMPANombre}{##1}{##2}\\\\\\\\%\\n        }%\\n      }%\\n    }{%\\n%      \\\\quotient{\\\\fpeval{\\\\useKV[PfMPixelArt]{Numero}-1}}{\\\\fpeval{\\\\useKV[PfMPixelArt]{Hauteur}/\\\\useKV[PfMPixelArt]{HauteurD}}}%\\n%      \\\\modulo{\\\\fpeval{\\\\useKV[PfMPixelArt]{Numero}-1}}{\\\\fpeval{\\\\useKV[PfMPixelArt]{Hauteur}/\\\\useKV[PfMPixelArt]{HauteurD}}}%\\n      \\\\quotient{\\\\fpeval{\\\\useKV[PfMPixelArt]{Numero}-1}}{\\\\fpeval{\\\\useKV[PfMPixelArt]{Largeur}/\\\\useKV[PfMPixelArt]{LargeurD}}}%\\n      \\\\modulo{\\\\fpeval{\\\\useKV[PfMPixelArt]{Numero}-1}}{\\\\fpeval{\\\\useKV[PfMPixelArt]{Largeur}/\\\\useKV[PfMPixelArt]{LargeurD}}}%\\n%      quotient = \\\\the\\\\intquotient -- remainder = \\\\the\\\\remainder :\\\\\\\\\\n      \\\\PfMBuildPixelArtGeant{#2}{\\\\useKV[PfMPixelArt]{Lettres}}{\\\\ListeAvantCouleurs}{\\\\the\\\\toklistePfMPANombre}{\\\\the\\\\intquotient}{\\\\the\\\\remainder}%\\n    }%\\n  }{%\\n    \\\\ifboolKV[PfMPixelArt]{Deforme}{%\\n        \\\\PfMBuildPixelArtDeforme{#2}{\\\\useKV[PfMPixelArt]{Lettres}}{\\\\ListeAvantCouleurs}{\\\\the\\\\toklistePfMPANombre}%\\n      }{%\\n        % \\\\PfMBuildPixelArt{#2}{\\\\useKV[PfMPixelArt]{Lettres}}{\\\\ListeAvantCouleurs}{\\\\the\\\\toklistePfMPANombre}%\\n        \\\\PfMBuildPixelArt{#2}{\\\\useKV[PfMPixelArt]{Lettres}}{\\\\the\\\\tokPfMPXNomCouleur}{\\\\the\\\\toklistePfMPANombre}%%\\n    }%\\n  }%\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMBuildPixelArt{m m m m}{%\\n  \\\\ifluatex\\n  \\\\mplibforcehmode\\n  \\\\begin{mplibcode}\\n%    largeur:=\\\\useKV[PfMPixelArt]{Largeur};\\n%    hauteur:=\\\\useKV[PfMPixelArt]{Hauteur};\\n    largeurd:=\\\\useKV[PfMPixelArt]{LargeurD};\\n    hauteurd:=\\\\useKV[PfMPixelArt]{HauteurD};\\n    Unite:=\\\\useKV[PfMPixelArt]{Unite};\\n\\n    boolean Solution,Nombres,Separations,RotationPixel;\\n    Solution:=\\\\useKV[PfMPixelArt]{Solution};\\n    Nombres:=\\\\useKV[PfMPixelArt]{Nombres};\\n    Separations:=\\\\useKV[PfMPixelArt]{Separations};\\n    RotationPixel:=\\\\useKV[PixelArt]{Landscape};\\n    \\n    string BaseLettres;\\n    BaseLettres=str #2;\\n    numeric EchelleScale;\\n    EchelleScale=Unite/5mm;\\n    \\n    color ColorEntier[],ColFond;\\n    n:=0;\\n    for p_=#3:\\n      n:=n+1;\\n      index:=0;\\n      for k=0 upto (length p_-1):\\n      if substring(k,k+1) of p_=\\\"!\\\":\\n      index:=k;\\n      fi;\\n    endfor;\\n    if index>0:  \\n    color base;\\n    base=scantokens(substring(0,index) of p_);\\n    atte:=scantokens(substring(index+1,length p_) of p_);\\n    ColorEntier[n]:=(atte/100)[white,base];\\n    else:\\n    ColorEntier[n]:=scantokens(p_);\\n    fi;\\n%    ColorEntier[n]:=black;\\n    endfor;\\n\\n    string RetiensNombres[];\\n    if Nombres:\\n    k:=0;\\n    for p_=#4:\\n    k:=k+1;\\n    RetiensNombres[k]=p_;\\n    endfor;\\n    else:\\n    m:=0;\\n    for p_=0 upto n-1:\\n    m:=m+1;\\n    RetiensNombres[m]=substring(p_,p_+1) of BaseLettres;\\n    endfor;\\n    fi;\\n\\n    picture Etiquette[];\\n    for k=1 upto n:\\n    Etiquette[k]=image(\\n    label(TEX(RetiensNombres[k]) scaled EchelleScale,(0,0));\\n    );\\n    endfor;\\n\\n    vardef Largeur(expr nomfichier)=\\n      string p_;\\n      p_=readfrom nomfichier;\\n      largeur=(length p_+1) div 2;\\n      closefrom nomfichier;\\n    enddef;\\n\\n    vardef Hauteur(expr nomfichier)=\\n      string p_;\\n      hauteur=0;\\n      p_=readfrom nomfichier;\\n      forever: exitif p_=EOF;\\n        hauteur:=hauteur+1;\\n        p_:=readfrom nomfichier;\\n      endfor;\\n      closefrom nomfichier;\\n    enddef;\\n    \\n    vardef Lecturecsv(expr nomfichier)=\\n    for h=hauteur downto 1:\\n      string p_;\\n      p_=readfrom nomfichier;\\n      l:=0;\\n      for p=0 step 2 until 2*largeur-2:\\n        l:=l+1;\\n        if Solution=false:\\n          if (substring(p,p+1) of p_)=\\\"-\\\":\\n          else:\\n            for m=0 upto (length BaseLettres-1):\\n              if (substring(p,p+1) of p_)=substring(m,m+1) of BaseLettres:\\n              draw Etiquette[m+1] shifted((l-1)*Unite,(h-1)*Unite);\\n              fi;\\n            endfor;\\n          fi;\\n        fi;\\n        if Solution:\\n          if (substring(p,p+1) of p_)=\\\"-\\\":\\n          else:\\n            for m=0 upto (length BaseLettres-1):\\n              if (substring(p,p+1) of p_)=substring(m,m+1) of BaseLettres:\\n                ColFond:=ColorEntier[m+1];\\n              fi;\\n            endfor;\\n            if unknown ColFond:\\n            else:\\n              fill (unitsquare scaled Unite) shifted ((l-1)*Unite-0.5*Unite,(h-1)*Unite-0.5*Unite) withcolor ColFond\\n            fi;\\n          fi;\\n        fi;\\n        trace (unitsquare scaled Unite) shifted ((l-1)*Unite-0.5*Unite,(h-1)*Unite-0.5*Unite);  \\n      endfor;\\n    endfor;\\n    closefrom nomfichier;\\n    enddef;\\n\\n    Largeur(#1);\\n    Hauteur(#1);\\n%    label.top(TEX(\\\"Largeur = \\\"&decimal(largeur)),(0,-1cm));\\n%    label.bot(TEX(\\\"Hauteur = \\\"&decimal(hauteur)),(0,-1cm));\\n    Lecturecsv(#1);\\n    if Separations:\\n    drawoptions(withcolor Purple);\\n    for k=hauteur step -hauteurd until 0:\\n    draw (Unite*(-1,k-0.5)--Unite*(largeur,k-0.5)) withpen pencircle scaled 1.25;\\n    endfor;\\n    for k=0 step largeurd until largeur:\\n    draw (Unite*(k-0.5,hauteur+0.125)--Unite*(k-0.5,-0.875)) withpen pencircle scaled 1.25;\\n    endfor;\\n    drawoptions();\\n    fi;\\n    if RotationPixel:\\n    picture Retiens;\\n    Retiens:=currentpicture;\\n    currentpicture:=nullpicture;\\n    draw Retiens rotatedabout(center Retiens,90);\\n    fi;\\n  \\\\end{mplibcode}\\n  \\\\fi\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMBuildPixelArtDeforme{m m m m}{%\\n  \\\\ifluatex\\n  \\\\mplibforcehmode\\n  \\\\begin{mplibcode}\\n    largeur:=\\\\useKV[PfMPixelArt]{Largeur};\\n    hauteur:=\\\\useKV[PfMPixelArt]{Hauteur};\\n    largeurd:=\\\\useKV[PfMPixelArt]{LargeurD};\\n    hauteurd:=\\\\useKV[PfMPixelArt]{HauteurD};\\n    Unite:=\\\\useKV[PfMPixelArt]{Unite};\\n\\n    %Deformation\\n    Coefx=\\\\useKV[PfMPixelArt]{Coefx};\\n    Coefy=\\\\useKV[PfMPixelArt]{Coefy};\\n    boolean Borne,Graines;\\n    Borne=\\\\useKV[PfMPixelArt]{Borne};\\n    Graines=\\\\useKV[PfMPixelArt]{Graines};\\n    if Graines:\\n    randomseed:=\\\\useKV[PfMPixelArt]{Graine};\\n    fi;\\n    %\\n    pair M[][];\\n    for l=1 upto hauteur+1:\\n      for c=1 upto largeur+1:\\n      if Borne:\\n      if (l=1) or (l=hauteur+1):\\n      M[l][c]=Unite*(c,l)+Unite*(-Coefx+uniformdeviate(2*Coefx),0);\\n      if (c=1) or (c=largeur+1):\\n      M[l][c]:=Unite*(c,l);\\n      fi;\\n      else:\\n      if (c=1) or (c=largeur+1):\\n      M[l][c]=Unite*(c,l-1)+Unite*(0,uniformdeviate(Coefy));\\n      else:\\n      M[l][c]=Unite*(c,l)+Unite*(-Coefx+uniformdeviate(2*Coefx),-Coefy+uniformdeviate(2*Coefy));\\n      fi;\\n      fi;\\n      else:\\n      M[l][c]=Unite*(c,l)+Unite*(-Coefx+uniformdeviate(2*Coefx),-Coefy+uniformdeviate(2*Coefy));\\n      fi;\\n      %dotlabel(\\\"\\\",M[l][c]);\\n      endfor;\\n    endfor;\\n    \\n    boolean Solution,Nombres,Separations;\\n    Solution:=\\\\useKV[PfMPixelArt]{Solution};\\n    Nombres:=\\\\useKV[PfMPixelArt]{Nombres};\\n    Separations:=\\\\useKV[PfMPixelArt]{Separations};\\n    \\n    string BaseLettres;\\n    BaseLettres=str #2;\\n    numeric EchelleScale;\\n    EchelleScale=Unite/10mm;\\n    \\n    color ColorEntier[],ColFond;\\n    n:=0;\\n    for p_=#3:\\n    n:=n+1;\\n    ColorEntier[n]:=p_;\\n    endfor;\\n\\n    string RetiensNombres[];\\n    if Nombres:\\n    n:=0;\\n    for p_=#4:\\n    n:=n+1;\\n    RetiensNombres[n]=p_;\\n    endfor;\\n    fi;\\n        \\n    vardef Lecturecsv(expr nomfichier)=\\n    for h=hauteur downto 1:\\n    string p_;\\n    p_=readfrom nomfichier;\\n    l:=0;\\n    for p=0 step 2 until 2*largeur-2:\\n    l:=l+1;\\n    if (substring(p,p+1) of p_)=\\\"-\\\":\\n    else:\\n    if Nombres:\\n    for m=0 upto (length BaseLettres-1):\\n    if (substring(p,p+1) of p_)=substring(m,m+1) of BaseLettres:\\n    label(TEX(RetiensNombres[m+1]) scaled EchelleScale,iso(M[h+1][l],M[h][l],M[h][l+1],M[h+1][l+1]));\\n    fi;\\n    endfor;\\n    else:\\n    label(TEX(substring(p,p+1) of p_) scaled EchelleScale,iso(M[h+1][l],M[h][l],M[h][l+1],M[h+1][l+1]));\\n    fi;\\n    if Solution:\\n    for m=0 upto (length BaseLettres-1):\\n    if (substring(p,p+1) of p_)=substring(m,m+1) of BaseLettres:\\n    ColFond:=ColorEntier[m+1];\\n    fi;\\n    endfor;\\n    if unknown ColFond: else: fill polygone(M[h+1][l],M[h][l],M[h][l+1],M[h+1][l+1]) withcolor ColFond fi;\\n    fi;\\n    trace polygone(M[h+1][l],M[h][l],M[h][l+1],M[h+1][l+1]);\\n   fi;\\n    endfor;\\n    endfor;\\n    closefrom nomfichier;\\n    enddef;\\n    \\n    Lecturecsv(\\\"#1\\\");\\n  \\\\end{mplibcode}\\n\\\\fi\\n}%\\n\\n\\\\NewDocumentCommand\\\\PfMBuildPixelArtGeant{m m m m m m}{%\\n  \\\\ifluatex%\\n  \\\\mplibforcehmode%\\n  \\\\begin{mplibcode}%\\n    largeur:=\\\\useKV[PfMPixelArt]{Largeur};\\n    hauteur:=\\\\useKV[PfMPixelArt]{Hauteur};\\n    largeurd:=\\\\useKV[PfMPixelArt]{LargeurD};\\n    hauteurd:=\\\\useKV[PfMPixelArt]{HauteurD};\\n    \\n    Unite:=\\\\useKV[PfMPixelArt]{Unite};\\n\\n    boolean Solution,Nombres;\\n    Solution:=\\\\useKV[PfMPixelArt]{Solution};\\n    Nombres:=\\\\useKV[PfMPixelArt]{Nombres};\\n    \\n    string BaseLettres;\\n    BaseLettres=str #2;\\n\\n    numeric EchelleScale;\\n    EchelleScale=Unite/5mm;\\n    \\n    color ColorEntier[],ColFond;\\n    n:=0;\\n    for p_=#3:\\n    n:=n+1;\\n    ColorEntier[n]:=p_;\\n    endfor;\\n\\n    string RetiensNombres[];\\n    if Nombres:\\n    n:=0;\\n    for p_=#4:\\n    n:=n+1;\\n    RetiensNombres[n]=p_;\\n    endfor;\\n    fi;\\n        \\n    vardef Lecturecsv(expr nomfichier)=\\n    % for h=hauteur-#5*hauteurd downto hauteur-(#5+1)*hauteurd:\\n    for h=hauteur downto 1:\\n    string p_;\\n    p_=readfrom nomfichier;\\n    l:=0;\\n    if (h>hauteur-(#5+1)*hauteurd) and (h<hauteur-#5*hauteurd+1):\\n    for p=2*#6*largeurd step 2 until 2*(#6+1)*largeurd-2:\\n    l:=l+1;\\n    if (substring(p,p+1) of p_)=\\\"-\\\":\\n    else:\\n    if Nombres:\\n    for m=0 upto (length BaseLettres-1):\\n    if (substring(p,p+1) of p_)=substring(m,m+1) of BaseLettres:\\n    label(TEX(RetiensNombres[m+1]) scaled EchelleScale,((l-1)*Unite,(h-1)*Unite));\\n    fi;\\n    endfor;\\n    else:\\n    label(TEX(substring(p,p+1) of p_) scaled EchelleScale,((l-1)*Unite,(h-1)*Unite));\\n    fi;\\n    if Solution:\\n    for m=0 upto (length BaseLettres-1):\\n    if (substring(p,p+1) of p_)=substring(m,m+1) of BaseLettres:\\n    ColFond:=ColorEntier[m+1];\\n    fi;\\n    endfor;\\n    if unknown ColFond: else: fill (unitsquare scaled Unite) shifted ((l-1)*Unite-0.5*Unite,(h-1)*Unite-0.5*Unite) withcolor ColFond fi;\\n    fi;\\n    trace (unitsquare scaled Unite) shifted ((l-1)*Unite-0.5*Unite,(h-1)*Unite-0.5*Unite);\\n   fi;\\n   endfor;\\n   fi;\\n    endfor;\\n    closefrom nomfichier;\\n    enddef;\\n    \\n    Lecturecsv(\\\"#1\\\");\\n  \\\\end{mplibcode}\\n  \\\\fi%\\n}%\"","<script lang=\"ts\">\n  import {\n    buildImagesUrlsList,\n    doesLatexNeedsPics,\n    getExosContentList,\n    getPicsNames,\n    type latexFileType,\n  } from '../../../lib/Latex'\n\n  import ProfMaquette from '../../../lib/latex/ProfMaquette.sty?raw'\n  import type TypeExercice from '../../../exercices/Exercice'\n\n  export let disabled: boolean\n  export let exercices: TypeExercice[]\n  export let latexFile: latexFileType\n\n  let textForOverleafInput: HTMLInputElement\n  let textForProfMaquette: string = ''\n  let imagesUrls = [] as string[]\n\n  /**\n   * Construction du matriel ncessaire au tlversement vers Overleaf :\n   * -- constitution des URLs pour le tlchargement des images (elles doivent pointer vers un serveur)\n   * -- encodage du contenu du code LaTeX de la feuille d'exercices\n   */\n  async function copyDocumentToOverleaf() {\n    const picsWanted = doesLatexNeedsPics(latexFile.contents)\n    const exosContentList = getExosContentList(exercices)\n    const picsNames = getPicsNames(exosContentList)\n    imagesUrls = picsWanted\n      ? buildImagesUrlsList(exosContentList, picsNames)\n      : []\n    textForProfMaquette = latexFile.latexWithPreamble.includes('ProfMaquette')\n      ? 'data:text/plain;base64,' +\n        btoa(unescape(encodeURIComponent(ProfMaquette)))\n      : ''\n    textForOverleafInput.value =\n      'data:text/plain;base64,' +\n      btoa(unescape(encodeURIComponent(latexFile.latexWithPreamble)))\n  }\n</script>\n\n<!--\n  @component\n  Bouton dclenchant l'exportation vers OverLeaf\n\n  ### Paramtres\n\n  * `latex` : code latex du document\n  * `latexFileInfos` : objet contenant les lments de mise en forme du fichier\n  * `disabled` : flag permettant de dsactiver le bouton\n\n  ### Exemple\n  ```tsx\n  <ButtonOverleaf\n    {latex}\n    latexFileInfos={{ title, reference, subtitle, style, nbVersions }}\n    disabled={false}\n  />\n  ```\n -->\n\n<form\n  class=\"{`${$$props.class || 'flex flex-col md:flex-row mx-4 pb-4 md:pb-8 md:space-x-4 space-y-3 justify-center md:justify-start items-center'}`}\"\n  method=\"POST\"\n  action=\"https://www.overleaf.com/docs\"\n  target=\"_blank\"\n>\n  {#each imagesUrls as imageUrl}\n    <input\n      type=\"hidden\"\n      name=\"snip_uri[]\"\n      value=\"{imageUrl}\"\n      autocomplete=\"off\"\n    />\n    <input\n      type=\"hidden\"\n      name=\"snip_name[]\"\n      value=\"{imageUrl.split('/')[imageUrl.split('/').length - 1]}\"\n      autocomplete=\"off\"\n    />\n  {/each}\n  {#if textForProfMaquette.length > 0}\n    <input\n      type=\"hidden\"\n      name=\"snip_uri[]\"\n      value=\"{textForProfMaquette}\"\n      autocomplete=\"off\"\n    />\n    <input\n      type=\"hidden\"\n      name=\"snip_name[]\"\n      value=\"ProfMaquette.sty\"\n      autocomplete=\"off\"\n    />\n  {/if}\n  <input\n    type=\"hidden\"\n    name=\"snip_uri[]\"\n    bind:this=\"{textForOverleafInput}\"\n    autocomplete=\"off\"\n  />\n  <input\n    type=\"hidden\"\n    name=\"snip_name[]\"\n    value=\"coopmath.tex\"\n    autocomplete=\"off\"\n  />\n  <input type=\"hidden\" name=\"engine\" value=\"lualatex\" autocomplete=\"off\" />\n  <button\n    id=\"btn_overleaf\"\n    type=\"submit\"\n    {disabled}\n    on:click=\"{copyDocumentToOverleaf}\"\n    class=\"{disabled\n      ? 'px-2 py-1 rounded-md text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action-lightest  dark:bg-coopmathsdark-action-lightest '\n      : 'px-2 py-1 rounded-md text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest'}\"\n  >\n    Aller sur Overleaf\n  </button>\n</form>\n","<script lang=\"ts\">\n  export let title = 'Mon titre'\n  export let icon = 'bxs-file-pdf'\n</script>\n\n<div\n  class=\"{$$props.class || 'mr-4'} block rounded-lg bg-coopmaths-canvas-dark shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),0_10px_20px_-2px_rgba(0,0,0,0.04)] dark:bg-coopmathsdark-canvas-dark\"\n>\n  {#if icon.length !== 0}\n    <div class=\"flex justify-center items-center p-4\">\n      <i\n        class=\"bx {icon} text-[100px] text-coopmaths-warn dark:text-coopmathsdark-warn\"\n      ></i>\n    </div>\n  {/if}\n  <div class=\"py-6 px-6 md:px-16\">\n    <h5\n      class=\"mb-2 text-3xl font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n    >\n      {title}\n    </h5>\n    <p\n      class=\"flex flex-col space-y-2 w-full mb-4 text-base font-light text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n    >\n      <slot>\n        Un texte devrait s'afficher ici. Celui-ci est le texte par dfaut.\n      </slot>\n    </p>\n\n    <div class=\"flex flex-col justify-center items-center space-y-2\">\n      {#if $$slots.button1}\n        <slot name=\"button1\">\n          <button\n            type=\"button\"\n            class=\"inline-block rounded bg-primary px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal text-white shadow-[0_4px_9px_-4px_#3b71ca] transition duration-150 ease-in-out hover:bg-primary-600 hover:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:bg-primary-600 focus:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:outline-none focus:ring-0 active:bg-primary-700 active:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] dark:shadow-[0_4px_9px_-4px_rgba(59,113,202,0.5)] dark:hover:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)] dark:focus:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)] dark:active:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]\"\n          >\n            Go somewhere\n          </button>\n        </slot>\n      {/if}\n      {#if $$slots.button2}\n        <slot name=\"button2\">\n          <button\n            type=\"button\"\n            class=\"inline-block rounded bg-primary px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal text-white shadow-[0_4px_9px_-4px_#3b71ca] transition duration-150 ease-in-out hover:bg-primary-600 hover:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:bg-primary-600 focus:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:outline-none focus:ring-0 active:bg-primary-700 active:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] dark:shadow-[0_4px_9px_-4px_rgba(59,113,202,0.5)] dark:hover:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)] dark:focus:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)] dark:active:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]\"\n          >\n            Go somewhere\n          </button>\n        </slot>\n      {/if}\n    </div>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import Latex, { type LatexFileInfos } from '../../../lib/Latex'\n\n  export let latexFileInfos: LatexFileInfos\n  export let latex: Latex\n\n  let selectedExos: number[] =  Array.from({ length: latex.exercices.length }, (_, i) => i); // exos slectionns pour appliquer config globale\n  let globalConfig = {\n    labels: '',\n    itemsep: { enabled: false, value: 1 },\n    cols: { enabled: false, value: 1 },\n    cols_corr: { enabled: false, value: 1 },\n    blocrep: { enabled: false, nbligs: 5, nbcols: 1 }\n  }\n\n   function applyGlobalConfig() {\n    latexFileInfos.exos = latexFileInfos.exos || {}\n    for (const idx of selectedExos) {\n      const exoConfig: any = {\n      }\n\n      if (globalConfig.labels !== ''  && globalConfig.labels !== undefined) {\n        exoConfig.labels = globalConfig.labels\n      }\n\n      if (globalConfig.itemsep.enabled) {\n        exoConfig.itemsep = globalConfig.itemsep.value\n      }\n\n      if (globalConfig.cols?.enabled) {\n        exoConfig.cols = globalConfig.cols.value\n      }\n\n      if (globalConfig.cols_corr?.enabled) {\n        exoConfig.cols_corr = globalConfig.cols_corr.value\n      }\n\n      if (globalConfig.blocrep?.enabled) {\n        exoConfig.blocrep = {\n          nbligs: globalConfig.blocrep.nbligs,\n          nbcols: globalConfig.blocrep.nbcols\n        }\n      }\n      latexFileInfos.exos[idx] = {\n        ...latexFileInfos.exos[idx],\n        ...exoConfig\n      }\n    }\n  }\n\n  function cancelAllChanges() {\n    // Rinitialise toutes les configurations des exercices\n    latexFileInfos.exos = {};\n    selectedExos = [];\n    globalConfig = {\n      labels: '',\n      itemsep: { enabled: false, value: 1 },\n      cols: { enabled: false, value: 1 },\n      cols_corr: { enabled: false, value: 1 },\n      blocrep: { enabled: false, nbligs: 5, nbcols: 1 }\n    };\n  }\n</script>\n\n<section class=\"mb-6 border rounded-lg p-4 bg-gray-50 mx-auto\">\n  <h3 class=\"text-lg font-semibold mb-3 text-center\">\n    Configuration globale des exercices\n  </h3>\n  <div class=\"flex flex-col gap-3 items-start\">\n    <!-- Labels -->\n    <div class=\"flex flex-col w-full text-left\">\n      Numrotation des questions\n      <select bind:value={globalConfig.labels} class=\"mt-1 border rounded px-2 py-1 w-40\">\n        <option value=\"\">(aucune)</option>\n        <option value=\"\\alph*)\">a, b, c, ...</option>\n        <option value=\"\\Alph*)\">A, B, C, ...</option>\n        <option value=\"\\roman*)\">i, ii, iii, ...</option>\n        <option value=\"\\Roman*)\">I, II, III, ...</option>\n        <option value=\"\\arabic*)\">1, 2, 3, ...</option>\n      </select>\n    </div>\n\n    <!-- Itemsep -->\n    <div class=\"flex flex-col w-full text-left\">\n      Espace entre les questions\n      <div class=\"flex flex-row items-center gap-2\">\n        <input type=\"checkbox\" bind:checked={globalConfig.itemsep.enabled} class=\"h-4 w-4\" />\n        <input\n          type=\"number\"\n          class=\"mt-1 border rounded px-2 py-1 w-24\"\n          min=\"1\"\n          max=\"50\"\n          class:opacity-50={!globalConfig.itemsep.enabled}\n          class:cursor-not-allowed={!globalConfig.itemsep.enabled}\n          class:pointer-events-none={!globalConfig.itemsep.enabled}\n          bind:value={globalConfig.itemsep.value}\n        />\n      </div>\n    </div>\n\n    <!-- Colonnes -->\n    <div class=\"flex flex-col w-full text-left\">\n      Nombre de colonnes pour l'exercice\n      <div class=\"flex flex-row items-center gap-2\">\n        <input type=\"checkbox\" bind:checked={globalConfig.cols.enabled} class=\"h-4 w-4\" />\n        <input\n          type=\"number\"\n          min=\"1\"\n          max=\"5\"\n          class=\"mt-1 border rounded px-2 py-1 w-24\"\n          class:opacity-50={!globalConfig.cols.enabled}\n          class:cursor-not-allowed={!globalConfig.cols.enabled}\n          class:pointer-events-none={!globalConfig.cols.enabled}\n          bind:value={globalConfig.cols.value}\n        />\n      </div>\n    </div>\n\n    <div class=\"flex flex-col w-full text-left\">\n      Nombre de colonnes pour la correction\n      <div class=\"flex flex-row items-center gap-2\">\n        <input type=\"checkbox\" bind:checked={globalConfig.cols_corr.enabled} class=\"h-4 w-4\" />\n        <input\n          type=\"number\"\n          min=\"1\"\n          max=\"5\"\n          class=\"mt-1 border rounded px-2 py-1 w-24\"\n          class:opacity-50={!globalConfig.cols_corr.enabled}\n          class:cursor-not-allowed={!globalConfig.cols_corr.enabled}\n          class:pointer-events-none={!globalConfig.cols_corr.enabled}\n          bind:value={globalConfig.cols_corr.value}\n        />\n      </div>\n    </div>\n\n    <!-- Bloc rponse -->\n    <fieldset class=\"flex flex-col gap-4 w-full\">\n      <legend class=\"text-left font-medium\">Bloc rponse</legend>\n      <label class=\"flex flex-row items-center gap-2\">\n        <input type=\"checkbox\" bind:checked={globalConfig.blocrep.enabled} class=\"h-4 w-4\" />\n        <span>Activer le bloc rponse</span>\n      </label>\n\n      <div\n        class:opacity-50={!globalConfig.blocrep.enabled}\n        class:cursor-not-allowed={!globalConfig.blocrep.enabled}\n        class:pointer-events-none={!globalConfig.blocrep.enabled}\n      >\n        <label class=\"flex flex-row items-center gap-2 w-full\">\n          <span class=\"w-32 text-left\">Nombre de lignes</span>\n          <input type=\"number\" min=\"1\" bind:value={globalConfig.blocrep.nbligs} class=\"border rounded px-2 py-1 w-20\" />\n        </label>\n\n        <label class=\"flex flex-row items-center gap-2 w-full mt-2\">\n          <span class=\"w-32 text-left\">Nombre de colonnes</span>\n          <input type=\"number\" min=\"1\" bind:value={globalConfig.blocrep.nbcols} class=\"border rounded px-2 py-1 w-20\" />\n        </label>\n      </div>\n    </fieldset>\n\n    <!-- Exercices cibls -->\n    <label class=\"flex flex-col w-full\">\n      Appliquer aux exercices :\n      <select multiple bind:value={selectedExos} class=\"mt-1 border rounded px-2 py-1 h-24 w-full\">\n        {#each latex.getExercices() as exo}\n          <option value={exo.index}>{exo.index + 1} - {exo.titre}</option>\n        {/each}\n      </select>\n    </label>\n  </div>\n\n  <!-- Boutons daction -->\n  <div class=\"pt-4 flex flex-col sm:flex-row sm:flex-wrap gap-3 justify-start\">\n    <button type=\"button\" on:click={applyGlobalConfig} class=\"px-3 py-1 rounded bg-green-600 text-white hover:bg-green-500\">\n      Appliquer\n    </button>\n\n    <button type=\"button\" class=\"px-4 py-2 rounded-lg bg-red-500 text-white hover:bg-red-600\" on:click={cancelAllChanges}>\n      Annuler les changements\n    </button>\n  </div>\n</section>\n","<script lang=\"ts\">\n  import Latex, { type LatexFileInfos } from '../../../lib/Latex'\n\n  export let latexFileInfos: LatexFileInfos\n  export let latex: Latex\n\n</script>\n\n<section class=\"mb-6 border rounded-lg p-4 bg-gray-50 mx-auto\">\n<h3 class=\"text-lg font-semibold mb-3\">Configuration individuelle des exercices</h3>\n    {#each latex.getExercices() as exo}\n      <fieldset style=\"margin-top:1rem; border-radius:0.5rem; padding:0.5rem; border:1px solid #ccc;\">\n        <legend class=\"px-2 text-base font-semibold text-gray-700\">Exercice {exo.index + 1}</legend>\n        <div class=\"mt-2 mb-3 space-y-1\">\n          <div class=\"text-sm text-gray-600\">\n            <span class=\"font-medium text-gray-800\">Titre :</span> {exo.titre}\n          </div>\n          <div class=\"text-sm text-gray-500 truncate\">\n            <span class=\"font-medium text-gray-700\">UUID :</span> {exo.uuid}\n          </div>\n        </div>\n        <label class=\"flex flex-col text-left\">\n          Numration des questions\n          <select class=\"w-40\" value={latexFileInfos.exos?.[exo.index]?.labels} on:change={(e) => {\n            // Cre l'objet exo si inexistant\n            latexFileInfos.exos = latexFileInfos.exos || {}\n            latexFileInfos.exos[exo.index] = latexFileInfos.exos[exo.index] || {}\n            // @ts-ignore\n            const select = e.target.value\n            latexFileInfos.exos[exo.index].labels = select || undefined\n          }}>\n            <option value=\"\">(aucune)</option>\n            <option value=\"\\alph*)\">\\alph* : a, b, c, ...</option>\n            <option value=\"\\Alph*)\">\\Alph* : A, B, C, ...</option>\n            <option value=\"\\roman*)\">\\roman* : i, ii, iii, ...</option>\n            <option value=\"\\Roman*)\">\\Roman* : I, II, III, ...</option>\n            <option value=\"\\arabic*)\">\\arabic* : 1, 2, 3, ...</option>\n          </select>\n        </label>\n        <label class=\"flex flex-col text-left\">\n          Espace entre les questions\n          <input\n            type=\"number\"\n            class=\"mt-1 border rounded px-2 py-1 w-24\"\n            min=\"0\"\n            max=\"50\"\n            on:input={e => {\n              latexFileInfos.exos = latexFileInfos.exos || {};\n              latexFileInfos.exos[exo.index] = latexFileInfos.exos[exo.index] || {};\n              // Rcupre la valeur tape\n              // @ts-ignore\n              let val = e.target.value\n              if (val === ''){\n                delete latexFileInfos.exos[exo.index].itemsep\n              } else {\n                // Force les bornes\n                val = Number(val)\n                if (val < 0) val = 0\n                if (val > 50) val = 50\n                if (latexFileInfos.exos[exo.index] !== undefined) {\n                  latexFileInfos.exos[exo.index].itemsep = val\n                }\n              }\n            }}\n            value={latexFileInfos.exos?.[exo.index]?.itemsep ?? ''}\n          />\n        </label>\n        <label class=\"flex flex-col text-left\">\n          Nombre de colonnes pour l'exercice\n          <input\n            type=\"number\"\n            class=\"mt-1 border rounded px-2 py-1 w-24\"\n            min=\"1\"\n            max=\"5\"\n            on:input={e => {\n              latexFileInfos.exos = latexFileInfos.exos || {};\n              latexFileInfos.exos[exo.index] = latexFileInfos.exos[exo.index] || {};\n              // Rcupre la valeur tape\n              // @ts-ignore\n              let val = e.target.value\n              if (val === ''){\n                delete latexFileInfos.exos[exo.index].cols\n              } else {\n                // Force les bornes\n                val = Number(val)\n                if (val < 1) val = 1\n                if (val > 5) val = 5\n                if (latexFileInfos.exos[exo.index] !== undefined) {\n                  latexFileInfos.exos[exo.index].cols = val\n                }\n              }\n            }}\n            value={latexFileInfos.exos?.[exo.index]?.cols ?? ''}\n          />\n        </label>\n        <label class=\"flex flex-col text-left\">\n          Nombre de colonnes pour la correction\n          <input\n            type=\"number\"\n            class=\"mt-1 border rounded px-2 py-1 w-24\"\n            min=\"1\"\n            max=\"5\"\n            on:input={e => {\n              latexFileInfos.exos = latexFileInfos.exos || {};\n              latexFileInfos.exos[exo.index] = latexFileInfos.exos[exo.index] || {};\n              // Rcupre la valeur tape\n              // @ts-ignore\n              let val = e.target.value\n              if (val === ''){\n                delete latexFileInfos.exos[exo.index].cols_corr\n              } else {\n                val = Number(val)\n                // Force les bornes\n                if (val < 1) val = 1\n                if (val > 5) val = 5\n                if (latexFileInfos.exos[exo.index] !== undefined) {\n                  latexFileInfos.exos[exo.index].cols_corr = val\n                }\n              }\n            }}\n            value={latexFileInfos.exos?.[exo.index]?.cols_corr ?? ''}\n          />\n        </label>\n        <fieldset>\n          <legend class=\"flex flex-col text-left\">Bloc rponse</legend>\n          <label class=\"flex flex-col text-left\">\n            Nombre de lignes\n            <input\n              type=\"number\"\n              class=\"mt-1 border rounded px-2 py-1 w-24\"\n              on:input={e => {\n                latexFileInfos.exos = latexFileInfos.exos || {};\n                latexFileInfos.exos[exo.index] = latexFileInfos.exos[exo.index] || {};\n                latexFileInfos.exos[exo.index].blocrep = latexFileInfos.exos[exo.index].blocrep || { nbligs: 1, nbcols: 1 };  \n\n                // @ts-ignore\n                let val = e.target.value\n                if (val === ''){\n                  delete latexFileInfos.exos[exo.index].blocrep\n                } else {\n                  // Force les bornes\n                  val = Number(val)\n                  if (val < 1) val = 1\n                  if (val > 20) val = 20\n                  if (latexFileInfos.exos[exo.index].blocrep !== undefined) {\n                    // @ts-ignore\n                    latexFileInfos.exos[exo.index].blocrep.nbligs = val\n                  }\n                }\n              }}\n              value={latexFileInfos.exos?.[exo.index]?.blocrep?.nbligs ?? ''}\n            />\n          </label>\n          <label class=\"flex flex-col text-left\">\n            Nombre de colonnes\n            <input type=\"number\"\n            class=\"mt-1 border rounded px-2 py-1 w-24\"\n            on:input={e => {\n                latexFileInfos.exos = latexFileInfos.exos || {};\n                latexFileInfos.exos[exo.index] = latexFileInfos.exos[exo.index] || {};\n                latexFileInfos.exos[exo.index].blocrep = latexFileInfos.exos[exo.index].blocrep || { nbligs: 1, nbcols: 1 };\n                // @ts-ignore\n                let val = e.target.value\n                if (val === ''){\n                  delete latexFileInfos.exos[exo.index].blocrep\n                } else {\n                  // Force les bornes\n                  val = Number(val)\n                  if (val < 1) val = 1\n                  if (val > 20) val = 20\n                  if (latexFileInfos.exos[exo.index].blocrep !== undefined) {\n                    // @ts-ignore\n                    latexFileInfos.exos[exo.index].blocrep.nbcols = val\n                  }\n                }\n              }}\n              value={latexFileInfos.exos?.[exo.index]?.blocrep?.nbcols ?? ''}\n            />\n        </fieldset>\n      </fieldset>\n    {/each}\n\n    <!-- Card JSON -->\n    <div class=\"w-full mt-6 p-4 border rounded-2xl shadow bg-gray-50\">\n      <h2 class=\"text-lg font-bold mb-3\">Aperu JSON</h2>\n      <pre class=\"bg-gray-900 text-green-200 p-3 text-left rounded-lg text-sm overflow-x-auto max-h-80\">{JSON.stringify(latexFileInfos.exos || {}, null, 2)}\n      </pre>\n    </div>\n</section>","<script lang=\"ts\">\n  import Latex, { type LatexFileInfos } from '../../../lib/Latex'\n  import FormConfigGlobal from './FormConfigGlobal.svelte'\n  import FormConfigIndividual from './FormConfigIndividual.svelte'\n\n  export let latex: Latex\n  export let latexFileInfos: LatexFileInfos\n  export let callback: () => void\n\n  /**\n   * Affiche ou ferme si dj ouvert le code Latex dans une boite de dialogue\n   */\n  async function dialogConfigToDisplayToggle() {\n    const dialog = document.getElementById('configLatex') as HTMLDialogElement\n    if (dialog.open) {\n      dialog.close()\n      callback()\n    } else {\n      dialog.showModal()\n    }\n  }\n\n</script>\n\n\n\n<form\n  class=\"{`${$$props.class || 'flex flex-col md:flex-row mx-4 pb-4 md:pb-8 md:space-x-4 space-y-3 justify-center md:justify-start items-center'}`}\"\n  target=\"_blank\"\n>\n  <button\n    id=\"btn_config\"\n    type=\"submit\"\n    on:click|preventDefault=\"{dialogConfigToDisplayToggle}\"\n    class=\"px-2 py-1 rounded-md text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n  >\n    Paramtrer\n  </button>\n</form>\n\n<dialog\n  class=\"fixed rounded-xl p-6 bg-coopmaths-canvas text-coopmaths-corpus left-[2%] top-[2%] w-[96%] h-[96%] dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-corpus-light shadow-lg\"\n  id=\"configLatex\"\n>\n<div class=\"mt-3 text-center\">\n    <div class=\"text-3xl font-medium text-coopmaths-warn-dark\">\n      <span class=\"header\">\n        <div class=\"absolute top-2 right-3\">\n          <button\n            type=\"button\"\n            on:click=\"{() => {\n              dialogConfigToDisplayToggle()\n            }}\"\n          >\n            <i\n              class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest text-xl bx bx-x\"\n            ></i>\n          </button>\n        </div>\n      </span>\n    </div>\n\n    <!-- Config globale -->\n    <FormConfigGlobal\n      bind:latexFileInfos\n      {latex}\n    />\n\n\n    <!-- Config individuelle -->\n    <FormConfigIndividual\n      bind:latexFileInfos\n      {latex}\n    />\n    \n    <!-- Card JSON -->\n    <div class=\"w-full mt-6 p-4 border rounded-2xl shadow bg-gray-50\">\n      <h2 class=\"text-lg font-bold mb-3\">Aperu JSON</h2>\n      <pre class=\"bg-gray-900 text-green-200 p-3 text-left rounded-lg text-sm overflow-x-auto max-h-80\">{JSON.stringify(latexFileInfos.exos || {}, null, 2)}\n      </pre>\n    </div>\n  \n</dialog>\n","<script lang=\"ts\">\n  import type Latex from '../../../lib/Latex'\n  import type { LatexFileInfos } from '../../../lib/Latex'\n  import ButtonConfig from '../../shared/forms/ButtonConfig.svelte'\n  import FormRadio from '../../shared/forms/FormRadio.svelte'\n\n  export let latexFileInfos: LatexFileInfos\n  export let latex: Latex\n  export let promise: Promise<any> | null = null\n\n   const isExerciceStaticInTheList = latex.isExerciceStaticInTheList()\n</script>\n\n<h5\nclass=\"mb-2 text-3xl font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\nMise en page\n</h5>\n<h6\nclass=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\nModle\n</h6>\n<FormRadio\ntitle=\"Style\"\nbgColor=\"bg-coopmaths-canvas-dark\"\norientation=\"{'col'}\"\nbind:valueSelected=\"{latexFileInfos.style}\"\nlabelsValues=\"{[\n    { label: 'Coopmaths', value: 'Coopmaths' },\n    { label: 'Classique', value: 'Classique' },\n    { label: 'ProfMaquette', value: 'ProfMaquette' },\n    {\n    label: 'ProfMaquette avec QrCode',\n    value: 'ProfMaquetteQrcode',\n    },\n    {\n    label: 'Course aux nombres',\n    value: 'Can',\n    isDisabled: isExerciceStaticInTheList,\n    },\n]}\"\n/>\n{#if latexFileInfos.style === 'Coopmaths' || latexFileInfos.style === 'Classique' || latexFileInfos.style === 'ProfMaquetteQrcode'}\n<h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n    Police de caractres\n</h6>\n<FormRadio\n    title=\"fontOption\"\n    bgColor=\"bg-coopmaths-canvas-dark\"\n    orientation=\"{'col'}\"\n    bind:valueSelected=\"{latexFileInfos.fontOption}\"\n    labelsValues=\"{[\n    { label: 'Standard', value: 'StandardFont' },\n    { label: 'Dys', value: 'DysFont' },\n    ]}\"\n/>\n{#if latexFileInfos.fontOption === 'StandardFont'}\n    <span>\n    Taille:\n    <input\n        type=\"number\"\n        id=\"export-latex-taille-input\"\n        class=\"min-w-14 border-1 w-1/5 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n        name=\"tailleFontOption\"\n        maxlength=\"2\"\n        min=\"8\"\n        max=\"20\"\n        bind:value=\"{latexFileInfos.tailleFontOption}\"\n    />\n    </span>\n{/if}\n{#if latexFileInfos.fontOption === 'DysFont'}\n    <span>\n    Taille:\n    <input\n        type=\"number\"\n        id=\"export-latex-dys-taille-input\"\n        class=\"min-w-14 border-1 w-1/5 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n        name=\"dysTailleFontOption\"\n        maxlength=\"2\"\n        min=\"8\"\n        max=\"20\"\n        bind:value=\"{latexFileInfos.dysTailleFontOption}\"\n    />\n    </span>\n{/if}\n{/if}\n{#if latexFileInfos.style === 'Can'}\n<h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n    Options\n</h6>\n<FormRadio\n    title=\"durationCanOption\"\n    bgColor=\"bg-coopmaths-canvas-dark\"\n    orientation=\"{'col'}\"\n    bind:valueSelected=\"{latexFileInfos.correctionOption}\"\n    labelsValues=\"{[\n    { label: 'Avec correction', value: 'AvecCorrection' },\n    { label: 'Sans correction', value: 'SansCorrection' },\n    ]}\"\n/>\n<h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n    Police de caractres\n</h6>\n<FormRadio\n    title=\"fontOption\"\n    bgColor=\"bg-coopmaths-canvas-dark\"\n    orientation=\"{'col'}\"\n    bind:valueSelected=\"{latexFileInfos.fontOption}\"\n    labelsValues=\"{[\n    { label: 'Standard', value: 'StandardFont' },\n    { label: 'Dys', value: 'DysFont' },\n    ]}\"\n/>\n{#if latexFileInfos.fontOption === 'StandardFont'}\n    <span>\n    Taille:\n    <input\n        type=\"number\"\n        id=\"export-latex-taille-input\"\n        class=\"min-w-14 border-1 w-1/5 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n        name=\"tailleFontOption\"\n        maxlength=\"2\"\n        min=\"8\"\n        max=\"20\"\n        bind:value=\"{latexFileInfos.tailleFontOption}\"\n    />\n    </span>\n{/if}\n{#if latexFileInfos.fontOption === 'DysFont'}\n    <span>\n    Taille:\n    <input\n        type=\"number\"\n        id=\"export-latex-dys-taille-input\"\n        class=\"min-w-14 border-1 w-1/5 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n        name=\"dysTailleFontOption\"\n        maxlength=\"2\"\n        min=\"8\"\n        max=\"20\"\n        bind:value=\"{latexFileInfos.dysTailleFontOption}\"\n    />\n    </span>\n{/if}\n<h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n    Dure\n</h6>\n<input\n    type=\"text\"\n    id=\"export-latex-duree-input\"\n    class=\"border-1 w-full disabled:opacity-20 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light placeholder:opacity-40\"\n    placeholder=\"9 min\"\n    bind:value=\"{latexFileInfos.durationCanOption}\"\n/>\n{/if}\n{#if latexFileInfos.style === 'ProfMaquette'}\n<h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n    Options\n</h6>\n<FormRadio\n    title=\"correctionOption\"\n    bgColor=\"bg-coopmaths-canvas-dark\"\n    orientation=\"{'col'}\"\n    bind:valueSelected=\"{latexFileInfos.correctionOption}\"\n    labelsValues=\"{[\n    { label: 'Avec correction', value: 'AvecCorrection' },\n    { label: 'Sans correction', value: 'SansCorrection' },\n    ]}\"\n/>\n<h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n    Format\n</h6>\n<FormRadio\n    title=\"typeFiche\"\n    bgColor=\"bg-coopmaths-canvas-dark\"\n    orientation=\"{'col'}\"\n    bind:valueSelected=\"{latexFileInfos.typeFiche}\"\n    labelsValues=\"{[\n    { label: 'Fiche', value: 'Fiche' },\n    { label: 'valuation', value: 'Eval' },\n    ]}\"\n/>\n<h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n    Configuration\n</h6>\n{#await promise}\n    <p>Chargement en cours...</p>\n{:then}\n    <ButtonConfig\n        class=\"\"\n        {latex}\n        {latexFileInfos}\n        callback={() => {\n        latexFileInfos = { ...latexFileInfos } // force la ractivit\n        }}\n    />    \n{/await}\n<h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n    Exercices\n</h6>\n<FormRadio\n    title=\"titlenOption\"\n    bgColor=\"bg-coopmaths-canvas-dark\"\n    orientation=\"{'col'}\"\n    bind:valueSelected=\"{latexFileInfos.titleOption}\"\n    labelsValues=\"{[\n    { label: 'Avec titre', value: 'AvecTitre' },\n    { label: 'Sans titre', value: 'SansTitre' },\n    ]}\"\n/>\n<h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n    Police de caractres\n</h6>\n<FormRadio\n    title=\"fontOption\"\n    bgColor=\"bg-coopmaths-canvas-dark\"\n    orientation=\"{'col'}\"\n    bind:valueSelected=\"{latexFileInfos.fontOption}\"\n    labelsValues=\"{[\n    { label: 'Standard', value: 'StandardFont' },\n    { label: 'Dys', value: 'DysFont' },\n    ]}\"\n/>\n{#if latexFileInfos.fontOption === 'StandardFont'}\n    <span>\n    Taille:\n    <input\n        type=\"number\"\n        id=\"export-latex-taille-input\"\n        class=\"min-w-14 border-1 w-1/5 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n        name=\"tailleFontOption\"\n        maxlength=\"2\"\n        min=\"8\"\n        max=\"20\"\n        bind:value=\"{latexFileInfos.tailleFontOption}\"\n    />\n    </span>\n{/if}\n{#if latexFileInfos.fontOption === 'DysFont'}\n    <span>\n    Taille:\n    <input\n        type=\"number\"\n        id=\"export-latex-dys-taille-input\"\n        class=\"min-w-14 border-1 w-1/5 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n        name=\"dysTailleFontOption\"\n        maxlength=\"2\"\n        min=\"8\"\n        max=\"20\"\n        bind:value=\"{latexFileInfos.dysTailleFontOption}\"\n    />\n    </span>\n{/if}\n<h6\n    class=\"mb-2 text-lg font-black leading-tight text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n    Qrcode\n</h6>\n<FormRadio\n    title=\"qrcodeOption\"\n    bgColor=\"bg-coopmaths-canvas-dark\"\n    orientation=\"{'col'}\"\n    bind:valueSelected=\"{latexFileInfos.qrcodeOption}\"\n    labelsValues=\"{[\n    { label: 'Avec', value: 'AvecQrcode' },\n    { label: 'Sans', value: 'SansQrcode' },\n    ]}\"\n/>\n{/if}\n\n","// Helpers pour encoder/dcoder\nexport function encodeBase64(obj: any): string {\n  return btoa(unescape(encodeURIComponent(JSON.stringify(obj))))\n}\n\nexport function decodeBase64(str: string): any {\n  try {\n    return JSON.parse(decodeURIComponent(escape(atob(str))))\n  } catch (e) {\n    return {}\n  }\n}\n","<script lang=\"ts\">\n  import { afterUpdate, beforeUpdate, onDestroy, onMount } from 'svelte'\n  import { get } from 'svelte/store'\n  import { Carousel, initTE } from 'tw-elements'\n  import type TypeExercice from '../../../exercices/Exercice'\n  import { downloadTexWithImagesZip, downloadZip } from '../../../lib/files'\n  import Latex, {\n      doesLatexNeedsPics,\n      getExosContentList,\n      getPicsNames,\n      makeImageFilesUrls,\n      type Exo,\n      type LatexFileInfos,\n      type latexFileType,\n      type picFile,\n  } from '../../../lib/Latex'\n  import {\n      mathaleaGetExercicesFromParams,\n      mathaleaGoToView,\n      mathaleaRenderDiv,\n      mathaleaUpdateUrlFromExercicesParams\n  } from '../../../lib/mathalea.js'\n  import { darkMode, exercicesParams } from '../../../lib/stores/generalStore'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import Footer from '../../Footer.svelte'\n  import ButtonActionInfo from '../../shared/forms/ButtonActionInfo.svelte'\n  import ButtonCompileLatexToPDF from '../../shared/forms/ButtonCompileLatexToPDF.svelte'\n  import ButtonCompileLatexToPdfLink from '../../shared/forms/ButtonCompileLatexToPDFLink.svelte'\n  import ButtonOverleaf from '../../shared/forms/ButtonOverleaf.svelte'\n  import ButtonTextAction from '../../shared/forms/ButtonTextAction.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import BasicClassicModal from '../../shared/modal/BasicClassicModal.svelte'\n  import SimpleCard from '../../shared/ui/SimpleCard.svelte'\n  import FormConfigSection from './FormConfigSection.svelte'\n  import { decodeBase64, encodeBase64 } from './LatexConfig'\n\n  const url = new URL(window.location.href)\n  const decoded = decodeBase64(url.searchParams.get(\"pdfParam\") || \"\") as Partial<LatexFileInfos>\n  \n    /**\n   * Toutes les variables configurables par l'interface WEB\n   * qui adaptent la sortie PDF\n   */\n  let latexFileInfos: LatexFileInfos = {\n    title: '',\n    reference: '',\n    subtitle: '',\n    style: 'Coopmaths',\n    fontOption: 'StandardFont',\n    tailleFontOption: 12,\n    dysTailleFontOption: 14,\n    correctionOption: 'AvecCorrection',\n    qrcodeOption: 'SansQrcode',\n    typeFiche: 'Fiche',\n    durationCanOption: '9 min',\n    titleOption: 'SansTitre',\n    nbVersions: 1,\n    exos: {},      // tu peux garder vide par dfaut\n    ...decoded     //  crase les valeurs par dfaut si prsente\n  }\n\n  const imgStylePartialUrls = {\n    Coopmaths: 'images/exports/export-coopmaths',\n    Classique: 'images/exports/export-classique',\n    ProfMaquette: 'images/exports/export-profmaquette',\n    ProfMaquetteQrcode: 'images/exports/export-profmaquette-qrcode',\n    Can: 'images/exports/export-can',\n  }\n  let dialogLua: HTMLDialogElement\n  let exercices: TypeExercice[]\n  let latexFile: latexFileType = {\n    contents: { preamble: '', intro: '', content: '', contentCorr: '' },\n    latexWithoutPreamble: '',\n    latexWithPreamble: '',\n  }\n\n  let picsWanted: boolean\n  let messageForCopyPasteModal: string\n  let picsNames: picFile[][] = []\n  let exosContentList: Exo[] = []\n  let divText: HTMLDivElement\n  let promise: Promise<void>\n  let isDownloadPicsModalDisplayed = false\n  let pdfParam = ''\n\n  const latex = new Latex()\n\n  async function initExercices() {\n    // console.log('initExercices')\n    const interfaceParams = get(exercicesParams)\n    interfaceParams.forEach((e) => {\n      e.interactif = '0'\n    })\n    mathaleaUpdateUrlFromExercicesParams(interfaceParams)\n    exercices = await mathaleaGetExercicesFromParams(interfaceParams)\n    latex.addExercices(exercices.filter((ex) => ex.typeExercice !== 'html'))\n    latexFile.contents = await latex.getContents(latexFileInfos)\n    picsWanted = doesLatexNeedsPics(latexFile.contents)\n    messageForCopyPasteModal = buildMessageForCopyPaste(picsWanted)\n  }\n\n  async function updateLatexWithAbortController() {\n    const clone = UpdateController.update()\n    if (clone.signal?.aborted) {\n      return Promise.reject(\n        new DOMException(\n          'Aborted in updateLatexWithAbortController',\n          'AbortError',\n        ),\n      )\n    }\n\n    return new Promise<void>(async (resolve, reject) => {\n      // Listen for abort event on signal\n      const rej = () => {\n        log('reject')\n        clone.signal?.removeEventListener('abort', rej)\n        reject(\n          new DOMException(\n            'Aborted in updateLatexWithAbortController',\n            'AbortError',\n          ),\n        )\n      }\n      clone.signal?.addEventListener('abort', rej)\n      // Something fake async\n      await updateLatex(clone)\n        .then(() => {\n          clone.signal?.removeEventListener('abort', rej)\n          log('Promise resolu')\n          resolve()\n        })\n        .catch((err) => {\n          reject(new DOMException(`Aborted : ${err.message}`, 'AbortError'))\n        })\n    })\n  }\n\n  async function updateLatex(clone: LatexFileInfos) {\n    try {\n      log('updateLatex')\n      // await new Promise((resolve) => setTimeout(resolve, 10000))\n      latexFile = await latex.getFile(clone)\n      log('fin updateLatex')\n    } catch (error) {\n      if (error instanceof DOMException && error.name === 'AbortError') {\n        // nouvelle demande de fichier LATEX demande\n        throw error\n      }\n      console.error('Erreur lors de la cration du code LaTeX :', error)\n      latexFile.latexWithoutPreamble = '% Erreur  signaler'\n    }\n  }\n\n  class UpdateController {\n    static controller: AbortController | undefined\n    static update() {\n      if (UpdateController.controller === undefined) {\n        UpdateController.controller = new AbortController()\n      } else {\n        UpdateController.controller.abort()\n        UpdateController.controller = new AbortController()\n      }\n      const clone = structuredClone(latexFileInfos)\n      clone.signal = UpdateController.controller.signal\n      return clone\n    }\n  }\n\n  const debug = false\n  function log(str: string) {\n    if (debug) {\n      console.info(str)\n    }\n  }\n\n  $: {\n    if (latex.exercices.length > 0) {\n      log('update')\n      latexFileInfos = {\n        ...latexFileInfos,\n        exos: {\n          ...latexFileInfos.exos\n          // les blocrep sont dj des sous-objets clons quand tu les modifies\n        }\n      }\n\n      pdfParam = encodeBase64(latexFileInfos)\n      url.searchParams.set('pdfParam', pdfParam)\n      history.replaceState(null, \"\", url)  // change lURL sans recharger\n\n      promise = updateLatexWithAbortController().catch((err) => {\n        if (err.name === 'AbortError') {\n          log('Promise Aborted')\n        } else {\n          log('Promise Rejected')\n        }\n      })\n    }\n  }\n\n  async function forceUpdate() {\n    log('forceUpdate')\n    latexFileInfos.title = latexFileInfos.title\n  }\n\n  onMount(async () => {\n    initTE({ Carousel })\n    // console.log('onMount')\n    promise = initExercices()\n      .then(() => updateLatexWithAbortController())\n      .catch((err) => {\n        if (err.name === 'AbortError') {\n          log('Promise Aborted')\n        } else {\n          log('Promise Rejected')\n        }\n      })\n    document.addEventListener('updateAsyncEx', forceUpdate)\n    mathaleaRenderDiv(divText)\n    // console.log('fin onMount')\n  })\n\n  onDestroy(async () => {\n    document.removeEventListener('updateAsyncEx', forceUpdate)\n  })\n\n  beforeUpdate(async () => {\n    // console.log('beforeUpdate')\n  })\n\n  afterUpdate(async () => {\n    // console.log('afterUpdate')\n  })\n\n  /**\n   * Grer le tlchargement des images dans une archive `images.zip` lors du clic sur le bouton du modal\n   * @author sylvain\n   */\n  function handleActionFromDownloadPicsModal() {\n    // console.log('handleActionFromDownloadPicsModal')\n    const imagesFilesUrls = makeImageFilesUrls(exercices)\n    downloadZip(imagesFilesUrls, 'images.zip')\n    isDownloadPicsModalDisplayed = false\n  }\n\n  /**\n   * Grer l'affichage du modal : on donne la liste des images par exercice\n   */\n  function handleDownloadPicsModalDisplay() {\n    // console.log('handleDownloadPicsModalDisplay')\n    exosContentList = getExosContentList(exercices)\n    picsNames = getPicsNames(exosContentList)\n    isDownloadPicsModalDisplayed = true\n  }\n\n  /**\n   * Construction d'un message contextualis indiquant le besoin de tlcharger les images si besoin\n   */\n  export function buildMessageForCopyPaste(picsWanted: boolean) {\n    if (picsWanted) {\n      return `<p>Le code LaTeX a t copi dans le presse-papier.</p>\n      <p class=\"font-bold text-coopmaths-warn-darkest\">Ne pas oublier de tlcharger les figures !</p>`\n    } else {\n      return 'Le code LaTeX a t copi dans le presse-papier.'\n    }\n  }\n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\"LaTeX\"\n    subtitleType=\"export\"\n    handleLanguage=\"{() => {}}\"\n    locale=\"{$referentielLocale}\"\n  />\n\n  <section\n    class=\"px-4 py-0 md:py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  >\n    <h1\n      class=\"mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n    >\n      Paramtrage\n    </h1>\n    <div\n      class=\"grid grid-cols-1 grid-rows-1 md:grid-cols-2 xl:grid-cols-3 gap-8\"\n    >\n      <div\n        class=\"flex flex-col w-full md:flex-row justify-between rounded-lg bg-coopmaths-canvas-dark shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),0_10px_20px_-2px_rgba(0,0,0,0.04)] dark:bg-coopmathsdark-canvas-dark\"\n      >\n        <div class=\"flex flex-col py-4 pl-16 w-2/3\">\n          <FormConfigSection\n            {latex}\n            bind:latexFileInfos\n            {promise}\n          />\n        </div>\n        <!-- Carousel de vignette pour les aperus -->\n        <div class=\"flex justify-center w-full md:w-1/3\">\n          <div\n            id=\"carouselExampleSlidesOnly\"\n            class=\"relative w-2/3 md:w-full\"\n            data-te-carousel-init\n            data-te-ride=\"carousel\"\n          >\n            <div\n              class=\"relative w-full overflow-hidden after:clear-both after:block after:content-['']\"\n            >\n              <!-- first item -->\n              <div\n                class=\"relative float-left -mr-[100%] w-full transition-transform duration-[300ms] ease-in-out motion-reduce:transition-none\"\n                data-te-carousel-item\n                data-te-carousel-active\n              >\n                <img\n                  src=\"{`${imgStylePartialUrls[latexFileInfos.style]}-thumb1.png`}\"\n                  alt=\"{latexFileInfos.style} image-1\"\n                  class=\"block h-auto w-full rounded-r-lg\"\n                />\n              </div>\n              <!-- second item -->\n              <div\n                class=\"relative float-left -mr-[100%] hidden w-full transition-transform duration-[300ms] ease-in-out motion-reduce:transition-none\"\n                data-te-carousel-item\n              >\n                <img\n                  src=\"{`${imgStylePartialUrls[latexFileInfos.style]}-thumb2.png`}\"\n                  alt=\"{latexFileInfos.style} image-2\"\n                  class=\"block h-auto w-full rounded-r-lg\"\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <SimpleCard icon=\"{''}\" title=\"{'lments de titres'}\">\n        <div class=\"flex flex-col w-full justify-start items-start space-y-2\">\n          <input\n            type=\"text\"\n            id=\"export-latex-titre-input\"\n            class=\"border-1 w-full disabled:opacity-20 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light placeholder:opacity-40\"\n            placeholder=\"{latexFileInfos.style === 'Can'\n              ? 'Course aux nombres'\n              : 'Titre'}\"\n            bind:value=\"{latexFileInfos.title}\"\n          />\n          <input\n            type=\"text\"\n            id=\"export-latex-reference-input\"\n            class=\" border-1 w-full disabled:opacity-20 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light placeholder:opacity-40\"\n            placeholder=\"{latexFileInfos.style === 'Coopmaths' ||\n            latexFileInfos.style === 'ProfMaquetteQrcode' ||\n            latexFileInfos.style === 'ProfMaquette'\n              ? 'Rfrence'\n              : 'Haut de page gauche'}\"\n            bind:value=\"{latexFileInfos.reference}\"\n            disabled=\"{latexFileInfos.style === 'Can'}\"\n          />\n          <input\n            type=\"text\"\n            id=\"export-latex-soustitre-input\"\n            class=\"border-1 w-full disabled:opacity-20 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light placeholder:opacity-40\"\n            placeholder=\"{latexFileInfos.style === 'Coopmaths' ||\n            latexFileInfos.style === 'ProfMaquetteQrcode' ||\n            latexFileInfos.style === 'ProfMaquette'\n              ? 'Sous-titre / Chapitre'\n              : 'Pied de page droit'}\"\n            bind:value=\"{latexFileInfos.subtitle}\"\n            disabled=\"{latexFileInfos.style === 'Can'}\"\n          />\n        </div>\n      </SimpleCard>\n      <SimpleCard icon=\"{''}\" title=\"{'Nombre de versions des exercices'}\">\n        <input\n          type=\"number\"\n          id=\"export-latex-nb-versions-input\"\n          class=\"min-w-14 border-1 w-1/5 border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas text-sm text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          name=\"numberOfVersions\"\n          maxlength=\"2\"\n          min=\"1\"\n          max=\"20\"\n          bind:value=\"{latexFileInfos.nbVersions}\"\n        />\n      </SimpleCard>\n    </div>\n\n    <div bind:this=\"{divText}\">\n      <h1\n        class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n      >\n        Exportation\n      </h1>\n      <div class=\"pl-4\">\n        <div\n          class=\"text-coopmaths-struct-light dark:text-coopmathsdark-struct-light md:text-2xl font-bold pb-2\"\n        >\n          Que faire du code $\\LaTeX$ ?\n        </div>\n        <div\n          class=\"grid grid-cols-1 grid-rows-1 md:grid-cols-2 xl:grid-cols-2 gap-8\"\n        >\n          <SimpleCard title=\"{'Obtenir un PDF'}\">\n            <div>\n              Je souhaite obtenir un fichier PDF  partir du code $\\LaTeX$. Je\n              vais tre redirig(e) vers le site OverLeaf (qui ncessite d'avoir\n              un compte) pour compiler le code en ligne.\n            </div>\n            <div slot=\"button1\">\n              {#await promise}\n                <p>Chargement en cours...</p>\n              {:then}\n                <ButtonOverleaf\n                  class=\"flex w-full flex-col justify-center\"\n                  {latexFile}\n                  {exercices}\n                  disabled=\"{false}\"\n                />\n              {/await}\n            </div>\n          </SimpleCard>\n          <SimpleCard\n            title=\"{'Compiler le code pour avoir un fichier PDF (version encore beta)'}\"\n          >\n            <div>\n              Je souhaite obtenir un fichier PDF  partir du code $\\LaTeX$.\n              J'essaie le nouveau compilateur en ligne (serveur TexLive.net) qui\n              ne ncessite pas d'avoir un compte.\n            </div>\n            <div slot=\"button1\">\n              {#await promise}\n                <p>Chargement en cours...</p>\n              {:then}\n                <ButtonCompileLatexToPDF\n                  class=\"flex w-full flex-col justify-center\"\n                  {latex}\n                  {latexFileInfos}\n                  id=\"0\"\n                />\n              {/await}\n            </div>\n          </SimpleCard>\n          <SimpleCard\n            title=\"{'Compiler le code pour avoir un fichier PDF (version encore gamma)'}\"\n          >\n            <div>\n              Je souhaite obtenir un fichier PDF  partir du code $\\LaTeX$.\n              J'essaie le nouveau compilateur en ligne qui\n              ne ncessite pas d'avoir un compte.\n            </div>\n            <div slot=\"button1\">\n              {#await promise}\n                <p>Chargement en cours...</p>\n              {:then}\n                <ButtonCompileLatexToPdfLink\n                  class=\"flex w-full flex-col justify-center\"\n                  {latex}\n                  {latexFileInfos}\n                  id=\"3\"\n                />\n              {/await}\n            </div>\n          </SimpleCard>\n          <SimpleCard title=\"{'Copier le code'}\" icon=\"{'bx-copy-alt'}\">\n            <div>\n              Je souhaite copier le code $\\LaTeX$ pour le coller dans un autre\n              logiciel.\n            </div>\n            <div slot=\"button1\">\n              {#await promise}\n                <p>Chargement en cours...</p>\n              {:then}\n                <ButtonActionInfo\n                  action=\"copy\"\n                  textToCopy=\"{latexFile.latexWithoutPreamble}\"\n                  text=\"Code seul\"\n                  successMessage=\"{messageForCopyPasteModal}\"\n                  errorMessage=\"Impossible de copier le code LaTeX dans le presse-papier\"\n                  class=\"px-2 py-1 rounded-md\"\n                />\n              {/await}\n            </div>\n            <div slot=\"button2\">\n              {#await promise}\n                <p></p>\n              {:then}\n                <ButtonActionInfo\n                  action=\"copy\"\n                  textToCopy=\"{latexFile.latexWithPreamble}\"\n                  text=\"Code + prambule\"\n                  successMessage=\"{messageForCopyPasteModal}\"\n                  errorMessage=\"Impossible de copier le code LaTeX dans le presse-papier\"\n                  class=\"px-2 py-1 rounded-md\"\n                />\n              {/await}\n            </div>\n          </SimpleCard>\n          <SimpleCard title=\"{'Tlcharger le code'}\" icon=\"{'bx-download'}\">\n            <div>Je souhaite tlcharger le matriel sur mon ordinateur.</div>\n            <div slot=\"button1\">\n              <ButtonTextAction\n                class=\"px-2 py-1 rounded-md\"\n                id=\"downloadFullArchive\"\n                on:click=\"{async () => {\n                  await promise\n                  downloadTexWithImagesZip('coopmaths', latexFile, exercices)\n                }}\"\n                text=\"Archive complte\"\n              />\n            </div>\n            <div slot=\"button2\">\n              {#await promise}\n                <p></p>\n              {:then}\n                <ButtonTextAction\n                  class=\"inline-block px-2 py-1 rounded-md\"\n                  id=\"downloadPicsButton\"\n                  on:click=\"{handleDownloadPicsModalDisplay}\"\n                  text=\"Uniquement les figures\"\n                  disabled=\"{!picsWanted}\"\n                />\n              {/await}\n            </div>\n          </SimpleCard>\n           <SimpleCard title=\"{'Basculer vers la vue PDF'}\" icon=\"{'bx-download'}\">\n            <div>Je souhaite basculer vers la vue PDF.</div>\n            <div slot=\"button1\">\n              <ButtonTextAction\n                class=\"px-2 py-1 rounded-md\"\n                id=\"vuePDF\"\n                on:click=\"{() => {\n                  mathaleaGoToView('pdf')\n                }}\"\n                text=\"Basculer sur la vue PDF\"\n              />\n            </div>\n            </SimpleCard>\n        </div>\n        <BasicClassicModal\n          bind:isDisplayed=\"{isDownloadPicsModalDisplayed}\"\n          icon=\"bx-code\"\n        >\n          <span slot=\"header\"></span>\n          <div slot=\"content\" class=\"flex flex-col justify-start items-start\">\n            Voici ce dont vous aurez besoin :\n            {#each exosContentList as exo, i (exo)}\n              <ul\n                class=\"flex flex-col justify-start items-start list-disc pl-6\"\n              >\n                <!-- <li class={picsNames[i].length > 0 ? \"container\" : \"hidden\"}>Exercice {i + 1} (<span class=\"text-italic\">{exo.groups.title}</span>) :</li> -->\n                {#if picsNames[i].length !== 0}\n                  <li>\n                    Exercice {i + 1} (<span class=\"text-italic\"\n                      >{exo.title}</span\n                    >) :\n                  </li>\n                  <ul\n                    class=\"flex flex-col justify-start items-start list-none pl-4\"\n                  >\n                    {#each picsNames[i] as img}\n                      <li class=\"font-mono text-sm\">{img.name}</li>\n                    {/each}\n                  </ul>\n                {/if}\n              </ul>\n            {/each}\n          </div>\n          <div slot=\"footer\">\n            <ButtonTextAction\n              text=\"Tlcharger les figures\"\n              on:click=\"{handleActionFromDownloadPicsModal}\"\n            />\n          </div>\n        </BasicClassicModal>\n      </div>\n    </div>\n\n    <dialog\n      bind:this=\"{dialogLua}\"\n      class=\"rounded-xl bg-coopmaths-canvas text-coopmaths-corpus dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-corpus-light font-light shadow-lg p-6\"\n    >\n      <!-- eslint-disable-next-line svelte/no-at-html-tags -->\n      {@html messageForCopyPasteModal}\n      {#if latexFileInfos.style === 'ProfMaquette'}\n        <p class=\"mt-4\">\n          Il faut mettre  jour votre distribution LaTeX pour avoir la dernire\n          version du package <em\n            class=\"text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest font-bold\"\n            >ProfMaquette</em\n          >.\n        </p>\n      {:else}\n        <p class=\"mt-4\">\n          Il faudra utiliser <em\n            class=\"text-coopmaths-warn-darkest dark:text-coopmathsdark-warn-darkest font-bold\"\n            >LuaLaTeX</em\n          > pour compiler le document.\n        </p>\n      {/if}\n    </dialog>\n\n    <h1\n      class=\"mt-12 md:mt-8 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n    >\n      Code\n    </h1>\n    <pre\n      class=\"my-10 shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus dark:text-coopmathsdark-corpus p-4 w-full overflow-y-auto overflow-x-scroll text-xs\">\n      {#await promise}\n        <p>Chargement en cours...</p>\n      {:then}\n        {latexFile.latexWithoutPreamble}\n      {/await}\n    </pre>\n  </section>\n  <footer>\n    <Footer />\n  </footer>\n</main>\n\n<style>\n  footer {\n    margin-top: auto;\n  }\n</style>\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import { tweened } from 'svelte/motion'\n  import type Latex from '../../../lib/Latex'\n  import {\n      buildImagesUrlsList,\n      doesLatexNeedsPics,\n      getExosContentList,\n      getPicsNames,\n      type LatexFileInfos,\n  } from '../../../lib/Latex'\n  import PdFviewer from '../../shared/forms/PDFviewer.svelte'\n\n  export let latex: Latex\n  export let latexFileInfos: LatexFileInfos\n\n\n  let pdfBlob: Blob | null = null\n  let downloadFilename: string | null = null\n  let clockAbled = false\n\n  const original = 60 // secondes\n  const timer = tweened(original)\n\n  // fabrique un nom de fichier\n  function generateFilename(prefix = \"document\", ext = \"pdf\") {\n    const now = new Date()\n    const pad = (n: number) => String(n).padStart(2, \"0\")\n    const date = `${now.getFullYear()}-${pad(now.getMonth() + 1)}-${pad(now.getDate())}`\n    const time = `${pad(now.getHours())}${pad(now.getMinutes())}${pad(now.getSeconds())}`\n    return `${prefix}_${date}_${time}.${ext}`\n  }\n\n  function downloadAndExtractPDF(blob: Blob, filename: string) {\n    pdfBlob = blob\n    downloadFilename = filename\n  }\n\n  //  fonction de compilation\n  export async function compileToPDF() {\n    const contents = await latex.getContents(latexFileInfos)\n    if (contents.content === '') {\n      pdfBlob = null\n      downloadFilename = null\n      return\n    }\n    const { latexWithPreamble } = await latex.getFile(latexFileInfos)\n    const picsWanted = doesLatexNeedsPics(contents)\n    const exosContentList = getExosContentList(latex.exercices)\n    const picsNames = getPicsNames(exosContentList)\n    const imagesUrls: string[] = picsWanted\n      ? buildImagesUrlsList(exosContentList, picsNames)\n      : []\n\n    const formData = new FormData()\n    formData.append('name', 'document.tex')\n    formData.append('originalname', 'document.tex')\n    formData.append('file', new Blob([latexWithPreamble]), 'document.tex')\n\n    for (let im = 0; im < imagesUrls.length; im++) {\n      const imaUrl = imagesUrls[im].replace(\n        'https://coopmaths.fr',\n        window.location.origin,\n      )\n      const visual = await fetch(imaUrl)\n      const blob = await visual.blob()\n      formData.append('name', imaUrl.split('/').slice(-1)[0])\n      formData.append('originalname', imaUrl.split('/').slice(-1)[0])\n      formData.append('file', blob, imaUrl.split('/').slice(-1)[0])\n    }\n\n    // timer\n    timer.set(original)\n    clockAbled = true\n    const timeValue = setInterval(() => {\n      timer.update(n => {\n        if (n > 0) return n - 1\n        clearInterval(timeValue)\n        return 0\n      })\n    }, 1000)\n\n    try {\n      const res = await fetch('https://latexcompiler.duckdns.org/generate', {\n        method: 'POST',\n        body: formData,\n        signal: AbortSignal.timeout(60 * 1000)\n      })\n      if (res.status !== 200) throw new Error(\"Erreur compilation\")\n      const blob = await res.blob()\n      await downloadAndExtractPDF(blob, generateFilename(\"document\", \"pdf\"))\n    } catch (err) {\n      console.error(\"Erreur de compilation:\", err)\n    } finally {\n      clockAbled = false\n    }\n  }\n  \n  // auto-lancement\n  onMount(() => {\n    compileToPDF()\n  })\n</script>\n\n<div class=\"flex flex-col h-full\">\n  {#if clockAbled}\n    <div class=\"loader text-center m-2\">\n      <progress value={$timer / original}></progress>\n      {$timer.toFixed(0)}s\n    </div>\n  {/if}\n\n  {#if pdfBlob}\n    {#if downloadFilename}\n      <div class=\"m-2\">\n        <a\n          href={URL.createObjectURL(pdfBlob)}\n          download={downloadFilename}\n          class=\"px-3 py-1 rounded bg-coopmaths-action text-white hover:bg-coopmaths-action-lightest\"\n        >\n          Tlcharger {downloadFilename}\n        </a>\n      </div>\n    {/if}\n\n    <div class=\"flex-1 overflow-auto m-2\">\n      <PdFviewer blob={pdfBlob} />\n    </div>\n  {/if}\n\n  {#if !pdfBlob && !clockAbled}\n    <div class=\"m-2 text-center text-coopmaths-corpus dark:text-coopmathsdark-corpus\">\n      Aucun PDF gnr\n    </div>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import { afterUpdate, beforeUpdate, onDestroy, onMount } from 'svelte'\n  import { get } from 'svelte/store'\n  import { Carousel, initTE } from 'tw-elements'\n  import type TypeExercice from '../../../exercices/Exercice'\n  import Latex, {\n      doesLatexNeedsPics,\n      type LatexFileInfos,\n      type latexFileType\n  } from '../../../lib/Latex'\n  import {\n      mathaleaGetExercicesFromParams,\n      mathaleaGoToView,\n  } from '../../../lib/mathalea.js'\n  import { darkMode, exercicesParams } from '../../../lib/stores/generalStore'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import Footer from '../../Footer.svelte'\n  import ButtonCompileLatexToPdf from '../../shared/forms/ButtonCompileLatexToPDF.svelte'\n  import ButtonTextAction from '../../shared/forms/ButtonTextAction.svelte'\n  import FormConfigGlobal from '../../shared/forms/FormConfigGlobal.svelte'\n  import FormConfigIndividual from '../../shared/forms/FormConfigIndividual.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import SimpleCard from '../../shared/ui/SimpleCard.svelte'\n  import FormConfigSection from './FormConfigSection.svelte'\n  import { decodeBase64, encodeBase64 } from './LatexConfig'\n  import PdfResult from './PdfResult.svelte'\n\n  \n  let showAdvanced = false; // toggle pour les paramtres avancs\n\n\n\n  const url = new URL(window.location.href)\n  const decoded = decodeBase64(url.searchParams.get(\"pdfParam\") || \"\") as Partial<LatexFileInfos>\n\n  /**\n   * Toutes les variables configurables par l'interface WEB\n   * qui adaptent la sortie PDF\n   */\n  let latexFileInfos: LatexFileInfos = {\n    title: '',\n    reference: '',\n    subtitle: '',\n    style: 'ProfMaquette',\n    fontOption: 'StandardFont',\n    tailleFontOption: 12,\n    dysTailleFontOption: 14,\n    correctionOption: 'AvecCorrection',\n    qrcodeOption: 'SansQrcode',\n    typeFiche: 'Fiche',\n    durationCanOption: '9 min',\n    titleOption: 'SansTitre',\n    nbVersions: 1,\n    exos: {},      // tu peux garder vide par dfaut\n    ...decoded     //  crase les valeurs par dfaut si prsente\n  }\n\n  let pdfParam = encodeBase64(latexFileInfos)\n\n  url.searchParams.set('pdfParam', pdfParam)\n\n  const imgStylePartialUrls = {\n    Coopmaths: 'images/exports/export-coopmaths',\n    Classique: 'images/exports/export-classique',\n    ProfMaquette: 'images/exports/export-profmaquette',\n    ProfMaquetteQrcode: 'images/exports/export-profmaquette-qrcode',\n    Can: 'images/exports/export-can',\n  }\n  let exercices: TypeExercice[]\n  let latexFile: latexFileType = {\n    contents: { preamble: '', intro: '', content: '', contentCorr: '' },\n    latexWithoutPreamble: '',\n    latexWithPreamble: '',\n  }\n  let isExerciceStaticInTheList = false\n  let picsWanted: boolean\n  let promise: Promise<void>\n  let activeTab : \"general\" | \"advanced\" | \"global\" = \"general\"\n  \n\n  const latex = new Latex()\n\n  async function initExercices(indexesToLoad?: number[]) {\n    log('initExercices')\n    const interfaceParams = get(exercicesParams)\n    interfaceParams.forEach((e) => {\n      e.interactif = '0'\n    })\n    exercices = await mathaleaGetExercicesFromParams(interfaceParams)\n    latex.addExercices(exercices.filter((ex, index) => ex.typeExercice !== 'html' && (!indexesToLoad || indexesToLoad.includes(index))))\n    isExerciceStaticInTheList = latex.isExerciceStaticInTheList()\n    latexFile.contents = await latex.getContents(latexFileInfos)\n    picsWanted = doesLatexNeedsPics(latexFile.contents)\n  }\n\n  async function updateLatexWithAbortController() {\n    const clone = UpdateController.update()\n    if (clone.signal?.aborted) {\n      return Promise.reject(\n        new DOMException(\n          'Aborted in updateLatexWithAbortController',\n          'AbortError',\n        ),\n      )\n    }\n\n    return new Promise<void>(async (resolve, reject) => {\n      // Listen for abort event on signal\n      const rej = () => {\n        log('reject')\n        clone.signal?.removeEventListener('abort', rej)\n        reject(\n          new DOMException(\n            'Aborted in updateLatexWithAbortController',\n            'AbortError',\n          ),\n        )\n      }\n      clone.signal?.addEventListener('abort', rej)\n      // Something fake async\n      await updateLatex(clone)\n        .then(() => {\n          clone.signal?.removeEventListener('abort', rej)\n          log('Promise resolu')\n          resolve()\n        })\n        .catch((err) => {\n          reject(new DOMException(`Aborted : ${err.message}`, 'AbortError'))\n        })\n    })\n  }\n\n  async function updateLatex(clone: LatexFileInfos) {\n    try {\n      log('updateLatex')\n      // await new Promise((resolve) => setTimeout(resolve, 10000))\n      latexFile = await latex.getFile(clone)\n      log('fin updateLatex')\n    } catch (error) {\n      if (error instanceof DOMException && error.name === 'AbortError') {\n        // nouvelle demande de fichier LATEX demande\n        throw error\n      }\n      console.error('Erreur lors de la cration du code LaTeX :', error)\n      latexFile.latexWithoutPreamble = '% Erreur  signaler'\n    }\n  }\n\n  class UpdateController {\n    static controller: AbortController | undefined\n    static update() {\n      if (UpdateController.controller === undefined) {\n        UpdateController.controller = new AbortController()\n      } else {\n        UpdateController.controller.abort()\n        UpdateController.controller = new AbortController()\n      }\n      const clone = structuredClone(latexFileInfos)\n      clone.signal = UpdateController.controller.signal\n      return clone\n    }\n  }\n\n  const debug = url.searchParams.get('log') === '5' || false\n  function log(str: string) {\n    if (debug) {\n      console.info(str)\n    }\n  }\n\n  $: {\n    if (latex.exercices.length > 0) {\n      log('update')\n      latexFileInfos = {\n        ...latexFileInfos,\n        exos: {\n          ...latexFileInfos.exos\n          // les blocrep sont dj des sous-objets clons quand tu les modifies\n        }\n      }\n      const newPdfParam = encodeBase64(latexFileInfos)\n      if (newPdfParam !== pdfParam) {\n        pdfParam = newPdfParam\n         url.searchParams.set('pdfParam', pdfParam)\n         history.replaceState(null, \"\", url)  // change lURL sans recharger\n\n         promise = updateLatexWithAbortController().catch((err) => {\n            if (err.name === 'AbortError') {\n              log('Promise Aborted')\n            } else {\n              log('Promise Rejected')\n            }\n          })\n      }\n    }\n  }\n\n  async function forceUpdate() {\n    log('forceUpdate')\n    latexFileInfos.title = latexFileInfos.title\n  }\n\n  onMount(async () => {\n    initTE({ Carousel })\n    promise = initExercices()\n      .then(() => updateLatexWithAbortController())\n      .catch((err) => {\n        if (err.name === 'AbortError') {\n          log('Promise Aborted')\n        } else {\n          log('Promise Rejected')\n        }\n      })\n    document.addEventListener('updateAsyncEx', forceUpdate)\n  })\n\n  onDestroy(async () => {\n    document.removeEventListener('updateAsyncEx', forceUpdate)\n  })\n\n  beforeUpdate(async () => {\n    // console.log('beforeUpdate')\n  })\n\n  afterUpdate(async () => {\n    // console.log('afterUpdate')\n  })\n\n \n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\"PDF\"\n    subtitleType=\"export\"\n    handleLanguage=\"{() => {}}\"\n    locale=\"{$referentielLocale}\"\n  />\n  <section class=\"px-4 py-0 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\">\n    <!-- Titre toujours en pleine largeur -->\n    <h1\n      class=\"w-full text-center md:text-left text-coopmaths-struct \n             dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold mb-6\"\n    >\n      Visualisation du PDF     \n      <button\n        class=\"mx-2 tooltip tooltip-left tooltip-neutral\"\n        data-tip=\"Changer les paramtres du PDF\"\n        type=\"button\"\n        on:click=\"{() => { showAdvanced = !showAdvanced }}\"\n      >\n        <i\n          class=\"text-coopmaths-action hover:text-coopmaths-action-lightest \n                 dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest \n                 bx bx-slider\"\n        ></i>\n      </button>\n    </h1>\n\n    <!-- Grille responsive uniquement pour le contenu -->\n    <div class=\"{showAdvanced ? 'grid grid-cols-1 gap-8 md:grid-cols-2 xl:grid-cols-3 items-stretch' : ''}\">\n      \n      {#if showAdvanced}\n        <!-- Colonne configuration -->\n        <div class=\"flex flex-col space-y-8\">\n          \n          <!-- Barre donglets -->\n          <div class=\"flex space-x-4 border-b border-gray-600 mb-4\">\n            <button\n              class=\"pb-2 px-2 -mb-px text-sm font-medium transition-colors duration-200\"\n              class:text-blue-500={activeTab === \"general\"}\n              class:border-b-2={activeTab === \"general\"}\n              class:border-blue-500={activeTab === \"general\"}\n              class:text-gray-400={activeTab !== \"general\"}\n              class:hover:text-gray-200={activeTab !== \"general\"}\n              on:click={() => (activeTab = \"general\")}\n            >\n              Gnral\n            </button>\n            <button\n              class=\"pb-2 px-2 -mb-px text-sm font-medium transition-colors duration-200\"\n              class:text-blue-500={activeTab === \"global\"}\n              class:border-b-2={activeTab === \"global\"}\n              class:border-blue-500={activeTab === \"global\"}\n              class:text-gray-400={activeTab !== \"global\"}\n              class:hover:text-gray-200={activeTab !== \"global\"}\n              on:click={() => (activeTab = \"global\")}\n              >\n              Global\n            </button>\n\n            <button\n              class=\"pb-2 px-2 -mb-px text-sm font-medium transition-colors duration-200\"\n              class:text-blue-500={activeTab === \"advanced\"}\n              class:border-b-2={activeTab === \"advanced\"}\n              class:border-blue-500={activeTab === \"advanced\"}\n              class:text-gray-400={activeTab !== \"advanced\"}\n              class:hover:text-gray-200={activeTab !== \"advanced\"}\n              on:click={() => (activeTab = \"advanced\")}\n            >\n              Avanc\n            </button>\n          </div>\n\n          <!-- les onglets -->\n          {#if activeTab === \"general\"}\n          <div class=\"mb-6 border rounded-lg p-4 bg-gray-50 mx-auto h-[70vh] overflow-y-auto\">\n            <div\n              class=\"mb-4 flex flex-col md:flex-row w-full justify-between rounded-lg \n                    bg-coopmaths-canvas-dark shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),\n                    0_10px_20px_-2px_rgba(0,0,0,0.04)] \n                    dark:bg-coopmathsdark-canvas-dark\"\n            >\n            <div class=\"flex flex-col py-4 pl-16 w-2/3\">\n            <FormConfigSection\n              {latex}\n              bind:latexFileInfos\n              {promise}\n            />\n            </div>\n            <!-- Carousel de vignette pour les aperus -->\n            <div class=\"flex justify-center w-full md:w-1/3\">\n              <div\n                id=\"carouselExampleSlidesOnly\"\n                class=\"relative w-2/3 md:w-full\"\n                data-te-carousel-init\n                data-te-ride=\"carousel\"\n              >\n                <div\n                  class=\"relative w-full overflow-hidden after:clear-both after:block after:content-['']\"\n                >\n                  <!-- first item -->\n                  <div\n                    class=\"relative float-left -mr-[100%] w-full transition-transform duration-[300ms] ease-in-out motion-reduce:transition-none\"\n                    data-te-carousel-item\n                    data-te-carousel-active\n                  >\n                    <img\n                      src=\"{`${imgStylePartialUrls[latexFileInfos.style]}-thumb1.png`}\"\n                      alt=\"{latexFileInfos.style} image-1\"\n                      class=\"block h-auto w-full rounded-r-lg max-w-[200px]\"\n                    />\n                  </div>\n                  <!-- second item -->\n                  <div\n                    class=\"relative float-left -mr-[100%] hidden w-full transition-transform duration-[300ms] ease-in-out motion-reduce:transition-none\"\n                    data-te-carousel-item\n                  >\n                    <img\n                      src=\"{`${imgStylePartialUrls[latexFileInfos.style]}-thumb2.png`}\"\n                      alt=\"{latexFileInfos.style} image-2\"\n                      class=\"block h-auto w-full rounded-r-lg\"\n                    />\n                  </div>\n                </div>\n              </div>\n            </div> <!-- fin carousel -->\n          </div>\n\n          <SimpleCard icon=\"{''}\" title=\"{'lments de titres'}\" class=\"mb-4\">\n            <input type=\"text\" placeholder=\"Titre\" bind:value=\"{latexFileInfos.title}\" />\n            <input type=\"text\" placeholder=\"Rfrence\" bind:value=\"{latexFileInfos.reference}\" />\n            <input type=\"text\" placeholder=\"Sous-titre\" bind:value=\"{latexFileInfos.subtitle}\" />\n          </SimpleCard>\n\n          <SimpleCard icon=\"{''}\" title=\"{'Nombre de versions des exercices'}\" class=\"mb-4\">\n            <input type=\"number\" min=\"1\" max=\"20\" bind:value=\"{latexFileInfos.nbVersions}\" />\n          </SimpleCard>\n\n          <SimpleCard title=\"{''}\" icon=\"{''}\" class=\"mb-4\">\n            <ButtonTextAction\n                class=\"px-2 py-1 rounded-md\"\n                id=\"vueLatex\"\n                on:click=\"{() => {\n                  mathaleaGoToView('latex')\n                }}\"\n                text=\"Basculer vers la vue Latex\"\n              />\n\n            <ButtonCompileLatexToPdf\n              class=\"px-4 rounded-lg flex gap-3 bg-coopmaths-action justify-center hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest text-white\"\n              {latex}\n              {latexFileInfos}\n              id=\"1\"\n            />\n          </SimpleCard>\n        </div>\n        {/if}\n        {#if activeTab === \"global\"}\n           <div\n            class=\"flex flex-col md:flex-row w-full justify-between rounded-lg \n                  bg-coopmaths-canvas-dark shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),\n                  0_10px_20px_-2px_rgba(0,0,0,0.04)] \n                  dark:bg-coopmathsdark-canvas-dark\"\n          >\n          <div class=\"mb-6 border rounded-lg p-4 bg-gray-50 mx-auto h-[70vh] overflow-y-auto\">\n            <FormConfigGlobal\n                bind:latexFileInfos\n                {latex}\n              />\n            </div>\n          </div>\n        {/if}\n        {#if activeTab === \"advanced\"}\n          <div\n              class=\"flex flex-col md:flex-row w-full justify-between rounded-lg \n                    bg-coopmaths-canvas-dark shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),\n                    0_10px_20px_-2px_rgba(0,0,0,0.04)] \n                    dark:bg-coopmathsdark-canvas-dark\"\n            >\n            <div class=\"mb-6 border rounded-lg p-4 bg-gray-50 mx-auto h-[70vh] overflow-y-auto\">\n              <FormConfigIndividual\n                bind:latexFileInfos\n                {latex}\n              />\n            </div>\n          </div>\n        {/if}\n      </div>\n       {/if}\n      <!-- Colonne rendu PDF -->\n      <div \n        class=\"shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark \n              text-coopmaths-corpus dark:text-coopmathsdark-corpus \n              w-full overflow-y-auto overflow-x-scroll text-xs \n              min-h-[70vh]\n              {showAdvanced ? 'col-span-1 md:col-span-1 xl:col-span-2 h-full' : 'h-[70vh]'}\"\n      >\n        {#await promise}\n          <p>Chargement en cours...</p>\n        {:then}\n          <PdfResult {latex} {latexFileInfos} />\n        {/await}\n      </div>\n    </div>\n  </section>\n\n  <footer>\n    <Footer />\n  </footer>\n</main>\n\n<style>\n  footer {\n    margin-top: auto;\n  }\n</style>\n","<script lang=\"ts\">\n  import { exercicesParams, darkMode } from '../../../lib/stores/generalStore'\n  import Footer from '../../Footer.svelte'\n  import NavBar from '../../shared/header/NavBar.svelte'\n  import {\n    mathaleaGetExercicesFromParams,\n    mathaleaUpdateExercicesParamsFromUrl,\n  } from '../../../lib/mathalea'\n  import type TypeExercice from '../../../exercices/Exercice'\n  import ButtonToggleAlt from '../../shared/forms/ButtonToggleAlt.svelte'\n  import FormRadio from '../../shared/forms/FormRadio.svelte'\n  import { referentielLocale } from '../../../lib/stores/languagesStore'\n  import { onMount } from 'svelte'\n  import { Tab, initTE } from 'tw-elements' // pour les tabs\n  import { saveAs } from 'file-saver'\n  import JSZip from 'jszip'\n\n  onMount(() => {\n    initTE({ Tab })\n  })\n\n  const copyCode = async () => {\n    const preElt = document.querySelector('pre')\n    if (preElt) {\n      try {\n        const text = preElt.innerText\n        await navigator.clipboard.writeText(text)\n      } catch (err) {\n        console.error('Accs au presse-papier impossible: ', err)\n      }\n    } else {\n      throw new Error(\"Can't find `pre` selector in document\")\n    }\n  }\n\n  function downloadGift() {\n    const preElt = document.querySelector('pre')\n    if (preElt) {\n      const text = preElt.innerText\n      const element = document.createElement('a')\n      element.setAttribute(\n        'href',\n        'data:text/plain;charset=utf-8,' + encodeURIComponent(text),\n      )\n      element.setAttribute('download', 'mathalea-gift.txt')\n      element.style.display = 'none'\n      document.body.appendChild(element)\n      element.click()\n      document.body.removeChild(element)\n    } else {\n      throw new Error(\"Can't find `pre` selector in document\")\n    }\n  }\n\n  function downloadScorm() {\n    const zip = new JSZip()\n    zip.file('imsmanifest.xml', contentScorm)\n    let indexHtml = ''\n    indexHtml += '<html>\\n'\n    indexHtml += '  <head>\\n'\n    indexHtml += '    <title>MathAlea</title>\\n'\n    indexHtml +=\n      '    <scr' +\n      'ipt type=\"text/javascript\" src=\"https://coopmaths.fr/alea/assets/externalJs/SCORM_API_wrapper.js\"></scr' +\n      'ipt>\\n'\n    indexHtml +=\n      '    <scr' +\n      'ipt type=\"text/javascript\" src=\"https://coopmaths.fr/alea/assets/externalJs/moodle.scorm.js\"></scr' +\n      'ipt>\\n'\n    indexHtml += '  </head>\\n'\n    indexHtml += '  <body></body>\\n'\n    indexHtml += '</html>\\n'\n    zip.file('index.html', indexHtml)\n    zip.generateAsync({ type: 'blob' }).then(function (content) {\n      saveAs(content, 'mathalea.scorm.zip')\n    })\n  }\n\n  let contentGift = ''\n  let contentScorm = ''\n  /*\n    <organizations default=\"coopmaths.fr\">\n        <organization identifier=\"coopmaths.fr\" structure=\"hierarchical\">\n          <title>MathAlea</title>\n          <item identifier=\"MathAlea-Exo1\" isvisible=\"true\" identifierref=\"MathAlea-Exo1\">\n            <title>Dcomposer un nombre entier en produit de (petits) facteurs premiers</title>\n          </item>\n          <item identifier=\"MathAlea-Exo2\" isvisible=\"true\" identifierref=\"MathAlea-Exo2\">\n            <title>Utiliser la simple distributivit</title>\n          </item>\n        </organization>\n      </organizations>\n      <resources>\n        <resource identifier=\"MathAlea-Exo1\" type=\"webcontent\" adlcp:scormtype=\"sco\"\n          href=\"index.html#uuid=1eaf7&id=4A11-0&alea=3HRw\">\n          <dependency identifierref=\"COMMON_FILES\"/>\n        </resource>\n        <resource identifier=\"MathAlea-Exo2\" type=\"webcontent\" adlcp:scormtype=\"sco\"\n          href=\"index.html#uuid=71dd8&id=4L10&alea=9QsD\">\n          <dependency identifierref=\"COMMON_FILES\"/>\n        </resource>\n        <resource identifier=\"COMMON_FILES\" type=\"webcontent\" adlcp:scormtype=\"asset\">\n          <file href=\"index.html\" />\n        </resource>\n      </resources>\n  */\n  let exercices: TypeExercice[]\n\n  async function initExercices() {\n    contentGift = ''\n    let xmlScorm = document.implementation.createDocument('', '', null)\n    let xmlManifest = xmlScorm.createElement('manifest')\n    xmlManifest.setAttribute('identifier', 'MathAlea')\n    xmlManifest.setAttribute('version', '1.0')\n    xmlScorm.appendChild(xmlManifest)\n    /*<metadata>\n    <schema>ADL SCORM</schema>\n    <schemaversion>1.2</schemaversion>\n    </metadata>*/\n    let xmlMetadata = xmlScorm.createElement('metadata')\n    let xmlSchema = xmlScorm.createElement('schema')\n    xmlSchema.textContent = 'ADL SCORM'\n    let xmlSchemaVersion = xmlScorm.createElement('schemaversion')\n    xmlSchemaVersion.textContent = '1.2'\n    xmlMetadata.appendChild(xmlSchema)\n    xmlMetadata.appendChild(xmlSchemaVersion)\n    xmlManifest.appendChild(xmlMetadata)\n    let xmlOrganizations = xmlScorm.createElement('organizations')\n    xmlOrganizations.setAttribute('default', 'coopmaths.fr')\n    let xmlOrganization = xmlScorm.createElement('organization')\n    xmlOrganization.setAttribute('identifier', 'coopmaths.fr')\n    xmlOrganization.setAttribute('structure', 'hierarchical')\n    let xmlTitle = xmlScorm.createElement('title')\n    xmlTitle.textContent = 'MathAlea'\n    xmlOrganization.appendChild(xmlTitle)\n    xmlOrganizations.appendChild(xmlOrganization)\n    xmlManifest.appendChild(xmlOrganizations)\n    let xmlResources = xmlScorm.createElement('resources')\n    xmlManifest.appendChild(xmlResources)\n    mathaleaUpdateExercicesParamsFromUrl()\n    exercices = await mathaleaGetExercicesFromParams($exercicesParams)\n    let i = 0\n    for (const param of $exercicesParams) {\n      let paramUrl = ''\n      for (const key of Object.keys(param)) {\n        if (key === 'sup') {\n          paramUrl += `s\\\\=${param[key]}&`\n        } else if (key === 'sup2') {\n          paramUrl += `s2\\\\=${param[key]}&`\n        } else if (key === 'sup3') {\n          paramUrl += `s3\\\\=${param[key]}&`\n        } else if (key === 'sup4') {\n          paramUrl += `s4\\\\=${param[key]}&`\n        } else if (key === 'sup5') {\n          paramUrl += `s5\\\\=${param[key]}&`\n        } else if (key === 'nbQuestions') {\n          paramUrl += `n\\\\=${param[key]}&`\n        } else if (key !== 'alea' && key !== 'id') {\n          paramUrl += `${key}\\\\=${param[key]}&`\n        }\n      }\n      paramUrl = paramUrl.slice(0, -1)\n      let graine\n      if (aleaType === 'alea') {\n        graine = ' graine\\\\=\"-1\"'\n      } else if (aleaType === 'moodle') {\n        graine = ''\n      } else {\n        graine = ` graine\\\\=\"${param.alea}\" `\n      }\n      contentGift += `:: ${param.id} - ${exercices[i].titre} - ${exercices[i].nbQuestions} ${exercices[i].nbQuestions > 1 ? 'questions' : 'question'} ::\\n`\n      contentGift +=\n        '<script src\\\\=\"https\\\\:\\/\\/coopmaths.fr\\/alea\\/assets\\/externalJs\\/moodle.js\" type\\\\=\"module\"><\\/script>\\n'\n      contentGift += `<mathalea-moodle v=\"4\" url\\\\=\"${paramUrl}\"${showTitle ? '' : ' titre=\"false\"'}${graine}/>\\n`\n      contentGift += '{\\n'\n      contentGift +=\n        '=%100%100|*=%90%90|*=%83.33333%83.333|*=%80%80|*=%75%75|*=%66.66667%66.666|*=%60%60|*=%50%50|*=%40%40|*=%33.33333%33.333|*=%30%30|*=%25%25|*=%20%20|*=%16.66667%16.666|*=%14.28571%14.2857|*=%12.5%12.5|*=%11.11111%11.111|*=%10%10|*=%5%5|*=%0%0|*\\n'\n      contentGift +=\n        '####<script src\\\\=\"https\\\\:\\/\\/coopmaths.fr\\/alea\\/assets\\/externalJs\\/moodle.js\" type\\\\=\"module\"><\\/script>\\n'\n      contentGift += `<mathalea-moodle v=\"4\" url\\\\=\"${paramUrl}\"${showTitle ? '' : ' titre=\"false\"'}${graine} correction />\\n`\n      contentGift += '}\\n\\n'\n      let xmlItem = xmlScorm.createElement('item')\n      xmlItem.setAttribute('identifier', `MathAlea-Exo${i + 1}`)\n      xmlItem.setAttribute('isvisible', 'true')\n      xmlItem.setAttribute('identifierref', `MathAlea-Exo${i + 1}`)\n      let xmlTitle = xmlScorm.createElement('title')\n      xmlTitle.textContent = exercices[i].titre\n      xmlItem.appendChild(xmlTitle)\n      xmlOrganization.appendChild(xmlItem)\n      let xmlResource = xmlScorm.createElement('resource')\n      xmlResource.setAttribute('identifier', `MathAlea-Exo${i + 1}`)\n      xmlResource.setAttribute('type', 'webcontent')\n      xmlResource.setAttribute('adlcp:scormtype', 'sco')\n      xmlResource.setAttribute(\n        'href',\n        'index.html#' +\n          paramUrl.replaceAll('\\\\=', '=') +\n          (useAlea ? '' : '&alea=' + param.alea),\n      )\n      let xmlDependency = xmlScorm.createElement('dependency')\n      xmlDependency.setAttribute('identifierref', 'COMMON_FILES')\n      xmlResource.appendChild(xmlDependency)\n      xmlResources.appendChild(xmlResource)\n      i++\n    }\n    let xmlResource = xmlScorm.createElement('resource')\n    xmlResource.setAttribute('identifier', 'COMMON_FILES')\n    xmlResource.setAttribute('type', 'webcontent')\n    xmlResource.setAttribute('adlcp:scormtype', 'asset')\n    let xmlFile = xmlScorm.createElement('file')\n    xmlFile.setAttribute('href', 'index.html')\n    xmlResource.appendChild(xmlFile)\n    xmlResources.appendChild(xmlResource)\n    contentScorm = new XMLSerializer().serializeToString(xmlScorm)\n    let ident = ''\n    // Debut Beautify XML\n    // Remarque : il s'agit d'un code maison qui ne gre probablement pas tous les cas\n    //            mais suffit emplement ici\n    let dir = 1\n    contentScorm =\n      '<' +\n      contentScorm\n        .split('<')\n        .slice(1)\n        .reduce((a, x) => {\n          if (x[0] === '/') {\n            if (dir === 1) {\n              a += '<' + x\n            } else {\n              a += '\\n' + ident + '<' + x\n            }\n            ident = ident.slice(1)\n            dir = -1\n          } else {\n            ident += ' '\n            a += '\\n' + ident + '<' + x\n            dir = 1\n            if (x.includes('/>')) {\n              ident = ident.slice(1)\n              dir = -1\n            }\n          }\n          return a\n        })\n    // Fin Beautify XML\n    contentScorm = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n' + contentScorm\n  }\n\n  let aleaType = 'alea' // 'alea' | 'moodle' | 'graine'\n  let useAlea = true\n  let showTitle = true\n  $: {\n    aleaType\n    useAlea\n    showTitle\n    initExercices()\n  }\n\n  let tab = 'gift'\n</script>\n\n<main\n  class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas {$darkMode.isActive\n    ? 'dark'\n    : ''}\"\n>\n  <NavBar\n    subtitle=\"Moodle\"\n    subtitleType=\"export\"\n    handleLanguage=\"{() => {}}\"\n    locale=\"{$referentielLocale}\"\n  />\n  <div\n    class=\"flex flex-col h-full w-full bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n  >\n    <div\n      class=\"h-full w-full md:w-2/3 lg:w-3/5 flex flex-col px-4 pb-4 md:py-10 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark mx-auto\"\n    >\n      <!--\n      <div\n        class=\"flex flex-col md:flex-row justify-start px-4 py-4 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n      >\n        <h3\n          class=\"font-bold text-2xl text-coopmaths-struct dark:text-coopmathsdark-struct bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n        >\n          Choix du type d'export Moodle\n        </h3>\n      </div>\n      -->\n      <!-- Tabulations pour la prsentation -->\n      <ul\n        class=\"flex list-none flex-row flex-wrap border-b-0 pl-0 pt-0 bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas\"\n        role=\"tablist\"\n        data-te-nav-ref\n      >\n        <li role=\"presentation\" class=\"flex-grow basis-0 text-center\">\n          <a\n            id=\"tabs-gift-btn\"\n            href=\"#tabs-gift\"\n            class=\"relative block font-extrabold px-7 pb-3.5 pt-4 text-base uppercase leading-tight text-coopmaths-action bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas-darkest hover:isolate hover:bg-coopmaths-action focus:isolate data-[te-nav-active]:bg-coopmaths-canvas data-[te-nav-active]:text-coopmaths-struct dark:text-coopmathsdark-action dark:hover:bg-coopmathsdark-action dark:hover:bg-opacity-20 dark:data-[te-nav-active]:bg-coopmathsdark-canvas dark:data-[te-nav-active]:text-coopmathsdark-struct\n            {tab === 'gift' ? ' hover:bg-opacity-0' : ' hover:bg-opacity-10'}\"\n            data-te-toggle=\"pill\"\n            data-te-target=\"#tabs-gift\"\n            role=\"tab\"\n            aria-controls=\"tabs-gift\"\n            aria-selected=\"true\"\n            data-te-nav-active=\"\"\n            on:click=\"{() => {\n              tab = 'gift'\n            }}\"\n          >\n            Export Gift (Quiz)\n          </a>\n        </li>\n        <li role=\"presentation\" class=\"flex-grow basis-0 text-center\">\n          <a\n            id=\"tabs-scorm-btn\"\n            href=\"#tabs-scorm\"\n            class=\"relative block font-extrabold px-7 pb-3.5 pt-4 text-base uppercase leading-tight text-coopmaths-action bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas-darkest hover:isolate hover:bg-coopmaths-action focus:isolate data-[te-nav-active]:bg-coopmaths-canvas data-[te-nav-active]:text-coopmaths-struct dark:text-coopmathsdark-action dark:hover:bg-coopmathsdark-action dark:hover:bg-opacity-20 dark:data-[te-nav-active]:bg-coopmathsdark-canvas dark:data-[te-nav-active]:text-coopmathsdark-struct\n            {tab === 'scorm' ? ' hover:bg-opacity-0' : ' hover:bg-opacity-10'}\"\n            data-te-toggle=\"pill\"\n            data-te-target=\"#tabs-scorm\"\n            role=\"tab\"\n            aria-controls=\"tabs-scorm\"\n            aria-selected=\"false\"\n            on:click=\"{() => {\n              tab = 'scorm'\n            }}\"\n          >\n            Export SCORM\n          </a>\n        </li>\n        <li role=\"presentation\" class=\"flex-grow basis-0 text-center\">\n          <a\n            id=\"tabs-bookmarklet-btn\"\n            href=\"#tabs-bookmarklet\"\n            class=\"relative block font-extrabold px-7 pb-3.5 pt-4 text-base uppercase leading-tight text-coopmaths-action bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas-darkest hover:isolate hover:bg-coopmaths-action focus:isolate data-[te-nav-active]:bg-coopmaths-canvas data-[te-nav-active]:text-coopmaths-struct dark:text-coopmathsdark-action dark:hover:bg-coopmathsdark-action dark:hover:bg-opacity-20 dark:data-[te-nav-active]:bg-coopmathsdark-canvas dark:data-[te-nav-active]:text-coopmathsdark-struct\n            {tab === 'bookmarklet'\n              ? ' hover:bg-opacity-0'\n              : ' hover:bg-opacity-10'}\"\n            data-te-toggle=\"pill\"\n            data-te-target=\"#tabs-bookmarklet\"\n            role=\"tab\"\n            aria-controls=\"tabs-bookmarklet\"\n            aria-selected=\"false\"\n            on:click=\"{() => {\n              tab = 'bookmarklet'\n            }}\"\n          >\n            Marque-page magique\n          </a>\n        </li>\n      </ul>\n      <!-- Pages des rglages -->\n      <div class=\"pb-6 pt-4 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\">\n        <div\n          class=\"hidden opacity-100 transition-opacity duration-150 ease-linear data-[te-tab-active]:block\"\n          id=\"tabs-gift\"\n          role=\"tabpanel\"\n          aria-labelledby=\"tabs-gift\"\n          data-te-tab-active=\"\"\n        >\n          <div\n            class=\"flex px-6 py-2 font-light text-lg text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          >\n            <!-- DEBUT GIFT -->\n            <section\n              class=\"px-4 py-0 md:py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas w-full\"\n            >\n              <h1\n                class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Comment l'utiliser ?\n              </h1>\n\n              <p\n                class=\"text-coopmaths-corpus dark:text-coopmathsdark-corpus text-lg md:text-xl\"\n              >\n                MathALA vous permet de crer un fichier au format gift que vous\n                pourrez ensuite importer dans la banque de questions de votre\n                plateforme Moodle. Vous trouverez de plus amples informations\n                dans notre <a\n                  href=\"https://forge.apps.education.fr/coopmaths/mathalea/-/wikis/Utilisation-de-Mathalea-avec-Moodle\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  class=\"text-coopmaths-action dark:text-coopmathsdark-action\"\n                  >documentation</a\n                >.\n              </p>\n              <h1\n                class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Exportation\n              </h1>\n\n              <div class=\"flex flex-col justify-center items-center space-y-2\">\n                <div class=\"pl-4 pt-4\">\n                  <div\n                    class=\"pl-2 pb-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n                  >\n                    Alatoire\n                  </div>\n                  <FormRadio\n                    title=\"Type d'alatoire\"\n                    bind:valueSelected=\"{aleaType}\"\n                    labelsValues=\"{[\n                      {\n                        label:\n                          \"L'nonc change  chaque actualisation de la page\",\n                        value: 'alea',\n                      },\n                      {\n                        label:\n                          \"L'nonc change  chaque nouvelle tentative du test Moodle et est diffrente pour chaque lve\",\n                        value: 'moodle',\n                      },\n                      {\n                        label: \"Pas d'alatoire (utiliser l'nonc actuel')\",\n                        value: 'graine',\n                      },\n                    ]}\"\n                  />\n                  <div\n                    class=\"pl-2 pb-2 mt-2 font-bold text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n                  >\n                    Autres options\n                  </div>\n                  <ButtonToggleAlt\n                    title=\"{'Afficher le titre'}\"\n                    bind:value=\"{showTitle}\"\n                    explanations=\"{[\n                      \"Le titre de l'exercice sera affich\",\n                      \"Le titre de l'exercice ne sera pas affich\",\n                    ]}\"\n                  />\n                </div>\n                <button\n                  type=\"submit\"\n                  on:click=\"{downloadGift}\"\n                  class=\"p-2 rounded-xl text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n                >\n                  <i class=\"bx bx-download mr-2\"></i>Tlcharger le fichier gift\n                </button>\n              </div>\n              <!-- <button\n                  on:click={copyCode}\n                  class=\"p-2 rounded-xl text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n                >\n                Copier le code\n                </button> -->\n\n              <h1\n                class=\"mt-12 md:mt-8 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Code\n              </h1>\n              <pre\n                class=\"my-10 shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus dark:text-coopmathsdark-corpus p-4 w-full overflow-auto\">{contentGift}\n            </pre>\n            </section>\n            <!-- FIN GIFT -->\n          </div>\n        </div>\n        <div\n          class=\"hidden opacity-100 transition-opacity duration-150 ease-linear data-[te-tab-active]:block\"\n          id=\"tabs-scorm\"\n          role=\"tabpanel\"\n          aria-labelledby=\"tabs-scorm\"\n        >\n          <div\n            class=\"flex px-6 py-2 font-light text-lg text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          >\n            <!-- DEBUT SCORM -->\n            <section\n              class=\"px-4 py-0 md:py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas w-full\"\n            >\n              <h1\n                class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Comment l'utiliser ?\n              </h1>\n\n              <p\n                class=\"text-coopmaths-corpus dark:text-coopmathsdark-corpus text-lg md:text-xl\"\n              >\n                MathALA vous permet de crer un fichier au format SCORM que\n                vous pourrez ensuite importer dans votre cours Moodle. Vous\n                trouverez de plus amples informations dans notre <a\n                  href=\"https://forge.apps.education.fr/coopmaths/mathalea/-/wikis/Utilisation-de-Mathalea-avec-Moodle\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  class=\"text-coopmaths-action dark:text-coopmathsdark-action\"\n                  >documentation</a\n                >.\n              </p>\n              <h1\n                class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Exportation\n              </h1>\n\n              <div class=\"flex flex-col justify-center items-center space-y-2\">\n                <div class=\"pl-4 pt-4\">\n                  <ButtonToggleAlt\n                    title=\"{'Utiliser des exercices alatoires'}\"\n                    bind:value=\"{useAlea}\"\n                    explanations=\"{[\n                      'Chaque lve aura des exercices diffrents.',\n                      'Tous les lves auront le mme exercice',\n                    ]}\"\n                  />\n                </div>\n\n                <button\n                  type=\"submit\"\n                  on:click=\"{downloadScorm}\"\n                  class=\"p-2 rounded-xl text-coopmaths-canvas dark:text-coopmathsdark-canvas bg-coopmaths-action hover:bg-coopmaths-action-lightest dark:bg-coopmathsdark-action dark:hover:bg-coopmathsdark-action-lightest\"\n                >\n                  <i class=\"bx bx-download mr-2\"></i>Tlcharger le fichier\n                  SCORM\n                </button>\n              </div>\n              <h1\n                class=\"mt-12 md:mt-8 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Code\n              </h1>\n              <pre\n                class=\"my-10 shadow-md bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus dark:text-coopmathsdark-corpus p-4 w-full overflow-auto\">{contentScorm}</pre>\n            </section>\n            <!-- FIN SCORM -->\n          </div>\n        </div>\n        <div\n          class=\"hidden opacity-100 transition-opacity duration-150 ease-linear data-[te-tab-active]:block\"\n          id=\"tabs-bookmarklet\"\n          role=\"tabpanel\"\n          aria-labelledby=\"tabs-bookmarklet\"\n        >\n          <div\n            class=\"flex px-6 py-2 font-light text-lg text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light\"\n          >\n            <!-- DEBUT BOOKMARKLET -->\n            <section\n              class=\"px-4 py-0 md:py-10 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas w-full\"\n            >\n              <p\n                class=\"text-coopmaths-corpus dark:text-coopmathsdark-corpus text-lg md:text-xl\"\n              >\n                Le marque-page magique permet de crer des activits MathALA\n                (au format scorm) en un clic.<br />\n                <center\n                  ><img\n                    src=\"./assets/images/moodle-bookmarklet-demo.gif\"\n                    alt=\"Vido de dmonstration du marque-page magique\"\n                    style=\"height:400px;margin:10px;\"\n                  /></center\n                >\n              </p>\n              <h1\n                class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Installation du marque-page magique\n              </h1>\n              Glissez dposez le lien ci-dessous dans votre barre de favoris / marque\n              page :<br />\n              <!-- svelte-ignore a11y-invalid-attribute -->\n              <a\n                href=\"javascript:var MathAleaBookmarkletScript = document.createElement('script');MathAleaBookmarkletScript.type='text/javascript';MathAleaBookmarkletScript.src='https://coopmaths.fr/alea/assets/externalJs/moodle-bookmarklet.js';document.body.appendChild(MathAleaBookmarkletScript);void(0);\"\n                style=\"color:blue;text-decoration:underline;\"\n                >Activit MathALA</a\n              >\n\n              <center\n                ><img\n                  src=\"./assets/images/moodle-bookmarklet-installation.gif\"\n                  alt=\"Vido d'installation du marque-page magique\"\n                  style=\"margin:10px;border: 1px solid black;filter:drop-shadow(2px 4px 6px black);transform: scale(0.9) rotate(-5deg) translate(20px, 20px);\"\n                /></center\n              ><br />\n\n              <h1\n                class=\"mt-12 mb-4 text-center md:text-left text-coopmaths-struct dark:text-coopmathsdark-struct text-2xl md:text-4xl font-bold\"\n              >\n                Utilisation\n              </h1>\n\n              Pour utilisez le marque-page magique :\n              <ul style=\"list-style-type: square;margin-left:30px;\">\n                <li>Ouvrez la page d'un cours en mode dition.</li>\n                <li>\n                  Appuyez sur le bouton permettant d'ajouter une activit  une\n                  section.\n                </li>\n                <li>\n                  Lorsque le slecteur d'activit s'affiche, appuyez sur le\n                  marque-page magique.\n                </li>\n                <li>\n                  La fentre vous propose alors de choisir une ou plusieurs\n                  activits MathALA  ajouter  votre cours.\n                </li>\n                <li>\n                  Une fois les activits choisies, appuyez sur le bouton\n                  \"Ajouter\" pour les insrer dans votre cours.\n                </li>\n              </ul>\n              <strong\n                >Important : en raison d'un bug moodle, le calcul du score sera\n                incorrect dans le cas o plusieurs exercices ont t choisis. Il\n                faut donc pour l'instant se limiter  un exercice par activit\n                MathALA.</strong\n              ><br />\n              L'activit obtenue est une activit au format SCORM, le marque-page\n              ne fait que simplifier la cration de l'activit. Reportez-vous  la\n              <a\n                href=\"https://forge.apps.education.fr/coopmaths/mathalea/-/wikis/Utilisation-de-Mathalea-avec-Moodle/Export-Scorm\"\n                style=\"text-decoration:underline;\"\n                >documentation de l'export Scorm</a\n              > pour plus d'information.\n            </section>\n            <!-- FIN BOOKMARKLET -->\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <footer>\n    <Footer />\n  </footer>\n</main>\n\n<style>\n  footer {\n    margin-top: auto;\n  }\n</style>\n","import { exercicesParams, globalOptions } from './stores/generalStore'\nimport { get } from 'svelte/store'\nimport { mathaleaGetExercicesFromParams } from './mathalea'\nimport { buildMathAleaURL } from './components/urls'\n\nexport async function sendActivityParams() {\n  const exercices = []\n  const exoParams = get(exercicesParams)\n  const exo = await mathaleaGetExercicesFromParams(exoParams)\n  let i = 0\n  for (const param of exoParams) {\n    let paramUrl = ''\n    for (const key of Object.keys(param)) {\n      if (key === 'sup') {\n        paramUrl += `s=${param[key]}&`\n      } else if (key === 'sup2') {\n        paramUrl += `s2=${param[key]}&`\n      } else if (key === 'sup3') {\n        paramUrl += `s3=${param[key]}&`\n      } else if (key === 'sup4') {\n        paramUrl += `s4=${param[key]}&`\n      } else if (key === 'sup5') {\n        paramUrl += `s5=${param[key]}&`\n      } else if (key === 'nbQuestions') {\n        paramUrl += `n=${param[key]}&`\n      } else if (key !== 'alea' && key !== 'id') {\n        paramUrl += `${key}=${param[key]}&`\n      }\n    }\n    paramUrl = paramUrl.slice(0, -1)\n    exercices.push({\n      titre: exo[i].titre,\n      url: paramUrl,\n    })\n    i++\n  }\n  const options = get(globalOptions)\n  const url = buildMathAleaURL({\n    view: 'eleve',\n    mode: 'un_exo_par_page',\n    removeSeed: true,\n    recorder: 'Moodle',\n  }).toString()\n  console.info(url)\n  window.parent.postMessage(\n    {\n      exercices,\n      action: 'mathalea:activityParams',\n      url,\n      globalOptions: options,\n    },\n    '*',\n  )\n}\n","<script lang=\"ts\">\n  export let isBackToTopButtonVisible = false\n  export let backToTop: () => void\n</script>\n\n{#if isBackToTopButtonVisible}\n  <button\n    on:click=\"{backToTop}\"\n    type=\"button\"\n    data-te-ripple-init\n    data-te-ripple-color=\"light\"\n    class=\"!fixed bottom-5 right-5 rounded-full bg-transparent p-3 text-xl font-medium uppercase leading-tight text-coopmaths-action shadow-md transition duration-150 ease-in-out hover:text-coopmaths-action-lightest hover:shadow-lg focus:text-coopmaths-action-lightest focus:shadow-lg focus:outline-none focus:ring-0 active:text-coopmaths-action-lightest active:shadow-lg\"\n    id=\"btn-back-to-top\"\n  >\n    <i class=\"bx bx-chevrons-up\"></i>\n  </button>\n{/if}\n","<script lang=\"ts\">\n  import { flip } from 'svelte/animate'\n  import type { InterfaceParams } from '../../../../lib/types'\n  import Footer from '../../../Footer.svelte'\n  import Exercice from '../../../shared/exercice/Exercice.svelte'\n\n  export let exercicesParams: InterfaceParams[]\n  export let toggleSidenav: (open: boolean) => void\n</script>\n\n<div\n  id=\"exercisesWrapper\"\n  class=\"flex flex-col w-full md:h-full justify-between md:pl-4\"\n>\n  <div class=\"flex flex-col md:mt-9 xl:mt-0\">\n    {#each exercicesParams as paramsExercice, i (paramsExercice)}\n      <div id=\"exo{i}\" animate:flip=\"{{ duration: (d) => 30 * Math.sqrt(d) }}\">\n        <Exercice\n          {paramsExercice}\n          {toggleSidenav}\n          indiceExercice=\"{i}\"\n          indiceLastExercice=\"{exercicesParams.length - 1}\"\n          on:exerciseRemoved\n        />\n      </div>\n    {/each}\n  </div>\n  <div class=\"hidden md:flex items-center justify-center\">\n    <Footer />\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { exercicesParams } from '../../../lib/stores/generalStore'\n  export let text: string = ''\n  export let indice: number\n\n  function remove() {\n    exercicesParams.update((l) => [\n      ...l.slice(0, indice),\n      ...l.slice(indice + 1),\n    ])\n  }\n</script>\n\n<!--\n  @component\n  Chip ddi pour les exercices. Contient un bouton `x` qui permet de le retirer de la liste.\n\n  ### Paramtres\n\n  * `text` : titre du chip\n  * `indice` : propre position dans la liste de chips\n\n  ### Utilisation\n\n  ``tsx\n  <ChipExo text={id.title} {indice} />\n  ```\n -->\n\n<div\n  id=\"exo-{indice}\"\n  class=\"flex justify-center w-full items-center rounded-full bg-coopmaths-struct dark:bg-coopmathsdark-struct pl-1 pr-2 py-[1px] shadow-sm cursor-move\"\n>\n  <div\n    class=\"block w-10/12 px-1 text-center text-coopmaths-canvas dark:text-coopmathsdark-canvas text-xs text-ellipsis overflow-hidden whitespace-nowrap\"\n  >\n    {text.replaceAll('_', ' ')}\n  </div>\n  <button\n    class=\"ml-2 w-2/12 bg-transparent hover focus:outline-none cursor-pointer\"\n    on:click=\"{remove}\"\n  >\n    <i\n      class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-x font-semibold text-base\"\n    ></i>\n  </button>\n</div>\n\n<style>\n</style>\n","<script lang=\"ts\">\n  import Sortable from 'sortablejs'\n  import ChipExo from './ChipExo.svelte'\n  import {\n    exercicesParams,\n    moveExercice,\n  } from '../../../lib/stores/generalStore'\n  import { onMount } from 'svelte'\n  import {\n    uuidCount,\n    exercisesUuidRanking,\n  } from '../../../lib/components/counts'\n  import { getUniqueStringBasedOnTimeStamp } from '../../../lib/components/time'\n  import type { ChipContentType } from '../../../lib/types'\n  export let chipsListDisplayed: boolean\n  let listIdsForChips: ChipContentType[] = []\n  $: {\n    const lIFC: ChipContentType[] = []\n    let ranks: number[]\n    let counts: Record<string, number>\n    for (const [i, ex] of $exercicesParams.entries()) {\n      ranks = exercisesUuidRanking($exercicesParams)\n      counts = uuidCount($exercicesParams)\n      const insert: string = `${\n        counts[ex.uuid] > 1 ? ' [' + ranks[i] + ']' : ''\n      }`\n      const keyValue = getUniqueStringBasedOnTimeStamp(i.toString())\n      const obj: ChipContentType = {\n        ref: ex.id ?? ex.uuid,\n        title: `${ex.id ?? ex.uuid}${insert}`,\n        key: keyValue,\n      }\n      lIFC.push(obj)\n    }\n    listIdsForChips = lIFC\n  }\n  onMount(() => {\n    Sortable.create(document.getElementById('chips-list'), {\n      animation: 150,\n      // Erreur dans le linter : Parameter 'evt' implicitly has an 'any' type.\n      // Sortable tant crit en JavaScript on ne connait pas le type de `evt`.\n      // @ts-ignore\n      onEnd: (evt) => {\n        exercicesParams.update((l) => {\n          return moveExercice(l, evt.oldIndex, evt.newIndex)\n        })\n      },\n    })\n  })\n</script>\n\n<div class=\"w-full flex flex-col space-y-6\">\n  <div class=\"relative w-full flex flex-col\">\n    <button\n      class=\"absolute -right-3 -top-3\"\n      type=\"button\"\n      on:click=\"{() => {\n        chipsListDisplayed = false\n      }}\"\n    >\n      <i\n        class=\"bx bx-x text-2xl text-coopmaths-action hover:text-coopmaths-action-lightest\"\n      ></i>\n    </button>\n    <div class=\"text-coopmaths-struct font-semibold text-lg\">\n      Rorganisation des exercices\n    </div>\n    <div class=\"p-2 text-coopmaths-corpus-light text-sm font-extralight\">\n      Saisir un exercice et le dposer  la place souhaite.\n    </div>\n  </div>\n  <div\n    class=\"w-full grid justify-items-stretch place-content-stretch grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-7 xl:grid-cols-8 2xl:grid-cols-10 gap-2 p-0 items-center overflow-x-auto whitespace-nowrap\"\n    id=\"chips-list\"\n  >\n    {#each listIdsForChips as id, indice (id.key)}\n      <ChipExo text=\"{id.title}\" {indice} />\n    {/each}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import ChipsList from '../../../../shared/ui/ChipsList.svelte'\n  import { fly, blur } from 'svelte/transition'\n\n  export let reorderModalDisplayed: boolean\n</script>\n\n{#if reorderModalDisplayed}\n  <div\n    in:fly|global=\"{{ y: -1000 }}\"\n    out:blur|global\n    id=\"exoChipsList\"\n    class=\"z-[1090] fixed top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 w-2/3 flex flex-row justify-start items-center p-8 rounded-md shadow-2xl bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark p\"\n  >\n    <ChipsList bind:chipsListDisplayed=\"{reorderModalDisplayed}\" />\n  </div>\n{/if}\n","<script lang=\"ts\">\n  export let setupButtonsList = [\n    { bxName: 'bx-zoom-in' },\n    { bxName: 'bx-zoom-out' },\n    { bxName: 'bx-refresh' },\n    { bxName: 'bx-trash' },\n    { bxName: 'bx-fullScreen' },\n  ]\n  export let exportButtonsList = [\n    { bxName: 'bx-slideshow' },\n    { bxName: 'bxs-graduation' },\n  ]\n</script>\n\n<!--\n  @component\n  Container pour positionner les boutons de rglages gnraux de la liste des exercices\n\n  ### Paramtres\n\n  * `setupButtonsList` : liste d'icnes  afficher\n  * `exportButtonsList` : idem\n  * `barWidthPercentage` : pourcentage pour le calcul de la longueur de la barre...\n\n  ### Remarque\n\n  Les paramtres `setupButtonsList` et `exportButtonsList` ne sont utiles que pour calibrer la barre des boutons.\n  Dans les faits, la dclaration des boutons se fait dans\n\n  ```tsx\n  <div slot=\"setup-buttons\" ...>\n    boutons ici\n  </div>\n  ```\n  et dans\n\n  ```tsx\n  <div slot=\"export-buttons\" ...>\n    boutons ici\n  </div>\n  ```\n -->\n\n<div\n  class=\"{`${\n    $$props.class || ''\n  } flex flex-col w-full md:flex-row justify-start items-start sm:justify-center sm:items-center`}\"\n>\n  <div class=\"relative flex flex-col w-full\">\n    <div\n      class=\"w-full flex flex-col xl:flex-row md:pr-4 xl:!pl-96 justify-between items-center bg-coopmaths-canvas dark:bg-coopmathsdark-canvas md:space-y-0 space-y-4\"\n    >\n      <div id=\"setupButtonsBar\" class=\"flex\">\n        <slot name=\"setup-buttons\">\n          {#each setupButtonsList as button}\n            <i\n              class=\"bx bx-sm px-2 {button.bxName} hover:text-coopmaths-action-lightest text-coopmaths-action dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n            ></i>\n          {/each}\n        </slot>\n      </div>\n      {#if $$slots.input}\n        <div id=\"input\">\n          <slot name=\"input\" />\n        </div>\n      {/if}\n      {#if $$slots['export-buttons']}\n        <div id=\"exportButtonsBar\" class=\"xl:pr-6\">\n          <slot name=\"export-buttons\">\n            {#each exportButtonsList as button}\n              <i\n                class=\"bx bx-sm px-2 {button.bxName} hover:text-coopmaths-action-lightest text-coopmaths-action dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n              ></i>\n            {/each}\n          </slot>\n        </div>\n      {/if}\n    </div>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import TwoStatesIcon from '../../../../../../../components/shared/icons/TwoStatesIcon.svelte'\n\n  export let setAllInteractive: (isAllInteractive: boolean) => void\n  let isAllInteractive: boolean = false\n</script>\n\n<button\n  type=\"button\"\n  on:click=\"{() => {\n    isAllInteractive = !isAllInteractive\n    setAllInteractive(isAllInteractive)\n  }}\"\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"{isAllInteractive\n    ? \"Supprimer l'interactivit\"\n    : 'Tous les exercices en interactif'}\"\n>\n  <div class=\"px-2\">\n    <TwoStatesIcon isOnStateActive=\"{isAllInteractive}\" size=\"{7}\" />\n  </div>\n</button>\n","<script lang=\"ts\">\n  import ButtonIconTooltip from '../../../../../../shared/forms/ButtonIconTooltip.svelte'\n  export let reorderModalDisplayed: boolean\n</script>\n\n<ButtonIconTooltip\n  icon=\"bx-transfer text-3xl rotate-90\"\n  tooltip=\"Rorganisation\"\n  on:click=\"{() => {\n    reorderModalDisplayed = !reorderModalDisplayed\n  }}\"\n/>\n","<script lang=\"ts\">\n  import ButtonIconTooltip from '../../../../../../shared/forms/ButtonIconTooltip.svelte'\n\n  export let newDataForAll: () => void\n</script>\n\n<ButtonIconTooltip\n  icon=\"bx-refresh text-3xl\"\n  tooltip=\"Nouveaux noncs\"\n  on:click=\"{newDataForAll}\"\n/>\n","<script lang=\"ts\">\n  import ButtonIconTooltip from '../../../../../../shared/forms/ButtonIconTooltip.svelte'\n\n  export let trash: () => void\n</script>\n\n<ButtonIconTooltip\n  icon=\"bx-trash text-3xl\"\n  tooltip=\"Supprimer tous les exercices\"\n  on:click=\"{trash}\"\n/>\n","<script lang=\"ts\">\n  import ZoomButtons from './ZoomButtons.svelte'\n  import InteractivityButton from './InteractivityButton.svelte'\n  import ReorderButton from './ReorderButton.svelte'\n  import NewDataButton from './NewDataButton.svelte'\n  import TrashButton from './TrashButton.svelte'\n  import FullscreenButton from './FullscreenButton.svelte'\n\n  export let reorderModalDisplayed: boolean\n  export let zoomUpdate: (plusMinus: '+' | '-') => void\n  export let setAllInteractive: (isAllInteractive: boolean) => void\n  export let newDataForAll: () => void\n  export let trash: () => void\n  export let setFullScreen: (isFullScreen: boolean) => void\n</script>\n\n<ZoomButtons {zoomUpdate} />\n<InteractivityButton {setAllInteractive} />\n<ReorderButton bind:reorderModalDisplayed />\n<NewDataButton {newDataForAll} />\n<TrashButton {trash} />\n<FullscreenButton callback=\"{setFullScreen}\" />\n","<svg\n  width=\"28.995893\"\n  height=\"31.999998\"\n  viewBox=\"0 0 7.67183 8.4666661\"\n  version=\"1.1\"\n  id=\"svg-pdf-text-icon\"\n  class=\"{$$props.class}\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:svg=\"http://www.w3.org/2000/svg\"\n>\n  <defs id=\"defs504\"></defs>\n  <g id=\"layer1\" transform=\"translate(-0.39741871)\">\n    <path\n      d=\"M 0.39741874,0 V 8.466666 H 1.3535184 V 5.0799995 C 1.6990966,5.0684802 2.0446748,4.9417683 2.2635409,4.59619 2.516965,4.1930155 2.6667156,3.4903397 2.6667156,2.53424 2.6667156,1.5781402 2.516965,0.9100225 2.2635409,0.50684742 2.0101169,0.11519274 1.7451736,0 1.3650377,0 Z M 1.3535184,3.8128794 v -2.568798 c 0.1036735,0 0.2419047,0 0.2995011,0.1267121 0.092154,0.2073467 0.092154,0.7372339 0.092154,1.2095236 0,0.4722902 0,0.9100226 -0.092154,1.0943311 C 1.5954226,3.7898409 1.4456726,3.8128794 1.3535184,3.8128794 Z M 3.1735546,8.466666 h 0.9215418 c 0.7602722,0 1.0367347,-0.2995011 1.1864853,-0.7487527 C 5.4543708,7.2110652 5.4543708,5.897868 5.4543708,4.2390926 5.4543708,2.5803171 5.431332,1.5205444 5.2355045,0.87546438 5.0281577,0.23038547 4.7286565,0 3.9683845,0 H 3.1735546 Z M 4.1296543,7.2225845 V 1.2440814 c 0.1382312,0.01152 0.3110204,-0.02304 0.3455782,0.276463 0.057597,0.5183667 0.034559,1.3362352 0.034559,3.0756456 v 1.9813152 c 0,0.6796371 -0.2303856,0.6450793 -0.3801372,0.6450793 z M 8.0692488,1.2786395 V 0 H 6.0879338 V 8.466666 H 7.0440335 V 4.7804984 H 7.7351899 V 3.5018591 H 7.0440335 V 1.2786395 Z\"\n      id=\"text1\"\n      style=\"font-stretch:ultra-condensed;font-size:11.2889px;font-family:'League Gothic';-inkscape-font-specification:'League Gothic, Ultra-Condensed';text-align:center;letter-spacing:0px;word-spacing:0px;text-anchor:middle;stroke-width:3.06122;stroke-linecap:round;stroke-linejoin:round\"\n      aria-label=\"PDF\"\n    ></path>\n  </g>\n</svg>\n","<svg\n  width=\"32.035019\"\n  height=\"31.965853\"\n  viewBox=\"0 0 8.4759316 8.4576318\"\n  version=\"1.1\"\n  id=\"svg4191\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:svg=\"http://www.w3.org/2000/svg\"\n  class=\"{$$props.class}\"\n  fill=\"currentColor\"\n  stroke=\"currentColor\"\n>\n  <defs id=\"defs4188\"></defs>\n  <g id=\"layer1\" transform=\"translate(0.00463201,-0.00451693)\">\n    <g\n      id=\"g4703\"\n      transform=\"matrix(0.68088189,0,0,0.64722958,-14.592662,0.40513752)\"\n    >\n      <path\n        id=\"rect9846\"\n        style=\"display:inline;fill:none;stroke:currentColor;stroke-width:1.08479\"\n        d=\"M 21.967594,0.542395 H 33.331265 V 11.906066 H 21.967594 Z\"\n      ></path>\n      <path\n        style=\"display:inline;fill:currentColor;fill-opacity:1;stroke-width:0.353;stroke-dasharray:none\"\n        d=\"m 30.187147,10.138692 c -3.21818,-4.0175496 -3.01441,-3.9353796 -5.07458,-2.0463796 -4.03864,3.7030996 -4.28539,3.6763596 -0.9908,-0.10736 1.03241,-1.18568 1.8771,-2.22601 1.8771,-2.31183 0,-0.0858 -0.79128,-0.54447 -1.7584,-1.01921 -1.93433,-0.94953 -2.0473,-1.18716 -1.13073,-2.37828 l 0.62296,-0.80956 1.45065,1.05084 c 0.79785,0.57796 1.56133,1.22995 1.69663,1.44886 0.33319,0.53911 1.85035,-1.5541 2.36047,-3.25671996 0.27287,-0.91077 0.60202,-1.32803 1.0476,-1.32803 1.07062,0 0.77611,1.39994 -0.80291,3.81656996 -1.45263,2.22318 -1.45263,2.22318 -0.75445,2.99567 1.35314,1.49715 3.64953,5.2880896 3.54188,5.8470396 -0.0716,0.3719 -0.78625,-0.27974 -2.08542,-1.90161 z\"\n        id=\"path6447\"\n      ></path>\n    </g>\n  </g>\n</svg>\n","<svg\n  width=\"31.999998\"\n  height=\"31.999998\"\n  viewBox=\"0 2 32 28\"\n  version=\"1.1\"\n  id=\"svg2697\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:svg=\"http://www.w3.org/2000/svg\"\n  class=\"{$$props.class}\"\n  stroke=\"currentColor\"\n>\n  <g fill=\"none\" stroke=\"currentColor\">\n    <rect x=\"6\" y=\"2\" width=\"21\" height=\"28\" rx=\"4\" ry=\"4\" stroke-width=\"2\"\n    ></rect>\n    <path\n      transform=\"matrix(.075075 .00043984 -.00043984 .075075 -2.3679 -12.924)\"\n      d=\"m294.47 523.45c-9.0804 8.8134-45.575-17.77-58.101-15.977-12.527 1.7928-40.099 37.545-51.287 31.633-11.188-5.9125 2.8168-48.836-2.7592-60.195-5.576-11.359-48.099-26.535-45.933-39.002s47.316-12.412 56.396-21.225c9.0804-8.8134 10.372-53.945 22.899-55.738 12.527-1.7928 26.426 41.164 37.614 47.077s54.51-6.805 60.086 4.5544c5.576 11.359-30.984 37.853-33.149 50.321-2.1659 12.467 23.316 49.739 14.236 58.552z\"\n      stroke-width=\"15.984\"\n    ></path>\n    <path\n      transform=\"matrix(.031314 -.025224 .025224 .031314 2.3208 .20682)\"\n      d=\"m294.47 523.45c-9.0804 8.8134-45.575-17.77-58.101-15.977-12.527 1.7928-40.099 37.545-51.287 31.633-11.188-5.9125 2.8168-48.836-2.7592-60.195-5.576-11.359-48.099-26.535-45.933-39.002s47.316-12.412 56.396-21.225c9.0804-8.8134 10.372-53.945 22.899-55.738 12.527-1.7928 26.426 41.164 37.614 47.077s54.51-6.805 60.086 4.5544c5.576 11.359-30.984 37.853-33.149 50.321-2.1659 12.467 23.316 49.739 14.236 58.552z\"\n      stroke-width=\"24.87\"\n    ></path>\n  </g>\n</svg>\n","<svg\n  width=\"31.999998\"\n  height=\"31.999998\"\n  viewBox=\"0 0 8.4666661 8.4666661\"\n  version=\"1.1\"\n  id=\"svg2697\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:svg=\"http://www.w3.org/2000/svg\"\n  class=\"{$$props.class}\"\n  fill=\"currentColor\"\n>\n  <defs id=\"defs2694\"></defs>\n  <g id=\"layer1\">\n    <path\n      id=\"path5800\"\n      style=\"fill:currentColor;stroke:none;stroke-width:0.024561\"\n      d=\"M 5.6190408,1.3436103 C 3.1929106,1.6410426 2.0896442,1.8517723 -6.6666665e-8,3.0631178 L 0.01937674,3.1181452 l 0.1660648,0.00168 c -0.0151705,0.1672543 -0.0417532,0.580651 -0.00793,1.2022881 -0.2318563,0.6710048 -0.005861,1.1268667 0.20632167,1.622751 0.0336508,-0.51578 0.0301858,-1.0806985 -0.12822484,-1.6428984 -0.0331509,-0.6174618 -0.005861,-1.0234456 0.009137,-1.1813718 l 1.38524723,0.013274 a 6.3367299,6.3367299 0 0 0 0.041012,0.8119988 c 2.413e-4,7.41e-5 4.827e-4,1.465e-4 7.24e-4,2.465e-4 -0.019394,0.1136922 -0.029686,0.2337457 -0.029686,0.3610258 V 7.1230563 H 3.0168247 V 4.4640923 C 3.0166023,4.3152495 3.0333743,4.1870108 3.0661804,4.0780232 3.4148371,4.0207547 3.7437413,3.892485 4.0371069,3.6999667 4.2663963,3.8138486 4.3816797,4.0680313 4.3816797,4.4640923 v 2.658964 h 1.354546 V 4.4640923 C 5.7372083,3.9080313 5.9669011,3.6300947 6.425373,3.6302654 6.8838432,3.6304378 7.1130792,3.9083588 7.1130792,4.4640923 v 2.658964 H 8.4666667 V 4.3070919 C 8.466496,3.7267978 8.2649892,3.2877561 7.8621894,2.9899135 7.5078576,2.7238375 7.0286125,2.5907977 6.4244128,2.5907977 c -0.6608527,0 -1.1162405,0.1571004 -1.3661083,0.4713116 -0.066043,-0.071577 -0.1408956,-0.1345516 -0.2236867,-0.1898186 5e-5,-9.82e-5 1.207e-4,-1.982e-4 1.948e-4,-2.879e-4 C 4.6513449,2.6664276 4.2917878,2.3859638 4.2917878,2.3859638 L 5.636261,1.403525 Z\"\n    ></path>\n  </g>\n</svg>\n","<svg\n  width=\"49.081623mm\"\n  height=\"46.026386mm\"\n  viewBox=\"0 0 49.081623 46.026386\"\n  version=\"1.1\"\n  id=\"svg863\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:svg=\"http://www.w3.org/2000/svg\"\n  class=\"{$$props.class}\"\n  fill=\"currentColor\"\n  stroke=\"currentColor\"\n>\n  <defs id=\"defs860\"></defs>\n  <g id=\"layer1\" transform=\"translate(-61.956809,-97.69643)\">\n    <g id=\"g983\" transform=\"translate(-0.54081118,0.98680658)\">\n      <path\n        id=\"path4521\"\n        d=\"m 72.49762,104.7401 v 1.51567 11.08356 h 3.029274 v -9.56996 h 9.570475 v -3.02927 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"path4519\"\n        d=\"m 88.126642,104.7401 v 3.02927 h 1.737878 v -3.02927 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"path4517\"\n        d=\"m 92.894309,104.7401 v 3.02927 h 9.569961 v 9.56996 h 3.0272 V 104.7401 Z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"path4515\"\n        d=\"m 72.49762,120.36912 v 1.73787 h 3.029274 v -1.73787 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"path4513\"\n        d=\"m 102.46427,120.36912 v 1.73787 h 3.0272 v -1.73787 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"path4511\"\n        d=\"m 72.49762,125.13627 v 12.59974 h 12.599749 v -3.02927 h -9.570475 v -9.57047 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"path4509\"\n        d=\"m 102.46427,125.13627 v 9.57047 h -9.569961 v 3.02927 h 12.597161 v -12.59974 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <path\n        id=\"rect4493\"\n        d=\"m 88.126642,134.70674 v 3.02927 h 1.737878 v -3.02927 z\"\n        style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:0.918803;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-opacity:1;vector-effect:none;stroke:none;stroke-width:3.029;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate\"\n      ></path>\n      <text\n        xml:space=\"preserve\"\n        style=\"font-style:normal;font-weight:normal;font-size:47.1417px;line-height:1000%;font-family:Sans;letter-spacing:0px;word-spacing:0px;stroke:none;stroke-width:0.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"\n        x=\"73.021278\"\n        y=\"140.82944\"\n        id=\"text4529\"\n        transform=\"scale(1.0297607,0.9710994)\"\n        ><tspan\n          id=\"tspan4527\"\n          x=\"73.021278\"\n          y=\"140.82944\"\n          style=\"font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-family:Wingdings;-inkscape-font-specification:Wingdings;stroke-width:0.264583px\"\n          ></tspan\n        ></text\n      >\n    </g>\n  </g>\n</svg>\n","<script lang=\"ts\">\n  import PdfTextIcon from '../../../../../../../components/shared/icons/PdfTextIcon.svelte'\n  import AmcIcon from '../../../../../../../components/shared/icons/AmcIcon.svelte'\n  import AnkiIcon from '../../../../../../../components/shared/icons/AnkiIcon.svelte'\n  import MoodleIcon from '../../../../../../../components/shared/icons/MoodleIcon.svelte'\n  import type { VueType } from '../../../../../../../lib/types'\n  import ButtonActionInfo from '../../../../../../shared/forms/ButtonActionInfo.svelte'\n  import ButtonIconTooltip from '../../../../../../shared/forms/ButtonIconTooltip.svelte'\n  import QcmCamIcon from '../../../../../../shared/icons/QcmCamIcon.svelte'\n  import { exercicesParams } from '../../../../../../../lib/stores/generalStore'\n\n  export let handleExport: (vue: VueType) => void\n  export let exportQcmCam: () => Promise<void>\n  \n  $: hasExercices = $exercicesParams.length > 0\n</script>\n\n<ButtonIconTooltip\n  icon=\"bx-slideshow text-3xl\"\n  tooltip=\"Diaporama\"\n  on:click=\"{() => handleExport('diaporama')}\"\n/>\n<ButtonIconTooltip\n  icon=\"{'bx-link text-3xl'}\"\n  cornerIcon=\"bxs-graduation\"\n  cornerIconClass=\"text-coopmaths-action dark:text-coopmathsdark-action\"\n  tooltip=\"Lien pour les lves\"\n  on:click=\"{() => handleExport('confeleve')}\"\n/>\n<button\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"LaTeX\"\n  on:click=\"{() => handleExport('latex')}\"\n>\n  <PdfTextIcon\n    class=\"w-7 h-7 hover:fill-coopmaths-action-lightest fill-coopmaths-action dark:fill-coopmathsdark-action dark:hover:fill-coopmathsdark-action-lightest\"\n  />\n</button>\n<button\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"AMC\"\n  on:click=\"{() => handleExport('amc')}\"\n>\n  <AmcIcon\n    class=\"w-7 h-7 hover:text-coopmaths-action-lightest text-coopmaths-action dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n  />\n</button>\n<button\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"Anki\"\n  on:click=\"{() => handleExport('anki')}\"\n>\n  <AnkiIcon\n    class=\"w-7 h-7 hover:text-coopmaths-action-lightest text-coopmaths-action dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n  />\n</button>\n<button\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"Moodle\"\n  on:click=\"{() => handleExport('moodle')}\"\n>\n  <MoodleIcon\n    class=\"w-7 h-7 hover:text-coopmaths-action-lightest text-coopmaths-action dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n  />\n</button>\n<button\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"QCM Cam\"\n  on:click=\"{exportQcmCam}\"\n>\n  <QcmCamIcon\n    class=\"w-7 h-7 hover:text-coopmaths-action-lightest text-coopmaths-action dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest\"\n  />\n</button>\n\n<!-- Bouton valuation -->\n<button\n  class=\"tooltip tooltip-bottom tooltip-neutral\"\n  data-tip=\"{hasExercices ? 'valuation' : 'valuation (slectionnez des exercices)'}\"\n  on:click=\"{() => hasExercices && handleExport('evaluation')}\"\n  disabled=\"{!hasExercices}\"\n>\n  <i\n    class=\"bx bx-clipboard transition-colors text-3xl {hasExercices \n      ? 'text-red-600 hover:text-red-700 dark:text-red-500 dark:hover:text-red-600' \n      : 'text-gray-400 dark:text-gray-600 cursor-not-allowed'}\"\n  ></i>\n</button>\n\n<ButtonActionInfo\n  action=\"download\"\n  useCurrentUrl=\"{true}\"\n  fileName=\"mathAlea\"\n  successMessage=\"Tlchargement en cours\"\n  errorMessage=\"Erreur lors du tlchargement\"\n  icon=\"bxs-file-export text-2xl\"\n  tooltip=\"Fichier de redirection\"\n/>\n","<script lang=\"ts\">\n  import ButtonsDeck from '../../../../../shared/ui/ButtonsDeck.svelte'\n  import SetupButtons from './setupButtons/SetupButtons.svelte'\n  import ExportButtons from './exportButtons/ExportButtons.svelte'\n  import type { VueType } from '../../../../../../lib/types'\n\n  export let reorderModalDisplayed: boolean = false\n  export let zoomUpdate: (plusMinus: '+' | '-') => void\n  export let setAllInteractive: (isAllInteractive: boolean) => void\n  export let newDataForAll: () => void\n  export let trash: () => void\n  export let setFullScreen: (isFullScreen: boolean) => void\n  export let handleExport: (vue: VueType) => void\n  export let exportQcmCam: () => Promise<void>\n</script>\n\n<ButtonsDeck class=\"md:pl-10 flex md:flex\">\n  <div\n    slot=\"setup-buttons\"\n    class=\"flex flex-row justify-start items-center space-x-3 md:space-x-4\"\n  >\n    <SetupButtons\n      bind:reorderModalDisplayed\n      {zoomUpdate}\n      {setAllInteractive}\n      {newDataForAll}\n      {trash}\n      {setFullScreen}\n    />\n  </div>\n  <div\n    slot=\"export-buttons\"\n    class=\"flex flex-row justify-end items-center space-x-3 md:space-x-4\"\n  >\n    <ExportButtons {handleExport} {exportQcmCam} />\n  </div>\n</ButtonsDeck>\n","<script lang=\"ts\">\n  export let isSidenavOpened: boolean\n  export let isRecorder: boolean\n  export let toggleSidenav: (test: boolean) => void\n</script>\n\n<div\n  class=\"flex justify-center items-center absolute z-50 left-0\n     h-8 md:h-10\n     w-8 md:w-10\n    {isRecorder\n    ? `${isSidenavOpened ? 'translate-x-[400px]' : ' translate-x-0'} top-0 rounded-r-md transition-transform ease-in-out`\n    : 'bottom-0 rounded-t-md'}\n    bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n>\n  <button\n    type=\"button\"\n    data-te-sidenav-toggle-ref\n    data-te-target=\"#choiceSideMenuWrapper\"\n    aria-controls=\"#choiceSideMenuWrapper\"\n    aria-haspopup=\"true\"\n    on:click=\"{() => {\n      toggleSidenav(false)\n    }}\"\n  >\n    <i\n      class=\"bx\n        text-lg md:text-2xl\n        {isSidenavOpened ? 'bx-x' : 'bx-right-arrow-alt'}\n        text-coopmaths-action dark:text-coopmathsdark-action\n        hover:text-coopmaths-action-lightest hover:dark:text-coopmathsdark-action-lightest\"\n    ></i>\n  </button>\n</div>\n","<script lang=\"ts\">\n  import { mathaleaGenerateSeed } from '../../../lib/mathalea'\n\n  export let title: string = ''\n  export let placeholder: string = ''\n  export let showTitle: boolean = true\n  export let value: string = ''\n  export let isDisabled: boolean = false\n  export let inputID: string = mathaleaGenerateSeed()\n  export let classAddenda: string = ''\n</script>\n\n<!--\n  @component\n  Champ de saisie de texte\n\n  ### Paramtres\n\n  * `title` : titre du champ de texte (situ au dessus du champ de saisie)\n  * `placeholder` : texte de'invite pour le champ\n  * `showTitle` : flag permettant de dcider de l'affichage du titre au dessus du champ ou pas\n  * `value` : valeur du champ\n  * `isDisabled` : flag permettant de dsactiver le champ\n  * `inputID` : ID du champ\n  * `classAddenda` : lments de style  ajouter  ceux dj prsents ( voir [Tailwindd CSS](https://tailwindcss.com/docs/installation))\n\n  ### Exemple\n\n  ```tsx\n  <InputText\n    title=\"Importer les exercices d'une feuille lve\"\n    placeholder=\"Lien\"\n    bind:value={urlFeuilleEleve}\n    classAddenda=\"w-50\"\n  />\n  ```\n\n -->\n\n<div>\n  <label\n    class=\"font-light text-xs pr-4\n      {showTitle ? 'block' : 'hidden'}\n      {isDisabled\n      ? 'text-opacity-10 dark:text-opacity-10'\n      : 'text-opacity-100 dark:text-opacity-100'}\n      text-coopmaths-struct dark:text-coopmathsdark-struct\"\n    for=\"{inputID}\"\n  >\n    {title}\n  </label>\n  <input\n    type=\"text\"\n    id=\"{inputID}\"\n    name=\"{inputID}\"\n    disabled=\"{isDisabled}\"\n    bind:value\n    {placeholder}\n    class=\"block h-5 text-sm border-1\n      border-coopmaths-action dark:border-coopmathsdark-action\n      focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest\n      focus:outline-0 focus:ring-0 focus:border-1\n      bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\n      disabled:opacity-20\n      text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light {classAddenda}\"\n  />\n</div>\n","<script lang=\"ts\">\n  import ButtonIconTooltip from '../../../shared/forms/ButtonIconTooltip.svelte'\n  import ButtonTextAction from '../../../shared/forms/ButtonTextAction.svelte'\n  import InputText from '../../../shared/forms/InputText.svelte'\n  import ButtonsDeck from '../../../shared/ui/ButtonsDeck.svelte'\n\n  export let zoomUpdate: (plusMinus: '+' | '-') => void\n  export let newDataForAll: () => void\n  export let trash: () => void\n  export let buildUrlAndOpenItInNewTab: (type: 'usual' | 'eleve') => void\n  export let showSettingsDialog: () => void\n  export let importExercises: (urlFeuilleEleve: string) => void\n  export let isExercisesListEmpty: boolean\n  export let isCapytale: boolean\n  export let handleRecorder: () => void\n\n  let urlFeuilleEleve: string = ''\n</script>\n\n<nav\n  class=\"flex justify-between items-start w-full p-4\n    flex-col md:flex-row\n    mx-auto md:space-x-6\n    bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n>\n  <div\n    class=\"flex flex-row justify-start\n    md:items-end\n    space-x-0 md:space-x-2\"\n  >\n    <div\n      class=\"font-logo9 tracking-tighter font-black\n      text-5xl md:text-4xl\n      text-coopmaths-struct dark:text-coopmathsdark-struct\"\n    >\n      MathALA\n    </div>\n    <div\n      class=\"flex flex-row font-light text-sm\n      text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-lightest\"\n    >\n      <span class=\"font-light font-sans mr-1 tracking-normal\"> par </span>\n      <a\n        href=\"https://coopmaths.fr\"\n        target=\"_blank\"\n        rel=\"noreferrer\"\n        class=\"font-extrabold font-logo9 tracking-tighter\n          text-coopmaths-action dark:text-coopmathsdark-action\n          hover:text-coopmaths-action-lightest dark:hover:text-coopmathsdark-action-lightest\"\n      >\n        CoopMaths\n      </a>\n    </div>\n  </div>\n  <div class=\"w-full flex flex-row\">\n    <ButtonsDeck class=\"mt-4 md:mt-0\">\n      <div\n        slot=\"setup-buttons\"\n        class=\"flex flex-row justify-center items-center space-x-4\"\n      >\n        <ButtonIconTooltip\n          icon=\"bx-zoom-out text-3xl\"\n          tooltip=\"Rduire la taille du texte\"\n          on:click=\"{() => zoomUpdate('-')}\"\n        />\n        <ButtonIconTooltip\n          icon=\"bx-zoom-in text-3xl\"\n          tooltip=\"Augmenter la taille du texte\"\n          on:click=\"{() => zoomUpdate('+')}\"\n        />\n        <ButtonIconTooltip\n          icon=\"bx-refresh text-3xl\"\n          tooltip=\"Nouveaux noncs\"\n          on:click=\"{newDataForAll}\"\n        />\n        <ButtonIconTooltip\n          icon=\"bx-trash text-3xl\"\n          tooltip=\"Supprimer tous les exercicess\"\n          on:click=\"{trash}\"\n        />\n      </div>\n      <div slot=\"input\" class=\"flex flex-row items-center space-x-4\">\n        <InputText\n          title=\"Importer les exercices d'une feuille lve\"\n          placeholder=\"Lien\"\n          bind:value=\"{urlFeuilleEleve}\"\n          classAddenda=\"w-50\"\n        />\n        <ButtonTextAction\n          class=\"text-sm py-1 px-2 rounded-md h-7\"\n          text=\"Ajouter\"\n          disabled=\"{urlFeuilleEleve === ''}\"\n          on:click=\"{() => importExercises(urlFeuilleEleve)}\"\n        />\n      </div>\n      <div\n        slot=\"export-buttons\"\n        class=\"flex flex-row justify-center items-center space-x-4\"\n      >\n        {#if !isCapytale}\n          <ButtonTextAction\n            class=\"text-sm py-1 px-2 rounded-md h-7\"\n            text=\"Valider\"\n            disabled=\"{isExercisesListEmpty}\"\n            on:click=\"{handleRecorder}\"\n          />\n        {/if}\n        {#if isCapytale}\n          <ButtonIconTooltip\n            icon=\"bx-cog text-3xl\"\n            tooltip=\"Rgler l'affichage du mode lve\"\n            disabled=\"{isExercisesListEmpty}\"\n            on:click=\"{showSettingsDialog}\"\n          />\n        {/if}\n        <div>\n          <ButtonIconTooltip\n            icon=\"bx-log-out bx-rotate-180\"\n            tooltip=\"Rejoindre MathALA\"\n            class=\"text-3xl\"\n            disabled=\"{isExercisesListEmpty}\"\n            on:click=\"{() => {\n              buildUrlAndOpenItInNewTab('usual')\n            }}\"\n          />\n        </div>\n      </div>\n    </ButtonsDeck>\n  </div>\n</nav>\n","<script lang=\"ts\">\n  import NavBar from '../../../../../components/shared/header/NavBar.svelte'\n  import ModalReorder from './ModalReorder.svelte'\n  import HeaderButtons from './headerButtons/HeaderButtons.svelte'\n  import SideMenuWrapper from './SideMenuWrapper.svelte'\n  import type { VueType } from '../../../../../lib/types'\n  import type { Language } from '../../../../../lib/types/languages'\n  import NavBarRecorder from '../../capytale/NavBarRecorder.svelte'\n\n  export let isExerciseDisplayed: boolean\n  export let isNavBarVisible: boolean\n  export let zoomUpdate: (plusMinus: '+' | '-') => void\n  export let setAllInteractive: (isAllInteractive: boolean) => void\n  export let newDataForAll: () => void\n  export let trash: () => void\n  export let setFullScreen: (isFullScreen: boolean) => void\n  export let handleExport: (vue: VueType) => void\n  export let handleRecorder: () => void\n  export let locale: Language\n  export let handleLanguage: (lang: string) => void\n  export let isCapytale: boolean\n  export let isRecorder: boolean\n  export let buildUrlAndOpenItInNewTab: (type: 'usual' | 'eleve') => void\n  export let showSettingsDialog: () => void\n  export let importExercises: (urlFeuilleEleve: string) => void\n  export let isExercisesListEmpty: boolean\n  export let isSidenavOpened: boolean\n  export let toggleSidenav: (test: boolean) => void\n  export let exportQcmCam: () => Promise<void>\n\n  let reorderModalDisplayed: boolean\n</script>\n\n<header\n  class=\"flex flex-col scrollbar-hide w-full\n  md:sticky md:top-0 md:z-50\n  bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n>\n  {#if isRecorder}\n    <div\n      id=\"headerCapytale\"\n      class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas print-hidden\"\n    >\n      <NavBarRecorder\n        {zoomUpdate}\n        {newDataForAll}\n        {trash}\n        {buildUrlAndOpenItInNewTab}\n        {showSettingsDialog}\n        {importExercises}\n        {isExercisesListEmpty}\n        {isCapytale}\n        {handleRecorder}\n      />\n    </div>\n  {:else}\n    <!-- Entte -->\n    {#if isNavBarVisible}\n      <div\n        id=\"headerStart\"\n        class=\"bg-coopmaths-canvas dark:bg-coopmathsdark-canvas print-hidden\"\n      >\n        <NavBar\n          subtitle=\"Conception de document\"\n          subtitleType=\"design\"\n          {locale}\n          {handleLanguage}\n        />\n      </div>\n    {/if}\n    <!-- Barre de boutons si non-smartphone  -->\n    <div\n      class=\"flex xl:h-[50px] md:h-[100px]\"\n    >\n      <div\n        class=\"relative w-full flex flex-col justify-center items-center bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n        id=\"barre-boutons\"\n      >\n        <SideMenuWrapper {isRecorder} {isSidenavOpened} {toggleSidenav} />\n        <HeaderButtons\n          bind:reorderModalDisplayed\n          {zoomUpdate}\n          {setAllInteractive}\n          {newDataForAll}\n          {trash}\n          {setFullScreen}\n          {handleExport}\n          {exportQcmCam}\n        />\n      </div>\n    </div>\n  {/if}\n</header>\n\n<ModalReorder {reorderModalDisplayed} />\n","<script lang=\"ts\">\n  import type { CanOptions } from '../../../../../lib/types/can'\n  import ButtonToggleAlt from '../../../../shared/forms/ButtonToggleAlt.svelte'\n  import FormRadio from '../../../../shared/forms/FormRadio.svelte'\n  import InputNumber from '../../../../shared/forms/InputNumber.svelte'\n  import InputText from '../../../../shared/forms/InputText.svelte'\n\n  export let canOptions: CanOptions\n  export let toggleCan: () => void\n</script>\n\n<div\n  class=\"pl-2 pb-2 font-light text-2xl\ntext-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n  Course aux nombres\n</div>\n<div class=\"flex flex-row justify-start items-center px-4\">\n  <div\n    class=\"flex flex-col items-start justify-start space-y-2 text-sm font-light\n    text-coopmaths-corpus-light dark:text-coopmathsdark-corpus\n    {canOptions.isChoosen\n      ? 'text-opacity-100 dark:text-opacity-100'\n      : 'text-opacity-10 dark:text-opacity-10'}\"\n  >\n    <ButtonToggleAlt\n      title=\"{'Format CAN'}\"\n      class=\"text-opacity-100 dark:text-opacity-100\"\n      id=\"{'config-eleve-format-can-toggle'}\"\n      bind:value=\"{canOptions.isChoosen}\"\n      on:toggle=\"{toggleCan}\"\n      explanations=\"{[\n        'Les questions seront poses les unes  la suite des autres en temps limit.',\n        'Chaque exercice sera dans un onglet diffrent',\n      ]}\"\n    />\n    <div class=\"flex justify-start flex-row items-center space-x-2\">\n      <div>Dure :</div>\n      <InputNumber\n        id=\"config-eleve-can-nb-questions-input\"\n        bind:value=\"{canOptions.durationInMinutes}\"\n        isDisabled=\"{!canOptions.isChoosen}\"\n      />\n      <div>\n        minute{canOptions.durationInMinutes !== undefined &&\n        canOptions.durationInMinutes > 1\n          ? 's'\n          : ''}.\n      </div>\n    </div>\n    <div class=\"flex justify-start flex-row items-center space-x-2\">\n      <div>Sous-titre :</div>\n      <InputText\n        inputID=\"config-eleve-can-duration-input\"\n        bind:value=\"{canOptions.subTitle}\"\n        isDisabled=\"{!canOptions.isChoosen}\"\n      />\n    </div>\n    <ButtonToggleAlt\n      title=\"{'Accs aux solutions'}\"\n      id=\"{'config-eleve-solutions-can-toggle'}\"\n      bind:value=\"{canOptions.solutionsAccess}\"\n      isDisabled=\"{!canOptions.isChoosen}\"\n      explanations=\"{[\n        'Les lves auront accs aux solutions dans le format dfini ci-dessous.',\n        \"Les lves n'auront pas accs aux solutions.\",\n      ]}\"\n    />\n    <FormRadio\n      title=\"can-solutions-config\"\n      bind:valueSelected=\"{canOptions.solutionsMode}\"\n      isDisabled=\"{!canOptions.isChoosen || !canOptions.solutionsAccess}\"\n      labelsValues=\"{[\n        {\n          label: 'Solutions rassembles  la fin.',\n          value: 'gathered',\n        },\n        {\n          label: 'Solutions avec les questions.',\n          value: 'split',\n        },\n      ]}\"\n    />\n  </div>\n</div>\n","<script lang=\"ts\">\n  import type { InterfaceGlobalOptions } from '../../../../../lib/types'\n  import type { CanOptions } from '../../../../../lib/types/can'\n  import ButtonToggle from '../../../../shared/forms/ButtonToggle.svelte'\n\n  export let globalOptions: InterfaceGlobalOptions\n  export let canOptions: CanOptions\n</script>\n\n<div\n  class=\"pl-2 pb-2 font-light text-2xl\n  text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n  Correction\n</div>\n<div class=\"flex flex-row justify-start items-center px-4\">\n  <ButtonToggle\n    isDisabled=\"{canOptions.isChoosen}\"\n    titles=\"{['Accs aux corrections', 'Pas de corrections']}\"\n    bind:value=\"{globalOptions.isSolutionAccessible}\"\n  />\n</div>\n","<script lang=\"ts\">\n  import type { InterfaceGlobalOptions } from '../../../../../lib/types'\n  import ButtonToggle from '../../../../shared/forms/ButtonToggle.svelte'\n\n  export let globalOptions: InterfaceGlobalOptions\n</script>\n\n<div\n  class=\"pl-2 pb-2 font-light text-2xl\ntext-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n  Affichage des titres\n</div>\n<div class=\"flex flex-row justify-start items-center px-4\">\n  <ButtonToggle\n    titles=\"{['Tous les titres sont affichs', 'Tous les titres sont masqus']}\"\n    bind:value=\"{globalOptions.isTitleDisplayed}\"\n  />\n</div>\n","<script lang=\"ts\">\n  import type { InterfaceGlobalOptions } from '../../../../../lib/types'\n  import ButtonToggle from '../../../../shared/forms/ButtonToggle.svelte'\n\n  export let globalOptions: InterfaceGlobalOptions\n</script>\n\n<div\n  class=\"pl-2 pb-2 font-light text-2xl\n  text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n  Donnes\n</div>\n<div class=\"text-sm font-extralight\">Tous les lves auront des pages :</div>\n<div class=\"flex flex-row justify-start items-center px-4\">\n  <ButtonToggle\n    titles=\"{['diffrentes', 'identiques']}\"\n    bind:value=\"{globalOptions.isDataRandom}\"\n  />\n</div>\n","<script lang=\"ts\">\n  import ButtonToggle from '../../../../shared/forms/ButtonToggle.svelte'\n  import FormRadio from '../../../../shared/forms/FormRadio.svelte'\n\n  export let setInteractive: string = '2'\n  export let oneShot: boolean = false\n  export let isDisabled: boolean\n  export let setInteractivity: (value: string) => void\n</script>\n\n<div\n  class=\"pl-2 pb-2 font-light text-2xl\n  text-coopmaths-struct-light dark:text-coopmathsdark-struct-light\"\n>\n  Interactivit\n</div>\n<FormRadio\n  title=\"Interactif\"\n  bind:valueSelected=\"{setInteractive}\"\n  {isDisabled}\n  on:newvalue=\"{() => setInteractivity(setInteractive)}\"\n  labelsValues=\"{[\n    { label: 'Laisser tel quel', value: '2' },\n    { label: 'Tout interactif', value: '1' },\n    { label: \"Pas d'interactivit\", value: '0' },\n  ]}\"\n/>\n<div class=\"pl-2 pt-2\">\n  <ButtonToggle\n    titles=\"{[\n      'Les lves peuvent rpondre une seule fois',\n      'Les lves peuvent rpondre plusieurs fois',\n    ]}\"\n    bind:value=\"{oneShot}\"\n  />\n</div>\n","<script lang=\"ts\">\n  import type { InterfaceGlobalOptions } from '../../../../../lib/types'\n  import type { CanOptions } from '../../../../../lib/types/can'\n  import ButtonTextAction from '../../../../shared/forms/ButtonTextAction.svelte'\n  import BasicClassicModal from '../../../../shared/modal/BasicClassicModal.svelte'\n  import ModalCapytalSettingsCan from './ModalCapytalSettingsCAN.svelte'\n  import ModalCapytalSettingsCorrection from './ModalCapytalSettingsCorrection.svelte'\n  import ModalCapytalSettingsTitles from './ModalCapytalSettingsTitles.svelte'\n  import ModalCapytalSettingsData from './ModalCapytalSettingsData.svelte'\n  import ModalCapytalSettingsInteractivity from './ModalCapytalSettingsInteractivity.svelte'\n\n  export let isSettingsDialogDisplayed = false\n  export let globalOptions: InterfaceGlobalOptions\n  export let canOptions: CanOptions\n  export let toggleCan: () => void\n  export let buildUrlAndOpenItInNewTab: (status: 'eleve' | 'usual') => void\n  export let updateParams: (params: {\n    globalOptions: InterfaceGlobalOptions\n    canOptions: CanOptions\n  }) => void\n\n  const params = {\n    globalOptions,\n    canOptions,\n  }\n\n  $: if (globalOptions || canOptions) {\n    params.globalOptions = globalOptions\n    params.canOptions = canOptions\n  }\n\n  function setInteractivity(value: string) {\n    params.globalOptions.setInteractive = value\n  }\n</script>\n\n<BasicClassicModal\n  bind:isDisplayed=\"{isSettingsDialogDisplayed}\"\n  on:close=\"{() => updateParams(params)}\"\n>\n  <div slot=\"header\">Rglages de l'affichage des exercices</div>\n  <div\n    slot=\"content\"\n    class=\"pt-2 pl-2 grid grid-flow-row text-justify\n      lg:grid-cols-2 md:gap-4 font-light\"\n  >\n    <div class=\"pb-2\">\n      <ModalCapytalSettingsInteractivity\n        setInteractive=\"{params.globalOptions.setInteractive ?? '2'}\"\n        {setInteractivity}\n        bind:oneShot=\"{params.globalOptions.oneShot}\"\n        bind:isDisabled=\"{params.canOptions.isChoosen}\"\n      />\n    </div>\n    <div class=\"pb-2\">\n      <ModalCapytalSettingsCan\n        bind:canOptions=\"{params.canOptions}\"\n        bind:toggleCan\n      />\n    </div>\n    <div class=\"pb-2\">\n      <ModalCapytalSettingsData bind:globalOptions=\"{params.globalOptions}\" />\n    </div>\n    <div class=\"pb-2\">\n      <ModalCapytalSettingsTitles bind:globalOptions=\"{params.globalOptions}\" />\n    </div>\n    <div class=\"pb-2\">\n      <ModalCapytalSettingsCorrection\n        bind:globalOptions=\"{params.globalOptions}\"\n        bind:canOptions=\"{params.canOptions}\"\n      />\n    </div>\n  </div>\n  <div slot=\"footer\" class=\"flex flex-row justify-end space-x-4 w-full\">\n    <div class=\"pt-4 pb-8 px-4\">\n      <ButtonTextAction\n        class=\"text-sm py-1 px-2 rounded-md h-7\"\n        on:click=\"{() => {\n          isSettingsDialogDisplayed = false\n        }}\"\n        text=\"Valider\"\n      />\n    </div>\n    <div class=\"pt-4 pb-8 px-4\">\n      <ButtonTextAction\n        class=\"text-sm py-1 px-2 rounded-md h-7\"\n        on:click=\"{() => {\n          buildUrlAndOpenItInNewTab('eleve')\n        }}\"\n        text=\"Aperu\"\n      />\n    </div>\n  </div>\n</BasicClassicModal>\n","<svg\n  width=\"92.762665\"\n  height=\"94.176659\"\n  viewBox=\"0 0 24.543455 24.917574\"\n  version=\"1.1\"\n  id=\"svg5\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:svg=\"http://www.w3.org/2000/svg\"\n  class=\"{$$props.class}\"\n  fill=\"currentColor\"\n>\n  <defs id=\"defs2\"></defs>\n  <g id=\"layer1\" transform=\"translate(-0.95743787,-0.77037907)\">\n    <path\n      id=\"path2\"\n      style=\"fill:currentColor;stroke-width:0;stroke-linecap:round;stroke-linejoin:round\"\n      d=\"m 24.068311,13.229166 c 0,0.389031 1.49792,1.780325 1.430365,2.163446 -0.06755,0.38312 -1.950989,1.178191 -2.084046,1.54376 -0.133056,0.365569 0.798677,2.185277 0.604162,2.522188 -0.194515,0.33691 -2.236295,0.439859 -2.486359,0.737874 -0.250065,0.298015 0.0031,2.326652 -0.294913,2.576717 -0.298015,0.250064 -2.251871,-0.351526 -2.588782,-0.15701 -0.33691,0.194515 -0.792847,2.187399 -1.158416,2.320455 -0.365569,0.133057 -1.995838,-1.100511 -2.378958,-1.032956 -0.383121,0.06755 -1.493167,1.784313 -1.882198,1.784313 -0.389031,0 -1.499077,-1.716759 -1.882198,-1.784313 -0.38312,-0.06755 -2.0133888,1.166013 -2.3789581,1.032956 C 8.6024405,24.80354 8.1465042,22.810656 7.8095937,22.616141 7.4726831,22.421625 5.518827,23.023215 5.2208121,22.773151 4.9227972,22.523086 5.1759636,20.494449 4.9258995,20.196434 4.6758353,19.898419 2.6340554,19.79547 2.43954,19.458559 2.2450246,19.121649 3.1767581,17.301941 3.0437017,16.936372 2.9106454,16.570803 1.0272105,15.775732 0.95965602,15.392612 0.89210154,15.009491 2.3900213,13.618197 2.3900213,13.229166 c 0,-0.389031 -1.49791974,-1.780325 -1.43036525,-2.163446 C 1.0272105,10.6826 2.9106454,9.8875295 3.0437017,9.5219602 3.1767581,9.1563909 2.2450247,7.336683 2.43954,6.9997725 2.6340554,6.662862 4.6758353,6.559913 4.9258995,6.2618981 5.1759636,5.9638832 4.9227973,3.9352456 5.2208122,3.6851815 5.518827,3.4351173 7.4726831,4.0367067 7.8095937,3.8421914 8.1465042,3.647676 8.6024406,1.6547922 8.96801,1.5217358 c 0.3655693,-0.1330563 1.995838,1.100511 2.378958,1.0329565 0.383121,-0.067554 1.493167,-1.78431323 1.882198,-1.78431323 0.389031,0 1.499077,1.71675873 1.882198,1.78431323 0.38312,0.067554 2.013389,-1.1660128 2.378958,-1.0329564 0.36557,0.1330563 0.821506,2.1259401 1.158416,2.3204555 0.336911,0.1945154 2.290767,-0.407074 2.588782,-0.1570099 0.298015,0.2500642 0.04485,2.2787018 0.294913,2.5767166 0.250064,0.2980149 2.291844,0.400964 2.486359,0.7378745 0.194515,0.3369105 -0.737218,2.1566183 -0.604162,2.5221876 0.133057,0.3655694 2.016492,1.1606398 2.084046,1.5437598 0.06755,0.383121 -1.430365,1.774415 -1.430365,2.163446 z\"\n    ></path>\n  </g>\n</svg>\n","<script lang=\"ts\">\n  import type { AppTierce } from '../../../lib/types/referentiels'\n  import StarIcon from '../icons/StarIcon.svelte'\n  import { exercicesParams } from '../../../lib/stores/generalStore'\n\n  export let application: AppTierce = {\n    title: 'Titre',\n    presentation: ' blabla',\n    imgPath: 'images/apps/appDefault.png',\n    uuid: 'theUuid',\n  }\n  export let reversed: boolean = false\n  export let selected: boolean = false\n  export let loadImages: boolean = true // Pour viter le chargement des images lorsque la carte n'est pas visible  l'cran\n\n  let listeCodes: string[]\n  // on compte ractivement le nombre d'occurences\n  // de la ressource dans la liste des slectionns\n  $: {\n    listeCodes = []\n    for (const entry of $exercicesParams) {\n      listeCodes.push(entry.uuid)\n    }\n    listeCodes = listeCodes\n  }\n\n  function addAppToList() {\n    exercicesParams.update((list) => [...list, { uuid: application.uuid }])\n  }\n  const isPresent = (code: string) => {\n    return code === application.uuid\n  }\n  function removeAppFromList() {\n    const matchingIndex = listeCodes.findIndex(isPresent)\n    exercicesParams.update((list) => [\n      ...list.slice(0, matchingIndex),\n      ...list.slice(matchingIndex + 1),\n    ])\n  }\n  function handelSelection() {\n    selected = !selected\n    if (selected) {\n      addAppToList()\n    } else {\n      removeAppFromList()\n    }\n  }\n</script>\n\n<button\n  type=\"button\"\n  class=\"relative block w-full rounded-lg bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark shadow-lg border border-coopmaths-canvas-darkest dark:border-coopmathsdark-canvas-darkest\"\n  on:click=\"{handelSelection}\"\n>\n  <div class=\"{reversed ? 'hide' : 'block'} \">\n    {#if loadImages}\n      <img\n        src=\"{application.imgPath}\"\n        alt=\"{application.title} image\"\n        class=\"object-fill rounded-t-lg\"\n      />\n    {:else}\n      <div class=\"h-48 bg-gray-200 rounded-t-lg flex items-center justify-center\">\n        <span class=\"text-gray-500\">Image  charger...</span>\n      </div>\n    {/if}\n  </div>\n  <div class=\"p-2 text-left\">\n    <h5\n      class=\"mb-2 text-lg font-bold leading-tight text-coopmaths-struct dark:text-coopmathsdark-struct\"\n    >\n      {application.title}\n    </h5>\n    <p\n      class=\"max-h-24 min-h-24 h-24 text-sm text-ellipsis overflow-hidden mb-4 font-light text-coopmaths-corpus dark:text-coopmathsdark-corpus leading-tight\"\n    >\n      {application.presentation}\n    </p>\n  </div>\n  <div class=\"absolute -bottom-4 left-1/2 -translate-x-1/2\">\n    <div\n      class=\"rounded-full h-8 w-8 bg-coopmaths-action text-coopmaths-canvas flex justify-center items-center hover:animate-pulse\"\n    >\n      <i class=\"bx bx-sm {selected ? 'bx-minus' : 'bx-plus'}\"></i>\n    </div>\n  </div>\n  <div class=\"absolute top-3 right-3 rotate-frac\">\n    <div class=\"relative\">\n      <StarIcon\n        class=\"{selected\n          ? 'container'\n          : 'hidden'} top-0 left-0 h-12 w-12 text-coopmaths-warn-800 dark:text-coopmathsdark-warn\"\n      />\n      <i\n        class=\"{selected\n          ? 'container'\n          : 'hidden'} absolute top-1 left-[0.1rem] bx bx-check bx-md text-coopmaths-canvas dark:text-coopmathsdark-canvas\"\n      ></i>\n    </div>\n  </div>\n</button>\n\n<style>\n  @-webkit-keyframes rotation {\n    0%,\n    70% {\n      -webkit-transform: rotate(0deg);\n    }\n    80%,\n    100% {\n      -webkit-transform: rotate(360deg);\n    }\n  }\n  @keyframes rotation {\n    0%,\n    70% {\n      transform: rotate(0deg);\n    }\n    80%,\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n  .rotate-frac {\n    -webkit-animation: rotation 4s infinite linear;\n    animation: rotation 4s infinite linear;\n  }\n</style>\n","<script lang=\"ts\">\n  import Card from '../../../shared/ui/Card.svelte'\n  import BasicClassicModal from '../../../shared/modal/BasicClassicModal.svelte'\n  import appsTierce from '../../../../json/referentielAppsTierce.json'\n  import type { AppTierceGroup } from '../../../../lib/types/referentiels'\n\n  export let thirdAppsChoiceModal: BasicClassicModal\n  export let showThirdAppsChoiceDialog: boolean\n  export let appsTierceInExercisesList: string[]\n\n  const appsTierceReferentielArray: AppTierceGroup[] = Object.values(appsTierce)\n</script>\n\n<!-- Fentre de dialogue pour le choix des applications tierces -->\n<BasicClassicModal\n  bind:this=\"{thirdAppsChoiceModal}\"\n  bind:isDisplayed=\"{showThirdAppsChoiceDialog}\"\n>\n  <div slot=\"header\">Applications</div>\n  <div slot=\"content\">\n    <div class=\"p2\">\n      {#each appsTierceReferentielArray as group}\n        <div class=\"mx-2 pt-8\">\n          <div class=\"font-bold text-2xl text-coopmaths-struct py-4\">\n            {group.rubrique}\n          </div>\n          <div class=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n            {#each group.liste as app}\n              <Card\n                application=\"{app}\"\n                selected=\"{appsTierceInExercisesList.includes(app.uuid)}\"\n                loadImages=\"{showThirdAppsChoiceDialog}\"\n              />\n            {/each}\n          </div>\n        </div>\n      {/each}\n    </div>\n  </div>\n</BasicClassicModal>\n","<script lang=\"ts\">\n  import { onDestroy, onMount } from 'svelte'\n  import legacyCarouselContent from '../../../../../json/carouselContent.json'\n  // import carouselContentForCapytale from '../../../../../json/carouselContentForCapytale.json'\n  import ButtonTextAction from '../../../../shared/forms/ButtonTextAction.svelte'\n  import { globalOptions } from '../../../../../lib/stores/generalStore'\n\n  let currentSlideIndex = 0\n  let intervalId: number | null = null\n  let isPaused = false\n\n  // let carouselContent = $globalOptions.recorder === 'capytale' ? carouselContentForCapytale : legacyCarouselContent\n  let carouselContent = legacyCarouselContent\n\n  // Configuration de l'animation\n  const SLIDE_DURATION = 5000 // 5 secondes par slide\n  const TRANSITION_DURATION = 500 // 500ms pour la transition\n\n  function nextSlide(): void {\n    if (carouselContent.slides && carouselContent.slides.length > 0) {\n      currentSlideIndex =\n        (currentSlideIndex + 1) % carouselContent.slides.length\n      scrollToSlide(currentSlideIndex)\n    }\n  }\n\n  function goToSlide(index: number): void {\n    currentSlideIndex = index\n    scrollToSlide(index)\n  }\n\n  function scrollToSlide(index: number): void {\n    const slideElement = document.getElementById(`carousel-item${index}`)\n    if (slideElement) {\n      slideElement.scrollIntoView({\n        behavior: 'smooth',\n        block: 'nearest',\n        inline: 'start',\n      })\n    }\n  }\n\n  function startAutoPlay(): void {\n    if (!intervalId) {\n      intervalId = setInterval(nextSlide, SLIDE_DURATION) as unknown as number\n    }\n  }\n  function stopAutoPlay(): void {\n    if (intervalId) {\n      clearInterval(intervalId)\n      intervalId = null\n    }\n  }\n\n  function togglePause(): void {\n    isPaused = !isPaused\n    if (isPaused) {\n      stopAutoPlay()\n    } else {\n      startAutoPlay()\n    }\n  }\n  // Gestionnaires d'vnements pour pause au survol\n  function handleMouseEnter(): void {\n    stopAutoPlay()\n  }\n\n  function handleMouseLeave(): void {\n    if (!isPaused) {\n      startAutoPlay()\n    }\n  }\n\n  // Gestionnaire de clic sur les indicateurs\n  function handleIndicatorClick(index: number): void {\n    goToSlide(index)\n    // Redmarrer le timer aprs un clic manuel\n    if (!isPaused) {\n      stopAutoPlay()\n      startAutoPlay()\n    }\n  }\n\n  onMount(() => {\n    // Dmarrer l'animation automatique au montage du composant\n    startAutoPlay()\n  })\n\n  onDestroy(() => {\n    // Nettoyer l'intervalle  la destruction du composant\n    stopAutoPlay()\n  })\n</script>\n\n{#if carouselContent.slides && carouselContent.slides.length !== 0}\n  <div class=\"h-[90%]\">\n    <div\n      class=\"carousel w-full h-full cursor-pause-circle\"\n      on:mouseenter=\"{handleMouseEnter}\"\n      on:mouseleave=\"{handleMouseLeave}\"\n      role=\"region\"\n      aria-label=\"Caroussel d'images\"\n    >\n      {#each carouselContent.slides as slide, i}\n        <div\n          id=\"carousel-item{i}\"\n          class=\"carousel-item w-full h-full flex justify-center items-center\"\n          style=\"transition: opacity {TRANSITION_DURATION}ms ease-in-out;\"\n        >\n          <div\n            class=\"flex flex-col justify-center items-center xl:w-4/5 w-11/12 h-full\n          bg-cover bg-no-repeat bg-center\"\n            style=\"background-image: url('images/carousel/{slide.background}');\"\n          >\n            <div\n              class=\"relative w-full h-full\n            {slide.message && slide.message.length !== 0\n                ? 'bg-opacity-80'\n                : 'bg-opacity-0'}\n            {slide.background && slide.background.length !== 0\n                ? 'bg-coopmaths-canvas dark:bg-coopmathsdark-canvas'\n                : 'bg-coopmaths-struct dark:bg-coopmathsdark-struct'}\"\n            >\n              <div\n                class=\"w-full h-full xl:p-20 lg:p-10 md:p-6 sm:p-4 p-3 flex flex-col justify-between items-start\"\n              >\n                {#if slide.title && slide.title.length !== 0}\n                  <h1\n                    class=\"w-full h-[20%] flex flex-row justify-start pb-8 font-bold\n             text-xl md:text-2xl lg:text-3xl xl:text-4xl 2xl:text-6xl\n             {slide.background && slide.background.length !== 0\n                      ? 'text-coopmaths-struct dark:text-coopmathsdark-struct'\n                      : 'text-coopmaths-canvas-darkest dark:text-coopmathsdark-canvas-darkest'}\"\n                  >\n                    {slide.title}\n                  </h1>\n                {/if}\n                {#if slide.message && slide.message.length !== 0}\n                  {#if slide.image && slide.image.length !== 0}\n                    <div class=\"flex flex-row w-full h-[80%] gap-4\">\n                      <div\n                        class=\"w-full lg:w-1/2 h-full flex justify-start items-center\n                        overflow-hidden text-ellipsis\n                 px-4 sm:px-6 md:px-8 lg:px-10 text-opacity-100 font-light\n                 text-lg sm:text-xl md:text-2xl lg:text-xl xl:text-2xl 2xl:text-4xl\n                 {slide.background && slide.background.length !== 0\n                          ? 'text-coopmaths-corpus dark:text-coopmathsdark-corpus'\n                          : 'text-coopmaths-canvas dark:text-coopmathsdark-canvas'}\"\n                      >\n                        {slide.message}\n                      </div>\n                      <div\n                        class=\"hidden lg:flex lg:w-1/2 flex-1 justify-center items-center\"\n                      >\n                        <!-- Support for both images and videos -->\n                        {#if slide.image.endsWith('.mp4')}\n                          <video\n                            class=\"flex items-center justify-center w-full h-full object-scale-down\"\n                            src=\"images/carousel/{slide.image}\"\n                            autoplay\n                            loop\n                            muted\n                            playsinline\n                          ></video>\n                        {:else}\n                        <img\n                          class=\"flex items-center justify-center w-full h-full object-scale-down\"\n                          src=\"images/carousel/{slide.image}\"\n                          alt=\"Image:{slide.image}\"\n                        />\n                        {/if}\n                      </div>\n                    </div>\n                  {:else}\n                    <div\n                      class=\"w-full h-[80%] flex justify-start items-center\n                      overflow-hidden text-ellipsis\n               px-4 sm:px-6 md:px-8 lg:px-10 text-opacity-100 font-light\n               text-lg sm:text-xl md:text-2xl lg:text-3xl xl:text-4xl\n               {slide.background && slide.background.length !== 0\n                        ? 'text-coopmaths-corpus dark:text-coopmathsdark-corpus'\n                        : 'text-coopmaths-canvas dark:text-coopmathsdark-canvas'}\"\n                    >\n                      {slide.message}\n                    </div>\n                  {/if}\n                {/if}\n              </div>\n              {#if slide.link && slide.link.length !== 0}\n                <div class=\"absolute bottom-6 right-6\">\n                  <ButtonTextAction\n                    text=\"{slide.buttonTitle && slide.buttonTitle.length !== 0\n                      ? slide.buttonTitle\n                      : 'En savoir plus'}\"\n                    class=\"inline-flex items-center py-1 px-3 rounded-md font-normal\"\n                    on:click=\"{() => {\n                      const w = window.open(\n                        slide.link || 'https://coopmaths.fr/alea/',\n                        '_blank',\n                      )\n                      if (w) {\n                        w.focus()\n                      }\n                    }}\"\n                  />\n                </div>\n              {/if}\n            </div>\n          </div>\n        </div>\n      {/each}\n    </div>\n    <div class=\"flex w-full justify-center gap-2 py-2\">\n      {#each carouselContent.slides as slide, i}\n        <button\n          class=\"btn btn-xs border-0\n            {i === currentSlideIndex\n            ? 'bg-coopmaths-light text-coopmaths-canvas dark:bg-coopmathsdark-action dark:text-coopmathsdark-canvas-dark'\n            : 'bg-coopmaths-canvas-darkest text-coopmaths dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-action'} font-light transition-all duration-200\"\n          on:click=\"{() => handleIndicatorClick(i)}\"\n          aria-label=\"Aller au slide {i + 1}\"\n        >\n          {i + 1}\n        </button>\n      {/each}\n    </div>\n  </div>\n{/if}\n","<script lang=\"ts\">\n    import { getLang } from '../../../../lib/stores/languagesStore'\n  import Footer from '../../../Footer.svelte'\n  import Carousel from './carousel/Carousel.svelte'\n\n  export let text: string\n  const lang = getLang()\n</script>\n\n<div class=\"relative flex-1 h-full\">\n  <div\n    class=\"flex flex-col justify-between h-full text-coopmaths-corpus dark:text-coopmathsdark-corpus md:px-10 py-6\"\n  >\n    <!-- <div class=\"bg-coopmaths-canvas\">\n      <span class=\"text-coopmaths-canvas\">&nbsp;</span>  <- Dcommenter si pas d'Advertising\n    </div> -->\n    <!-- <Advertising /> -->\n    {#if lang === 'fr-FR'}\n    <div class=\"md:block md:h-full hidden\">\n      <Carousel />\n    </div>\n    {/if}\n    <div\n      class=\"animate-pulse flex flex-col md:flex-row justify-start space-x-6 items-center {lang !== 'fr-FR' ? 'mt-32 md:mt-40' : ''}\"\n    >\n      <div class=\"mt-[10px]\">\n        <div class=\"hidden md:inline-flex\">\n          <i class=\"bx bx-chevron-left text-[50px]\"></i>\n        </div>\n        <div class=\"inline-flex md:hidden\">\n          <i class=\"bx bx-chevron-up text-[50px]\"></i>\n        </div>\n      </div>\n      <div class=\"font-extralight text-[50px]\">\n        {text}\n      </div>\n    </div>\n    <div class=\"invisible sm:visible flex items-center justify-center\">\n      <Footer />\n    </div>\n  </div>\n</div>\n","/**\n * En thorie, indique si moins d'un mois s'est coul depuis la date passe\n * en paramtre et aujourd'hui.\n * /!\\ ATTENTION : En ralit, la fonction est bancale car elle prsuppose une type de chane pour dsigner la date : YYYY/MM/DD\n * On lui prfrera `isLessThanAMonth` de `lib\\types\\dates.ts`\n * @param dateString chaine reprsentant la date\n * @returns `true` si aujourd'hui - date < un mois\n */\nexport function isRecent(dateString: string) {\n  if (dateString === undefined) return false\n  const [jour, mois, annee] = dateString.split('/').map((s) => parseInt(s))\n  const date = new Date(annee, mois - 1, jour)\n  const elapsedTime = Date.now() - date.getTime()\n  const unMois = 3600 * 24 * 30 * 1000\n  return elapsedTime < unMois\n}\n\nexport const monthes = [\n  'Janvier',\n  'Fvrier',\n  'Mars',\n  'Avril',\n  'Mai',\n  'Juin',\n  'Juillet',\n  'Aot',\n  'Septembre',\n  'Octobre',\n  'Novembre',\n  'Dcembre',\n]\n","<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  viewBox=\"0 0 8.467 8.467\"\n  class=\"{$$props.class}\"\n>\n  <defs>\n    <marker\n      id=\"a\"\n      markerHeight=\"2\"\n      markerWidth=\"2\"\n      orient=\"auto-start-reverse\"\n      preserveAspectRatio=\"xMidYMid\"\n      refX=\"0\"\n      refY=\"0\"\n      style=\"overflow:visible\"\n      viewBox=\"0 0 5.324 6.155\"\n    >\n      <path\n        d=\"m5.77 0-8.65 5V-5Z\"\n        style=\"fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt\"\n        transform=\"scale(.5)\"\n      ></path>\n    </marker>\n    <marker\n      id=\"b\"\n      markerHeight=\"2\"\n      markerWidth=\"2\"\n      orient=\"auto-start-reverse\"\n      preserveAspectRatio=\"xMidYMid\"\n      refX=\"0\"\n      refY=\"0\"\n      style=\"overflow:visible\"\n      viewBox=\"0 0 5.324 6.155\"\n    >\n      <path\n        d=\"m5.77 0-8.65 5V-5Z\"\n        style=\"fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt\"\n        transform=\"scale(.5)\"\n      ></path>\n    </marker>\n  </defs>\n  <g transform=\"matrix(.87062 0 0 .87062 .723 1.111)\">\n    <path\n      d=\"M6.117 4.022a2.086 2.086 0 0 0-2.084 2.083c0 1.15.935 2.084 2.084 2.084A2.086 2.086 0 0 0 8.2 6.105a2.086 2.086 0 0 0-2.083-2.083zm0 3.75a1.669 1.669 0 0 1-1.52-2.35l.096.058c.082.052.164.104.268.143.103.04.226.065.391.065s.289-.026.392-.065c.103-.039.186-.09.268-.143.083-.052.165-.104.268-.143.103-.04.227-.065.392-.065s.289.026.392.065c.103.039.185.091.268.143.082.052.165.104.268.143.037.014.078.026.121.036.04.142.063.291.063.446 0 .92-.748 1.667-1.667 1.667z\"\n      style=\"stroke-width:.208363\"\n    ></path>\n    <circle cx=\"5.388\" cy=\"6.209\" r=\".313\" style=\"stroke-width:.208363\"\n    ></circle>\n    <circle cx=\"6.846\" cy=\"6.209\" r=\".313\" style=\"stroke-width:.208363\"\n    ></circle>\n  </g>\n  <path\n    d=\"M1.062.56h3.08a.474.474 0 0 1 .474.474v2.37a.474.474 0 0 1-.474.473h-3.08a.474.474 0 0 1-.474-.474v-2.37A.474.474 0 0 1 1.062.56Z\"\n    style=\"fill:none;stroke-width:.236966;stroke-linecap:round;stroke-linejoin:round\"\n  ></path>\n  <path\n    d=\"M.773.536.536.752v.432h4.029V.752L4.327.536Zm1.948.141h1.421a.118.118 0 0 1 .12.12.118.118 0 0 1-.12.12H2.721a.118.118 0 0 1-.12-.12.118.118 0 0 1 .12-.12ZM1.019.68a.118.118 0 0 1 .009 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.118.118.118.118 0 0 1-.119-.118.118.118 0 0 1 .11-.118Zm.313 0a.118.118 0 0 1 .009 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.118.118.118.118 0 0 1-.119-.118.118.118 0 0 1 .11-.118Zm.313 0a.118.118 0 0 1 .01 0 .118.118 0 0 1 .118.118.118.118 0 0 1-.119.118.118.118 0 0 1-.118-.118.118.118 0 0 1 .11-.118z\"\n    style=\"stroke:none;stroke-width:.226291px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"\n  ></path>\n  <path\n    d=\"M7.062 3.945V1.536h-1.21\"\n    style=\"fill:none;stroke-width:.747516;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#a)\"\n  ></path>\n  <path\n    d=\"M1.589 4.668v2.41h1.208\"\n    style=\"fill:none;stroke-width:.747516;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#b)\"\n  ></path>\n  <path\n    d=\"m.53.53 7.407 7.407\"\n    style=\"fill:none;stroke-width:.79375;stroke-linecap:round;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1\"\n  ></path>\n</svg>\n","<script lang=\"ts\">\n  import katex from 'katex'\n  import { onDestroy } from 'svelte'\n  import {\n      isExerciceItemInReferentiel,\n      isGeoDynamic,\n      isTool,\n      resourceHasMonth,\n      resourceHasPlace,\n      type JSONReferentielEnding,\n  } from '../../../../../../lib/types/referentiels'\n// eslint-disable-next-line no-unused-vars, @typescript-eslint/no-unused-vars\n  import { mathaleaGenerateSeed } from '../../../../../../lib/mathalea'\n  import {\n      changes,\n      exercicesParams,\n      globalOptions,\n  } from '../../../../../../lib/stores/generalStore'\n  import type { InterfaceParams } from '../../../../../../lib/types'\n  import { isLessThan1Month } from '../../../../../../lib/types/dates'\n  import NoInteractivityIcon from '../../../../../shared/icons/NoInteractivityIcon.svelte'\n  import QcmCamIcon from '../../../../../shared/icons/QcmCamIcon.svelte'\n\n  export let ending: JSONReferentielEnding\n  export let nestedLevelCount: number\n\n  let nomDeExercice: HTMLDivElement\n  let selectedCount: number\n  /* --------------------------------------------------------------\n    Gestions des exercices via la liste\n   --------------------------------------------------------------- */\n  /**\n   * Compare un code  UUID courante\n   * @param {string} code le code de l'UUID  comparer  l'UUID courante\n   * @returns {boolean} `true` si les deux chanes sont gales\n   */\n  const compareCodes = (code: string): boolean => {\n    return code === ending.uuid\n  }\n  /**\n   * Compte le nombre de fois o la ressource a t slectionne\n   * @returns {number} nb d'occurences\n   */\n  const countOccurences = (): number => {\n    return $exercicesParams.map((item) => item.uuid).filter(compareCodes).length\n  }\n  // on compte ractivement le nombre d'occurences\n  // de l'exercice dans la liste des slectionns\n  const unsubscribeToExerciceParams = exercicesParams.subscribe(() => {\n    selectedCount = countOccurences()\n  })\n\n  let endingTitre = ''\n\n  $: {\n    if (isExerciceItemInReferentiel(ending)) {\n      endingTitre = ending.titre\n      if (endingTitre.includes('$')) {\n        const regexp = /(['$])(.*?)\\1/g\n        const matchs = endingTitre.match(regexp)\n        matchs?.forEach((match) => {\n          endingTitre = endingTitre.replace(\n            match,\n            katex.renderToString(match.replaceAll('$', '')),\n          )\n        })\n      }\n    }\n    selectedCount = countOccurences()\n  }\n\n  onDestroy(unsubscribeToExerciceParams)\n\n  /**\n   * Ajouter l'exercice courant  la liste\n   */\n  function addToList() {\n    const newExercise = {\n      uuid: ending.uuid,\n      alea: mathaleaGenerateSeed(),\n      interactif: isGeoDynamic(ending) ? '1' : '0',\n    } as InterfaceParams\n    if (isExerciceItemInReferentiel(ending) || isTool(ending)) {\n      newExercise.id = ending.id\n    }\n    if (\n      $globalOptions.recorder === 'capytale' ||\n      $globalOptions.setInteractive === '1'\n    ) {\n      newExercise.interactif = '1'\n    }\n    exercicesParams.update((list) => [...list, newExercise])\n    $changes++\n  }\n  /**\n   * Retirer l'exercice de la liste (si plusieurs occurences\n   * la premire est retire)\n   */\n  function removeFromList() {\n    const matchingIndex = $exercicesParams\n      .map((item) => item.uuid)\n      .findIndex(compareCodes)\n    exercicesParams.update((list) => [\n      ...list.slice(0, matchingIndex),\n      ...list.slice(matchingIndex + 1),\n    ])\n    $changes--\n  }\n\n  /* --------------------------------------------------------------\n    Gestions des icnes en dbut de ligne\n   --------------------------------------------------------------- */\n  let icon = 'bxs-message-alt'\n  let rotation = '-rotate-90'\n  let mouseIsOut = true\n  function handleMouseOver() {\n    icon = 'bx-trash'\n    rotation = 'rotate-0'\n    mouseIsOut = false\n  }\n  function handleMouseOut() {\n    icon = 'bxs-message-alt'\n    rotation = '-rotate-90'\n    mouseIsOut = true\n  }\n</script>\n\n<!--\n  @component\n  Composant destin  afficher les terminaisons des branches d'un rfrentiel.\n\n  #### Paramtres\n  **ending** (_JSONReferentielEnding_) : l'objet reprsentant la terminaison\n  **nestedLevelCount** (_number_) : compteur du niveau d'imbrication (utilis pour la mise en page)\n -->\n<div\n  class=\"{`${$$props.class || ''} w-full flex flex-row mr-4 text-start items-start text-sm text-coopmaths-corpus dark:text-coopmathsdark-corpus bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark`}\"\n  style=\"padding-left: {(nestedLevelCount * 2) / 6}rem\"\n>\n  <div\n    class=\"{`w-full relative inline-flex text-start justify-start items-start hover:bg-coopmaths-action-light dark:hover:bg-coopmathsdark-action-light dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest ${selectedCount >= 1 ? 'bg-coopmaths-warn dark:bg-coopmathsdark-warn' : 'bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas-darkest'} cursor-pointer`}\"\n  >\n    <button\n      type=\"button\"\n      on:click=\"{addToList}\"\n      class=\"ml-[3px] pl-2 pr-4 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark hover:bg-coopmaths-canvas dark:hover:bg-coopmathsdark-canvas-darkest flex-1\"\n    >\n      <div bind:this=\"{nomDeExercice}\" class=\"flex flex-row justify-start\">\n        {#if isExerciceItemInReferentiel(ending)}\n          <!-- Exercice MathALA -->\n          <div\n            class=\"text-start text-coopmaths-corpus dark:text-coopmathsdark-corpus bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark hover:bg-coopmaths-canvas dark:hover:bg-coopmathsdark-canvas-darkest\"\n          >\n            <span class=\"font-bold\">{ending.id} - </span>{@html endingTitre}\n            {#if isLessThan1Month(ending.datePublication)}\n              &nbsp;\n              <span\n                class=\"tooltip tooltip-bottom tooltip-neutral\"\n                data-tip=\"{ending.datePublication}\"\n              >\n                <span\n                  class=\"inline-flex flex-wrap items-center justify-center rounded-full bg-coopmaths-warn-dark dark:bg-coopmathsdark-warn-dark text-coopmaths-canvas dark:text-coopmathsdark-canvas text-[0.6rem] px-2 ml-2 font-semibold leading-normal\"\n                >\n                  NEW\n                </span>\n              </span>\n            {/if}\n            {#if isLessThan1Month(ending.dateModification)}\n              &nbsp;\n              <span\n                class=\"tooltip tooltip-bottom tooltip-neutral\"\n                data-tip=\"{ending.dateModification}\"\n              >\n                <span\n                  class=\"tooltip tooltip-bottom tooltip-neutral\n                  inline-flex flex-wrap items-center justify-center rounded-full bg-coopmaths-struct-light dark:bg-coopmathsdark-struct-light text-coopmaths-canvas dark:text-coopmathsdark-canvas text-[0.6rem] px-2 ml-2 font-semibold leading-normal\"\n                >\n                  MAJ\n                </span>\n              </span>\n            {/if}\n            {#if ending.features.qcmcam}\n              &nbsp;\n              <span\n                class=\"tooltip tooltip-bottom tooltip-neutral\"\n                data-tip=\"Export QCM Cam Disponible\"\n              >\n                <QcmCamIcon\n                  class=\"inline-flex h-3 w-3 text-coopmaths-warn-dark dark:text-coopmathsdark-warn-dark fill-coopmaths-warn-dark dark:fill-coopmathsdark-warn-dark stroke-coopmaths-warn-dark dark:stroke-coopmathsdark-warn-dark\"\n                />\n              </span>\n            {/if}\n            {#if !ending.features.interactif?.isActive}\n              &nbsp;<span\n                class=\"tooltip tooltip-bottom tooltip-neutral\"\n                data-tip=\"Pas d'interactivit\"\n              >\n                <NoInteractivityIcon\n                  class=\"inline-flex h-3 w-3 text-coopmaths-warn-dark dark:text-coopmathsdark-warn-dark fill-coopmaths-warn-dark dark:fill-coopmathsdark-warn-dark stroke-coopmaths-warn-dark dark:stroke-coopmathsdark-warn-dark\"\n                />\n              </span>\n            {/if}\n          </div>\n        {:else if resourceHasPlace(ending)}\n          <!-- Exercices d'annales -->\n          <div class=\"text-start\">\n            <span class=\"font-bold\">\n              {ending.typeExercice.toUpperCase()}\n              {#if resourceHasMonth(ending)}\n                {ending.mois}\n              {/if}\n              {ending.annee}\n              {ending.lieu}\n              {#if ending.jour !== undefined}\n                [{ending.jour === 'J1' ? 'Sujet 1' : 'Sujet 2'}]\n              {/if}\n              - {ending.numeroInitial}\n            </span>\n            <div class=\"pl-2\">\n              {#each ending.tags as tag}\n                <span\n                  class=\"inline-flex flex-wrap items-center justify-center rounded-full bg-coopmaths-struct-light dark:bg-coopmathsdark-struct-light text-coopmaths-canvas dark:text-coopmathsdark-canvas text-[0.6rem] px-2 py-px leading-snug font-semibold mr-1\"\n                >\n                  {tag}\n                </span>\n              {/each}\n            </div>\n          </div>\n        {:else if isTool(ending)}\n          <!-- Outils -->\n          <div\n            class=\"text-start text-coopmaths-corpus dark:text-coopmathsdark-corpus bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark hover:bg-coopmaths-canvas dark:hover:bg-coopmathsdark-canvas-darkest\"\n          >\n            <span class=\"font-bold\">{ending.id} - </span>{ending.titre}\n          </div>\n        {:else}\n          <!-- Exercice de la bibliothque -->\n          <div\n            class=\"text-start text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n          >\n            <span class=\"font-bold\">{ending.uuid}</span>\n          </div>\n        {/if}\n      </div>\n    </button>\n\n    <!-- Bouton en dbut de ligne pour visualiser si l'exo est slectionn,\n        combien de fois et pour ventuellement le retirer de la slection -->\n    {#if selectedCount >= 1}\n      <button\n        type=\"button\"\n        class=\"absolute -left-4 top-1/2 transform -translate-y-1/2\"\n        on:mouseover=\"{handleMouseOver}\"\n        on:focus=\"{handleMouseOver}\"\n        on:mouseout=\"{handleMouseOut}\"\n        on:blur=\"{handleMouseOut}\"\n        on:click=\"{removeFromList}\"\n        on:keydown=\"{removeFromList}\"\n      >\n        <i\n          class=\"text-coopmaths-action-light dark:text-coopmathsdark-action-light text-base bx {icon} {rotation}\"\n        ></i>\n      </button>\n    {/if}\n    {#if selectedCount >= 2 && mouseIsOut}\n      <div\n        class=\"absolute -left-3 -top-0 text-[0.6rem] font-bold text-coopmaths-canvas dark:text-coopmathsdark-canvas-dark\"\n      >\n        {selectedCount}\n      </div>\n    {/if}\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { onMount } from 'svelte'\n  import { slide } from 'svelte/transition'\n  import codeToLevelList from '../../../../../../json/codeToLevelList.json'\n  import themesList from '../../../../../../json/levelsThemesList.json'\n  import themesListCH from '../../../../../../json/levelsThemesListCH.json'\n  import { monthes } from '../../../../../../lib/components/handleDate'\n  import { codeToLevelTitle } from '../../../../../../lib/components/refUtils'\n  import { toMap } from '../../../../../../lib/components/toMap'\n  import {\n    bibliothequeDisplayedContent,\n    exercicesParams,\n  } from '../../../../../../lib/stores/generalStore'\n  import {\n    isExamItemInReferentiel,\n    isJSONReferentielEnding,\n    type JSONReferentielObject,\n  } from '../../../../../../lib/types/referentiels'\n  import ReferentielEnding from './ReferentielEnding.svelte'\n\n  const themes = toMap(themesList)\n  const themesCH = toMap(themesListCH)\n\n  export let subset: JSONReferentielObject\n  export let unfold: boolean = false\n  export let nestedLevelCount: number\n  export let indexBase: number\n  export let levelTitle: string\n  export let pathToThisNode: string[]\n  $: items = prepareSubset(subset)\n  const levels = Object.keys(codeToLevelList)\n\n  /**\n   * Recherche dans la liste des thmes si le thme est rfrenc\n   * et si oui, renvoie son intitul\n   * @param {string} themeCode code du thme\n   * @return {string} intitul du thme\n   * @author Sylvain Chambon & Rmi Angot\n   */\n  function themeTitle(themeCode: string) {\n    if (themes.has(themeCode)) {\n      return [\n        themeCodeisSubthemeCode(\n          levelTitle,\n          Array.from(levelTitle.replace('auto', ''))[0],\n        )\n          ? ''\n          : ' : ',\n        themes.get(themeCode).get('titre'),\n      ].join('')\n    } else if (themesCH.has(themeCode)) {\n      return [\n        themeCodeisSubthemeCode(\n          levelTitle,\n          Array.from(levelTitle.replace('auto', ''))[0],\n        )\n          ? ''\n          : ' : ',\n        themesCH.get(themeCode).get('titre'),\n      ].join('')\n    } else {\n      return ''\n    }\n  }\n\n  /**\n   * Teste si le code du niveau correspond  un sous-thme :\n   * sur la base de la syntaxe adopte pour les codes des thmes\n   * ( savoir :  <NB><LETTRE><NOMBRE> ou auto<NB><LETTRE><NOMBRE>),\n   * la fonction confronte le code  tester  une expression rgulire afin de savoir si\n   * une lettre suit le code de trois caractres.\n   * @param {string} themeCode code du niveau\n   * @param {string} level? niveau optionnel (6 par dfaut)\n   * @author Sylvain Chambon\n   */\n  function themeCodeisSubthemeCode(\n    themeCode: string,\n    level: string = '6',\n  ): boolean {\n    const regexp = new RegExp(`^(auto)?${level}[A-Z]\\\\d+[A-Z0-9]$`, 'g')\n    const regexp3Auto = new RegExp(`^(3Auto)?[A-Z]\\\\d+[A-Z0-9]$`, `g`)\n    return regexp.test(themeCode) || regexp3Auto.test(themeCode)\n  }\n\n  /**\n   * Ordonne les entres d'un sous-menu  l'envers lorsque son titre contient le mot `anne`\n   * afin de commencer par l'anne la plus rcente\n   */\n  function prepareSubset(s: JSONReferentielObject) {\n    // console.log('======= referentiel before preparation ====')\n    // console.log(pathToThisNode.join('/'))\n    // console.log(Object.entries(s))\n    if (pathToThisNode.length !== 0) {\n      // console.log('object in prepareSubset (pathToThisNode): ')\n      // console.log(pathToThisNode)\n      // console.log(s)\n      // classement entres CAN\n      if (pathToThisNode[pathToThisNode.length - 1].includes('CAN')) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        return Object.entries(s).sort(([keyA, valueA], [keyB, valueB]) => {\n          return levels.indexOf(keyA) - levels.indexOf(keyB)\n        })\n      }\n      // classement des entres par annes dcroissantes\n      const key = pathToThisNode[\n        pathToThisNode.length - 1\n      ] as keyof typeof codeToLevelList\n      if (codeToLevelList[key]?.includes('anne')) {\n        return Object.entries(s).reverse()\n      }\n      // classement des entres par annes dcroissantes\n      if (pathToThisNode[pathToThisNode.length - 1].includes('anne')) {\n        return Object.entries(s).reverse()\n      }\n\n      // classement des thmes dans l'ordre alphabtique\n      const key2 = pathToThisNode[\n        pathToThisNode.length - 1\n      ] as keyof typeof codeToLevelList\n      if (codeToLevelList[key2]?.includes('thme')) {\n        return Object.entries(s).sort(([keyA, valueA], [keyB, valueB]) => {\n          return keyA.localeCompare(keyB, 'fr')\n        })\n      }\n\n      // classement des thmes dans l'ordre alphabtique\n      if (pathToThisNode[pathToThisNode.length - 1].includes('Tags')) {\n        return Object.entries(s).sort(([keyA, valueA], [keyB, valueB]) => {\n          return keyA.localeCompare(keyB, 'fr')\n        })\n      }\n\n      // classement des thmes dans l'ordre alphabtique\n      if (pathToThisNode[pathToThisNode.length - 1].includes('Tags')) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const e = Object.entries(s).sort(([keyA, valueA], [keyB, valueB]) => {\n          return keyA.localeCompare(keyB, 'fr')\n        })\n\n        // console.log('======= referentiel after (theme) ====')\n        // console.log(e)\n        return e\n      }\n      // classement des entres par annes : sujets 1 et 2\n      const regExpForExactlyFourDigits = /^\\d{4}$/gm\n      if (\n        regExpForExactlyFourDigits.test(\n          pathToThisNode[pathToThisNode.length - 1],\n        )\n      ) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        return Object.entries(s).sort(([keyA, valueA], [keyB, valueB]) => {\n          if (\n            isExamItemInReferentiel(valueA) &&\n            isExamItemInReferentiel(valueB) &&\n            valueA.jour &&\n            valueB.jour\n          ) {\n            const jourA = parseInt(valueA.jour.replace('J', ''))\n            const jourB = parseInt(valueB.jour.replace('J', ''))\n            const moisA = monthes.indexOf(valueA.mois ?? '')\n            const moisB = monthes.indexOf(valueB.mois ?? '')\n            return (\n              moisB - moisA ||\n              valueA.lieu.localeCompare(valueB.lieu) ||\n              jourA - jourB\n            )\n          } else {\n            return 0\n          }\n        })\n      }\n      return Object.entries(s)\n    } else {\n      // classement dans l'ordre alphabtique\n      if (\n        'Gomtrie dynamique' === levelTitle ||\n        'Vos ressources' === levelTitle\n      ) {\n        return Object.entries(s).sort(([keyA, valueA], [keyB, valueB]) => {\n          return keyA.localeCompare(keyB, 'fr')\n        })\n      }\n      return Object.entries(s)\n    }\n  }\n\n  /**\n   * Gestion la bibliothque de statiques\n   */\n  let bibliothequeUuidInExercisesList: string[]\n  $: {\n    bibliothequeUuidInExercisesList = []\n    const uuidList: string[] = []\n    for (const entry of $exercicesParams) {\n      uuidList.push(entry.uuid)\n    }\n    if ($bibliothequeDisplayedContent) {\n      for (const item of Object.values($bibliothequeDisplayedContent)) {\n        if (isJSONReferentielEnding(item) && uuidList.includes(item.uuid)) {\n          bibliothequeUuidInExercisesList.push(item.uuid)\n        }\n      }\n    }\n    bibliothequeUuidInExercisesList = bibliothequeUuidInExercisesList\n  }\n\n  onMount(() => {\n    //   console.log('******** subset ********')\n    //   console.log(Object.entries(subset))\n    // console.log('levelTitle: ', levelTitle)\n    if (\n      (nestedLevelCount === 1 && levelTitle === 'Exercices alatoires') ||\n      themeCodeisSubthemeCode(\n        levelTitle,\n        Array.from(levelTitle.replace('auto', ''))[0],\n      )\n    ) {\n      unfold = true\n    }\n  })\n</script>\n\n<!--\n  @component\n  Composant destin  afficher la liste des entres d'un rfrentiel  un niveau N.\n  On affiche le titre du niveau N et un clic sur ce titre dploie la liste des entres\n  du niveau N+1. Lorsque N=1, on considre que c'est un titre de section et le format est diffrent.\n\n  #### Remarque\n  Le composant s'appelle lui-mme afin d'assurer rcursivement le parcours entier du rfrentiel.\n  On dtecte si l'objet pass en paramtre est du type `JSONReferentielEnding` pour s'arrter.\n  Dans ce cas, le composant `ReferentielEnding.svelte` est appel.\n\n  #### Paramtres\n  - **subset** (_JSONReferentielObject_) : la branche du rfrentiel  afficher.\n  - **unfold** (_boolean_) : flag pour savoir si le niveau courant est dploy ou pas.\n  - **nestedLevelCount** (_number_) : compteur pour connatre le nombre d'imbrication (utilis pour la mise en page).\n  - **indexBase** (_number_) : nombre utilis pour identifier les lments HTML.\n  - **levelTitle** (_string_) : titre du niveau courant (cl du nud retraduite sur la base des fichiers `levelsThemesList.json` et `codeToLevelList.json`).\n\n -->\n<div class=\"{`${$$props.class || ''}`}\">\n  <button\n    id=\"{'titre-liste-' + indexBase}\"\n    type=\"button\"\n    disabled=\"{Object.keys(subset).length === 0}\"\n    class=\"w-full flex flex-row text-start items-center justify-between font-bold first-letter:first-linemarker\n    {nestedLevelCount !== 1\n      ? 'text-coopmaths-action dark:text-coopmathsdark-action hover:bg-coopmaths-canvas-darkest dark:hover:bg-coopmathsdark-canvas-darkest'\n      : 'text-coopmaths-struct dark:text-coopmathsdark-struct py-2'}\n    {unfold &&\n    nestedLevelCount !== 1 &&\n    !themeCodeisSubthemeCode(\n      levelTitle,\n      Array.from(levelTitle.replace('auto', ''))[0],\n    )\n      ? 'bg-coopmaths-canvas-darkest dark:bg-coopmathsdark-canvas-darkest'\n      : 'bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark'}\n    {Object.keys(subset).length === 0\n      ? 'opacity-10'\n      : 'opacity-100 cursor-pointer'}\"\n    style=\"padding-left: {(nestedLevelCount * 2) / 5}rem\"\n    on:click=\"{() => {\n      unfold = !unfold\n    }}\"\n  >\n    <div\n      id=\"{'titre-liste-' + indexBase + '-content'}\"\n      class=\" {nestedLevelCount === 1\n        ? 'text-xl'\n        : themeCodeisSubthemeCode(\n              levelTitle,\n              Array.from(levelTitle.replace('auto', ''))[0],\n            )\n          ? 'text-base leading-none py-2'\n          : 'text-base'}\"\n    >\n      <!-- on va chercher dans les fichiers JSON les significations des cls passes comme titre -->\n      {#if !themeCodeisSubthemeCode(levelTitle, Array.from(levelTitle.replace('auto', ''))[0])}\n        {codeToLevelTitle(levelTitle)}\n      {/if}\n      <span\n        class=\"{themeCodeisSubthemeCode(\n          levelTitle,\n          Array.from(levelTitle.replace('auto', ''))[0],\n        )\n          ? 'font-normal text-sm leading-[80%]'\n          : 'font-normal '}\">{themeTitle(levelTitle)}</span\n      >\n    </div>\n    <div>\n      <!-- Suivant que c'est le premier niveau (nestedLevelCount = 1) ou pas, on a un affichage diffrent :\n      le premier niveau correspond au tritre du rfrentiel -->\n      {#if nestedLevelCount !== 1}\n        <i\n          class=\" flex text-xl bg-transparent transition-transform duration-500 ease-in-out\n        {unfold && nestedLevelCount !== 1\n            ? 'bx bx-plus rotate-[225deg]'\n            : 'bx bx-plus'}\"\n        ></i>\n      {/if}\n\n      {#if nestedLevelCount === 1}\n        <i\n          class=\"flex text-sm text-coopmaths-action dark:text-coopmathsdark-action bg-transparent transition-transform duration-500 ease-in-out\n        {unfold ? 'bx bxs-up-arrow' : 'bx bxs-up-arrow rotate-[180deg]'}\"\n        ></i>\n      {/if}\n    </div>\n  </button>\n  <div>\n    {#if unfold}\n      <ul transition:slide|global=\"{{ duration: 500 }}\">\n        {#each items as [key, obj], i}\n          <li>\n            {#if isJSONReferentielEnding(obj)}\n              <ReferentielEnding\n                ending=\"{obj}\"\n                nestedLevelCount=\"{nestedLevelCount + 1}\"\n                class=\"{i === items.length - 1 ? 'pb-1' : ''}\"\n              />\n            {:else}\n              <svelte:self\n                indexBase=\"{`${indexBase}-${i.toString()}`}\"\n                levelTitle=\"{key}\"\n                nestedLevelCount=\"{nestedLevelCount + 1}\"\n                pathToThisNode=\"{[...pathToThisNode, key]}\"\n                bind:subset=\"{obj}\"\n              />\n            {/if}\n          </li>\n        {/each}\n      </ul>\n    {/if}\n  </div>\n</div>\n","/**\n * Dbarrasse une chane de ses caractres accentus en les remplaant\n * par des caractres sans accent\n * @see https://www.equinode.com/fonctions-javascript/retirer-les-accents-avec-javascript\n * @example\n * // returns `'Thales eleve ca peche a noel'`\n * texte=\"Thals lve a pche  nol\"\n * stringWithNoAccent(texte) // returns `'Thales eleve ca peche a noel'`\n * @param a chane  traiter\n * @returns chane dbarasse de ses accents\n */\nexport function stringWithNoAccent(a: string): string {\n  return a.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '')\n}\n","// inspiration : https://blog.susomejias.dev/blog/design-pattern-criteria\n\nimport { MONTHS, YEARS } from '../types/dates'\nimport {\n  isExerciceItemInReferentiel,\n  type ResourceAndItsPath,\n  type Level,\n  resourceHasPlace,\n  isLevelType,\n  isTool,\n  isStaticType,\n  EXAMS,\n  isExamItemInReferentiel,\n  resourceHasMonth,\n} from '../types/referentiels'\nimport { stringWithNoAccent } from './textUtils'\n\n/**\n * Dfinition d'un critre.\n *\n * ### Intention\n *\n * Un critre est essentiellement dfini par la dclaration d'une fonction `meetCriterion`\n * qui prend une liste (typiquement un rfrentiel) et renvoie la liste passe au crible\n * dfinit dans `meetCriterion`.\n */\nexport interface Criterion<T> {\n  meetCriterion(items: T[]): T[]\n}\n\n/**\n * Dfinition un critre multiple bas sur l'intersection de plusieurs critres\n *\n * ### Intention\n *\n * Tous les critres (stocks dans une variable prive)\n * doivent tre vrifis en mme temps.\n *\n * @function addCriterion ajouter un critre (ou un tableau de critres)  la liste\n */\nexport class MultiCriteria<T> implements Criterion<T> {\n  private criteriaList: Criterion<T>[] = []\n\n  addCriterion(criterion: Criterion<T> | Criterion<T>[]): MultiCriteria<T> {\n    if (Array.isArray(criterion)) {\n      for (const item of criterion) {\n        this.criteriaList.push(item)\n      }\n    } else {\n      this.criteriaList.push(criterion)\n    }\n    return this\n  }\n\n  meetCriterion(items: T[]): T[] {\n    let result: T[] = items\n    for (const criterion of this.criteriaList) {\n      result = criterion.meetCriterion(result)\n    }\n    return result\n  }\n}\n\n/**\n * Dfinition d'un critre bas sur l'union de deux autres\n *\n * ### Intention\n *\n * Le critre contrle si l'un ou l'autre des deux critres passs en paramtres\n * est vrifi.\n */\nexport class OrCriteria<T> implements Criterion<T> {\n  private firstCriterion: Criterion<T>\n  private secondCriterion: Criterion<T>\n  constructor(firstCriterion: Criterion<T>, secondCriterion: Criterion<T>) {\n    this.firstCriterion = firstCriterion\n    this.secondCriterion = secondCriterion\n  }\n\n  meetCriterion(items: T[]): T[] {\n    const firstResult = this.firstCriterion.meetCriterion(items)\n    const secondResult = this.secondCriterion.meetCriterion(items)\n    return Array.from(new Set([...firstResult, ...secondResult]))\n  }\n}\n\n/**\n * Dfinition d'un critre multiple bas sur l'union de tous les critres\n *\n * ### Intention\n *\n * Ce critre sera vrifi si l'un au moins des critres\n * (stocks dans une variable prive) est vrifi.\n *\n * @function addCriterion ajouter un critre (ou un tableau de critres)  la liste\n */\nexport class AtLeastOneOfCriteria<T> implements Criterion<T> {\n  private criteriaList: [Criterion<T>, Criterion<T>, ...Criterion<T>[]]\n  // au moins deux critres sont demands par le constructeur\n  constructor(criteriaList: [Criterion<T>, Criterion<T>, ...Criterion<T>[]]) {\n    this.criteriaList = [...criteriaList]\n  }\n\n  addCriterion(\n    criterion: Criterion<T> | Criterion<T>[],\n  ): AtLeastOneOfCriteria<T> {\n    if (Array.isArray(criterion)) {\n      for (const item of criterion) {\n        this.criteriaList.push(item)\n      }\n    } else {\n      this.criteriaList.push(criterion)\n    }\n    return this\n  }\n\n  meetCriterion(items: T[]): T[] {\n    const [firstCriterion, secondCriterion, ...list] = [...this.criteriaList]\n    let resultCriterion = new OrCriteria<T>(firstCriterion, secondCriterion)\n    for (const criterion of list) {\n      resultCriterion = new OrCriteria<T>(resultCriterion, criterion)\n    }\n    return resultCriterion.meetCriterion(items)\n  }\n}\n\n/**\n * tablie un critre de filtration sur la base d'une liste de spcifications\n * passe en paramtres\n * @remark Au 2023-10-01, seulement `amc` et `interactif` comme spcification autorise\n * @param {[('interactif' | 'amc')]}specs liste des spcifications  rechercher (sur la base du ET)\n * @returns {Criterion<ResourceAndItsPath>} un critre pour filtration\n * @example\n * ```ts\n * const all = getAllEndings(baseReferentiel)                // cration de l'objet de recherche\n  const amcSpec = featuresCriteria(['amc'])                   // cration du filtre\n  const filteredList = amcSpec.meetCriterion(all)             // utilisation du filtre\n  const filteredReferentiel = buildReferentiel(filteredList)  // reconstitution du rfrentiel\n  ```\n */\nexport function featuresCriteria(\n  specs: ('interactif' | 'amc' | 'qcm' | 'qcmcam')[],\n): Criterion<ResourceAndItsPath> {\n  // construction du critre pour la spcification `amc`\n  const amcCriterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]): ResourceAndItsPath[] {\n      return items.filter((item: ResourceAndItsPath) => {\n        if (isExerciceItemInReferentiel(item.resource)) {\n          if (\n            item.resource.features.amc &&\n            item.resource.features.amc.isActive\n          ) {\n            return true\n          } else {\n            return false\n          }\n        } else {\n          return false\n        }\n      })\n    },\n  }\n  // construction du critre pour la spcification `qcm`\n  const qcmCriterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]): ResourceAndItsPath[] {\n      return items.filter((item: ResourceAndItsPath) => {\n        if (isExerciceItemInReferentiel(item.resource)) {\n          if (\n            item.resource.features.qcm &&\n            item.resource.features.qcm.isActive\n          ) {\n            return true\n          } else {\n            return false\n          }\n        } else {\n          return false\n        }\n      })\n    },\n  }\n  // construction du critre pour la spcification `qcmcam`\n  const qcmcamCriterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]): ResourceAndItsPath[] {\n      return items.filter((item: ResourceAndItsPath) => {\n        if (isExerciceItemInReferentiel(item.resource)) {\n          if (\n            item.resource.features.qcmcam &&\n            item.resource.features.qcmcam.isActive\n          ) {\n            return true\n          } else {\n            return false\n          }\n        } else {\n          return false\n        }\n      })\n    },\n  }\n  // construction du critre pour la spcification `interactif`\n  const interactifCriterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]): ResourceAndItsPath[] {\n      return items.filter((item: ResourceAndItsPath) => {\n        if (isExerciceItemInReferentiel(item.resource)) {\n          if (\n            item.resource.features.interactif &&\n            item.resource.features.interactif.isActive\n          ) {\n            // console.log('found interactive :')\n            // console.log(item.resource)\n            return true\n          } else {\n            // console.log('found non interactive :')\n            // console.log(item.resource)\n            return false\n          }\n        } else {\n          return false\n        }\n      })\n    },\n  }\n  // on trie en fonction de ce que contient la liste des spcifications\n  if (specs.length < 2) {\n    if (specs.length === 0) {\n      // la liste ne peut pas tre vide\n      throw new Error(\n        'La liste des spcifications passe en paramtre est vide !',\n      )\n    }\n    // une seule spcification est prsente : on renvoie le critre correspondant\n    switch (specs[0]) {\n      case 'amc':\n        return amcCriterion\n      case 'interactif':\n        return interactifCriterion\n      case 'qcm':\n        return qcmCriterion\n      case 'qcmcam':\n        return qcmcamCriterion\n    }\n  } else {\n    //  on renvoie l'intersection des critres\n    const criterion = new MultiCriteria<ResourceAndItsPath>()\n    for (const spec of specs) {\n      switch (spec) {\n        case 'amc':\n          criterion.addCriterion(amcCriterion)\n          break\n        case 'interactif':\n          criterion.addCriterion(interactifCriterion)\n          break\n        case 'qcm':\n          criterion.addCriterion(qcmCriterion)\n          break\n        case 'qcmcam':\n          criterion.addCriterion(qcmcamCriterion)\n          break\n      }\n    }\n    return criterion\n  }\n}\n\n/**\n * Construit un critre pour filtrer une liste d'objets `ResourceAndItsPath`\n * contre un niveau de classe\n * @param {Level} level le niveau de classe retenu\n * @param {boolean} [considerCAN=false] doit-on inclure les exos CAN ou pas ?\n * @returns { Criterion<ResourceAndItsPath>} un critre pour filtration\n */\nexport function levelCriterion(\n  level: Level,\n  considerCAN: boolean = true,\n): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter((item) => {\n        // static est considr comme un niveau particulier\n        if (level === 'alea') {\n          return !isStaticType(item.resource)\n        }\n        if (level === 'static') {\n          return isStaticType(item.resource)\n        }\n        // CAN est considr comme un niveau donc on court-circuite les tests\n        if (level === 'CAN') {\n          return item.pathToResource[0] === level\n        }\n        if (considerCAN && item.pathToResource[0] === 'CAN') {\n          // cas o on veut des exercices CAN, on regarde le 2e lment du chemin\n          return item.pathToResource[1] === level\n        } else if (['1e', 'Terminale'].includes(item.pathToResource[0])) {\n          return item.pathToResource[1] === level\n        } else {\n          // dans l'autre cas, le niveau est dans le 1er lment du chemin\n          return item.pathToResource[0] === level\n        }\n      })\n    },\n  }\n  return criterion\n}\n\n/**\n * Construit un critre pour filtrer une liste d'objets `ResourceAndItsPath`\n * contre un sujet  rechercher dans la liste des tags\n * @param {string} selectedTag le sujet recherch dans les tags\n * @returns { Criterion<ResourceAndItsPath>} un critre pour filtration\n */\nexport function tagCriterion(\n  selectedTag: string,\n): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter(\n        (item: ResourceAndItsPath) =>\n          item.resource.tags &&\n          item.resource.tags\n            .map((t) => stringWithNoAccent(t.toLowerCase()))\n            .find((t) =>\n              t.includes(stringWithNoAccent(selectedTag.toLowerCase())),\n            ),\n      )\n    },\n  }\n  return criterion\n}\n\nexport function monthCriterion(\n  monthToMatch: string,\n): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter(\n        (item: ResourceAndItsPath) =>\n          MONTHS.find((t) => t.includes(monthToMatch.toLowerCase())) &&\n          resourceHasMonth(item.resource) &&\n          item.resource.mois &&\n          item.resource.mois.toLowerCase().includes(monthToMatch.toLowerCase()),\n      )\n    },\n  }\n  return criterion\n}\n\nexport function idCriterion(idToMatch: string): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter((item: ResourceAndItsPath) => {\n        if (\n          isExerciceItemInReferentiel(item.resource) ||\n          isTool(item.resource)\n        ) {\n          return item.resource.id\n            .toLowerCase()\n            .includes(idToMatch.toLowerCase())\n        } else {\n          return false\n        }\n      })\n    },\n  }\n  return criterion\n}\n\nexport function examCriterion(\n  examToMatch: string,\n): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter((item: ResourceAndItsPath) => {\n        // console.log('examToMatch.toLowerCase()')\n        // console.log(examToMatch.toLowerCase())\n        return (\n          EXAMS.includes(examToMatch.toLowerCase()) &&\n          item.resource.uuid.startsWith(examToMatch.toLowerCase())\n        )\n      })\n    },\n  }\n  return criterion\n}\n\nexport function yearCriterion(\n  yearToMatch: string,\n): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter((item: ResourceAndItsPath) => {\n        return (\n          YEARS.includes(yearToMatch) &&\n          isExamItemInReferentiel(item.resource) &&\n          item.resource.annee === yearToMatch\n        )\n      })\n    },\n  }\n  return criterion\n}\n\n/**\n * Construit un critre de filtration sur un sujet (chane de caractres).\n * La recherche s'effectue sur le titre (s'il y en a) ou sur le lieu (s'il y en a)\n * @param {String} subject le sujet  rechercher\n * @param {boolean} [isCanIncluded=false] doit-on inclure les exercices CAN dans le critre de la recherche\n * @returns { Criterion<ResourceAndItsPath>} un critre pour filtration\n */\nexport function subjectCriterion(\n  subject: string,\n  isCanIncluded: boolean = true,\n): Criterion<ResourceAndItsPath> {\n  const criterion: Criterion<ResourceAndItsPath> = {\n    meetCriterion(items: ResourceAndItsPath[]) {\n      return items.filter((item) => {\n        const subjectToLowerCaseWithoutAccent = stringWithNoAccent(\n          subject.toLowerCase(),\n        )\n        if (item.pathToResource.includes('CAN') && !isCanIncluded) {\n          return false\n        }\n        // on recherche un lieu\n        let placeMatch = false\n        if (resourceHasPlace(item.resource)) {\n          // si le sujet est un lieu et que la ressource a `lieu` dans ses proprit, on compare\n          placeMatch = stringWithNoAccent(\n            item.resource.lieu.toLowerCase(),\n          ).includes(subjectToLowerCaseWithoutAccent)\n        }\n        // on rechercher dans le titre\n        if (isExerciceItemInReferentiel(item.resource)) {\n          // la ressource est un exercice : elle a donc un titre\n          if (\n            stringWithNoAccent(item.resource.titre.toLowerCase()).includes(\n              subjectToLowerCaseWithoutAccent,\n            )\n          ) {\n            return true\n          } else {\n            return false || placeMatch\n          }\n        } else {\n          return false || placeMatch\n        }\n      })\n    },\n  }\n  return criterion\n}\n/**\n * Construit une liste de critres en les taguant ET ou OU\n * @param input chane de caractres pour l'inout\n * @param isCanIncluded flag pour l'inclusion des CAN\n * @returns liste d'objets du type {connector: 'ET'|'OU', filter: Criterion<ResourceAndItsPath>}\n */\nexport function buildCriteriaFromString(\n  input: string,\n  isCanIncluded: boolean = true,\n): Array<{ connector: 'ET' | 'OU'; filter: Criterion<ResourceAndItsPath> }> {\n  const criteria: Array<{\n    connector: 'ET' | 'OU'\n    filter: Criterion<ResourceAndItsPath>\n  }> = []\n  // on construit le tableau des mots recherchs en retirant les espaces superflus\n  // mais en prservant les chanes entre guillemets ou apostrophes\n  // pour l'ide, voir : https://stackoverflow.com/a/16261693/6625987\n  const re = /(?:[^\\s\"']+|['\"][^'\"]*[\"'])+/g\n  // on enlve les espace aux bornes et on partage la chane sur un ou plusieurs espace entre les mots (ainsi pas de chaine vide dans le tableau)\n  const regExpResult = input.trim().match(re)\n  const wordsTemp = regExpResult === null ? [] : [...regExpResult]\n  const words: string[] = []\n  // on traite les OU en dtectant les caractres | dans les chanes\n  for (const w of wordsTemp) {\n    if (w.includes('+')) {\n      // do somthing\n      const list = w.split('+')\n      const premier = list.shift()\n      if (premier) {\n        words.push(premier)\n      }\n      for (const w of list) {\n        words.push('+' + w)\n      }\n    } else {\n      words.push(w)\n    }\n  }\n  // console.log('words')\n  // console.log(words)\n  if (words.length === 0 || (words.length === 1 && words[0].length === 0)) {\n    // la chane explore ne doit pas tre vide\n    throw new Error('Search input should not be empty when building Criteria')\n  } else {\n    // on regarde si `CAN` est un mot pour inclure les exos CAN dans le critre de recherche\n    if (words.map((word) => word.toUpperCase()).includes('CAN')) {\n      isCanIncluded = true\n    }\n    // on nettoie les guillemets ou apostrophes si prsentes dans une chane\n    // (une chane peut tre : \"labyrinthe de multiples\", \"l'heure\", 'informations inutiles')\n    words.forEach((word, index, theArray) => {\n      let w = word\n      if (/^['\"]/.test(word)) {\n        // la chane contient un guillemet ou apostrophe au dbut\n        w = w.slice(1) // on retire le premier caractre\n      }\n      if (/['\"]$/.test(word)) {\n        // la chane contient un guillemet ou apostrophe  la fin\n        w = w.slice(0, -1) // on retire le dernier caractre\n      }\n      theArray[index] = w\n    })\n    // console.log('words (avant boucle)')\n    // console.log(words)\n    for (const word of words) {\n      const connector = word.startsWith('+') ? 'OU' : 'ET'\n      const realWord = word.replace('+', '')\n      // console.log('realWord: ' + realWord)\n      if (isLevelType(realWord)) {\n        // console.log('found level')\n        criteria.push({\n          connector,\n          filter: levelCriterion(realWord, isCanIncluded),\n        })\n        continue\n      }\n      if (EXAMS.includes(realWord.toLowerCase())) {\n        // console.log('found exam')\n        criteria.push({ connector, filter: examCriterion(realWord) })\n        continue\n      }\n      if (YEARS.includes(realWord)) {\n        // console.log('found year')\n        criteria.push({ connector, filter: yearCriterion(realWord) })\n        continue\n      }\n      // le mot n'est ni un niveau, ni un examen\n      // console.log('found subject')\n      criteria.push({\n        connector,\n        filter: new AtLeastOneOfCriteria([\n          subjectCriterion(realWord, isCanIncluded),\n          tagCriterion(realWord),\n          idCriterion(realWord),\n          monthCriterion(realWord),\n        ]),\n      })\n    }\n  }\n  return criteria\n}\n\n/**\n * Construit un critre unique bas sur la chane passe en paramtres.\n * Les mots prcds d'un signe `+` sont traits comme des critres ET\n * et les autres comme des critres OU.\n * @param input Chane de caractres utilise pour la fabrication des critres\n * @param isCanIncluded flag pour inclure les CAN\n * @returns un critre unique\n */\nexport function stringToCriterion(\n  input: string,\n  isCanIncluded: boolean = true,\n): Criterion<ResourceAndItsPath> {\n  if (input.length === 0) {\n    // la chane explore ne doit pas tre vide\n    throw new Error('Search input should not be empty when building Criteria')\n  } else {\n    const criteria = buildCriteriaFromString(input, isCanIncluded)\n    if (criteria.length === 1) {\n      // on a un seul critre : peut importe ET/OU\n      return criteria[0].filter\n    } else {\n      // on a au moins deux critres : on va inspecter la liste des critres :\n      // on va isoler les critres avec un connecteur ET\n      // et on va regrouper les critres avec un connecteur OU\n      // en un seul critre en en faisant l'union. Ainsi,\n      // on aura une seule liste de critres dont il faudra faire l'intersection\n      const justAndCriteria: Criterion<ResourceAndItsPath>[] = []\n      const orAssociations: Criterion<ResourceAndItsPath>[][] = []\n      let orListTransit: Criterion<ResourceAndItsPath>[] = []\n      // dans un premier temps, on regroupe les OU dans des listes\n      // et on isole les ET\n      criteria.forEach((item, i) => {\n        if (i === 0) {\n          // c'est le premier terme, on l'ajoute d'office\n          orListTransit.push(item.filter)\n        } else {\n          if (item.connector === 'OU') {\n            // l'lment courant a un connecteur OU\n            // on remplit la liste des OU\n            orListTransit.push(item.filter)\n          } else {\n            // l'lment courant a un connecteur ET\n            // on remplit la liste des associations\n            orAssociations.push(orListTransit)\n            // on purge la liste des OU\n            orListTransit = []\n            // on y met l'lment courant\n            orListTransit.push(item.filter)\n          }\n        }\n      })\n      // on ajoute la dernire liste de transit\n      orAssociations.push(orListTransit)\n      // on traite les listes : s'il y a un seul lment,\n      // on l'ajoute directement sinon on en fait l'union\n      orAssociations.forEach((list) => {\n        if (list.length === 1) {\n          // il y a un seul lments: il a forcment un critre ET on l'ajoute directement\n          justAndCriteria.push(list[0])\n        } else {\n          // il y a plusieurs rfrences, on doit en faire l'union\n          const [first, second, ...others] = [...list]\n          const orCriteriaUnion = new AtLeastOneOfCriteria<ResourceAndItsPath>([\n            first,\n            second,\n            ...others,\n          ])\n          justAndCriteria.push(orCriteriaUnion)\n        }\n      })\n      //  ce stade, il n'y a plus de connecteurs OU\n      // on fait l'intersection de tous les critres\n      const c = new MultiCriteria<ResourceAndItsPath>()\n      justAndCriteria.forEach((item) => c.addCriterion(item))\n      return c\n    }\n  }\n}\n","import { get, writable } from 'svelte/store'\nimport type {\n  DisplayedFilter,\n  FilterObject,\n  FilterType,\n} from '../../../../../lib/types'\nimport type {\n  Features,\n  JSONReferentielObject,\n  Level,\n  ResourceAndItsPath,\n} from '../../../../../lib/types/referentiels'\nimport {\n  levelCriterion,\n  type Criterion,\n  AtLeastOneOfCriteria,\n  featuresCriteria,\n  MultiCriteria,\n} from '../../../../../lib/components/filters'\nimport {\n  buildReferentiel,\n  getAllEndings,\n} from '../../../../../lib/components/refUtils'\n// pour sauvegarder les slections de filtres\nexport const allFilters = writable<\n  Record<FilterType, DisplayedFilter<string | Level>>\n>({\n  levels: {\n    '6e': {\n      title: 'Sixime',\n      values: ['6e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    '5e': {\n      title: 'Cinquime',\n      values: ['5e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    '4e': {\n      title: 'Quatrime',\n      values: ['4e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    '3e': {\n      title: 'Troisime',\n      values: ['3e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    college: {\n      title: 'Collge',\n      values: ['6e', '5e', '4e', '3e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    '2e': {\n      title: 'Seconde',\n      values: ['2e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    '1e': {\n      title: 'Premire',\n      values: ['1e'],\n      isSelected: false,\n      clicked: 0,\n    },\n    techno1: {\n      title: 'Premire Technologique',\n      values: ['techno1'],\n      isSelected: false,\n      clicked: 0,\n    },\n    'Terminale Expert': {\n      title: 'Terminale Expert',\n      values: ['Terminale Expert'],\n      isSelected: false,\n      clicked: 0,\n    },\n    'Terminale Sp': {\n      title: 'Terminale Spcialit',\n      values: ['Terminale Sp'],\n      isSelected: false,\n      clicked: 0,\n    },\n    HP: {\n      title: 'Hors-Programme (Lyce)',\n      values: ['HP'],\n      isSelected: false,\n      clicked: 0,\n    },\n    lycee: {\n      title: 'Lyce',\n      values: [\n        '2e',\n        '1e',\n        'techno1',\n        'Terminale Sp',\n        'Terminale Expert',\n        'HP',\n      ],\n      isSelected: false,\n      clicked: 0,\n    },\n  },\n  specs: {\n    amc: {\n      title: 'AMC (AutoMultipleChoice)',\n      values: ['amc'],\n      isSelected: false,\n      clicked: 0,\n    },\n    interactif: {\n      title: 'Interactif',\n      values: ['interactif'],\n      isSelected: false,\n      clicked: 0,\n    },\n    qcm: {\n      title: 'QCM',\n      values: ['qcm'],\n      isSelected: false,\n      clicked: 0,\n    },\n    qcmcam: {\n      title: 'exportable QcmCam',\n      values: ['qcmcam'],\n      isSelected: false,\n      clicked: 0,\n    },\n  },\n  types: {\n    alea: {\n      title: 'Alatoires seulement',\n      values: ['alea'],\n      isSelected: false,\n      clicked: 0,\n    },\n    static: {\n      title: 'Statiques seulement',\n      values: ['static'],\n      isSelected: false,\n      clicked: 0,\n    },\n    CAN: {\n      title: 'Course aux nombres',\n      values: ['CAN'],\n      isSelected: false,\n      clicked: 0,\n    },\n  },\n})\n\n/**\n * Retourne la liste de tous les niveaux slectionns\n * @returns {Level[]} la liste des niveaux slectionns dans les filtres\n */\nexport function getSelectedLevels(): Level[] {\n  const filters = get(allFilters)\n  const selectedLevels: Level[] = []\n  // on regarde les niveaux\n  Object.entries(filters.levels).forEach(([filter, level]) => {\n    if (filter !== 'college' && filter !== 'lycee') {\n      if (level.isSelected) {\n        selectedLevels.push(filter as Level)\n      }\n    }\n  })\n  // on regarde les types (qui sont des niveaux particuliers : CAN, static, etc.)\n  Object.entries(filters.types).forEach(([filter, level]) => {\n    if (level.isSelected) {\n      selectedLevels.push(filter as Level)\n    }\n  })\n  return selectedLevels\n}\n/**\n * Retourne la liste des filtres slectionns sous la forme d'objet comprenant le type, la cl et le contenu\n * @returns liste des filtres slectionns comme objects\n */\nexport function getSelectedFiltersObjects(): FilterObject<string | Level>[] {\n  const filters = get(allFilters)\n  const levels: FilterObject<string | Level>[] = []\n  // on regarde les niveaux\n  Object.entries(filters).forEach(([filterType, filterObject]) => {\n    Object.entries(filterObject).forEach(([key, obj]) => {\n      if (key !== 'college' && key !== 'lycee') {\n        if (obj.isSelected) {\n          levels.push({ type: filterType as FilterType, key, content: obj })\n        }\n      }\n    })\n  })\n  return levels\n}\n\n/**\n * Retourne la liste de toutes les fonctionnalits coches (AMC, interactif)\n * @returns liste de toutes les fonctionnalits coches\n */\nexport function getSelectedFeatures(): (keyof Features)[] {\n  const filters = get(allFilters)\n  const selectedFeatures: (keyof Features)[] = []\n  Object.entries(filters.specs).forEach(([key, spec]) => {\n    if (spec.isSelected) {\n      selectedFeatures.push(key as keyof Features)\n    }\n  })\n  return selectedFeatures\n}\n\n/**\n * Dslectionne les filtres lyce (ou collge) si une cl lyce (ou collge) est dslectionne\n * @param {string} key cl  inspecter\n */\nexport function handleUncheckingMutipleFilters(key: string) {\n  const filters = get(allFilters)\n  const clgKeys = [...filters.levels.college.values]\n  const lyceeKeys = [...filters.levels.lycee.values]\n  if (clgKeys.includes(key)) {\n    filters.levels.college.isSelected = false\n  }\n  if (lyceeKeys.includes(key)) {\n    filters.levels.lycee.isSelected = false\n  }\n}\n\n/**\n * Sur la base d'un rfrentiel pass en paramtre, construit un nouveau rfrentiel\n * sur la base de trois critres :\n * - les exercices AMC\n * - les exercices avec des QCM\n * - les exercices interactifs\n * - les niveaux de classe\n * @param {JSONReferentielObject} originalReferentiel Rfrentiel  filter\n * @param {boolean} isAmcOnlySelected flag pour limiter le rfrentiel aux exercices AMC\n * @param {boolean} isInteractiveOnlySelected flag pour limiter le rfrentiel aux exercices interactifs\n * @param {Level[]} levelsSelected flag pour limiter le rfrentiel aux exercices de certains niveaux\n * @returns {JSONReferentielObject} le rfrentiel filtr\n * @author sylvain\n */\nexport function updateReferentiel(\n  isQcmCamOnlySelected: boolean,\n  isQcmOnlySelected: boolean,\n  originalReferentiel: JSONReferentielObject,\n  isAmcOnlySelected: boolean,\n  isInteractiveOnlySelected: boolean,\n  levelsSelected: Level[], // les seuls niveaux accepts sont ceux stock dans codeList\n): JSONReferentielObject {\n  // on rcupre tous les exercices du rfrentiel pass en paramtre\n  let filteredList: ResourceAndItsPath[] = getAllEndings(originalReferentiel)\n  // on commence par crer les critres de filtration pour les spcificits (AMC et/ou Interactif)\n  const features: ('amc' | 'interactif' | 'qcm')[] = []\n  if (isAmcOnlySelected) {\n    features.push('amc')\n  }\n  if (isInteractiveOnlySelected) {\n    features.push('interactif')\n  }\n  if (isQcmOnlySelected) {\n    features.push('qcm')\n  }\n  if (isQcmCamOnlySelected) {\n    features.push('qcm')\n  }\n\n  if (features.length !== 0) {\n    // pas de liste de spcificits vide passe  `featuresCriteria`\n    filteredList = featuresCriteria(features).meetCriterion(filteredList)\n  }\n  // on traite les niveaux\n\n  switch (levelsSelected.length) {\n    case 0:\n      // pas de critre, on fait rie\n      break\n    case 1:\n      // un seul critre, on l'applique  la liste\n      filteredList = levelCriterion(levelsSelected[0]).meetCriterion(\n        filteredList,\n      )\n      break\n    default:\n      // il y a au moins deux critres : un tableau de critres par niveau\n      // puis union des critres\n      {\n        const levelsCriteria: Criterion<ResourceAndItsPath>[] = []\n        for (const level of levelsSelected) {\n          levelsCriteria.push(levelCriterion(level))\n        }\n        const [first, second, ...others] = [...levelsCriteria]\n        const unionOfCriteria: Criterion<ResourceAndItsPath> =\n          new AtLeastOneOfCriteria([first, second, ...others])\n        filteredList = unionOfCriteria.meetCriterion(filteredList)\n      }\n      break\n  }\n  return buildReferentiel(filteredList)\n}\n\n/**\n * Applique les filtres slectionns dans le store  une liste d'lment\n * de type `ResourceAndItsPath` et renvoie une liste du mme type trie\n * @param {ResourceAndItsPath[]} original liste originelle\n * @author sylvain\n */\nexport function applyFilters(\n  collection: ResourceAndItsPath[],\n): ResourceAndItsPath[] {\n  const original = [...collection]\n  // on rcupre dans le store les niveaux et les fonctionnalits cochs\n  const selectedLevels: Level[] = getSelectedLevels()\n  const selectedSpecs: (keyof Features)[] = getSelectedFeatures()\n  if (selectedLevels.length === 0 && selectedSpecs.length === 0) {\n    // pas de filtre coch : on renvoie l'original\n    return original\n  } else {\n    // on gre les niveaux cochs\n    let finalLevelsCriterion: Criterion<ResourceAndItsPath> | undefined\n    if (selectedLevels.length !== 0) {\n      const levelsCriteria: Criterion<ResourceAndItsPath>[] = []\n      for (const level of selectedLevels) {\n        levelsCriteria.push(levelCriterion(level))\n      }\n      // au moins un niveau coch !\n      if (levelsCriteria.length < 2) {\n        // un seul niveau coch\n        finalLevelsCriterion = levelsCriteria[0]\n      } else {\n        // au moins deux niveaux cochs, on fait l'UNION\n        const [first, second, ...others] = [...levelsCriteria]\n        finalLevelsCriterion = new AtLeastOneOfCriteria([\n          first,\n          second,\n          ...others,\n        ])\n      }\n    }\n    // on gre les fonctionnalits (AMC, interactif)\n    let specsCriteria: Criterion<ResourceAndItsPath> | undefined\n    if (selectedSpecs.length !== 0) {\n      specsCriteria = featuresCriteria(selectedSpecs)\n    }\n    if (finalLevelsCriterion !== undefined) {\n      if (specsCriteria !== undefined) {\n        // on a des niveaux ET des fonctionnalits cochs\n        return new MultiCriteria<ResourceAndItsPath>()\n          .addCriterion(finalLevelsCriterion)\n          .addCriterion(specsCriteria)\n          .meetCriterion(original)\n      } else {\n        // on a que des niveaux cochs\n        return finalLevelsCriterion.meetCriterion(original)\n      }\n    } else {\n      if (specsCriteria !== undefined) {\n        // on a que des fonctionnalits coces\n        return specsCriteria.meetCriterion(original)\n      }\n    }\n    return original\n  }\n}\n\nexport const filtersHaveChanged = writable<boolean>(false)\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import {\n    FILTER_SECTIONS_TITLES,\n    type FilterType,\n  } from '../../../../../../../lib/types'\n  import type { Level } from '../../../../../../../lib/types/referentiels'\n  import { allFilters, filtersHaveChanged } from '../../filtersStore'\n  import { getUniqueStringBasedOnTimeStamp } from '../../../../../../../lib/components/time'\n  export let filterType: FilterType = 'levels'\n  const timeTag: string = getUniqueStringBasedOnTimeStamp()\n  const dispatch = createEventDispatcher()\n  /**\n   * Grer le cochage des filtres. On a juste  grer les niveaux multiples\n   * collge et lyce qui concernent plusieurs niveaux.\n   * @remarks __Bizarrerie__ : Pour tre sr que la fonction callback de `subsribe` du store\n   * `allFilters` soit appele, on ajoute 1  la proprit `clicked`\n   * @param selectedEntry\n   */\n  function handleFiltersChanges(selectedEntry: Level | string) {\n    $filtersHaveChanged = true\n    if (filterType === 'levels') {\n      switch (selectedEntry) {\n        case 'college':\n        case 'lycee':\n          Object.values($allFilters.levels[selectedEntry].values).forEach(\n            (level) => {\n              // on met tous les niveaux college/lycee  `true` ou `false`\n              if ($allFilters.levels[selectedEntry].isSelected) {\n                $allFilters.levels[level].isSelected = true\n              } else {\n                $allFilters.levels[level].isSelected = false\n              }\n            },\n          )\n          $allFilters.levels[selectedEntry].clicked++\n          break\n        default:\n          $allFilters.levels[selectedEntry].clicked++\n          break\n      }\n      // on dcoche `college` si tous les niveaux de college ne sont pas cochs\n      $allFilters.levels.college.values.forEach((level) => {\n        if (!$allFilters.levels[level].isSelected) {\n          $allFilters.levels.college.isSelected = false\n        }\n      })\n      // on dcoche `lycee` si tous les niveaux de lycee ne sont pas cochs\n      $allFilters.levels.lycee.values.forEach((level) => {\n        if (!$allFilters.levels[level].isSelected) {\n          $allFilters.levels.lycee.isSelected = false\n        }\n      })\n    } else {\n      $allFilters[filterType][selectedEntry].clicked++\n    }\n  }\n</script>\n\n<div class=\"{`${$$props.class || ''} flex flex-col`}\">\n  <div\n    class=\"text-coopmaths-struct font-semibold text-sm px-1 border-b w-full border-coopmaths-struct\"\n  >\n    {FILTER_SECTIONS_TITLES[filterType]}\n  </div>\n  <div>\n    <ul class=\"w-full columns-[175px] gap-4 mt-2\">\n      {#each Object.entries($allFilters[filterType]) as [key, filter], i}\n        <li\n          class=\"flex-row justify-start items-center pr-4 pl-6 py-0 my-0 line-clamp-1 leading-none\"\n        >\n          <input\n            id=\"checkbox-{key}-{i}-{timeTag}\"\n            aria-describedby=\"checkbox-{key}-{i}-{timeTag}\"\n            type=\"checkbox\"\n            class=\"w-3 h-3 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark border-coopmaths-action text-coopmaths-action dark:border-coopmathsdark-action dark:text-coopmathsdark-action focus:ring-0 rounded\"\n            value=\"{key}\"\n            bind:checked=\"{filter.isSelected}\"\n            on:change=\"{() => {\n              handleFiltersChanges(key)\n              dispatch('filters-change')\n            }}\"\n          />\n          <label\n            for=\"checkbox-{key}-{i}-{timeTag}\"\n            class=\"ml-2 text-xs font-light text-coopmaths-corpus dark:text-coopmathsdark-corpus\"\n          >\n            {filter.title}\n          </label>\n        </li>\n      {/each}\n    </ul>\n  </div>\n</div>\n","<script lang=\"ts\">\n  import { createEventDispatcher } from 'svelte'\n  import type { CoopmathsColor } from '../../../../../../../lib/types'\n  export let text = ''\n  export let bgColor: CoopmathsColor = 'warn'\n  export let textColor: CoopmathsColor = 'corpus'\n  export let isVisible: boolean = true\n\n  // Au clic sur le bouton, on diffuse _action_\n  const dispatch = createEventDispatcher()\n\n  function triggerAction() {\n    dispatch('action', {\n      msg: 'Action triggered !',\n    })\n  }\n</script>\n\n<!--\n  @component\n  Chip avec bouton pour fermeture\n\n  ### Paramtres\n\n  * `text` : titre affich dans le chip\n  * `textColor` : couleur du texte\n  * `bgColor` : couleur de l'arrire-plan du chip\n  * `isVisible` : flag permettant de cacher le chip\n\n  ### Action\n\n  `action` est diffuse lorsque le bouton de fermeture est cliqu et sera rcupre dans le composant par `on:action`\n\n  ### Exemple\n  ```tsx\n  <Chip\n    text={(levelsMap.get(filter) ?? typesMap.get(filter)).title}\n    textColor=\"canvas\"\n    bgColor=\"struct\"\n    isVisible={selectedFilters.includes(filter)}\n    on:action={() => {\n      updateFilters(filter)\n    }}\n  />\n  ```\n -->\n\n<div\n  class=\"{isVisible\n    ? 'inline-flex'\n    : 'hidden'} flex-wrap scale-75 mr-1 items-center justify-center rounded-full bg-coopmaths-{bgColor} dark:bg-coopmathsdark-{bgColor} text-coopmaths-{textColor} dark:text-coopmathsdark-{textColor} text-xs px-2 py-[1px] shadow-sm\"\n>\n  {text}\n  <button\n    class=\"ml-1 bg-transparent hover focus:outline-none cursor-pointer\"\n    on:click=\"{triggerAction}\"\n  >\n    <i\n      class=\"text-coopmaths-action hover:text-coopmaths-action-lightest dark:text-coopmathsdark-action dark:hover:text-coopmathsdark-action-lightest bx bx-x font-semibold text-base\"\n    ></i>\n  </button>\n</div>\n","import {\n  isExamItemInReferentiel,\n  isExerciceItemInReferentiel,\n  isStaticType,\n  resourceHasMonth,\n  type ResourceAndItsPath,\n} from '../types/referentiels'\nimport { monthes } from './handleDate'\n\n/**\n * Un type pour dcomposer les chanes de caractres\n */\ntype StringDecomposition = {\n  index: number\n  value: string[]\n  o: string\n  s: string\n}\n\n/**\n * Un type pour faciliter le tri d'un tableau de resource\n */\ntype ResourceAndItsPathDecomposition = {\n  index: number\n  value: string[]\n  o: ResourceAndItsPath\n  s: string\n}\n\n/**\n * Dtecte si une chane est un nombre ou pas\n * @param v chaine  inspecter\n * @returns `true` si la chane contient un nombre\n */\nfunction thisStringRepresentsANumber(v: string) {\n  return (+v).toString() === v\n}\n\n/**\n * Trier deux objets dcrit par un tableau de chanes\n */\nconst customSorting = {\n  asc: function (a: StringDecomposition, b: StringDecomposition): number {\n    let i = 0\n    const l = Math.min(a.value.length, b.value.length)\n\n    while (i < l && a.value[i] === b.value[i]) {\n      i++\n    }\n    if (i === l) {\n      return a.value.length - b.value.length\n    }\n    if (\n      thisStringRepresentsANumber(a.value[i]) &&\n      thisStringRepresentsANumber(b.value[i])\n    ) {\n      return parseInt(a.value[i]) - parseInt(b.value[i])\n    }\n    return a.value[i].localeCompare(b.value[i])\n  },\n  desc: function (a: StringDecomposition, b: StringDecomposition): number {\n    return customSorting.asc(b, a)\n  },\n}\n\n/**\n * Trier deux objets dcrit par un tableau de chanes\n */\nconst customSortingForResources = {\n  asc: function (\n    a: ResourceAndItsPathDecomposition,\n    b: ResourceAndItsPathDecomposition,\n  ): number {\n    let i = 0\n    const l = Math.min(a.value.length, b.value.length)\n\n    while (i < l && a.value[i] === b.value[i]) {\n      i++\n    }\n    if (i === l) {\n      return a.value.length - b.value.length\n    }\n    if (\n      thisStringRepresentsANumber(a.value[i]) &&\n      thisStringRepresentsANumber(b.value[i])\n    ) {\n      return parseInt(a.value[i]) - parseInt(b.value[i])\n    }\n    return a.value[i].localeCompare(b.value[i])\n  },\n  desc: function (\n    a: ResourceAndItsPathDecomposition,\n    b: ResourceAndItsPathDecomposition,\n  ): number {\n    return customSortingForResources.asc(b, a)\n  },\n}\n\n/**\n * Trier un tableau de chanes de caractres contenant des tirets\n * comme `4A10`, `4A10-1` `4A10-10`, etc.\n * Source : https://stackoverflow.com/a/47051217\n * @param data tableau  trier\n * @param order `asc` (dfaut) ou `desc`\n */\nexport const sortArrayOfStringsWithHyphens = (\n  data: string[],\n  order: 'asc' | 'desc' = 'asc',\n) => {\n  // nettoyer les chanes en ne gardant que les lments lis par des tirets\n  // (comme `4-A10-1`) puis dstructurer cette chane\n  const mapped = data.map(function (el, i) {\n    const string = el.replace(/\\d(?=[a-z])|[a-z](?=\\.)/gi, '$&. .')\n    const regex = /(\\d+)|([^0-9.]+)/g\n    let m: RegExpExecArray | null\n    const parts = []\n\n    while ((m = regex.exec(string)) !== null) {\n      parts.push(m[0])\n    }\n    return { index: i, value: parts, o: el, s: string }\n  })\n  mapped.sort(customSorting[order] || customSorting.asc)\n  return mapped.map(function (el) {\n    return data[el.index]\n  })\n}\n\n/**\n * Transforme les ID des exercices d'automatisme afin de prserver\n * leur positionnement en fin de liste d'une section lors de l'organisation du rfrentiel.\n * La chane auto6N2A devient 6N2zzzzzA, auto6N2A-1 devient 6N2zzzzzA-1, etc.\n * @param input ID  transformer\n * @returns la chane avec le `zzzzz` insre aprs les trois premiers caractres\n */\nfunction transformAutomatismId(input: string): string {\n  // Expression rgulire pour matcher le pattern dcrit\n  // auto + chiffre + lettre majuscule + chiffre + reste\n  const regex = /^auto(\\d)([A-Z])(\\d)(.*)?/gm\n  const match = [...input.matchAll(regex)]\n\n  // Si la chane ne correspond pas au pattern, retourner l'input inchang\n  if (match.length === 0) {\n    return input\n  }\n\n  // Extraction des groupes capturs\n  const [, digit1, letter, digit2, optionalSuffix] = [...match[0]]\n\n  // Construction de la nouvelle chane\n  // Format: chiffre + lettre + chiffre + \"zzzzz\" + dernire partie + suffixe optionnel\n  const result = `${digit1}${letter}${digit2}zzzzz${optionalSuffix || ''}`\n\n  return result\n}\n\n/**\n * Trie une liste de ressources sur la base d'une proprit (uuid ou id).\n * L'ordre tient compte des tirets : par exemple, `4-C10`, viendra avant `4-C10-1`\n * qui viendra lui-mme avant `4-C10-10`\n * @param data la liste  trier\n * @param key la proprit sur laquelle va s'oprer le tri\n * @param order l'ordre du tri (ascendant ou descendant)\n * @returns la liste trie\n * @see https://stackoverflow.com/a/47051217\n */\nexport const sortArrayOfResourcesBasedOnProp = (\n  data: ResourceAndItsPath[],\n  key: 'uuid' | 'id',\n  order: 'asc' | 'desc' = 'asc',\n): ResourceAndItsPath[] => {\n  if (data.length === 0) {\n    return data\n  }\n  const mapped = data.map((elt, i) => {\n    const r = elt.resource\n    let string: string\n    if (isExerciceItemInReferentiel(r) && key === 'id') {\n      string = transformAutomatismId(r[key])\n      string = string.replace(/\\d(?=[a-z])|[a-z](?=\\.)/gi, '$&. .')\n    } else if (isStaticType(r) && key === 'uuid') {\n      string = r[key].replace(/\\d(?=[a-z])|[a-z](?=\\.)/gi, '$&. .')\n    } else {\n      throw new Error(`La cl ${key} n'existe pas dans les ressources  trier.`)\n    }\n    const regex = /(\\d+)|([^0-9.]+)/g\n    let m: RegExpExecArray | null\n    const parts = []\n\n    while ((m = regex.exec(string)) !== null) {\n      parts.push(m[0])\n    }\n    return { index: i, value: parts, o: elt, s: string }\n  })\n  mapped.sort(customSortingForResources[order] || customSortingForResources.asc)\n  return mapped.map(function (el) {\n    return data[el.index]\n  })\n}\n\n/**\n * Trie une liste de ressources suivant l'anne et ventuellement le mois\n * @param data liste de ressources\n * @param order ordre de tri (ascendant ou descendant)\n * @returns la liste trie\n */\nexport const sortArrayOfResourcesBasedOnYearAndMonth = (\n  data: ResourceAndItsPath[],\n  order: 'asc' | 'desc' = 'asc',\n): ResourceAndItsPath[] => {\n  if (data.length === 0) {\n    return data\n  }\n  return data.sort((a, b) => {\n    // seuls les ressources de type examens ont des proprits `annee` et des fois `mois`\n    if (\n      isExamItemInReferentiel(a.resource) &&\n      isExamItemInReferentiel(b.resource)\n    ) {\n      const resourceAYear = parseInt(a.resource.annee)\n      const resourceBYear = parseInt(b.resource.annee)\n      if (resourceAYear !== resourceBYear) {\n        switch (order) {\n          case 'asc':\n            return resourceAYear - resourceBYear\n          case 'desc':\n            return resourceBYear - resourceAYear\n          default:\n            return 0\n        }\n      }\n      if (resourceHasMonth(a.resource) && resourceHasMonth(b.resource)) {\n        const resourceAMonth = monthes.indexOf(a.resource.mois!)\n        const resourceBMonth = monthes.indexOf(b.resource.mois!)\n        switch (order) {\n          case 'asc':\n            return resourceAMonth - resourceBMonth\n          case 'desc':\n            return resourceBMonth - resourceAMonth\n          default:\n            return 0\n        }\n      } else {\n        return 0\n      }\n    } else {\n      return 0\n    }\n  })\n}\n/**\n * Trie selon l'ordre alphabtique ou numrique\n * @param a nombre ou chane de caractres\n * @param b nombre ou chane de caractres\n * @returns le rsultat de la comparaison\n */\n// Define a custom sorting function\nexport const customSortStringNumber = (\n  a: number | string,\n  b: number | string,\n): number => {\n  if (typeof a === 'number' && typeof b === 'number') {\n    return a - b\n  } else {\n    return String(a).localeCompare(String(b))\n  }\n}\n\ntype Order = 'asc' | 'desc' | 'ascStringdescNumber'\n\n// Fonction qui divise une chane en parties numriques et non numriques (pour mettre dans l'ordre sujet1, sujet2 et sujet10)\nfunction splitAlphaNumeric(str: string): (string | number)[] {\n  return str\n    .split(/(\\d+)/)\n    .map((part) => (isNaN(Number(part)) ? part : Number(part)))\n}\n\n// Fonction de comparaison prenant en compte les parties numriques et les majuscules accentues\nfunction compareAlphaNumeric(a: string, b: string, order: Order): number {\n  const aParts = splitAlphaNumeric(a)\n  const bParts = splitAlphaNumeric(b)\n\n  for (let i = 0; i < Math.max(aParts.length, bParts.length); i++) {\n    const aPart = aParts[i] ?? ''\n    const bPart = bParts[i] ?? ''\n\n    if (typeof aPart === 'number' && typeof bPart === 'number') {\n      if (aPart !== bPart) {\n        // console.log(a +':' + b +'=>n' + aPart +':'+ bPart + ':' + (aPart - bPart))\n        return order === 'asc' ? aPart - bPart : bPart - aPart\n      }\n    } else if (aPart !== bPart) {\n      // Utiliser localeCompare pour comparer les chanes de manire insensible aux accents et  la casse\n      const comparison = (aPart as string)\n        .normalize('NFD')\n        .localeCompare((bPart as string).normalize('NFD'), undefined, {\n          sensitivity: 'base',\n        })\n      if (comparison !== 0) {\n        // console.log(a +':' + b +'=>s' + aPart +':'+ bPart + ':'+ (comparison))\n        return order === 'asc' || order === 'ascStringdescNumber'\n          ? comparison\n          : -comparison\n      }\n    }\n  }\n  return 0\n}\n\n/**\n * Trie les annales selon le type (bac, brevet.... par thme ou par anne) puis suivant l'anne ou le thme puis suivant le nom (donc rangement alphabtique)\n * @param {ResourceAndItsPath[]} data liste de ressources\n * @param {'asc' | 'desc' | 'ascStringdescNumber'} order ordre de tri (ascendant ou descendant)\n * ascStringdescNumber : ascendant pour les strings et descandants pour les nombres (car les nombres sont des annes)\n * @returns {ResourceAndItsPath[]} la liste trie\n * @author Eric Elter\n */\n\n// Exemple d'utilisation : Ne pas supprimer car c'est pratique pour des tests.\n/* const data: DataItem[] = [\n  {\n    pathToResource: ['Paris1', 'Agrandissement-rduction', 'dnb_2013_04_pondichery_5'],\n    resource: { uuid: 'dnb_2013_04_pondichery_5', annee: '2013', lieu: 'Pondichry' }\n  },\n  {\n    pathToResource: ['Paris11', 'Agrandissement-rduction', 'dnb_2023_04_pondichery_5'],\n    resource: { uuid: 'dnb_2023_04_pondichery_5', annee: '2023', lieu: 'Pondichry' }\n  },\n  {\n    pathToResource: ['Paris2', 'Agrandissement-rduction', 'dnb_2013_04_pondichery_5'],\n    resource: { uuid: 'dnb_2013_04_pondichery_5', annee: '2013', lieu: 'Pondichry' }\n  }\n] */\nexport const triAnnales = (\n  data: ResourceAndItsPath[],\n  order: Order = 'asc',\n): ResourceAndItsPath[] => {\n  if (data.length > 0) {\n    data.sort((a, b) => {\n      // Premier critre de tri : pathToResource[0]\n      let result = compareAlphaNumeric(\n        a.pathToResource[0],\n        b.pathToResource[0],\n        order,\n      )\n      if (result !== 0) return result\n\n      // Deuxime critre de tri : pathToResource[1] (si disponible)\n      if (a.pathToResource[1] && b.pathToResource[1]) {\n        result = compareAlphaNumeric(\n          a.pathToResource[1],\n          b.pathToResource[1],\n          order,\n        )\n        if (result !== 0) return result\n      }\n\n      // Troisime critre de tri : pathToResource[2] (si disponible)\n      if (a.pathToResource[2] && b.pathToResource[2]) {\n        result = compareAlphaNumeric(\n          a.pathToResource[2],\n          b.pathToResource[2],\n          order,\n        )\n        if (result !== 0) return result\n      }\n\n      // Si tout est gal\n      return 0\n    })\n  }\n  return data\n}\n","<script lang=\"ts\">\n  import { createEventDispatcher, onDestroy, onMount, tick } from 'svelte'\n  import { stringToCriterion } from '../../../../../../../lib/components/filters'\n  import {\n    isExerciceItemInReferentiel,\n    isTool,\n    type ExerciceItemInReferentiel,\n    type ResourceAndItsPath,\n    type ToolItemInReferentiel,\n    type Level,\n    isStaticType,\n    isExamItemInReferentiel,\n  } from '../../../../../../../lib/types/referentiels'\n  import {\n    allFilters,\n    getSelectedFiltersObjects,\n    handleUncheckingMutipleFilters,\n    filtersHaveChanged,\n  } from '../../filtersStore'\n  import type { FilterObject } from '../../../../../../../lib/types'\n  import {\n    getUniqueStringBasedOnTimeStamp,\n    debounce,\n  } from '../../../../../../../lib/components/time'\n  import Filtres from './Filtres.svelte'\n  import Chip from './Chip.svelte'\n  import type { Unsubscriber } from 'svelte/store'\n  import ButtonIcon from '../../../../../../shared/forms/ButtonIcon.svelte'\n  import {\n    sortArrayOfResourcesBasedOnProp,\n    sortArrayOfResourcesBasedOnYearAndMonth,\n  } from '../../../../../../../lib/components/sorting'\n  export let origin: ResourceAndItsPath[]\n  export let results: ResourceAndItsPath[] = []\n  export let addExercise: (uuid: string, id: string) => void\n  export let inputSearch: string = ''\n\n  let searchField: HTMLInputElement\n  let isFiltersVisible: boolean = false\n  let selectedFilters: FilterObject<string | Level>[] = []\n  let lastInput: string = ''\n  let isInputFocused = false\n  let isCtrlDown: boolean = false\n  let isKDown: boolean = false\n  let isEnterDown: boolean = false\n  let unsubscribeToFiltersStore: Unsubscriber\n\n  const dispatch = createEventDispatcher()\n  const timeStamp = getUniqueStringBasedOnTimeStamp()\n  const fetchResults = debounce<typeof updateResults>(updateResults, 500)\n  const inputSearchSamples = [\n    'pythagore',\n    '3e proba',\n    'dnb+3e stat',\n    'bac asie python',\n    'crpe 2016+2015 aires',\n  ]\n\n  onMount(() => {\n    typeWriter(`#searchInputField-${timeStamp}`, inputSearchSamples, true)\n    unsubscribeToFiltersStore = allFilters.subscribe(() => {\n      selectedFilters = [...getSelectedFiltersObjects()]\n    })\n  })\n\n  onDestroy(() => {\n    if (unsubscribeToFiltersStore) unsubscribeToFiltersStore()\n  })\n\n  $: if (inputSearch != null && inputSearch.length !== 0) {\n    handleInput(inputSearch)\n  } else {\n    results.length = 0\n  }\n\n  // ===================================================================================\n  //\n  //                                Gestion de la recherche\n  //\n  // ===================================================================================\n  function updateResults(input: string): void {\n    if (input == null || input.length === 0) {\n      results.length = 0\n    } else {\n      const resultsWithDuplicates = getResults(input)\n      const unsortedResults = getUniques(resultsWithDuplicates)\n      // on ordonne la liste de recherche\n      // tri des exercices par type\n      let nonStatics: ResourceAndItsPath[] = []\n      let statics: ResourceAndItsPath[] = []\n      const others: ResourceAndItsPath[] = []\n      for (const item of unsortedResults) {\n        if (isExerciceItemInReferentiel(item.resource)) {\n          nonStatics.push(item)\n        } else if (isStaticType(item.resource)) {\n          statics.push(item)\n        } else {\n          others.push(item)\n        }\n      }\n      // ordonner les exercices dans chaque catgorie :\n      // -- anne/mois dcroissant pour examens\n      // -- id ordre alpha pour les exercices\n      nonStatics = [...sortArrayOfResourcesBasedOnProp(nonStatics, 'id')]\n      statics = [\n        ...sortArrayOfResourcesBasedOnYearAndMonth(statics, 'desc'),\n      ].sort((eltA, eltB) => {\n        // ranger dans les sujets d'examens identiques par numro d'exercices croissant\n        const nameA = eltA.resource.uuid.slice(0, -1)\n        const nameB = eltB.resource.uuid.slice(0, -1)\n        if (nameA.localeCompare(nameB) === 0) {\n          if (\n            isExamItemInReferentiel(eltA.resource) &&\n            isExamItemInReferentiel(eltB.resource)\n          ) {\n            return (\n              parseInt(eltA.resource.numeroInitial) -\n              parseInt(eltB.resource.numeroInitial)\n            )\n          } else {\n            return 0\n          }\n        } else {\n          return 0\n        }\n      })\n      results = [...nonStatics, ...statics, ...others]\n    }\n  }\n\n  function getResults(input: string) {\n    if (input.length === 0) {\n      return []\n    } else {\n      return [...stringToCriterion(input, true).meetCriterion(origin)]\n    }\n  }\n\n  function getUniques(results: ResourceAndItsPath[]) {\n    const uniques: ResourceAndItsPath[] = []\n    const treatedUuids: string[] = []\n    for (const elt of results) {\n      if (!treatedUuids.includes(elt.resource.uuid)) {\n        treatedUuids.push(elt.resource.uuid)\n        uniques.push(elt)\n      }\n    }\n    return uniques\n  }\n\n  function handleInput(input: string) {\n    const beginsWithQuote = input.replace(/^[\\s\"']/, '').length === 0\n    if (input == null || input.length === 0 || beginsWithQuote) {\n      results.length = 0\n    } else {\n      if (input !== lastInput) {\n        lastInput = input\n        fetchResults(input)\n      }\n      if ($filtersHaveChanged) {\n        $filtersHaveChanged = false\n        fetchResults(input)\n      }\n    }\n  }\n\n  export const triggerUpdate = (): void => {\n    if (inputSearch != null && inputSearch.length !== 0) {\n      handleInput(inputSearch)\n    }\n  }\n\n  // ===================================================================================\n  //\n  //                                Gestion du clavier\n  //\n  // ===================================================================================\n  function onFocusInput() {\n    isInputFocused = true\n  }\n  function onBlurInput() {\n    isInputFocused = false\n  }\n\n  /**\n   * Recherche si la chane de l'input correspond  une ID de la liste des rsultats.\n   * @returns {ExerciceItemInReferentiel|ToolItemInReferentiel|null} renvoie l'exercice trouv ou `null`\n   */\n  function matchOnResultsList(\n    inputSearch: string,\n  ): ExerciceItemInReferentiel | ToolItemInReferentiel | null {\n    if (inputSearch == null || inputSearch.length === 0) return null\n    for (const result of results) {\n      if (\n        isExerciceItemInReferentiel(result.resource) ||\n        isTool(result.resource)\n      ) {\n        if (inputSearch === result.resource.id) {\n          return result.resource\n        }\n      }\n    }\n    return null\n  }\n  /**\n   * Si Entre et qu'un seul exercice matche alors on ajoute l'exercice  la liste\n   */\n  function onEnterDown() {\n    const matchingResource = matchOnResultsList(inputSearch)\n    if (matchingResource !== null) {\n      addExercise(matchingResource.uuid, matchingResource.id)\n    }\n  }\n  /**\n   *\n   * @param event\n   */\n  function onKeyDown(event: KeyboardEvent) {\n    if (event.repeat) return\n    switch (event.key) {\n      case 'Control':\n        isCtrlDown = true\n        event.preventDefault()\n        break\n      case 'k':\n        isKDown = true\n        break\n      case 'Enter':\n        if (isInputFocused) {\n          isEnterDown = true\n        }\n        event.preventDefault()\n        break\n    }\n    if (isCtrlDown && isKDown) {\n      // https://svelte.dev/repl/48bd3726b74c4329a186838ce645099b?version=3.46.4\n      getFocusOnSearchInput()\n    }\n    if (isEnterDown) {\n      onEnterDown()\n    }\n  }\n\n  function onKeyUp(event: KeyboardEvent) {\n    switch (event.key) {\n      case 'Control':\n        isCtrlDown = false\n        event.preventDefault()\n        break\n      case 'k':\n        isKDown = false\n        event.preventDefault()\n        break\n      case 'Enter':\n        isEnterDown = false\n        break\n    }\n  }\n  const getFocusOnSearchInput = async () => {\n    await tick()\n    searchField.focus()\n  }\n  /**\n   * Permet d'afficher squentiellement une liste de chanes de caractres\n   * dans un champ de recherche  la place du placeholder\n   * @see https://stackoverflow.com/a/57903237/6625987\n   * @param selectorTarget\n   * @param textList\n   * @param placeholder\n   * @param i\n   * @param textListI\n   * @param delayMs\n   */\n  function typeWriter(\n    selectorTarget: string,\n    textList: string[],\n    placeholder = false,\n    i = 0,\n    textListI = 0,\n    delayMs = 100,\n  ) {\n    if (lastInput === '') {\n      if (!i) {\n        if (placeholder) {\n          const inputDiv = document.querySelector(\n            selectorTarget,\n          ) as HTMLInputElement\n          if (inputDiv) {\n            inputDiv.placeholder = ''\n          }\n        } else {\n          const inputDiv = document.querySelector(\n            selectorTarget,\n          ) as HTMLInputElement\n          if (inputDiv) {\n            inputDiv.innerHTML = ''\n          }\n        }\n      }\n      const txt = textList[textListI]\n      if (i < txt.length) {\n        if (placeholder) {\n          const inputDiv = document.querySelector(\n            selectorTarget,\n          ) as HTMLInputElement\n          if (inputDiv) {\n            inputDiv.placeholder += txt.charAt(i)\n          }\n        } else {\n          const inputDiv = document.querySelector(\n            selectorTarget,\n          ) as HTMLInputElement\n          if (inputDiv) {\n            inputDiv.innerHTML += txt.charAt(i)\n          }\n        }\n        i++\n        setTimeout(\n          typeWriter,\n          delayMs,\n          selectorTarget,\n          textList,\n          placeholder,\n          i,\n          textListI,\n        )\n      } else {\n        textListI++\n        if (typeof textList[textListI] === 'undefined') {\n          setTimeout(\n            typeWriter,\n            delayMs * 7,\n            selectorTarget,\n            textList,\n            placeholder,\n          )\n        } else {\n          i = 0\n          setTimeout(\n            typeWriter,\n            delayMs * 7,\n            selectorTarget,\n            textList,\n            placeholder,\n            i,\n            textListI,\n          )\n        }\n      }\n    } else {\n      const inputDiv = document.querySelector(\n        selectorTarget,\n      ) as HTMLInputElement\n      if (inputDiv) {\n        inputDiv.placeholder = ' Thme, identifiant...'\n      }\n    }\n  }\n</script>\n\n<!--\n  @component\n  Champ de texte pour recherche d'exercices\n  ### Paramtres\n  - **origin** (_ResourceAndItsPath[]_) : le rfrentiel  rechercher (dplier dans un tableau)\n  - **result** (_ResourceAndItsPath[]_) : la liste des entres correspondant au texte dans le champ de recherche\n -->\n<svelte:window on:keydown=\"{onKeyDown}\" on:keyup=\"{onKeyUp}\" />\n<div class=\"flex flex-col justify-start items-center\">\n  <div class=\"relative flex flex-col w-full\">\n    <input\n      type=\"search\"\n      id=\"searchInputField-{timeStamp}\"\n      class=\"w-full border border-coopmaths-action dark:border-coopmathsdark-action focus:border-coopmaths-action-lightest dark:focus:border-coopmathsdark-action-lightest focus:outline-0 focus:ring-0 focus:border-1 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark text-coopmaths-corpus-light dark:text-coopmathsdark-corpus-light text-sm placeholder-coopmaths-corpus-lightest dark:placeholder-coopmathsdark-corpus-lightest placeholder:italic placeholder-opacity-50\"\n      placeholder=\" Thme, identifiant...\"\n      bind:value=\"{inputSearch}\"\n      bind:this=\"{searchField}\"\n      on:focus=\"{onFocusInput}\"\n      on:blur=\"{onBlurInput}\"\n      autocomplete=\"off\"\n      autocorrect=\"off\"\n      name=\"notASearchField\"\n    />\n    <!-- Invite pour presser Entre lors d'un match input = ID d'exo -->\n    <div\n      class=\"absolute -bottom-6 {matchOnResultsList(inputSearch) !== null &&\n      isInputFocused\n        ? 'flex'\n        : 'hidden'} items-center pl-1 italic font-extralight text-xs text-coopmaths-corpus-lightest dark:text-coopmathsdark-corpus-lightest\"\n    >\n      Presser <span class=\"font-normal mx-1\">Entre</span> pour ajouter l'exercice\n    </div>\n    <!-- Bouton pour effacer l'input de recherche -->\n    <ButtonIcon\n      icon=\"bxs-tag-x text-2xl\"\n      class=\"absolute right-2 top-1\"\n      disabled=\"{inputSearch.length === 0}\"\n      on:click=\"{() => {\n        inputSearch = ''\n      }}\"\n    />\n    <!-- Bouton pour afficher les filtres -->\n    <button\n      type=\"button\"\n      class=\"absolute right-2 -bottom-6 text-sm text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest hover:dark:text-coopmathsdark-action-lightest\"\n      on:click=\"{() => {\n        isFiltersVisible = !isFiltersVisible\n      }}\"\n    >\n      Filtrer les exercices <i class=\"bx bx-filter-alt\"></i>\n    </button>\n  </div>\n  <!-- Chips des filtres -->\n  <div\n    class=\"{selectedFilters.length === 0\n      ? 'hidden'\n      : 'flex w-full flex-row flex-wrap justify-start text-sm mt-6 leading-tight'}\"\n  >\n    {#each selectedFilters as filter}\n      <Chip\n        text=\"{filter.content.title}\"\n        textColor=\"canvas\"\n        bgColor=\"struct\"\n        isVisible=\"{true}\"\n        on:action=\"{() => {\n          $allFilters[filter.type][filter.key].isSelected = false\n          handleUncheckingMutipleFilters(filter.key)\n          dispatch('filters-change')\n          $filtersHaveChanged = true\n          triggerUpdate()\n        }}\"\n      />\n    {/each}\n  </div>\n  <!-- Filtres -->\n  <div class=\"{isFiltersVisible ? 'flex flex-col w-full mt-4' : 'hidden'}\">\n    <Filtres class=\"mt-2\" filterType=\"levels\" on:filters-change />\n    <Filtres class=\"mt-2\" filterType=\"specs\" on:filters-change />\n    <Filtres class=\"mt-2\" filterType=\"types\" on:filters-change />\n  </div>\n</div>\n","<script lang=\"ts\">\n  import SearchInput from './searchInput/SearchInput.svelte'\n  import ReferentielEnding from '../referentielNode/ReferentielEnding.svelte'\n  import type { ResourceAndItsPath } from '../../../../../../lib/types/referentiels'\n  import type { SvelteComponent } from 'svelte'\n  interface SearchInputType extends SvelteComponent {\n    triggerUpdate: () => void\n  }\n  export let resourcesSet: ResourceAndItsPath[]\n  export let addExercise: (uuid: string, id: string) => void\n  let foundResources: ResourceAndItsPath[] = []\n  let inputSearch: string = ''\n  let searchInput: SearchInputType\n  export const triggerUpdateFromSearchBlock = (): void =>\n    searchInput.triggerUpdate()\n</script>\n\n<!--\n  @component\n  Bloc de recherche comprenant~:\n  - un champ texte pour saisir la recherche\n  - la liste des rsultats ventuels de la recherche\n  #### Paramtres\n  - `resourcesSet` : l'ensemble des resources  chercher sous la forme\n  d'une liste d'objets de type `ResourceAndItsPath`\n -->\n<div class=\"{`${$$props.class || ''}`}\">\n  <div class=\"p-4\">\n    <SearchInput\n      bind:this=\"{searchInput}\"\n      origin=\"{resourcesSet}\"\n      bind:results=\"{foundResources}\"\n      bind:inputSearch\n      on:filters-change\n      {addExercise}\n    />\n  </div>\n  <ul\n    class=\"{inputSearch.length === 0 || foundResources.length === 0\n      ? 'hidden'\n      : 'flex flex-col justify-start w-full mt-4 mx-0 p-4 text-[10px] bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark'} \"\n  >\n    {#each foundResources as foundResource}\n      <li>\n        <ReferentielEnding\n          ending=\"{foundResource.resource}\"\n          nestedLevelCount=\"{1}\"\n        />\n      </li>\n    {/each}\n  </ul>\n</div>\n","<script>\n  import { getContext } from 'svelte'\n  const { toggleThirdAppsChoiceDialog } = getContext('thirdAppsChoiceContext')\n</script>\n\n<button\n  type=\"button\"\n  class=\"{`${$$props.class || ''} font-bold text-xl text-coopmaths-struct dark:text-coopmathsdark-struct`}\"\n  on:click=\"{toggleThirdAppsChoiceDialog}\"\n>\n  Applications tierces\n</button>\n","// Ce store est ddi au stockage des rfrentiels et des outils de leur volution\nimport { get, writable } from 'svelte/store'\nimport referentielAleaCH from '../../json/referentiel2022CH.json'\nimport referentielAlea from '../../json/referentiel2022FR.json'\nimport referentielBibliotheque from '../../json/referentielBibliotheque.json'\nimport referentielGeometrieDynamique from '../../json/referentielGeometrieDynamique.json'\nimport referentielProfs from '../../json/referentielProfs.json'\nimport referentielRessources from '../../json/referentielRessources.json'\nimport referentielsActivation from '../../json/referentielsActivation.json'\nimport referentielExamsCH from '../../json/referentielStaticCH.json'\nimport referentielExams from '../../json/referentielStaticFR.json'\nimport {\n  buildReferentiel,\n  getAllEndings,\n  getRecentExercices,\n} from '../components/refUtils'\nimport {\n  sortArrayOfResourcesBasedOnProp,\n  triAnnales,\n} from '../components/sorting'\nimport type { Language } from '../types/languages'\nimport type {\n  ActivationName,\n  JSONReferentielObject,\n  ReferentielInMenu,\n  ResourceAndItsPath,\n} from '../types/referentiels'\n\nfunction createoriginalReferentielsFR() {\n  /**\n   * Constitutions des rfrentiels franais\n   */\n  // on trie les examens dans l'ordre inverse des annes/mois\n  const examsReferentiel: JSONReferentielObject = { ...referentielExams }\n  const activations: Record<ActivationName, boolean> = {\n    ...referentielsActivation,\n  }\n  const examens = getAllEndings(examsReferentiel)\n  // MGu: c'est tri dans ReferentielNode\n  // examens = triAnnales(examens, 'ascStringdescNumber')\n  const orderedExamsReferentiel = buildReferentiel(examens)\n  const baseReferentiel: JSONReferentielObject = { ...referentielAlea }\n  const referentielOutils: JSONReferentielObject = { ...referentielProfs }\n  const referentielHtml: JSONReferentielObject = { ...referentielRessources }\n  const biblioReferentiel: JSONReferentielObject = {\n    ...referentielBibliotheque,\n  }\n  const baseGeometrieDynamiqueReferentiel: JSONReferentielObject = {\n    ...referentielGeometrieDynamique,\n  }\n  // on ajoute les nouveauts\n  const newExercises: ResourceAndItsPath[] = getRecentExercices(baseReferentiel)\n  const newExercisesReferentiel: JSONReferentielObject = {}\n  for (const item of newExercises) {\n    newExercisesReferentiel[\n      item.pathToResource[item.pathToResource.length - 1]\n    ] = { ...item.resource }\n  }\n\n  // on trie les exercice alatoires par ID ('4-C10' < '4-C10-1' <'4-C10-10')\n  // EE : Puisqu'on a dj le rfrentiel, je ne comprends pas  quoi cela sert\n  // d'autant que cela change les ordres alphabtiques pour les terminales.\n  // Bon, j'ai compris mais comme les exos de terminales n'ont pas une entte cohrente alphabtiquement, on n'a pas le choix\n  // que d'enlever ces lignes.\n\n  const baseAndNewsReferentiel: JSONReferentielObject = {\n    Nouveauts: { ...newExercisesReferentiel },\n    ...baseReferentiel,\n  }\n  let exercices = getAllEndings(baseAndNewsReferentiel)\n  exercices = [...sortArrayOfResourcesBasedOnProp(exercices, 'id')]\n\n  const aleaReferentiel = buildReferentiel(exercices)\n\n  const exercicesGeometrieDynamique = getAllEndings(\n    baseGeometrieDynamiqueReferentiel,\n  )\n  const geometrieDynamiqueReferentiel = buildReferentiel(\n    exercicesGeometrieDynamique,\n  )\n  // rfrentiel original\n  const allReferentielsInMenus: ReferentielInMenu[] = [\n    {\n      title: 'Exercices alatoires',\n      name: 'aleatoires',\n      searchable: true,\n      referentiel: aleaReferentiel,\n    },\n    {\n      title: 'Annales examens',\n      name: 'examens',\n      searchable: true,\n      referentiel: orderedExamsReferentiel,\n    },\n    {\n      title: 'Gomtrie dynamique',\n      name: 'geometrieDynamique',\n      searchable: false,\n      referentiel: geometrieDynamiqueReferentiel,\n    },\n    {\n      title: 'Outils',\n      name: 'outils',\n      searchable: false,\n      referentiel: referentielOutils,\n    },\n    {\n      title: 'Vos ressources',\n      name: 'ressources',\n      searchable: false,\n      referentiel: referentielHtml,\n    },\n    {\n      title: 'Bibliothque',\n      name: 'statiques',\n      searchable: false,\n      referentiel: biblioReferentiel,\n    },\n  ]\n  const activatedReferentielsInMenu: ReferentielInMenu[] = []\n  for (const ref of allReferentielsInMenus) {\n    if (activations[ref.name]) {\n      activatedReferentielsInMenu.push(ref)\n    }\n  }\n  const originalReferentiels = [...activatedReferentielsInMenu]\n  return originalReferentiels\n}\n\nfunction createoriginalReferentielsCH() {\n  /**\n   * Constitutions des rfrentiels suisses\n   */\n  // on trie les examens dans l'ordre inverse des annes/mois\n  const examsReferentielCH: JSONReferentielObject = { ...referentielExamsCH }\n  const activations: Record<ActivationName, boolean> = {\n    ...referentielsActivation,\n  }\n  let examensCH = getAllEndings(examsReferentielCH)\n  examensCH = [...triAnnales(examensCH, 'desc')]\n  const referentielHtml: JSONReferentielObject = { ...referentielRessources }\n  const referentielOutils: JSONReferentielObject = { ...referentielProfs }\n  const baseGeometrieDynamiqueReferentiel: JSONReferentielObject = {\n    ...referentielGeometrieDynamique,\n  }\n  const exercicesGeometrieDynamique = getAllEndings(\n    baseGeometrieDynamiqueReferentiel,\n  )\n  const geometrieDynamiqueReferentiel = buildReferentiel(\n    exercicesGeometrieDynamique,\n  )\n\n  const orderedExamsReferentielCH = buildReferentiel(examensCH)\n  const baseReferentielCH: JSONReferentielObject = { ...referentielAleaCH }\n  const newExercisesCH: ResourceAndItsPath[] =\n    getRecentExercices(baseReferentielCH)\n  const newExercisesReferentielCH: JSONReferentielObject = {}\n  for (const item of newExercisesCH) {\n    newExercisesReferentielCH[\n      item.pathToResource[item.pathToResource.length - 1]\n    ] = { ...item.resource }\n  }\n  const baseAndNewsReferentielCH: JSONReferentielObject = {\n    Nouveauts: { ...newExercisesReferentielCH },\n    ...baseReferentielCH,\n  }\n  // on trie les exercice alatoires par ID ('4-C10' < '4-C10-1' <'4-C10-10')\n  let exercicesCH = getAllEndings(baseAndNewsReferentielCH)\n  exercicesCH = [...sortArrayOfResourcesBasedOnProp(exercicesCH, 'id')]\n  const aleaReferentielCH = buildReferentiel(exercicesCH)\n  const allReferentielsInMenusCH: ReferentielInMenu[] = [\n    {\n      title: 'Exercices alatoires',\n      name: 'aleatoires',\n      searchable: true,\n      referentiel: aleaReferentielCH,\n    },\n    //    {\n    //     title: 'EVACOM et TAF',\n    //  name: 'examens',\n    // searchable: true,\n    // referentiel: orderedExamsReferentielCH,\n    // },\n    {\n      title: 'Gomtrie dynamique',\n      name: 'geometrieDynamique',\n      searchable: false,\n      referentiel: geometrieDynamiqueReferentiel,\n    },\n    {\n      title: 'Outils',\n      name: 'outils',\n      searchable: false,\n      referentiel: referentielOutils,\n    },\n    {\n      title: 'Vos ressources',\n      name: 'ressources',\n      searchable: false,\n      referentiel: referentielHtml,\n    },\n  ]\n  const activatedReferentielsInMenuCH: ReferentielInMenu[] = []\n  for (const ref of allReferentielsInMenusCH) {\n    if (activations[ref.name]) {\n      activatedReferentielsInMenuCH.push(ref)\n    }\n  }\n  const originalReferentielsCH = [...activatedReferentielsInMenuCH]\n\n  return originalReferentielsCH\n}\n\n/**\n * Fabrique une liste de _vraies_ copies d'objets reprsentant les rfrentiels dans le menu.\n * Ces objet sont passs en paramtres sous la forme d'un tableau.\n * @param {ReferentielInMenu[]} originals liste de rfrentiels\n * @returns {ReferentielInMenu[]} liste des copies des rfrentiels\n */\nexport const deepReferentielInMenuCopy = (\n  originals: ReferentielInMenu[],\n): ReferentielInMenu[] => {\n  const copy: ReferentielInMenu[] = []\n  for (const item of originals) {\n    const ref: ReferentielInMenu = {\n      title: item.title,\n      name: item.name,\n      searchable: item.searchable,\n      referentiel: { ...item.referentiel },\n    }\n    copy.push(ref)\n  }\n  return copy\n}\n// rfrentiel mutable utilis par les composants\n// MGu ne surtout pas le charger au dpart, car c'est une variable globale,\n// et donc l'arbre va tre charg quelque soit la page demande...\n// alors que c'est utile seulement pour menuside de la vue prof\n// MGu pourquoi le mettre en storer, alors que finalement personne y souscrit ?\n// Une variable globale aurait le mme effet.\nconst referentiels = writable<ReferentielInMenu[]>([])\n\nlet localeLangLoaded: Language\n\nexport const getReferentiels = (lang: Language) => {\n  // console.log('getReferentiels', lang)\n  if (lang === 'fr-FR' && localeLangLoaded !== 'fr-FR') {\n    referentiels.set(createoriginalReferentielsFR())\n    localeLangLoaded = lang\n    // console.log('getReferentiels loaded', lang)\n  } else if (lang === 'fr-CH' && localeLangLoaded !== 'fr-CH') {\n    referentiels.set(createoriginalReferentielsCH())\n    localeLangLoaded = lang\n    // console.log('getReferentiels loaded', lang)\n  }\n  return deepReferentielInMenuCopy(get(referentiels))\n}\n","<script lang=\"ts\">\n  import {\n    type JSONReferentielObject,\n    type ResourceAndItsPath,\n    type ReferentielInMenu,\n    type ActivationName,\n  } from '../../../../../lib/types/referentiels'\n  import {\n    buildReferentiel,\n    getAllEndings,\n  } from '../../../../../lib/components/refUtils'\n  import ReferentielNode from './referentielNode/ReferentielNode.svelte'\n  import SearchBlock from './searchBlock/SearchBlock.svelte'\n  import SideMenuApps from './SideMenuApps.svelte'\n\n  import codeToLevelList from '../../../../../json/codeToLevelList.json'\n  import { onDestroy, onMount } from 'svelte'\n  import { applyFilters } from './filtersStore'\n  import { referentielLocale } from '../../../../../lib/stores/languagesStore'\n\n  import type { SvelteComponent } from 'svelte'\n  import type { Language } from '../../../../../lib/types/languages'\n  import { get } from 'svelte/store'\n  import {\n    deepReferentielInMenuCopy,\n    getReferentiels,\n  } from '../../../../../lib/stores/referentielsStore'\n  import { sortArrayOfResourcesBasedOnYearAndMonth } from '../../../../../lib/components/sorting'\n  interface SearchBlockType extends SvelteComponent {\n    triggerUpdateFromSearchBlock: () => void\n  }\n\n  export let excludedReferentiels: ActivationName[] = []\n  export let addExercise: (uuid: string, id: string) => void\n\n  let searchBlock: SearchBlockType\n\n  let referentielsForMenu: ReferentielInMenu[] = []\n\n  let localeValue: Language = get(referentielLocale)\n\n  let referentiels: ReferentielInMenu[] = getReferentiels(\n    get(referentielLocale),\n  )\n\n  /**\n   * Souscription aux changements de langues.\n   *  chaque changement, on doit :\n   * -> changement du rfrentiel courant (celui qui sert de rfrence)\n   * -> changement du rfrentiel dans le store\n   * -> mise  jour des entres du menu\n   */\n  const unsubscribeToReferentielLocale = referentielLocale.subscribe(\n    (value) => {\n      if (localeValue !== value) {\n        localeValue = value\n        referentiels = getReferentiels(value)\n        updateRepositories()\n      }\n    },\n  )\n\n  onMount(() => {\n    updateRepositories()\n  })\n  onDestroy(() => {\n    unsubscribeToReferentielLocale()\n  })\n\n  function updateRepositories() {\n    const updatedRepositories: ReferentielInMenu[] = []\n    const repositoriesInMenu: ReferentielInMenu[] = deepReferentielInMenuCopy(\n      referentiels,\n    ).filter((e) => {\n      return !excludedReferentiels.includes(e.name)\n    })\n    for (const repositoryInMenu of repositoriesInMenu) {\n      if (repositoryInMenu.searchable) {\n        let filteredRepository: JSONReferentielObject =\n          buildFilteredRepository(repositoryInMenu)\n\n        if (repositoryInMenu.name === 'aleatoires') {\n          filteredRepository = orderFollowingSchoolLevel(filteredRepository)\n        }\n        repositoryInMenu.referentiel = filteredRepository\n        updatedRepositories.push(repositoryInMenu)\n      } else {\n        // /!\\ TODO : doit-ordonner les rfrentiels non cherchable ? (item.referentiel)\n        updatedRepositories.push(repositoryInMenu)\n      }\n    }\n    referentielsForMenu = updatedRepositories\n  }\n\n  function buildFilteredRepository(repositoryInMenu: ReferentielInMenu) {\n    const allExercices = getAllEndings(repositoryInMenu.referentiel)\n    // const filteredExercices: ResourceAndItsPath[] = applyFilters(allExercices) // EE : (15/05/025) Comment et remplac par la ligne ci-dessous car tri dans les annales incorrect\n    const filteredExercices: ResourceAndItsPath[] =\n      sortArrayOfResourcesBasedOnYearAndMonth(\n        applyFilters(allExercices),\n        'desc',\n      )\n    return buildReferentiel(filteredExercices)\n  }\n\n  function orderFollowingSchoolLevel(\n    filteredRepository: JSONReferentielObject,\n  ) {\n    for (const key of Object.keys(codeToLevelList).reverse()) {\n      if (Object.keys(filteredRepository).includes(key)) {\n        const keyToBeFirst = { [key]: null }\n        filteredRepository = Object.assign(keyToBeFirst, filteredRepository)\n      }\n    }\n    return filteredRepository\n  }\n\n  const buildResourcesSet = (\n    refList: ReferentielInMenu[],\n  ): ResourceAndItsPath[] => {\n    let result: ResourceAndItsPath[] = []\n    const refList2 = deepReferentielInMenuCopy(refList)\n    for (const item of refList2) {\n      if (item.searchable) {\n        if (item.referentiel.BrevetTags) {\n          delete item.referentiel.BrevetTags\n        }\n        if (item.referentiel.E3CTags) {\n          delete item.referentiel.E3CTags\n        }\n        if (item.referentiel.crpeTags) {\n          delete item.referentiel.crpeTags\n        }\n        result.push(...getAllEndings(item.referentiel))\n      }\n    }\n    const clavier: ResourceAndItsPath = {\n      resource: {\n        uuid: 'clavier',\n        url: 'clavier',\n        id: 'clavier',\n        titre: 'clavier',\n        typeExercice: 'outil',\n        tags: [],\n      },\n      pathToResource: ['ClavierTest'],\n    }\n    const version: ResourceAndItsPath = {\n      resource: {\n        uuid: 'version',\n        url: 'version',\n        id: 'version',\n        titre: 'version',\n        typeExercice: 'outil',\n        tags: [],\n      },\n      pathToResource: ['Version'],\n    }\n    result.push(clavier, version)\n    return result\n  }\n</script>\n\n<aside\n  class=\"flex w-full md:h-full md:min-h-full flex-col items-start pb-4 pt-0 md:pt-4 ml-0 md:mx-0 bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n>\n  <SearchBlock\n    bind:this=\"{searchBlock}\"\n    class=\"w-full flex flex-col justify-start pt-0 sm:\"\n    resourcesSet=\"{buildResourcesSet(referentielsForMenu)}\"\n    on:filters-change=\"{() => {\n      updateRepositories()\n      searchBlock.triggerUpdateFromSearchBlock()\n    }}\"\n    {addExercise}\n  />\n  <div class=\"mt-4 w-full\">\n    <!-- Affichage de tous les rfrentiels -->\n    {#each referentielsForMenu as item, i}\n      <ReferentielNode\n        bind:subset=\"{item.referentiel}\"\n        indexBase=\"{i + 1}\"\n        levelTitle=\"{item.title}\"\n        nestedLevelCount=\"{1}\"\n        class=\"w-full px-4 text-[10px]\"\n        pathToThisNode=\"{[]}\"\n      />\n    {/each}\n    <!-- Bouton spcial pour les applications tierces -->\n    <SideMenuApps class=\"text-start p-6 w-full\" />\n  </div>\n</aside>\n","<script lang=\"ts\">\n  //\n  //\n  // /!\\ Il reste  traiter ReferentielEnding.svelte qui contient encore des accs au generalStore\n  //     Il faut faire remonter les demandes  Start.svelte pour qu'il reste le seul avec ces accs\n  //        et faire en sorte que ReferentielEnding.svelte ne gre que de l'affichage en bon presentationalComponent\n  // /!\\ Chip.svelte, SearchInput.svelte et Filtres.svelte contiennet encore des createEventDispatcher, dans l'idal il\n  //     faudrait pluttqu'ils fassent remonter les changements jusqu' SideMenu.svelte via une {function} pour qu'ils\n  //     les fassent redescendre ensuite par des {attributs}\n  //\n  import { onDestroy, onMount, setContext, tick } from 'svelte'\n  import { get } from 'svelte/store'\n  import { Collapse, Ripple, Sidenav, initTE } from 'tw-elements'\n  import appsTierce from '../../../json/referentielAppsTierce.json'\n  import { qcmCamExportAll } from '../../../lib/amc/qcmCam'\n  import { buildEsParams } from '../../../lib/components/urls'\n  import { downloadFile } from '../../../lib/files'\n  import handleCapytale from '../../../lib/handleCapytale'\n  import { sendActivityParams } from '../../../lib/handleRecorder'\n  import {\n    getExercisesFromExercicesParams,\n    mathaleaUpdateExercicesParamsFromUrl,\n    mathaleaUpdateUrlFromExercicesParams,\n  } from '../../../lib/mathalea'\n  import { canOptions } from '../../../lib/stores/canStore'\n  import {\n    darkMode,\n    exercicesParams,\n    globalOptions,\n    previousView,\n  } from '../../../lib/stores/generalStore'\n  import {\n    localisedIDToUuid,\n    referentielLocale,\n  } from '../../../lib/stores/languagesStore'\n  import type {\n    InterfaceGlobalOptions,\n    InterfaceParams,\n    VueType,\n  } from '../../../lib/types'\n  import type { CanOptions } from '../../../lib/types/can'\n  import type { Language } from '../../../lib/types/languages'\n  import { ALLOWED_LANGUAGES, isLanguage } from '../../../lib/types/languages'\n  import { type AppTierceGroup } from '../../../lib/types/referentiels'\n  import Footer from '../../Footer.svelte'\n  import Keyboard from '../../keyboard/Keyboard.svelte'\n  import { SM_BREAKPOINT } from '../../keyboard/lib/sizes'\n  import BasicClassicModal from '../../shared/modal/BasicClassicModal.svelte'\n  import ButtonBackToTop from './presentationalComponents/ButtonBackToTop.svelte'\n  import Exercices from './presentationalComponents/Exercices.svelte'\n  import Header from './presentationalComponents/header/Header.svelte'\n  import SideMenuWrapper from './presentationalComponents/header/SideMenuWrapper.svelte'\n  import ModalCapytalSettings from './presentationalComponents/modalCapytalSettings/ModalCapytalSettings.svelte'\n  import ModalThirdApps from './presentationalComponents/ModalThirdApps.svelte'\n  import Placeholder from './presentationalComponents/Placeholder.svelte'\n  import SideMenu from './presentationalComponents/sideMenu/SideMenu.svelte'\n\n  let isNavBarVisible: boolean = true\n  let innerWidth = 0\n  let isBackToTopButtonVisible = false\n  let selectedThirdApps: string[]\n  let thirdAppsChoiceModal: BasicClassicModal\n  let showThirdAppsChoiceDialog = false\n  let isMd: boolean\n  let localeValue: Language = get(referentielLocale)\n  let isSidenavOpened: boolean = true\n\n  const unsubscribeToReferentielLocale = referentielLocale.subscribe(\n    (value) => {\n      localeValue = value\n    },\n  )\n\n  console.log('[START]  Start.svelte is being initialized!')\n  console.log('[START]  Current URL:', window.location.href)\n\n  onMount(async () => {\n    console.log('[START]  onMount called!')\n    initTE({ Sidenav, Collapse, Ripple })\n    await tick() // globalOptions n'est pas encore initialis si on n'attend pas\n    console.log('[START] globalOptions.recorder =', $globalOptions.recorder)\n    console.log('[START] Full globalOptions:', $globalOptions)\n    if ($globalOptions.recorder === 'capytale') {\n      console.log('[START]  Calling handleCapytale()')\n      handleCapytale()\n      globalOptions.update((params) => {\n        params.presMode = 'un_exo_par_page'\n        params.isDataRandom = true\n        params.isTitleDisplayed = true\n        if ($globalOptions.v === 'eleve') {\n          params.isInteractiveFree = false\n        }\n        return params\n      })\n    }\n    addScrollListener()\n  })\n\n  onDestroy(() => {\n    unsubscribeToReferentielLocale()\n  })\n\n  // Spcifique  Capytale\n  let isSettingsDialogDisplayed = false\n  // Gestion de la graine\n  function buildUrlAndOpenItInNewTab(status: 'eleve' | 'usual') {\n    const url = new URL('https://coopmaths.fr/alea/')\n    for (const ex of $exercicesParams) {\n      url.searchParams.append('uuid', ex.uuid)\n      if (ex.id !== undefined) url.searchParams.append('id', ex.id)\n      if (ex.nbQuestions !== undefined) {\n        url.searchParams.append('n', ex.nbQuestions.toString())\n      }\n      if (ex.duration !== undefined) {\n        url.searchParams.append('d', ex.duration.toString())\n      }\n      if (ex.sup !== undefined) url.searchParams.append('s', ex.sup)\n      if (ex.sup2 !== undefined) url.searchParams.append('s2', ex.sup2)\n      if (ex.sup3 !== undefined) url.searchParams.append('s3', ex.sup3)\n      if (ex.sup4 !== undefined) url.searchParams.append('s4', ex.sup4)\n      if (ex.sup5 !== undefined) url.searchParams.append('s5', ex.sup5)\n      if (ex.alea !== undefined) url.searchParams.append('alea', ex.alea)\n      if (ex.interactif === '1') url.searchParams.append('i', '1')\n      if (ex.cd !== undefined) url.searchParams.append('cd', ex.cd)\n      if (ex.cols !== undefined) {\n        url.searchParams.append('cols', ex.cols.toString())\n      }\n    }\n    switch (status) {\n      case 'eleve':\n        if ($canOptions.isChoosen) {\n          url.searchParams.append('v', 'can')\n        } else {\n          url.searchParams.append('v', 'eleve')\n        }\n        break\n      default:\n        break\n    }\n    url.searchParams.append('title', $globalOptions.title ?? '')\n    const presMode =\n      $exercicesParams.length === 1 ? 'liste_exos' : 'un_exo_par_page'\n    url.searchParams.append('es', buildEsParams(presMode))\n\n    if ($canOptions.isChoosen) {\n      if ($canOptions.durationInMinutes !== 0) {\n        url.searchParams.append(\n          'canD',\n          $canOptions.durationInMinutes.toString(),\n        )\n      }\n      if ($canOptions.subTitle !== '') {\n        url.searchParams.append('canT', $canOptions.subTitle)\n      }\n      if ($canOptions.solutionsAccess) {\n        url.searchParams.append('canSM', $canOptions.solutionsMode)\n      }\n    }\n    window.open(url, '_blank')?.focus()\n  }\n\n  function toggleCan() {\n    if ($canOptions.isChoosen) {\n      $globalOptions.setInteractive = '1'\n    }\n  }\n\n  function showSettingsDialog() {\n    isSettingsDialogDisplayed = true\n  }\n\n  const handleLanguage = (lang: string) => {\n    let selectedLanguage: Language = ALLOWED_LANGUAGES[0]\n    // on se dplace circulairement dans le tableau allowedLanguages\n    // ide prise ici :https://dev.to/turneremma21/circular-access-of-array-in-javascript-j52\n    if (isLanguage(lang)) {\n      selectedLanguage = lang\n    } else {\n      window.notify(`${lang} is not allowed as language.`, {})\n    }\n\n    referentielLocale.set(selectedLanguage)\n    const currentRefToUuid = localisedIDToUuid[get(referentielLocale)]\n    exercicesParams.update((list) => {\n      for (let i = 0; i < list.length; i++) {\n        const localeID = (\n          Object.keys(currentRefToUuid) as (keyof typeof currentRefToUuid)[]\n        ).find((key) => {\n          return currentRefToUuid[key] === list[i].uuid\n        })\n        const frenchID = (\n          Object.keys(\n            localisedIDToUuid['fr-FR'],\n          ) as (keyof (typeof localisedIDToUuid)['fr-FR'])[]\n        ).find((key) => {\n          return localisedIDToUuid['fr-FR'][key] === list[i].uuid\n        })\n        list[i].id =\n          localeID !== undefined && localeID.length !== 0 ? localeID : frenchID\n      }\n      return list\n    })\n    const event = new window.Event('languageHasChanged', {\n      bubbles: true,\n    })\n    document.dispatchEvent(event)\n    mathaleaUpdateUrlFromExercicesParams()\n  }\n\n  $: {\n    isNavBarVisible = $globalOptions.v !== 'l'\n    updateSelectedThirdApps()\n    isMd = innerWidth >= SM_BREAKPOINT\n  }\n\n  function addScrollListener() {\n    function updateBackToTopButtonVisibility() {\n      isBackToTopButtonVisible =\n        document.body.scrollTop > 500 ||\n        document.documentElement.scrollTop > 500\n    }\n    window.addEventListener('scroll', () => updateBackToTopButtonVisibility())\n  }\n\n  /* MGu empeche le zoom sur double touch sur IPAD */\n  document.addEventListener('gesturestart', function (e) {\n    e.preventDefault()\n  })\n\n  /* Pour que les apps puissent fermer la sidenav */\n  window.addEventListener('message', (event) => {\n    if (event.data?.type === 'closeSidenav') {\n      if (isSidenavOpened) toggleSidenav(false)\n    }\n  })\n\n  function updateSelectedThirdApps() {\n    const appsTierceReferentielArray: AppTierceGroup[] =\n      Object.values(appsTierce)\n    const uuidList: string[] = $exercicesParams.map(\n      (exerciceParams) => exerciceParams.uuid,\n    )\n    selectedThirdApps = []\n    for (const group of appsTierceReferentielArray) {\n      for (const app of group.liste) {\n        if (uuidList.includes(app.uuid)) {\n          selectedThirdApps.push(app.uuid)\n        }\n      }\n    }\n  }\n\n  function zoomUpdate(plusMinus: '+' | '-') {\n    let zoom = Number($globalOptions.z)\n    if (plusMinus === '+') zoom = Number.parseFloat((zoom + 0.1).toFixed(1))\n    if (plusMinus === '-') zoom = Number.parseFloat((zoom - 0.1).toFixed(1))\n    globalOptions.update((params) => {\n      params.z = zoom.toString()\n      return params\n    })\n  }\n\n  function setAllInteractive(isAllInteractive: boolean) {\n    let eventName: string\n    if (isAllInteractive) {\n      $globalOptions.setInteractive = '1'\n      eventName = 'setAllInteractif'\n    } else {\n      $globalOptions.setInteractive = '0'\n      eventName = 'removeAllInteractif'\n    }\n    const event = new window.Event(eventName, { bubbles: true })\n    document.dispatchEvent(event)\n  }\n\n  function newDataForAll() {\n    const newDataForAll = new window.Event('newDataForAll', { bubbles: true })\n    document.dispatchEvent(newDataForAll)\n  }\n\n  function trash() {\n    exercicesParams.set([])\n    toggleSidenav(true)\n  }\n\n  function setFullScreen(isFullScreen: boolean) {\n    globalOptions.update((params) => {\n      isFullScreen ? (params.v = 'l') : (params.v = '')\n      return params\n    })\n  }\n\n  function handleExport(vue: VueType) {\n    $previousView = ''\n    globalOptions.update((params) => {\n      params.v = vue\n      return params\n    })\n  }\n\n  function addExercise(uuid: string, id: string) {\n    const newExercise: InterfaceParams = { uuid, id }\n    if (\n      $globalOptions.recorder === 'capytale' ||\n      $globalOptions.setInteractive === '1'\n    ) {\n      newExercise.interactif = '1'\n    }\n    exercicesParams.update((list) => [...list, newExercise])\n  }\n\n  function backToTop() {\n    window.scrollTo({ top: 0, behavior: 'smooth' })\n  }\n\n  function importExercises(urlFeuilleEleve: string) {\n    const tempRecorder = $globalOptions.recorder\n    let url = urlFeuilleEleve.replace('&v=confeleve', '')\n    url = url.replace('&v=eleve', '&recorder=' + $globalOptions.recorder)\n    if (url.includes('v=can')) {\n      $canOptions.isChoosen = true\n    }\n    url = url.replace('&v=can', '&recorder=' + $globalOptions.recorder)\n    url = url.replace(/&es=\\d{7}/g, '&es=1110001') // Force les rglages de prsentation\n    // presMode|setInteractive|isSolutionAccessible|isInteractiveFree|oneShot|twoColumns|isTitleDisplayed\n    if (url.includes('coopmaths.fr/alea') || url.includes('/mathalea.fr/')) {\n      const options = mathaleaUpdateExercicesParamsFromUrl(url)\n      if (options !== null) {\n        globalOptions.set(options)\n      } else {\n        alert('URL non valide !')\n      }\n      // On maintient Capytale car l'import d'une url non valide cr un objet globalOptions vide\n      $globalOptions.recorder = tempRecorder\n    }\n  }\n\n  /**\n   * Gestion des rfrentiels\n   */\n  // Contexte pour le modal des apps tierces\n  setContext('thirdAppsChoiceContext', {\n    toggleThirdAppsChoiceDialog: () => {\n      showThirdAppsChoiceDialog = !showThirdAppsChoiceDialog\n      if (showThirdAppsChoiceDialog === false && thirdAppsChoiceModal) {\n        thirdAppsChoiceModal.closeModal()\n      }\n    },\n  })\n\n  function updateParams(params: {\n    globalOptions: InterfaceGlobalOptions\n    canOptions: CanOptions\n  }) {\n    canOptions.set(params.canOptions)\n    globalOptions.set(params.globalOptions) // en dernier car c'est sa modification qui dclenche la mise  jour de l'url dans App.svelte qui prvient ensuite Capytale d'une mise  jour\n  }\n\n  function toggleSidenav(forceOpening: boolean): void {\n    const sideMenuWrapper = document.getElementById('choiceSideMenuWrapper')\n    if (!sideMenuWrapper) return\n    const sidenav = Sidenav.getOrCreateInstance(sideMenuWrapper)\n    if (!sidenav) return\n    if (forceOpening) {\n      if (!isSidenavOpened) {\n        sidenav.toggle()\n        isSidenavOpened = !isSidenavOpened\n      }\n    } else {\n      sidenav.toggle()\n      isSidenavOpened = !isSidenavOpened\n    }\n  }\n\n  async function exportQcmCam(): Promise<void> {\n    const exercises = await getExercisesFromExercicesParams()\n    const exercisesQcms = exercises.filter((exercise) => {\n      exercise.nouvelleVersion()\n      const questionsQcm = exercise.autoCorrection.filter(\n        (el) =>\n          el.reponse?.param?.formatInteractif === 'qcm' &&\n          el.propositions != null &&\n          el.propositions?.length > 1,\n      ).length\n      return questionsQcm !== 0\n    })\n\n    if (exercisesQcms.length === 0) {\n      alert(\n        \"Il n'y a pas encore d'export vers QCM Cam pour les exercices slectionns\",\n      )\n      return\n    }\n    const content = qcmCamExportAll(exercisesQcms)\n    if (content === '{}') {\n      alert(\n        \"Il n'y a pas encore d'export vers QCM Cam pour les exercices slectionns\",\n      )\n      return\n    }\n    downloadFile(content, 'questions.txt') // @todo Si possible, il faudrait l'nvoyer directement  travers l'ouverture d'un nouvel onglet qcmcam.net avec le lien vers ce fichier en argument.\n  }\n</script>\n\n<svelte:window bind:innerWidth />\n<div\n  class=\"{$darkMode.isActive\n    ? 'dark'\n    : ''} relative flex w-screen h-screen bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  id=\"startComponent\"\n>\n  <div class=\"flex-1 flex flex-col w-full md:overflow-hidden\">\n    <Header\n      {isNavBarVisible}\n      isExerciseDisplayed=\"{$exercicesParams.length !== 0}\"\n      {zoomUpdate}\n      {setAllInteractive}\n      {newDataForAll}\n      {trash}\n      {setFullScreen}\n      {handleExport}\n      handleRecorder=\"{sendActivityParams}\"\n      locale=\"{localeValue}\"\n      {handleLanguage}\n      isCapytale=\"{$globalOptions.recorder === 'capytale'}\"\n      isRecorder=\"{!!$globalOptions.recorder}\"\n      {buildUrlAndOpenItInNewTab}\n      {showSettingsDialog}\n      {importExercises}\n      isExercisesListEmpty=\"{$exercicesParams.length === 0}\"\n      {isSidenavOpened}\n      {toggleSidenav}\n      {exportQcmCam}\n    />\n    {#if isMd}\n      <!-- ====================================================================================\n                    MODE NORMAL\n  ========================================================================================= -->\n      <!-- Menu choix + Exos en mode non-smartphone -->\n      <div\n        class=\"relative flex w-full h-full bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n      >\n        {#if $globalOptions.recorder}\n          <SideMenuWrapper\n            isRecorder=\"{$globalOptions.recorder === 'capytale'}\"\n            {isSidenavOpened}\n            {toggleSidenav}\n          />\n        {/if}\n        <nav\n          id=\"choiceSideMenuWrapper\"\n          class=\"absolute left-0 top-0 w-[400px] h-full z-[1035] -translate-x-full data-[te-sidenav-hidden='false']:translate-x-0 overflow-y-auto overscroll-contain bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n          data-te-sidenav-init\n          data-te-sidenav-width=\"400\"\n          data-te-sidenav-hidden=\"false\"\n          data-te-sidenav-content=\"#exercisesPart\"\n          data-te-sidenav-position=\"absolute\"\n          data-te-sidenav-mode=\"side\"\n        >\n          <div\n            data-te-sidenav-menu-ref\n            class=\"w-full bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n          >\n            <SideMenu {addExercise} />\n          </div>\n        </nav>\n        <!-- Affichage exercices -->\n        <main\n          id=\"exercisesPart\"\n          class=\"absolute right-0 top-0 flex flex-col w-full h-full px-6 overflow-x-auto overflow-y-auto\n            {$globalOptions.recorder ? '!pl-[425px]' : '!pl-[400px]'}\n            bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n        >\n          {#if $exercicesParams.length !== 0}\n            <Exercices exercicesParams=\"{$exercicesParams}\" {toggleSidenav} />\n          {:else}\n            <Placeholder text=\"Slectionner les exercices\" />\n          {/if}\n        </main>\n      </div>\n    {:else}\n      <!-- ====================================================================================\n                  MODE SMARTPHONE\n========================================================================================= -->\n      <div\n        class=\"flex flex-col h-full justify-between bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n      >\n        <!-- Menu choix en mode smartphone -->\n        <div>\n          <div\n            class=\"w-full flex flex-col bg-coopmaths-canvas-dark dark:bg-coopmathsdark-canvas-dark\"\n          >\n            <button\n              type=\"button\"\n              class=\"group w-full flex flex-row justify-between items-center p-4\"\n              data-te-collapse-init\n              data-te-target=\"#choiceMenuWrapper\"\n              aria-expanded=\"true\"\n              aria-controls=\"choiceMenuWrapper\"\n            >\n              <div\n                class=\"text-lg font-bold text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest hover:dark:text-coopmathsdark-action-lightest\"\n              >\n                Choix des exercices\n              </div>\n              <i\n                class=\"bx bxs-up-arrow rotate-0 group-[[data-te-collapse-collapsed]]:rotate-180 text-lg text-coopmaths-action dark:text-coopmathsdark-action hover:text-coopmaths-action-lightest hover:dark:text-coopmathsdark-action-lightest\"\n              ></i>\n            </button>\n            <div\n              id=\"choiceMenuWrapper\"\n              class=\"!visible w-full overflow-y-visible overscroll-contain bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n              data-te-collapse-item\n              data-te-collapse-show\n            >\n              <SideMenu {addExercise} />\n            </div>\n          </div>\n          <!-- Barre de boutons en mode smartphone -->\n          <!--<div\n            class={$exercicesParams.length === 0\n              ? 'hidden'\n              : 'w-full flex flex-col justify-center items-center bg-coopmaths-canvas dark:bg-coopmathsdark-canvas'}\n            id=\"barre-boutons\"\n          >\n            <HeaderButtons\n              {zoomUpdate}\n              {setAllInteractive}\n              {newDataForAll}\n              {trash}\n              {setFullScreen}\n              {handleExport}\n              {exportQcmCam}\n            />\n          </div>-->\n          <!-- Affichage exercices en mode smartphone -->\n          <main\n            id=\"exercisesPart\"\n            class=\"flex w-full px-6 bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n          >\n            {#if $exercicesParams.length !== 0}\n              <Exercices exercicesParams=\"{$exercicesParams}\" {toggleSidenav} />\n            {:else}\n              <Placeholder text=\"Slectionner les exercices\" />\n            {/if}\n          </main>\n        </div>\n        <Footer />\n      </div>\n    {/if}\n  </div>\n  <Keyboard />\n</div>\n<ButtonBackToTop {isBackToTopButtonVisible} {backToTop} />\n<ModalThirdApps\n  {thirdAppsChoiceModal}\n  {showThirdAppsChoiceDialog}\n  appsTierceInExercisesList=\"{selectedThirdApps}\"\n/>\n<ModalCapytalSettings\n  bind:isSettingsDialogDisplayed\n  globalOptions=\"{$globalOptions}\"\n  canOptions=\"{$canOptions}\"\n  {toggleCan}\n  {buildUrlAndOpenItInNewTab}\n  {updateParams}\n/>\n\n<style>\n  @media (min-width: 768px) {\n    #barre-boutons {\n      width: calc(\n        100% -\n          (\n            var(--isMenuOpen) * var(--sidebarWidth) * 1px +\n              (var(--isMenuOpen)) * 16px\n          )\n      );\n    }\n  }\n  @media (max-width: 768px) {\n    #barre-boutons {\n      width: 100vw;\n    }\n  }\n  ::-webkit-scrollbar {\n    width: 5px;\n    height: 5px;\n  }\n  ::-webkit-scrollbar-thumb {\n    background: #cccccc;\n    border-radius: 10px;\n  }\n  ::-webkit-scrollbar-thumb:hover {\n    background: #dddddd;\n  }\n  ::-webkit-scrollbar-track {\n    background: #ffffff;\n    border-radius: 10px;\n    box-shadow: inset 7px 10px 12px #f0f0f0;\n  }\n</style>\n","<script lang=\"ts\">\n  export let message: string = ''\n  export let visible = false\n  export let onClose = () => {} // Callback pour la fermeture du popup\n\n  function closePopup() {\n    visible = false\n    onClose()\n  }\n</script>\n\n{#if visible}\n  <button class=\"overlay\" on:click=\"{closePopup}\" aria-label=\"Close popup\"\n  ></button>\n  <div class=\"popup\">\n    <p>{@html message}</p>\n    <button class=\"button\" on:click=\"{closePopup}\">Fermer</button>\n  </div>\n{/if}\n\n<style>\n  .popup {\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    background-color: white;\n    padding: 20px;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);\n    z-index: 1000;\n  }\n  .overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.5);\n    z-index: 999;\n  }\n  .button {\n    background-color: #007bff;\n    color: white;\n    border: none;\n    padding: 10px 20px;\n    font-size: 16px;\n    border-radius: 5px;\n    cursor: pointer;\n    transition: background-color 0.3s ease;\n  }\n  .button:hover {\n    background-color: #0056b3;\n  }\n  .button:focus {\n    outline: none;\n    box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.5);\n  }\n</style>\n","<script lang=\"ts\">\n  import { onDestroy, onMount } from 'svelte'\n  import type { Unsubscriber } from 'svelte/store'\n  import { checkBrowserVersion } from '../lib/components/browserVersion'\n  import { fetchServerVersion } from '../lib/components/version'\n  import {\n      mathaleaUpdateExercicesParamsFromUrl,\n      mathaleaUpdateUrlFromExercicesParams,\n  } from '../lib/mathalea'\n  import { canOptions } from '../lib/stores/canStore'\n  import {\n      darkMode,\n      exercicesParams,\n      freezeUrl,\n      globalOptions,\n      isInIframe,\n  } from '../lib/stores/generalStore'\n  import { updateReferentielLocaleFromURL } from '../lib/stores/languagesStore'\n  import { vendor } from '../lib/stores/vendorStore'\n  import type { CanSolutionsMode } from '../lib/types/can'\n  import { context } from '../modules/context'\n\n  import Can from './display/can/Can.svelte'\n  import Eleve from './display/eleve/Eleve.svelte'\n  import Alacarte from './setup/alacarte/Alacarte.svelte'\n  import Amc from './setup/amc/Amc.svelte'\n  import Anki from './setup/anki/Anki.svelte'\n  import ConfigEleve from './setup/configEleve/ConfigEleve.svelte'\n  import Diaporama from './setup/diaporama/Diaporama.svelte'\n  import Evaluation from './setup/evaluation/Evaluation.svelte'\n  import Correction from './setup/correction/Correction.svelte'\n  import Latex from './setup/latex/Latex.svelte'\n  import Pdf from './setup/latex/Pdf.svelte'\n  import Moodle from './setup/moodle/Moodle.svelte'\n  import Start from './setup/start/Start.svelte'\n  import Popup from './shared/modal/Popup.svelte'\n\n  let showPopup = false\n  let popupMessage = ''\n  let globalOptionsUnsubscriber: Unsubscriber\n  let exercicesParamsUnsubscriber: Unsubscriber\n\n  function handlePopupClose() {\n    // console.log('Popup has been closed');\n    showPopup = false\n  }\n\n  onMount(() => {\n    updateParams()\n    addEventListener('popstate', updateParams)\n    globalOptionsUnsubscriber = globalOptions.subscribe(() => {\n      updateContext() // Si on attend les 500 ms de mise  jour de l'url, la sortie LaTeX sera charge avant la mise  jour du contexte et on se retrouvera avec du svg dans le LaTeX\n      updateVendor() // Par prvention, on met aussi  jour le vendor\n      mathaleaUpdateUrlFromExercicesParams()\n    })\n    exercicesParamsUnsubscriber = exercicesParams.subscribe(() => {\n      mathaleaUpdateUrlFromExercicesParams()\n    })\n\n    const version = checkBrowserVersion()\n    if (version.popupMessage.length > 0) {\n      showPopup = true\n      popupMessage = version.popupMessage\n    }\n  })\n\n  onDestroy(() => {\n    removeEventListener('popstate', updateParams)\n    globalOptionsUnsubscriber()\n    exercicesParamsUnsubscriber()\n  })\n\n\n\n  // charge le numro de version du serveur\n  fetchServerVersion()\n\n  // Gestion des recorders (Moodle, Capytale, etc. )\n  // Lorsque la page d'accueil est dans un iFrame, l'URL est bloque et les boutons d'exports cachs\n  const url = new URL(window.location.href)\n  const recorder = url.searchParams.get('recorder')\n  if (recorder !== null) {\n    isInIframe.set(true)\n    freezeUrl.set(true)\n  } else {\n    isInIframe.set(false)\n  }\n\n  // le plus tt possible, on met  jour la vue\n  // const view = url.searchParams.get('v') ?? ''\n  // const v = convertVueType(view) ?? ''\n  // globalOptions.update((options) => {\n  //   options.v = v\n  //   return options\n  // })\n\n  // Gestion des paramtres de la CAN\n  const canDuration = url.searchParams.get('canD')\n  if (canDuration !== null) {\n    $canOptions.durationInMinutes = parseInt(canDuration)\n  }\n  const canSub = url.searchParams.get('canT')\n  if (canSub !== null) {\n    $canOptions.subTitle = canSub\n  }\n  const canSolAccess = url.searchParams.get('canSA')\n  if (canSolAccess !== null) {\n    $canOptions.solutionsAccess = canSolAccess === 'true'\n  }\n  const canSolMode = url.searchParams.get('canSM')\n  if (canSolMode !== null) {\n    $canOptions.solutionsMode = canSolMode as CanSolutionsMode\n  }\n  const canIsInteractive = url.searchParams.get('canI')\n  if (canIsInteractive !== null) {\n    $canOptions.isInteractive = canIsInteractive === 'true'\n  }\n\n  function updateParams() {\n    updateParamsFromUrl()\n    updateContext()\n    updateVendor()\n  }\n\n  function updateParamsFromUrl() {\n    updateReferentielLocaleFromURL()\n    const urlOptions = mathaleaUpdateExercicesParamsFromUrl()\n    console.log('[APP.SVELTE]  urlOptions returned from mathaleaUpdateExercicesParamsFromUrl:', urlOptions)\n    console.log('[APP.SVELTE]  urlOptions.recorder =', urlOptions.recorder)\n    console.log('[APP.SVELTE]  Current window.location.href =', window.location.href)\n    if (JSON.stringify($globalOptions) !== JSON.stringify(urlOptions)) {\n      console.log('[APP.SVELTE]  Setting globalOptions to urlOptions')\n      globalOptions.set(urlOptions)\n    } else {\n      console.log('[APP.SVELTE]  globalOptions unchanged')\n    }\n  }\n\n  function updateContext() {\n    context.isDiaporama = $globalOptions.v === 'diaporama'\n    if ($globalOptions.v === 'latex' || $globalOptions.v === 'pdf') {\n      context.isHtml = false\n    } else {\n      context.isHtml = true\n    }\n    if ($globalOptions.v === 'confeleve') {\n      context.isHtml = false\n    }\n    if ($globalOptions.v === 'alacarte') {\n      context.isHtml = false\n    }\n    if ($globalOptions.v === 'amc') {\n      context.isAmc = true\n      context.isHtml = false\n    } else {\n      context.isAmc = false\n    }\n    context.vue = ''\n    if ($globalOptions.v === 'diaporama') context.vue = 'diap' // for compatibility\n    if ($globalOptions.v === 'latex') context.vue = 'latex' // for compatibility\n    if ($globalOptions.v === 'can') context.vue = 'can' // for compatibility\n    // lorsque l'diteur sera intgr  la v3, il faudra mettre  true cette proprit pour l'editeur\n    context.isInEditor = false\n  }\n\n  function updateVendor() {\n    // initialisation du vendor pour l'intgration de la bannire dans la vue lve\n    if ($globalOptions.v === 'myriade') {\n      $vendor.product = {\n        name: 'indices',\n        logoPath: 'assets/images/vendors/bordas/myriade-bordas-logo.png',\n      }\n    }\n    if ($globalOptions.v === 'indices') {\n      $vendor.product = {\n        name: 'indices',\n        logoPath: 'assets/images/vendors/bordas/indices-bordas-logo.png',\n      }\n    }\n  }\n\n  function isDevMode() {\n    return window.location.href.startsWith('http://localhost')\n  }\n</script>\n\n<div\n  class=\" {$darkMode.isActive\n    ? 'dark'\n    : ''} subpixel-antialiased bg-coopmaths-canvas dark:bg-coopmathsdark-canvas\"\n  id=\"appComponent\"\n>\n  {#if showPopup}\n    <Popup\n      message=\"{popupMessage}\"\n      visible=\"{showPopup}\"\n      onClose=\"{handlePopupClose}\"\n    />\n  {:else if $globalOptions.v === 'diaporama' || $globalOptions.v === 'overview'}\n    <Diaporama />\n  {:else if $globalOptions.v === 'can'}\n    <Can />\n  {:else if $globalOptions.v === 'eleve' || $globalOptions.v === 'indices' || $globalOptions.v === 'myriade'}\n    <Eleve />\n  {:else if $globalOptions.v === 'latex'}\n    <Latex />\n  {:else if $globalOptions.v === 'alacarte'}\n    <Alacarte />\n  {:else if $globalOptions.v === 'confeleve'}\n    <ConfigEleve />\n  {:else if $globalOptions.v === 'amc'}\n    <Amc />\n  {:else if $globalOptions.v === 'moodle'}\n    <Moodle />\n  {:else if $globalOptions.v === 'anki'}\n    <Anki />\n  {:else if $globalOptions.v === 'evaluation'}\n    <Evaluation />\n  {:else if $globalOptions.v === 'correction'}\n    <Correction />\n  {:else if $globalOptions.v === 'pdf'}\n    <Pdf />\n  {:else if $globalOptions.v !== undefined}\n    <Start />\n  {/if}\n</div>\n\n{#if isDevMode()}\n  <dialog\n    id=\"notifDialog\"\n    class=\"rounded-xl p-6 bg-coopmaths-canvas text-coopmaths-corpus dark:bg-coopmathsdark-canvas-dark dark:text-coopmathsdark-corpus-light shadow-lg\"\n  ></dialog>\n{/if}\n","import 'boxicons/css/boxicons.min.css'\nimport './app.css'\nimport App from './components/App.svelte'\nimport './bugsnag'\nimport './modules/stats'\n\nconst app = new App({\n  target: document.getElementById('appMathalea') as HTMLElement,\n})\n\nexport default app\n"],"file":"assets/index-Bk_D2JkM.js"}
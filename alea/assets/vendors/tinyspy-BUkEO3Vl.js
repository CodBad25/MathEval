function d(t,e){if(!t)throw new Error(e)}function p(t,e){return typeof e===t}function x(t){return t instanceof Promise}function v(t,e,l){Object.defineProperty(t,e,l)}function f(t,e,l){Object.defineProperty(t,e,{value:l})}var g=Symbol.for("tinyspy:spy"),C=new Set,E=t=>{t.called=!1,t.callCount=0,t.calls=[],t.results=[],t.next=[]},S=t=>(v(t,g,{value:{reset:()=>E(t[g])}}),t[g]),m=t=>t[g]||S(t);function M(t){d(p("function",t)||p("undefined",t),"cannot spy on a non-function value");let e=function(...i){let r=m(e);r.called=!0,r.callCount++,r.calls.push(i);let y=r.next.shift();if(y){r.results.push(y);let[a,n]=y;if(a==="ok")return n;throw n}let u,c="ok";if(r.impl)try{new.target?u=Reflect.construct(r.impl,i,new.target):u=r.impl.apply(this,i),c="ok"}catch(a){throw u=a,c="error",r.results.push([c,a]),a}let o=[c,u];if(x(u)){let a=u.then(n=>o[1]=n).catch(n=>{throw o[0]="error",o[1]=n,n});Object.assign(a,u),u=a}return r.results.push(o),u};f(e,"_isMockFunction",!0),f(e,"length",t?t.length:0),f(e,"name",t&&t.name||"spy");let l=m(e);return l.reset(),l.impl=t,e}var j=(t,e)=>Object.getOwnPropertyDescriptor(t,e),P=(t,e)=>{e!=null&&typeof e=="function"&&e.prototype!=null&&Object.setPrototypeOf(t.prototype,e.prototype)};function A(t,e,l){d(!p("undefined",t),"spyOn could not find an object to spy upon"),d(p("object",t)||p("function",t),"cannot spyOn on a primitive value");let[i,r]=(()=>{if(!p("object",e))return[e,"value"];if("getter"in e&&"setter"in e)throw new Error("cannot spy on both getter and setter");if("getter"in e)return[e.getter,"get"];if("setter"in e)return[e.setter,"set"];throw new Error("specify getter or setter to spy on")})(),y=j(t,i),u=Object.getPrototypeOf(t),c=u&&j(u,i),o=y||c;d(o||i in t,`${String(i)} does not exist`);let a=!1;r==="value"&&o&&!o.value&&o.get&&(r="get",a=!0,l=o.get());let n;o?n=o[r]:r!=="value"?n=()=>t[i]:n=t[i],l||(l=n);let s=M(l);r==="value"&&P(s,n);let O=w=>{let{value:R,...b}=o||{configurable:!0,writable:!0};r!=="value"&&delete b.writable,b[r]=w,v(t,i,b)},k=()=>o?v(t,i,o):O(n),h=s[g];return f(h,"restore",k),f(h,"getOriginal",()=>a?n():n),f(h,"willCall",w=>(h.impl=w,s)),O(a?()=>(P(s,l),s):s),C.add(s),s}export{m as A,A as E};
//# sourceMappingURL=tinyspy-BUkEO3Vl.js.map

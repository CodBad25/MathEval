{"version":3,"file":"vitest_spy-CVeaWOS9.js","sources":["../../../node_modules/.pnpm/@vitest+spy@1.6.1/node_modules/@vitest/spy/dist/index.js"],"sourcesContent":["import * as tinyspy from 'tinyspy';\n\nconst mocks = /* @__PURE__ */ new Set();\nfunction isMockFunction(fn2) {\n  return typeof fn2 === \"function\" && \"_isMockFunction\" in fn2 && fn2._isMockFunction;\n}\nfunction spyOn(obj, method, accessType) {\n  const dictionary = {\n    get: \"getter\",\n    set: \"setter\"\n  };\n  const objMethod = accessType ? { [dictionary[accessType]]: method } : method;\n  const stub = tinyspy.internalSpyOn(obj, objMethod);\n  return enhanceSpy(stub);\n}\nlet callOrder = 0;\nfunction enhanceSpy(spy) {\n  const stub = spy;\n  let implementation;\n  let instances = [];\n  let invocations = [];\n  const state = tinyspy.getInternalState(spy);\n  const mockContext = {\n    get calls() {\n      return state.calls;\n    },\n    get instances() {\n      return instances;\n    },\n    get invocationCallOrder() {\n      return invocations;\n    },\n    get results() {\n      return state.results.map(([callType, value]) => {\n        const type = callType === \"error\" ? \"throw\" : \"return\";\n        return { type, value };\n      });\n    },\n    get lastCall() {\n      return state.calls[state.calls.length - 1];\n    }\n  };\n  let onceImplementations = [];\n  let implementationChangedTemporarily = false;\n  function mockCall(...args) {\n    instances.push(this);\n    invocations.push(++callOrder);\n    const impl = implementationChangedTemporarily ? implementation : onceImplementations.shift() || implementation || state.getOriginal() || (() => {\n    });\n    return impl.apply(this, args);\n  }\n  let name = stub.name;\n  stub.getMockName = () => name || \"vi.fn()\";\n  stub.mockName = (n) => {\n    name = n;\n    return stub;\n  };\n  stub.mockClear = () => {\n    state.reset();\n    instances = [];\n    invocations = [];\n    return stub;\n  };\n  stub.mockReset = () => {\n    stub.mockClear();\n    implementation = () => void 0;\n    onceImplementations = [];\n    return stub;\n  };\n  stub.mockRestore = () => {\n    stub.mockReset();\n    state.restore();\n    implementation = void 0;\n    return stub;\n  };\n  stub.getMockImplementation = () => implementation;\n  stub.mockImplementation = (fn2) => {\n    implementation = fn2;\n    state.willCall(mockCall);\n    return stub;\n  };\n  stub.mockImplementationOnce = (fn2) => {\n    onceImplementations.push(fn2);\n    return stub;\n  };\n  function withImplementation(fn2, cb) {\n    const originalImplementation = implementation;\n    implementation = fn2;\n    state.willCall(mockCall);\n    implementationChangedTemporarily = true;\n    const reset = () => {\n      implementation = originalImplementation;\n      implementationChangedTemporarily = false;\n    };\n    const result = cb();\n    if (result instanceof Promise) {\n      return result.then(() => {\n        reset();\n        return stub;\n      });\n    }\n    reset();\n    return stub;\n  }\n  stub.withImplementation = withImplementation;\n  stub.mockReturnThis = () => stub.mockImplementation(function() {\n    return this;\n  });\n  stub.mockReturnValue = (val) => stub.mockImplementation(() => val);\n  stub.mockReturnValueOnce = (val) => stub.mockImplementationOnce(() => val);\n  stub.mockResolvedValue = (val) => stub.mockImplementation(() => Promise.resolve(val));\n  stub.mockResolvedValueOnce = (val) => stub.mockImplementationOnce(() => Promise.resolve(val));\n  stub.mockRejectedValue = (val) => stub.mockImplementation(() => Promise.reject(val));\n  stub.mockRejectedValueOnce = (val) => stub.mockImplementationOnce(() => Promise.reject(val));\n  Object.defineProperty(stub, \"mock\", {\n    get: () => mockContext\n  });\n  state.willCall(mockCall);\n  mocks.add(stub);\n  return stub;\n}\nfunction fn(implementation) {\n  const enhancedSpy = enhanceSpy(tinyspy.internalSpyOn({ spy: implementation || (() => {\n  }) }, \"spy\"));\n  if (implementation)\n    enhancedSpy.mockImplementation(implementation);\n  return enhancedSpy;\n}\n\nexport { fn, isMockFunction, mocks, spyOn };\n"],"names":["mocks","isMockFunction","fn2","spyOn","obj","method","accessType","objMethod","stub","tinyspy.internalSpyOn","enhanceSpy","callOrder","spy","implementation","instances","invocations","state","tinyspy.getInternalState","mockContext","callType","value","onceImplementations","implementationChangedTemporarily","mockCall","args","name","n","withImplementation","cb","originalImplementation","reset","result","val","fn","enhancedSpy"],"mappings":"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","x_google_ignoreList":[0]}
{"version":3,"file":"svelte-writable-derived-Cn90q3ND.js","sources":["../../../node_modules/.pnpm/svelte-writable-derived@3.1.1_svelte@4.2.20/node_modules/svelte-writable-derived/index.mjs"],"sourcesContent":["import { derived, get } from \"svelte/store\";\n/**\n * @external Store\n * @see [Svelte stores](https://svelte.dev/docs#component-format-script-4-prefix-stores-with-$-to-access-their-values-store-contract)\n */\n\n/**\n * Create a store similar to [Svelte's `derived`](https://svelte.dev/docs#run-time-svelte-store-writable),\n * but which has its own `set` and `update` methods and can send values back to the origin stores.\n * [Read more...](https://github.com/PixievoltNo1/svelte-writable-derived#default-export-writablederived)\n * \n * @param {Store|Store[]} origins One or more stores to derive from. Same as\n * [`derived`](https://svelte.dev/docs#run-time-svelte-store-writable)'s 1st parameter.\n * @param {!Function} derive The callback to determine the derived value. Same as\n * [`derived`](https://svelte.dev/docs#run-time-svelte-store-writable)'s 2nd parameter.\n * @param {!Function} reflect Called when the derived store gets a new value via its `set` or\n * `update` methods, and determines new values for the origin stores.\n * [Read more...](https://github.com/PixievoltNo1/svelte-writable-derived#new-parameter-reflect)\n * @param [initial] The new store's initial value. Same as\n * [`derived`](https://svelte.dev/docs#run-time-svelte-store-writable)'s 3rd parameter.\n * \n * @returns {Store} A writable store.\n */\nexport default function writableDerived(origins, derive, reflect, initial) {\n\tvar childDerivedSetter, originValues, blockNextDerive = false;\n\tvar reflectOldValues = reflect.length >= 2;\n\tvar wrappedDerive = (got, set, update) => {\n\t\tchildDerivedSetter = set;\n\t\tif (reflectOldValues) {\n\t\t\toriginValues = got;\n\t\t}\n\t\tif (!blockNextDerive) {\n\t\t\tlet returned = derive(got, set, update);\n\t\t\tif (derive.length < 2) {\n\t\t\t\tset(returned);\n\t\t\t} else {\n\t\t\t\treturn returned;\n\t\t\t}\n\t\t}\n\t\tblockNextDerive = false;\n\t};\n\tvar childDerived = derived(origins, wrappedDerive, initial);\n\t\n\tvar singleOrigin = !Array.isArray(origins);\n\tfunction doReflect(reflecting) {\n\t\tvar setWith = reflect(reflecting, originValues);\n\t\tif (singleOrigin) {\n\t\t\tblockNextDerive = true;\n\t\t\torigins.set(setWith);\n\t\t} else {\n\t\t\tsetWith.forEach( (value, i) => {\n\t\t\t\tblockNextDerive = true;\n\t\t\t\torigins[i].set(value);\n\t\t\t} );\n\t\t}\n\t\tblockNextDerive = false;\n\t}\n\t\n\tvar tryingSet = false;\n\tfunction update(fn) {\n\t\tvar isUpdated, mutatedBySubscriptions, oldValue, newValue;\n\t\tif (tryingSet) {\n\t\t\tnewValue = fn( get(childDerived) );\n\t\t\tchildDerivedSetter(newValue);\n\t\t\treturn;\n\t\t}\n\t\tvar unsubscribe = childDerived.subscribe( (value) => {\n\t\t\tif (!tryingSet) {\n\t\t\t\toldValue = value;\n\t\t\t} else if (!isUpdated) {\n\t\t\t\tisUpdated = true;\n\t\t\t} else {\n\t\t\t\tmutatedBySubscriptions = true;\n\t\t\t}\n\t\t} );\n\t\tnewValue = fn(oldValue);\n\t\ttryingSet = true;\n\t\tchildDerivedSetter(newValue);\n\t\tunsubscribe();\n\t\ttryingSet = false;\n\t\tif (mutatedBySubscriptions) {\n\t\t\tnewValue = get(childDerived);\n\t\t}\n\t\tif (isUpdated) {\n\t\t\tdoReflect(newValue);\n\t\t}\n\t}\n\treturn {\n\t\tsubscribe: childDerived.subscribe,\n\t\tset(value) { update( () => value ); },\n\t\tupdate,\n\t};\n}\nexport { writableDerived };\n\n/**\n * Create a store for a property value in an object contained in another store.\n * [Read more...](https://github.com/PixievoltNo1/svelte-writable-derived#named-export-propertystore)\n * \n * @param {Store} origin The store containing the object to get/set from.\n * @param {string|number|symbol|Array<string|number|symbol>} propName The property to get/set, or a path of\n * properties in nested objects.\n *\n * @returns {Store} A writable store.\n */\nexport function propertyStore(origin, propName) {\n\tif (!Array.isArray(propName)) {\n\t\treturn writableDerived(\n\t\t\torigin,\n\t\t\t(object) => object[propName],\n\t\t\t(reflecting, object) => {\n\t\t\t\tobject[propName] = reflecting;\n\t\t\t\treturn object;\n\t\t\t},\n\t\t);\n\t} else {\n\t\tlet props = propName.concat();\n\t\treturn writableDerived(\n\t\t\torigin,\n\t\t\t(value) => {\n\t\t\t\tfor (let i = 0; i < props.length; ++i) {\n\t\t\t\t\tvalue = value[ props[i] ];\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\t(reflecting, object) => {\n\t\t\t\tlet target = object;\n\t\t\t\tfor (let i = 0; i < props.length - 1; ++i) {\n\t\t\t\t\ttarget = target[ props[i] ];\n\t\t\t\t}\n\t\t\t\ttarget[ props[props.length - 1] ] = reflecting;\n\t\t\t\treturn object;\n\t\t\t},\n\t\t);\n\t}\n}"],"names":["writableDerived","origins","derive","reflect","initial","childDerivedSetter","originValues","blockNextDerive","reflectOldValues","wrappedDerive","got","set","update","returned","childDerived","derived","singleOrigin","doReflect","reflecting","setWith","value","i","tryingSet","fn","isUpdated","mutatedBySubscriptions","oldValue","newValue","get","unsubscribe"],"mappings":"gDAuBe,SAASA,EAAgBC,EAASC,EAAQC,EAASC,EAAS,CAC1E,IAAIC,EAAoBC,EAAcC,EAAkB,GACpDC,EAAmBL,EAAQ,QAAU,EACrCM,EAAgB,CAACC,EAAKC,EAAKC,IAAW,CAKzC,GAJAP,EAAqBM,EACjBH,IACHF,EAAeI,GAEZ,CAACH,EAAiB,CACrB,IAAIM,EAAWX,EAAOQ,EAAKC,EAAKC,CAAM,EACtC,GAAIV,EAAO,OAAS,EACnBS,EAAIE,CAAQ,MAEZ,QAAOA,CAET,CACAN,EAAkB,EACnB,EACIO,EAAeC,EAAQd,EAASQ,EAAeL,CAAO,EAEtDY,EAAe,CAAC,MAAM,QAAQf,CAAO,EACzC,SAASgB,EAAUC,EAAY,CAC9B,IAAIC,EAAUhB,EAAQe,EAAYZ,CAAY,EAC1CU,GACHT,EAAkB,GAClBN,EAAQ,IAAIkB,CAAO,GAEnBA,EAAQ,QAAS,CAACC,EAAOC,IAAM,CAC9Bd,EAAkB,GAClBN,EAAQoB,CAAC,EAAE,IAAID,CAAK,CACrB,CAAC,EAEFb,EAAkB,EACnB,CAEA,IAAIe,EAAY,GAChB,SAASV,EAAOW,EAAI,CACnB,IAAIC,EAAWC,EAAwBC,EAAUC,EACjD,GAAIL,EAAW,CACdK,EAAWJ,EAAIK,EAAId,CAAY,CAAC,EAChCT,EAAmBsB,CAAQ,EAC3B,MACD,CACA,IAAIE,EAAcf,EAAa,UAAYM,GAAU,CAC/CE,EAEOE,EAGXC,EAAyB,GAFzBD,EAAY,GAFZE,EAAWN,CAMb,CAAC,EACDO,EAAWJ,EAAGG,CAAQ,EACtBJ,EAAY,GACZjB,EAAmBsB,CAAQ,EAC3BE,EAAW,EACXP,EAAY,GACRG,IACHE,EAAWC,EAAId,CAAY,GAExBU,GACHP,EAAUU,CAAQ,CAEpB,CACA,MAAO,CACN,UAAWb,EAAa,UACxB,IAAIM,EAAO,CAAER,EAAQ,IAAMQ,CAAK,CAAI,EACpC,OAAAR,CACF,CACA","x_google_ignoreList":[0]}